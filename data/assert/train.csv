thread_id,timestamp,init_date,text,reading_from_folder_,automatic_model_selection_,substitution_model_options_,bug_report_,rate_heterogeneity_options_,ascertainment_bias_correction_option_,partition_model_options_,mixture_model_options_,heterotachy_model_options_,site_specific_frequency_model_options_,polymorphism_aware_model_options_,automatic_partition_merging_,tree_search_parameters_,constrained_tree_search_,ultrafast_bootstrap_parameters_,nonparametric_bootstrap_,single_branch_tests_,tree_topology_tests_,concordance_factor_,phylogenetic_dating_,ancestral_sequence_reconstruction_,constructing_consensus_tree,propose_feature_,likelihood_mapping_analysis_,utilizing_multi_core_CPUs,inferring_site_specific_rates_,reducing_impact_of_severe_model_violations_with_UFBoot_
"0M_KQmOxehA","4/19/2021 13:30:06","5/20/2020","why two nodes coexist with variable substitution matrix For a given MSA file  I have used basic amino acid substitution model like  JTT  VT  WAG  LG   Mixture model  LG4M  LG4X  Mixture model combination with a profile mixture model  LG FO I G GTR20 I G  LG4X I G  and complex model  GTR20 F H4 LG4M R5 H4  LG4X I G H4   Interestingly what i have observed  two organisms like A and B are always coexist  So my doubt is   1  is it some kind of artifact  2  I am doing something terribly wrong  suggestions are highly needed  syntax  iqtree2 exe  s LG4X aln  m LG4X  bb 1000   alrt 1000   abayes iqtree2 exe  s GTR I G aln  m GTR20 I G  bb 1000   alrt 1000   abayes qtree2 exe  s WAG aln  m WAG  bb 1000   alrt 1000   optlen BFGS iqtree2 exe  s LG4M H4 aln  m LG4M R5 H4  bb 1000   alrt 1000   optlen BFGS  Dear Raghvendra Singh  Thank you for your interest  Unfortunately  it gets not quite clear what your problem is  What exactly do you mean by  two organisms like A and B are always coexist   Just from the sentence I would say  if the sequences of two organisms are present in the alignment  they both have also to exist in the tree   but I cannot imagine that this is the co existence you refer to    Could you please be more detailed describing your problem  maybe also using some explicit examples  Best regards  Heiko        You received this message because you are subscribed to the Google Groups  IQ TREE  group    To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com   To view this discussion on the web visit https   groups google com d msgid iqtree a364f8e4 87f0 4547 916f 0b1b81c1cee9 40googlegroups com                                                                               Heiko Schmidt Vienna  Austria                                                                                Dear Schmidt  Thank you for your quick response  What I meant is  in attached presentation1 pdf   Irrespective of substitution matrix  is i mentioned previously  what i found is A and B always come at the same place with  70 of boot strap value  please look at image   So My question is am i doing something wrong with program or what  Thank you To view this discussion on the web visit https   groups google com d msgid iqtree D8C4D91A 9485 43E8 8E3E 050528548143 40univie ac at                                                                                                        Raghvendra Singh D Phil  SERB National Post Doc Fellow C o Dr  R Sankaranarayanan Structural Biology Lab CSIR Centre for Cellular and Molecular Biology Uppal Road  Hyderabad   500 007  Dear Raghvendra Singh    On 21 May 2020  at 05 27  raghvendra singh   raghvendr    gmail com   wrote    Dear Schmidt    Thank you for your quick response    What I meant is  in attached presentation1 pdf   Irrespective of substitution matrix  is i mentioned previously  what i found is A and B always come at the same place with  70 of boot strap value  please look at image   So My question is am i doing something wrong with program or what  A few questions and comments  Is there any reason to believe that the two taxa should not end up in these places  Why would you believe that changing the substitution model needs to change the resulting tree  From the command lines you have sent in your first email  I see that you do show UFboot support values  not standard bootstrap support values   In the interpretation of the values that makes a big difference  While one might start trusting standard bootstrap  SBS  values at about 70   this is not the case for UFboot values  The latter behave more like probabilities  Thus  you would like to have them around 95  and above to be trustworthy  For UFboot values about 70  means no actual support  So  if these values are indeed UFboot values  all the support values are pretty low  which makes it hard to take any branch in there as certain  The reasons why the tree has low support can be manyfold and could also depend on the sequences used and their alignment  A question from my side  Which tool did you use to draw that tree  Best wishes  Heiko   To view this discussion on the web visit https   groups google com d msgid iqtree CAP7cDT KJrsY9XQgiuHtD8qar 3D5Xm65ehHmXr3vrPKj1bwJr3g 40mail gmail com    Presentation1 pdf                                                                                Heiko Schmidt Center for Integrative Bioinformatics Vienna  CIBIV  University of Vienna   Max Perutz Labs http   www cibiv at                                                                                 A few questions and comments  Is there any reason to believe that the two taxa should not end up in these places  No  in fact it is following my hypothesis  Why would you believe that changing the substitution model needs to change the resulting tree  It is my perception  though I am wrong now  when you use complex substitution model or other programs texa A and B may change  But they are not changing  So  they are not randomly placed  From the command lines you have sent in your first email  I see that you do show UFboot support values  not standard bootstrap support values   In the interpretation of the values that makes a big difference  Yes  You are right I have used UFboot  Along with UFboot I used  alrt also  Alrt UfBoot together will make sense      80  and UFboot    95     But the problem is  in I TOL I cannot represent two values together  It would be great help if you can suggest me how to represent UFboot alrt values together in Itol  While one might start trusting standard bootstrap  SBS  values at about 70   this is not the case for UFboot values  The latter behave more like probabilities  Thus  you would like to have them around 95  and above to be trustworthy  For UFboot values about 70  means no actual support  Yes  I agree  I have got clarity I will change So  if these values are indeed UFboot values  all the support values are pretty low  which makes it hard to take any branch in there as certain  The reasons why the tree has low support can be manyfold and could also depend on the sequences used and their alignment  Your suggestions are really improved my understanding  While selecting sequences I took care of diversity and minimum biasness  For alignment I have used MAFFT with structural constrain  A question from my side  Which tool did you use to draw that tree  I have used I TOL  Can you suggest me something where I can represent UFboot and alrt and abayes value together  I have another doubt like when to use ML method and when do we use Bayesian based method for phylogeny Thank you for your valuable comments  Raghav To view this discussion on the web visit https   groups google com d msgid iqtree FCE08102 49B1 49F4 A2EA 49523D0C82C5 40univie ac at  Hi All  Just a couple of general comments  Fist  it s fairly normal that changing the substitution model doesn t change the tree  Indeed  although the substitution models are all different  they are still all very very similar  They all make very similar assumptions about the way molecular evolution works  So in general if changing the model changes the tree  particularly the part you are interested in  that is something to worry about  Normally one expects very little to change in the tree   when you do see changes they tend to be on short and or poorly supported branches  There are lots of papers out there on this  here s one we wrote  the model differences here are about partitioning  but it s the same principle   https   academic oup com mbe article 32 6 1611 1068429 ggtree  in R  and ete tools  in python  are probably the best options for plotting lots of things on branches of trees  Finally  ML vs  Bayes  This is a good paper to get you started  https   www nature com articles nrg3186    But the short answer is that both methods are substantially similar if you are just looking to estimate a tree  The main difference is that ML provides you with a point estimate of the tree and branch lengths  which are usually the things you care about   You can get a nice idea of uncertainty in both via bootstrapping  Bayesian inference provides you with a posterior distribution of trees and branch lengths  If you are proper Bayesian then you would never really use a single tree  only the full distribution of trees  Since most people are interested in some kind of  best  tree  e g  in Bayesian inference people often like to use the MAP tree   this means that ML and Bayesian often show identical or near identical trees  A couple of differences between ML and Bayesian are that Bayesian inference allows you to specify informative priors  and that the estimates of the tree and branch lengths that you get have integrated out any uncertainty you might have in nuisance parameters like the transition rates  In practice though this makes very little difference for building trees  Where it makes a really big difference is in fitting very complex models like those used in molecular dating and phylodynamics  Hope some of that helps  Rob To view this discussion on the web visit https   groups google com d msgid iqtree CAP7cDT9hQchPULDukevass5 3DUVC4 PQGwOEWYiPK8VFRZXjpAg 40mail gmail com Rob Lanfear Division of Ecology and Evolution  Research School of Biology  The Australian National University  Canberra www robertlanfear com  Thanks Rob  It is really helpful for me  Thanks a lot    To view this discussion on the web visit https   groups google com d msgid iqtree CAGr 2BNmpM0uOyPkqF6SUkPuxJXZQrHBD98VoxDPeZBka8DiFqrQ 40mail gmail com ",0,0,1,0,0,0,0,1,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0
"1kxjz3RM_yI","4/19/2021 13:37:43","6/17/2020"," IQ TREE CRASHES WITH SIGNAL SEGMENTATION FAULT   ASR anlysis with codon model Hi  I launched an ASR job and received the following error message  Optimal log likelihood   78003 192 Nonsynonymous synonymous ratio  omega   0 117 Transition transversion ratio  kappa   1 000 Site proportion and rates   0 036 0 143   0 138 0 326   0 225 0 598   0 373 0 952   0 174 1 625   0 053 3 092   0 002 7 859  Parameters optimization took 38 rounds  20224 067 sec  BEST SCORE FOUND    78003 192 ERROR  STACK TRACE FOR DEBUGGING  ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR      For bug report please send to developers  ERROR      Log file   home gdupre work HA phylo muscleAlign ancestors with codons models with dnatreefile ali dna HA5 ntCDSlist trim aln log ERROR      Alignment files  if possible   bin bash  line 1  47554 Segmentation fault iqtree  s  home gdupre work HA phylo muscleAlign ancestors with codons models with dnatreefile ali dna HA5 ntCDSlist trim aln  m MG F1X4 R7  st CODON  te ali dna HA5 ntCDSlist trim aln contree  asr With another data set  alignment which is very similar to the previous one  above   I also tried to perform an ASR analysis with the same command  but without specifying any user provided tree  and I received the same error message  FINALIZING TREE SEARCH                                                                        Performs final model parameters optimization Estimate model parameters  epsilon   0 010  1  Initial log likelihood   87225 673 2  Current log likelihood   87225 637 3  Current log likelihood   87225 621 Optimal log likelihood   87225 615 Nonsynonymous synonymous ratio  omega   0 099 Transition transversion ratio  kappa   1 000 Site proportion and rates   0 020 0 084   0 144 0 353   0 353 0 650   0 257 1 039   0 173 1 677   0 052 3 083  Parameters optimization took 3 rounds  1701 168 sec  BEST SCORE FOUND    87225 615 ERROR  STACK TRACE FOR DEBUGGING  ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR      For bug report please send to developers  ERROR      Log file   home gdupre work HA phylo muscleAlign ancestors with codons models without treefile ali dna HA7 ntCDSlist trim aln log ERROR      Alignment files  if possible  I do not understand where the problem is  How can I fix this issue  The logfiles of these jobs are attached to this post  Best regards Gabriel  It looks like some problem with codon models when combined with free rate model   R   Olga has also recently found this issue  So can you please avoid using the free rate model  and just use Gamma model   G   Before we have time to look into the issue  Note that this is specific to codon models  If the problem still persists  let me know  Thanks Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 16a00ba2 683d 4f8e 8e27 c63424676f41o 40googlegroups com  ali dna HA5 ntCDSlist trim aln log   ali dna HA7 ntCDSlist trim aln log   Hi  Thank you very much for your response  I ll keep you informed  Best regards  Gabriel  Hi  I got the same error message using the command   T AUTO     T 15     T 10      So  I just removed it and it run  But it takes a while to finish  I had the same issue with IQTree 1 and looks like this hasn t been solved  Best  Janice Create initial parsimony tree by phylogenetic likelihood library  PLL     0 114 seconds Generating 1000 samples for ultrafast bootstrap  seed  373364     NOTE  165 MB RAM  0 GB  is required  Measuring multi threading efficiency up to 16 CPU cores Increase to 10 rounds for branch lengths 10 trees examined Threads  1   Time  17 756 sec   Speedup  1 000   Efficiency  100    LogL   142912 Threads  2   Time  10 464 sec   Speedup  1 697   Efficiency  85    LogL   142912 Threads  3   Time  8 468 sec   Speedup  2 097   Efficiency  70    LogL   142912 Threads  4   Time  8 217 sec   Speedup  2 161   Efficiency  54    LogL   142912 ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR      For bug report please send to developers      IQ TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR  ERROR      For bug report please send to developers     Log file  concat log ERROR      Alignment files  if possible  ERROR      Log file  concat log ERROR      Alignment files  if possible  Segmentation fault  11  Hi everyone  Is anyone else having problems  I can t get my files to load  They just hang on  waiting   You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 9f3e3f1c f5a1 4888 89c2 9464288ed5f3o 40googlegroups com L  Lee Grismer  Director of Research Herpetology Laboratory Department of Biology  La Sierra University 4500 Riverwalk Parkway Riverside  CA 92515 8247  USA Tel  951 785 2345  A risk free world is a very dull world  one from which we are apt to learn little of consequence     Geerat Vermeij  If people are good only because they fear punishment  and hope for reward  then we are a sorry lot indeed     Albert Einstein  Hi Lee  Janice  Can you please send me the data and the log file per my personal email  While this same crash message occurs  the issue may be actually different  so I can only say something once having a look at individual cases  Thanks Minh To view this discussion on the web visit https   groups google com d msgid iqtree CAMe9Yo9WSQWKC7tUhu8Xk78oekE3d7d2zW10aaD9CAOdc2Ln8Q 40mail gmail com  Hi Minh  As you said in your previous email on this issue  I tried to redo my ASR analysis for some of my data sets with another codon model  without the free rate model  when it was possible   ASR analysis with a provided DNA tree worked well  but the same analysis without any provided tree failed  with the following error message   IQtree crashes with signal aborted    Have you got any update on this problem  I cannot change the codon model with my other data sets  alignments  as the likelihood  AIC  and BIC scores are too far from the best estimated codon model  To unsubscribe from this group and stop receiving emails from it  send an email to iqt    googlegroups com  Hi Gabriel  I suggest that you avoid doing codon models for tree reconstruction for your dataset  Alignment has 1928 sequences with 597 columns  595 distinct patterns 558 parsimony informative  18 singleton sites  21 constant sites This is rather short for a full analysis with complex codon models  So I d better  as you did  reconstruct a tree with DNA model  and then use the DNA tree as input for codon models for the ASR reconstruction  This is the same when people use PAML   users typically input a tree inferred by another software for PAML codon analysis  Cheers Minh To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 9d6fbdb9 66f1 423c a51f 29c048642775o 40googlegroups com ",0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0
"2TwuyoirCmY","4/19/2021 13:41:23","3/2/2021","Subset from loci treefile Hello IQTRee  I am working on the site gene concordance approach for building a phylogenetic tree  I have been able to execute the  iqtree  p ALN DIR   prefix concat  B 1000  T AUTO and the  iqtree  S ALN DIR   prefix loci  T AUTO commands  however  I am unable to run the following  iqtree  t concat treefile   gcf loci treefile  s ALN FILE   scf 100   prefix concord  T 10 because of trees in the loci treefile that don t have the correct number of taxa  This is because the gene clustering program will add genes in multiple pieces when they are not assembled properly  Is there anyway to filter the loci treefile so that it retains trees with only the N   10 number of taxa  That is the number of taxa represented in the concat treefile constructed from the whole genome alignments  Thanks  Austin  Hi Austin  I m confused  what is the actual problem  Does it work if you run  iqtree  t concat treefile   gcf loci treefile   prefix concord  just to compute gCF and no sCF   then I know  if the loci treefile has any taxa not in concat treefile  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree eea24fa3 8414 47b1 bd61 66026615af71n 40googlegroups com  Hello Minh  Attached are the concord log file and the two input tree files  There is an incorrect number of taxa in the loci treefile due to a fault in the gene clustering program  Panaroo   Is there a way to simply delete the trees in the loci treefile that contain more than the designated taxa in the concat treefile  Thanks  Austin ",0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0
"4DechVCtLz8","4/19/2021 13:44:26","6/11/2020","error message after tree construction and asr analysis with codon models   ERROR  File not found MG   Hi  I had trouble when launching a tree construction and an asr analysis with providing codon models  MG F1X4 R7 and MG F3X4 R6   With both of the two types of jobs  I received the same error message  see below   I am wondering if that IQtree interprets the   m  option as an input file name  and that seems quite weird to me  Job1  Command job1  tree construction   iqtree  s alignement file  m MG F1X4 R7  alrt 1000  b 100  redo  nt 8 ERROR  File not found MG Job2  Command job2  ASR   iqtree  s alignement file  m MG F1X4 R7  te tree file  asr ERROR  File not found MG Does someone encounter the same problem  How can I perform my jobs with these codon models  MG F1X4 R7 and MG F3X4 R6   Best regards  Gabriel  Hi Gabriel  Simple answer  you forgot to set the sequence type as codon   st CODON  for standard genetic code  for changing the genetic code see the docs   Due to this  IQ TREE assumes you are using a DNA model  Because MG is not in the list of pre defined DNA models  it assumes that MG is a file name containing a custom model  That s why it s trying to read that file  that obviously does not exist  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree d5551f62 541b 4587 b016 28e4293fc90do 40googlegroups com ",0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,0,1,0,0
"6CaYqVZRhNI","4/19/2021 13:49:09","2/20/2021","Constrained tree search as a means for placing taxa in the  correct  tree Hi all  I m currently at my wits end trying to solve an error that IQ TREE version 1 6 12 for Linux is throwing at me  I am using  g to perform a a constrained analysis on an alignment that contains all of the taxa in the constraint phylogeny and additional  unknown  taxa  I want to use the  g option to infer the relationship of these unknown taxa relative to the known relationships of taxa in my reference  The tree that I am using is an unrooted and pruned version of the most current one available for the group I work with  I have not polytomized any of the relationships in this  best  constraint tree beyond what already existed  My understanding per the advanced tutorial is    The constraint tree can be multifurcating and need not to contain all species     emphasis mine  But when I run my analysis with the following command  iqtree  s  Alignment file   m TESTNEW  bb 1000  wbtl  g  Constraint tree  I get the following error at the  Creating fast initial parsimony tree by random order stepwise addition     step    ERROR  Alignment sequence neodelphineis sp does not appear in the tree  for up to 24 of the sequences in my alignment that are not represented in the tree  And the final error   ERROR  Tree taxa and alignment sequence do not match  see above   If anyone has any idea as to how I can fix this  I  and my dissertation  would greatly appreciate it  All the best  Cory Gargas  Hi Cory  This looks indeed strange  Please send me the whole log file for inspection  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree cf13f6bf 8b92 4ac4 be8f e6ab23310ac7n 40googlegroups com ",0,1,0,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0
"9MaMp4tR468","4/19/2021 13:55:56","3/12/2020","File does not start with opening bracket Hi  I m trying to run a ML tree but I keep recieving the following message  ERROR  Tree file does not start with an opening bracket      line 1 column 1  The code I run is  iqtree  s passeriformes 9l phy  m GTR G  a 4 51  nt 3  bb 1000 What should I do  I saw that the example file does not have     but I tried to use that and     and I still end up recieving that messge  Thanks in advance  Raquel  Hi Raquel  I just ran the same commandline with your alignment in my computer   Everything works fine to the end  iqtree 1 6 12   So which version did you use  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree ce734ca7 84e0 47fd b72a 1f2639178814 40googlegroups com  passeriformes 9l phy  ",0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0
"aFY83ZhItZM","4/19/2021 14:09:18","1/18/2021","Questions on position rate calculations  Hi Minh and everyone  Recently I ve been experimenting with using IQ Tree to calculate protein sequence position rates  as an alternative to Rate4site and LEISR but there are some points that aren t entirely clear and you might be able to assist with  1  Rate4site normalizes the rates into z scores but afaik LEISR doesn t  How does iqtree behave for either bayesian or ML rates  A per gene normalization by the gene median  or the median across the entire complex studied  might be in order for raw rates  2  There are a couple of references indicating that accuracy is better when using a JC like model such that is available on LEISR  e g  doi 10 1093 molbev msy127   Unless I m mistaken  as an equal rates matrix  that would be the equivalent of Poisson for iqtree  right  3  Another thing I ve messed with is the rate categories  For ML rates  including among site rate heterogeneity is not supposed to make much of a difference  previous ref   but I ve found that adding  R or  G tends to make the rates of positions in the highest categories shoot up even by an order of a magnitude  Any ideas about why this happens  I ve been able to replicate such behavior in LEISR too  4  Based on the above I think I ve come up with a strategy to get the best of all possible worlds when using iqtree for rate calculation  First estimate the ML tree  with Modelfinder or whichever other method  and retain it in the next round with  t and  blfix  Then  do one run for bayesian rates with Poisson R16  essentially a fusion of the ref above and rate4site but free rates instead of the default G16   Finally  to avoid weird outliers  ML rates with just Poisson  essentially mimicking LEISR   The normalization is still an issue but it depends on the downstream use  What do you think  Thanks for all the help  Cheers  Panos  H Panos  Sorry I missed your email but just found it  On 18 Jan 2021  at 10 33 pm  Panagiotis Adam   panagiotis    gmail com   wrote  Hi Minh and everyone  Recently I ve been experimenting with using IQ Tree to calculate protein sequence position rates  as an alternative to Rate4site and LEISR but there are some points that aren t entirely clear and you might be able to assist with  1  Rate4site normalizes the rates into z scores but afaik LEISR doesn t  How does iqtree behave for either bayesian or ML rates  A per gene normalization by the gene median  or the median across the entire complex studied  might be in order for raw rates  I ve never heard of the z score normalisation in Rate4Site  As far as I could remember  the estimation procedure in IQ TREE is very similar to Rate4site  In fact I looked at Tal s 2004 paper when implemented this feature in IQ TREE  The  wsr option will print the site rates solely based on the Empirical Bayesian method  The advantage of IQ TREE is that it implements the free rate model   R  in addition to the Gamma model   G   So I believe the rate estimates will be more accurate compared with the Gamma model  But I never did a proper benchmark to confirm this  Perhaps you and others can repeat similar exercise in Tal s paper to study this  If you use   mlrate option in IQ TREE 2  it will instead perform the ML estimation of the site rates  which I believe is also similiar to that option of Rate4site  In summary  you can replace rate4site with IQ TREE  it s faster  multi threading and offer many more models  2  There are a couple of references indicating that accuracy is better when using a JC like model such that is available on LEISR  e g  doi 10 1093 molbev msy127   Unless I m mistaken  as an equal rates matrix  that would be the equivalent of Poisson for iqtree  right  Yes  Poisson is the JC equivalent for amino acid data  3  Another thing I ve messed with is the rate categories  For ML rates  including among site rate heterogeneity is not supposed to make much of a difference  previous ref   but I ve found that adding  R or  G tends to make the rates of positions in the highest categories shoot up even by an order of a magnitude  Any ideas about why this happens  I ve been able to replicate such behavior in LEISR too  The ML rates are not stable  some rates might be saturated and become extremely high reaching the upper bound  Especially for highly variable rates  I believe this is also documented in Tal s paper  4  Based on the above I think I ve come up with a strategy to get the best of all possible worlds when using iqtree for rate calculation  First estimate the ML tree  with Modelfinder or whichever other method  and retain it in the next round with  t and  blfix  Then  do one run for bayesian rates with Poisson R16  essentially a fusion of the ref above and rate4site but free rates instead of the default G16   Finally  to avoid weird outliers  ML rates with just Poisson  essentially mimicking LEISR   The normalization is still an issue but it depends on the downstream use  What do you think  Yes  that sounds very sensible for me  Minh Thanks for all the help  Cheers  Panos You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree c05f8811 9fe6 4bd6 9f5d ead17af20357n 40googlegroups com  Hey Minh  Thanks for your response  The whole rates estimation was sent to the back burner temporarily anyway  since we ve been swamped with other analyses  The thing about z scores in rate4site originates from this paper  first paragraph in Results   https   peerj com articles 3391  However  I haven t confirmed it myself  I reckon though that if you didn t use the rate4site code verbatim  probably iqtree doesn t perform any sort of normalization  Tbh  it was exactly this option for  R that made me switch  Thanks for confirming about Poisson JC  There seems to be some data that it s the better option  mathematically and in benchmarks  for estimating ML rates  Not sure if it would hold up for empirical bayesian though  https   www biorxiv org content 10 1101 411025v1 abstract https   academic oup com mbe article 35 9 2307 5040133 All in all  it seems that it was a good option to drop rate heterogeneity for ML estimations  My  mathematically impaired  assumption was sth of the sort that for the very saturated variable sites  the max likelihood involves a couple of sites getting pigeonholed in extremely high rates at a long right tail of the distribution  Haven t checked if this has any formal statistical basis  Also I m picturing a Gamma distribution in my head  which probably doesn t jive with a free rate model  I m following up with another thread on recoding  Thanks for all the help  Best  Panos  And a little addendum to the previous post  I ended up rereading the original rate4site publication   https   doi org 10 1093 bioinformatics 18 suppl 1 S71   that only contained the ML rate part of the algorithm  Quoting from the Algorithm section    We repeat this calculation for all positions in the multiple sequence alignment  We then normalize these rates so that the average is zero and the standard deviation is one    Addendum 2  After some experimenting with the strategy above  I found that iqtree passes an error when combining  blfix with a  R model   ERROR  Fixing branch lengths not supported under specified site rate model  Simple Poisson  or other matrices  work normally for ML rates but only produce the file headers for empirical bayesian  I get from rate4site that the  G  or  R here  is assumed as part of the prior  hence the empty file for bayesian but I cannot figure out what s happening with the  blfix thingy   Addendum 3  I m under the impression  G16 with blfix does not produce the same outlier values in mlrates as  G  R without it  Given what I had observed when using  G in LEISR that modifies the branch lengths of the provided tree  I suspect the extreme values are linked to the branch length optimization   Ok  I just had a look at this paper  and I can confirm that IQ TREE DIDN T do this one sentence    We then normalize these rates so that the average is zero and the standard deviation is one  Without this normalization  the 2 implementations are identical  Minh To view this discussion on the web visit https   groups google com d msgid iqtree 93a8717d 8a9c 4fe2 8b9a 2f1d35afb8dcn 40googlegroups com  Yep   R model does not support  blfix  due to a requirement in the EM algorithm  it just does not work with  blfix option  Minh To view this discussion on the web visit https   groups google com d msgid iqtree 7ec1181a b69d 4171 ac39 29f32fd90405n 40googlegroups com  Hi Minh I ve got a couple more insights after trying to calculate rates across a few different alignments  For a few supermatrices in the  6k aa size range  there is almost no difference among Poisson  Poisson G16  LG  LG G16  bayesian or ML   Poisson just seems to be slightly more consistent internally  However  the absurd outlier ML rates  even   20  persist with smaller input alignments  In a run  rate and mlrate  that includes  m Poisson G16   t   blfix   n 0  how do those interact   especially in the output tree of the run  From what I ve figured out  1   n 0  doesn t calculate tree  calculates model parameters from the initial parsimony tree   is the output treefile just the parsimony tree  2   n 0  t sth tree  doesn t calculate tree  calculates model parameters from the input tree  the output treefile has modified branch lengths for some reason   Are they optimized based on the new model somehow  Does this happen before or after rate calculation  i e  is the order tree  model parameters  new tree  rates OR tree  model parameters  rates  new tree  3   t sth tree  calculates new tree according to  m  calculates model parameters from the input tree  the new tree might be entirely different to the input tree 4   blfix  5   n 0  blfix  Those two give different model parameters  rates  and output treefiles and even different to  1   What s happening  Does the parsimony tree get affected  What s in the output treefile  6   n 0  t sth tree  blfix  doesn t calculate tree  calculates model parameters from the input tree and doesn t alter the branch lengths 7   t sth tree  blfix  identical to  6    n 0 in that case is redundant These behaviors seem to persist even without rate heterogeneity  I m a bit stumped  Thanks a bunch  Best  Panos  Hi Panos  On 19 Feb 2021  at 1 36 am  Panagiotis Adam   panagiotis    gmail com   wrote  Hi Minh I ve got a couple more insights after trying to calculate rates across a few different alignments  For a few supermatrices in the  6k aa size range  there is almost no difference among Poisson  Poisson G16  LG  LG G16  bayesian or ML   Poisson just seems to be slightly more consistent internally  However  the absurd outlier ML rates  even   20  persist with smaller input alignments  That s what we also observed  due to the limited phylogenetic information with small alignments  In a run  rate and mlrate  that includes  m Poisson G16   t   blfix   n 0  how do those interact   especially in the output tree of the run  From what I ve figured out  1   n 0  doesn t calculate tree  calculates model parameters from the initial parsimony tree   is the output treefile just the parsimony tree  Yes  it s just a parsimony tree  if you don t specify  t option  However  combining  blfix and  n 0 concerns me  In that case  the branch lengths are based on parsimony  which are well known to be an underestimation  And these parsimonious branch lengths are fixed here  Therefore  I recommend to avoid  blfix in this context  Only use it if you provide a existing tree via  t option  where you are sure that the branch lengths of your tree are meaningful  2   n 0  t sth tree  doesn t calculate tree  calculates model parameters from the input tree  the output treefile has modified branch lengths for some reason   Are they optimized based on the new model somehow  Does this happen before or after rate calculation  i e  is the order tree  model parameters  new tree  rates OR tree  model parameters  rates  new tree  Yes  branch lengths are optimized on the model  before rate calculation of course  IQ TREE will optimize branch lengths are model parameters until convergence  And at the end  compute the site rates  3   t sth tree  calculates new tree according to  m  calculates model parameters from the input tree  the new tree might be entirely different to the input tree Yes  because  t will only specify a starting tree  4   blfix  5   n 0  blfix  Those two give different model parameters  rates  and output treefiles and even different to  1   What s happening  Does the parsimony tree get affected  What s in the output treefile  See above  that s why my concern  6   n 0  t sth tree  blfix  doesn t calculate tree  calculates model parameters from the input tree and doesn t alter the branch lengths yep 7   t sth tree  blfix  identical to  6    n 0 in that case is redundant yep   blfix implicity sets number of iterations to 0  Minh To view this discussion on the web visit https   groups google com d msgid iqtree 6e29b792 4cac 4fc8 a9c7 91da0cf22f63n 40googlegroups com ",0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0
"as1ePWvrQY0","4/19/2021 14:14:26","12/1/2020","IQTREE2 missing Concatenated data matrix from multiple sequence alignments Hi there  i just started playing with the new  p option in IQTREE2 that reads a folder with multiple alignments and conducts a concatenated analyses  According to the documentation it also generates a concatenated matrix as an ouput   For your convenience IQ TREE writes the concatenated alignment into the file example nex conaln    So far I have not been able to locate such file  This is my command line  iqtree2  p example partition nex   prefix bestmodel   T AUTO  m MFP MERGE  B 1000 Cheers Miquel  Hi Miquel  The option is  wca  for riting oncatenated lignment  Let me know if adding this option works  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree e1499dd2 86ed 4e39 9b07 14754d9d583dn 40googlegroups com  Hi Minh  I am using version 2 0 3  and even using the  wca parameter  it does not generate the concatenation  The log says it does  see below   but it doesn t  iqtree  s test dir  m LG  pre concat  nt AUTO  safe  keep ident  st AA  wca  redo Analysis results written to  IQ TREE report  concat iqtree Maximum likelihood tree  concat treefile Likelihood distances  concat mldist Concatenated alignment  concat conaln Screen log file  concat log I am missing something  best  Thiberio L  Thib rio Rangel   Ph D  Postdoctoral Associate Department of Earth  Atmospheric   Planetary Sciences Massachusetts Institute of Technology 77 Massachusetts Ave Cambridge  MA 02139 To view this discussion on the web visit https   groups google com d msgid iqtree 725AA974 C849 41AA A200 F1A7E0EF2A7E 40univie ac at ",1,1,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0
"caPurU55p64","4/19/2021 14:16:30","6/12/2020","What are the differences between the user provided tree file and the   treefile   generated from an ASR job  Hi  I am doing ancestral sequence reconstructions  ASR   and I have a question about some output files  I am launching the ASR analysis by specifying the best fit substitution model and my consensus tree in my command line  After the job was done  a   treefile  is generated  in which node labels were automatically added for every internal node  Is this   treefile  the same tree as mine  with internal node labels added  Can this  treefile  differ to my consensus tree in terms of genetic distances between nodes and topology  I am not sure how this   treefile  was built  Can I have more information about its construction  Best regards Gabriel  Hi Gabriel  On 12 Jun 2020  at 6 42 pm  Gabriel DUPRE   gabriel    gmail com   wrote  Hi  I am doing ancestral sequence reconstructions  ASR   and I have a question about some output files  I am launching the ASR analysis by specifying the best fit substitution model and my consensus tree in my command line  After the job was done  a   treefile  is generated  in which node labels were automatically added for every internal node  Is this   treefile  the same tree as mine  with internal node labels added  Depends on whether you fixes the topology of the starting tree or not  What is the command line  If you use   t  option then IQ TREE uses the input tree as starting tree and will further optimise it  With   te  option  it will fix the tree topology  Can this  treefile  differ to my consensus tree in terms of genetic distances between nodes and topology  See above I am not sure how this   treefile  was built  Can I have more information about its construction  I assume this is a general question about IQ TREE algorithm  If so  have a look at our paper  https   doi org 10 1093 molbev msu300 Minh Best regards Gabriel You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree e57abb01 8651 4edc 918a d53a19bfa712o 40googlegroups com ",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0
"C-oFh9KaQHY","4/19/2021 14:36:39","3/3/2021","Adding SH aLRT after the tree has been inferred  Hi  I was wondering if it is possible to add SH aLRT to a tree that has already been inferred  or do I have to rerun the entire analysis again and add the  alrt flag  Thanks  Miles  Hi Miles  Yes you can annotate SH aLRT values onto an existing tree  provided that this tree is bifurcating  If so  use  te option to provide a fixed user tree topology  a simple analysis is something like  iqtree  s ALN FILE  te TREE FILE  alrt 1000 should do the job  You might want to specify a model to speed up the analysis  by skipping ModelFinder   Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 67ef74ff 9aca 4833 8cc4 4f678d183c20n 40googlegroups com  Perfect thank you very much for the quick response  Best  Miles ",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0
"cPujHIMeCYA","4/19/2021 14:46:02","6/23/2020","How to run IQTREE faster while maintaining accuracy for large dataset Hello  We are running about 20 000 sequences with an average length of 1 000 1 200 amino acids  aligned   The code we ran is taking nearly two months to complete  so we are looking for ways to make the process faster while maintaining the accuracy of the tree  These are the options we used  iqtree v1 6 12   s PEP fa  alrt 1000  bb 1000  nt AUTO  safe 1  Is there an option like   bo  pre  to split bootstrap runs for SH aLRT test and ultrafast bootstrap  2  We installed IQTREE 2 and are thinking of using iqtree mpi and limiting model choices with   mset nuclear  to quicken the process  Are there any other options we could use  Thank you for your time  Best Regards  Jenny  Hi Jenny  MPI may help  though your alignments are not very long so I m not totally sure on how much you will be able to speed things up  How many processors does it select under  nt AUTO  If it s a small number  I m pretty sure MPI can t help you  The best way for us to understand how to help you speed it up would be to post your log file  That would let us see what is taking the most time  For example  my intuition is that it s unlikely to be the model selection  but rather just the challenge of inferring a tree with 20K sequences  IQ TREE does tend to get slower with more than about 10K sequences  so it would be worth trying out raxml ng and or fasttree as well  or just try both  and compare the lnLs by re running the fasttree tree in raxml ng   Both of those pieces of software are more optimised for very large datasets  Rob You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 0acbc81f e0d0 4be5 a682 b129f1fbded2o 40googlegroups com Rob Lanfear Division of Ecology and Evolution  Research School of Biology  The Australian National University  Canberra www robertlanfear com  Dear All  We are working on a fast version that works with  10K sequences datasets  Details will follow next week  Please note that using MPI version is perfectly fine as it does not depend on the sequence length  whereas multi threading does not scale well with such short sequences  Moreover  even the ultrafast bootstrap will become slow for such large dataset  So I d suggest just to use the SH aLRT test  To speed up ModelFinder further  you can use option  m TEST  to ignore the free rate model  Cheers Minh To view this discussion on the web visit https   groups google com d msgid iqtree CAGr 2BNmrqwpNGCM 3DT6f doVx2P0p3aXoy4ibswjih 3D7ZjTrJRGg 40mail gmail com ",0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0
"GnUR0k1ayBQ","4/19/2021 14:50:15","2/23/2021","BUG  IQ TREE CRASHES WITH SIGNAL SEGMENTATION FAULT  core dumped  Dear developers  I have first been running IQ TREE v1 6 12 on my alignment without specifying any partitions and the run went fine  However  when running now by specifying partitions  I get segmentation fault error  Please find beginning and end of the log file below  Thanks in advance for your reply  Best  Simon                                                         BEGINNING                                                         IQ TREE multicore version 1 6 12 for Linux 64 bit built Aug 15 2019 Developed by Bui Quang Minh  Nguyen Lam Tung  Olga Chernomor  Heiko Schmidt  Dominik Schrempf  Michael Woodhams  Host  deigo010915 oist jp  AVX2  FMA3  503 GB RAM  Command  iqtree  s supermatrix nex  spp all partitions nex  nt AUTO  ntmax 24  mem 10G Seed  566713  Using SPRNG   Scalable Parallel Random Number Generator  Time  Tue Feb 23 21 22 29 2021 Kernel  AVX FMA   auto detect threads  128 CPU cores detected  Reading partition model file all partitions nex     Reading alignment file supermatrix nex     Nexus format detected                                                         END                                                         Loading 5 partitions    Subset Type Seqs Sites Infor Invar Model Name 1 320 2933 1664 916 rRNA 2 326 1922 975 716 tRNA 3 326 3939 2019 1561 coding first 4 326 3939 2127 1493 coding second 5 326 3938 2499 1097 coding third Degree of missing data  0 003 Info  multi threading strategy over partitions Create initial parsimony tree by phylogenetic likelihood library  PLL     0 582 seconds NOTE  ModelFinder requires 1197 MB RAM  NUMBER OF THREADS FOR PARTITION FINDING  5 Testing GTR F G on supermatrix    GTR F G4   LnL   1053664 626   df  658   AIC  2108645 251   AICc  2108699 413   BIC  2113725 950 Selecting individual models for 5 charsets using BIC    No  Model Score Charset 1 GTR F R5 137405 745 tRNA 2 GTR F I G4 278265 320 rRNA 3 GTR F R5 485433 650 coding first 4 GTR F R5 514751 069 coding second 5 GTR F R5 655716 423 coding third Full partition model BIC score  2078001 114  LnL   1035466 819 df 727  Partition information was printed to all partitions nex best scheme nex Partition information in Raxml format was printed to all partitions nex best scheme All model information printed to all partitions nex model gz CPU time for ModelFinder  11042 569 seconds  3h 4m 2s  Wall clock time for ModelFinder  3254 475 seconds  0h 54m 14s  NOTE  574 MB RAM  0 GB  is required  Measuring multi threading efficiency up to 24 CPU cores ERROR  STACK TRACE FOR DEBUGGING  ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR      For bug report please send to developers  ERROR      Log file  all partitions nex log ERROR      Alignment files  if possible   var spool slurmd job5848028 slurm script   ligne 57   95727 Erreur de segmentation  core dumped iqtree  s  ALIGNMENT  spp   WORKDIR    ANALYSIS ALL  nex  nt AUTO  ntmax   SLURM CPUS PER TASK   mem 10G  Hi  I think I narrowed it to down to multi threading issues  I restarted the run without specifying  nt and  ntmax with the below command and the run could complete  iqtree  s  ALIGNMENT  spp   WORKDIR    ANALYSIS ALL  nex  redo Best  Simon  Hi Simon  Does it work  if you specify something like  nt 10  instead of  nt AUTO  That means  tell IQ TREE the specific number of threads  instead of asking IQ TREE to determine it  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree b6d2d7ad 058d 47a0 9b43 c007d98b8bb9n 40googlegroups com  Dear Minh  Thank you for your reply  Specifying the number of threads was actually my first test  I specified  nt to 24  which gave me a lot of the same warning followed by the same crash reported above  WARNING  Number of threads seems too high for short alignments  Use  nt AUTO to determine best number of threads  I am currently running it again with  nt set to 10 and will let you know how that goes  Best  Simon  Hi Minh  The job with  nt 10 crashed as reported with  nt AUTO  Best  Simon  Hi Simon  I look more carefully now  You have only 5 partitions  And IQ TREE even said  NUMBER OF THREADS FOR PARTITION FINDING  5 So can you rerun with  nt 5  Anyway please send me the data  I ll try to fix this bug  IQ TREE shouldn t have crashed  but do something about small datasets like this to limit the number of threads  Minh To view this discussion on the web visit https   groups google com d msgid iqtree 56783c6b ac85 4b39 81d5 7a55b11ed6d1n 40googlegroups com  Hi Minh  I just tried with  nt 5 but the same crash occurs unfortunately  I just sent you the data for you to have a look at it  Best  Simon ",0,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0
"m3a00R-C54Q","4/19/2021 15:03:37","5/19/2020","How to exclude third codon position from an analysis Hi  I am trying to run an analysis of a multiple aligment in IQ Tree  including a COI fragment gene  the third position of its codons is saturated   charset Subset3    How can I exclude this third position  These are the parementers indicated by PartitionFinder2   nexus begin sets  charset Subset1   1 1234  charset Subset2   1913 2524 3 1914 2524 3 1235 1912 3 1236 1912 3  charset Subset3   1237 1912 3  charset Subset4   1915 2524 3  charpartition PartitionFinder   TVM I G Subset1  GTR I G Subset2  TIM I G Subset3  GTR I G Subset4  end  Many thanks and stay healthy  Fernando Carbayo  Hi Fernando  Simply remove this charset line from the file  and also remove  TIM I G Subset3  from the charpartition  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree b3dba039 ba1a 4231 ab9c 07a935357e25 40googlegroups com  Hi Minh  Many tahnks for your quick and direct reply  Best wishes  Fernando Carbayo ",0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"NjiLa_NQ6AM","4/19/2021 15:23:45","5/21/2020","rogue taxa search tests Dear all  is there any rogue taxa search tests implemented in iqtree   Hi Phillipp  I m 99  sure that the answer is a simple  no   Slightly longer answer  RogeNaRok seems popular for this https   github com aberer RogueNaRok wiki Hands On 1  a Basic Rogue Taxon Search   In IQ TREE one can of course get some idea about rogue taxa by examining bootstrap replicates and concordance factors  Rob On Fri  22 May 2020 at 02 46  Philipp Chetverikov   philipp c    gmail com   wrote  Dear all  is there any rogue taxa search tests implemented in iqtree  You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 87f33ea3 db82 4df9 8e05 b65b4c01f431 40googlegroups com Rob Lanfear Division of Ecology and Evolution  Research School of Biology  The Australian National University  Canberra www robertlanfear com  Rob is right  there is no such option  But the 1  is to use   tbe option together with the standard bootstrap option   b   This transfer bootstrap expectation method   https   www nature com articles s41586 018 0043 0   computes an index for each taxon  how often it has to be transferred  i e  some sort of stability index  IQ TREE will print a file with that information  You can compare it with RogueNaRok  Cheers  Minh To view this discussion on the web visit https   groups google com d msgid iqtree CAGr 2BNmq7H 3DUkzO3Lmgwm3ACquH1ipwxx3RK 3DiDixJvtaC5 vNQ 40mail gmail com  Dear Rob and Minh  thanks for the answers  I will try RogueNaRok  This program wants me to upload ML tree and a bootstrap tree set  Which file of those obtained in iqtree analysis contains  a bootstrap tree set   If I did not really get it in the analysis  because I did not ask iqtree about it   what is the command to calculte it           21     2020     19 46 44 UTC 3              Philipp Chetverikov           Hi there  If you did standard bootstrap   b  then this is printed to  boottrees file automatically  If you did ultrafast bootstrap   bb in v1 or  B in v2   then you need to add   wbt  option to print  ufboot file  which contain the set of ufboot trees  If you didn t use  wbt option  you can still get the ufboot trees adding this option  assuming you are using iqtre v2     undo  wbt   undo is a new option  I believe it s called   force unfinish in v1  to ignore that IQ TREE finished and won t complain  which is handy when you want to change a few options  It works in this case before all the bootstrap trees are actually stored in the checkpoint file  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 28ea50f4 9581 43c9 985f 12bdd0bf64d6 40googlegroups com  dear Minh  thanks a lot  I did what you suggested   wbt  and it worked perfect  thanks           21     2020     19 46 44 UTC 3              Philipp Chetverikov          Dear all  is there any rogue taxa search tests implemented in iqtree  ",0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0
"NjiLa_NQ6AM","4/19/2021 15:24:29","5/21/2020","rogue taxa search tests Dear all  is there any rogue taxa search tests implemented in iqtree   Hi Phillipp  I m 99  sure that the answer is a simple  no   Slightly longer answer  RogeNaRok seems popular for this https   github com aberer RogueNaRok wiki Hands On 1  a Basic Rogue Taxon Search   In IQ TREE one can of course get some idea about rogue taxa by examining bootstrap replicates and concordance factors  Rob On Fri  22 May 2020 at 02 46  Philipp Chetverikov   philipp c    gmail com   wrote  Dear all  is there any rogue taxa search tests implemented in iqtree  You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 87f33ea3 db82 4df9 8e05 b65b4c01f431 40googlegroups com Rob Lanfear Division of Ecology and Evolution  Research School of Biology  The Australian National University  Canberra www robertlanfear com  Rob is right  there is no such option  But the 1  is to use   tbe option together with the standard bootstrap option   b   This transfer bootstrap expectation method   https   www nature com articles s41586 018 0043 0   computes an index for each taxon  how often it has to be transferred  i e  some sort of stability index  IQ TREE will print a file with that information  You can compare it with RogueNaRok  Cheers  Minh To view this discussion on the web visit https   groups google com d msgid iqtree CAGr 2BNmq7H 3DUkzO3Lmgwm3ACquH1ipwxx3RK 3DiDixJvtaC5 vNQ 40mail gmail com  Dear Rob and Minh  thanks for the answers  I will try RogueNaRok  This program wants me to upload ML tree and a bootstrap tree set  Which file of those obtained in iqtree analysis contains  a bootstrap tree set   If I did not really get it in the analysis  because I did not ask iqtree about it   what is the command to calculte it           21     2020     19 46 44 UTC 3              Philipp Chetverikov           Hi there  If you did standard bootstrap   b  then this is printed to  boottrees file automatically  If you did ultrafast bootstrap   bb in v1 or  B in v2   then you need to add   wbt  option to print  ufboot file  which contain the set of ufboot trees  If you didn t use  wbt option  you can still get the ufboot trees adding this option  assuming you are using iqtre v2     undo  wbt   undo is a new option  I believe it s called   force unfinish in v1  to ignore that IQ TREE finished and won t complain  which is handy when you want to change a few options  It works in this case before all the bootstrap trees are actually stored in the checkpoint file  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 28ea50f4 9581 43c9 985f 12bdd0bf64d6 40googlegroups com  dear Minh  thanks a lot  I did what you suggested   wbt  and it worked perfect  thanks           21     2020     19 46 44 UTC 3              Philipp Chetverikov          Dear all  is there any rogue taxa search tests implemented in iqtree  ",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0
"O3-qO3BF9Ww","4/19/2021 15:37:52","3/2/2021","Re   iqtree  BUG   mem option not wirking   question of  speed  again Hi Karen  On 1 Mar 2021  at 8 14 pm   kmeus     googlemail com   via IQ TREE   iqt    googlegroups com   wrote  Dear Minh  1   mem option  are there plans to make it work on mixture models   partition models  I today tried with a dataset using mixture models  but it failed  or is there another problem  I thought that  mem only does not work on the  spp model  command      iqtree 1 6 12 Linux bin iqtree  s alignment fas  mem 100G  st AA  m JTTDCMut C60 FO R5  pre BS00 49 strict mixmod  nt AUTO  gmedian  t RANDOM  bo 50  safe  ERROR  phylotree cpp 5216  bool PhyloTree  computeTraversalInfo PhyloNeighbor    PhyloNode    double      Assertion  0     No free unlocked mem slot found    failed  ERROR  STACK TRACE FOR DEBUGGING  ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL ABORTED ERROR      For bug report please send to developers  ERROR      Log file  BS00 49 strict mixmod log ERROR      Alignment files  if possible   mem option is supposed to work with mixture models  This is the case here  So can you send me the log file  If you run without  mem  how much RAM does IQ TREE requirement  It could be that  mem 100G is too restrictive  and in such case  it should say so  instead of assertion  So does it work  if you increase to  say   mem 200G  2  the partition specific rates in the log file are the same like the speed value in the iqtree file correct   slight difference due to rounding  from an earlier post   Speed column is exactly as you asked  it is the partition specific rate  They are computed by maximum likelihood  The rates are normalized such that the weighted average is 1  where the weights are the partition alignment length divided by supermatrix length   Yes  see an earlier reply  Minh Best  Karen You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree f232b315 9e63 488a bd66 43c944aedfe2n 40googlegroups com  Dear Minh  see in between the lines    Minh Bui schrieb am Dienstag  2  M rz 2021 um 03 28 33 UTC 1  Hi Karen  On 1 Mar 2021  at 8 14 pm   kmeus     googlemail com   via IQ TREE   iqt    googlegroups com   wrote  Dear Minh  1   mem option  are there plans to make it work on mixture models   partition models  I today tried with a dataset using mixture models  but it failed  or is there another problem  I thought that  mem only does not work on the  spp model  command      iqtree 1 6 12 Linux bin iqtree  s alignment fas  mem 100G  st AA  m JTTDCMut C60 FO R5  pre BS00 49 strict mixmod  nt AUTO  gmedian  t RANDOM  bo 50  safe  ERROR  phylotree cpp 5216  bool PhyloTree  computeTraversalInfo PhyloNeighbor    PhyloNode    double      Assertion  0     No free unlocked mem slot found    failed  ERROR  STACK TRACE FOR DEBUGGING  ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL ABORTED ERROR      For bug report please send to developers  ERROR      Log file  BS00 49 strict mixmod log ERROR      Alignment files  if possible   mem option is supposed to work with mixture models  This is the case here  So can you send me the log file  its attached here   or shall I sed it to an email address   which one   If you run without  mem  how much RAM does IQ TREE requirement  It could be that  mem 100G is too restrictive  and in such case  it should say so  instead of assertion  So does it work  if you increase to  say   mem 200G  It seems to need I think 170 GB RAM   currently I have no opportunity to more than ca  100 GB RAM  so others doing for me now the analyses  so I cannot could not try it out  Anyway  I also did not understand the error message  2  the partition specific rates in the log file are the same like the speed value in the iqtree file correct   slight difference due to rounding  great thanks a lot      still no idea why my posts on monday got deleted from this googlegroup although subscribed    Best  Karen ",0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0
"qpAyooApcDA","4/19/2021 18:10:02","1/24/2020","ModelFinder is much slower than PartitionFinder2 I set up a ModelFinder analysis on my phylogenomic dataset that should mimic settings I used in PartitionFinder2  The PF2 analysis finished in 1 5 days using 72 cpus  The MF analysis  in contrast  was still running after 2 days and the estimated amount of time remaining kept increasing    2 000 hours   I have generally found the MF analysis available in IQTree to be much slower than PF2 and I am curious to know why that is and if there is a fix in the works or if I am setting up the analysis incorrectly  For some background  my dataset has 283 taxa  694198 bp  and 5423 partitions  To reduce analysis time  I used the rclusterf algorithm and restricted the model to GTR G only  Here is the exact execution script run in v1 6 12 on a cluster  iqtree  s aln phy  spp aln nodupes part  m TESTMERGEONLY  rclusterf 10  mset GTR G  merit AICc  mrate G  nt 72 Any comments appreciated  Thanks  Michael  Hi Michael  It looks like there might be a mistake in your Modelfinder command line  From what I understand   rclusterf is just a flag  and shouldn t be followed by a number  I don t know what happens when you follow it with a number  but given what you report I suspect ModelFinder might be ignoring the flag altogether  Maybe try this  iqtree  s aln phy  spp aln nodupes part  m TESTMERGEONLY  rclusterf  mset GTR G  merit AICc  mrate G  nt 72 and alternatively you could try this which should be very similar iqtree  s aln phy  spp aln nodupes part  m TESTMERGEONLY  rcluster max 5  mset GTR G  merit AICc  mrate G  nt 72 The latter will run the standard rcluster analysis  but only look at the top 5 potential pairs to merge  It should be fairly quick  and might help you figure out if it s something intrinsic to ModelFinder being slower for some reason  which I think is relatively unlikely  or something that can be fixed by changing your command line  Rob You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 0a71fc8f a904 4b3f 8280 9434b7951f04 40googlegroups com Rob Lanfear Division of Ecology and Evolution  Research School of Biology  The Australian National University  Canberra www robertlanfear com  Hi guys  Just to chime in  I recently used  rclusterf 10 and it seemed to work fine  Then again  there was nothing in the log file that said that ModelFinder just used to top 10  of candidates  Chris On Thursday  23 January 2020 19 09 06 UTC 5  Rob Lanfear wrote  Hi Michael  It looks like there might be a mistake in your Modelfinder command line  From what I understand   rclusterf is just a flag  and shouldn t be followed by a number  I don t know what happens when you follow it with a number  but given what you report I suspect ModelFinder might be ignoring the flag altogether  Maybe try this  iqtree  s aln phy  spp aln nodupes part  m TESTMERGEONLY  rclusterf  mset GTR G  merit AICc  mrate G  nt 72 and alternatively you could try this which should be very similar iqtree  s aln phy  spp aln nodupes part  m TESTMERGEONLY  rcluster max 5  mset GTR G  merit AICc  mrate G  nt 72 The latter will run the standard rcluster analysis  but only look at the top 5 potential pairs to merge  It should be fairly quick  and might help you figure out if it s something intrinsic to ModelFinder being slower for some reason  which I think is relatively unlikely  or something that can be fixed by changing your command line  Rob On Fri  24 Jan 2020 at 10 51  Michael Branstetter   mgbran    gmail com   wrote  I set up a ModelFinder analysis on my phylogenomic dataset that should mimic settings I used in PartitionFinder2  The PF2 analysis finished in 1 5 days using 72 cpus  The MF analysis  in contrast  was still running after 2 days and the estimated amount of time remaining kept increasing    2 000 hours   I have generally found the MF analysis available in IQTree to be much slower than PF2 and I am curious to know why that is and if there is a fix in the works or if I am setting up the analysis incorrectly  For some background  my dataset has 283 taxa  694198 bp  and 5423 partitions  To reduce analysis time  I used the rclusterf algorithm and restricted the model to GTR G only  Here is the exact execution script run in v1 6 12 on a cluster  iqtree  s aln phy  spp aln nodupes part  m TESTMERGEONLY  rclusterf 10  mset GTR G  merit AICc  mrate G  nt 72 Any comments appreciated  Thanks  Michael You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqt    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 0a71fc8f a904 4b3f 8280 9434b7951f04 40googlegroups com  Thanks for the comments  I initially tried to run the command without the number after rclusterf  but I received an error message stating that it expected there to be a number  I did think this was odd  given that PF2 does not require such a number when using rclusterf  I will keep trying  but I am curious to know if it is a reasonable expectation that MF should be as fast or faster than PF2 with the same number of cpus  Also  if MF has been tested on large phylogenomic datasets and compared to PF2 in terms of performance and speed  Thanks  Michael                                                           Michael Branstetter  PhD USDA ARS Pollinating Insects Research Unit Utah State University 5310 Old Main Hill Logan  UT 84322 5310  435  797 2588                                                           To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 6077c882 1d1d 4289 8a65 6aca68f4b541 40googlegroups com  Dear Michael  dear all  I think that providing a number to the rclusterf option is correct  in iqtree  I was also surprised how long my last rclusterf run took  It had about 260000 sites  1300 data blocks and 135 taxa  So much smaller than your data set   No Hymenoptera in fact   It took almost exactly one month to complete on 50 cores  I did not compare this to PF2  but I was surprised that it took that long  Another point of interest  The time left during the merging phase increased almost steadily up to a maximum of about 6400 hours  Minutes after reaching that maximum  the merging phase successfully finished  I think the run time of the rclusterf simply cannot be estimated  It would be easier to estimate the time until the next merging step since for the current step  the number of remaining analyses is known  In an rcluster run  no f  the  time left  decreased to 0 and stayed there for days until it finished  Maybe this difficulty in estimating the remaining computation time could be pointed out somewhere  Best Christoph To view this discussion on the web visit https   groups google com d msgid iqtree CAJgYPPExc5BF4ZPaaPQmQV21eSX5UJ0mGMdfGWAOZ1ZnTLdLiw 40mail gmail com                                          Dr  Christoph Mayer Email  c maye    uni bonn de Tel    49  0 228 9122 403 Zoologisches Forschungsmuseum Alexander Koenig   Leibniz Institut f r Biodiversit t der Tiere   Adenauerallee 160 53113 Bonn  Germany www zfmk de Stiftung des  ffentlichen Rechts  Interimsdirektor  Prof  B  Misof Sitz  Bonn                                           Hi All  Minh is on holiday at the moment  but when he s back he and I can sit down and work through these issues and differences in performance  We re preparing to release a new version of ModelFinder so these concerns are very timely  If anyone else has observations  this would be a good thread to raise discuss them  Rob To view this discussion on the web visit https   groups google com d msgid iqtree 754EBE7A 938B 4C17 886B 4FB2514C78CB 40uni bonn de  Hi Rob  I posted this before  but ModelFinder was taking a very long time on my unpartitioned alignment of about 2 million bp and 33 taxa  Because if this I simply compared GTR R10 and GTR I G  Chris To view this discussion on the web visit https   groups google com d msgid iqtree CAGr 2BNmqmNEfzVj5 2B10ieWtdL7F3chNVJYCGtvE5ftpb 2BT ZErw 40mail gmail com                                        Christopher Blair  Ph D  Associate Professor Department of Biological Sciences New York City College of Technology and Ecology  Evolution and Behavior PhD Program Graduate Center The City University of New York 285 Jay Street Brooklyn  NY 11201 CBl    citytech cuny edu cbl    gc cuny edu Website  https   sites google com site christopherblairphd home Office  Academic Complex 501A  Ph  718 260 5342 Lab  Academic Complex 401  Dear Minh  there is another point I want to add to this discussion  since I feel that it could be linked to ModelFinder being slow on large data sets  I am using Version 1 6 12 since this is the last stable release  I am aware of the fact the 1 7 includes improvements of the merging  Anyway  A while ago I started a merging run with rcluster 10  Since it is slow I copied the folder including the model gz file and started a run with rclusterf 10 which should be faster  iqtree says that it read the model gz file  which is already 500 MB large  Even though it has read the model file  it started to recompute models for all data blocks  Even though I gave this job 56 cores it reports the model of a single data block only every few minutes  The pattern is the following  It writes the model gz tmp file  which takes about 4 minutes  Then it renames it to model gz  Every time it finishes  it reports the result of exactly one model determination of a single data block    In this way it takes very long to conduct the primary model determination for 1300 data blocks    I wonder why it determines the models of the individual data blocks  since it should already have obtained them from the previous run when reading the model gz file  It reported that it read this file and apparently it is writing this file to the disk constantly   Of course I did not change the data files when starting the rclusterf run     Why does it only report the model for a single partition every 4 minutes  It could run 56 model determinations in parallel  Things might have changed in the beta and release candidate versions of iqtree  Best wishes and many many thanks in advance  Christoph To view this discussion on the web visit https   groups google com d msgid iqtree 754EBE7A 938B 4C17 886B 4FB2514C78CB 40uni bonn de  Dear Minh  dear all  for my case I think I have solved the problem  I restarted a run with an existing huge model gz file  about 500 GB  in a ModelFinder merge Analysis  Iqtree was running for 62 hours with little progress  Since I conjectured that writing the model gz was the bottleneck  I rerun the analysis with the option  cptime 1000  which reduces the time intervals after which checkpointing data is written to the disc from 20 to 1000 seconds  The latter is about one quarter of an hour  This reduced the run time considerably  The model determination for the first 829 data blocks reduced from  62h 5m 10s to 0h 4m 27s  which is a nice speedup I would say  This speedup will only be achieved if the model gz file is very large  But for data sets with many data blocks this will be the case at some point  Maybe the default time intervals for writing checkpointing data is an overkill  Having checkpointing data every quarter of an hour should be more than sufficient  Best Christoph To view this discussion on the web visit https   groups google com d msgid iqtree C97BEC37 8D13 4735 9FD8 16E56DD7133F 40uni bonn de  To follow up on what Christoph said about the new version of IQTREE  I found that merging in IQTREE2 0 rc1 is much  much faster  In a merging analysis using 2 0 rc1  a nucleotide dataset with 1059 partitions using  m TESTNEWMERGEONLY  rcluster 10  rcluster max 1000  nt 25 took 38 hours to complete  I didn t try this exact analysis in IQTREE 1 6 x  but similar ones were running for a month before I killed them and they still had  80 days left in the estimated time remaining  This is a great improvement  but I didn t see mention of improved merging in the IQTREE2 preprint on Biorxiv  so more info would be useful  Thanks  Matt Kweskin To view this discussion on the web visit https   groups google com d msgid iqtree 6077c882 1d1d 4289 8a65 6aca68f4b541 40googlegroups com You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqt    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree CAJgYPPExc5BF4ZPaaPQmQV21eSX5UJ0mGMdfGWAOZ1ZnTLdLiw 40mail gmail com                                          Dr  Christoph Mayer Email  c    uni bonn de Tel    49  0 228 9122 403 Zoologisches Forschungsmuseum Alexander Koenig   Leibniz Institut f r Biodiversit t der Tiere   Adenauerallee 160 53113 Bonn  Germany www zfmk de Stiftung des  ffentlichen Rechts  Interimsdirektor  Prof  B  Misof Sitz  Bonn                                          You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqt    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 754EBE7A 938B 4C17 886B 4FB2514C78CB 40uni bonn de                                          Dr  Christoph Mayer Email  c    uni bonn de Tel    49  0 228 9122 403 Zoologisches Forschungsmuseum Alexander Koenig   Leibniz Institut f r Biodiversit t der Tiere   Adenauerallee 160 53113 Bonn  Germany www zfmk de Stiftung des  ffentlichen Rechts  Interimsdirektor  Prof  B  Misof Sitz  Bonn                                          You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqt    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree C97BEC37 8D13 4735 9FD8 16E56DD7133F 40uni bonn de                                          Dr  Christoph Mayer Email  c    uni bonn de  Dear All  Thanks for the discussions  I will look through these once back in about a week  Quick comments about  The model determination for the first 829 data blocks reduced from  62h 5m 10s to 0h 4m 27s  which is a nice speedup I would say  Yes indeed the default checkpoint time is too small for very large data set like this  So Christoph nicely pointed out that one should increase this with  cptime option to reduce the bottleneck of writing the checkpoint file  To follow up on what Christoph said about the new version of IQTREE  I found that merging in IQTREE2 0 rc1 is much  much faster  In a merging analysis using 2 0 rc1  a nucleotide dataset with 1059 partitions using  m TESTNEWMERGEONLY  rcluster 10  rcluster max 1000  nt 25 took 38 hours to complete  I didn t try this exact analysis in IQTREE 1 6 x  but similar ones were running for a month before I killed them and they still had  80 days left in the estimated time remaining  This is a great improvement  but I didn t see mention of improved merging in the IQTREE2 preprint on Biorxiv  so more info would be useful  This is actually a new  unpublished  feature in v2 0  where we introduce several heuristics to speed up this process  We re preparing ModelFinder2 ms about this  so more detailed descriptions will follow in the next few months  Cheers  Minh To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 4bc97bec 05fb 40cb 9b35 a751e2d178f2 40googlegroups com  Dear Minh  I would like to suggest I simple default value for the  cptime option  Most users will never look at this option  so a better default value would be good to have  Some thoughts  For large data sets which run for many days  a checkpointing ever few hours is fully sufficient  What about  cptime default parameter   number of datablocks   4  For 20 data blocks this is 80 or about 1 3 Minutes  For 1000 data blocks this is 4000s or about 1h  For 2000 data blocks this is 8000s or about 2h  Etc  Best Christoph To view this discussion on the web visit https   groups google com d msgid iqtree E84AAA28 ECDB 4C02 867B 09F09338EC3B 40univie ac at                                          Dr  Christoph Mayer Email  c maye    uni bonn de  Dear Minh  I have now experienced the ModelFinder speedup available in 2 0 rc1  and it seems to be a major improvement  but I am confused now as to how to setup the analysis correctly  It appears that the analysis options have changed compared to 1 6 x  Could you tell me how to run a merge only analysis that mimics PartitionFinder2  Specifically  I would like to do one run that only uses GTR G  rclusterf  and AICc  I thought I setup the analysis correctly  but the output suggests that the program is using GTR I G rather than GTR G only  Here are the options I used   home michael branstetter downloads iqtree 2 0 rc1 Linux bin iqtree  s aln phy  spp aln part  m TESTMERGEONLY  rclusterf 10  mset GTR G  merit AICc  mrate G  nt 72  cptime 3600 When I look at the help information for v2 0 rc1  it seems to me that the merge options should be run separately from the model test options  but I can t quite figure out how to run the analysis correctly  I m also interested in doing a run that would allow for all iqtree models to be tested  All help appreciated  Thanks  Best  Michael                                                           Michael Branstetter  PhD USDA ARS Pollinating Insects Research Unit Utah State University 5310 Old Main Hill Logan  UT 84322 5310  435  797 2588                                                           To view this discussion on the web visit https   groups google com d msgid iqtree E84AAA28 ECDB 4C02 867B 09F09338EC3B 40univie ac at  Michael  I suggest trying your partition file in nexus format if it s not already  That was the only way I was able to get merging to work with iqtree2 rc1  Matt  The merging worked for me using a raxml style format file  but iqtree used the wrong model  What settings did you use to start the analysis  Best  Michael                                                           Michael Branstetter  PhD USDA ARS Pollinating Insects Research Unit Utah State University 5310 Old Main Hill Logan  UT 84322 5310  435  797 2588                                                            I believe I made an error suggesting that nexus vs raxml style partitions make a difference  In some early attempts  I thought that was the case  but it was probably user error  I m re running a job with raxml style partitions and so far the log looks about the same as when I used nexus  If there is a difference in the results  I ll follow up  This is the command I used  iqtree 2 0 rc1 Linux bin  iqtree  s alignment phy  p partitions nexus  m TESTNEWMERGEONLY  nt 15  rcluster 10  rcluster max 1000  pre TESTNEWMERGE  cptime 1800  Hi Christoph  In version 2 0 we already implemented a better checkpointing automatically adapted to the dataset size  It will measure the time needed to write the checkpoint file  say   x  The waiting time to the next checkpoint will be set to max 60 sec  x 20   That way  IQ TREE will never spend more than 5  of the runtime for checkpointing  Does that make sense  Cheers Minh To view this discussion on the web visit https   groups google com d msgid iqtree 6A3FF99E B483 4DA3 BCE8 D7E1B08E87A5 40uni bonn de  Hi Michael  In iqtree v2 there are two new options to control the model and rate for the merging phase  Here is the relevant help usage  which you can see by running iqtree  h  PARTITION FINDER    merge Merge partitions to increase model fit   merge greedy rcluster rclusterf Set merging algorithm  default  rclusterf    merge model 1 all Use only 1 or all models for merging  default  1    merge model STR     Comma separated model list for merging   merge rate 1 all Use only 1 or all rate heterogeneity  default  1    merge rate STR     Comma separated rate list for merging   rcluster NUM Percentage of partition pairs for rcluster algorithm   rclusterf NUM Percentage of partition pairs for rclusterf algorithm   rcluster max NUM Max number of partition pairs  default  10 partitions  The two relevant options are   merge model and   merge rate  You can set    merge model all   merge rate all to revert the old  slow  behaviour of considering all models and rates  Or you can do    merge model GTR   merge rate G to only consider GTR G  We re still in the process of preparing ModelFinder2 ms  Full details will follow  Cheers  Minh To view this discussion on the web visit https   groups google com d msgid iqtree CAJgYPPHuWogZExKAZnWfg6 oZiNO7BEvUenNKo7d0232D8 2B3Tg 40mail gmail com  Hi Minh  Thanks for the help  I had checked the help information  but what remains unclear to me is the relationship between the   m  and    merge  settings  since these seem to be separate parameters in iqtree2  When I attempted a run using    merge rclusterf  only  without the   m  option  iqtree2 did not perform the MF analysis  it just did a tree search  I have only been able to get the MF analysis to work when I use the old   m TESTMERGEONLY  setting  It does appear that doing  m TESTMERGEONLY  followed by    merge model GTR   merge rate G  produces the correct outcome  limiting the merge model to GTR G only  However  after the merging  it tests all available models across the partitions  Do I need to set   mset  and  mrate  in addition to  merge model  and  merge rate   And what about    merge rclusterf  versus   rclusterf 10   Do I need both of these or just one  Perhaps I just need to wait for the MF2 paper documentation to get the answers I need  but I would appreciate the any clarity you can provide  Thanks  Michael                                                           Michael Branstetter  PhD USDA ARS Pollinating Insects Research Unit Utah State University 5310 Old Main Hill Logan  UT 84322 5310  435  797 2588                                                           To view this discussion on the web visit https   groups google com d msgid iqtree 6762F488 E24B 416C 99D3 D9A20403AA5F 40univie ac at ",0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0
"QYhXz9_52Lg","4/19/2021 18:17:59","2/19/2021","Modelfinder heuristic Hi Minh  My question is related to at least one other question already asked here  When running Modelfinder on my data with IQ TREE 2 1 2 with the following command  iqtree  s strict fas  mset LG  madd C10 F G C20 F G C60 F G LG C10 F G LG C20 F G LG C60 F G all mixture models are ignored in the analysis  ModelFinder will test up to 32 protein models  sample size  170140      ModelFinder will test up to 32 protein models  sample size  170140      No  Model  LnL df AIC AICc BIC 1 LG 2943070 717 109 5886359  435 5886359  576 5887454 272 2 LG I 2753622 735 110 5507465 471 5507465  614 5508570  352 3 LG G4 2663121 791 110 5326463 582 5326463  725 5327568  463 4 LG I G4 2654337 413 111 5308896  825 5308896 972 5310011  751 5 LG R2 2681429 118 111 5363080 235 5363080 381 5364195 161 6 LG R3 2653494 544 113 5307215 088 5307215  239 5308350  102 7 LG R4 2648416 029 115 5297062 059 5297062  215 5298217  162 8 LG R5 2647403 863 117 5295041  726 5295041 888 5296216  918 9 LG R6 2647294 536 119 5294827 073 5294827 241 5296022 353 10 LG R7 2647250 998 121 5294743 997 5294744 170 5295959 366 11 LG R8 2647243 450 123 5294732  901 5294733  080 5295968 359 23 LG F R7 2645420 440 140 5291120 881 5291121 113 5292527 093 WARNING  Log likelihood  2 64544e 06 of LG F R8 worse than LG F R7  2 64542e 06 24 LG F R8 2645438 749 142 5291161 499 5291161 738 5292587 800 Akaike Information Criterion  LG F R7 Corrected Akaike Information Criterion  LG F R7 Bayesian Information Criterion  LG F R7 Best fit model  LG F R7 chosen according to BIC The same command in IQ TREE 1 6 12 searches all of the models in the list  ModelFinder will test 32 protein models  sample size  170140      No  Model  LnL df AIC AICc BIC 1 LG 2942916 704 109 5886051  408 5886051  549 5887146 245 2 LG I 2753715 827 110 5507651 654 5507651 798 5508756 536 3 LG G4 2663413 860 110 5327047  719 5327047  863 5328152 601 4 LG I G4 2654660 907 111 5309543  814 5309543  960 5310658 740 5 LG R2 2681694 363 111 5363610  726 5363610  872 5364725 652 6 LG R3 2653821 823 113 5307869 645 5307869 797 5309004 660 7 LG R4 2648733 870 115 5297697 739 5297697 896 5298852 843 8 LG R5 2647735 096 117 5295704 191 5295704 354 5296879 383 9 LG R6 2647734 725 119 5295707 449 5295707  617 5296902  730 14 LG F 2939855 844 128 5879967 688 5879967 882 5881253 368 15 LG F I 2750522 258 129 5501302  516 5501302  713 5502598 241 16 LG F G4 2661348 862 129 5322955  724 5322955  921 5324251 448 17 LG F I G4 2652729 180 130 5305718 359 5305718  559 5307024  128 18 LG F R2 2679422 706 130 5359105  413 5359105  613 5360411 182 19 LG F R3 2651895 306 132 5304054  613 5304054  819 5305380 470 20 LG F R4 2646869 963 134 5294007 926 5294008 138 5295353 872 21 LG F R5 2645895 794 136 5292063 589 5292063  808 5293429  624 22 LG F R6 2645895 697 138 5292067 395 5292067 621 5293453 519 Model C10 F G is alias for    clipped    27 C10 F G 2658098 597 139 5316475 194 5316475  423 5317871  362 Model C20 F G is alias for    clipped    28 C20 F G 2612765 914 149 5225829  829 5225830  092 5227326 441 Model C60 F G is alias for    clipped    29 C60 F G 2577243 864 189 5154865 728 5154866 150 5156764 115 Model LG C10 F G is alias for    clipped    30 LG C10 F G 2596404 886 139 5193087  772 5193088  001 5194483 940 Model LG C20 F G is alias for    clipped    31 LG C20 F G 2576136 297 149 5152570 594 5152570  857 5154067  206 Model LG C60 F G is alias for    clipped    32 LG C60 F G 2560608 678 189 5121595 356 5121595  778 5123493  743 Akaike Information Criterion  LG C60 F G Corrected Akaike Information Criterion  LG C60 F G Bayesian Information Criterion  LG C60 F G Best fit model  LG C60 F G chosen according to BIC From what I understood from your past answers is that IQ TREE 2 has a heuristic that filters out non promising models  Is this the reason why they are not tested  In my example  the mixture model favoured over the FreeRate model  in IQ TREE 1 6 12   Is there a way to switch off this heuristic in IQ TREE 2  Thanks a lot  Alex  Hi Alex  This is a bug in 2 1 2  We ll fix it  Thanks  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 16f13642 d3e7 470d 9f5a f9ce11285947n 40googlegroups com  Hi Minh  Good to know   thanks a lot  Cheers  Alex ",0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"t3SWk4U_E5o","4/19/2021 18:20:24","5/6/2020","Question about an error message with a tree topology test   au command and bp RELL Hi everyone  I am using IQ Tree v1 6 7 on a GNU environment and I ve had some trouble doing a topology test  I would like to perform the weighted KH  SH and the approximately unbiased  AU  tests to my data  Here below is the command line I used  and the following error message  command line  iqtree  s  alignment aln   z  trees set   n 0  zb 1000  zw  au error message  The AU test is temporarily disabled due to numerical issue when bp RELL 0 What does this error message mean  and how can I fix this issue  Kind regards Gabriel  Hi Gabriel  Quite simple answer  use the latest version  either v1 6 12 or v2 0 4  if you want more features in v2 0 4  whereas v1 6 is more stable   Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 6011a7f7 2750 48b2 9136 23679b8c717e 40googlegroups com  Hi Minh  Thank you very much for your answer  Cheers Gabriel Le jeudi 7 mai 2020 02 36 09 UTC 2  Minh Bui a  crit   Hi Gabriel  Quite simple answer  use the latest version  either v1 6 12 or v2 0 4  if you want more features in v2 0 4  whereas v1 6 is more stable   Cheers Minh On 7 May 2020  at 1 47 am  Gabriel DUPRE   gabriel    gmail com   wrote  Hi everyone  I am using IQ Tree v1 6 7 on a GNU environment and I ve had some trouble doing a topology test  I would like to perform the weighted KH  SH and the approximately unbiased  AU  tests to my data  Here below is the command line I used  and the following error message  command line  iqtree  s  alignment aln   z  trees set   n 0  zb 1000  zw  au error message  The AU test is temporarily disabled due to numerical issue when bp RELL 0 What does this error message mean  and how can I fix this issue  Kind regards Gabriel You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqt    googlegroups com ",0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0
"trcKeFD3ZmQ","4/19/2021 18:22:20","4/15/2020","Re   iqtree  input file   25 datasets    output file   25 tree   Hi Adeline  If you have 25 Nexus files all in a folder  you should be able to generate 25 trees using a single command  iqtree  S ALN DIR  I e  the   S  command is what you need  More details in the command reference  but you can add whatever other commands you want to apply to all of them there too  Rob On Wed  15 Apr 2020 at 01 00  Adeline   adelin    orange fr   wrote  Hello  I have in a file 25 datasets in NEXUS format  In each dataset there are 47 alignments of protein sequences  Is it possible with this input file to generate a tree for each dataset  with iqtree  Or do I have to do it manually  You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree fec716d5 e99c 427e a748 d70a44290c96 40googlegroups com Rob Lanfear Division of Ecology and Evolution  Research School of Biology  The Australian National University  Canberra www robertlanfear com  Hi Adeline  I m not aware that NEXUS format allows for multiple replicate datasets in file  But one way you might do this  it does depend on your file being in the standard nexus format though  is to define a partition file that specifies the limits of each dataset within your file  then use this approach  iqtree  s ALN FILE  S PARTITION FILE This is probably not the best approach  since it means you won t be able to specify partitions within each dataset  and with 47 genes it s probably a good idea to consider partitioned analyses  I d recommend instead just splitting the 25 datasets out into 25 individual nexus files  then running replicate analyses  either with or with a for loop or just 25 command lines in a single shell script  with correctly specified partitions  and full model selection through MF MERGE Rob On Thu  16 Apr 2020 at 01 18  Adeline adelin    orange fr wrote  I have 25 replicate datasets in one file  so I don t know how to have 25 trees from a file  Le mercredi 15 avril 2020 01 20 45 UTC 2  Rob Lanfear a  crit   Hi Adeline  If you have 25 Nexus files all in a folder  you should be able to generate 25 trees using a single command  iqtree  S ALN DIR  I e  the   S  command is what you need  More details in the command reference  but you can add whatever other commands you want to apply to all of them there too  Rob On Wed  15 Apr 2020 at 01 00  Adeline   adelin    orange fr   wrote  Hello  I have in a file 25 datasets in NEXUS format  In each dataset there are 47 alignments of protein sequences  Is it possible with this input file to generate a tree for each dataset  with iqtree  Or do I have to do it manually  You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqt    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree fec716d5 e99c 427e a748 d70a44290c96 40googlegroups com Rob Lanfear Division of Ecology and Evolution  Research School of Biology  The Australian National University  Canberra www robertlanfear com You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree b3ac2485 dfb2 4c44 85e5 0ecf211423d4 40googlegroups com ",1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"x2j3_q7IkvQ","4/19/2021 20:48:43","2/19/2021","Interpreting the brunch lengths difference between using PoMo and not using PoMo Hello  I tried to built phylogeny using concatenated variant sites  only SNPs  for  30 con generic species some are multiple sampled  some are not   I did three runs  1  input with aligned fasta with only ATCGs  choose the major allele if it s heterozygous  2  input with aligned fasta with IUPAC ambiguity codes 3  input with count file using PoMo  Treat each individual as a population  so the count file only contains 0 1 2  diploid   Attached the results  The topology remains almost the same  What I am curious about is that the Brunch lengths varies a lot  1    2    3   I found it s hard to explain this given that including heterozygous information should more or less increase the diversity level  But the results show the opposite  What s your opinion about why this happened  Please point out if did the analysis in a totally wrong way  I m not sure whether 3  is a good way to do the job because the model requires specifying population size which could not be less than 3  What s a better way to do it if any   Dear Wu  Your trees don t have the scale bar   Am I right  that the scale bars have the same length  That means  the branch lengths can be visually comparable  Dominik will be able to say something about 3  Run 1 is certainly sensible  Run 2  IUPAC has a different interpretation  it s not about SNP  See http   www iqtree org doc Frequently Asked Questions how does iq tree treat gapmissingambiguous characters   For example  R means that the character can be either A or G  but we are unsure which one  But under SNP  R would be A and G  So using IUPAC to  trick  IQ TREE is not appropriate  Instead  one should introduce a new state in the Markov process that represent  A and G   That explains why you got shorter branch lengths in Run2  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 23403c49 a972 48c9 b7ab cd15371ed876n 40googlegroups com  3   PoMo pdf   2   IUPAC pdf   1   atcg ONLY pdf   Thank you very much for replying Minh  Sorry I can not understand  one should introduce a new state in the Markov process that represent  A and G    Could you please explain a bit more  Or is there already a method to do this that I can refer to  Also   hi Dominik  I am very interested in hearing your opinion about how to fit PoMo to this dataset  My best   Hi Wu  I m not aware of method software that can do this directly  But let s assume you have diploid genomes  Then each site can be homozygote  A  G  C  T  or heterozygote  R     That means  there are 10 states  A  C  G  T  R  Y  W  S  M  K  where R   A G  Y   C T  W   A T  S   G C  M   A C  K   G T  What you can do in IQ TREE is to convert these 10 states into character 0  1  2     9  So the converted alignment will have these digits  When you load this alignment in IQ TREE  it will be detected as morphological alignment  and now you can use a morphological model to run the analysis  http   www iqtree org doc Tutorial binary morphological and snp data   There are just 3 morphological models in IQ TREE  MK  ORDERED and GTR  Do not use ORDERED which is not designed to such data  Also MK is too simplified  GTR is a bit too complex  but it depends on the phylogenetic information of your alignment  e g  sequence length   I guess you can use GTR if you alignment is long enough  I think a model complexity somewhere between MK and GTR will be desirable  but this can be topic of a future research  Cheers Minh  I just saw that RAxML NG can do this in their wiki  GENOTYPE   https   github com amkozlov raxml ng wiki Input data state encoding  order It s however unclear to me what model they use  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree F486EF57 513A 4F14 949E 1D53A5CFCC53 40univie ac at  Thank you Minh  Those information are very helpful     What you can do in IQ TREE is to convert these 10 states into character 0  1  2     9  So the converted alignment will have these digits  This sounds like the 10 states are isolated states  so the transition possibility between any two of them is the same  Will the GTR model possibly aware that  say A    W has a higher possibility than A    T  I ll explore the RAxML NG as well  My best   Hi  Did I understand correctly that you run the analyses with SNP data only  That is  did you exclude sites where all species individuals have the reference base  In this case  it is not really appropriate to use PoMo  because it needs to infer the heterozygosity in the data  The heterozygosity can only be inferred correctly if all sites are included in the alignment  Of course  one could filter  let s say  the first and second codon positions  But one cannot filter for sites with mutations  With respect to the branch lengths  the absolute branch lengths of PoMo differ a lot from other models  One can convert the branch lengths using the procedure described in  1   Section 2 8  The relative branch lengths are also different  Terminal branches are expected to be shorter with PoMo  because polymorphisms are correctly interpreted  and not mistaken for substitutions  Finally  the population size parameter N is more of a discretization factor describing how many bins are used to approximate the population dynamics  So  using 3 would be perfectly fine in your case  I hope I could help  Let me know if you have further questions  Best  Dominik  1  Schrempf  D   Minh  B  Q   De Maio  N   von Haeseler  A     Kosiol  C   Reversible polymorphism aware phylogenetic models and their application to tree inference  Journal of Theoretical Biology  407    362 370  2016   http   dx doi org 10 1016 j jtbi 2016 07 042 ",0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"zkoXqNJyFhs","4/19/2021 20:55:37","2/27/2021","sCF of 100 for an alternative topology Hello  I m trying to interpret some concordance factor values I got for a phylogeny combining 3 differents datasets  nuclear  mitochondrial and plastid loci   My idea is to use concordance factors to study the discrepancies between the topology I got for each dataset  Maybe the plastid dataset doesn t show an alternative topology but still some plastid sites support the combined topology etc    However  I m a bit puzzled looking at the result from one node  This branching isn t supported by one of the dataset  gCF 66   not the topology presented in every individual tree  but the sCF value is 100  How is that possible  If all sites supports this relationship  why it is not the one represented in every datasets  What am I missing  Pauline  Hi Pauline  Can it be some display issue  Indeed I wouldn t expect any branch to have sCF of 100   unless in an ideal case  Because you have only 3 trees here  can you post the zoom in figure at this part of the trees containing that suspicious branch  and map the 3 locus wise sCF values  This is to understand more the situation  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 4552639d 8fa8 4e35 bef9 3a61a8637fd1n 40googlegroups com  Hi Minh  branches are really short so it s not really informative anyway but I d like to be sure I m understanding concordance factors right    For next time  For uninformative branches  I would expect values around 33  So here are zoom in of the different trees  Full is the tree I was talking about  3 datasets  and then mito chloro nucl present the respective loci wise values for each dataset  lot of short loci  that s why we decided to compare the 3 whole datasets   Best regards  Pauline  Hi Pauline  There are 3 numbers on each branch  Can you help tell me specifically  what is the  problematic  branch  And what number are what  Minh To view this discussion on the web visit https   groups google com d msgid iqtree fd1bffc4 322f 4304 a0eb e07417f1c1acn 40googlegroups com  chloro png   nucl png   full png   mito png   Hi Minh  sorry  the numbers are UFbootstrap values gCF sCF  The branch I was talking about is the one between Awim3 and Mavim 2   Hi Minh  do you have any insight about my issue  Thank you very much  Pauline ",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0
"3ZuFNWifhbY","4/19/2021 20:57:45","12/22/2020","Errors of Segmentation Fault and Numerical underflow  lh branch  Hi there  I ve been trying to create a gene tree using IQTREE to run on an alignment file of 367 proteins  I ve run it in various different ways in order to to try get it to run  but I get an error every time  The first command was  iqtree  s homologs trimmed aligned faa  nt AUTO This resulted in the error  Numerical underflow  lh branch   Run again with the safe likelihood kernel via   safe  option  see error fite   ntauto  When I run with the  safe option I get a similar response  phylokernelnew h 3159  double PhyloTree  computeLikelihoodFromBufferSIMD    VectorClass   Vec4d  nstates   20  FMA   true  SITE MODEL   false   Assertion  std  isfinite tree lh      Numerical underflow for lh from buffer   failed   see error file   ntautosafe  I saw that these issues could be potentially circumvented by using the  m TEST flag   which I attempted using the command  And got the error  ERROR  STACK TRACE FOR DEBUGGING  ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL ABORTED  see error file  ntautosafemtest  NB that this command didn t  finish   i e  it stayed stuck and didn t retrun to a newline after the error message was displayed I ve also attached the alignment file in here  I hope you can help  I look foward to using your tool   Here are those log files  I ve had to add an  txt extension on the end of the  faa alignment file in order to be able to upload it  Cheers   Hi Megan  Sorry for the long delay  I m back from a long break  I reran IQ TREE v1 6 12 your same command line on a MacBook and it completed without any crash  The best model is LG F I G4  Attached is the log file  So I couldn t reproduce this behaviour  Cheers Minh ",0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0
"81PJzJaxBT4","4/20/2021 5:21:42","1/9/2019","Concordance Factors  input file format not recognized Hi Binh  I was excited to try the new option for calculating concordance factors and downloaded 1 7 beta7 MacOSX  I was running a test to see how it would go to start with single locus alignments and used  p ALN DIR   prefix concat  bb 1000  nt 4   There were two issues  First there were only 3 files in the directory but iqtree seemed to detect 4  Second  I received an error message indicating the sequence format was unknown  This happened three times with three different formats  fasta  full nexus  simplified nexus  The text from the log file pasted in below  IQ TREE multicore version 1 7 beta7 for Mac OS X 64 bit built Dec 18 2018 Developed by Bui Quang Minh  Nguyen Lam Tung  Olga Chernomor  Heiko Schmidt  Dominik Schrempf  Michael Woodhams  Host  beliskner be  AVX2  FMA3  8 GB RAM  Command    iqtree  p ALN DIR   prefix  bb 1000  nt 2 Seed  986462  Using SPRNG   Scalable Parallel Random Number Generator  Time  Wed Jan 9 17 48 07 2019 Kernel  AVX FMA   2 threads  4 CPU cores detected  Reading 4 alignment files in directory ALN DIR Reading alignment file ALN DIR  DS Store     ERROR  Unknown sequence format  please use PHYLIP  FASTA  CLUSTAL  MSF  or NEXUS format It seemed to be reading the directory as the first file  Test analyses with example files were working fine  Thanks for any suggestions  Cheers  Sarah  Hi Sarah   DS Score is a hidden index file in Mac OS  which is generated for all indexed folders  Please simply remove this file from the folder  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To post to this group  send email to iqt    googlegroups com Visit this group at https   groups google com group iqtree For more options  visit https   groups google com d optout  Hi  I tried to run the  p and  S commands to infer the concordance factor  As Sarah posted  I had the same problem with the  DS Score file  so I deleted it  However  when I tried to run each command again  a log file was created    and I had a similar problem because iqtree is reading this new log file as one of my alignments  so it is not working yet  Do you know how can I fix this  Thanks   Giovani Command   Applications iqtree 2 1 2 MacOSX bin iqtree2  S  Users giovani Desktop mult nex   prefix loci  T AUTO Seed  483317  Using SPRNG   Scalable Parallel Random Number Generator  Time  Tue Jan 26 15 13 23 2021 Kernel  AVX FMA   auto detect threads  16 CPU cores detected  Reading 11 alignment files in directory  Users giovani Desktop mult nex Reading alignment file  Users giovani Desktop mult nex loci log     ERROR  Unknown sequence format  please use PHYLIP  FASTA  CLUSTAL  MSF  or NEXUS format  Are you running IQ TREE from the same folder that stores the alignment files  If so  simply change the current directory before running IQ TREE  This will avoid loci log being written in that folder  Cheers Minh To view this discussion on the web visit https   groups google com d msgid iqtree ca85efcc 37e3 4dc0 a304 2579299a0a02n 40googlegroups com  It worked  Thank you very much  ",1,1,0,1,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0
"c2UCd-MiL1g","4/20/2021 5:25:33","12/27/2020","Re   iqtree  How can I get a file called PARTITION FILE in tutorial  Hi Hiroto  Sorry for the long delay  I m back from a long break  Here you can use the same partition file for  S option  it accepts either a partition file  or a directory   See http   www iqtree org doc Concordance Factor putting it all together   So something like  iqtree  s myfilename phy  S myfilename nex  nt AUTO   prefix loci Minh On 27 Dec 2020  at 2 56 pm  Hiroto   s8163    gmail com   wrote  Hi  thanks for reading  I am trying to get concordance factors on my phylogenetic tree  First  I tried to get species tree described in tutorial  inferring species tree part  and ran iqtree  s myfilename phy  p myfilename nex   alrt 1000  B 1000  bnni  nt AUTO This command looked like to work well  so I tried to go to the next step  inferring gene locus tree part   Though  I got stuck here what to do with  S option  Tutorial says it direct iqtree to a DIRECTORY which contains PARTITION FILE  but what I have now is NEXUS file with partition information  So  I don t know what kind of file I should input in this step  Is a PARTITION FILE in this step  inferring gene locus tree part  completely same as the one used in  inferring species tree  part   or one of the outfiles output from the part   Always thanks for your great support Best wishes  Hiroto tai You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 79452538 22cb 45ae b6e9 1e48422a61dcn 40googlegroups com  Thanks for the response  Dr Minh   Though the  inferring species tree  part successfully ran with  p option and my NEXUS file  the  inferring gene locus trees  part somehow stops with  S option and the same NEXUS file  It generates some error messages described in the log file attached to this message  I wish you could tell me what kind of problems the WARNING message may indicate  please  Best wishes  Hiroto Tai 2021 1 18     13 38 32 UTC 9 Minh Bui  ",0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,1
"e_RyzLD9EuU","4/20/2021 5:27:56","2/17/2021","directory of alignments Hi all  We are trying to run IQ TREE on directories of alignments to obtain both ML gene trees and bootstrap trees  We are running into a couple challenges   1  It looks like the bootstrap support values get mapped on the ML trees in the  trees file  Is there any way to get the bootstrap trees as well  We may want to use these in downstream ASTRAL analyses   2  IQ TREE crashed when we tried to run another directory of alignments  I am attaching the  log file as reference  Any thoughts  Best wishes  Chris  Hi Chris  On 18 Feb 2021  at 3 49 am  blai     gmail com blai    gmail com   wrote  Hi all  We are trying to run IQ TREE on directories of alignments to obtain both ML gene trees and bootstrap trees  We are running into a couple challenges   1  It looks like the bootstrap support values get mapped on the ML trees in the  trees file  Is there any way to get the bootstrap trees as well  We may want to use these in downstream ASTRAL analyses  Use  wbt option   rite ootstrap rees   If you want bootstrap trees with branch lengths  use  wbtl option   2  IQ TREE crashed when we tried to run another directory of alignments  I am attaching the  log file as reference  Any thoughts  Does it work  if you use a  for loop  to run IQ TREE on each alignment  Unfortuntately I have no idea why  Some user s  also reported similar problem  and they could overcome by running IQ TREE for each alignment separately  Cheers Minh Best wishes  Chris You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 57d78c8e efe5 4b14 b563 98b0638037e8n 40googlegroups com  loci log  ",1,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0
"gvPYKhD7Qrc","4/20/2021 5:33:18","1/20/2021","IQ TREE crashed with signal aborted during NNI search Hi there  I am trying to estimate a tree with constrained topology  however IQ TREE crashes in the NNI search for the 20 best initial trees                                                                         INITIALIZING CANDIDATE TREE SET                                                                        Generating 99 parsimony trees    1287 488 second Computing log likelihood of 99 initial trees     1235 368 seconds Current best score   512746 393 Do NNI search on 20 best initial trees lambda    0 000 NEGATIVE BRANCH len    0 001 rate   2 830 with the error  ERROR  phylosupertreeplen cpp 383  virtual void PhyloSuperTreePlen  computeFuncDerv double  double    double     Assertion  0  failed  ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL ABORTED ERROR      For bug report please send to developers  ERROR      Log file  constrained  log ERROR      Alignment files  if possible  scripts IQTREEconstrained HPC SANGER sh  line 32  33605 Aborted  home jc454633 applications iqtree 2 1 2 Linux bin iqtree2  s    3d final alignments concat concat aln fasta   prefix constrained   p    3d final alignments concat partitions txt  g    pruned constrain concat gene part tre  m MFP MERGE  B 1000  T AUTO I am running the analysis on a RHEL Linux cluster  I ve tried re running the analysis twice but the same error occurs  Any idea what the issue might be  Many thanks Lizzy  Hi Lizzy  Thanks for this bug report  This seems to be a rare issue  I never saw it happening before  I just checked the IQ TREE code and the error message occurred within the partition model  that Olga Chernomor implemented  So Olga might be able to say something here  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree b92fdebe 253b 44ae b4a6 cad324d10adan 40googlegroups com  Dear Lizzy  I think  this assertion might have been raised due to numerical issues  rather than a bug in the software  but I ll have to investigate it in more details  Does your data have many missing sequences or very gappy alignment  Cheers  Olga To view this discussion on the web visit https   groups google com d msgid iqtree CA 2B 2B 8MQPnnffby 2B4ZTrvsadFvY 3DOw 2BUKybm 2Bv74uiTK1bOZfkg 40mail gmail com  Hi Olga and Minh  Thanks very much for getting back to me  It is a gappy alignment  so this may be the issue  I will rerun the analyses with a different alignment and see if that fixes the issue  Many thanks  Lizzy ",0,1,0,1,0,0,1,0,0,0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0
"GXnCRUBPCdw","4/20/2021 5:35:55","1/16/2021","WARNING  Estimated model parameters are at boundary that can cause numerical instability  Hi  IQ TREE developers  Thank you for providing us this very fast running phylogenetic analysis software  As I wrote in the title  I m getting this error below and can t get out of it  WARNING  Estimated model parameters are at boundary that can cause numerical instability  This appeared while creating gene locus trees using  S option as below iqtree  s myfilename phy  S myfilename partitions txt   prefix loci  T AUTO Of course  I ve already created a species tree for this data set using  p option as below  it actually worked well  I think  iqtree  s myfilename phy  p myfilename nex   prefix concat  T AUTO I really hope someone would help me with this error message  Best wishes  Hiroto Tai  Hi Hiroto  Someone else also reported the same issue with  S option  but unfortunately we couldn t figure out why  So I suggest that you use a  for loop  to construct individual gene trees  The individual tree files can then be concatenated together  Cheers  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree dd4c1db0 363f 4d36 adbb 834ea5453269n 40googlegroups com  Hi  Dr Minh  Thanks for the suggestion  Though it may be also a bit tough to split the sequences to separate files  I ll try anyway  Best  Hiroto Tai 2021 1 28     11 50 12 UTC 9 Minh Bui  ",1,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0
"hjsBusT_xng","4/20/2021 5:45:17","1/7/2021","BUG IQ TREE CRASHES WITH SIGNAL ABORTED IQ TREE multicore version 2 0 7 for Linux 64 bit  Command  iqtree  s FcC supermatrix fas  m LG C60 FO R  ft guide tree  n 0  T AUTO Seed  666986  Using SPRNG   Scalable Parallel Random Number Generator       COMPUTING SITE FREQUENCY MODEL BASED ON TREE FILE guide tree Model LG C60 FO R is alias for LG POISSON G FMIX C60pi1 1 0 0169698865 C60pi2 1 0 0211683374 C60pi3 1 0 0276589079 C60pi4 1 0 0065675964 C60pi5 1 0 0141221416 C60pi6 1 0 0068774834 C60pi7 1 0 0146909701 C60pi8 1 0 0067225777 C60pi9 1 0 0018396660 C60pi10 1 0 0102547197 C60pi11 1 0 0230896163 C60pi12 1 0 0057941033 C60pi13 1 0 0125394534 C60pi14 1 0 0204526478 C60pi15 1 0 0070629602 C60pi16 1 0 0117982741 C60pi17 1 0 0068334668 C60pi18 1 0 0433775839 C60pi19 1 0 0318278731 C60pi20 1 0 0222546108 C60pi21 1 0 0102264969 C60pi22 1 0 0150545891 C60pi23 1 0 0134159878 C60pi24 1 0 0148552065 C60pi25 1 0 0239111516 C60pi26 1 0 0128776278 C60pi27 1 0 0222318842 C60pi28 1 0 0247444742 C60pi29 1 0 0214274810 C60pi30 1 0 0115001882 C60pi31 1 0 0076017389 C60pi32 1 0 0130258568 C60pi33 1 0 0093701965 C60pi34 1 0 0467194264 C60pi35 1 0 0441940314 C60pi36 1 0 0322263154 C60pi37 1 0 0402999891 C60pi38 1 0 0150234227 C60pi39 1 0 0104589903 C60pi40 1 0 0214742395 C60pi41 1 0 0154957836 C60pi42 1 0 0101789953 C60pi43 1 0 0227980379 C60pi44 1 0 0123204539 C60pi45 1 0 0066777583 C60pi46 1 0 0004150083 C60pi47 1 0 0344385130 C60pi48 1 0 0113663379 C60pi49 1 0 0127143049 C60pi50 1 0 0124323741 C60pi51 1 0 0262124415 C60pi52 1 0 0064994957 C60pi53 1 0 0103203293 C60pi54 1 0 0142463512 C60pi55 1 0 0215600067 C60pi56 1 0 0199150700 C60pi57 1 0 0038964200 C60pi58 1 0 0113448855 C60pi59 1 0 0128595846 C60pi60 1 0 0117656776  FO R WARNING  Both Gamma and FreeRate models were specified  continue with FreeRate model NOTE  419084 MB RAM is required  Measuring multi threading efficiency up to 56 CPU cores ERROR  phylotreepars cpp 63  void PhyloTree  computePartialParsimonyFast PhyloNeighbor    PhyloNode     Assertion   aln  ordered pattern empty    failed  ERROR  STACK TRACE FOR DEBUGGING  ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL ABORTED ERROR      For bug report please send to developers  ERROR      Log file  FcC supermatrix fas log ERROR      Alignment files  if possible   Hi there  Thanks for the report  Can you please check  if it works in v1 6 12  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree b0d65cb5 b89a 4941 8892 624a680a89f2n 40googlegroups com ",0,0,1,1,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0
"ItU0XxBKOr4","4/20/2021 5:49:42","1/13/2021"," Partition model has worse fit than single model  warning Hello  I was hoping to get some help about the  Partition model has worse fit than single model  warning  I have a large  sparse DNA matrix  4 510 taxa x 48 167 bp  62 genes  93  missing data   It s a rather unusual dataset  a very small number of taxa are completely sampled for all genes  from next gen sequencing   and a very small number of genes are nearly completely sampled for all taxa  from Sanger sequencing data   and the rest of the data are missing  I m hoping to combine these two sources to enable broad taxon sampling across many genes  I was able to get IQTREE to finish in a reasonable amount of time  about a week with 18 threads  with an unpartitioned analysis  Now I am trying a partitioned analysis with one partition per gene  iqtree  s alignment phy  bb 1000  nt 32  spp gene blocks nex  redo After model finder finished  it issued these two warnings  WARNING  Partition model has worse fit than single model  WARNING  Add MERGE to  m option to increase model fit  With this type of data  is there any a priori expectation that a simple concatenated analysis without partitions would be better than partitioning by gene  Thanks   Hi there  Whether or not there is a prior expectation like this  I can t say  You will only know after running the analysis  But 93  missing data in your data sound like the main reason for the overfitting of partition models  As the WARNING said  it s better if you merge the partitions together with e g    m MFP MERGE option  It implements the PartitionFinder algorithm  which tries to reduce the number of partitions to avoid over parameterization  Perhaps you can try the relaxed clustering algorithm to speed up this analysis  All these are documented here  http   www iqtree org doc Advanced Tutorial choosing the right partitioning scheme Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 240566d8 edb1 43fb 826c 8b492e85cfacn 40googlegroups com  Hi Minh  Thanks so much for getting back to me about this  I did go ahead and try with MFP MERGE  It ran for a few days  then crashed before finishing the merge with  WARNING  Too many iterations in tqli  followed by  ERROR  Numerical underflow  lh branch   Run again with the safe likelihood kernel via   safe  option   There were also several instances of   WARNING  ABNORMAL TERMINATION IN LNSRCH   Here is a link to the output  https   www dropbox com s uwrmyc7hkdbi6nd plastid gene blocks nex log dl 0 I have not tried yet with the relaxed clustering algorithm  Do you think from the results so far though  that it may be better to just do the concatenated analysis without partitioning on this dataset  Best  Joel  Hi Joel  It sounds like your very gappy alignments caused numerical issues if using complex models  If there is little information to estimate parameters of very complex models  IQ TREE might struggle and many WARNINGs like this are a good indicator of over parameterization  Therefore  Yes I d recommend just to use a single model without partitioning for your dataset  Minh To view this discussion on the web visit https   groups google com d msgid iqtree 42d195f9 ab5c 4a41 95f6 367c69b0a90cn 40googlegroups com  Hi Minh  I see  thanks so much for the advice  Best  Joel ",0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0
"pAqCqoBRIQ8","4/20/2021 11:22:35","1/8/2021","AU test clarification Hi  Newbie here  I d be grateful if could you clarify some points about the AU test in IQTree  I am using v2 1 2   1  If I want to test multiple constraints  like in 5 7 of the manual  must I  process  my constraint files first to produce  treefile  which are then concatenated into a  treels  In other words  can I circumvent a step by doing iqtree  s  fasta   z  treels   m GTR G   te  unconstrained ML treefile   zb 1000  au Where  treels  consists of the raw Newick constraints   1 constr    2 constr    3 constr   and not  1 constr treefile    2 constr treefile    3 constr treefile    2  When I run the AU test with a file containing many constraints  are the p values derived from comparing each tree to the best tree of the lot  regardless of whether constrained or unconstrained   Or is it from comparing each tree to the unconstrained  I am trying to test every constrained topology to one single maximum likelihood unconstrained tree  i e  many 1v1 comparisons  Thank you very much   Hi there  Heiko may give some more insights  but here are my quick answers  On 9 Jan 2021  at 1 02 am  grape   joyoon    gmail com   wrote  Hi  Newbie here  I d be grateful if could you clarify some points about the AU test in IQTree  I am using v2 1 2   1  If I want to test multiple constraints  like in 5 7 of the manual  must I  process  my constraint files first to produce  treefile  which are then concatenated into a  treels  In other words  can I circumvent a step by doing iqtree  s  fasta   z  treels   m GTR G   te  unconstrained ML treefile   zb 1000  au Where  treels  consists of the raw Newick constraints   1 constr    2 constr    3 constr   and not  1 constr treefile    2 constr treefile    3 constr treefile    No  you cannot do this  You would need to run separate tree search for each of the constraint trees  as shown in the tutorial  to generatee 1 constr treefile etc  And then concatenate the treefile s  into one file for the AU test  2  When I run the AU test with a file containing many constraints  are the p values derived from comparing each tree to the best tree of the lot  regardless of whether constrained or unconstrained   Or is it from comparing each tree to the unconstrained  It will only compare the trees in your treels file  So make sure to have the unconstrained tree in this set  If not  it may happen that a tree is not be rejected even if it is much worse than the unconstrained ML tree  because it is seen as not much worse than the best tree in the set  I am trying to test every constrained topology to one single maximum likelihood unconstrained tree  i e  many 1v1 comparisons  The AU and SH tests are designed for multiple testing  So you shouldn t actually do many 1 by 1 comparisons  but just put them all into one comparision  Cheers Minh Thank you very much  You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 98dc5f61 71df 4e37 84f7 42b537de5ac1n 40googlegroups com  Hi  Many thanks for your reply  I did consider concatenating the unconstrained  along with all my other  treefiles  into a single  treels to test all my constraints at once  as you say here  But I was hesitant because I couldn t be sure that the unconstrained ML tree was the best tree in the set  i e  one of my constraints may have a higher log likelihood value than the unconstrained ML  Ideally I would like to put all constraints in a single test comparison  but I need to make sure that each constraint is being compared to the unconstrained specifically  and not any other constraint in the group that  by chance  happens to have a higher LL  What would you suggest is the best way to go  Again  thanks so much   really appreciate it   HI there  On 19 Jan 2021  at 1 48 am  grape   joyoon    gmail com   wrote  Hi  Many thanks for your reply  I did consider concatenating the unconstrained  along with all my other  treefiles  into a single  treels to test all my constraints at once  as you say here  But I was hesitant because I couldn t be sure that the unconstrained ML tree was the best tree in the set  i e  one of my constraints may have a higher log likelihood value than the unconstrained ML  I d expect a 99  probability that the unconstrained ML tree shows a higher  or at least equal  likelihood than the constrained tree  The 1  could happen if the tree search heuristics got stuck in local optima  But if you see this  just repeat 10 or more runs of IQ TREE and pick the best one  Ideally I would like to put all constraints in a single test comparison  but I need to make sure that each constraint is being compared to the unconstrained specifically  and not any other constraint in the group that  by chance  happens to have a higher LL  Yes  all trees will be compared against each other  That s the purpose of the SH or AU test  What would you suggest is the best way to go  Just to reiterate  I d do a multiple testing of all trees together  Cheers Minh To view this discussion on the web visit https   groups google com d msgid iqtree 596a1397 4172 465b b216 adae070c77a5n 40googlegroups com ",0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0
"w7zZusvm1oA","4/20/2021 11:35:48","2/6/2021","Recoded dataset stationary frequencies  plus a feature suggestion  Hey again Minh  Another thing we ve been messing with lately is protein sequence recoding  particularly SR4 and Dayhoff6  It took an embarrassing amount of time to pick up on the fact that  X s in the sequences were causing the runs to fail  After converting those to dashes or question marks for ambiguous characters  everything went smoothly  So  here are a few questions that have come up in discussions  1  For a 4 state alphabet  does it make a difference whether I recode to letters  ATCG  or numbers  0123   Do the morphological MK and GTR4 behave the same as JC and nucleotide GTR  2  To grossly misquote the literature  looking at the intro of doi 10 1093 molbev msu044 atm  for a protein dataset  a  F model adjusts the empirical rate matrix Q based on the observed stationary amino acid frequencies  by going through the exchangeability matrix R  not even going to try posting the whole r  business here   However  what happens in iqtree if I m using a GTR model   morphological GTRX in this case  but the question also applies for nucleotide GTR4 and protein GTR20  At first glance  I d expect such an adjustment to be embedded in the GTRX estimation but adding FO and F to the model selection picks one of them instead  What am I missing here  For protein datasets  would using Qmaker make a difference  2 5  As an offshoot of the previous question  for amino acid datasets  have you ever benchmarked if  FO on different starting matrices adjusts them to sth similar looking  Again  I might be misunderstanding sth  3  Is it possible to use PMSF to get from SR4 to SR4 C60 F G or do I have to run the mixture model directly  4  Little feature suggestion  would it be possible to implement a molecular clock test in iqtree i e  an option that when providing a  rooted  tree  all branch lengths are set to equal  and an ML estimate of what that length would be  then it s fairly simple to do an LRT between the strict clock  more like ultrametric in this case   and the unconstrained input trees  I was looking around for a while  including the options for dating   and what I ended up doing for fun was to include  Hk in the model selection  If a heterotachy model comes up as  10BIC better than the simple one  I d say that rejects the clock hypothesis  What do you think  Sorry for being such a hassle again and thanks for your time  Best  Panos  Hi Panos  On 6 Feb 2021  at 8 13 am  Panagiotis Adam   panagiotis    gmail com   wrote  Hey again Minh  Another thing we ve been messing with lately is protein sequence recoding  particularly SR4 and Dayhoff6  It took an embarrassing amount of time to pick up on the fact that  X s in the sequences were causing the runs to fail  After converting those to dashes or question marks for ambiguous characters  everything went smoothly  So  here are a few questions that have come up in discussions  1  For a 4 state alphabet  does it make a difference whether I recode to letters  ATCG  or numbers  0123   Do the morphological MK and GTR4 behave the same as JC and nucleotide GTR  I d say there is no differerence between these 2 recodings  MK   JC and GTR4   GTR  2  To grossly misquote the literature  looking at the intro of doi 10 1093 molbev msu044 atm  for a protein dataset  a  F model adjusts the empirical rate matrix Q based on the observed stationary amino acid frequencies  by going through the exchangeability matrix R  not even going to try posting the whole r  business here   However  what happens in iqtree if I m using a GTR model  If you are recoding to a DNA alignment  the default for GTR is  F   morphological GTRX in this case  but the question also applies for nucleotide GTR4 and protein GTR20  At first glance  I d expect such an adjustment to be embedded in the GTRX estimation but adding FO and F to the model selection picks one of them instead  What am I missing here  I believe if you are recoding to 0123  the default is then  FQ  for equal frequencies  for morphological data  So that the difference  For protein datasets  would using Qmaker make a difference  It only makes a difference with QMaker if you have a partitition model  while QMaker estimate a single Q matrix for all parititions  it actually allows different rate heterogeneity types between partitions  Whereas without QMaker  you will can only have a single model  i e   non partitioning  in order to estimate a joint Q matrix for all alignment sites  2 5  As an offshoot of the previous question  for amino acid datasets  have you ever benchmarked if  FO on different starting matrices adjusts them to sth similar looking  Again  I might be misunderstanding sth  For  FO  technically IQ TREE will initialize the parameters with the observed frequencies  like from  F  and then try to estimate them further using maximum likelihood  So we also see that  FO improves the likelihood compared with  F  In terms of benchmarking  or testing   I didn t really perform a thorough test  but since  FO always returns better log likelihood than  F  I didn t see anything unexpected  3  Is it possible to use PMSF to get from SR4 to SR4 C60 F G or do I have to run the mixture model directly  Yes  PMSF should also work with non amino acid models  If not  please follow up here  4  Little feature suggestion  would it be possible to implement a molecular clock test in iqtree i e  an option that when providing a  rooted  tree  all branch lengths are set to equal  and an ML estimate of what that length would be  then it s fairly simple to do an LRT between the strict clock  more like ultrametric in this case   and the unconstrained input trees  I was looking around for a while  including the options for dating   and what I ended up doing for fun was to include  Hk in the model selection  If a heterotachy model comes up as  10BIC better than the simple one  I d say that rejects the clock hypothesis  What do you think  Once upon a time there was indeed an idea to implement a strick clock model in IQ TREE  However  I never got enough motivation to implement such feature  as strict clock will be rejected for most  say  95   of the datasets anyway  So this model  while historically interesting  is almost useless nowadays   Sorry for being such a hassle again and thanks for your time  No worries  it s the purpose of this maillist  Minh Best  Panos You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree e7995940 5846 4684 a2d7 55951c592747n 40googlegroups com ",0,0,1,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"WU8gbNiXvyM","4/20/2021 12:47:56","5/19/2015","Mixture model implementation HI Minh  I am very excited to see that IQ tree has implemented C60 etc mixture models  I recently tried LG C60 G4 versus LG G4 under IQ 1 2 3  I noticed that lnL s are very similar between the two  which was suspect to me as I would expect the lnL for LG C60 G4 to have a better lnL  I also noticed that in the log file the number of free parameters for LG G4 was 146 and that this is the same for LG C60 G4  I have 74 taxa  so   2x74  3 145 branch lengths   1 for the alpha parameter     146  I would expect that with LG C60 G4 would be 146   59  for the C60 Mixture model  these are the weights for the 60 classes  60 weights minus 1 because the last weight is 1  all the others        205 free parameters  I am wondering if there may be a bug in the implementation of the c series mixture models or a bug in the code  Do you have any idea  Thank you  Matt Brown Log Files  IQ Tree Non Partitioned   LG G4 Log likelihood of the tree   5805899 8515  s e  13390 6396  Number of free parameters  146 Akaike information criterion  AIC  score  11612091 7030 Corrected Akaike information criterion  AICc  score  11612092 1549 Bayesian information criterion  BIC  score  11613473 3025 Unconstrained log likelihood  without tree    1084836 7826 IQ Tree Non Partitioned   LG C60 G4 Log likelihood of the tree   5805899 8645  s e  13390 7095  Number of free parameters  146 Akaike information criterion  AIC  score  11612091 7291 Corrected Akaike information criterion  AICc  score  11612092 1810 Bayesian information criterion  BIC  score  11613473 3286 Unconstrained log likelihood  without tree    1084836 7826  Dear Matt Brown  thanks for trying it out  Can you paste the command line that you used  C60 model has 60 components  each is a Poisson model with unequal amino acid frequencies plus a Gamma rate heterogeneity  So I am not sure what is LG C60  If you specify   m C60   the mixture weights are fixed by the model  Instead  if you want to optimize the weights  then add an option   mwopt  into the command line  I saw that this option is not listed in the help usage  will add in the next release  Cheers  Minh You received this message because you are subscribed to the Google Groups  IQTREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To post to this group  send email to iqt    googlegroups com Visit this group at http   groups google com group iqtree For more options  visit https   groups google com d optout Bui Quang Minh Center for Integrative Bioinformatics Vienna  CIBIV  Max F  Perutz Laboratories Campus Vienna Biocenter 5  VBC5  Ebene 1 A 1030 Vienna  Austria Phone    43 1 4277 24026 Fax    43 1 4277 24098 Email  minh bui  AT  univie ac at  Thanks for the reply Minh  I must have put the command in wrong  I am trying to use both the LG matrix and C60 mixture model  is this possible with IQ tree  iqtree omp  omp 20  s Bordor 351 74 12 18 2014 dat  m LG G  bb 1000 iqtree omp  omp 20  s Bordor 351 74 12 18 2014 dat  m LG C60 G  bb 1000  Dear Matt  in your 2nd command IQ Tree will understand the model as LG G  omitting  C60  because there is no LG C60 model  The correct one is  iqtree omp  omp 20  s Bordor 351 74 12 18 2014 dat  m C60  bb 1000  C60 already includes  G  you will see in the log file that C60 is alias for POISSON G4 FMIX       If you further want to optimize the mixture weights then  iqtree omp  omp 20  s Bordor 351 74 12 18 2014 dat  m C60  bb 1000  mwopt However  if you really want to use the LG matrix for C60 instead of POISSON  then the only way right now is   m  LG G4 FMIX       i e  copy the whole alias and change POISSON to LG  and don t forget the double quote   However  I am not sure whether this is the right model to use and such model was not described in the literature  to my knowledge   Cheers  Minh  HI Minh  The LG C20 model is described in http   www ncbi nlm nih gov pubmed 24441033 From that paper  The rate matrix for a site having one component in the cF4  cF9  or cF20 profiles is obtained from an empirical rate matrix  Q  using the usual adjustment  via exchangeabilities  The only change is that the role of the data set frequencies is now played by the set of profiles of interest in cF4  or cF9 and cF20   All models also include an F class  which uses the data set frequencies  So  for instance  cF4 has five classes  one F class for the overall frequencies and four for the cF frequencies  We refer to the model that obtains rate matrices for the F and cF classes  via the usual adjustment to the exchangeabilities  as the cF4  or  respectively  cF9 and cF20  model   The exchangeabilities are from LG and they used cseries mixtures  They did not do C60 because it was too slow in their implentation  QmmRAxML   My understanding is that the cF20 model in that paper is LG G4 F C20  So the LG q matrix with cseries mixture  plus one more general  F  class in the mixture  so it is the C20 classes plus an F class  For implementing this LG C60 G F how would I try this   m  LG G4 FMIX       what do I put in the     for this  Thank you  Matt  Hi Minh  I tried several options with mixtures  but there are RAM requirement issues   m  LG G4 FMIX c60 alias       722GB of RAM  m C60     722GB of RAM  m  LG G4 FMIX c10 alias       125GB of RAM  m C10     125GB of RAM My cluster has 20threads but only 62GB of RAM so these will not run  I m wondering if there is some mistake in the code and too much RAM is being allocated for mixtures  Bare in mind that my dataset is 100000AA sites 74 taxa  Best  Matt  Dear Matt  the memory requirement for mixture model is  in bytes    3n 6    m   s   c   k   sizeof double  where n   number of taxa m   number of distinct site patterns    alignment length  s   number of states  20 for AA  c   number of rate categories  4 for  G4  k   number of mixture components  60 to C60  I don t know how many site patterns  m  you have  but since m   100000  the RAM required for your data is   772 GB  I have a machine here with 512 GB  thus I could offer to analyze your data up to C30 or C40  What do you think  And finally thanks for the citation  I was not aware of this complex model  I will think about supporting such model directly without having to use such a long  m option  Cheers  Minh  Hi Minh  Really happy that you ve implemented these models  I m hoping it will be feasible to actually do bootstrapped analyses of such large data sets  such as the one Matt is talking about  in reasonable times  One thing that might work to speed things up  and lower RAM usage  would be to estimation under the various classes for each site with a starting tree  NJ or whatever you are using for IQTREE  to estimate the likelihoods of each of the classes for every site and optimize the weights  Then you could  as an approximation  only use the top 2 3 classes in terms of posterior probability for a given site and do tree searching with this instead of evaluating the full mixture for every tree  My guess is that the top 2 3 classes collectively comprise  0 99 of the posterior probability distribution over the classes for the site and so failing to evaluate the likelihood of the remaining ones for that site will make almost no difference to tree selection and could lead to substantial speed up  You could do something even riskier than this and only evaluate the class with the highest posterior probability for the site during the tree searching   I wonder if it would matter too much  In theory this is not the  right  way to do things  I realize  however I suspect that evaluating only the top 3 classes will pretty much capture all you need from the mixture  In fact  I suspect this is exactly what happens under Bayesian inference with Phylobayes using the C10 C60 models because the mixture is only being approximated over the MCMC generations  not every generation  and it is practically impossible for MCMC to properly evaluate the mixture for every site with this many classes unless you did an infeasible number of MCMC generations  This is just an idea about how to speed up these large mixture models using an approximation  Cheers Andrew Roger  Dear Andrew Roger  thanks for sharing the ideas  Actually Arndt and I had similar thoughts  that quite possibly only a few mixture components will contribute to the likelihoods  the rest can be safely ignored  I will go further into that direction  such that the complex mixture models will be computationally feasible  The version 1 3 0 I just released accepts now mixture models like LG C60 or LG C60 F  empirical frequencies is added to the mixture as an extra component  or JTT CF4 G  Cheers  Minh  Dear Minh  Thanks for adding these models  I am running LG c10 F and LG c20 F it by putting the entire mixture model as suggested  I am only able to run up to c30 as the RAM constraints  We have a 512GB node  but it is a little difficult to get ahold of for a long period  At the moment I have it running  I looks like ML   1000 ultrafast BSreps will complete in a total of  86hr for c10 and  132hr for c20  each 8 threads at 132GB and 250GB RAM  respectively   I look forward to seeing any sort of speed ups and RAM short cuts in the future as Andrew mentioned  THank you for your help with this  All the best  Matt  Dear Minh  That is great  I look forward to seeing the result of your investigations  BTW  our experience is that the LG C20  or C60  F mixture fits large data sets MUCH better than LG C60 or Poisson C60  we have done these evaluations using QMMRAxML   but its slower than IQTREE   Ideally it would be good to estimate an empirical exchangeability matrix for use with C series mixtures   LG was never optimized for this use as you know  Cheers Andrew Roger  Dear Matt  We have just released new version 1 3 2 that reduces RAM requirement by a factor of 3  e g  from 600 GB down to 200 GB  using another technique  So it should be possible to analyze your data with C60 model now  Please have a try  Cheers  Minh  Hi Minh  Is there an updated version of this formula to estimate upfront the optimal RAM requirement for a given dataset  Many thanks  Laura  Hi Laura  Someone asked the same question but I couldn t find it anymore  Nevertheless  in the latest version of IQ TREE  there are now two modes  full memory and memory saving mode  In the full mode  the formula is for the RAM requirement in Bytes is  8 x number of sequences x number of distinct site patterns x number of states x number of rate categories x number of mixture classes   Number of distinct site patterns is normally smaller than the number of sites in the alignment  when some sites appear repeatedly in the alignment  esp  constant sites     Number of states is 4 for DNA  20 for protein  61 for codon models    Number of rate categories is for 4 for the Gamma model  G4 or the free rate model  R4  But can also be higher  say  5 if you used  R5 model    Number of mixture classes is 10 if using  C10 model  20 for  C20 model  etc  In the memory saving mode  IQ TREE can automatically reduce the RAM usage if the full requirrement exceeds 95    the RAM size  This technique was described in this paper  https   cme h its org exelixis pubs Exelixis RRDR 2011 8 pdf   In theory  you can replace number of sequences in this formula with log2 number of sequences  2  This is a lot of reduction for large number of sequences  But there is a trade off between run time and RAM requirement  What you can do is to use  mem option  For example   mem 100G will make sure that IQ TREE won t use more than 100GB RAM  You can also do something like  mem 0 5  meaning that IQ TREE will use half memory of the full mode  In my own experience  50  memory saving will make IQ TREE run 10  to 20  slower  Hope that helps  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 680509d6 e720 4ab2 a1be 436416b2dea6n 40googlegroups com  Thank you so much  Minh  this is very helpful   Best  Laura ",0,0,1,0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0
"xpgWvC1qXVA","4/22/2021 9:20:30","12/9/2020","Maximun Likelihood Tree vs  Consensus tree bootstrap values and selecting outgroups Hello  I am running a concatenation based species tree using a partition model with Ultrafast bootstrap and the SH aLRT fast branch test  My code  iqtree  p ALIGNMENT FOLDER   prefix concat  alrt 1000  B 1000  T AUTO I have two questions  1  In the concat iqtree output I get a Maximun Likelihood Tree with SH aLRT support       ultrafast bootstrap support     values and also a Consensus Tree with bootstrap supports      How are the bootstrap values in the Consensus different from the values in the first tree  I don t fully understand how this two trees are different or how to interpret them  2  The output indicates   Tree is UNROOTED although outgroup taxon  1  is drawn at root   Is there a way to avoid this  Is there any way to visualize the tree without a radon taxa as outgroup  or to select a more suitable outgroup   I would really appreciate some help  Thanks  Isabel  Hi Isabel  On 10 Dec 2020  at 3 48 am  Isabel Fernandez Escapa   isabel fern    gmail com   wrote  Hello  I am running a concatenation based species tree using a partition model with Ultrafast bootstrap and the SH aLRT fast branch test  My code  iqtree  p ALIGNMENT FOLDER   prefix concat  alrt 1000  B 1000  T AUTO I have two questions  1  In the concat iqtree output I get a Maximun Likelihood Tree with SH aLRT support       ultrafast bootstrap support     values and also a Consensus Tree with bootstrap supports      How are the bootstrap values in the Consensus different from the values in the first tree  I don t fully understand how this two trees are different or how to interpret them  Please look up the IQ TREE forum  I recalled that someone asked the same question  IQ TREE even tells you the Robinson Foulds distance between ML and consensus tree  see  iqtree file   2  The output indicates   Tree is UNROOTED although outgroup taxon  1  is drawn at root   Is there a way to avoid this  Is there any way to visualize the tree without a radon taxa as outgroup  or to select a more suitable outgroup   Use  o option  see the documentation  Cheers Minh I would really appreciate some help  Thanks  Isabel You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 784fc300 4eeb 4e2c 9026 b1eddcf93fc8n 40googlegroups com  Hi Minh  I will try the  o option to root my trees  About the ML vs  consensus  my understanding is that the consensus tree is build from the bootstrap trees  so it is an extended majority consensus from the UFBoot bootstrap trees  Is this correct  Thanks  Isabel  Hi Isabel  Sorry for the long delay  I m back from a long break  Yes  that is correct  Some bonus infos  You can use the  minsup option   http   www iqtree org doc Advanced Tutorial consensus construction and bootstrap value assignment   such as  minsup 0 5 to build the majority rule consensus  The default is  minsup 0  i e   extended majority rule consensus  If you want to build a strict consensus  use  minsup 1 0  Cheers Minh  Thanks  ",1,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0
"xxwuime3TTY","4/22/2021 9:24:10","1/28/2021","Fwd   iqtree  gCF and sCF interpretation question Hi there  Forwarded below is the answer by Matt Hahn  Hope that it helps  Minh Begin forwarded message  From   Hahn  Matthew    m    indiana edu Subject  Re   iqtree  gCF and sCF interpretation question Date  19 January 2021 at 5 53 26 am AEDT To  Minh Bui   minh    univie ac at Cc  Rob Lanfear   rob l    gmail com Well  these data are clearly from bacteria  where it s not clear what sCFs should mean there s not  normal  recombination  so no ILS as we imagine it should be measured by site discordance  In any case  given their numbers  I think it s perfectly possible that their sequences are not very informative  such that sCFs are close to 1 3  In this case I guess the genes are informative enough possible because they re very long  or because informative sites are clumped non randomly to give the results they re seeing  But as I said  I would be wary of applying CFs to bacteria in the first place  It s not wrong  just a bit unproven  matt On Jan 18  2021  at 9 04 AM  Minh Bui   minh    univie ac at   wrote  Hi Rob and Matt  This is a question in the IQ TREE forum  What would you say here  Thanks  Minh Begin forwarded message  From  Alexander Kneubehl   a kne    onu edu Subject   iqtree  gCF and sCF interpretation question Date  8 January 2021 at 4 23 54 pm AEDT To  IQ TREE   iqt    googlegroups com Reply To  iqt    googlegroups com Hi all  This may be a naive question from a neophyte but I have a node that has some CF data that has me a little puzzled  The analysis was done on a concatenated dataset of 760 single copy core genome orthologs from 9 different strains of bacteria  same genus different species  following the directions on the iqtree website  The node in particular has a bootstrap gCF sCF of 100 62 2 37 7  a gCF gDF1 gDF2 gDFP of 62 24 8 03 11 45 18 29  a gCF N gDF1 N gDF2 N gDFP N of 473 61 87 139  an sCF sDF1 sDF2 of 37 68 27 62 34 7 and an sCF N sDF1 N sDF2 N of 10427 1 7646 89 9608 56  Now I would expect based on my limited understanding of concordance factors that if the sCF is low  approaching 33  indicating that there is little signal in the sites being analyzed  that the gCF would be low as well at least not as high as 62  However here we see that the gCF    gDF1 and gDF2 but the sCF is somewhat similar to sDF1 and sDF2  How would one interpret these results  Any help would be greatly appreciated  Thanks  You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree d6b9f0c7 70c0 48b2 aa3c 9d449e8c3286n 40googlegroups com ",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0
"3VxuGvFlsPE","4/22/2021 9:34:38","12/12/2020","Parallelization of candidate tree set calculation  Hi  I would like to propose more parallelization to improve speed of IQTREE2 on very large supermatrices  I found that the following step always uses a single CPU thread  IQ TREE multicore version 1 6 12 for Linux 64 bit built Aug 15 2019                                                                          INITIALIZING CANDIDATE TREE SET                                                                        Generating 98 parsimony trees    On very large Supermatrices it runs for days and is a bottleneck for overall performance  I hope this can be parallelized  Best wishes and thanks for the great IQtree2 tool  Heiner  Dear Heiner  Sorry for the long delay  I m back from a long break  Thanks for your suggestion  Quick answer  use  t PARS option to resolve this issue  Long answer  This issue was known but we didn t focus on this because parsimony is typical fast  But you are right  it can  and should  be paralellised  Technically  IQ TREE uses the phylogenetic likelihood library and due to the limited interface with this library  it is only called sequentially  However  I believe that if you use  t PARS option  IQ TREE will then use its own parsimony kernel instead  which indeed parallelises this step  Let me know if using this option helps  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 29c71d69 c2fa 43b3 b2a0 7b50811024d6n 40googlegroups com ",0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0
"4cffimmnvGw","4/22/2021 9:37:31","11/16/2020","Start tree search from multiple trees specified in file Hi  I want to perform a tree search starting from 50 random   50 parsimony trees  The reasoning behind it is that starting from parsimony trees only  could bias the search towards a specific part of the tree space  and potentially local optima  I would appreciate any comment about it   From what I understand  the  t  file  option allows to load only one user defined tree to start the search  What I want to know is  if my  file  has the 50 random   50 parsimony trees that I want to use  will all of them be considered  or just the first one  first line   Thanks    My apology for the delay in replying  Just too much commitment at the moment  On 16 Nov 2020  at 9 54 am  Kevin I  S nchez   kevin iman    gmail com   wrote  Hi  I want to perform a tree search starting from 50 random   50 parsimony trees  The reasoning behind it is that starting from parsimony trees only  could bias the search towards a specific part of the tree space  and potentially local optima  I would appreciate any comment about it   By default IQ TREE will already generate 99 parsimony starting trees  plus a BIONJ tree   I would advise against random starting trees   this is something specific for RAxML algorithm  not IQ TREE  Therefore  what you can do is to simply start 10 independent IQ TREE runs  from different seed number   This will generate in total 990 parsimony in all 10 runs  That s enough  See the recent Zhou et al paper  https   academic oup com mbe article 35 2 486 4644721 From what I understand  the  t  file  option allows to load only one user defined tree to start the search  What I want to know is  if my  file  has the 50 random   50 parsimony trees that I want to use  will all of them be considered  or just the first one  first line   Only the first line  or the first tree  will be loaded  But see my answer above  Minh Thanks   You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree adf25ca9 7981 46b1 a918 8619ce56d036n 40googlegroups com  Dear Minh  all I have now looked and so many datasets  ok mainly from insects  that I disagree a bit what you wrote about random start trees  I would always do independent runs and then BOTH  parsimony start trees and random  because I really saw many times that the range of best likelihoods received afterwards is still much wider and not comparing this then  quite often  the overall best logLG  comparing ML trees with 25 random   25 parsimony  was one with a random start tree  similar to RAxML actually   Also I recognized that having dataset with a lot closely related taxa  so one genus family or population   in contrast to  deep  phylogenies here ML searches with a pars  starting tree  default  having better logLH scores  Interesting to hear more opinions  Additionally I also switched when doing slow BS to start with random trees here as well  Best  Karen  HI Minh  thanks for the answer  I just have read the paper  really helpful So a question arises  Starting the tree search from random   parsimony trees as can be specified in RAxML  is recommended to avoid stuck in local optimum because it implements SPR based moves  I see that IQ TREE is based on NNI moves     Hi Karen  I see  that s good to know  When you observed that starting from random trees obtained better log likelihoods  how much better it is  But yeah I agree  it depends on the dataset  Minh To view this discussion on the web visit https   groups google com d msgid iqtree 7efad7ad 679b 4903 beb6 7998cabfb3cdn 40googlegroups com  This is because RAxML doesn t have the stochastic pertubation step like in IQ TREE  RAxML has the only one  random  step in the starting tree  the remaining is hill climbing SPR  Whereas IQ TREE does a lot of iterations  each will propose a random tree  by randomly perturbing branches of some local optimal tree  and then do hill climbing NNI  We observed that this is better than RAxML algorithm  as independently confirmed by Zhou et al  But as Karen just wrote  for some datasets it may even be more helpful to do random starting trees  so you can do this when in doubt about local optima  Minh To view this discussion on the web visit https   groups google com d msgid iqtree b309c022 3df9 4f65 b85f d6bfcc7287b8n 40googlegroups com  Dear Minh  with a dataset I handle currently  Antl      at least several likelihood units  up to 3 before the comma   but in others deep phylogeny datasets the difference is biger  I see no general trend   therefore agreed that it is highly dataset dependent There are also not really  tests  out there  how much ML tree searches are reasonable and at the same time not too exhaustive  time wise    I found nly phylogenetic terraces   tree space papers which are great but i think not really implemented in packages  I am always afraid of  local  optima  I also did not find unambiguous literature stating  what difference in terms of logLH scores is actually meaningful  Might also depend on the dataset  Recently  see last post  handling a different dataset  many termites of only one family   onebarcode marker   the differences were by far smaller  about 0 00X difference    here always the runs with the parsimony trees end up with a better score  Anyway  in most  deeper  phyl  atasets Iam dealing with its the opposite   Cheers Karen  Dear Minh and Karen Thanks for the replies and discussions  Extracted from the Zhou et al  paper   a program was considered to perform better than another if it yielded a log likelihood score that was more than 0 01 higher than the other   Can we extrapolate this conclusion to the difference in log likelihoods in ML trees that started from random and parsimony trees   e g  a ML tree inferred from a set of X random starting trees whose logL is 0 01 greater that a ML tree inferred from a set of X parsimony trees Given that  I find it interesting to compare results from different starting trees    For instance  in raxml ng the command   tree pars 50  rand 50  allows the program to start the search from 100 starting trees  50 parsimony   50 random   does iq tree have an analogous command  Kevin  in IQ TREE if you did not add an additional command  its doing parsiony trees  and one BioNJ   see Minhs commen  for a random start tree you add  t RANDOM  for a BioNJ   t BIONJ  see command reference    http   www iqtree org doc Command Reference     t Cheers Karen  Thanks Karen  Actually  t RANDOM starts the search with only one random tree  what I wanted to know is you can specify multiple trees to start the search  loading a file with e g  50 random trees  in fact  t  file  allows one to specify a user defined tree  but if the file has multiple trees  iq tree will read only the first tree  kevin   t RANDOM will do 100 random starting trees  Observe these lines the log  Generate random initial Yule Harding tree    Log likelihood of random tree   26305 628                                                                        INITIALIZING CANDIDATE TREE SET                                                                        Generating 99 random trees    Minh To view this discussion on the web visit https   groups google com d msgid iqtree c2ee64a8 6ce1 4a85 99ec 3176bf4177ben 40googlegroups com  Dear Minh Many thanks  that was really helpful  I was not aware that 100 random trees were generated  given that the documentation states     t RANDOM starts tree search from completely random tree   I thought that only one random tree was generated  kevin ",0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"8Rk1pGhT5oA","4/22/2021 9:39:25","12/29/2020","Removing recombinant genes with GET PHYLOMARKERS Hello  I am using the GET HOMOLOGUES  GET PHYLOMARKERS pipeline for pangenomic analysis and for generating core genome gene clusters alignments   https   www frontiersin org articles 10 3389 fmicb 2018 00771 full    This pipeline includes a step to scan gene cluster alignments with the Phi test   Bruen et al   2005   to identify and discard those with significant evidence for recombinant sequences  This pipeline also allows removal of genes that yield   outlier gene trees   and poorly resolved gene trees Since this is a relatively new paper  2018  and I am new to Phylogenomics  I would like to know is this practice of removing recombinant genes from the alignment used for tree reconstruction is recommended and well accepted on the field  I ve used IQtree to create a concatenation based species tree using a partition model with Ultrafast bootstrap using all the core genes as well as the output after each filtering step  The issue is that I am not sure how to determine which one is better  so I would really appreciate some guidance  Thanks a lot  Isabel  Hi Isabel  While I am not an expert on phylogenomics  I have been digging a bit on the same topic of including removing recombination tracts and I am not sure this is settled  but a couple of papers suggest that removing may be worst than including  https   academic oup com mbe article 33 7 1711 2578655 login true 87271471 https   mbio asm org content 5 6 e02158 14 short  Thanks Ricardo  I will take a look at those papers  Happy New Year  You received this message because you are subscribed to a topic in the Google Groups  IQ TREE  group  To unsubscribe from this topic  visit https   groups google com d topic iqtree 8Rk1pGhT5oA unsubscribe To unsubscribe from this group and all its topics  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 6d7775e9 66c4 4308 a6d7 6c2d69a3304cn 40googlegroups com ",0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0
"AkaifHuEhQk","4/22/2021 9:41:04","11/29/2020","BUG  IQ TREE crashes when optimising candidate tree set Dear IQ TREE users and developers  Can anyone please help to sort out the issue posted below which I encountered when running IQ tree version 1 6 12 on macOS 64 bit version 11 0 1  Big Sur   ERROR  phylokernelnew h 3159  double PhyloTree  computeLikelihoodFromBufferGenericSIMD    VectorClass   Vec4d  FMA   true  SITE MODEL   false   Assertion  std  isfinite tree lh      Numerical underflow for lh from buffer   failed  ERROR  STACK TRACE FOR DEBUGGING  ERROR  2  sigtramp   ERROR  5 double PhyloTree  computeLikelihoodFromBufferGenericSIMD Vec4d  true  false    ERROR  6 PhyloTree  getBestNNIForBran PhyloNode   PhyloNode   NNIMove   ERROR  7 IQTree  evaluateNNIs std    1  map int  std    1  pair Node   Node    std    1  less int   std    1  allocator std    1  pair int const  std    1  pair Node   Node           std    1  vector NNIMove  std    1  allocator NNIMove      ERROR  8 IQTree  optimizeNNI bool  ERROR  9 IQTree  doNNISearch   ERROR  10 IQTree  doTreeSearch   ERROR  11 runTreeReconstruction Params   IQTree    ERROR  12 runPhyloAnalysis Params   Checkpoint   ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL ABORTED ERROR      For bug report please send to developers  ERROR      Log file  ref6 1 best phy log ERROR      Alignment files  if possible  zsh  abort iqtree  s ref6 1 best phy   sequential  st CODON11  nt AUTO I can send the full log file and alignment file upon request  Many thanks  Best regards  E  Bundhoo   Hi there  the codon models are known to be sometimes numerically unstable  depending on the data  So does it work if you add  m TEST option  With this option IQ TREE will ignore the parameter rich free rate models  and might resolve the numerical problem  or not   If not  let me know  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree af2b95ef ed47 4025 b534 95bb78a858ecn 40googlegroups com  Dear Minh  Thank you for your reply  Unfortunately however it does not work when I add the  m TEST option  I get the same error at the same step  i e  optimising candidate tree set   I copy the error message again below  Please advise  Thank you  Sincerely  Eshan  ERROR  phylokernelnew h 3159  double PhyloTree  computeLikelihoodFromBufferGenericSIMD    VectorClass   Vec4d  FMA   true  SITE MODEL   false   Assertion  std  isfinite tree lh      Numerical underflow for lh from buffer   failed  ERROR  STACK TRACE FOR DEBUGGING  ERROR  2  sigtramp   ERROR  5 double PhyloTree  computeLikelihoodFromBufferGenericSIMD Vec4d  true  false    ERROR  6 PhyloTree  getBestNNIForBran PhyloNode   PhyloNode   NNIMove   ERROR  7 IQTree  evaluateNNIs std    1  map int  std    1  pair Node   Node    std    1  less int   std    1  allocator std    1  pair int const  std    1  pair Node   Node           std    1  vector NNIMove  std    1  allocator NNIMove      ERROR  8 IQTree  optimizeNNI bool  ERROR  9 IQTree  doNNISearch   ERROR  10 IQTree  doTreeSearch   ERROR  11 runTreeReconstruction Params   IQTree    ERROR  12 runPhyloAnalysis Params   Checkpoint   ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL ABORTED ERROR      For bug report please send to developers  ERROR      Log file  ref6 1 best phy log ERROR      Alignment files  if possible  zsh  abort iqtree  s ref6 1 best phy   sequential  st CODON11  nt AUTO  m TEST  Does it work  if you use DNA models  How long is your alignment  If it s too short or too sparse  you may actually don t have enough information to estimate codon models  Please send your full log file  Cheers Minh To view this discussion on the web visit https   groups google com d msgid iqtree 1b9cab93 27b0 4749 8b8d 5ff8b0812da3n 40googlegroups com  My alignment is of length 2505  835 codons   I ll try again with DNA models  In the meantime  I ll share the log file and alignment file  Thanks  Eshan  ",0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0
"ASTWSZOtQC8","4/22/2021 9:44:25","3/9/2020","IQ Tree consistency Hello  Thanks for providing this software  its easy to use and remarkably quick for our dataset  I just wanted to ask for your advice regarding IQ TREE parameters  I am running IQ TREE with a concatenated dataset of RAD loci composed of 1829548 sites and 14599 SNPs for 260 samples  I initially ran the analysis using the command below iqtree  s populations all edit phylip  m MFP  bb 1000  alrt 1000  pre out  nt 16 To see if our tree search is consistently identifying the sample topology  I ran the same analysis multiple times and found that the best tree identified is different for each analysis  I saw the suggestions for the best practices in IQ TREE here https   groups google com forum   topic iqtree 0mwGhDokNns and changed the input for  pers and  nstop as follows for two different runs   pers 0 2  nstop 500  pers 0 1  nstop 1000 However  I found similar results  I have attached a plot showing the comparison of the best trees from two separate analyses using  pers 0 1  nstop 1000 and you can see that there are a lot of differences  Below are the  BEST SCORE FOUND  values from the log files of 10 runs using  pers 0 1  nstop 1000   2773113 415  2773098 037  2773100 456  2773193 719  2773110 434  2773140 700  2773146 741  2773120 365  2773076 027  2773115 223 There is some variation in the Lnl values above  Am I correct in assuming that the tree search has not identified the optimum tree for this dataset  If so  can you recommend additional parameters that I could test  Thanks again and best wishes Ollie  Hi Ollie  This is a great question  the details really help  The ultimate answer is  there is unfortunately no way to guarantee a global optimum  because IQ TREE  and other software  rely on heuristic algorithms  You can repeat as many runs as possible to narrow the gap to the global optimum  Therefore I suggest that you perform 100 runs for each setting   pers 0 1  nstop 1000  pers 0 2  nstop 1000  pers 0 3  nstop 1000  pers 0 4  nstop 1000  pers 0 5  nstop 1000 And then take the tree with highest likelihood from these 500 runs  Another way is to look back at the data and try to clean it up  Often there are  rogue  taxa  whose positions in the tree are unstable and move around the tree from different runs  I would suggest that you use some tools like RogueNaRok to identify and remove them from the analysis  This tool need the bootstrap trees  so you just add option  wbt to print the bootstrap trees and feed them into RogueNaRok  Cheers  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 1756e0e9 18ef 4e73 81f6 9b3a6a8e808d 40googlegroups com  plot comparison iqtree 1 2 blacklist pers 0 1 nstop 1000 array repeat pdf   Hi Minh  Just wanted to thank you for your reply and advice with this  And thanks also for your recommendation of RogueNaRok  Both worked well for me  Best wishes Ollie On Wednesday  March 11  2020 at 7 14 54 AM UTC  Minh Bui wrote  Hi Ollie  This is a great question  the details really help  The ultimate answer is  there is unfortunately no way to guarantee a global optimum  because IQ TREE  and other software  rely on heuristic algorithms  You can repeat as many runs as possible to narrow the gap to the global optimum  Therefore I suggest that you perform 100 runs for each setting   pers 0 1  nstop 1000  pers 0 2  nstop 1000  pers 0 3  nstop 1000  pers 0 4  nstop 1000  pers 0 5  nstop 1000 And then take the tree with highest likelihood from these 500 runs  Another way is to look back at the data and try to clean it up  Often there are  rogue  taxa  whose positions in the tree are unstable and move around the tree from different runs  I would suggest that you use some tools like RogueNaRok to identify and remove them from the analysis  This tool need the bootstrap trees  so you just add option  wbt to print the bootstrap trees and feed them into RogueNaRok  Cheers  Minh To unsubscribe from this group and stop receiving emails from it  send an email to iqt    googlegroups com  Dear Mihn  I hope you are well I have run IQtree with the combination of parameters suggested herein  and now I have 500 runs from which I ve picked the maximum likelihood tree  However  I m not sure how to perform bootstrap on this best tree and I would like to run 10 000 replicates  Probably this is very basic  but I have tried using this best tree as the initial tree   t option  but I get a worse likelihood  even though it is apparently starting from the highest likelihood spot  Maybe I have to specify the same partition model that I ve got on that run  however  I don t know how to do this and I couldn t find information on the command reference  The command that I m running now is  path iqtree 2  p  path align  bb 10000  alrt 10000  T AUTO  m MFP MERGE  rcluster 10  pre  path out 195spp 14g best tree 10kboot t  o T Semanga superba MWT93D002    keep empty seq  g  cons tree  minsupnew 80   no terrace  t  ml best tree  wbtl Thank you so much in advance  Wendy El mi rcoles  11 de marzo de 2020  3 14 54  UTC 4   Minh Bui escribi   Hi Ollie  This is a great question  the details really help  The ultimate answer is  there is unfortunately no way to guarantee a global optimum  because IQ TREE  and other software  rely on heuristic algorithms  You can repeat as many runs as possible to narrow the gap to the global optimum  Therefore I suggest that you perform 100 runs for each setting   pers 0 1  nstop 1000  pers 0 2  nstop 1000  pers 0 3  nstop 1000  pers 0 4  nstop 1000  pers 0 5  nstop 1000 And then take the tree with highest likelihood from these 500 runs  Another way is to look back at the data and try to clean it up  Often there are  rogue  taxa  whose positions in the tree are unstable and move around the tree from different runs  I would suggest that you use some tools like RogueNaRok to identify and remove them from the analysis  This tool need the bootstrap trees  so you just add option  wbt to print the bootstrap trees and feed them into RogueNaRok  Cheers  Minh To unsubscribe from this group and stop receiving emails from it  send an email to iqt    googlegroups com  Hi Wendy  From this run IQ TREE printed a file  splits nex  which contains the bootstrap spports for all possible splits from all bootstrap trees  You can use this file to assign supports to your best ML tree using  sup option   http   www iqtree org doc Command Reference constructing consensus tree iqtree  t XXX splits nex  sup BEST ML TREE FILE For your question why using  t may result in lower ML tree  it s due to stochasticity in model selection and tree search  it may find a slightly different model and trees in this run  even though the start tree is better  Cheers Minh To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree e1d2406e e559 4e27 b1b1 7a86c3c24638 40googlegroups com  Hi Wendy  I see  this command can t know the bootstrap trees of course  But you can still use  wbt option to quickly write the bootstrap trees  without branch lengths  from the previous best run by repeating the very same command line and adding option   undo  if using v2 0   iqtree  same command line as before    undo  wbt If you used v1 6 X or earlier  change   undo to   force unfinish By default without this option  IQ TREE complaint that this run completed  But with this option  IQ TREE will load everything from the checkpoint file and continue the analysis  This is handy if you change add a few options   wbt in this case  and it should finish quickly because all the bootstrap trees were already recorded in the checkpoint file  Please note that this option is different from   redo  I should have written this in the tutorial manual  However  this can t work with  wbtl because the bootstrap trees in the checkpoint file don t have branch lengths  Still  you don t have to repeat all 500 runs but only the best run using the same random seed number to reproduce it  which was written in the log file   So the command line is  iqtree  same command line as before   seed SEED NUMBER FROM BEST RUN  wbtl  pre ANOTHER PREFIX Hope that helps  Minh On 2 Apr 2020  at 2 28 pm  Wendy Valencia   valen    gmail com   wrote  Hi Minh  Thank you for your reply  The problem is that I need to write the bootstrap trees because I need the distribution of trees to perform other uncertainty downstream analysis  However  when I run this iqtree  t XXX splits nex  sup BEST ML TREE FILE and add the option  wbtl  it doesn t write the trees  although it assigns the supports  I was not wise enough to write the bootstrap trees before the 500 runs  and now it would be very time and computationally consuming to repeat the 500 runs  Therefore  I would be very grateful if there s any other way to get the bootstrap trees using this previously found best ML tree  Thank you so much in advance and best wishes  Wendy  Sorry to bother you Ollie  but I m very interested in the method you use to draw the diagram you are sharing  the comparison of all the trees generated from all your runs  What software did you use to draw it   Hi there  you better send this email to o willi    gmail com Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 67a0e1fd 33b3 4821 971a 3c14efb5feb7n 40googlegroups com ",0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,1,0,0
"FDfRWxILV18","4/22/2021 9:47:11","1/3/2021","mldist values I want to calculate maximum likelihood pairwise distances using iqtree2 exe  s conothoa concat nex  p part nex  B 1000  T AUTO   alrt 1000   redo Analysis goes well  all final files had been generated  However ML distances values in mldist file are too small  Patristic distances taken from nex treefile are realistic  What is wrong    Hi Andrey  Indeed the distances in mldist file look too small  Did you get the same if using version 1 6 12 or not  They should be similar  If not  please get back to me  Thanks  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 47741177 2b56 4baf befd cde810c36621n 40googlegroups com ",0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0
"hbN1YPLDZ4c","4/22/2021 9:49:07","12/16/2020"," Uniqueseq   alignment different from input Hi everyone  I have noticed something weird in the      uniqueseq phy   alignment produced by IQ TREE  Although the number of characters indicated in the heading of the phylip file is correct  the sequences seem to be different from the original ones used as input in the analysis  For example  a sequence that begins with   CGCCTCCCGCCCCA  in the input file  begins with         TCGCGTTG  in the uniqueseq file  Another example  a sequence that begins with   CGCCTCCTGCAATA  in the input file  begins with  TCATTTTCCGCGTTG  in the uniqueseq file  I know that the uniqueseq file is supposed to have a smaller number of taxa  as some of the identical ones are removed  but it should not make changes in the sequences  right  Any ideas of what is happening   This might have something to do with it  Are you doing a partitioned analysis  https   github com Cibiv IQ TREE issues 176 You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 22908adc 90d7 43b2 87b2 524d1ffce572n 40googlegroups com  Yes  indeed  However  I am using IQ tree v 1 6 12   Hi Gabriel  Sorry for the long delay  I m back from a long break  Edward is right  that s the problem  but not a bug  Same behaviour for v1 or v2  Only with partition models will the uniqueseq file write the sites in the alignment in a different order compared to the original alignment  The reason why this is written in the github link below  Cheers Ninh To view this discussion on the web visit https   groups google com d msgid iqtree ef9bcf3f d347 4b2b 9432 5b4ca7c6c968n 40googlegroups com ",0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"kla8-RA1eUs","4/22/2021 9:52:03","12/27/2020","Concordance Factor and number of parameters Hello  I m trying to compute gene and site concordance factors  The input is composed of   Input data  225 taxa with 190 partitions and 46774 total sites  0  missing data   I concatenated multiple single gene alignments and I defined a partition for each gene  I estimated the best model for each partition using modeltest ng and I passed the result to iqtree   When I estimate a species tree everything seems to work properly       iqtree  s  msa  p  partition  B 1000   bnni  alrt 1000  nt AUTO  ntmax 24   prefix all blau lrt     The problem appears when I try to estimate gene trees in order to compute Concordance Factors      iqtree  s  msa  S  partition  nt AUTO  ntmax 24   prefix blau all locus      partition is the same partition file used to estimate the species tree  from modeltest         charset WP 015524823 1 GT718 RS07140   46135 46383  charset WP 022426467 1 GT718 RS07520   46384 46656  charset WP 022426381 1 GT718 RS02505   46657 46774  charpartition mine   LG I G4 F WP 015524754 1 GT718 RS07525  LG I G4 WP 110103921 1 GT718 RS11690  LG I G4 F WP 129975563 1 GT718 RS12570             Then I got a warning                                   WARNING                              Number of parameters  K  model parameters and branch lengths   86358 Sample size  n  alignment length   46774     When i try using way less species sequences  around 30 instead of 220  this problem dissapears  but I would like to try to use all or most of the sequences  species  What can I do to try to solve this  Regards  Jose Luis  Hi Jose  Sorry for the long delay  I m back from a long break  Quick answer  You can ignore this warning  Long answer  This warning is meant for a partition model with unlinked branch lengths   sp option in IQ TREE 1 or  Q in IQ TREE 2   But here you used  S option  so this warning does not apply  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree fdd872e0 a3f7 42f1 9f7b 707cd560e711n 40googlegroups com ",1,1,0,0,0,0,1,0,0,0,0,0,1,0,1,0,1,0,1,0,0,0,0,0,1,0,1
"kzWQ_UpjePI","4/22/2021 9:58:22","12/29/2020","800 gene partition analysis and species tree generation Hi there  I have been running an analysis for 5 days now with 15 cores and up to 125Gb of RAM and using iqtree2 1 2 for Linux  I have 800 gene nucleotide fasta alignments in a directory and I tried to merge partitions and generate a species tree with this using the following parameters  iqtree2  p aligned gene sequences single copy orthologs   m MFP MERGE   prefix concat  bb 1000  T 15  This has been running for 5 days and it is still running and looks like the bootstrap analysis is not anywhere near converging at 750 iterations  LogL   2363367 783  latest bootstrap correlation coefficient of split occurrence frequencies   0 060   I feel like something has gone very wrong since that frequency is very low  I can provide the log file in its current state if that would help figure out what could be going on  Any help would be appreciated  Thanks   Iqtree finished after 233hrs wall clock  Considering that there were  800 individual gene nucleotide fasta alignments in the alignment directory for a total of 9 bacterial strains I was expecting the resulting tree to be the concatenated  species  tree to be a tree of those 9 bacterial strains  However  the tree that was output was of 7227 taxa in one tree where it thought each gene for each strain was a different taxa  I am wondering if I have something formatted incorrectly  Each file in the alignment directory is a gene for each of the strains that was aligned and in fasta format  Files can be provided  Any insight would be appreciated  Thanks   Hi there  not knowing how the sequence headers are look like but to my understanding in each alignment the sequence header  e g  for each strain  must be identical  that the software can somehow recognize that e g  strain A in alignment 1 the same like strain A in alignment 2  If you have for example not the same header in each alignment  or an additional  strain A algn1  and strain A align2   strange that the   is 7227  I would expect rather 7200 then    Much success  Karen  This is what I thought might be the issue  I ll look into that and see  The actual number is 803 so with 9 strains that does end up at 7227  I couldn t remember the exact number offhand  Thanks for the help  Regards  Alexander Kneubehl BS Molecular Biology  2015 Ohio Northern University You received this message because you are subscribed to a topic in the Google Groups  IQ TREE  group  To unsubscribe from this topic  visit https   groups google com d topic iqtree kzWQ UpjePI unsubscribe To unsubscribe from this group and all its topics  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree d6e63645 1061 4031 b029 c6d2fd8c6f46n 40googlegroups com  Yep that was the issue  Name changes fixed everything and it wrapped up analysis in  15mins  Big difference from 233hrs LOL   Fixed the fasta headers and reran  Completed in  15mins with the expected tree  Big improvement over a 7227 taxa tree and 223hrs LOL  Thanks  On Wednesday  December 30  2020 at 10 29 09 AM UTC 6 Alexander Kneubehl wrote   Thanks a lot Karen  for the assistance  Just to confirm  eeach sequence must be named the same in all alignments in the directory  so that IQ TREEE can properly recognise and concatente them together  I found program like JalView a bit disturbing  that it appends the positions like   1 216  into each sequence name in the exported alignment files  causing IQ TREE unable to match the sequences among different alignments  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 04b7777e b50a 4bbb a382 e63b5aebd640n 40googlegroups com ",1,1,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0
"R3wFZllfOFY","4/22/2021 9:59:27","12/9/2020","Getting a branch specific rate using LSD  option  j  Hi  When using LSD with option  j  we get some additional data about each branch  sample output is attached   The output prints node id tip label  branch length  in units of substitutions site   elapsed time on the branch  root to tip distance to the node  and the date of the node  Can you guide how can one calculate the rate of each branch separately from this output  I imagine it should be the branch length in substitutions divided by the elapsed time  however  it does not give the intended result  Moreover  LSD collapses null branches  internal and others   How does that affect the rate calculation  In other words  what will be the simplest way to get a branch specific rate using this output  thanks   Hi Arshan  The branch length in the output of option  j is the branch length of the input tree  not the output tree  That s why you didn t get what you expect when you divide them to the elapsed time  For your purpose  you can divide the branch lengths of 2 output trees   nex   The one  date nex presents the elapsed time  and the other one presents the nb of substitution per site  You can do that by  for example  read the 2 nexus trees in R  However  if you have specified a tree partition  then the rate of each part  so the rate of all branches in each part  is reported in the result file  Hence  you know the rate of each branch by just looking at which part it belongs to  you don t need to divide the branch lengths of 2 output trees  The small branches are collapsed before the analysis  so their rates are not estimated in both 2 output trees  If you get some null branch lengths in the output trees  it s due to the minimim branch length   u  was set to 0  You can increase this if you want to avoid null branches  or just ignore them if you don t really need those branches  Hope that helps  Best regards  Hien You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree b70545aa 085c 4e26 82f3 55989299c528n 40googlegroups com  Dear Hein  thanks for your response  I attached my two nexus trees from the LSD output  It seems that dividing the branch lengths gives identical rate to each branch  0 023   I was under the impression that rates would be different for each branch  Am I missing or misunderstanding something  thanks for all your input  Best wishes You received this message because you are subscribed to a topic in the Google Groups  IQ TREE  group  To unsubscribe from this topic  visit https   groups google com d topic iqtree R3wFZllfOFY unsubscribe To unsubscribe from this group and all its topics  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree CAKjtwTxCSOF CuKGrHa ub83hhw4wp4qAdKdiaG9T2vjb4foqQ 40mail gmail com  Hi Arshan  The rate of all branches in the time scaled tree should be the same as you observed  and it is the rate reported in the result file   Except when you use option  E then internal and external branches have different rates  or option  p to specify tree partition then the branches in each part have different rates  Cheers  Hien To view this discussion on the web visit https   groups google com d msgid iqtree CAEyE 3DN1umRsRYcds 5jhUacw 2BcfWkKr9GYRSmDVw FA2ZV0Gug 40mail gmail com ",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0
"t5bVI7WTDUE","4/22/2021 10:04:29","12/30/2020","iq tree stuck at NNI search  Dear all  I am relatively new to iq tree  but I am using it to generate a core genome tree on a 2Gb alignment  While the processe seem to be running  I realised the log file has not been updated for more than 24h and the last thing that was written to it was                                                                         INITIALIZING CANDIDATE TREE SET                                                                        Generating 98 parsimony trees    43764 190 second Computing log likelihood of 98 initial trees     9739 769 seconds Current best score   36991990 887 Do NNI search on 20 best initial trees Estimate model parameters  epsilon   0 100  I am just wondering if this is normal behaviour or if it indicates that the process should be aborted  I am running this on a server  with the command  iqtree  s alignment grp aln  m GTR F I G4  B 1000   wbtl  nt 18 While this takes 93Gb of RAM  this should not be a problem as we have 1Tb  I am running IQ TREE multicore version 2 0 3 for Linux 64 bit built Dec 20 2020 Thanks for any help  Ricardo Ramiro  Hi Ricardo  Sorry for the long delay  I m back from a long break  I think IQ TREE was still running on your BIG alignment  The last step NNI in your log is time consuming  esp  for larg dataset like this  You can try  fast option and see if that helps  This option invoke a much faster tree search  that resembles the behaviour of FastTree  If you say more what you want to do  incl  the command line  then we might be able to give some comments how to speed it up  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 205d9a25 dc7c 4d29 b435 e1d3a1a3ab17n 40googlegroups com ",0,0,1,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0
"tM4qAxoNWu8","4/22/2021 10:06:52","11/11/2020","IQ TREE CRASHES WITH SIGNAL SEGMENTATION FAULT I searched the group for similar cases  but I see all of them are slightly different  In any case  I had not found solution  I run IQ TREE multicore version 2 1 2  I have a partitioned dataset and want to calculate model for each partition and build an ML tree after that  The software works on small portion of loci  but fails on big  I did not catch a limit yet  it can take time    I think my dataset is not too big for genomic studies    it is 8G and 1149904 partitions  Firstly I tried iqtree2 exe  s ind phy  p ind partitions phy  T AUTO  B 1000   alrt 1000   redo later I had an idea that I can calculate models first and run tree construction after that  iqtree2 exe  s ind phy  p ind partitions phy  T AUTO  m MF But all my runs had the same final  1149903 DNA 25 292 0 292 GTR p1149903 WARNING  No variant sites in partition p1149903 1149904 DNA 25 290 0 290 GTR p1149904 WARNING  No variant sites in partition p1149904 Degree of missing data  0 000 Info  multi threading strategy over partitions ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR      For bug report please send to developers  ERROR      Log file  ind partitions phy log ERROR      Alignment files  if possible  The beginning of log is  IQ TREE multicore version 2 1 2 COVID edition for Windows 64 bit built Oct 22 2020 Developed by Bui Quang Minh  James Barbetti  Nguyen Lam Tung  Olga Chernomor  Heiko Schmidt  Dominik Schrempf  Michael Woodhams  Host  Lissovsky  AVX  15 GB RAM  Command  iqtree2 exe  s ind phy  spp ind partitions phy  T AUTO  m MF Seed  603877  Using SPRNG   Scalable Parallel Random Number Generator  Time  Wed Nov 11 16 42 11 2020 Kernel  AVX   auto detect threads  12 CPU cores detected  Reading partition model file ind partitions phy     Reading alignment file ind phy     Phylip format detected Alignment most likely contains DNA RNA sequences WARNING  10842150 sites contain only gaps or ambiguous characters  Alignment has 25 sequences with 332097087 columns  1510679 distinct patterns 797310 parsimony informative  1761842 singleton sites  329537935 constant sites Gap Ambiguity Composition p value 1 t01 3 67  failed 0 00  2 h01 3 76  failed 0 00  3 opa 3 90  passed 57 07  4 t02 3 70  failed 0 00  5 h02 4 05  failed 2 44  6 a01 3 99  passed 99 95  7 nn1 4 03  passed 15 02  8 a02 3 93  passed 92 77  9 t03 3 98  passed 91 83  10 a03 3 88  passed 40 22  11 t04 4 08  failed 0 36  12 pus 4 14  failed 0 00  13 nn2 3 87  passed 7 26  14 h03 4 04  passed 9 86  15 h04 3 60  failed 0 00  16 pa1 3 96  passed 34 96  17 pa2 4 03  failed 1 14  18 t05 4 02  passed 18 57  19 a04 4 08  failed 1 26  20 a05 4 01  passed 95 44  21 a06 4 01  passed 58 33  22 man 3 96  passed 99 38  23 h05 4 17  failed 0 00  24 h06 3 94  passed 56 62  25 a07 3 70  failed 0 00       TOTAL 3 94  11 sequences failed composition chi2 test  p value 5   df 3  Partition file is not in NEXUS format  assuming RAxML style partition file    Subset Type Seqs Sites Infor Invar Model Name 1 DNA 25 290 0 290 GTR p1 WARNING  No variant sites in partition p1 2 DNA 25 292 0 292 GTR p2 WARNING  No variant sites in partition p2 3 DNA 25 292 8 280 GTR p3 4 DNA 25 292 0 292 GTR p4 WARNING  No variant sites in partition p4 5 DNA 25 292 0 288 GTR p5 WARNING  No parsimony informative sites in partition p5 6 DNA 25 292 0 292 GTR p6 WARNING  No variant sites in partition p6 7 DNA 25 292 0 292 GTR p7 WARNING  No variant sites in partition p7 8 DNA 25 290 6 280 GTR p8 9 DNA 25 290 4 286 GTR p9 10 DNA 25 292 2 284 GTR p10  Well  I have seen the error in one of my scripts and rerun it right now  Command  iqtree2 exe  s ind phy  p ind partitions1 phy  T AUTO  m MF There is the same error report  However there was some additional information that is absent in the log unfortunately  This is the final part  Without additional information in this case  New error today 257772 DNA 290 290 GTR p257772 WARNING  No variant sites in partition p257772 Degree of missing data  0 000 Info  multi threading strategy over partitions ERROR   Users minh Dropbox iqtree2 main phylotesting cpp 537  std    cxx11  stri ng computeFastMLTree Params    Alignment    ModelCheckpoint    ModelsBlock    in t    int  std    cxx11  string   Assertion  subst names size      rate names siz e    failed  This application has requested the Runtime to terminate it in an unusual way  Please contact the application s support team for more information  ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL ABORTED ERROR      For bug report please send to developers  ERROR      Log file  ind partitions2 phy log ERROR      Alignment files  if possible   Well  I found IQ tree falls down every time I use  m flag  I tried all possible options after  m  Deleting   m  starts normal execution   My apology for the delay in replying  Just too much commitment at the moment  Your dataset is simply toooo big  Does it work if you add  t PARS option to the command line  I just want to filter out that this might due to the PLL library internally used in IQ TREE  This librarry had known issue with big alignment  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree e02bdf70 41d8 4f22 9bae 20b06aa14535n 40googlegroups com  Sorry  I did not receive a notification of your answer  Will check  Dear Minh  what dataset is not big  Could you give me some starting point  ",0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0
"WoNMjYJtmFk","4/22/2021 10:08:39","12/7/2020","ERROR  Rooted constraint tree not accepted Hello everyone  I m using iqtree wish is by the way a really nice software   In my project I need to constrain topologies of house keepng genes according to a well supported consensus tree of 100 species  In order to do that I put the tree topology into a file called   constrained tree nwk and run the following command   iqtree  s EOG091B0P2P house keeping 1 fasta  g constrained tree nwk  m TEST  nt 10 But I get the following issue   Reading constraint tree EOG091B0P2P constrained topology nwk    ERROR  Rooted constraint tree not accepted I use the IQ TREE multicore version 1 6 12 for Linux 64 bit built Mar 16 2020 Does someone have an idea  I do not understand why I cannot give a rooted tree since I need my gene phylogeny to be rooted as well   Hi there  This error message is there for a reason  In the tutorial there is an example  http   www iqtree org doc Advanced Tutorial constrained tree search   Users may confuse between monophyletic clades  which is only defined on a rooted tree  versus a bipartition  which is well defined in an unrooted tree  The constraint tree only enforces bipartition  Anyway v2 removes this message by converting the rooted constraint tree to unrooted  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 49e921cc 03a4 46d6 b712 3eb1c2dd2e83n 40googlegroups com ",0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0
"X-b3TmlEdw8","4/22/2021 10:13:14","11/28/2020","suitable partition model for non coding regions Hi  thanks for reading  I ran ultrafast boot strap method on my RAD seq paired end sequence data and obtained a consensus tree and its ultrafast boot strap value on each branch  I want to exploit how concordant the values are to my data for further discussions Though  I am facing a problem trying to calculate a concordance factor and have some questions  First  I tried to create a partition file for my data  but I got lost which model I should choose  My data probably contains mostly non coding regions because it was obtained from random sites on a genome  So I guess maybe GTR I G is the appropriate one  but I m not sure  Which model is supposed to be the most appropriate for non coding regions  Second  can I choose Edge proportional partition model after creating the partition file  I think all of the three models documented in the tutorial are mainly supposed to work for coding regions  so I want know whether I can apply one to my non coding sequence data  Best wishes  Hiroto  Hi Hiroto  To calculate concordance factors  you will need to estimate a separate gene tree for each of your loci  The tutorial is here    http   www iqtree org doc Concordance Factor If I were you  I would 1  generate separate alignments for each of your ddRAD loci  2  put all of those separate alignments into a directory  and 3  then use the  S option in iqtree 2 x to direct iqtree to that directory  which will perform separate tree inference on each of those alignments  If you combine that option with  m MFP and  B 1000  for bootstraps  that will automatically determine the appropriate substitution model and build a gene tree for each ddrad locus  This will not consider amino acid or codon models  You may run into issues related to the fact that your ddRAD loci will be pretty short  but I think you could try this approach    Best  Jake  Thanks for answering  Jake  I thought a PARTITION FILE is always required to estimate separate gene trees  but with  S option  I don t have to create PARTITION FILE in prior to that  right  I think I was stuck at a very beginning part  I m gonna read the pages again and start by creating separate alignments for each locus  Best  Hiroto 2020 11 29     3 16 jacob    gmail com jacob    gmail com You received this message because you are subscribed to a topic in the Google Groups  IQ TREE  group  To unsubscribe from this topic  visit https   groups google com d topic iqtree X b3TmlEdw8 unsubscribe To unsubscribe from this group and all its topics  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 7ffecdab c384 4335 be82 c6dc834f5252n 40googlegroups com  Hi Hiroto   S is a good way to go here  so you can run the analyses to get the gene trees separately from each other  W r t  the models  it s not really about coding vs  non coding  Rather  the models simply have different numbers of parameters and or force different combinations of parameters to be equal  Which model you should choose depends on the molecular evolution of the loci you are analysing  In some cases a simple JC model is the right one  in other something more flexible like an HKY model  and often with more data you ll want a GTR model  The  I and  G are all about modelling rate variation across sites  A simple solution here is just to let modelfinder in IQ TREE choose the best model for you  The instructions in the concordance factor tutorial will do this automatically  so you don t have to worry   But do please cite modelfinder and IQ TREE when you write up your work   Cheers  Rob You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree CAFxNn 3DiKH9CERK 3DUNRidJrB 2B2QsqsmN1p0zxvayUMjg6Uka9qQ 40mail gmail com Rob Lanfear Division of Ecology and Evolution  Research School of Biology  The Australian National University  Canberra www robertlanfear com  Thanks for giving me the details  Rob  Unfortunately  I m still struggling with splitting my NEXUS file to separate ones for the size of it  So I will be able to try the  S option a bit later    Thank you for giving us this very useful option  Though I need to understand the differences between the models better  anyway I can get phylogenetic trees estimated with appropriate models  I ll gladly cite this software if I could write one  Best  Hiroto 2020 12 1     9 09 Rob Lanfear   rob l    gmail com To view this discussion on the web visit https   groups google com d msgid iqtree CAGr 2BNmo 2BJihmiOhTGc 2Br 1pipEh2jFLib2iY1oV5XZdYKdv8OA 40mail gmail com  Thanks for giving me advice  Rob  I successfully obtained a NEXUS file with Sets block and got ready to run  S option today  Though  I also got an error message below  I couldn t get any solutions on the Internet  In this case  what does this  negative site ID  mean  This is my command iqtree  s all markers mintaxa20 phy  spp all markers mintaxa20 nex  m MFP MERGE This is the error message below NOTE  No CharPartition defined  use all CharSets Loading 7579 partitions    ERROR  Negative site ID I want to know what kind of values were calculated and how the results became a negative one  if possible  Best  Hiroto  It means  something wrong with your partition file  Attach it here  we ll have a look  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree CAFxNn 3DgiamsC3x0iVsUE 2BiW 2BNxqO 3DRKXT6nMRVUs 3DG2d5oUhCQ 40mail gmail com  Ok I see the problem  Your file is rich text format  the first few lines below  You need to convert it into plain text format  If you used the TextEdiit program in Mac  click on  Format  menu and choose  Make Plain Text     rtf1 ansi ansicpg932 cocoartf2513  cocoatextscaling0 cocoaplatform0  fonttbl f0 fswiss fcharset0 Helvetica     colortbl  red255 green255 blue255  red0 green0 blue0       expandedcolortbl   cssrgb c0 c0 c0 cname textColor     info   title     subject     doccomm     author       company       copyright     keywords    paperw11900 paperh16840 margl1440 margr1440 margb1800 margt1800 vieww10000 viewh6000 viewkind0  pard tx640 tx1280 tx1920 tx2560 tx3200 tx3840 tx4480 tx5120 tx5760 tx6400 tx7040 tx7680 slleading80 pardirnatural partightenfactor0  f0 fs24  cf2 BEGIN SETS   charset 0   0 188   charset 1   188 374   Minh On 3 Dec 2020  at 5 59 pm         s8163    gmail com   wrote  Hi  Minh  I ve attached the  SETS BLOCK  part to this message  Hope you will check this out  I always appreciate your great help  Hiroto 2020 12 2     22 19 Minh Bui   minh    univie ac at  sample set block txt   Ok as you converted it to plain text properly  I now see other problems    Site ID starts from 1  not 0  You started from 0  which is not correct    A charset from site x to y are inclusive of the boundary x and y  So something like  charset 0   0 188  charset 1   188 374  will cause site 188 to occur in both partition 0 and 1  This might not be what you want    Please better name the charset with a letter at the beginning  to avoid potential misbehaviour  So name them something like p0  p1     instead of 0  1   That s it  I think  Minh On 4 Dec 2020  at 4 37 pm         s8163    gmail com   wrote  Thank you  Minh  I copied the whole content in the NEXUS file to a new file using Text Edit and ran the command with that again  but the same error message occured  As far as I can see  there seems to be no problem with it  I wish you would take a look at it again  Best  Hiroto  set block txt  ",1,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0
"X-z_GF-HAXA","4/22/2021 10:15:25","12/22/2020","Re   iqtree  Nexus partition file Hi there  Sorry for the long delay  I m back from a long break  Indeed it s simple but not easy to spot  A semi colon is missing in the declaration of p3  So change  charset p3   3297 6512 charset p3   3297 6512  Everything else looks OK with me  Cheers Minh On 22 Dec 2020  at 11 36 pm  jlr120   jl    connect hku hk   wrote  Hi  I have what I assume  and hope  to be a pretty simple issue though I ve been unable to find a solution  I ve got a partitioned alignment and I ve written a nexus partition file with the model parameters I d like for each partition based on examples I ve seen  NEXUS begin sets  charset p1   1 1519  charset p2   1520 3296  charset p3   3297 6512 charpartition matrices   TIM F I G4 p1  TIM3e R5 0 7112 0 1773 0 07464 1 502 0 09283 1 502 0 0545 3 213 0 06685 6 69  p2  TNe R6 0 5992 0 07424 0 005797 0 1616 0 003189 0 1817 0 1342 0 6685 0 07942 1 579 0 1783 4 145  p3  end  Yet each time I try to run the command iqtree2  s alignmentfile  spp partitionfile  nt AUTO I get the error  ERROR  Unknown sequence type p1  My alignment file is in nexus format and specifies that the data type is DNA  Is there something that must be included in the partition file that I ve missed  Thanks  You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 60eee243 2608 4c95 a5b1 f40b5e1a6449n 40googlegroups com ",0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0
"ZsXim-QZIc8","4/22/2021 10:19:27","1/7/2021","Constraint not found incorrect input Hi  Happy new year  I am trying to constrain a group of taxa to a single clade  on version 2 1 2  My constraint tree is defined like this   a b c d e  Where a e are the taxa I want lumped together  I have this saved as a Text Edit file  Unfortunately whenever I try to run the constrained search  iqtree  s  fasta   g  n constr  I get the following  Reading constraint tree    ERROR  File not found or incorrect input  pls check it again  I m not sure why it s displaying this  as this command worked well up until now  I have tried other constraints  without luck  like   a b c d  e  and   a b   c d e   Is there a specific file application the constraint needs to be saved to  Or a name  Many thanks in advance  Hi there  A semi colon is missing at the end of the file  Adding it should solve the problem  Moreover  a constraint  a b c d e   won t actually do anything  Because a constraint tree does not enforce anything about other taxa not appearing in the constraint tree  So other taxa might still be in the group of these 5 taxa  It make sure that the resulting tree pruned to those taxa a b c d e will obey the constraint  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree bf334911 4cc1 4b13 aabd d2953aff9561n 40googlegroups com ",0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0
"1t1fd9dAKak","4/22/2021 14:55:58","5/10/2020","Ghost model error Hi I am trying to run my UCE data with GHOST model  I used the  mrate to determine the best model  and proceeded with the analysis from there  But now I have an error that I am not sure how to solve  ratefree cpp 539  double RateFree  optimizeWithEM    Assertion  score   old score 0 1  failed  Thank you Miles  Hi Miles  Thanks for the report  I believe this is a bug in  bnni option with GHOST model  because everything works well until this step  So CC Diep  For now please refraining from using this option with GHOST model   Diep  let s have a meeting to discuss this  Cheers  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 16d7d27f bad0 4aeb 83da dc368b59c9ef 40googlegroups com  ghost log   Hi Minh  I m getting the same error using MFP LM with  S on a directory of alignments for separate tree inference  IQtree crashes on one particular alignment  but it doesn t seem to be a weird alignment  When I remove that particular alignment from the directory  IQtree crashes again because it can t resume without the full set of alignments  Would you recommend trying with  optalg BFGS   I suppose I would have to re start my run in that case  This is on IQtree 2 1 1 compiled on linux  Best wishes  Jake Berv  Hi Jake  What is the full command line you used   Diep  Can you please confirm if this bug with  bnni option was fixed or not  Minh To view this discussion on the web visit https   groups google com d msgid iqtree 520174c5 5d40 4bb8 bd0c b1af942768den 40googlegroups com  Hi Minh  Initially  I used   iqtree2  S  all loci  m MFP LM  T 63   prefix MFP LM  B 1000   safe This crashed on that previous error after a certain point  so I re started from checkpoint with the additional  optalg BFGS flag  This got much farther   seemingly through model selection  after a few additional crashes and re starts from checkpoint    however it is now crashing on the final tree inference steps  I keep restarting it and it keeps giving me a segmentation fault error using v 2 1 1  Note that these data work fine with the regular  m MFP search  Might you advise that I redo the whole analysis with  optalg BFGS   The model selection procedure took a while  WARNING  Numerical underflow for lh branch WARNING  Numerical underflow for lh branch ERROR  STACK TRACE FOR DEBUGGING  ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR      For bug report please send to developers  ERROR      Log file  MFP LM log ERROR      Alignment files  if possible  Segmentation fault  core dumped  Best  Jake  Hi Jake  does it work in v1 6 12   It s more stable  but slower   Minh  Hi Minh  It does not appear that I can duplicate this analysis in 1 6 12  because the  S option is not available  Best  Jake ",0,0,1,1,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,1
"3NgLSLRbB-Q","4/22/2021 15:22:53","6/3/2017","Feature suggestion  More than one user defined constraint tree Hi Minh and the IQ TREE team  Thanks again for the great software  My research has been made both more efficient and more flexible due to your efforts  Bravo  I have a suggestion for a future version of IQ TREE which is being prompted by a project currently in progress  Suppose we have several ingroup taxa  some of which are living animals represented by both DNA and morphology  while other ingroup taxa are fossils represented only by morphology  Also suppose that the outgroup taxa are similarly represented  some are living and some are fossils  Let s also assume that the DNA data representing the living taxa is robust   maybe a 40 gene concatenated alignment with 50 000 positions  In a model and partition scheme test using IQ TREE or PartitionFinder  or whatever software  we find it makes most sense to use 12 DNA partitions some of which use a GTR G model and others a GTR I G model  If we want to force all ingroup taxa to form a monophyletic group  we can easily do so by using the  g option  This can be done with a constraint tree like the example  monophyly constraint tree nwk  attached below  To use this in IQ TREE  I simply add   g monophyly constraint tree nwk  to the terminal call  However  if the DNA data has been used in a previous study to infer the relationships among the living taxa  and the support values for those relationships are strong   a different approach could be made  Suppose we eliminate the DNA data from the current analysis altogether and instead use only morphology   We could create a  molecular scaffold  tree based on the previous study to lock down the relationships among living taxa and allow fossils to assume their most likely positions  If we are willing to assume that the inclusion of fossil taxa won t change the relationships among living taxa  this approach has a major advantage  the software does not have to deal with GTR G and GTR I G parameters across 12 different partitions and can therefore greatly reduce processing time  This can be done with a scaffold tree like the example  scaffold constraint tree nwk  attached below  To use this in IQ TREE  I simply add   g scaffold constraint tree nwk  to the terminal call  But     What if we want to use BOTH scaffold and monophyly constraints at the same time  This would be quite advantageous  The trick of course is that we need to provide scaffold and monophyly constraint trees that are fully congruent  like the two trees attached   This can be done in MrBayes using a combination of  hard   monophyly  and  soft   backbone  constraints  TNT also offers the option to combine monophyletic group trees and skeleton trees  Both MrBayes and TNT run a congruence test on the user defined trees before processing the data and stop if the trees fail this test  My suggestion for a future version of IQ TREE would be to allow more than one constraint tree under the condition that they are congruent  Maybe the terminal call could be adapted to something like    g1 momophyly constraint tree nwk  g2 scafold constraint tree nwk   One foreseeable issue would be to preserve the code of former IQ TREE versions by setting  g and  g1 to be synonymous commands  As far as I know  RAxML does not allow more than one set of user defined constraints  If IQ TREE could incorporate this feature  it would add to the growing list of items that make your software more versatile and better adapted to deal with diverse data sets  Thanks for hearing me out  Cheers   Steven  Dear Steven  you are welcome  For your example  since the two constraint trees are congruent  you can merge them into one tree  And input this merged constraint tree into IQ TREE  right  I agree that accepting more than 1 constraint tree is still more convenient  However  right now we have a more pressing thing to do  that the constrained tree search is quite slow for taxon rich data sets because of an inefficient data structure to handle constraints  Thus  we have to improve this first  before adding further feature  Cheers  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To post to this group  send email to iqt    googlegroups com Visit this group at https   groups google com group iqtree For more options  visit https   groups google com d optout  monophyly constraint tree jpg   scaffold constraint tree jpg  Bui Quang Minh Center for Integrative Bioinformatics Vienna  CIBIV  Campus Vienna Biocenter 5  VBC5  Ebene 1 A 1030 Vienna  Austria Phone    43 1 4277 74326 Email  minh bui  AT  univie ac at  This is almost exactly what I am in need of doing  I have a trustworthy molecular tree which I can use as a scaffold my   100 extant taxa  and I have   400 fossils  The catch is that this requires the use of  soft  or  partial  constraints  which I have done extensively in MrBayes  Minh  would you clarify for me  If I specify a scaffold tree only including extant taxa   i e    I omit the fossils from the constraint tree   can the fossils  traverse  the constrained node  as in a  partial  constraint   or will they be excluded from the clades designated in the scaffold tree  In other words  does the  g newick tree specify  hard  constraint or  partial  constraint  Thank you  Brendon  Hi Brendon  On 21 Feb 2020  at 2 08 pm  Brendon Boudinot   boud    gmail com   wrote  This is almost exactly what I am in need of doing  I have a trustworthy molecular tree which I can use as a scaffold my   100 extant taxa  and I have   400 fossils  The catch is that this requires the use of  soft  or  partial  constraints  which I have done extensively in MrBayes  Can you explain what is soft   partial constraints  Minh  would you clarify for me  If I specify a scaffold tree only including extant taxa   i e    I omit the fossils from the constraint tree   can the fossils  traverse  the constrained node  as in a  partial  constraint   or will they be excluded from the clades designated in the scaffold tree  In other words  does the  g newick tree specify  hard  constraint or  partial  constraint  Any taxa not included in the constraint tree are free to move everywhere   the bottom line is that there is no constraint about them  Does that answer your question   I don t know what is partial constraint  to be honest   Cheers Minh Thank you  Brendon On Saturday  June 3  2017 at 6 30 53 AM UTC 7  steven wa     gmail com wrote  Hi Minh and the IQ TREE team  Thanks again for the great software  My research has been made both more efficient and more flexible due to your efforts  Bravo  I have a suggestion for a future version of IQ TREE which is being prompted by a project currently in progress  Suppose we have several ingroup taxa  some of which are living animals represented by both DNA and morphology  while other ingroup taxa are fossils represented only by morphology  Also suppose that the outgroup taxa are similarly represented  some are living and some are fossils  Let s also assume that the DNA data representing the living taxa is robust   maybe a 40 gene concatenated alignment with 50 000 positions  In a model and partition scheme test using IQ TREE or PartitionFinder  or whatever software  we find it makes most sense to use 12 DNA partitions some of which use a GTR G model and others a GTR I G model  If we want to force all ingroup taxa to form a monophyletic group  we can easily do so by using the  g option  This can be done with a constraint tree like the example  monophyly constraint tree nwk  attached below  To use this in IQ TREE  I simply add   g monophyly constraint tree nwk  to the terminal call  However  if the DNA data has been used in a previous study to infer the relationships among the living taxa  and the support values for those relationships are strong   a different approach could be made  Suppose we eliminate the DNA data from the current analysis altogether and instead use only morphology   We could create a  molecular scaffold  tree based on the previous study to lock down the relationships among living taxa and allow fossils to assume their most likely positions  If we are willing to assume that the inclusion of fossil taxa won t change the relationships among living taxa  this approach has a major advantage  the software does not have to deal with GTR G and GTR I G parameters across 12 different partitions and can therefore greatly reduce processing time  This can be done with a scaffold tree like the example  scaffold constraint tree nwk  attached below  To use this in IQ TREE  I simply add   g scaffold constraint tree nwk  to the terminal call  But     What if we want to use BOTH scaffold and monophyly constraints at the same time  This would be quite advantageous  The trick of course is that we need to provide scaffold and monophyly constraint trees that are fully congruent  like the two trees attached   This can be done in MrBayes using a combination of  hard   monophyly  and  soft   backbone  constraints  TNT also offers the option to combine monophyletic group trees and skeleton trees  Both MrBayes and TNT run a congruence test on the user defined trees before processing the data and stop if the trees fail this test  My suggestion for a future version of IQ TREE would be to allow more than one constraint tree under the condition that they are congruent  Maybe the terminal call could be adapted to something like    g1 momophyly constraint tree nwk  g2 scafold constraint tree nwk   One foreseeable issue would be to preserve the code of former IQ TREE versions by setting  g and  g1 to be synonymous commands  As far as I know  RAxML does not allow more than one set of user defined constraints  If IQ TREE could incorporate this feature  it would add to the growing list of items that make your software more versatile and better adapted to deal with diverse data sets  Thanks for hearing me out  Cheers   Steven You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree f04770cf 9daf 4d57 9355 9191344e6d05 40googlegroups com  Dear Minh  My apologies for the very late reply  For some reason I did not receive a notice that this question had been answered  the project I was working on is done  but I have a similar application now  Anyway  the constraint system employed by IQTree is exactly what I needed  Any taxa not in the constraint list  in my case  fossils  can move about freely in the tree  which is termed a  soft  constraint in MrBayes  Another question which is more pertinent to hypothesis testing with molecular data  Can IQTree implement  hard  constraints  i e   constraining a set of taxa and completely preventing other taxa from nesting in that set  Thank you so much  I am quite relieved and I will be proceeding soon  Cheers  Brendon ",0,0,1,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0
"aTq2wlHFOjI","4/22/2021 15:26:02","11/20/2020","Problem with building a consensus tree from VertLife  nex file Hello  I have a 10000 BS trees in a  nex file that I downloaded from VertLife   http   vertlife org phylosubsets    when I run   iqtree  t hom nex  con homCon  it reads all 10000 trees but does not like my  nex file  I get the same error if I use   net  instead of   con   Has anyone else have this issue   David IQ TREE multicore version 1 6 12 for Linux 64 bit built Aug 15 2019 Developed by Bui Quang Minh  Nguyen Lam Tung  Olga Chernomor  Heiko Schmidt  Dominik Schrempf  Michael Woodhams  Host  c1123 ll unc edu  AVX2  FMA3  251 GB RAM  Command  iqtree  t hom nex  con homCon Seed  380389  Using SPRNG   Scalable Parallel Random Number Generator  Time  Fri Nov 20 10 24 42 2020 Kernel  AVX FMA   1 threads  48 CPU cores detected  HINT  Use  nt option to specify number of threads because your CPU has 48 cores  HINT   nt AUTO will automatically determine the best number of threads to use  Reading input file hom nex    10000 tree s  loaded ERROR  Expecting      but found  T  instead  line 1 column 5   Hi David  My apology for the delay in replying  Just too much commitment at the moment  It seems like some problem with your nexus file  Does it work if you input a newick tree file  instead of nexus file  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 54daf2b8 4751 4c41 b88a 061ce90d4ea4n 40googlegroups com ",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0
"iCYyO0mFZF0","4/22/2021 15:34:10","12/2/2020","Question for iqtree  cmax I have questions about the meaning of  cmax  Is this parameter useful for long sequences  When do I need to change  cmax  How long sequence considered a long sequence    Hi there  The number of rate categories depends both on the number of sequences and the sequence length  But it has more to do with many sequences  less on long sequences  Because this is about rate heterogeneity across sites   you may observe more rate variations for alignments with more sequences  In any case  there is a default of  cmax 10 simply due to computational reason  You can of course increase this limit and observe how and whether IQ TREE finds more categories to fit better or not  The AIC BIC criterion will tell you  Cheers Minh On 2 Dec 2020  at 5 37 pm  juren xiao   4798    qq com   wrote  I have questions about the meaning of  cmax  Is this parameter useful for long sequences  When do I need to change  cmax  How long sequence considered a long sequence   You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 296c6956 cc5e 4909 b80c d4a0e4abf8dfn 40googlegroups com ",0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"khnS3lrHn5c","4/22/2021 15:45:22","11/3/2020","BUG  iqtree  m 12 12 UNREST Hi  I am trying to infer the root of my alignment  as done in a recent preprint using iqtree By default RootDigger uses no rate categories  and currently only supports the UNREST model  27   IQ TREE was executed with the arguments iqtree  m 12 12  s  MSA FILE   g  TREE FILE  The  m 12 12 argument to IQ TREE specifies that the UNREST model should be used  26  and the  g  TREE FILE  option constrains the tree search to the given user tree  When given an fully resolved unrooted tree  this has the effect of rooting the tree      https   doi org 10 1101 2020 02 13 935304  suppmat  but it almost immediatelly crashes with  full log attached       Computing log likelihood of 1 initial trees     0 050 seconds Current best score   37132 749 Do NNI search on 2 best initial trees ERROR  phylotree cpp 3575  virtual NNIMove PhyloTree  getBestNNIForBran PhyloNode   PhyloNode   NNIMove    Assertion  node1  degree      3    node2  degree      3  failed  ERROR  STACK TRACE FOR DEBUGGING  ERROR  1 funcAbort   ERROR  2    ERROR  3 gsignal   ERROR  4 abort   ERROR  6 PhyloTree  getBestNNIForBran PhyloNode   PhyloNode   NNIMove   ERROR  7 IQTree  evaluateNNIs std  map int  std  pair Node   Node    std  less int   std  allocator std  pair int const  std  pair Node   Node           std  vector NNIMove  std  allocator NNIMove      ERROR  8 IQTree  optimizeNNI bool  ERROR  9 IQTree  doNNISearch bool  ERROR  10 IQTree  initCandidateTreeSet int  int  ERROR  11 IQTree  doTreeSearch   ERROR  12 runTreeReconstruction Params   IQTree    ERROR  13 runPhyloAnalysis Params   Checkpoint   ERROR  14 main   ERROR  15   libc start main   ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL ABORTED ERROR      For bug report please send to developers  ERROR      Log file  scuba 21oct fullmtDNA fasta log ERROR      Alignment files  if possible  aln is a 14943 bp one of full mtDNA with   200 seqs   can be send if needed of course  any hint of what can be happening  thanks in advance  sara  Hi Sara  I discussed this with Ben and  g option does not work with non reversible models  This preprint may contain outdated information  If you have a fully resolved unrooted tree and want to root it  please supply this tree with  te option and turn on   root find  Moreover  by default IQ TREE only searches the root up to 2 branches away from the current arbitrary rooting position  If you want to search thoroughly  you need to increase it with   root dist option  So for example  iqtree  m 12 12  s  MSA FILE   te  TREE FILE    root find   root dist 1000 Moreover  I wouldn t use 12 12 substitution model without rate heterogeneity  So better something like  iqtree  mset 12 12  s  MSA FILE   te  TREE FILE    root find   root dist 1000 And IQ TREE will automatically detect the best rate model for this 12 12 model  Please have a look at our preprint  Assessing Confidence in Root Placement on Phylogenies  An Empirical Study Using Non Reversible Models View ORCID Profile Suha Naser Khdour View ORCID Profile Bui Quang Minh Robert Lanfear doi  https   doi org 10 1101 2020 07 31 230144 Suha  CC d  may provide additional information  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 5942b474 09cd 42be a51a bd3d84de4cc3n 40googlegroups com  iqtree crash log txt   uau  great  thanks lot for the fast reply  just a little question for now  in    root dist 1000   what are the  units        you say the default is 2 steps away from the current root but then 1000  many thanks  Sara Rocha   PostDoc Researcher CINBIO Phylogenomics Group Universidade de Vigo   Campus Universitario Lagoas Marcosende 36310 Vigo Tlf   34 986 130 050 LAB WEB www cinbio es IUCN SSC Skink Specialist Group  Twitter   skinks IUCN  https   www skinks org  Protecci n de datos  sorry  one more doubt that seems silly but  now when trying to run the cmd you advised I get this  unrelated  error  somehow it was not happening before so maybe related with current options  but I don t know why   it complains of not finding all taxa from the tree in the aln  but they do are  they are read at start   maybe something to do with the sequences it  ignores but added at the end   the identical ones   but then there are 19 of those and it only specifically complains about 5 of those    any way to prevent this behaviour  or I ll really have to infer a tree with  unique  sequences  thanks       TOTAL 0 00  0 sequences failed composition chi2 test  p value 5   df 3  NOTE  EUCE18 1027H T is identical to EICE18 887H T but kept for subsequent analysis NOTE  ENCE17 4511M N is identical to EICE18 900H N but kept for subsequent analysis NOTE  EICE18 906H T is identical to EICE18 900H T but kept for subsequent analysis NOTE  ENCE17 4528H T1 is identical to ENCE17 4511H T but kept for subsequent analysis NOTE  ENCE17 4531H T is identical to ENCE17 4528H T2 but kept for subsequent analysis NOTE  EPCE18 827H T is identical to EOCE18 469F T but kept for subsequent analysis NOTE  EUCE18 1015H N is identical to EPCE18 826H unk1 but kept for subsequent analysis NOTE  EUCE18 1018H T is identical to EUCE18 1015H T but kept for subsequent analysis NOTE  EUCE18 994H T is identical to EUCE18 1031H T but kept for subsequent analysis NOTE  FRCE17 840H T is identical to FRCE17 701H T but kept for subsequent analysis NOTE  IDCE19 636H T is identical to ICCE19 431H T but kept for subsequent analysis NOTE  N0 ICCE19 366F N0 is identical to N0 ICCE19 364F N0 but kept for subsequent analysis NOTE  PACE17 433H T is identical to PACE17 421H3 T but kept for subsequent analysis NOTE  PVCE17 1351H T is identical to PVCE17 1247H T but kept for subsequent analysis NOTE  UGCE17 2333H T is identical to UGCE17 2106H T but kept for subsequent analysis NOTE  19 identical sequences  see below  will be ignored for subsequent analysis NOTE  N0 EECE18 925F N0  identical to EICE18 900H N  is ignored but added at the end NOTE  EPCE18 851H T  identical to EICE18 900H T  is ignored but added at the end NOTE  EPCE18 853H T  identical to EICE18 900H T  is ignored but added at the end NOTE  EUCE18 1024A N  identical to EPCE18 826H unk1  is ignored but added at the end NOTE  EUCE18 1032H T  identical to EUCE18 1015H T  is ignored but added at the end NOTE  EYCE18 9H T  identical to EUCE18 1031H T  is ignored but added at the end NOTE  PACE17 970H T2  identical to EUCE18 1031H T  is ignored but added at the end NOTE  IXCE19 750H T  identical to ICCE19 431H T  is ignored but added at the end NOTE  IXCE19 759H T  identical to ICCE19 431H T  is ignored but added at the end NOTE  PACE17 569H T  identical to PACE17 421H3 T  is ignored but added at the end NOTE  PACE17 668H T  identical to PACE17 421H3 T  is ignored but added at the end NOTE  PACE17 670H T  identical to PACE17 421H3 T  is ignored but added at the end NOTE  PACE17 947H T  identical to PACE17 421H3 T  is ignored but added at the end NOTE  PACE17 959H T  identical to PACE17 421H3 T  is ignored but added at the end NOTE  PACE17 970H T1  identical to PACE17 421H3 T  is ignored but added at the end NOTE  PACE17 976H T  identical to PACE17 421H3 T  is ignored but added at the end NOTE  PVCE17 1395H T  identical to PVCE17 1247H T  is ignored but added at the end NOTE  PVCE17 1402H T  identical to PVCE17 1247H T  is ignored but added at the end NOTE  UGCE17 2401H T  identical to UGCE17 2106H T  is ignored but added at the end Alignment was printed to scuba 21oct fullmtDNA fasta uniqueseq phy For your convenience alignment with unique sequences printed to scuba 21oct fullmtDNA fasta uniqueseq phy Reading input tree file scuba 21oct fullmtDNA fasta raxml bestTree     ERROR  Tree taxon PVCE17 1395H T does not appear in the alignment ERROR  Tree taxon PACE17 569H T does not appear in the alignment ERROR  Tree taxon UGCE17 2401H T does not appear in the alignment ERROR  Tree taxon IXCE19 759H T does not appear in the alignment ERROR  Tree taxon N0 EECE18 925F N0 does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxon does not appear in the alignment ERROR  Tree taxa and alignment sequence do not match  see above   uvibesrp c6601 iqtree rooting    Hi Sara  Quick answer  use  keep ident option to keep identical sequences in the alignment  so they won t be ignored in the analysis and match your tree file  The treatment is explained here  http   www iqtree org doc Frequently Asked Questions how does iq tree treat identical sequences But indeed IQ TREE should also detect this when reading the tree file  I ll fix that in a future release  Minh  Hi Sara again  the unit is the number of branches  So   root dist 1000 means to search the root up to 1000 branches away from the initial root  This should be enough as you said to have a couple of hundred taxa  The maximal number of branches between any two taxa will be at most the number of taxa in the alignment  Minh To view this discussion on the web visit https   groups google com d msgid iqtree CAG 3Ds9gwzO gZqO8 2Br 3DX8xKx 2BFgMWJhMBnP4nPB 2Bs4 3DJgnKHe4w 40mail gmail com  Great  thanks  I was puzzles because yesterday using the same alignment and tree  but  g options  it did not give this error  thus i thought It wqs options related and did not even searched the manual  Thanks  sent from my mobile  sorry for the short reply  Thanks again  sent from my mobile  sorry for the short reply To view this discussion on the web visit https   groups google com d msgid iqtree 30B80672 80E5 421F A0D3 D03C3B652B3B 40univie ac at  Hi again  so  I tried to run it now with your suggested cmds  and it now reads properly aln and tree   iqtree2  mset 12 12  s scuba 21oct fullmtDNA fasta  keep ident  te scuba 21oct fullmtDNA fasta raxml bestTree   root find   root dist 500 but then  All model information printed to scuba 21oct fullmtDNA fasta model gz CPU time for ModelFinder  546 613 seconds  0h 9m 6s  Wall clock time for ModelFinder  552 244 seconds  0h 9m 12s  NOTE  42 MB RAM  0 GB  is required  Estimate model parameters  epsilon   0 010  Thoroughly optimizing  I G parameters from 10 start values    Init pinv  alpha  0 000  0 677   Estimate  0 000  0 163   LogL   36855 298 Init pinv  alpha  0 100  0 677   Estimate  0 101  0 218   LogL   36853 487 Init pinv  alpha  0 200  0 677   Estimate  0 201  0 290   LogL   36851 903 Init pinv  alpha  0 301  0 677   Estimate  0 302  0 391   LogL   36850 569 Init pinv  alpha  0 401  0 677   Estimate  0 402  0 552   LogL   36849 525 Init pinv  alpha  0 501  0 677   Estimate  0 501  0 849   LogL   36848 894 Init pinv  alpha  0 601  0 677   Estimate  0 599  1 566   LogL   36849 183 Init pinv  alpha  0 701  0 677   Estimate  0 659  2 863   LogL   36851 264 Init pinv  alpha  0 802  0 677   Estimate  0 670  3 321   LogL   36853 838 Init pinv  alpha  0 902  0 677   Estimate  0 690  4 671   LogL   36857 869 Optimal pinv alpha  0 501  0 849   LogL   39465 529 ERROR  modelfactory cpp 1180  virtual double ModelFactory  optimizeParametersGammaInvar int  bool  double  double   Assertion  fabs tree  getCurScore     bestLogl    1 0  failed  ERROR  STACK TRACE FOR DEBUGGING  ERROR  1 funcAbort   ERROR  2 ERROR  3 gsignal   ERROR  4 abort   ERROR  6 ModelFactory  optimizeParametersGammaInvar int  bool  double  double  ERROR  7 IQTree  optimizeModelParameters abi cxx11  bool  double  ERROR  8 runTreeReconstruction Params   IQTree    ERROR  9 runPhyloAnalysis Params   Checkpoint   ERROR  10 main   ERROR  11   libc start main   ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL ABORTED ERROR      For bug report please send to developers  ERROR      Log file  scuba 21oct fullmtDNA fasta log ERROR      Alignment files  if possible   var log slurm spool slurmd job4795231 slurm script  line 6  10251 Aborted  core dumped  iqtree2  mset 12 12  s scuba 21oct fullmtDNA fasta  keep ident  te scuba 21oct fullmtDNA fasta raxml bestTree   root find   root dist 500  uvibesrp fs6804 iqtree rooting   any idea      thanks in advance again   Hi again  any idea on how to solve this problem now   may it have to do with being a huge alignment  full mtDNA genome   and with it being trying to optimize a single model for it  for running the ML tree before I estimated different models for a bunch of partitions   is there a way to do it here for the non reversible model  and would that help be the correct way to do it  thanks again  sara  Hi  sorry to insist but can you have a look at the problem bellow  I ve not been able to solve it    thanks in advance  Hi Sara  Sorry  I didn t have the time to look at this  Does it work if you don t use I G model  Say by adding  m 12 12 G to the command line  Minh ",0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"KUFL9qO5fBI","4/22/2021 15:52:46","10/3/2020","Change Sequence names Hello  I m trying to build a consensus tree via concatenation  the main tree is already built  for running IQ Tree to generate separate gene trees I will loop it as so  for s in   aln fas  do iqtree  s  s  st DNA  m GTR FQ I G  done then cat as so  cat   treefile   all aln treefile then when running  iqtree  con  t all aln treefile I get the stderr of  Error  sequence names changed  Why are species names being changed when running IQtree on the individual alignments  How can I fix this so I can map the number of trees showing a particular partition to the branches on the original tree  Best  AAH  Hi AAH  This looks all good  But I can t find this error phrase in the source code  So can you please send the log file  which will contain the exact error message  before I can say something  Please note that the consensus tree option only works for trees with the same set of taxa  e g  bootstrap trees   Here you have gene trees  so some taxa may appear in one tree but not the other  So to overcome this  you need to compute the gene concordance factors  which generalize consensus concept for this case  See this tutorial  http   www iqtree org doc Concordance Factor FYI  Your for loop is now implemented directly in IQ TREE 2 via the  S option  capital S  see this tutorial   It s not just for convenience  but also more time effcient than the for loop when you use multiple CPU cores  IQ TREE will smartly schedule the jobs  big alignments first  such that the waiting time is minimised  Cheers  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree e8dbb408 4c47 47bf b80a fd58bf8fca20n 40googlegroups com  Hi Minh  So I am trying the concordance pipeline now  The first step is trying to build a consensus tree from a directory with the  3000 core gene alignments  Doing so  iqtree  p aln dir  m GTR G Fo  pre concat  nt AUTO only outputs a concat uniqueseq phy file but doesn t put out any tree file  what am I doing wrong  attached is the log file  Best  Austin  Hi Austin  My apology for the delay in replying  Just too much commitment at the moment  The problem is that your alignments seem to have completely different set of taxon names  from my quick skim through the log file  So it couldn t concatenate the sequences properly  So try to rename the sequences  such that they match each other  before running the analysis  Otherwise it doesn t make sense to run  p option  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 5733a6d0 5be4 464b 924c d02f1dd76688n 40googlegroups com  concat log zip  ",1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0
"O6tcEU64PAc","4/22/2021 20:02:49","11/28/2020","Re   iqtree  Problem with creating a partition file on my non coding sequence data Hi Hiroto  On 28 Nov 2020  at 8 13 am  Hiroto   s8163    gmail com   wrote  Hi  thanks for reading  I ran ultrafast boot strap method on my RAD seq paired end sequence data and obtained a consensus tree and its ultrafast boot strap value on each branch  I want to exploit how concordant the values are to my data for further discussions Though  I am facing a problem trying to calculate a concordance factor and have some questions  First  I tried to create a partition file for my data  but I got lost which model I should choose  My data probably contains mostly non coding regions because it was obtained from random sites on a genome  So I guess maybe GTR I G is the appropriate one  but I m not sure  Which model is supposed to be the most appropriate for non coding regions  You don t need to specify any models   let IQ TREE decide that for you  It s enough to prepare the partitions without any model  See the guide http   www iqtree org doc Complex Models partition models   If you go with a nexus file  you can ignore charpartition command  Just charset is enough  Second  can I choose Edge proportional partition model after creating the partition file  I think all of the three models documented in the tutorial are mainly supposed to work for coding regions  so I want know whether I can apply one to my non coding sequence data  Yes you can   why not   p option works without needing to know the type of data you have  Cheers Minh Best wishes  Hiroto You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 7ec7b89a 23d4 40ae b617 5772f17f0955n 40googlegroups com ",0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0
"UTRzfhg5ADY","4/23/2021 6:03:50","12/3/2020","Recommendations for handling coded indels  I have created a file indels phy composed of coded indels  including multi state indels  from cpDNA of alders  pop gen study   The indel states are coded as A  consistent with reference   B  C  D  and E  various indel forms   Most columns have just A and B forms  Does anyone have a suggestion how best to handle this data  I ran using  m MFP and the selected model was mtVer  mitochondrial amino acid substitution model  which is not likely the best fit   I could convert the data to binary  presence absence of every indel form  if there is not a good way to handle the multi state data  Once I settle this  I plan to run a partitioned analysis combining coded indels and DNA alignments  thanks in advance  Hi George  I don t think that the chacters A  B  C  D  E are recognised in IQ TREE  What did IQ TREE say about type of your sequences that it detected when loading in the alignment file  I d encode them as 0  1  2  3   9  A  B    Z  starting from 0  not A   Such alignment will be interpreted as morphological data  and you can specify GTR model for it  Cheerrs Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 1c390f60 cf4b 48b2 aa10 26d5ab7d84e9n 40googlegroups com  Hi Minh This is great  thank you  I will recode as 0 1 2 3 and 4  IQTree identified them as amino acids  George On Wed  Dec 2  2020 at 10 44 PM Minh Bui   minh    univie ac at   wrote   This email originated from outside of OSU  Use caution with links and attachments   To view this discussion on the web visit https   groups google com d msgid iqtree 2FC1E34C 68C8 4E7E AFA0 A77E5B399F22 40univie ac at ",0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"uWqb6GR86ts","4/23/2021 6:04:49","11/24/2020","Error not enough signal in the input temporal constraints in IQTREE v2 1 2 Hey All I am using the newest version of IQTREE2  version 2 1 2   and I am getting the same error as   https   groups google com g iqtree c zuTzkkawsOg m ZhzY1FfDAwAJ I have tried applying the same advice given in the previous post  by using single calibration with root date and tip dates as zero  Any suggestions why its not working  The calibrations are based on the fossil calibrations of the mrca  Log file  fossil calibration file  alignment file are under  IQTREE v2 1 2  error in https   github com Jigyasa3 errors Regards Jigyasa  This is a question for Hien   Hien  I use this commit of lsd2  lsd2   ae2b90f Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 7d5822a4 823e 4e78 b418 a259bbe695c5n 40googlegroups com  Hi Jigyasa  The root date should be smaller than the tips date  so your option should be   date root  130 and not 130  Please let me know if you know other issues after fixing this  Cheers  Hien ",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0
"V2Lnd3r9IHk","4/23/2021 6:09:51","11/2/2020","Questions in ancestral sequence reconstruction Hello  I m attempting to do an ancestral sequence reconstruction  trying to reconstruct two sequences  and I have some questions  I used the following script  iqtree  s alignment phy  asr  blfix  keep empty seq  m GTR G I  te newick tree txt  o Polypterus First question  I used   blfix  to maintain the topology of the newick tree I m using  The tree has no branch lengths  so  as far as I understand  branch lengths are estimated based on the sequences  Is this correct  To make this estimation more accurate  I decided to  concatenate  my two sequences  and reconstruct their ancestral state in one analysis  I figured the branch length and parameters estimation would be more accurate with a longer sequence  So I thought one  big  analysis was better than two smaller ones  Is this a good approximation  Second question  I was wondering if there is an error or something like that associated with the results I obtained  In the  log file  I can find information about the parameters determined  base frequencies  rate parameters  etc    but no information regarding error  In the  state file  there is information of likelihood of state for each position in the sequence  for each node  but I can t find error information  Is there such a thing as error  or a confidence interval  or something like that in this type of analysis  Any help on this matter would be greatly appreciated  Vicente Mu oz Walther Ph D  c  Laboratorio de Ontogenia y Filogenia Las Palmeras 3425 Universidad de Chile  Hi Vicente  On 3 Nov 2020  at 1 26 am  Vicente Mu oz Walther   tente    gmail com   wrote  Hello  I m attempting to do an ancestral sequence reconstruction  trying to reconstruct two sequences  and I have some questions  I used the following script  iqtree  s alignment phy  asr  blfix  keep empty seq  m GTR G I  te newick tree txt  o Polypterus First question  I used   blfix  to maintain the topology of the newick tree I m using  The tree has no branch lengths  so  as far as I understand  branch lengths are estimated based on the sequences  Is this correct  If your tree has no branch lengths  please remove  blfix option and IQ TREE will estimate branch lengths  The  te option is already fixing the tree topology of the given tree  To make this estimation more accurate  I decided to  concatenate  my two sequences  and reconstruct their ancestral state in one analysis  I figured the branch length and parameters estimation would be more accurate with a longer sequence  So I thought one  big  analysis was better than two smaller ones  Is this a good approximation  From my understand  you have two alignments for the same set of species  right  Yes  this is a good point  having more data in one analysis is better  You can concatenate them to a single alignment and run this same command line  For your convenience   s option in IQ TREE 2 allows a directory name  where you put two alignments  Running  iqtree2  s ALN DIR     will load  concatenate them and do the analysis as usual  It also works when some species is missing in one alignment as IQ TREE will match the sequence names  The question is now  whether you use a single model or a partition model  I suggest that you do both and compare the results  In the latter case  just replace  s ALN DIR with  p ALN DIR  Second question  I was wondering if there is an error or something like that associated with the results I obtained  In the  log file  I can find information about the parameters determined  base frequencies  rate parameters  etc    but no information regarding error  Do you mean standard error in parameter estimates  No  IQ TREE does not compute this  Although there is a formula to compute the s e   but I don t find them useful  no body will look at it   In the  state file  there is information of likelihood of state for each position in the sequence  for each node  but I can t find error information  Is there such a thing as error  or a confidence interval  or something like that in this type of analysis  The information written in  state is already providing you enough information  right  it tells you the probability of a site being an A  C  G  or T  There is nothing like confidence interval  because we have a discrete number of states here  Perhaps you mean the confidence set  You can do that by ranking A C G T by the probability  larger first  and include all states until the accumulated probability exceeds 0 95  Say for example  p A    0 8 p C    0 P G    0 17 p T    0 03  which should sum to 1  of course   The ranking of states is A  G  T  C  and the confidence set is  A  G  because p A    p G    0 97   0 95  So for this position  the state could be either A or G  although A is more likely  but we are not sure about that   Does that answer your question  Minh Any help on this matter would be greatly appreciated  Vicente Mu oz Walther Ph D  c  Laboratorio de Ontogenia y Filogenia Las Palmeras 3425 Universidad de Chile You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree CA 2BVmrY7rQMxFxuRm96yJ2OqOeG 2BwEgS5epFSzghecEHMh2RbvA 40mail gmail com  I think you answered my questions  Thank you very much   Regarding this  I think I understand what you mean by partition and single models  but I prefer to ask  just to be sure  What are these  what s the difference between single and partition models  You ve been really helpful already  Any further help would be greatly appreciated   Hi Vicente  the doc will explain this  http   www iqtree org doc Complex Models Minh  Thank you  Following your recommendation  I ve been trying to use iqtree2 and a directory to automatically concatenate the sequences  I m finding a problem nonetheless  I get the following errors  ERROR  Tree taxon Polypterus does not appear in the alignment ERROR  Tree taxon does not appear in the alignment I have double checked  and Polypterus is indeed in both alignment files  The second error I don t understand either  It seems to me that there is some taxon in the tree without a name  thus the blank space  but I have double checked and the tree is fine  What could be the problem  Any help would be truly appreciated  Just in case  the command I m using is the following  bin iqtree2  s Alignments  asr  keep empty seq  m GTR G I  te Full tree NOBL txt Alignments is the name of dir with the alignments in Phylip format  Full tree NOBL txt is a newick tree without branch lengths   Hi Vicente  I suspect there is something wrong with the newick tree file  Please send it here  I ll have a look  Minh To view this discussion on the web visit https   groups google com d msgid iqtree CA 2BVmrY7j 2B6A0kdDoLkZT47vUve1f79833ffBjEnLoZ5Y4qOsmA 40mail gmail com  The tree is in the attachment  I ll also paste in here  just in case                    Xiphophorus Poecilia N29  Cyprinodon Fundulus N28 N27 Kryptolebias N26 Oryzias N25 Pundamilia N24  Parambassis Acanthochromis N23 N22  Scophthalmus   Mastacembelus Monopterus N21  Betta Anabas N20 N19 N18 N17  Gasterosteus  Takifugu Labrus N30 N16 N15 Hippocampus N31 Periophthalmus N14 Gadus N13  Esox Hucho N12 N11  Clupea  Danio  Electrophorus  Pygocentrus Astyanax N10 N9 N8 N7 N6  Paramormyrops Scleropages N5 N4 Anguilla N3 Lepisosteus N2  oxyrhinchus ruthenus N32 N1 Polypterus NR  NR  N1  N2    and so forth are node labels  Thanks in advance   Hi Vicente  Sorry for the delay  In case if it s still relevant  I just ran the command  iqtree2  s Alignment 190 phy  asr  keep empty seq  m GTR G I  te Full tree NOBL txt in my Mac  Everything works smoothly  No error message  so I don t know what happened at your side  Minh On 17 Nov 2020  at 1 04 am  Vicente Mu oz Walther   tente    gmail com   wrote  Dear Minh  have you had any luck finding out what the problem might be  Any help would be appreciated a lot  Thanks in advance  On Thu  Nov 5  2020 at 9 11 PM Vicente Mu oz Walther   tente    gmail com   wrote  Attached are the two alignments  I m using Iqtree 2 1 2 for windows  Thanks ina advance  On Thu  Nov 5  2020 at 8 14 PM Minh Bui   minh    univie ac at   wrote  Your newick tree looks fine  Please also send me the alignment  so that I can quickly reproduce the run  Which version of iQ TREE are you using  Minh  Full tree NOBL txt  Vicente Mu oz Walther Ph D  c  Laboratorio de Ontogenia y Filogenia Las Palmeras 3425 Universidad de Chile  I think the problem might be related to the fact that I used a directory  containing two different alignments encompassing the same taxa  instead of a single file in the  s option  bin iqtree2 Alignments  asr  keep empty seq  m GTR G I  te Full tree NOBL txt Alignments is a directory that contains the alignments Alignment 190 phy and Full alignment 4 phy I ll try to solve this  by concatenating the two alignments  and using a single  phy document  instead of using a directory  Thanks  ",1,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0
"wyW5F8al5Kc","4/23/2021 6:15:21","10/22/2020","Checkpointing for four cluster likelihood mapping and likelihood mapping analyses Hi Minh  It would be nice if some checkpointing can be supported in the future versions for analyses of four cluster likelihood mapping and simple likelihood mapping  quartet analyses  so in case of power outage or similar problem not all quartets have to be calculated again  I am using 1 6 12 though I am not sure if in version 2 it is already supported  Thanks Alex  Hi Alex  You are right  likelihood mapping feature does not have checkpoint  also in version 2  This is normally fast  but indeed depends on the dataset  Especially if you do   lmap ALL  to assess all possible quartets  Also  it s not a frequently used feature and we didn t prioritize it  Heiko  howevre  You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 44de5e99 57e5 406d 908c 1f1d12cfdfd7o 40googlegroups com  PS  Heiko  do you think you can help to implement the checkpointing   Hi Minh  Many thanks  You are right this is usually very fast but also depends on the model  I used a C60 model on a relatively large dataset so for some branches with a lot of quartets it is very slow  Best wishes Alex To view this discussion on the web visit https   groups google com d msgid iqtree 7750F23D BCA6 4FD4 BDE3 E651A1187DC7 40univie ac at  Maybe its not used that oft  but I agree  I would also highly appreciate checkpointing     Since I need it as well  Many thanks in advance      Best  Karen ",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0
"yWp3Umbs4Vw","4/23/2021 6:17:34","11/10/2020","Perform non parametric bootstrap with specified partition scheme and model Hi group  I performed a search for the best partition scheme and selection of substitution models in conjunction with ultrafast boostrap approach  What I want to do next is to perform a standard boostrap analysis using the results from the previous run  So my question is if it is correct to fed the search with the best scheme nex and best model nex outputs  with the and flags  respectively  Like  iqtree  s msa phy  p best scheme nex best model nex  b 1000   prefix output Or I may be missing something with that command  Thanks in advance  My apology for the delay in replying  Just too much commitment at the moment  Use  p option  not  m   m is for single model  not a partition model   Either you can do iqtree  s msa phy  p best scheme nex best model nex  b 1000   prefix output iqtree  s msa phy  p best model nex  b 1000   prefix output The difference is that best model nex stores not only the best partitioning scheme  but also model parameters  So the second run will actually fix all model parameters  whereas the first run will re estimate model parameters  So the 2nd will be faster  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 56db4949 4e42 4b9b 9b0e a62ab6bae93an 40googlegroups com ",0,1,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0
"yWp3Umbs4Vw","4/23/2021 6:18:11","11/10/2020","Perform non parametric bootstrap with specified partition scheme and model Hi group  I performed a search for the best partition scheme and selection of substitution models in conjunction with ultrafast boostrap approach  What I want to do next is to perform a standard boostrap analysis using the results from the previous run  So my question is if it is correct to fed the search with the best scheme nex and best model nex outputs  with the and flags  respectively  Like  iqtree  s msa phy  p best scheme nex best model nex  b 1000   prefix output Or I may be missing something with that command  Thanks in advance  My apology for the delay in replying  Just too much commitment at the moment  Use  p option  not  m   m is for single model  not a partition model   Either you can do iqtree  s msa phy  p best scheme nex best model nex  b 1000   prefix output iqtree  s msa phy  p best model nex  b 1000   prefix output The difference is that best model nex stores not only the best partitioning scheme  but also model parameters  So the second run will actually fix all model parameters  whereas the first run will re estimate model parameters  So the 2nd will be faster  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 56db4949 4e42 4b9b 9b0e a62ab6bae93an 40googlegroups com ",0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0
"0FkevDPT9r4","4/23/2021 6:47:57","10/22/2020","what does manual mean by  repeat analysis   does it mean independent or sequential   In the user manual it says  While the default parameters were empirically determined to work well under our extensive benchmark  Nguyen et al   2015   it might not hold true for all data sets  If in doubt that tree search is still stuck in local optima  one should repeat analysis with at least 10 IQ TREE runs  Moreover  our experience showed that  pers and  nstop are the most relevant options to change in such case  For example  data sets with many short sequences should be analyzed with smaller perturbation strength  e g   pers 0 2  and larger number of stop iterations  e g   nstop 500   Does that mean that they recommend 10 independent runs starting from scratch  or a single run 10 times  with the output of the last being a seed for the first  Thanks   I am not sure but it seems using the same parameters or different but varying the seed  Sent from my Verizon  Samsung Galaxy smartphone You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 56299538 41bc 4543 96be 2900abbef572n 40googlegroups com  Hi  It could be either  but in practice independent is probably the way to go  the first few times   Say you have a tree for which IQTree got stuck in a local optimum  there were no trees  near  enough to the tree it had  for IQTree to find them  that were better   You can either have it start again from scratch  hoping that IQTree will luck onto a better tree  this time  or you can turn up the perturbation strength  or turn up the number of stop iterations   and start with the tree that IQTree got stuck on last time  hoping that IQTree will be able to find a better tree  near to the place it got stuck the last time  If you ve only run IQTree analysis once  you ve got an even chance of getting a tree as good or better  starting from scratch  the second time  If you start IQTree from where it got stuck the first time  your odds of getting a better tree  with a higher likelihood  aren t as good  The more times you ve repeated the analysis with the same parameters  the lower your odds of getting a better tree  if you ve already done that 10 times  the odds against getting a better tree on the 11th try are    already ten to one   Regards  James ",0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"2vM-lKqNPDk","4/23/2021 6:52:57","10/1/2020","dating a microbial tree gives a segmentation fault Hey All I am trying to fossil calibrate an alignment using a single fossil calibration on a RY tree of the alignment  also generated from IQTREE using GTR F I G model   But I get the following error  TREE 1  PROCESSING  Reading the tree     Collapse 1  over 437  internal branches having branch length    6 67e 05  settable via option  l  Parameter to adjust variances was set to 0 0505  settable via option  b  Can not estimate minimum branch lengths for time scaled tree  the temporal constraints provided are not enough  or conflict  Minimum branch length is then set to 0  settable via option  u and  U   Estimating the root position on all branches using fast method     Computing confidence intervals using sequence length 7497 and a lognormal relaxed clock with mean 1  standard deviation 0 2  settable via option  q  ERROR  STACK TRACE FOR DEBUGGING  ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR      For bug report please send to developers  ERROR      Log file  protein nucleotide cockroach extracted Treponema COG0525 fasta log ERROR      Alignment files  if possible  IQTREE Google group search shows this error is due to short branch lengths  so I am using   u 0   Code used   flash BourguignonU Tool iqtree 2 0 6 Linux bin iqtree2  s protein nucleotide cockroach extracted Treponema COG0525 fasta   date DATA FILE  te ry cockroach Treponema COG0525 treefile   date ci 100  u 0  m GTR F I G I also tried the version where I don t give the tree file  but I get the same error  Any suggestions on what might be going wrong here   The files were too big to send via email  so I have uploaded them here  https   github com Jigyasa3 errors Thanks again   Hi Arora  First  dating can not be processed with only 1 calibration node  you need the dates of tips as well  so maybe add   date tip 0 to let all tip dates to be 0 if they re all present sequences  Just another suggestion  for unrooted trees  if you have good outgroups  it s generally better to use those outgroups to define the root then let the program suggest the root for you  Then  in some recent versions of lsd2  if you calculate confidence intervals  there s a bug of printing out CI values for null branches in the output tree  This bug is reported here and has been fixed in the new version of lsd2  You can either continue to use  u 0  which allows null branches in the output tree  but so you need to wait when the new version of lsd2 integrated to iq tree  or just run the updated version of lsd2 separately   or use  u with a positive value which should be fine for your tree I think  Best regards  Hien You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree b77adce7 e4ee 42ac 9871 bc61b3ba6fb7n 40googlegroups com  Thank you so much for replying  I followed your advice and used the rooted version of the RY tree  and used the following script for 1 fossil calibration  code    flash BourguignonU Tool iqtree 2 0 6 Linux bin iqtree2  s protein nucleotide cockroach extracted Treponema COG0525 fasta   date DATA FILE  te ry cockroach Treponema COG0525 rooted nwk   date ci 100  u 1  m GTR F I G   date tip 0  pre rooted tree Question  a  The time tree nwk files  scale axis is from 5mya onwards  but the fossil calibration I added is 145 mya  How is that possible  b  how do I visualize the CI intervals on the nodes in Figtree  or is there any other software that can be used   Looking forward to your reply  Regards Jigyasa Arora  The rooted starting tree   ry cockroach Treponema COG0525 rooted nwk  and the time tree  rooted tree timetree nwk  and the log file  rooted tree log  are available here  https   github com Jigyasa3 errors  Hi Arora  You should look at the nexus file  rooted tree timetree nex  for date scaling  and for visualizing the CI intervals  In Figtree  you select Node Bars  and then display by CI height  Moreover  it seems that just your starting tree is rooted  but the treefile served as input for dating is unrooted  so lsd2 still rerooted your tree  Regards  Hien You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree ae2cbe1a b260 425f a27f 21ba6bd7edc1n 40googlegroups com  Dear Hien Thank you for replying back  I redid the analysis with   o  option to root the alignment file also  Now the root is 5000 years old  I also checked the nexus file in Figtree  but there are no CI height option in Node Bars  The nexus file  rooted tree timetree nex  is available https   github com Jigyasa3 errors  All the other files are the same as before  I also tried the version where I use only 1 sequence for rooting  but then I get an error that my outgroups are not monophyletic  which is true from the ry cockroach Treponema COG0525 rooted nwk starting tree   How do I work around it  My code   flash BourguignonU Tool iqtree 2 0 6 Linux bin iqtree2  s protein nucleotide cockroach extracted Treponema COG0525 fasta   date DATA FILE  o  mgm4583651 3 4 csv COG0525 number122  Bacteria Spirochaetes Spirochaetia Spirochaetales Spirochaetaceae Treponema 1 mgm4583651 3 4 csv COG0525 number125  Bacteria Spirochaetes Spirochaetia Spirochaetales Spirochaetaceae Treponema 1 mgm4583652 3 3 csv COG0525 number97  Bacteria Spirochaetes Spirochaetia Spirochaetales Spirochaetaceae Treponema 1 mgm4583652 3 3 csv COG0525 number99  Bacteria Spirochaetes Spirochaetia Spirochaetales Spirochaetaceae Treponema 1   te ry cockroach Treponema COG0525 rooted nwk   date ci 100  u 1  m GTR F I G   date tip 0  pre rooted tree  Hi Arora  It seems that for some figtree version  Node Bars doesn t read values in the quotes  So you need to remove all the quote marks in the nexus tree and try again  I m not sure about the problem you got when you used 1 outgroup sequence  it should be monophyletic itself and the program shouldn t complain about that  Could you give the log file for that error  Cheers  Hien You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 55b2205e f4bc 4af1 8f90 390cccc20e9fn 40googlegroups com   PFA  the log file with the error  I pressed send too quickly     Hi  I saw in the log file you have 2 outgroup sequences which are not monophyletic in the tree  so we can not determine where the root is  To have a monophyletic  you need to include all sequences in the outgroup subtree that defines the root  Hien To view this discussion on the web visit https   groups google com d msgid iqtree 75addff9 7558 4183 a7f2 53a72fac82ben 40googlegroups com  Hey Hien I am able to get a better version using 1 outgroup in new version  rooted tree3 version  log file  rooted tree3 log    Now the date on the root node is correct   145 mya   But when I compare IQTREE timetree  file  rooted tree3 timetree nex  with BEAST timetree  file  COG0525 exponentialprior consensus trees  using the same fossil calibrations  I get very different branching times for internal nodes  The BEAST tree ages correspond more to what we expect for this group  while IQTREE ages are twice as old  PFA all the files mentioned here   https   github com Jigyasa3 errors I understand that the model I have used in IQTREE is a simple one  but the age difference is double  Any suggestions  Model used in BEAST for comparison  Clock model strict clock  site model  GTR gamma  tree model  Yule model  Regards Jigyasa Arora  Hi Arora  Not sure if I understand it correctly  but I didn t see fossil calibration in your beast tree  Your DATA FILE indicates that the most common ancestor of the 5 sequences   mgm       is 145  while I saw that it s about 3 3 in the beast tree  Was it something confusing between the root and the most common ancestor of outgroups  How did you define the time constraints outgroups in beast  Hien To view this discussion on the web visit https   groups google com d msgid iqtree 53bdc35d 6e66 4063 8dc1 1d413f94db25n 40googlegroups com  Hey Hien Sorry  my DATA FILE was completely wrong  The fossil calibration is supposed to be at the node between 5 mgm    sequences and those starting with numbers  301     229    272    230      I have the corrected version now  I still have a few questions  a  I have added upper and lower bounds in the calibration file  DATA FILE   and this time not using a starting tree  final files  2 nostarttree timetree nex  nostarttree log    But the comparison with BEAST tree   COG0525 exponentialprior consensus trees   shows that the age of the nodes is vastly different  Code used   flash BourguignonU Tool iqtree 2 0 6 Linux bin iqtree2  s protein nucleotide cockroach extracted Treponema COG0525 fasta   date DATA FILE  o  mgm4583651 3 4 csv COG0525 number122  Bacteria Spirochaetes Spirochaetia Spirochaetales Spirochaetaceae Treponema 1 mgm4583651 3 4 csv COG0525 number125  Bacteria Spirochaetes Spirochaetia Spirochaetales Spirochaetaceae Treponema 1 mgm4583652 3 3 csv COG0525 number97  Bacteria Spirochaetes Spirochaetia Spirochaetales Spirochaetaceae Treponema 1 mgm4583652 3 3 csv COG0525 number99  Bacteria Spirochaetes Spirochaetia Spirochaetales Spirochaetaceae Treponema 1    date ci 100  u 1  m GTR F I G   date tip 0  pre nostarttree b  If I add more than 1 fossil calibration in the file  DATA FILE2   I get an error that the DATA FILE2 is not correct  I am following the http   www iqtree org doc Dating format  files DATA FILE2 rooted tree micro log are attached for reference  I want to use multiple fossil calibrations but wanted to test them one at a time  All files are here  https   github com Jigyasa3 errors Thanks again for all the help  Jigyasa  Hi Arora  Sorry for the late response  here s what I can see so far  a  You re using version 2 0 6 of iq tree  which uses an old version of lsd2  I have updated lsd2 that fixed some bugs  some of them are integrated in the new version of iq tree  2 1 1   some are not  I think your data is a bit special that needs to adapt some options instead of using the default ones of lsd2  So I suggest you to run lsd2 separately here   https   github com tothuhien lsd2   to make the test faster  For this  you can run iq tree with option   date debug  that would  at the end  generate some extra files for you to run lsd2 alone  You have the command in the log file  Building time tree by least square dating  LSD  with command       that you can adjust and add more custom options  First  your outgroup is very far from the ingroup sequences  the branch associated to outgroups of your tree is significantly long compared to the rest  This generally causes bias in estimating root date  To penalize the effect of long branches  you can use the option  b to adjust the variance of branch length  By default  it s the median of branch lengths  it s value is reported in the standard output   The bigger it is  the smoother the variances  all branches tend to have the same variance   The smaller it is  the more variances depend linearly to branch lengths  In your case  I think you should set  b smaller to show that variance of the long outgroup branch is very high  Second  you can try to run lsd2 twice  where the second time we use the branch lengths of the first run to calculate the variances  Option  v 2 is used for this  Upon simulation data  in some cases that helps to improve the results  Finally  when all your tips dates are equal  you need at least one fixed  not a range  fossil calibration in order to have a unique solution from lsd2  Otherwise  the old lsd2 version just selects one of the limite for the fossil and gives you the solution corresponding to that  the new version now throws an error  Just a remark  option  u 1 that you used in iqtree command didn t pass to lsd2  because it s a command of lsd2  not iqtree  To use this option through iqtree  you should put it in   date options   u 1   But if you re running lsd2 separately  just set  u 1  or any positive value for minimum branch length of output tree   b  As you see in the log file   ERROR  Line 2        there s an error related to the sequence 272 52  MAD15 s       Actually there s an extra space in the sequence just before it  Hope that helps a bit  Cheers  Hien To view this discussion on the web visit https   groups google com d msgid iqtree 26ed5832 622d 4f52 ba80 abf287ff4744n 40googlegroups com  Thank you so much for replying  Hien  I did as you recommended  I am using iqtree 2 1 1 version now and I have installed lsd2 also  I am using the outputs from iqtree2   date debug into lsd2  but I get the following error  Code used for IQTREE2 to get files to run LSD2    flash BourguignonU Tool iqtree 2 1 1 Linux bin iqtree2  s new protein nucleotide cockroach extracted Treponema COG0525 fasta  m GTR F I G   date debug  pre COG0525 datedebug  o  mgm4583651 3 4 csv COG0525 number122  Bacteria Spirochaetes Spirochaetia Spirochaetales Spirochaeta ceae Treponema 1  NA NA NA NA NA mgm4583651 3 4 csv COG0525 number125  Bacteria Spirochaetes Spirochaetia Spirochaetales Spirochaetaceae Tr eponema 1  NA NA NA NA NA mgm4583652 3 3 csv COG0525 number97  Bacteria Spirochaetes Spirochaetia Spirochaetales Spirochaetaceae Treponema  1  NA NA NA NA NA mgm4583652 3 3 csv COG0525 number99  Bacteria Spirochaetes Spirochaetia Spirochaetales Spirochaetaceae Treponema 1  NA NA  NA NA NA mgm4583652 3 3 csv COG0525 number105  Bacteria Spirochaetes Spirochaetia Spirochaetales Spirochaetaceae Treponema 1  NA NA NA NA NA   d DATE FILE2 Code used for LSD2    flash BourguignonU Tool lsd2 src lsd2  i COG0525 datedebug timetree subst  d DATE FILE2  o lsd COG0525  b 0 1  g COG0525 datedebug timetree outgroup  v 2  s 7497  u 1  f 100  z 0 Error  Reroot the tree s  using given outgroups     TREE 1  PROCESSING  Reading the tree     Collapse 0  over 437  internal branches having branch length    6 66933e 05  settable via option  l  Minimum branch length of time scaled tree  settable via option  u and  U   1 Error  There s conflict or not enough signal in the input temporal constraints  All the files and also the log file from IQTREE https   github com Jigyasa3 errors  Hi Jigyasa  The command that you used confused a bit about the date file format and the options  For input date file  iq tree uses option   date  and lsd2 uses option  d  Their date file formats are also different  I ve attached here an example of 2 date files for 2 programs  Actually when you run iq tree with   date debug option  it will generate the date file of lsd2 for you  I also found some issues in your date file    As I said you should have at least one fixed calibration fossil  can not have all as intervals     The fossil dates should be more ancient than the tips date  so they should be negative    And  I haven t checked carefully  but it seems that your 2 calibration points refer to the same internal nodes  that may also cause the conflict  Cheers  Hien You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree ee6649a4 9d8d 4368 b5ae 31b634549984n 40googlegroups com  Hi Hien and others  I have just released IQ TREE v2 1 2  which integrates the latest LSD2 version 1 9 7  Hope that this will fix issues recently posted here  Cheers Minh To view this discussion on the web visit https   groups google com d msgid iqtree CAKjtwTxpwbGnMLOqSJfYNCJvyM90MzRQC5w 2B 2BTHXhe 3D18R4pfQ 40mail gmail com  DATE iqtree txt   DATE lsd txt  ",0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0
"5LlleFo3UeU","4/23/2021 6:57:38","10/16/2020","Why there are not available bootstrap in teh fast mode of tree search  I am trying to run the following code  iqtree2  s input fasta  nt AUTO  mem 1000G  o EPI ISL 406801  fast  keep ident  m GTR F R4  alninfo  bb 1000 But a message appear that we cannot add  bb parameter when  fast is present  Why is that  How can i perform the bootstrap in this case  How can i accelerate the analysis of my analysis of roughly 50 000 sequences of 30 000 lenght  thanks for your answer  Dear Santiago  The ultra fast bootstrap  UFBoot  which one enables by  bb  requires the huge amount of trees seen during the  normale  tree search in IQ TREE  The search here can even be prolonged by UFBoot if the sample is not large enough yet  when the normal tree search without UFBoot would already stop  The fast option causes IQ Tree to no do the full search  but only do 2 trees  1x parsimony starting tree and the NJ starting tree  to be evaluated by ML and optimised by NNIs  This only gives a quick preliminary glimpse towards a result  and is similarly fast and similarly sub optimal compared to  e g   FastTree  These fast runs should not be seen as a proper substitute for the full search  The set of tree touched during the evaluation of the two trees and their NNI optimisation is by far to small to do any meaning full UFBoot analysis  This is the reason why you cannot have UFBoot with the  fast option  even if you state  bb  However  it is still possible to do a standard bootstrap  with  b  as this samples randomly from the alignment and does a fast mode tree search on this  Please member that the number of bootstraps performed should rather be larger than the often used absolute minimum of 100 bootstrap samples  This minimum was once determined in the past for much smaller datasets than those we have nowadays  I hope this answers your question  Best wishes  Heiko        You received this message because you are subscribed to the Google Groups  IQ TREE  group    To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com   To view this discussion on the web visit https   groups google com d msgid iqtree 36800a48 6fde 401f a362 843ae0334239n 40googlegroups com                                                                               Heiko Schmidt Center for Integrative Bioinformatics Vienna  CIBIV  University of Vienna   Max Perutz Labs http   www cibiv at                                                                                ",0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0
"89egH8Z8sDY","4/23/2021 7:16:47","10/1/2020","Help with reconstruction of ancestral sequence I m trying to reconstruct the ancestral sequence of an enhancer using IQ TREE  I have the enhancer sequences for several organisms and their phylogenetic relationships  with branch lenghts included   coded in the following Newick tree                  Xiphophorus 0 163704 Poecilia 0 163704  0 30415  Cyprinodon 0 40872 Fundulus 0 40872  0 059138  0 1919 Kryptolebias 0 659753  0 098759 Oryzias 0 758508  0 076102 Pundamilia 0 834611  0 011208  Parambassis 0 82257 Acanthochromis 0 82257  0 023255  0 066068  Scophthalmus 0 796596   Mastacembelus 0 59803 Monopterus 0 59803  0 082706  Betta 0 39546 Anabas 0 39546  0 28527  0 11586  0 11529  0 023867  Gasterosteus 0 791517 Labrus 0 791517  0 14424  0 103656 Periophthalmus 1 04121  0 336975 Gadus 1 37639  0 433232  Esox 0 82349 Hucho 0 82349  0 98612  0 38432  Clupea 1 9049  Danio 1 45489  Electrophorus 1 2594  Pygocentrus 0 85253 Astyanax 0 85253  0 40687  0 19548  0 45004  0 289  0 22731  Scleropages 1 8936 Paramormyrops 1 8936  0 52768  0 073013 Anguilla 2 49425  0 53182 Lepisosteus 3 02611  0 55924 Acipenser 3 5853  0 82294  The problem I m having is that the node I m most interested in is the first one  common ancestor of Acipenser with every other organism in the tree   which is not reconstructed by IQ TREE  It reconstructs the ancestral sequence of each node starting from the second one  common ancestor of Lepisosteus and every other organism  onwards  I ve thought of a solution  although I m not quite sure how good of a solution it is  I m thinking of making up a  mock  outgroup  in which I ve made up the sequence completely  but leaving the binding sites of the sequence  the parts I m most interested in  as unknowns  coded as  N  in the sequence   Would this be a good solution  If not  is there a better solution for this problem  Any help on this matter would be greatly appreciated   Hi there  Yes  your solution is sensible  Also add an option  keep empty seq in the command line  so that IQ TREE won t discard this sequence from the analysis  Also if you want to fix the branch lengths like this  use option  blfix  Otherwise IQ TREE will reestimate the branch lengths based on alignment and model  Cheers MInh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 160702ce c39a 4054 a34d 390f9956a5a4n 40googlegroups com  Thank you so much  You ve been really helpful  I will try this  Vicente Mu oz Walther Ph D  c  Laboratorio de Ontogenia y Filogenia Las Palmeras 3425 Universidad de Chile  I ve got one further question  In the example shown on   http   www iqtree org doc Command Reference   about ancestral reconstruction  the model of substitution used is  JC G   The line of code is as follows  iqtree  s example phy  m JC G  asr As I understand it  JC refers to the Jukes and Cantor model of substitution  but I m not quite sure what the  G means  Is this the best model of substitution  or are there better options  I m quite new to this topic  so any help would be really appreciated   Hi Vicente It is the Gamma distribution  this model assumes that the substitution rate at each site is a random variable that is described by a discretized gamma distribution  which has two parameters  the shape parameter     and the rate parameter     In order that we can interpret the branch lengths as the expected number of substitutions per site  this model assumes that the mean site rate is equal to 1  If you want to know a little more  I invite you to read  https   link springer com article 10 1007 BF00160154 https   www researchgate net publication 281591353 Modelos de sustitucion de nucleotidos y otros modelos https   www ccg unam mx  vinuesa Cursos PDFs BGE4 Tema4 modelos de sust nt pdf Cristian E  Cadena Caballero Biologist Coelomed genomics laboratory  Industrial University of Santander   Thank you  To view this discussion on the web visit https   groups google com d msgid iqtree bf3a1e4a d299 4b64 8f52 29b78cf758b6n 40googlegroups com  I have one further question  I would really appreciate any help  I did the sequence reconstruction using a  mock  outgroup with a  NNNN     sequence  to reconstruct the sequence of the first node  N1   which is the most interesting to me  By doing this  I introduced a new node which I called NR  Node root   The Newick tree used is                   Xiphophorus 0 163704 Poecilia 0 163704 N29 0 30415  Cyprinodon 0 40872 Fundulus 0 40872 N28 0 059138 N27 0 1919 Kryptolebias 0 659753 N26 0 098759 Oryzias 0 758508 N25 0 076102 Pundamilia 0 834611 N24 0 011208  Parambassis 0 82257 Acanthochromis 0 82257 N23 0 023255 N22 0 066068  Scophthalmus 0 796596   Mastacembelus 0 59803 Monopterus 0 59803 N21 0 082706  Betta 0 39546 Anabas 0 39546 N20 0 28527 N19 0 11586 N18 0 11529 N17 0 023867  Gasterosteus 0 791517 Labrus 0 791517 N16 0 14424 N15 0 103656 Periophthalmus 1 04121 N14 0 336975 Gadus 1 37639 N13 0 433232  Esox 0 82349 Hucho 0 82349 N12 0 98612 N11 0 38432  Clupea 1 9049  Danio 1 45489  Electrophorus 1 2594  Pygocentrus 0 85253 Astyanax 0 85253 N10 0 40687 N9 0 19548 N8 0 45004 N7 0 289 N6 0 22731  Scleropages 1 8936 Paramormyrops 1 8936 N5 0 52768 N4 0 073013 Anguilla 2 49425 N3 0 53182 Lepisosteus 3 02611 N2 0 55924 Acipenser 3 5853 N1 0 30264 Polypterus 3 88793 NR  Polypterus serves as the mock outgroup  Doing this  I was attempting to reconstruct a position of particular interest to me  which it managed to do  Thinking about it  I find it curious  This position is a T in Acipenser and C in the rest of the tree  There is a split at the base of the tree  in which one branch  Acipenser  is one way  T   and the other  the rest of the tree  is another C   So I d say there s a 50  chance of that position being either C or T  But  the algorithm reconstructed an 80  chance of it being C  Is this result meaningful  or is it some sort of bias or artifact resulting from the methodology I used  the mock outgroup methology   Would adding more taxa with  NNNNN     sequences in different positions in the tree change this result in any way  Any help would be tremendously appreciated   Hi Vicente  As discussed  adding  mock  outgroup is totally fine  no biases or things like that  When you say only one sequence shows a T  and the rest   30 sequences or so  show a C  why do you think that there is 50 50 being C or T  Note that this is the reconstruction with a model  under a mixed likelihood and empirical Bayesian approach   not the parsimony ancestral construction  This model may show different substitution rates between the bases  say C  T is not equally likely as T  C or C  A  Moreover  the branch lengths also play a role  The tree you posted is a clock like tree  or cladogram  perhaps only for drawing purpose  If that s the case  I would not use these branch lengths for the ASR inference because they must be in the units of substitutions per site  and hence ignore my previous comment about using  blfix option  Cheers Minh To view this discussion on the web visit https   groups google com d msgid iqtree CA 2BVmrY7Ddz0QbK3COf0vSc1mii eczQwr9 3Dq7SsYZ292oScYTQ 40mail gmail com  Thank you so much  The branch lengths I obtained from a publication that estimated divergence times using molecular data calibrated with the fossil record  Hughes et al   2018   The sequence I m trying to reconstruct is quite short  around 40 pb   so I don t believe that the program would get accurate branch lengths based on the alignment  Or maybe that doesn t really matter  Should I still not use the  blfix option  Again  thanks for any help you can provide   Then defintely do not use these branch lengths for ASR reconstruction  because they are expressed in different units  not the number of substitutions per site  You need to extract the branch lengths from before they did the transformation  If that s still not available  simply ignore  blfix option  Minh To view this discussion on the web visit https   groups google com d msgid iqtree CA 2BVmrY5M1AWYv62ENst79f7d6Qy 2BifJv4wE6pQEnYj6Xvdsp9Q 40mail gmail com  I ve found that when doing ancestral state reconstruction using the  blfix option  I get Rate parameters and Base frequencies in the  log file  Such as  Rate parameters  A C  1 79418 A G  9 23818 A T  1 02706 C G  3 60946 C T  6 72761 G T  1 00000 Base frequencies  A  0 207 C  0 180 G  0 225 T  0 388 I do not get this information when not using the  blfix command  Is there a reason for this  The command I m using is  bin iqtree  s Full alignment 4 phy  asr  keep empty seq  m GTR G I  te Full tree NOBL txt  redo  o Polypterus  blfix  keep empty seq to use the  mock  sequence full of  NN      m GTR G I is the substitution model  o Polypterus to set the  mock  outgroup as an outgroup  blfix to fix branch lengths  I ve tried with and without this option  Since I m not using branch lengths  I can t obtain branch lengths in the unit of substitution site   I understand that I should not use this option  Any further help would be greatly appreciated  ",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0
"B6kyoqSM4ws","4/23/2021 7:17:37","10/21/2020","Consensus trees  quick question  When I run  iqtree  con mytrees  minsup 0 5 What is the output filename  Is there any way to assign or specify  Does it print it to the command line unless I use     to assign it to a file   just checked its written to mytrees contree If you run  con mytrees lstree it becomes mytrees lstree contree ",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0
"FKWR2uxx0s4","4/23/2021 7:24:56","10/8/2020","Error when constructing species tree using concatenation Hello Minh et al  I am trying to establish gcf and scf for my data set  I have successfully conducted my gene tree analysis with 2413 genes  I am now trying to make a species tree using the concatenation approach which always give me an error  attached   I am not sure how to interpret this error  I am running the analysis on a computing cluster using  iqtree 2 0 rc2    Thank you so much for your help  Manpreet  Hi Manpreet  Please remove  mem option  it does not work in combination with partitioned models   p option   Normally an error message like that should have been printed  Thanks Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 7756f51c d8da 4f86 94d4 1428e7436dd8n 40googlegroups com  output txt   PBS SAMPLE OpenMPI Speciestree sh   error txt   Hello Minh  Thank you so much for your reply  Removing the  mem option and allocating a large amount of memory works  earlier I was using 64gb which failed  but 128 gb works   Manpreet ",0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0
"GBVelrhCttw","4/23/2021 7:27:42","10/20/2020","Best way to evaluate results  combine vs compare  from 10 independent runs I am running 10 independent IQTREE runs  and was wondering if my results would be more accurate by picking the tree with the best log likelihood value  or using the runs to build a consensus tree with support values  And if the later is better  what is the best way to do that  The section on this in the manual seems to be meant for building consensus trees from other programs  Should I be building a consensus off of the 10 consensuses for the 10 independent runs  Would that be enough to generate useful support values  Thank you  I found a relevant post by Tung Nguyen   Best practices for IQ TREE tree search     Dear IQ TREE users  For most alignments  the default setting for the tree search in IQ TREE should work fine  However  sometimes you might need or simply want to fine tune the tree search to get the best results  Here I will provide some recommendations for improving the search  Because the number of possible trees is astronomically large  no tree search heuristic can guarantee the optimal tree  The so called maximum likelihood tree that you get from any phylogenetic reconstruction program is in fact only an approximation of the ML tree  However  if you have a lot of data  very long alignment   the chance of getting the optimal tree is increased  If your alignment is short and have a lot of taxa  very little phylogenetic signal   finding the true ML tree could be very difficult  In any case  it is recommended to runs IQ TREE several times and compare the tree log likelihoods  If the log likelihoods  and the tree topology  are all the same  then there is a high chance that you already have the optimal tree  If you observe a large variance among the log likelihoods  you might need to run the tree search as many times as possible and take the best tree  The log file   screen output also gives you some indication about whether repeating the search many times is necessary  During the tree search  IQ TREE samples a lot of locally optimal trees and produce a locally optimal tree in each iteration  The log likelihood of the locally optimal trees are printed after every 10 iterations  If you want to see the log likelihood of all locally optimal trees  turn on the flag  v  verbose   Toward the end of the search  if the log likelihoods seem to converge  some iterations produce the same log likelihood  then you might only need to repeat the search few more times  If they do not  you should repeat the search as many times as possible  The following options are also useful   pers  proportion   adjust the strength of the perturbation method  which helps IQ TREE escape local optima  The default value is 0 5  If you think that the search does not converge  it is sensible to reduce the perturbation strength  e g   pers 0 1 or  pers 0 2   numstop  number   adjust the stopping rule  In the default setting  IQ TREE will stop if it cannot find a new best tree in the last 100 iterations  You can increase this number to make IQ TREE search more thoroughly  e g   numstop 500   wt  write all locally optimal trees into  treels  This option might be useful if you want to take a look at the alternative trees  You can also build a consensus tree from these trees  Sometimes the consensus tree might have higher log likelihood than the best locally optimal tree  Last but not least  large log likelihood variance among IQ TREE runs often means that your data does not contain enough phylogenetic signal  In such case  you have do some statistical tests to access the branch support  UFBoot  aLRT  standard bootstrap   With little data  even if the optimal tree could be found  it might still look very different from the true tree     Hi Bio Student  The information you found is indeed very helpful  To your question  I wouldn t use the consensus tree of the runs  but just use the consensus tree of the bootstrap trees  This is a typical way of getting support values in phylogenetics  Whereas the values on the consensus tree of the different runs only showed the variation between the runs  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree f62e07f9 fafb 4c99 b78a e53f81a087f4n 40googlegroups com ",0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"hZbQVDl-rt8","4/23/2021 7:37:12","10/20/2020","Phylogenetic dating   continuing after initial bootstrap partition run Hi All  I am trying to run the phylogenetic dating option on the results of an initial ML partitioned bootstrap run  The initial run used the following command  iqtree2  p internal     prefix concat50internal  B 1000    nt AUTO  ntmax 20    m MFP MERGE   merge model GTR   merge rate G   rclusterf 10   cptime 4000 Now I want to date the resulting tree file using the results  partition  models  tree  I have tried the following  iqtree2    p internal    T AUTO    pre concat50internal     undo   date date file txt     date ci 100     date root  324     date tip 0     date root  324    te concord50internal cf r tree My understanding is the   undo  will allow me to alter the command options from a previous run and continue the run  Since i am giving it the same prefix as before my hope is that it will use the model and partition results from that run  I am also giving it the tree from that run as a constraint tree via   te   After some trial and error i got it to load the constrain tree   had to reroot it and NOT specify the outgroup  gave me an error when i did  For the moment it seems to be running  but it still seems to be doing model selection even though it has read in the check point file model file  see log below  Am I missing something with the dating settings  or is this running the way it should be  Also is this the best way to use the dating option for a run that has previoulsy completed  Thanks Pete                     NOTE  Restoring information from model checkpoint file concat50internal model gz Reading input tree file concord50internal cf r tree     rooted tree Perform fast likelihood tree search using GTR I G model    CHECKPOINT  Tree restored  LogL   14957149 716 NOTE  ModelFinder requires 246 MB RAM  Selecting individual models for 1933 charsets using BIC    No  Model Score TreeLen Charset 1 HKY F R2 21862 680 1 398 uce 111423 nexus NOTE  21 996 seconds to dump checkpoint file  increase to 440 000 2 K3P R3 16099 923 0 997 uce 112159 nexus 3 HKY F G4 19684 550 1 238 uce 990291749 nexus 4 K2P R3 19638 733 1 379 uce 115319 nexus 5 HKY F R3 19770 359 1 792 uce 112165 nexus 6 TPM2 F R3 18033 689 1 440 uce 794 nexus 7 TN F R4 28057 796 4 221 uce 990272081 nexus 8 TPM2 F R4 40033 229 7 197 uce 2599 nexus 9 TN F R3 18147 396 1 366 uce 990293089 nexus 10 GTR F G4 20720 325 1 722 uce 113337 nexus 0h 5m 13s  16h 43m 35s left  11 HKY F R3 20542 215 1 579 uce 558 nexus 0h 5m 45s  16h 46m 53s left                will report any progress   Hi Pete    undo will also load the model checkpoint file  It s just printing the information again  but no calculation is done  You will notice that this is running much faster than the previous run  You can make it faster by feeding  p option with the best scheme nex file printed in the previous run  so you don t need to use   undo option  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 3b00c602 b850 4a7a 9f84 20b88603133dn 40googlegroups com ",0,0,1,0,1,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0
"hZbQVDl-rt8","4/23/2021 7:40:25","10/20/2020","Phylogenetic dating   continuing after initial bootstrap partition run Hi All  I am trying to run the phylogenetic dating option on the results of an initial ML partitioned bootstrap run  The initial run used the following command  iqtree2  p internal     prefix concat50internal  B 1000    nt AUTO  ntmax 20    m MFP MERGE   merge model GTR   merge rate G   rclusterf 10   cptime 4000 Now I want to date the resulting tree file using the results  partition  models  tree  I have tried the following  iqtree2    p internal    T AUTO    pre concat50internal     undo   date date file txt     date ci 100     date root  324     date tip 0     date root  324    te concord50internal cf r tree My understanding is the   undo  will allow me to alter the command options from a previous run and continue the run  Since i am giving it the same prefix as before my hope is that it will use the model and partition results from that run  I am also giving it the tree from that run as a constraint tree via   te   After some trial and error i got it to load the constrain tree   had to reroot it and NOT specify the outgroup  gave me an error when i did  For the moment it seems to be running  but it still seems to be doing model selection even though it has read in the check point file model file  see log below  Am I missing something with the dating settings  or is this running the way it should be  Also is this the best way to use the dating option for a run that has previoulsy completed  Thanks Pete                     NOTE  Restoring information from model checkpoint file concat50internal model gz Reading input tree file concord50internal cf r tree     rooted tree Perform fast likelihood tree search using GTR I G model    CHECKPOINT  Tree restored  LogL   14957149 716 NOTE  ModelFinder requires 246 MB RAM  Selecting individual models for 1933 charsets using BIC    No  Model Score TreeLen Charset 1 HKY F R2 21862 680 1 398 uce 111423 nexus NOTE  21 996 seconds to dump checkpoint file  increase to 440 000 2 K3P R3 16099 923 0 997 uce 112159 nexus 3 HKY F G4 19684 550 1 238 uce 990291749 nexus 4 K2P R3 19638 733 1 379 uce 115319 nexus 5 HKY F R3 19770 359 1 792 uce 112165 nexus 6 TPM2 F R3 18033 689 1 440 uce 794 nexus 7 TN F R4 28057 796 4 221 uce 990272081 nexus 8 TPM2 F R4 40033 229 7 197 uce 2599 nexus 9 TN F R3 18147 396 1 366 uce 990293089 nexus 10 GTR F G4 20720 325 1 722 uce 113337 nexus 0h 5m 13s  16h 43m 35s left  11 HKY F R3 20542 215 1 579 uce 558 nexus 0h 5m 45s  16h 46m 53s left                will report any progress   Hi Pete    undo will also load the model checkpoint file  It s just printing the information again  but no calculation is done  You will notice that this is running much faster than the previous run  You can make it faster by feeding  p option with the best scheme nex file printed in the previous run  so you don t need to use   undo option  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 3b00c602 b850 4a7a 9f84 20b88603133dn 40googlegroups com ",0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,0,0
"pFZN7ki_VMo","4/23/2021 7:50:49","9/23/2020","question about rooting method in phylogenetic dating Hi everyone  I would like to perform molecular clock analysis and build a time tree with my datasets  I note that it is possible to automatically identify an unrooted tree best root position by specifying an additional option in the command line     date options   r a    I have several questions about this rooting method    Is it possible to use this option with a fixed tree topology   te option  existing DNA tree        How can I check which sequence s  from my data set  time tree and alignement  has been assigned as outgroup s   Best regards Gabriel  Hi Gabriel  On 24 Sep 2020  at 1 21 am  gabriel     gmail com gabriel    gmail com   wrote  Hi everyone  I would like to perform molecular clock analysis and build a time tree with my datasets  I note that it is possible to automatically identify an unrooted tree best root position by specifying an additional option in the command line     date options   r a    This is the default behaviour and you don t have to set this option  if the treee is unrooted  IQ TREE LSD2 will automatically determine the best root position  I have several questions about this rooting method    Is it possible to use this option with a fixed tree topology   te option  existing DNA tree      YES   How can I check which sequence s  from my data set  time tree and alignement  has been assigned as outgroup s   Once finished  you can simply look at the resulting tree   outgroup s  may group together on one side of the tree  If this is not the case  I suggest that you specify the outgroup with  o option  Does that answer your question  Minh Best regards Gabriel You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree f2fb6baf b2fb 4cf7 a62e f81cfe73d543n 40googlegroups com  Dear Minh  Thank you for your response  Unfortunately  I do not understand how the software is behaving to determine the best root position  Maybe it would be more convenient if I send you my data and the resulting time tree   As you could see  the iqtree report says that the first sequence of the alignment has been assigned as the outgroup  I think this sequence would not be the best outgroup  Is this behaviour normal   Additionally  I do not notice any taxon positioned at one side of the timetree  Could you give me more information about this points  Best regards  Gabriel  Hi Gabriel  Could you send the log file as well so that I can see what command you ve used  For the rooting method  it is done in the dating process  It has the same principle with root to tip rooting method  In general  we search on all branches  and the root position corresponds to the one that minimizes the sum of residues  the differences   variances adjusted   between the input branch lengths and the output branch lengths   You can find more details in our paper Best regards  Hieen To view this discussion on the web visit https   groups google com d msgid iqtree 19e063e5 a69e 4dae 86f3 d949ced7a6a8n 40googlegroups com ",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0
"V9PpjoaYgwY","4/23/2021 7:59:45","5/14/2017","Required information for analysing Splits nex Output I used IQTree with the command    iqtree omp  s SNP phy  m GTR ASC  bb 1000  alrt 1000  nt 32 One of the outputs was SNP phy splits nex  May I ask you please to provide me with the references IQTree used to generate this splits file as I didn t find anything in the manual  Moreover  I opened this file with SplitsTree and it seems that SplitsTree automatically generated the network using this splits file  I don t know why most of SplitsTree options was deactivated and I wan t able to figure out which algorithm SplitsTree used to generate this graph  I highly appreciate if someone can clarify these issues to me and provide related references  Thank you in advance     Dear RJ  thanks for the question   it reminds me that we should document this feature  IQ TREE generates  splits nex file  which contains all splits present in the bootstrap trees with their bootstrap supports in percentage  e g  the frequency each split occurs in the set of bootstrap trees   One can view this file in SplitsTree program to explore the conflicting signals in the data  So it is more informative than consensus tree  e g  you can see how highly supported the second best conflicting split is  which had no chance to enter the consensus tree  Cheers  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To post to this group  send email to iqt    googlegroups com Visit this group at https   groups google com group iqtree For more options  visit https   groups google com d optout Bui Quang Minh Center for Integrative Bioinformatics Vienna  CIBIV  Campus Vienna Biocenter 5  VBC5  Ebene 1 A 1030 Vienna  Austria Phone    43 1 4277 74326 Email  minh bui  AT  univie ac at  Many thanks dear for your prompt respond  I highly appreciate this   In addition  since the splits file contains splits already  when analyzing this with SplitsTree all the options which exist to produce sets of splits might be deactivated  The reason is that  differently to if you feed SplitsTree the alignment  here this set of splits was generated by IQ Tree  not some algorithm in SplitsTree  You should still be able to set parameters like thresholds for splits used in the graph  Best wishes  Heiko Schmidt  Dear Minh  Is it possible to plot the bootstrap values for the splits in the splits nex on SplitsTree  I m able to load the splits nex into SliptsTree  but no bootstrap values are shown  Cheers  Carol   Hi Carol  the boostrap values are assigned as split weights in SplitsTree  You can ask SplitsTree to display them  Cheers  Minh To view this discussion on the web visit https   groups google com d msgid iqtree 6d59988b 8d8e 4c59 be18 f7b9b9730e3dn 40googlegroups com ",0,0,1,0,0,1,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,1,0,0
"wbkt6epLVYo","4/23/2021 8:02:36","10/20/2020","Does  ntmax apply for initial parsimony tree building  I m trying to run IQTREE  non MPI  on a system scheduler  openlava  and the runs keep suspending during the initial parsimony tree stage  I have the run set to  nt AUTO  ntmax 10 and was wondering if it was possible that IQTREE uses more than the 10 allotted cores when it is building the initial parsimony tree and maybe that was what was holding it up  If this is the case  are there any possible fixes  Thank you  Running it with  nt 10 seems to have fixed the problem   Actually it only fixed it for unconstrained trees  but the constrained trees are still taking a very long time at the initial parsimony step   Hi  Bio Student  Does  ntmax apply for initial parsimony tree building  A  No  An explicit  nt setting  like  nt 10  takes effect before the construction of the initial parsimony tree  But  ntmax only matters to the code that figures out how many threads to use  if you ve passed  nt AUTO   And the initial parsimony tree is always constructed before  nt AUTO takes effect  because the code that decides how many threads to use  when  nt AUTO is set  uses the time that it takes to calculate likelihoods on a tree  it has to have a tree to run    So  yes  your initial guess was correct  In the initial parsimony tree stage  IQTree will  feel free  to use as many threads as are physically available  even if that is more than you specified via  ntmax   because  ntmax won t have been honoured yet   In my opinion  this is a bug  The combination of  ntmax 10 and  nt AUTO should constrain IQTree to use no more than 10 threads   including  in any processing  such as initial parsimony tree construction  that takes place before the number of threads to use for likelihood processing is figured out  As for why even an explicit  nt 10 setting doesn t seem to help for constrained trees  I cannot say  Regards  James You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 754955ff 9058 4f23 8ebb 571674a920b2n 40googlegroups com  James gave a good answer to your 1st question  For the 2nd   Actually it only fixed it for unconstrained trees  but the constrained trees are still taking a very long time at the initial parsimony step  Did you use IQ TREE version 1  If yes  please switch to version 2  It significantly speeds up the constraint tree option  especially for datasets with many many sequences  Cheeers Minh To view this discussion on the web visit https   groups google com d msgid iqtree 1950005108 1286614 1603151072083 40mail yahoo com ",0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0
"xbncLFYmqWk","4/23/2021 9:22:08","10/19/2020","Include models to test with  madd  not appearing in list of tested models Hi  I m not sure if this is a bug or I am just using the command wrong  I m trying to include LG C60 G F  and LG C60 R F as models to test with the model finder  but these aren t added when I use  m and  madd as I understand from the docs  Details  IQ TREE multicore version 2 0 6 for Linux 64 bit built May 30 2020 Command  iqtree2  s file faa  m MFP  madd LG C60 F G LG C60 F R  bb 1000  T 24 Seed  148707  Using SPRNG   Scalable Parallel Random Number Generator  Time  Fri Oct 16 17 04 53 2020 Kernel  AVX FMA   24 threads  64 CPU cores detected  Results of model finder  NOTE  ModelFinder requires 12602 MB RAM  ModelFinder will test up to 548 protein models  sample size  11602      No  Model  LnL df AIC AICc BIC 1 LG 7168743 715 1397 14340281 430 14340664 223 14350561 859 2 LG I 7145604 743 1398 14294005 486 14294388 863 14304293 274 3 LG G4 6767858 360 1398 13538512 720 13538896 097 13548800 508 4 LG I G4 6763863 312 1399 13530524 624 13530908 588 13540819 771 5 LG R2 6877205 514 1399 13757209 027 13757592 991 13767504 174 6 LG R3 6795297 917 1401 13593397 834 13593782 971 13603707 698 7 LG R4 6765228 181 1403 13533262 363 13533648 676 13543586 945 8 LG R5 6750169 945 1405 13503149 890 13503537 381 13513489 191 9 LG R6 6742321 201 1407 13487456 402 13487845 073 13497810 420 10 LG R7 6738153 626 1409 13479125 252 13479515 105 13489493 989 11 LG R8 6735426 170 1411 13473674 340 13474065 377 13484057 795 12 LG R9 6733559 397 1413 13469944 793 13470337 016 13480342 965 13 LG R10 6732530 584 1415 13467891 169 13468284 579 13478304 059 26 LG F R10 6735247 625 1434 13473363 251 13473768 049 13483915 960 39 WAG R10 6791294 603 1415 13585419 206 13585812 616 13595832 095 52 WAG F R10 6778033 730 1434 13558935 460 13559340 258 13569488 169 65 JTT R10 6851377 417 1415 13705584 834 13705978 244 13715997 724 78 JTT F R10 6850323 249 1434 13703514 498 13703919 296 13714067 208 91 JTTDCMut R10 6849628 949 1415 13702087 898 13702481 308 13712500 788 104 JTTDCMut F R10 6847246 126 1434 13697360 253 13697765 051 13707912 962 117 DCMut R10 6904138 053 1415 13811106 107 13811499 517 13821518 997 130 DCMut F R10 6874975 231 1434 13752818 461 13753223 259 13763371 171 143 VT R10 6800497 396 1415 13603824 792 13604218 202 13614237 681 156 VT F R10 6794584 031 1434 13592036 063 13592440 860 13602588 772 169 PMB R10 6825104 982 1415 13653039 965 13653433 375 13663452 855 182 PMB F R10 6819682 554 1434 13642233 108 13642637 906 13652785 818 195 Blosum62 R10 6810897 210 1415 13624624 419 13625017 830 13635037 309 208 Blosum62 F R10 6814076 221 1434 13631020 442 13631425 240 13641573 152 221 Dayhoff R10 6903827 061 1415 13810484 122 13810877 532 13820897 011 234 Dayhoff F R10 6874906 143 1434 13752680 286 13753085 084 13763232 996 247 mtREV R10 7178097 573 1415 14359025 145 14359418 556 14369438 035 260 mtREV F R10 6937038 631 1434 13876945 262 13877350 060 13887497 972 273 mtART R10 7203453 285 1415 14409736 570 14410129 980 14420149 460 286 mtART F R10 6973350 716 1434 13949569 432 13949974 230 13960122 142 299 mtZOA R10 7017835 700 1415 14038501 400 14038894 810 14048914 290 312 mtZOA F R10 6884714 727 1434 13772297 454 13772702 251 13782850 163 325 mtMet R10 7151504 237 1415 14305838 474 14306231 885 14316251 364 338 mtMet F R10 6955300 098 1434 13913468 195 13913872 993 13924020 905 351 mtVer R10 7291901 565 1415 14586633 130 14587026 540 14597046 020 364 mtVer F R10 7111867 463 1434 14226602 927 14227007 725 14237155 636 377 mtInv R10 7126118 212 1415 14255066 425 14255459 835 14265479 315 390 mtInv F R10 6865717 938 1434 13734303 875 13734708 673 13744856 585 403 mtMAM R10 7401744 481 1415 14806318 962 14806712 372 14816731 852 416 mtMAM F R10 7181783 818 1434 14366435 636 14366840 434 14376988 345 429 HIVb R10 7068739 669 1415 14140309 338 14140702 748 14150722 228 442 HIVb F R10 7065518 939 1434 14133905 877 14134310 675 14144458 587 455 HIVw R10 7388115 552 1415 14779061 103 14779454 514 14789473 993 468 HIVw F R10 7326162 229 1434 14655192 459 14655597 257 14665745 168 481 FLU R10 6988280 200 1415 13979390 401 13979783 811 13989803 291 494 FLU F R10 6995792 906 1434 13994453 812 13994858 610 14005006 522 507 rtREV R10 6804616 417 1415 13612062 834 13612456 245 13622475 724 520 rtREV F R10 6760875 194 1434 13524618 388 13525023 185 13535171 097 533 cpREV R10 6821898 155 1415 13646626 310 13647019 720 13657039 200 546 cpREV F R10 6822468 676 1434 13647805 352 13648210 150 13658358 062 Akaike Information Criterion  LG R10  Hi there  I can t reproduce what you said   madd option works in my case  with the same version 2 0 6  and all other verions   So please send me the log file  I suspect that you didn t look carefully at the log file  because it says  test up to 548 protein models   and you only pasted the part up to model 546  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 8e65d60a 62fd 4304 a4fc 6596d4fde37an 40googlegroups com ",0,1,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0
"zWML9-2xxgE","4/23/2021 9:25:16","10/18/2020","not recovering same likelihood score when recalculating Hi  I am finding that for certain trees  I am not able to recover the same likelihood score as reported during the tree inference  and it s enough of a difference to make me wonder what is going on  For instance  I inferred a tree and the likelihood score reported at the end of the inference was  1 016 312 877  If I provide the same alignment and model specification  and supply the inferred tree with the  te argument  the score I get is  1 016 883 498   I attached the log files for these  the original inference  and the likelihood evaluation on the fixed tree   These scores are different enough that they change the ranking of candidate trees when I compare these scores to the scores of other phylogenetic inferences of this same dataset  Is one of these more accurate  thanks   Pascal  Hi Pascal  Indeed I don t expect this to happen  My only guess right now is that  this is due to local optimum in the parameter space  the 2nd run suddenly landed a sub optimal model parameters  What you can do to check this  notice that your first run produce a best model nex file  This file contains the model and the parameters  In the 2nd run  you can replace the  spp option with this file from the 1st run  And let me know  if that returns the better log likelihood of the first run  In any case I d just stick with the likelihood from the first run  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 3f8d0cc4 3dd1 4eac b0d7 f5c7600156c3n 40googlegroups com  gekkoTree26 eval iqtree log   Gekkonidae default 26 log   Ok  yes I can confirm that if I supply the model parameters  I get the initial better log likelihood  So this must be due to a local optimum  thanks   Hi Pascal  thanks for the confirmation  It s an interesting observation  I think this can happen because the numerical optimization algorithm actually does not guarantee global optimum  But I expect this to occur very rarely  this is still  much  easier than optimizing tree topology  So this is not a bug  rather an unwanted feature     Cheers Minh To view this discussion on the web visit https   groups google com d msgid iqtree af7f63e1 066d 4578 b0e1 16f7c6bb6fcbn 40googlegroups com ",0,0,1,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0
"91oUreKkPf4","4/23/2021 17:49:15","10/9/2020","What is considered a large data set  Hello  I learned that if I have large datasets I have to performed multiple runs   nrun   In previous mails  I have read that a dataset is considered large when the number of sequences is  500  This number would be 500 sequences included in a single partition  In other words  if I have a database that comprise 100 individuals and nine loci  or 9 partitions   should I perform multiple runs  Thank you Best regards  Hi Elsa  On 9 Oct 2020  at 3 27 pm  Elsa   folga    gmail com   wrote  Hello  I learned that if I have large datasets I have to performed multiple runs   nrun   In previous mails  I have read that a dataset is considered large when the number of sequences is  500  This number would be 500 sequences included in a single partition  Yes  And actually an alignment with just one partition is rather short  and tree search is getting more difficult with increasing number of sequences  So defintely do multiple runs in this case  In other words  if I have a database that comprise 100 individuals and nine loci  or 9 partitions   should I perform multiple runs  Yes  please  It s better to be on the safe side  Your dataset is rather quick to run  and comparing the runs will indiciate how well the tree search converged  Cheers Minh Thank you Best regards You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 09d34187 35bc 4699 a5e4 026aa37f0edeo 40googlegroups com ",0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"bB9bGFSEvfw","4/23/2021 17:54:35","4/21/2020","Branch length interpretation Hi All  I have a morphological dataset  states 1 2    described by the MK FQ I G4  my question is how does one interpret branch lengths  Substitutions  character state transitions  per site  Thanks Vinny  Hi Vinny  Fairly simple answer  yes  branch lengths are number of substitutions per site  just like for DNA  protein or other models  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 7b266dcc 26ac 4fd6 a781 16d881bd8f30 40googlegroups com  Hi Minh  I am wondering how to explain the morphological tree with branch length values over 1  I was using the command with iqtree2  s Morph phy  st MORPH  m MK  te species tree tre  And I obtain a result showing one species with an extremely long branch length  10   Thank you in advance  Best  Wenbin Zhou  Hi  Wenbin Zhou   This answer in terms of DNA nucleotides  but the principles are the same for proteins and morophological data  Branch lengths indicate how many times  on average  each nucleotide is estimated to have changed  in the time since the species diverged  For a short branch length  a branch length close to zero  much less than one   that is almost the same as  is only a little more than   the number of differences that have accumulated since the species diverged  divided by the number of nucleotides in the alignment  But  as the number of substitutions increases  some of the substitutions change nucleotides back to what they were at the time of divergence  so they are no longer different    Each time that happens  the number of substitutions increases by one  but the number of differences falls by one  So  as the number of substitutions increases  and the branch length goes up  the fraction of nucleotides that are different doesn t approach 1  but approaches a lower number  which depends on the substitution model   There s a graph showing what happens for another model  not the model you are using   on the Wikipedia page  https   en wikipedia org wiki Models of DNA evolution   In that case  with the Jukes Cantor model  the one shown in the graph   the fraction of nucleotides that differ is expected to eventually get very close to 0 75  not 1   But  by the time they do  for the average site in the alignment  there have been multiple substitutions  many more than 0 75    IQTree tends to limit branch lengths  to no more than 10   When branch lengths are as long as that  or longer   it is difficult to guess just how many nucleotide substitutions have occurred  Branch length estimates are derived by guessing how many of the nucleotides that are the same are the same because they haven t ever changed  by looking at how many more are the same than you d expect to be the same   just by chance   from a randomly generated genetic sequence   By the time you get to a branch length of 10  it is unlikely that there are many of those left  The  similarity  signal  for sites where no substitution has occurred  has become so degraded that it can no longer be distinguished from noise  sites  at which multiple substitutions have occurred  that are the same  merely due to chance   Regards  James To view this discussion on the web visit https   groups google com d msgid iqtree 8b042cc5 2a75 46e5 9a0c 93a7bd7e319dn 40googlegroups com  Hi James  Thank you so much for the explain  Best regards  Wenbin To view this discussion on the web visit https   groups google com d msgid iqtree 1791742441 36775 1602308295372 40mail yahoo com ",0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"bfbYQbmjCIQ","4/23/2021 17:56:52","9/22/2020","BUG  IQ Tree crashes in molecular dating Hi Minh  Very happy to see IQ Tree implements a powerful molecular dating algorithm  It seems that I encountered a bug when dating using IQ Tree with a very small data set  Basically  I tried a few different options  either with or without    te   and either with or without polytomies  However  none of them seemed to work well  May I ask what s wrong with the data  I attach my data and log files here  An example command is  iqtree  s anfG aln   date root 100   date tip 0  redo   Thank you  TREE 1  PROCESSING  Reading the tree     Collapse 0  over 1  internal branches having branch length    0 00379  settable via option  l  Parameter to adjust variances was set to 0 194  settable via option  b  Minimum branch length of time scaled tree  settable via option  u and  U   0 Estimating the root position on all branches using fast method     ERROR  STACK TRACE FOR DEBUGGING  ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR      For bug report please send to developers  ERROR      Log file  anfG aln log ERROR      Alignment files  if possible  Best  Sishuo  Here come the data and results   Hi Sishuo  The root date has to be smaller than the tip dates  so the command should look something like    date root  100   date tip 0  could you try again with this setting  However  normally in this case it should throw a message about conflict dates  so there s maybe another probleem  Hien On Tue  Sep 22  2020 at 3 28 PM Sishuo Wang   tomas    gmail com   wrote  Here come the data and results  You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 19618355 6512 4bd9 99cc c5d251cdf78en 40googlegroups com  Hi Hien  Thank you for your help  However  it seemed that there was still a problem as I tried    date root  100   date tip 0  but  Thanks  Sishuo  Hi Sishuo  I ve tried to run lsd2 alone with your data in the previous email and didn t get any error  Do you have the log file of your second try  Hien To view this discussion on the web visit https   groups google com d msgid iqtree d412a35c 7476 4f13 8278 18a90d2aeb45n 40googlegroups com  Hi Hien  It is attached  Thanks  Sishuo  Hi Sishuo  Thanks for the file and pointing out the issue  I ve found the bug now  I had tried the version for mac before which worked well  but the linux version had problems  There s an error of uninitialized value for a variable that the mac version sets 0 to it   which by chance is correct  while the linux version gives it a random value  I ve fixed it now in the new update of lsd2   Minh Bui could it be possible to include the new version of lsd2 in iq tree  Thanks  Hien To view this discussion on the web visit https   groups google com d msgid iqtree af870486 9476 49f1 9750 f713d22b941en 40googlegroups com  Hi Minh  I will affect the case of unrooted tree with a root date  I d be nice if if the new version is integrated which fixes another bug Thanks  Hien On Wed  Sep 30  2020 at 6 40 AM Minh Bui   m     anu edu au   wrote  Hi Hien  Do you think if this is a serious bug   e g   does it affect most analyses    If yes  I ll integrate it today or tomorrow  Minh ",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0
"Cx-Tb1kAbcg","4/23/2021 18:00:51","10/6/2020","Doubts about  log files and other Hello  I am a new IQ tree user  I have run some analyses with this great software and I have a few doubts  In the  log file  one of the output files  there is table like the following  Subset Type Seqs Sites Infor Invar Model Name DNA 1200 134 1003 TVM F R2 part1 DNA 900 863 TIM F I part2 DNA 800 638 TVM F R2 part3 1350 101 1204 K3Pu F G4 part4 1000 100 848 K3Pu F G4 part5 DNA 600 111 427 GTR F I G4 Part6 In this table  I have noticed that if the partition model was K3Pu  the program does not indicate the data type of those partition  e g  DNA  AA  BIN  etc   So I want to know if IQ tree analyze these partitions as DNA data  and therefore  if I should ignore this information of the  log file  Also  I don t understand why the number of total sites in the alignment is greater than the number of informative sites plus invariants sites   On the other hand  if my dataset includes less than 10 loci  do you recommend that I perform the UFBoot analyzes with the partition resampling strategies GENE and   or GENESITE  And should I also apply bnni preventively  although I do not know if there are severe violations of the model   Thank you Best regards  Hi there  K3Pu is a DNA model  I don t know why the log file does not indicate that  but you can look at  iqtree file when the run finished  The datatype will for sure be mentioned there  Also  I don t understand why the number of total sites in the alignment is greater than the number of informative sites plus invariants sites   Because there is the 3rd category of sites called singleton  that are neither parsimony informative nor invariant  If you look at the log file again  you may see something like this  Alignment has 17 sequences with 1998 columns  1152 distinct patterns 1009 parsimony informative  303 singleton sites  686 constant sites  note that constant sites    invariant sites   Singleton is a site that has the same character for n 1 sequences and just one sequence shows a different character  some sequences may show gaps unknown characters  For example  a site with ATA AAA  is a singleton  A in seq1  T in seq2  A in seq3    in seq4  etc    On the other hand  if my dataset includes less than 10 loci  do you recommend that I perform the UFBoot analyzes with the partition resampling strategies GENE and   or GENESITE  And should I also apply bnni preventively  although I do not know if there are severe violations of the model   Good question  I don t have an answer  But I lean towards not using GENE   GENESITE resamplings for such small number of partitions  You can analyse with and without  bnni and compare the results  Cheers Minh Thank you Best regards You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 13e66db6 fa48 4914 8ab8 d2020c8a9aa1o 40googlegroups com  Thank you very much for your quick response  I ran analyses with the same seed  with and without bnni  The supports of some branches are higher in the analysis without bnni  What would be the appropriate criterion for choosing between the two analyzes  bnni vs  without bnni   If my dataset contains 5 10 loci  could I calculate the gene and site concordance factor  Could be appropriate  Thank you again  Cheers Hi there  To unsubscribe from this group and stop receiving emails from it  send an email to iqt    googlegroups com  Hi Elsa  On 8 Oct 2020  at 8 35 am  Elsa   folga    gmail com   wrote  Thank you very much for your quick response  I ran analyses with the same seed  with and without bnni  The supports of some branches are higher in the analysis without bnni  What would be the appropriate criterion for choosing between the two analyzes  bnni vs  without bnni   To be on the safe side  I d use the supports from using  bnni option  If my dataset contains 5 10 loci  could I calculate the gene and site concordance factor  Could be appropriate  Yes for site concondance factor  But No Yes  I d say rather No  for gene concordance factor  if you have just 10 genes  the gCF values will be quite discrete and not smooth between 0  and 100   Cheers Minh To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 1ca41c3c ccc7 4c7e 8449 1bfdf4c9a043o 40googlegroups com ",0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1
"FK9Sn7dYaSU","4/23/2021 18:02:04","10/3/2020","short question on the   contree output when running UFboot Dear all Minh  the   contree file when e g  runingUFboot  is this a consensus tree  what exactly  majority rule   extended majority rule  from e g  the number of bootstraps I run   Searched here but only could find threads in thein combination with SH aLRT   and in the manual pdf I did not find an expplanation  Many many thanks  Karen  Hi Karen  It s the extended majority consensus from the UFBoot bootstrap trees  If you want majority rule consensus  add   minsup 0 5  option to the command line  Cheers  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree ef046c3d 03b7 4598 8ac1 8793dd489ac9n 40googlegroups com  ok great  many thanks     Cheers Karen ",0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0
"gT9Ch67YIYw","4/24/2021 10:51:04","9/17/2020","BUG  IQ TREE CRASHES WITH SIGNAL ABORTED Dear IQTree Developers  I am having trouble running a codon based analysis of 299 sequences of COI  It crashes  and curiously I am not getting the same model in different runs  I am running IQTree 2 0 6 for Windows 10  IQ TREE multicore version 2 0 6 for Windows 64 bit built May 30 2020 Command  bin iqtree2  s C  Users suzaw Downloads sol COI 657bp namesChckd 16Sep20 codons fasta  st CODON5  nt AUTO Seed  612206  Using SPRNG   Scalable Parallel Random Number Generator  Time  Thu Sep 17 12 33 32 2020 Kernel  AVX FMA   auto detect threads  8 CPU cores detected  Last few lines of log                                                                         OPTIMIZING CANDIDATE TREE SET                                                                        Iteration 30   LogL   18257 954   Time  0h 34m 11s  1h 39m 3s left  Iteration 40   LogL   18198 495   Time  0h 43m 33s  1h 22m 39s left  Estimate model parameters  epsilon   0 100  BETTER TREE FOUND at iteration 41   18192 145 Iteration 50   LogL   18197 447   Time  0h 52m 57s  1h 38m 20s left  Iteration 60   LogL   18207 874   Time  1h 1m 49s  1h 24m 52s left  Iteration 70   LogL   18213 242   Time  1h 11m 10s  1h 13m 14s left  Iteration 80   LogL   18257 026   Time  1h 20m 52s  1h 2m 26s left  Iteration 90   LogL   18210 481   Time  1h 30m 51s  0h 52m 4s left  ERROR  phylokernelnew h 3273  double PhyloTree  computeLikelihoodFromBufferGenericSIMD    VectorClass   Vec4d  FMA   true  SITE MODEL   false   Assertion  std  isfinite tree lh      Numerical underflow for lh from buffer   failed  ERROR  ERROR      IQ TREE CRASHES WITH SIGNAL ABORTED I would be grateful for your help  Thanks  Suzanne  Hi Suzanne  This looks like a bug  but codon models are known for numerical instability for small data  Just to be sure  can you run successfully in v1 6 12  This version is more stable  If still failed  can you add  m TEST option  It will ignore the complex free rate models and thus may improve numerical stability  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree df4d40e6 50a8 4e3c b6f1 83ee94743cd0n 40googlegroups com ",0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0
"HlZiXZnYdJo","4/24/2021 10:53:30","9/15/2020","error for constructing the concatenated tree Hi  I want to run the iq tree2 for my data set  33097 windows with 10kb size  to construct the concatenated tree  by using this command  iqtree  s  input  o  outgroup  m GTR I G  B 1000 but I receive this error message in the log file  ERROR      IQ TREE CRASHES WITH SIGNAL ABORTED ERROR      For bug report please send to developers  ERROR      Log file   work alaeikak fasta 10000bp 90perc 1R 36I log ERROR      Alignment files  if possible  would you please help me debug The best Niloo  Hi Niloo  Can you send thee full log file  This error crash message alone does not help to figure out why  Thanks Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 87fbca28 5f9f 4eb1 8490 a6e524bc4113n 40googlegroups com  Dear Minh I attached the log file  please find it Thanks Niloo  Hi Niloo  This is the relevant error message from the log file  terminate called after throwing an instance of  std  bad alloc  It means that the server ran out of memory  I did notice that it has a lot of RAM  Host  node009 eve ufz de  AVX2  FMA3  377 GB RAM  But can you make sure that your job has no restriction on RAM usage  Because this is huge data set  with  33K alignments in the directory  So make sure that you have full control of the server  and that nobody else is running on that server  Cheers Minh  IQ TREE 7048715 zip   Hi dear Minh Thanks a lot for your help  The best Niloo ",0,0,1,1,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0
"HVA9eeEQpD8","4/24/2021 10:57:12","10/6/2020","branch labels and iqtree annotations Dear Minh  I have a pretty basic question about how IQtree outputs branch labels  which I guess is also a basic question about newick format     when using two support metrics simultaneously  for example   alrt 1000  B 1000     I ve noticed for years that IQtree prints the support values as a concatenated pair  ie  100 100     is there a particular reason for printing the support values this way instead of printing them as separate labels  I guess it appears that the standard newick format does not support this  but the extended formats do  Is that correct  I ask because I often forget which value in the 100 100 pair represents which support metric  I suspect this can get even more confusing when doing more than those 2 metrics  and have wondered if there was a way of more explicitly keeping track of this information in the tree output  Might you have any tips for doing just that  Best wishes  Jake Berv  Hi Jake  You can find this information in  iqtree file  which has a line like  Numbers in parentheses are SH aLRT support       ultrafast bootstrap support     I don t know how the newick format allows to specify the labels  But the nexus format that FigTree uses certainly does  Can you please post a feature request in GitHub  in the  issues  tab   and we will come to that when we have the time  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 03ba4d6e 00e5 4ae3 b621 b3a4a3616b39n 40googlegroups com  Hi Jake  I recommend to try TreeGraph for visualization of the newick formatted tree with UFB alrt supports  See also an old thread https   groups google com g iqtree c DRoWy8h BHk m ZYRbFO75AAAJ Sishuo  Thanks  this is helpful  Sent from my iPad On Oct 6  2020  at 6 45 PM  Sishuo Wang   tomas    gmail com   wrote   Hi Jake  To view this discussion on the web visit https   groups google com d msgid iqtree 25a3c6c7 e2ac 4ac1 baac 29459778d3c9n 40googlegroups com ",0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0
"I7qrdcSPK8s","4/24/2021 10:58:47","9/25/2020","MODELFINDER not testing all the models Hi  I ve been running two versions of iqtree  version 1and version version   both for Linux 64 b it built  I m using the flag   m TEST  to have MODELFINDER test for standard model selection  with the command   for iqtree 1 6 1   iqtree  nt AUTO  s input fasta  m TEST  seed 10101 Seed  10101 for iqtree 2 0 6  iqtree2  nt AUTO  s input fasta  m TEST Seed  316299 In the log files  I get different outputs for ModelFinder  for iqtree 1 6 1   ModelFinder will test DNA models  sample size  1901           all 88 models tested for iqtree 2 0 6  ModelFinder will test up to DNA models  sample size  1901           only 25 models tested This issue has been happening with different datasets  and even using the default ModelFinder command  I d like to know if this is a bug  or if iqtree 2 implements a faster way of running ModelFinder without having to test all possible models  Many thanks in advance for your help  Paul  Hi Paul  It s all good  IQ TREE 2 has a heuristic to filter out non promissing models  before having to evaluate them  That s why the  up to  is added to the phrase  So it s not a bug  but a feature  We are still preparing a manuscript about ModelFinder2 with all these heuristics to be described  Cheers Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 4fb0dcfe 0ed4 4ee1 864f 65c322911e9dn 40googlegroups com ",0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0
"mnnTTmMiUfM","4/24/2021 11:06:51","10/5/2020","Error when using  ASC because of 0 invariant sites in the alignment  Dear all  According to the last FAQ stated here  http   www iqtree org doc Frequently Asked Questions   I ve filtered my variants to make sure that none of constant site  gap and ambiguous base contained in a file  I finally used the following command  iqtree  s  home jumpp project sugarcane phylo sugarcane L2 phy  st DNA  nt 30  v  mem 70G  m GTR ASC  bb 10000 PS  I m quite new in phylogenetic analysis  So I don t know what kind of model that might suit my data  I just read IQTREE manual and found that GTR ASC is recommended for SNPs data Here s an error I got  Command  iqtree  s  home jumpp project sugarcane phylo sugarcane L2 phy  st DNA  nt 30  v  mem 70G  m GTR ASC  bb 10000 Seed  362115  Using SPRNG   Scalable Parallel Random Number Generator  64 bit Linear Congruential Generator with Prime Addend seed   362115  stream number   0 parameter   0 Time  Mon Oct 5 20 26 45 2020 Kernel  AVX FMA   30 threads  32 CPU cores detected  Reading alignment file  home jumpp project sugarcane phylo sugarcane L2 phy     Phylip format detected Alignment most likely contains DNA RNA sequences Alignment has 16 sequences with 21909 columns  643 distinct patterns 773 parsimony informative  21135 singleton sites  0 constant sites Empirical state frequencies  0 1480327719 0 3563689580 0 3509060204 0 1446922498 Gap Ambiguity Composition p value 1 114684 SiS 0 00  passed 21 33  2 114685 K88 0 00  passed 32 54  3 114686 KK0 0 00  failed 0 62  4 114687 UT1 0 00  passed 55 79  5 114688 KK0 0 00  passed 90 44  6 114689 UT1 0 00  passed 38 44  7 114690 LK  0 00  passed 9 36  8 114691 KK0 0 00  failed 2 21  9 114692 KK0 0 00  passed 99 49  10 114694 KK0 0 00  failed 4 52  11 114698 KK0 0 00  failed 1 69  12 114700 NSU 0 00  failed 0 08  13 114702 KK0 0 00  passed 97 86  14 114704 KK3 0 00  failed 0 89  15 114705 TRJ 0 00  failed 0 21  16 114706 KK0 0 00  failed 0 71       TOTAL 0 00  8 sequences failed composition chi2 test  p value 5   df 3  Empirical state frequencies  0 1480327719 0 3563689580 0 3509060204 0 1446922498 Create initial parsimony tree by phylogenetic likelihood library  PLL     0 0158557687 seconds 64 bit Linear Congruential Generator with Prime Addend seed   362115  stream number   0 parameter   0 Generating 10000 samples for ultrafast bootstrap  seed  362115     Empirical state frequencies  0 1480327719 0 3563689580 0 3509060204 0 1446922498 Alignment was printed to  home jumpp project sugarcane phylo sugarcane L2 phy varsites phy ERROR  For your convenience alignment with variable sites printed to  home jumpp project sugarcane phylo sugarcane L2 phy varsites phy ERROR  Invalid use of  ASC because of 0 invariant sites in the alignment So any suggestions on what might be going wrong here   Hi there  This indeed strange  the error message is contradictory  because ASC model should work when you have 0 invariant sites  Which version of IQ TREE did you use  Can you send me the alignment via personal email for further inspection  Thanks Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 0ddf8be7 ba83 479b 8588 7297a6ec95f0n 40googlegroups com  Hi Minh  Sorry for late reply  I use IQ TREE version 1 6 1  I ve also tried the input with raxml ng using the same model and it works well  So I ll send you an input I used  Thank you for you help   After looking into the run reproduced from the alignment you sent  I now see the problem  Your alignment has 21909 sites and there is just one site being invariant  If you look at  varsites phy file IQ TREE printed  you will see that it has 21908 sites  So why IQ TREE printed 0 invariant sites  This is just a printing problem due to a rounding down in the numerics  when I take the product of the fraction of invariant sites  internally stored as 0 000045643342918435343   with the number of sites  21909   this becomes 0 99999999999999988   And for some reason  C   decided to round it down  The correct error message should have been  because of 1 invariant sites   My suggestion is to just re run your analysis using  varsites phy file that IQ TREE provided  Cheers Minh To view this discussion on the web visit https   groups google com d msgid iqtree 65a69eb5 63dc 4456 97f1 b420adc71a5fn 40googlegroups com  I ve tried using  varsites phy file and it works  Thank you Minh  Best Phongphak  Hi Minh    So why IQ TREE printed 0 invariant sites  This is just a printing problem due to a rounding down in the numerics  when I take the product of the fraction of invariant sites  internally stored as 0 000045643342918435343  with the number of sites  21909   this becomes 0 99999999999999988  And for some reason  C   decided to round it down  I guess that the float result  a decimal number  is converted to an integer by a cast for printing  or just printed as an integer  which implies a cast   This is typically OK  because we expect integer numbers and no rounding effects  Here  however  by casting the number looses the part after the dot  thus changing to zero  the part before the dot   Am I right  Best wishes  Heiko                                                                               Heiko Schmidt Center for Integrative Bioinformatics Vienna  CIBIV  University of Vienna   Max Perutz Labs http   www cibiv at                                                                                 Hi Heiko  Yes that s exactly what happened  in the casting from double to int  Minh        You received this message because you are subscribed to the Google Groups  IQ TREE  group    To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com   To view this discussion on the web visit https   groups google com d msgid iqtree DD718D46 226A 40BE 89F7 4219472C6B0F 40univie ac at ",0,0,1,1,0,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0
"q7vRlIIQU2k","4/24/2021 11:08:40","9/24/2020","Multiple runs and bootstrapping best tree Hello  I would like to run several independent runs using the  n run option  In the output summary of results from the runs  is the best tree also output  If so  is it possible to subsequently compute standard bootstrap support values for this tree and produce a consensus tree  Or is it possible to invoke multiple runs and bootstrapping in a single command  Many thanks for any feedback   gratefully received  Best wishes  Helen  Hi Helen  On 24 Sep 2020  at 7 40 pm  Helen Jenkins   hel    mba ac uk   wrote  Hello  I would like to run several independent runs using the  n run option  I m assuming you used   runs option  In the output summary of results from the runs  is the best tree also output  Yes  the best tree of different runs will be output to  treefile and summarised in  iqtree file  The  runtrees file will contain trees of all runs  If so  is it possible to subsequently compute standard bootstrap support values for this tree and produce a consensus tree  Or is it possible to invoke multiple runs and bootstrapping in a single command  yes  that s possible  e g     runs 10  B 1000 will do 10 runs  each with 1 000 ultrafast bootstrap replicates  and the result will be from the best run  Cheers Minh Many thanks for any feedback   gratefully received  Best wishes  Helen You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 34cf683a 8586 4f3b b143 113b85dc6f62n 40googlegroups com ",0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0
"qO-bDUeZryM","4/24/2021 11:34:10","12/21/2019","State frequencies for binary and multistate morphological characters in IQ TREE Dear All  When I analyze datasets with mophological data  and have both binary and multistate  three states  in my case  chars   the output file indicates a single 3x3 Q matrix for MK model  I see how this is fine for MK model  as transition rates are all equal but how about stationary state frequencies  How IQ TREE deals with the fact that they are 0 5 0 5 for binary and  0 33 0 33 033 for my multistate data  Best Daniel Casali  Hi Daniel  The MK model has equal state frequencies  So yes  they are as you understood   1 2 for binary and 1 3 for 3 state data   This is the default behaviour with ModelFinder  If you want to change it  you need to set option   mfreq FQ F  to test both  FQ  equal  and  F  empirical  frequency model  Alternatively you can also set the model manually  e g  with  m MK F G  Does that answer your question  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree cc7284fc 5940 4152 be09 1c10f66723fd 40googlegroups com  Hi Minh  Thanks for the answer  My question is more about how  given those different number of states i have  IQ TREE calculates the transition rates  Considering that  although frequencies are equal for all chars   their values vary according to the number of states  In the case of nucleotide data  for which we always have 4 possible states and they are not arbitrary  it is clear to me  but when I have data with variable number of states  i m trying to understand how calculations during the search are performed  For example  in Beast  if I understood it properly it automatically partitions the dataset per number of states of the characters  and estimate the rates for each class defined by the characters with a given number pf states separately  There is any necessity to use different partitions for morphological data in IQ TREE in order to account for this heterogeneity in the number of states or this is already accounted for without partitioning  If so  how this is done  In a character by characters basis  Since I ve just seen a 3 3 rate matrix in the output  I was affraid a 0 33 value of frequency  relative to my multistate data  could have being applied to binary characters as well  during the optimizations  Hope this is not a silly question   but I haven t found any good explanation elsewhere  so I Hope you can help me elucidating this doubt  Best regards Daniel Casali  Hi Daniel  I m not sure if I understand you correctly  Do you mean that  in your alignment  you have some sites with only 2 states  and other sites with 3 states  If that s the case  then indeed IQ TREE applies a single 3x3 rate matrix for all sites in the alignment  Perhaps what you need to do  is to manually partition the alignment into 2 partitions  one with 2 state sites  which should be encoded with 0 and 1  and the other with 3 state sites  again encoded as 0  1  2   Then IQ TREE should account for the lack of state  Is that your doubt  Cheers  Minh        You received this message because you are subscribed to the Google Groups  IQ TREE  group    To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com   To view this discussion on the web visit https   groups google com d msgid iqtree 11275e5b dc8b 4bc2 8ae8 98be1574e964 40googlegroups com  Hi Minh  Exactly that  Thank you so much for clarifying it  Unfortunately  this icould be a potential limitation when dealing with emprical morphological datasets  which usually have too few characters with more states  e g  4  5  6      In cases like this  we may not have enough data for estimating the paramenters for those partitions  but avoiding partitioning would lead to a undesirable effect as well  of ignoring variation is state frequencies  I don t know if there is a good solution for that right now    Best Daniel Casali   To unsubscribe from this group and stop receiving emails from it  send an email to iqt    googlegroups com  Hi all  I ve run into this issue as well  I have a morphological dataset with characters that have 2  3  4  or 5 states  I tried partitioning by total number of states at each site  I even specified the model MK FQ ASC G4 for each charset under charpartition in the partition file  In the output five empirical state frequencies are output for each partition  leading me to believe that the Q matrix is still assigning 5 states to each partition  I am using IQ TREE multicore version 2 0 rc1 for Linux 64 bit built Nov 21 2019  Do you have suggestions for restricting each partition s Q matrix to the appropriate number of states  For now I will probably run a FO model where state frequencies are empirically estimated  since then the non existant states will have frequencies closer to 0   Hi there  You can recode your alignment  Say  changing 2 3 4 5 to 0 1 2 3  respectively  assuming that states 0 and 1 are missing   More generally  if some state s  is missing  you need to recode the characters such as all states from 0 to  n 1  are present in the alignment  Otherwise  it may cause numerical issues  Minh To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree 47735e50 cfc2 490e b506 69e7d5f40f76n 40googlegroups com  Hi Minh  My apologies I don t think I worded my question properly  I have some characters sites that have 0   1 values  other sites that have 0 1 2 values  and others that have 0 1 2 3 values  So some sites should have a q matrix of 2 states  while others should have a q matrix of 3 states  and others a q matrix of 4 states  I ve tried partitioning the data by the total number of states each site should have  but the iqtree output seems to still assign a q matrix of 4 states to all sites  even if a site only ever has the values of 0 1  Let me know if that is more clear  I am not a morphologist so I am not always accurate with the terminology   Ah ok  I misunderstood you  I believe in such partitioned morphological analaysis  each partition should have a Q matrix size corresponding to the number of states in that partition  Please send me the alignment  partition file  and the log file  I ll have a look if that s the case  Minh To view this discussion on the web visit https   groups google com d msgid iqtree b5a7f9fc 7944 4e60 82a2 93c1efee7331n 40googlegroups com  Hi there  Sorry for the delay  Now I see the problem  It s because the concanated alignment is in a single file  IQ TREE will read this file and detect the number of states  then partitioning them  As a result  these partitions will have same number of states as the original alignment  even if the actual partitions contain few states  There is a way to overcome this  You need to prepare each partition in a different file  and then use this syntax to specify the partition file http   www iqtree org doc Complex Models partition models   that you can basically put the alignment file names into the partition file  for example   nexus begin sets  charset binary part   part1 phy  charset morph part   part2 phy  end  This way  each file  corresponding to one partition  will be read individually and IQ TREE will detect the number of states separately for each partition  In IQ TREE 2  there is a convenient way to avoid preparing such partition file  You need to put all alignments into the directory and run  iqtree  p DIR      Hope that helps  Minh On 15 Sep 2020  at 12 06 pm  Genevieve Mount   ggmo    gmail com   wrote  Hi Minh here is the data and alignments  I ve also attached a test run I did using the FO model instead of the FQ model because I was trying to determine the number of states for the q matrix for each partition  This FO log is what lead me to believe that each partition still has a q matrix with 5 states even for the partitions with only 2 states  Thank you for the help                     Genevieve G  Mount PhD Student  Jeremy Brown Lab and Chris Austin Lab Department of Biological Science and Museum of Natural Sciences Louisiana State University Website  Phyleaux website Twitter  Lizardeve Pronouns  She her they them he him  no preference  Although I may choose to send emails at odd hours including mornings evenings and weekends  I have no expectations for you to reply outside of your working hours   Simoes2018OGCutPart nex   Simoes2018OGCut nex   Simoes cut part log   logFOmodel log   Great  That makes sense  I will try this  Thank you for the reply  ",0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
"RhTPHzAEX8o","4/24/2021 11:38:05","10/10/2020","Identical sequences Hi  I ve just started using iqtree  and I like many of its features a lot  including the one that deals with identical sequences  However  the output is a bit confusing  I get two types of messages from the same analysis  One identifies identical sequences  but says that they are retained  e g   MN012068 Nanorana cf blanfordii is identical to MN012072 Nanorana cf blanfordii but kept for subsequent analysis  And in fact  these two identical sequences are written to the  uniqueseq  file  The other type of message says that identical sequences are added at the end  e g   NOTE  MN012181 Nanorana sp  identical to MN012178 Nanorana sp  is ignored but added at the end Can you explain the difference  Thanks  Dave  Hi Dave  I believe this question was asked some time ago  but I faster write an answer here before looking up the forum  Among a group of identical sequences  IQ TREE will keep the first two and ignore the rest  If the sequence is the 2nd one  it will be  kept for subsequent analysis   If it is the 3rd or more  it will be  ignored but added at the end   The rationale for this is to still be able to calculate the bootstrap support for this group of identical sequences  it is not always 100   Because by bootstrap resampling  on average only two third of the sites will be present in a bootstrap alignment  due to sampling with replacement   and suddenly another sequence not in this group may actually become identical to this group of sequences  In that case  the bootstrap value will be   100   Does that answer your question  Minh You received this message because you are subscribed to the Google Groups  IQ TREE  group  To unsubscribe from this group and stop receiving emails from it  send an email to iqtree un    googlegroups com To view this discussion on the web visit https   groups google com d msgid iqtree ec583741 7026 4259 adff cfcaa987bc09n 40googlegroups com ",0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
