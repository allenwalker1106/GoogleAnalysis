{"Iv8H4ss3DTE": {"topic": "iqtree crashes when using ultrafast bootstraps and tree topology contraint", "initializeDate": "May 5, 2017, 2:51:27 AM", "timeStamp": "Jul 9, 2018, 2:44:57 AM", "content": ["Hej, I just played around a little bit with constrainig my topology using a newick file, and experienced a series of crashes... after a while i switched from ultrafast bootstraps to normal (from -bb to -b) and now its running.... The error message i received was IQ-TREE multicore version 1.5.3 for Linux 64-bit built Jan 15 2017 Copyright (c) 2011-2016 Nguyen Lam Tung, Olga Chernomor, Arndt von Haeseler and Bui Quang Minh. Host: molev-32-72 (AVX2, FMA3, 125 GB RAM) Command: iqtree-omp -s SRR3987482-86.trim.aln -g COG0086.tree -bb 1000 -nt 40 -pre SRR3987482-86.trim.iqtree -v Seed: 523557 (Using SPRNG - Scalable Parallel Random Number Generator) 64 bit Linear Congruential Generator with Prime Addend seed = 523557, stream_number = 0 parameter = 0 Time: Fri May 5 08:49:37 2017 Kernel: AVX+FMA - 40 threads(48 CPU cores detected) Reading alignment file SRR3987482-86.trim.aln ... Fasta format detected For your convenience alignment with unique sequences printed to SRR3987482-86.trim.iqtree.uniqueseq.phy Creating fast SIMD initial parsimony tree by random order stepwise addition... iqtree-omp: /home/CIBIV/minh/Dropbox/iqtree-git/phylotreepars.cpp:378: int PhyloTree::computeParsimonyTree(const char*, Alignment*): Assertion `taxon_order.size() == constraintTree.leafNum' failed. STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: SRR3987482-86.trim.iqtree.log *** Alignment files (if possible) and no problems running iqtree-omp -s SRR3987482-86.trim.aln -g COG0086.tree -b 100 -nt 40 -pre SRR3987482-86.trim.iqtree -v cheers, Max ", "Hi Max, thanks for the report. Can you send me the alignment and constraint tree via personal email? For constrained standard bootstrap, please use version 1.5.4 because of an important change: Combining standard bootstrap ( ) and constraint tree option ( ) will impose the constraint on bootstrap trees ( previously not ). Thanks to Matthew Prebus for discussions. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, The same error message appears with iqtree-opm 1.5.5 (downloaded today) when running a tree search under a topological constraint (-g) with identical sequences in the dataset. It appears that the duplicate taxa are removed from the alignment, but they are not pruned from the constraint tree. Using a constraint with these duplicates removed, fixes the issue. Here are last few lines of the log file: Reading constraint tree con.tree... NOTE: Entomoneis_pseudoduplex_ROS_AF18 is identical to Entomoneis_pseudoduplex_ROS_KD19 but kept for subsequent analysis NOTE: 2 identical sequences (see below) will be ignored for subsequent analysis NOTE: Entomoneis_pseudoduplex__ROS_AF18_ (identical to Entomoneis_pseudoduplex_ROS_KD19) is ignored but added at the end NOTE: Entomoneis_pseudoduplex_ROS_KD16 (identical to Entomoneis_pseudoduplex_ROS_KD19) is ignored but added at the end For your convenience alignment with unique sequences printed to xx.uniqueseq.phy Creating fast initial parsimony tree by random order stepwise addition... iqtree-omp: /home/minh/Dropbox/iqtree-git/phylotreepars.cpp:378: int PhyloTree::computeParsimonyTree(const char *, Alignment *): Assertion `taxon_order.size() == constraintTree.leafNum' failed. Dropping Entomoneis_pseudoduplex__ROS_AF18_ and Entomoneis_pseudoduplex_ROS_KD16 from the constraint tree (these sequences are not in xx.uniqueseq.phy) fixes the problem. Regards ", "Dear Max, Another way to achieve this is to state the option \u201c-keep-ident\u201d on the command line. This tells IQ-Tree not to prune identical sequences. Best wishes, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Hi Max, I am experiencing a similar problem. Did you get any solution of this problem. Cheers, Swati ", "Dear Swati, I believe such \u201cold\" problem has been resolved. So before we can provide further help, please explain the problem you encountered explicitly, e.g. what is the command line? Did you see any warning or error messages in the log? Cheers Minh "]}, "fs7DTvS2YWE": {"topic": "IQ-TREE release 1.4.4", "initializeDate": "Aug 28, 2016, 4:04:38 PM", "timeStamp": "Aug 28, 2016, 4:04:38 PM", "content": ["August 28, 2016 Dear users, We would like to announce the standard IQ-TREE version 1.4.4, available at http://www.iqtree.org , with the following changes: New features: - Allowing mixture frequency model with optimized frequency via e.g. `-m C10+FO` (requested by Edward Braun). - Supporting `GTR20` (general time reversible) amino-acid model (requested by Desmond Ramirez, Panagiotis Adam). - New option `-blscale` to optimize tree length scaling factor and model parameters for a user tree passed via `-t` option (requested by Rob Lanfear). The results are written to `.blscale` file in YAML format. - New option `--no-outfiles` to suppress printing all output files (`.log`, `.treefile`, `.iqtree` files). Bug fixes: - (critical) Memory overflow for long alignments (>55,000 aa site patterns) under large mixture models (e.g. `C60`) (reported by Matthew Brown). - (critical) AU test implementation (reported by Jan Janouskovec). - Counting of constant sites with many ambiguous states (reported by Greg Owens). We thank the users mentioned above for bug reports and testing. Best, IQ-TREE development team "]}, "aLmq-KucdsE": {"topic": "SH-aLRT on a given topology", "initializeDate": "Jan 16, 2016, 8:14:30 PM", "timeStamp": "Jan 17, 2016, 3:45:34 PM", "content": ["Hi IQtree team, A question about the SH-aLRT (either with > 1000 replicates or set to 0): Is this possible by providing a fixed tree topology (with which command?) to calculate the SH-aLRT test ? (Or do I have to perform the SH-aLRT with the alignment only and then later plot the values on a given (best) tree (like if I would do a tree search and seperatey a BS analyses?) In addition I try to figure out the difference as well to RAxML where you can perform the SH ration test (here is no refernce given but I think it refers NOT to the aLRT test) Thanks Karen ", "Dear Karen, On Jan 17, 2016, at 2:14 AM, Karen Meusemann < kmeus...@googlemail.com > wrote: Hi IQtree team, A question about the SH-aLRT (either with > 1000 replicates or set to 0): Is this possible by providing a fixed tree topology (with which command?) to calculate the SH-aLRT test ? via -te option, e.g.: iqtree -s alignment -te treefile -alrt 1000 -alrt 0 will assign both SH-aLRT and aLRT supports within a single run. (Or do I have to perform the SH-aLRT with the alignment only and then later plot the values on a given (best) tree (like if I would do a tree search and seperatey a BS analyses?) In addition I try to figure out the difference as well to RAxML where you can perform the SH ration test (here is no refernce given but I think it refers NOT to the aLRT test) then you need to ask RAxML guy ;-) Cheers Minh Thanks Karen You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, via -te option, e.g.: iqtree -s alignment -te treefile -alrt 1000 -alrt 0 will assign both SH-aLRT and aLRT supports within a single run. Thanks, perfect! I guess there will be 2 different output files then, correct? In addition I try to figure out the difference as well to RAxML where you can perform the SH ration test (here is no refernce given but I think it refers NOT to the aLRT test) then you need to ask RAxML guy ;-) already done ! Many thanks like always mich appreciated! Cheers Karen ", "Hi Karen, via -te option, e.g.: iqtree -s alignment -te treefile -alrt 1000 -alrt 0 will assign both SH-aLRT and aLRT supports within a single run. Thanks, perfect! I guess there will be 2 different output files then, correct? No, only one output tree file, each branch has both support values separated by a slash, which can be visualized directly in e.g. FigTree Minh In addition I try to figure out the difference as well to RAxML where you can perform the SH ration test (here is no refernce given but I think it refers NOT to the aLRT test) then you need to ask RAxML guy ;-) already done ! Many thanks like always mich appreciated! Cheers Karen "]}, "mkgO0DjZdAI": {"topic": "mitochondrial models", "initializeDate": "Aug 24, 2020, 1:32:07 AM", "timeStamp": "Aug 26, 2020, 8:06:50 PM", "content": ["I have run iqtree with the option to find the best models for my amino acid sequences. My sequences are from an invertebrate, however, when running modeltest, it seems IQTREE run models for several taxa, including non-invertebrates, for example: mtMet+G4, mtMAM+I+G4, mtInv+I+G4, mtMAM+I+G4, .. I do not have problems with the tree, is actually what is expected. But is it correct to use models outside the invertebrates? If not correct, how Can I restrict my analyses of mitochondrial models for invertebrates? Thanks for your time ", "Hi there, On 24 Aug 2020, at 3:32 pm, gusta10 < gus.san...@gmail.com > wrote: I have run iqtree with the option to find the best models for my amino acid sequences. My sequences are from an invertebrate, however, when running modeltest, it seems IQTREE run models for several taxa, including non-invertebrates, for example: mtMet+G4, mtMAM+I+G4, mtInv+I+G4, mtMAM+I+G4, .. I do not have problems with the tree, is actually what is expected. But is it correct to use models outside the invertebrates? Do you have a partitioned alignment? I think it\u2019s OK if some loci do not strictly follow the inverterbrate rate matrix. This matrix is designed to be the \u201caverage\u201d substition patterns for invertebrate. But there could be outlier loci that are far from the average and may actually be closer to another matrix. So just let ModelFinder decide that for you and you don\u2019t have to worry here. Am I right that you have mitochondrial sequences? In that case, you can speed it up with \"-msub mitochondrial\" option, so that only mito. rate matrices are considereed. If not correct, how Can I restrict my analyses of mitochondrial models for invertebrates? If you want, you use \"-mset mtInv\u201d option. Minh Thanks for your time You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8b2496af-4a0c-4864-b436-9734ad5e76dfn%40googlegroups.com "]}, "kzWQ_UpjePI": {"topic": "800 gene partition analysis and species tree generation", "initializeDate": "Dec 28, 2020, 5:28:57 PM", "timeStamp": "Jan 17, 2021, 11:52:52 PM", "content": ["Hi there, I have been running an analysis for 5 days now with 15 cores and up to 125Gb of RAM and using iqtree2.1.2 for Linux. I have 800 gene nucleotide fasta alignments in a directory and I tried to merge partitions and generate a species tree with this using the following parameters: iqtree2 -p aligned_gene_sequences_single_copy_orthologs/ -m MFP+MERGE --prefix concat -bb 1000 -T 15. This has been running for 5 days and it is still running and looks like the bootstrap analysis is not anywhere near converging at 750 iterations (LogL: -2363367.783, latest bootstrap correlation coefficient of split occurrence frequencies: -0.060). I feel like something has gone very wrong since that frequency is very low. I can provide the log file in its current state if that would help figure out what could be going on. Any help would be appreciated. Thanks! ", "Iqtree finished after 233hrs wall clock. Considering that there were ~800 individual gene nucleotide fasta alignments in the alignment directory for a total of 9 bacterial strains I was expecting the resulting tree to be the concatenated \"species\" tree to be a tree of those 9 bacterial strains. However, the tree that was output was of 7227 taxa in one tree where it thought each gene for each strain was a different taxa. I am wondering if I have something formatted incorrectly. Each file in the alignment directory is a gene for each of the strains that was aligned and in fasta format. Files can be provided. Any insight would be appreciated. Thanks! ", "Hi there, not knowing how the sequence headers are look like but to my understanding in each alignment the sequence header (e.g. for each strain) must be identical, that the software can somehow recognize that e.g. strain_A in alignment 1 the same like strain_A in alignment 2. If you have for example not the same header in each alignment, or an additional: strain_A_algn1, and strain_A_align2,, strange that the # is 7227, I would expect rather 7200 then... Much success! Karen ", "This is what I thought might be the issue. I'll look into that and see. The actual number is 803 so with 9 strains that does end up at 7227. I couldn't remember the exact number offhand. Thanks for the help! Regards, Alexander Kneubehl BS-Molecular Biology, 2015 Ohio Northern University You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/kzWQ_UpjePI/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d6e63645-1061-4031-b029-c6d2fd8c6f46n%40googlegroups.com ", "Yep that was the issue. Name changes fixed everything and it wrapped up analysis in ~15mins. Big difference from 233hrs LOL. ", "Fixed the fasta headers and reran. Completed in ~15mins with the expected tree. Big improvement over a 7227 taxa tree and 223hrs LOL. Thanks! On Wednesday, December 30, 2020 at 10:29:09 AM UTC-6 Alexander Kneubehl wrote: ", "Thanks a lot Karen, for the assistance! Just to confirm: eeach sequence must be named the same in all alignments in the directory, so that IQ-TREEE can properly recognise and concatente them together. I found program like JalView a bit disturbing, that it appends the positions like \u201c/1-216\u201d into each sequence name in the exported alignment files, causing IQ-TREE unable to match the sequences among different alignments. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/04b7777e-b50a-4bbb-a382-e63b5aebd640n%40googlegroups.com "]}, "hqLJtZY_kFw": {"topic": "Site Concordance Factors by locus", "initializeDate": "Feb 27, 2019, 12:45:50 PM", "timeStamp": "Feb 28, 2019, 1:22:36 PM", "content": ["Hello, I think it is great that you have implemented both the gCF and sCF in IQTree. However, is it possible to estimate sCF for each locus separately? I could do this remotely by making an R script and control IQ tree via that platform, but I wanted to make sure there wasn't an internal way of doing this in IQ Tree. So far I have run it this was and don't see this in the output as being by locus despite providing a partitioned (by locus file): ./iqtree -t Astral_tree_for_R --gcf IQ_Gene_Trees -s Squam_Concatenated_Phylip.phy -p Squam_Partitions2.txt --scf 1000 --prefix concord -nt 10 Thanks! Frank ", "Hi Frank, Similar question has been asked. Simply add --cf-verbose option. This will additionally print .stat_loci file, e.g.: # Concordance factor statistics for loci # This file can be read in MS Excel or in R with command: # tab2=read.table('example.phy.treefile.cf.stat_loci',header=TRUE) # Columns are tab-separated with following meaning: # ID: Branch ID # PartID: Locus ID # sC: Number of concordant sites averaged over 100 quartets # sD1: Number of discordant sites for alternative quartet 1 # sD2: Number of discordant sites for alternative quartet 2 # NOTE: NA means that locus is not decisive for branch ID PartID sC sD1 sD2 18 1 26.23 13.07 17.97 18 2 15.91 4.64 6.62 18 3 43.37 19.38 21.88 19 1 28.84 19.01 14.92 Then compute sC/(sC+sD1+sD2), which will be the concordance factor for each branch and partition. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Fantastic! Thanks Minh! Frank "]}, "1fT20qjUKms": {"topic": "checkpoints during ML treesearch ?", "initializeDate": "Feb 14, 2016, 8:03:46 PM", "timeStamp": "Feb 15, 2016, 6:09:18 PM", "content": ["Dear developers, I am running currently a large (partitioned) dataset. I was wondering, in case the walltimes I have available (and max. 20 cores) are not sufficient, if I can simply restart the ML tree search: does it continues at the stage it crashed or is that not possible (so in other words: is is checkpointed?) dataset: 119 taxa, 931450 aa sites, LG4X included (I now use random starting tree + gmedian but it takes remarkable longer than in a previous test dataset (nearly this size) with an older IQtree version (version 1.3.10) where I used nearly same settings - why is this? Best Karen ", "Dear Karen, On Feb 15, 2016, at 2:03 AM, 'Karen Meusemann' via IQTREE < iqt...@googlegroups.com > wrote: Dear developers, I am running currently a large (partitioned) dataset. I was wondering, in case the walltimes I have available (and max. 20 cores) are not sufficient, if I can simply restart the ML tree search: does it continues at the stage it crashed or is that not possible (so in other words: is is checkpointed?) dataset: 119 taxa, 931450 aa sites, LG4X included this is not possible with ver 1.3.X but possible with 1.4.0 (still in beta-testing phase). Can you pls try it out? (I now use random starting tree + gmedian but it takes remarkable longer than in a previous test dataset (nearly this size) with an older IQtree version (version 1.3.10) where I used nearly same settings - why is this? For your older runs did you also use random starting tree? Compared with the default parsimony starting trees, the random tree option will cause IQ-TREE to run slower, simply because it takes more time to optimize a random tree. On a side note: with exactly the same option, ver 1.3.11 and later should be slightly faster than 1.3.10 and older versions. Pls let me know if that\u2019s not the case. Cheers, Minh Best Karen You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Am Montag, 15. Februar 2016 21:01:35 UTC+11 schrieb Bui Quang Minh: Dear Karen, On Feb 15, 2016, at 2:03 AM, 'Karen Meusemann' via IQTREE < iqt...@googlegroups.com > wrote: Dear developers, I am running currently a large (partitioned) dataset. I was wondering, in case the walltimes I have available (and max. 20 cores) are not sufficient, if I can simply restart the ML tree search: does it continues at the stage it crashed or is that not possible (so in other words: is is checkpointed?) dataset: 119 taxa, 931450 aa sites, LG4X included this is not possible with ver 1.3.X but possible with 1.4.0 (still in beta-testing phase). Can you pls try it out? I will! would be awesome... (I now use random starting tree + gmedian but it takes remarkable longer than in a previous test dataset (nearly this size) with an older IQtree version (version 1.3.10) where I used nearly same settings - why is this? For your older runs did you also use random starting tree? Compared with the default parsimony starting trees, the random tree option will cause IQ-TREE to run slower, simply because it takes more time to optimize a random tree. no, I used the parsimony option (the random option was crashing in this version still) and now I use in addition -gmedian with this 1 treesearch needed around 50-60 h). OK I see - will hope it will not take tooo long :) (or I need an own cluster) :) On a side note: with exactly the same option, ver 1.3.11 and later should be slightly faster than 1.3.10 and older versions. Pls let me know if that\u2019s not the case. okay I will try this at some point, first I will try the checkpointing! Many thanks and appreciate that you always answer that fast! Best Karen "]}, "7vjfKsSAdDk": {"topic": "modelomatic -ERROR: STACK TRACE FOR DEBUGGING", "initializeDate": "Apr 6, 2020, 7:27:09 AM", "timeStamp": "Apr 13, 2020, 8:50:32 PM", "content": ["Hello! I am trying to run modelomatic in iqtree-2.0 with an alignment of ~3 million sites using the following command: /data/genomics/roa-varona/Programs/iqtree-2.0/bin/iqtree -nt $NSLOTS -rcluster 10 -safe -blmin 1e-6 -s DNA_FcC_supermatrix.phy -st CODON --modelomatic but, I get the following error: Perform fast likelihood tree search using GY+F3X4+I+G model... CHECKPOINT: Tree restored, LogL: -11637296.574 NOTE: ModelFinder requires 200592 MB RAM! Adjusted LnL: -11272325.532 df: 41 ModelFinder will test up to 1027 codon/AA/DNA models (sample size: 956264) ... No. Model -LnL df AIC AICc BIC 1 GY+F3X4 10724486.627 116 21449205.253 21449205.282 21450570.665 WARNING: Numerical underflow for lh-branch 2 GY+F3X4+I 10639710.348 117 21279654.696 21279654.725 21281031.878 3 GY+F3X4+G4 10528497.659 117 21057229.317 21057229.346 21058606.500 4 GY+F3X4+I+G4 10525372.899 118 21050981.799 21050981.828 21052370.752 ERROR: phylokernelnew.h:3273: double PhyloTree::computeLikelihoodFromBufferGenericSIMD() [VectorClass = Vec4d, FMA = false, SITE_MODEL = false]: Assertion `std::isfinite(tree_lh) && \"Numerical underflow for lh-from-buffer\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: DNA_FcC_supermatrix.phy.log ERROR: *** Alignment files (if possible) ################################################## I was wondering if the alignment will be too big for debugging? Any suggestions would be highly appreciated. Stay Healthy. Stay Active. Stay Sane! Adela ", "Hi Adela, Yes that\u2019s a huge dataset! This crash happened when testing GY+F3X4+R2 model. Can you please add option -m TEST to avoid this, and let me know if it works? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/68e08726-8481-45ed-856a-c6c20b391f02%40googlegroups.com ", "Will do and let you know! Thank you, Minh, Get Outlook for iOS From: Minh Bui < minh...@univie.ac.at Sent: Monday, April 13, 2020 8:11:02 PM To: IQ-TREE < iqt...@googlegroups.com >; Adela RoaVaron < aroa...@gmail.com Subject: Re: [iqtree] modelomatic -ERROR: STACK TRACE FOR DEBUGGING "]}, "76kMDTlZynM": {"topic": "Re: [iqtree] ERROR: Tree file does not start with an opening-bracket '('", "initializeDate": "Aug 14, 2018, 3:36:10 AM", "timeStamp": "Aug 14, 2018, 3:36:10 AM", "content": ["Hi Amber, Sorry for this late reply. When I look at your tree file (ALPL\u2026) there is a strange character at the beginning of the file (screenshot attached). This is likely the reason why IQ-TREE complaint. Cheers Minh On 14 Jul 2018, at 5:50 am, aet...@nyu.edu wrote: Hey there, I have been trying to figure out why my tree files are not being read. When I run the trees individually with -z they seem to work, however, when I run the file that contains both trees I get: ERROR: Tree file does not start with an opening-bracket '(' I have attached my trees. Any help would be much appreciated! -Amber Trujillo You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <ALPL_MLtree.nwk> <TimeTree_rooted.nwk> "]}, "LrlIhcgCkaI": {"topic": "crash of 1.6.1 with partitioned nt data", "initializeDate": "Jan 18, 2018, 3:50:38 PM", "timeStamp": "Jan 26, 2018, 7:07:57 AM", "content": ["Dear Minh and all, happy to work with the new release! I am currently running large datasets: an amino acid one doing tree ML tree searchHowever, a nucleotide one, doing the same, IQtree 1.6.1 always crashes. For both I did best model estimation before (with version 1.5.5 though). Anyway: The tree search for the aa dataset works fine, but the nt dataset crashes constantly. we are wondering - having tried a lot compilations (wih the system admin of the cluster I use, Ond H.- we emailed before) what the error could be and simply cannot find the problem. Notes from teh admin: failed with a clang compiled version as well \u2013 time to submit an issue I think \u2013 the below information should be useful \u2013 so I\u2019ve tried: Compiling with our usual flags using gcc/6.4.0 and system default gcc, as well as no flags and letting cmake choose it\u2019s own. Also tried openmpi/1.8.8 and 2.1.2. Best error we\u2019ve had is: ERROR: ERROR: ABNORMAL_TERMINATION_IN_LNSRCH We also got the following \u2013 I THINK that was with system gcc and openmpi/1.8.8 ERROR: EERROR: SCurrent log-likelihood at step 31: -26421230.937\" I cannot figure out its a but or an issue of the dataset!? (ca. 130 taxa, ca.. 3000 gene partitions) Just to be sure, I will now also try the 1.5.5 version...).. Shall I wait here or shall I send the dataset (to you or another person? Best, Karen ", "PS: it seems that 1.5.5 is working fine with this nt dataset that crashes with 1.6.1. (it started, no crash...). Any ideas? (I can send the dataset separately begin of Feb would be enough though!!) Best, karen ", "Indeed: the run with iqtree ended fine without any crash... Best, Karen ", "Hi Karen, You can ignore this ABNORMAL_TERMINATION_IN_LNSRCH message for the moment, they are warnings but not error. We will change this in the next release. Technically, this is from an optimisation routine taken from R optim function. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Dear Minh, ok again, sorry for being unclear: 1) thanks for the info that these are just warnings 2) anyways, the nt partitioned dataset then finally crashes constantly after seeing these warnings while the same dataset finishes successfully with 1.5.5 3) running a similar aa dataset with 1.6.1 also finishes without crashing. Any ideas? Best, Karen ", "Hi Karen, Please send me the data set and the log/output files via personal email. Thanks, Minh ", "sure i will - many thanks :)) "]}, "2Qu7IZp11FY": {"topic": "branch lengths reported for alignments with codon and DNA models on different partitions", "initializeDate": "Jun 9, 2016, 10:34:48 AM", "timeStamp": "Jun 9, 2016, 3:45:47 PM", "content": ["Hi, What is the branch length interpretation when using a partitioning scheme with both codon and dna models? thanks, Diamantis ", "dear diamantis, good question. the branch lengths in such case are normalized by the number of nucleotide substitution per nucleotide site. i will add this info into the FAQ cheers, minh "]}, "x_qQLdvO-ps": {"topic": "ERROR: Numerical underflow (lh-derivative).", "initializeDate": "Feb 14, 2017, 4:21:28 AM", "timeStamp": "Feb 14, 2017, 8:18:37 PM", "content": ["Dear all, I keep getting this \"ERROR: Numerical underflow (lh-derivative). Run again with the safe likelihood kernel via `-safe` option\" It seems as though the \u2013safe option is not available on the webserver. Is it so? Haven't got enough memory on my laptop to run locally. Attached a summary of tests. Probably I am doing a trivial mistake in the command line. Can you point it out for me please? Note that the dataset giving errors, Dataset3, is a subset of Dataset1. Finally, in my case, the outfile gives the following warning message: \"be extremely cautious if n <= K\". What do you mean exactly? I checked the Reference, and they say just to use AICc. And I cannot increase \"n\" All the best, Giorgio ", "Dear Giorgio, On Feb 14, 2017, at 10:21 PM, Giorgio Matassi < gmata...@gmail.com > wrote: Dear all, I keep getting this \"ERROR: Numerical underflow (lh-derivative). Run again with the safe likelihood kernel via `-safe` option\" It seems as though the \u2013safe option is not available on the webserver. Is it so? Thanks for the report. The error message speaks by itself. Unfortunately -safe option is not available from the web server. Haven't got enough memory on my laptop to run locally. Can you still repeat the run from a desktop adding -safe option and let me know how it goes? Moreover, do you get any other WARNINGs like some codon does not appear in the alignment? Many such warnings may also indicate potential numerical problem. Attached a summary of tests. Probably I am doing a trivial mistake in the command line. Can you point it out for me please? Your command lines look fine. Note that the dataset giving errors, Dataset3, is a subset of Dataset1. Finally, in my case, the outfile gives the following warning message: \"be extremely cautious if n <= K\". What do you mean exactly? I checked the Reference, and they say just to use AICc. And I cannot increase \"n\" This warning means that your alignment is too short in order to estimate trees and model parameters reliably. If you cannot increase n, then you can decrease the number of sequences or alternatively, you can also use DNA model instead of codon model, which effectively increase n by 3 times. If both are not possible, then I suggest that you repeat the analysis 10 times, use other tools as well (e.g. PhyML, RAxML). do some tree topology tests with the resulting trees. If the branches of your interests show high supports or appear in all trees, then you might be more confident. If you are interested in a branch, you can also perform a four cluster likelihood mapping analysis ( http://www.iqtree.org/doc/Command-Reference/#likelihood-mapping-analysis ) to see how many quartets support your branch compared to the two alternatives. Moreover, you can check whether the tree agrees with the taxonomy? Do you have ribosomal RNAs for the corresponding taxa? How does the rRNA tree look like? Such extra information may further help for your decision. Hope that helps, Minh All the best, Giorgio You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <IQTREE_tests.docx> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "r-uZ6vQ9kcg": {"topic": "Crash in partitioned models including morphology/binary data (and some suggestions)", "initializeDate": "Jan 19, 2015, 5:00:11 AM", "timeStamp": "Aug 14, 2015, 2:45:14 PM", "content": ["Dear guys, This is great software! Hope you keep developing it... In the hope of helping others who're also using it, here are some minor crash reports I've had with IQTree 1.1.5 in Ubuntu 14.04 (and some suggestions as well): Crashes: - partitioned models including DNA (perhaps protein too? Didn't test) + morphology/binary; - option \"-spp\" doesn't work as expected (crashes asking for \"-nn1\", but when it's put there, crashes as well); - when proportion of invariant sites is too high (seen this with >0.9, not sure about the threshold), models with +I+G crashes -> my current workaround is chosing; Suggestions: - with partitioned data sets, make option \"-spp\" the default behaviour (proportional branch lengths across partitions), which is typical of other ML software too (and further decreases the number of parameters being estimated per partition, which is utterly important for alignments with small number of taxa/sites); - possibility to include list of models to be tested (instead of the whole 88); Thks for developing IQTree! All the best, Jose. ", "Minor error, I didn't complete one of the phraes...here it goes: \"- when proportion of invariant sites is too high (seen this with >0.9, not sure about the threshold), models with +I+G crashes -> my current workaround is choosing one of the models including \"+I\" tested before crashing; ", "Dear Jose, thank you for your interest, please find my detailed answer below: On 19 Jan 2015, at 11:03, jspa...@gmail.com wrote: Minor error, I didn't complete one of the phraes...here it goes: \"- when proportion of invariant sites is too high (seen this with >0.9, not sure about the threshold), models with +I+G crashes -> my current workaround is choosing one of the models including \"+I\" tested before crashing; Since it looks like a bug I will try to fix it if you send me this alignment directly to my email... Em segunda-feira, 19 de janeiro de 2015 08:00:11 UTC-2, jspa...@ gmail.com escreveu: Dear guys, This is great software! Hope you keep developing it... In the hope of helping others who're also using it, here are some minor crash reports I've had with IQTree 1.1.5 in Ubuntu 14.04 (and some suggestions as well): Crashes: - partitioned models including DNA (perhaps protein too? Didn't test) + morphology/binary; I haven\u2019t tested mixing morphology/binary data with other data type thoroughly. Again if you send me the alignment then I can fix it. - option \"-spp\" doesn't work as expected (crashes asking for \"-nn1\", but when it's put there, crashes as well); Right, we knew this already (that\u2019s why we marked this option as \u201cExperimental feature\u201d in the manual). Since we are still working on a ms, we will release a stable version once the ms is submitted. We will notify once this is available. - when proportion of invariant sites is too high (seen this with >0.9, not sure about the threshold), models with +I+G crashes -> my current workaround is chosing; Suggestions: - with partitioned data sets, make option \"-spp\" the default behaviour (proportional branch lengths across partitions), which is typical of other ML software too (and further decreases the number of parameters being estimated per partition, which is utterly important for alignments with small number of taxa/sites); - possibility to include list of models to be tested (instead of the whole 88); I see, will add this to the TODO list Minh Thks for developing IQTree! All the best, Jose. You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Dear Jose, just want to let you know that several issues have been fixed in version 1.2.0 released today. I will appreciate if you can cross check with your data set? Thanks! Minh ", "Dear Dr. Minh, That's awesome, I'll check it and send you feedback on it! Cheers, Jose You received this message because you are subscribed to a topic in the Google Groups \"IQTREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/r-uZ6vQ9kcg/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ------------------------------------------------------------- Jose Salvatore L. Patane Post-Doc - Departmento de Bioqu\u00edmica Instituto de Qu\u00edmica Universidade de S\u00e3o Paulo Av. Prof. Lineu Prestes, 748 - sala 911 S\u00e3o Paulo, SP 05508-000, Brazil Tel.: +55 (11) 3091-9804 ", "Dear Dr. Minh, Yes, now that crash disappeared (have been working with v1.3.5 now), great that was fixed! Jose To unsubscribe from this group and all its topics, send an email to iqtree+unsubscribe@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "4MqPgFnSIDQ": {"topic": "alignments of bootstrap samples", "initializeDate": "Dec 21, 2016, 5:18:24 AM", "timeStamp": "Dec 21, 2016, 6:42:53 PM", "content": ["Hi all, Is there a way to export the alignments (not trees) of each bootstrap sample? Thank you Victor ", "Dear Victor, yes there is an undocumented option \u201c-wba\u201d (standing for \"write bootstrap alignments\u201d). All the bootstrap alignments will be printed into one file with suffix \u201c.bootaln\". Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Awesome!! Thanks Minh! ", "Hi Minh, Just ran your example.phy to get bootstrap alignments with the option \u2013wba. IQ-tree did output the file with suffix \u201c.bootaln\", but it contains zero bytes (all other outputs were ok). I tried with my own dataset and also got an output for \u201c.bootaln\u201d of zero bytes. Could you help with that? Thank you Cheers Victor "]}, "GXnCRUBPCdw": {"topic": "WARNING: Estimated model parameters are at boundary that can cause numerical instability!", "initializeDate": "Jan 16, 2021, 1:30:37 AM", "timeStamp": "Feb 1, 2021, 3:59:21 AM", "content": ["Hi, IQ-TREE developers! Thank you for providing us this very fast running phylogenetic analysis software. As I wrote in the title, I'm getting this error below and can't get out of it. WARNING: Estimated model parameters are at boundary that can cause numerical instability! This appeared while creating gene/locus trees using -S option as below iqtree -s myfilename.phy -S myfilename_partitions.txt --prefix loci -T AUTO Of course, I've already created a species tree for this data set using -p option as below (it actually worked well, I think) iqtree -s myfilename.phy -p myfilename.nex --prefix concat -T AUTO I really hope someone would help me with this error message. Best wishes, Hiroto Tai ", "Hi Hiroto, Someone else also reported the same issue with -S option, but unfortunately we couldn\u2019t figure out why. So I suggest that you use a \u201cfor loop\u201d to construct individual gene trees. The individual tree files can then be concatenated together. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/dd4c1db0-363f-4d36-adbb-834ea5453269n%40googlegroups.com ", "Hi, Dr.Minh, Thanks for the suggestion! Though it may be also a bit tough to split the sequences to separate files, I'll try anyway. Best, Hiroto Tai 2021\u5e741\u670828\u65e5\u6728\u66dc\u65e5 11:50:12 UTC+9 Minh Bui: "]}, "elf4neGs8hg": {"topic": "simulation under the GHOST model", "initializeDate": "Sep 14, 2017, 10:18:15 AM", "timeStamp": "Sep 19, 2017, 5:44:05 AM", "content": ["Dear IQTree Team, I would appreciate if you tell me if there is a way to simulate replicates under the GHOST model. Could you also advise me how to use the unlinked GHOST model, which, as per the manual should be called, e.g.: -m GTR*H4 When I try to use this model with the following iqtree version: IQ-TREE multicore version 1.6.beta4 for Linux 64-bit built Jun 21 2017 the program prints: iqtree: No match. and quits. Thank you for your help, Vadim ", "Dear Vadim, That\u2019s weird, there is no part in the IQ-TREE code that prints this message. Can you send us the full log file? Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Vadim, It has been quite a while since we were in contact last ;) One guess what this message might come from. Maybe the iqtree executable is not in the search path defined by the variable PATH under Linux. How this message looks depends (a) on the Linux distribution and (b) the shell one is using. On most Linux systems such a message would be: \u201ciqtree: command not found\u201d. If this is the reason - this can also happen, if the executable is actually placed in the current working directory, because the current directory \u201c.\u201d Is typically not in the path. Could you please try to run it with the full path (no matter whether relative from the current directory or absolute starting with \u201c/\u201c) leading to the executable? As I said it\u2019s only a guess, but it is the only idea I have since (as Minh wrote) there is no such message in the IQTree code/executable. Best wishes, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Dear Vadim again, Sorry I forgot this question: I would appreciate if you tell me if there is a way to simulate replicates under the GHOST model. Assuming that you do -m GTR*H4, then you will see something like this in .iqtree file: Mixture model of substitution: MIX{GTR+F,GTR+F,GTR+F,GTR+F}*H4 No Component Rate Weight Parameters 1 GTR 1.0000 1.0000 GTR{2.25495,4.95837,2.01928,0.887905,9.52507}+F{0.354671,0.228235,0.191925,0.225169} 2 GTR 1.0000 1.0000 GTR{3.74769,0.867304,4.21835,0.232151,3.57077}+F{0.354671,0.228235,0.191925,0.225169} 3 GTR 1.0000 1.0000 GTR{2.69266,64.479,8.5735,4.29265,75.2463}+F{0.354671,0.228235,0.191925,0.225169} 4 GTR 1.0000 1.0000 GTR{2.83327,1.7128,2.20851,0.087827,7.47787}+F{0.354671,0.228235,0.191925,0.225169} Model of rate heterogeneity: Rate heterotachy with 4 categories Heterotachy weights: 0.4751 0.1297 0.2038 0.1914 Heterotachy tree lengths: 0.3715 4.0606 5.1894 11.7273 Moreover, in .treefile file, there are 5 trees printed with the same topology but just different branch lengths. The 1st tree is the combined tree, whereas the next 4 trees correspond to the 4 heterotachy class. So you would need to simulate 4 alignments. The first alignment corresponds to the 2nd tree in .treefile and this model parameters: 1 GTR 1.0000 1.0000 GTR{2.25495,4.95837,2.01928,0.887905,9.52507}+F{0.354671,0.228235,0.191925,0.225169} where the alignment length should be 0.4751*original_aln_length And so on for 2nd, 3rd, 4th-class alignment. And finally concatenate them. That\u2019s all I can think of. @Stephen Crotty might even be able to give you the script to do all these, as I believe he did this for the GHOST manuscript. Cheers, Minh ", "Dear IQTree Team, The issue with the executable path does not seem to affect the error, because the command line, in which the option \"-m GTR*H4\" has been immediately substituted by \"-m GTR+H4\" in the same Linux terminal has started program executon in my previous experiments. Also, if I remember correctly, I was able to find only the option \"GTR+H#\" (but not GTR*H#) in the list of program arguments invoked by typing \"iqtree - help\". I use IQ-TREE multicore version 1.6.beta4 for Linux 64-bit built Jun 21 2017. I will investigate more in a few days when I return back to work. Best wishes, Vadim Also, I have noticed that the help menu of the ", "Dear Vadim, (Minh, please see below for a suggestion) Oh, indeed there are more possibilities that can cause the \u201cNo match\u201d message. Please be aware, that \u2018*\u2019 and \u2018#\u2019 are special characters in Unix/Linux shell environments. The star \u2018*\u2019 is a wildcard that marks any set of characters that can resolve to existing filenames. For instance \u201ca*.txt\u201d would be substituted by the shell to every filename starting with \u201ca\u201d and ending with \u201c.txt\u201d in the current working directory. Hence, for \u201c-m GTR*H4\u201d the shell will try to resolve \u201cGTR*H4\u201d by any fitting filename starting with \u201cGTR\u201d and ending on \u201cH4\u201d - fortunately there is none and that might produce the message \u201cNo match\u201d from the shell, not iqtree itself. (But this again depends on the systems and shell settings of your system. Suse Linux or MacOSX do not produce a message. Typically, if there is no match the shell keeps the start \u2018*\u2019 untouched. However, if one creates folders like GTR+H4, GTR+H3, GTR+H5, etc. then GTR*H4 would be substituted by GTR+H4 automatically.) @Minh: the use of the star \u2018*\u2019 in the multi-partition/multi-alignment files is of course save because their content is not touched by the shell. However, for the commandline I suggest (a) to add a remark to the manual either a \u2018\\\u2019 before the star (\"\\*\u201d) or quotes around the model name and possibly a remark explaining the special role of stars in the shell, and (b) it might be a good idea to allow something like GTRxH4 as an alternative to GTR*H4 to have a shell-save variant for the commandline. What do you think. Just for completeness, the \u2018#\u2019 denotes that everything following the letter in that line is a comment and thus the end of the command line would be ignored\u2026 indeed neither Vadim nor IQ-TREE does use \u2018#\u2019 in the commandline, but using it e.g. in filename would be a certain source of error ;) Best wishes, Heiko ", "Hi Vadim, With regard to simulating datasets under a GHOST model, I\u2019m afraid I do not have a simple script to do this generally. However, the methodology is quite straight forward and is as described by Minh below. To create a dataset under the GHOST model, one simply simulates separate alignments for each class desired. Here is the procedure I followed when simulating two-class datasets for the validation of the GHOST model: 1. Generate a random tree topology, T. 2. Generate a random set of branch lengths for each of the two classes. 3. Using the above, create a tree file in Newick format for each class. 4. Generate random substitution and base frequency parameters for each class. 5. I then used Seq-Gen to simulate alignments for each class, of whatever length is desired. 6. Finally, I used the ape package in R to read the two simulated alignments, concatenate them into one alignment and write the sequence to a .fasta file. There is a section explaining what I did in more detail in the \u201cValidation of the GHOST model\u201d section of our manuscript: http://www.biorxiv.org/content/early/2017/08/10/174789.article-metrics Hope this helps, Stephen ", "Dear Minh Thank you very much for your explanarion about simulation under a GHOST model. In your example I have the following parameters to simulate the first alignment representing the first heterotachy class: 1 GTR 1.0000 1.0000 GTR{2.25495,4.95837,2.01928,0.887905,9.52507}+F{0.354671,0.228235,0.191925,0.225169} Could you tell me what do the first two parameters (1.0000 1.0000) represent when simulation of a separate replicate (0.4751*original_aln_length) is attempted? Does the first parameter (1.0000) correspond to an alpha parameter of G distribhution (G with a=1)? What does the second parameter represent? Or, more generally, does a proportion of sites assigned to a heterogeneity class assume some form of among sites rate heterogeneity at all, and if yes, how it should be modeled? Best wishes, Vadim Am Donnerstag, 14. September 2017 16:18:15 UTC+2 schrieb vadim.g...@fmach.it ", "Dear Heiko, I would like to confirm that masking the model name as you have suggested (e.g. -m GTR\\*H5) helped to avoid program crash. Thank you very much! I should say that, following advise of Stephen Grotty I have consulted the \u201cValidation of the GHOST model\u201d section of your paper on the GHOST model. The section says \u201cWithin each class, the five relative substitution rates were drawn randomly from a uniform distribution between 0.5 and 5.\u201d It appears that a form of rate heterogeneity would be expected within a heterotachy class (please correct me if I am wrong). Could you please tell me if one needs to simulate a rate heterogeneity among sites for each heterotachy class, and, if so, how this can be done based on the information in the iqtree output files? Or, for the simulation purposes, should I assume that each heterotachy class assumes an equal rate for all sites included (like in the native GTR model)? Best wishes, Vadim ", "Hi Vadim, Currently IQ-TREE does not support fitting a rate heterogeneity model, eg. Gamma, within each heterotachy class. If you are attempting to simulate data based solely on the output from IQ-TREE then you should not introduce any rate heterogeneity to the classes. As explained earlier by Minh, you should just use the rate parameters, base frequencies, trees and weights inferred for each class to independently simulate one alignment for each class. Then concatenate the classes together into one alignment. As to the question of whether rate heterogeneity should be included within each class or not, that is something that can be debated. I have little doubt that including a Gamma model within each class would improve the likelihood at little cost (in terms of additional parameters). However, if you read the discussion of the GHOST paper, you will see that part of the rationale behind its development was to minimise the amount of model constraints. The necessity of the classes in a Gamma model to have relatively scaled branch lengths is one such constraint. Indeed, you can think of a GHOST model as a relaxation of the Gamma model - it allows multiple classes but without the necessity of the branch lengths being scalar multiples of each other. The cost of course, is the additional parameters required by the GHOST model. So I\u2019d be inclined not to include rate heterogeneity within the GHOST classes. But I\u2019d certainly be happy to hear arguments/discussion to the contrary. Cheers, Stephen Crotty ", "Dear Stephen, Thank you very much! Vadim To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/elf4neGs8hg/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+unsubscribe@googlegroups.com "]}, "SEX3mKcVIxQ": {"topic": "Constraint trees - ERRROR: a taxon has no name?", "initializeDate": "Nov 30, 2017, 4:28:21 PM", "timeStamp": "Dec 7, 2017, 2:56:21 PM", "content": ["Dear IQ-TREE team, I get the following error reading in a constraint tree via the -g option: Reading constraint tree Zahiri5.nex... ERROR: A taxon has no name. (line 1 column 1915) I created this tree using Mesquite, and have attached it below. I removed branch lengths manually, but still get this error. I saw the earlier thread from 15 September addressing this topic, but I do not seem to have any single entities within their own brackets. Do you have any suggestions about how to proceed from here? Thank you in advance for your help with this question! Nicholas Homziak ", "Dear Nicholas, Your constraint newick file has a double parentheses right at the beginning: ((\u2026)); Please remove the redundant parenthesis. I don\u2019t know if there is any other mistake. But you can try iqtree again at least with this correction. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <Zahiri5.nex> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Dr. Minh, Thank you for catching that mistake. IQ-TREE ran without issue after removing the double parentheses. Thank you for your help, Nicholas Homziak "]}, "22sxfJQGi88": {"topic": "number of sequences and alignment length", "initializeDate": "Apr 8, 2015, 10:14:54 AM", "timeStamp": "Apr 8, 2015, 10:25:51 AM", "content": ["Hi, This article (DOI: 10.1093/molbev/msu300) says that \"...the number of sequences must be between 200 and 800 for DNA...alignments. Second, the alignment length must be at least four (or two) times the number of sequences in DNA (or AA) alignments. Third, the proportion of gaps/ unknown characters must be less or equal than 70%.\". Can I use the IQ-TREE to perform a phylogeny from an alignment with 17 sequences (nucleotides) and 11153 nt (alignment length)? Thank you. Daniela ", "Hi Daniela, Of course you can use IQ-TREE with any number of sequences or alignment length that fit your computational resource. In the article, we used large alignments because small alignments are often \"too easy\" for benchmarking. Other criteria were just used to filter out \"bad\" alignments in TreeBase. They are by no means restrictions of IQ-TREE. Cheers Tung "]}, "JZgRuBeUt9o": {"topic": "Why are some models skipped in the model selection?", "initializeDate": "Jun 20, 2016, 7:57:19 AM", "timeStamp": "Jun 21, 2016, 2:26:34 AM", "content": ["Hi, I am running a model selection with the following command: iqtree-omp -nt 8 -s aln.fasta -pre aln_testnewonly -m TESTNEWONLY -mset LG -madd LG4M,LG4X,C60 -mfreq F -mrate E,I,G10,I+G10,R -cmin 5 -cmax 10 The 2 models LG+F+R9 and LG+F+R10 have been skipped in the process, any idea why this might bet? Many thanks, Fabien ", "Dear Fabien, This is a feature: iqtree tests models with increasing numbers of categories (starting from 2) until the model fit does not improve. In your case +R8 showed worse fit than +R7. Therefore +R9 and beyond would be worse anyway and thus skipped. Cheers, Minh Sent from my Samsung device You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "ndQ7pM_HMhM": {"topic": "IQ-TREE segmentation fault (Core dumped) on phylogenetic tree generation for more than 20,000 genomic sequences", "initializeDate": "Mar 19, 2021, 10:03:00 AM", "timeStamp": "Mar 25, 2021, 7:07:31 AM", "content": ["Dear IQ-TREE Community, I have been trying to generate phylogenetic tree (ML with UFB 1000) for genomic sequence alignment (more than 20,000 genomic sequences) on my workstation (running on Ubuntu 20.04 LTS) but it shows segmentation fault (core dumped). I have tried couple of times but my bad, I was not able to sort it out. Kindly help me figure it out. Thank you ", "Can you please provide more information? Anyway with 20K sequences, I\u2019m not sure if IQ-TREE will be able to complete the analysis, even without crashing\u2026 Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1038d7f0-b508-4dbd-9f02-beec19c0f70bn%40googlegroups.com "]}, "bmTzAZsg_6k": {"topic": "binomial test of symetry", "initializeDate": "Jun 12, 2019, 7:09:01 AM", "timeStamp": "Aug 31, 2020, 7:38:19 AM", "content": ["Good day, I am interest in the BiSymTests. Those tests explore stationary, reversible and homogeneous (SRH) conditions of partitions. Those tests were suggested by Naser-Khdour et al. in your preprint \u201cThe prevalence and impact of model violations in phylogenetics analysis\u201d. Also those tests were implanted in IQ-TREE (Beta version 1.7 \u2013 beta 2) with command line --bisymtest (binomial test of symmetry ) at first time. New command lines were added at Beta version 1.7 \u2013 beta 4, Beta version 1.7 \u2013 beta 5, and Beta version 1.7 \u2013 beta 7, however I do not know if those new command lines (binomial test of symmetry) are in the last version of IQ-TREE (1.6.10 or 1.6.11 versions), also I do not know who apply those command lines (I could not find those commands in the manuals of IQ-TREE), so I am two questions: Which IQ-TREE version contains the binomial test of symmetry? How I can apply the binomial test of symmetry (e.g., command lines, input, etc)? Than you so much, Michel ", "Hi Michel, Thanks for your interest and apology for the delay - I was travelling. The tests of symmetry are only available in the beta version 1.7, not the stable release 1.6. That\u2019s why they are not described in the manual yet. Which IQ-TREE version contains the binomial test of symmetry? I recommend you download the latest beta version from https://github.com/Cibiv/IQ-TREE/releases (currently beta12). How I can apply the binomial test of symmetry (e.g., command lines, input, etc)? Let\u2019s first show the help usage: TEST OF SYMMETRY: --bisymtest Perform three binomial tests of symmetry --maxsymtest NUMBER Replicates for maximum tests of symmetry --symtest-remove-bad Do --bisymtest and remove bad partitions --symtest-remove-good Do --bisymtest and remove good partitions --symtest-type MAR|INT Use MARginal/INTernal test when removing partitions --symtest-pval NUMER P-value cutoff (default: 0.05) --symtest-keep-zero Keep NAs in the tests Simply run IQ-TREE as follows: iqtree -s ALN_FILE -p PARTITION_FILE --bisymtest To identify partition that failed the tests. In the log file, you will see something like: Performing matched-pair tests of symmetry... 100% 0.006 seconds SymTest results written to example.nex.symtest.csv Actually you can kill the run once IQ-TREE passed this point and look at the csv file. This file may look like this (from the example alignment): # Matched-pair tests of symmetry # This file can be read in MS Excel or in R with command: # dat=read.csv('example.nex.symtest.csv',comment.char='#') # Columns are comma-separated with following meanings: # Name: Partition name # SymSig: Number of significant sequence pairs by test of symmetry # SymNon: Number of non-significant sequence pairs by test of symmetry # SymBi: P-value for binomial test of symmetry # MarSig: Number of significant sequence pairs by test of marginal symmetry # MarNon: Number of non-significant sequence pairs by test of marginal symmetry # MarBi: P-value for binomial test of marginal symmetry # IntSig: Number of significant sequence pairs by test of internal symmetry # IntNon: Number of non-significant sequence pairs by test of internal symmetry # IntBi: P-value for binomial test of internal symmetry Name,SymSig,SymNon,SymBi,MarSig,MarNon,MarBi,IntSig,IntNon,IntBi part1,44,92,6.28775e-24,50,86,5.87435e-30,4,132,0.912781 part2,43,93,5.67514e-23,49,87,6.43434e-29,5,131,0.815054 part3,23,113,3.04046e-07,37,99,1.49562e-17,7,129,0.523227 The relevant columns that SymBi, MarBi and IntBi, which are the p-values for 3 different variants of the test of symmetry. A p-value < 0.05 indiciates that the partition is rejected by the test, i.e. does not comply with statitionarity / reversibility or homogeneity conditions. You can ask IQ-TREE to remove \u201cbad\u201d partitions from subsequent analysis by adding --symtest-remove-bad option. By default, this will remove partititons with SymBi < 0.05. Hope that helps for now. We will write this in a proper document. Thanks for your patience, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/fd5bd67d-9b08-4836-a188-b2148fe5100f%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Could you explain the purpose of the --symtest-keep-zero option? Does this mean that partitions which cannot be tested are kept in the downstream analysis? Best wishes, Jake Berv ", "Hi Jake, Long story short: ignore this option, the default is good. This option was introduced while I encountered a technical problem with the test, which was then solved. If you want to know: This option concerns with a technical implementation of the symmetry test. It\u2019s explained the paper regarding this sentence ( https://doi.org/10.1093/gbe/evz193 A P value is then obtained by a chi^2 test with f degrees of freedom, where f is the number of (i, j) pairs for which d_ij + d_ji > 0. With --symtest-keep-zero option, IQ-TREE actually then renders the test to be inapplicable for any locus, where there exist an (i,j) pair such that d_ij + d_ji = 0. But that\u2019s not good for (many) sparse divergence matrix, especially amino-acid. Therefore, we use a reduced degree of freedom of f, instead of (m choose 2). Cheers Minh > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/be15e6a3-c1b0-4c9a-9e15-3b6da3ddc028n%40googlegroups.com ", "Cool \u2014 thanks for the clarification. On a related note \u2014 say for example I have a directory containing fasta files of coding sequence alignments in reading frame. Is there an automated way to tell IQtree to consider codon positions as separate partitions for each locus separately? Or do I need to first parse out codon positions from each locus before passing them to IQtree. I know I can pass IQtree a partition file that specifies how to generate sub-partitions for individual sequence alignments (or alternatively, it\u2019s easy enough it's easy enough to parse out before analysis) but it would be convenient to be able to direct IQtree to multiple directories (for example, directory 1 = coding sequence alignments, directory 2 = noncoding sequence alignments), and also then flag IQtree to further partition each locus in directory 1 into codon positions for subsequent analyses. Or something like that\u2026 Best, Jake ", "Hi Jake, I vaguely remember that someone else requested that feature. It\u2019s a valid request, we just don\u2019t have enough resources to do it. In fact we are focussing on COVID-19 at the moment. You can nevertheless create a github issue here https://github.com/iqtree/iqtree2/issues , that\u2019s the place to remind us of something TODO from time to time. Cheers Minh "]}, "89egH8Z8sDY": {"topic": "Help with reconstruction of ancestral sequence", "initializeDate": "Sep 30, 2020, 7:18:59 PM", "timeStamp": "Oct 14, 2020, 3:42:22 PM", "content": ["I'm trying to reconstruct the ancestral sequence of an enhancer using IQ-TREE. I have the enhancer sequences for several organisms and their phylogenetic relationships (with branch lenghts included), coded in the following Newick tree: ((((((((((((((((Xiphophorus:0.163704,Poecilia:0.163704):0.30415,(Cyprinodon:0.40872,Fundulus:0.40872):0.059138):0.1919,Kryptolebias:0.659753):0.098759,Oryzias:0.758508):0.076102,Pundamilia:0.834611):0.011208,(Parambassis:0.82257,Acanthochromis:0.82257):0.023255):0.066068,(Scophthalmus:0.796596,((Mastacembelus:0.59803,Monopterus:0.59803):0.082706,(Betta:0.39546,Anabas:0.39546):0.28527):0.11586):0.11529):0.023867,(Gasterosteus:0.791517,Labrus:0.791517):0.14424):0.103656,Periophthalmus:1.04121):0.336975,Gadus:1.37639):0.433232,(Esox:0.82349,Hucho:0.82349):0.98612):0.38432,(Clupea:1.9049,(Danio:1.45489,(Electrophorus:1.2594,(Pygocentrus:0.85253,Astyanax:0.85253):0.40687):0.19548):0.45004):0.289):0.22731,(Scleropages:1.8936,Paramormyrops:1.8936):0.52768):0.073013,Anguilla:2.49425):0.53182,Lepisosteus:3.02611):0.55924,Acipenser:3.5853):0.82294; The problem I'm having is that the node I'm most interested in is the first one (common ancestor of Acipenser with every other organism in the tree), which is not reconstructed by IQ-TREE. It reconstructs the ancestral sequence of each node starting from the second one (common ancestor of Lepisosteus and every other organism) onwards. I've thought of a solution, although I'm not quite sure how good of a solution it is. I'm thinking of making up a \"mock\" outgroup, in which I've made up the sequence completely, but leaving the binding sites of the sequence (the parts I'm most interested in) as unknowns (coded as \"N\" in the sequence). Would this be a good solution? If not, is there a better solution for this problem? Any help on this matter would be greatly appreciated. ", "Hi there, Yes, your solution is sensible. Also add an option -keep_empty_seq in the command line, so that IQ-TREE won\u2019t discard this sequence from the analysis. Also if you want to fix the branch lengths like this, use option -blfix. Otherwise IQ-TREE will reestimate the branch lengths based on alignment and model. Cheers MInh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/160702ce-c39a-4054-a34d-390f9956a5a4n%40googlegroups.com ", "Thank you so much! You've been really helpful. I will try this. Vicente Mu\u00f1oz Walther Ph.D.(c) Laboratorio de Ontogenia y Filogenia Las Palmeras 3425 Universidad de Chile ", "I've got one further question. In the example shown on \" http://www.iqtree.org/doc/Command-Reference \" about ancestral reconstruction, the model of substitution used is \"JC+G\". The line of code is as follows: iqtree -s example.phy -m JC+G -asr As I understand it, JC refers to the Jukes and Cantor model of substitution, but I'm not quite sure what the +G means. Is this the best model of substitution, or are there better options? I'm quite new to this topic, so any help would be really appreciated. ", "Hi Vicente It is the Gamma distribution, this model assumes that the substitution rate at each site is a random variable that is described by a discretized gamma distribution, which has two parameters: the shape parameter, \u03b1, and the rate parameter, \u03b2. In order that we can interpret the branch lengths as the expected number of substitutions per site, this model assumes that the mean site rate is equal to 1. If you want to know a little more, I invite you to read: https://link.springer.com/article/10.1007/BF00160154 https://www.researchgate.net/publication/281591353_Modelos_de_sustitucion_de_nucleotidos_y_otros_modelos https://www.ccg.unam.mx/~vinuesa/Cursos_PDFs/BGE4-Tema4_modelos_de_sust_nt.pdf Cristian E. Cadena-Caballero Biologist Coelomed genomics laboratory. Industrial University of Santander. ", "Thank you! To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/bf3a1e4a-d299-4b64-8f52-29b78cf758b6n%40googlegroups.com ", "I have one further question, I would really appreciate any help. I did the sequence reconstruction using a \"mock\" outgroup with a \"NNNN...\" sequence, to reconstruct the sequence of the first node (N1), which is the most interesting to me. By doing this, I introduced a new node which I called NR (Node root). The Newick tree used is: (((((((((((((((((Xiphophorus:0.163704,Poecilia:0.163704)N29:0.30415,(Cyprinodon:0.40872,Fundulus:0.40872)N28:0.059138)N27:0.1919,Kryptolebias:0.659753)N26:0.098759,Oryzias:0.758508)N25:0.076102,Pundamilia:0.834611)N24:0.011208,(Parambassis:0.82257,Acanthochromis:0.82257)N23:0.023255)N22:0.066068,(Scophthalmus:0.796596,((Mastacembelus:0.59803,Monopterus:0.59803)N21:0.082706,(Betta:0.39546,Anabas:0.39546)N20:0.28527)N19:0.11586)N18:0.11529)N17:0.023867,(Gasterosteus:0.791517,Labrus:0.791517)N16:0.14424)N15:0.103656,Periophthalmus:1.04121)N14:0.336975,Gadus:1.37639)N13:0.433232,(Esox:0.82349,Hucho:0.82349)N12:0.98612)N11:0.38432,(Clupea:1.9049,(Danio:1.45489,(Electrophorus:1.2594,(Pygocentrus:0.85253,Astyanax:0.85253)N10:0.40687)N9:0.19548)N8:0.45004)N7:0.289)N6:0.22731,(Scleropages:1.8936,Paramormyrops:1.8936)N5:0.52768)N4:0.073013,Anguilla:2.49425)N3:0.53182,Lepisosteus:3.02611)N2:0.55924,Acipenser:3.5853)N1:0.30264,Polypterus:3.88793)NR; Polypterus serves as the mock outgroup. Doing this, I was attempting to reconstruct a position of particular interest to me, which it managed to do. Thinking about it, I find it curious. This position is a T in Acipenser and C in the rest of the tree. There is a split at the base of the tree, in which one branch (Acipenser) is one way (T), and the other (the rest of the tree) is another(C). So I'd say there's a 50% chance of that position being either C or T. But, the algorithm reconstructed an 80% chance of it being C. Is this result meaningful? or is it some sort of bias or artifact resulting from the methodology I used (the mock outgroup methology). Would adding more taxa with \"NNNNN...\" sequences in different positions in the tree change this result in any way? Any help would be tremendously appreciated. ", "Hi Vicente, As discussed, adding \u201cmock\u201d outgroup is totally fine, no biases or things like that. When you say only one sequence shows a T, and the rest (>30 sequences or so) show a C, why do you think that there is 50:50 being C or T? Note that this is the reconstruction with a model (under a mixed likelihood and empirical Bayesian approach), not the parsimony ancestral construction. This model may show different substitution rates between the bases, say C->T is not equally likely as T->C or C->A. Moreover, the branch lengths also play a role. The tree you posted is a clock-like tree, or cladogram, perhaps only for drawing purpose. If that\u2019s the case, I would not use these branch lengths for the ASR inference because they must be in the units of substitutions per site, and hence ignore my previous comment about using -blfix option. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CA%2BVmrY7Ddz0QbK3COf0vSc1mii-eczQwr9%3Dq7SsYZ292oScYTQ%40mail.gmail.com ", "Thank you so much! The branch lengths I obtained from a publication that estimated divergence times using molecular data calibrated with the fossil record (Hughes et al., 2018). The sequence I'm trying to reconstruct is quite short (around 40 pb), so I don't believe that the program would get accurate branch lengths based on the alignment. Or maybe that doesn't really matter? Should I still not use the -blfix option? Again, thanks for any help you can provide. ", "Then defintely do not use these branch lengths for ASR reconstruction, because they are expressed in different units, not the number of substitutions per site. You need to extract the branch lengths from before they did the transformation. If that\u2019s still not available, simply ignore -blfix option. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CA%2BVmrY5M1AWYv62ENst79f7d6Qy%2BifJv4wE6pQEnYj6Xvdsp9Q%40mail.gmail.com ", "I've found that when doing ancestral state reconstruction using the -blfix option, I get Rate parameters and Base frequencies in the .log file. Such as: Rate parameters: A-C: 1.79418 A-G: 9.23818 A-T: 1.02706 C-G: 3.60946 C-T: 6.72761 G-T: 1.00000 Base frequencies: A: 0.207 C: 0.180 G: 0.225 T: 0.388 I do not get this information when not using the -blfix command. Is there a reason for this? The command I'm using is: bin\\iqtree -s Full_alignment_4.phy -asr -keep_empty_seq -m GTR+G+I -te Full_tree_NOBL.txt -redo -o Polypterus -blfix -keep_empty_seq to use the \"mock\" sequence full of \"NN...\" -m GTR+G+I is the substitution model -o Polypterus to set the \"mock\" outgroup as an outgroup -blfix to fix branch lengths, I've tried with and without this option. Since I'm not using branch lengths (I can't obtain branch lengths in the unit of substitution/site), I understand that I should not use this option. Any further help would be greatly appreciated. "]}, "Db6Rvzmp90Y": {"topic": "logLs values with trees with same topology", "initializeDate": "Aug 28, 2018, 2:19:12 PM", "timeStamp": "Aug 30, 2018, 12:10:14 PM", "content": ["Hi, I have a question about logL values of tree topology tests (maybe is really obvious). I compared 63 trees without branch lenghts, which I know if I rooted them with the same outgroup, that only 5 differ in topology. So, I expected same topology, same logL values but I got 53 different values. I know tests values will change because of number of trees and logL of the rest of the trees, but why logL values changes? It is something related to the order in the file or because someting about ML trees unrooted? Or are these logL values relatives and not absolutes of each tree? Thanks in advance, Bea Beamud ", "Hi Bea Beamud, It\u2019s hard to answer without additional information. Can you please give the IQ-TREE version, command line used and relevant part of .iqtree file (USER TREES)? Are their any WARNING in the log file? Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "V1XDmB6wFg0": {"topic": "AU-test", "initializeDate": "Aug 3, 2016, 11:14:59 AM", "timeStamp": "Sep 29, 2016, 5:17:54 PM", "content": ["Hi, wondering about known issues with the AU-test in v1.4.2. In my dataset, the p-AU output values (-au) look unrealistic and are different from KH, SH, ELW values, and from p-AU values computed with Consel from per-site log-likelihoods (-wsl from the same run, or alternatively via RAxML), which look good. Ran iqtree -s infile -m LG+I+G4+F -z trees -wsl -zb 1000 -zw -au. Outputs are attached. J ", "Dear J, thanks for the report. That indeed looks odd. Please send me your data via personal email, so that i can investigate Minh > On Aug 3, 2016, at 5:14 PM, janj...@gmail.com wrote: > Hi, wondering about known issues with the AU-test in v1.4.2. In my dataset, the p-AU output values (-au) look unrealistic and are different from KH, SH, ELW values, and from p-AU values computed with Consel from per-site log-likelihoods (-wsl from the same run, or alternatively via RAxML), which look good. Ran iqtree -s infile -m LG+I+G4+F -z trees -wsl -zb 1000 -zw -au. Outputs are attached. J > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout > <AU_test_consel><AU_test_iq-tree> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Thanks for your prompt response. The dataset and associated files are attached (see README). The dataset I tested this on is rather big, unfortunately (31k sites). I wanted to say thanks for IQ-TREE too, it is a very useful tool. Let me know if you have any questions. Jan ==== Jan Janouskovec Excellence Research Fellow University College London Department of Genetics, Evolution & Environment Room 631, Darwin Building Gower Street, London, WC1E 6BT, UNITED KINGDOM Phone: 07415773605 (+447415773605 You received this message because you are subscribed to a topic in the Google Groups \"IQTREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/V1XDmB6wFg0/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com ", "Hi all, Minh and Co, has this been solved? I am asking because I also have an enormous big dataset where I wanted to apply the AU test, but probably I can't make corresponing tests with ExaML... Any news here? Best Karen ", "Dear Karen, the AU test was fixed in a beta version that can be downloaded from here: https://github.com/Cibiv/IQ-TREE/releases/tag/v1.4.4-beta Minh ", "greaqt, many thanks :) Best Karen ", "Dear Minh and all, I have a quite large dataset which I want to apply the AU test with 3 different topologies (IQtree 1.4.4) All my trials fail, with following last lines of the logfile (see below). Maybe the command is wrong? I'm also don't know if I really need -te (I was using te as input tree since parameters should be optimized using this one) and also not sure if -spp is too oversized along with gmendian, or is it just a command problem since I first have to invoke that sitelogLH are calculated ( so would this be correct instead: ... -wsl -zb 1000 -au?) Sorry, I am slightly confused. (alternativly, shall I send you the files?) FcLM and siteloglh calculation is running well now! :) Thanks best Karen Parameters optimization took 26 rounds (698.949 sec) WARNING: Estimated model parameters are at boundary that can cause numerical instability! BEST SCORE FOUND : -17465086.983 Total tree length: 9.616 Total number of iterations: 0 CPU time used for tree search: 0.020 sec (0h:0m:0s) Wall-clock time used for tree search: 0.021 sec (0h:0m:0s) Total CPU time used: 12008.776 sec (3h:20m:8s) Total wall-clock time used: 714.420 sec (0h:11m:54s) Reading trees in /flush2/meu00c/ANTLIO/DDD_aa_AU/three_tree_topologies.tre ... 3 trees detected Note: 22867.427 MB of RAM required! Creating 10000 bootstrap replicates... STACK TRACE FOR DEBUGGING: 1 funcAbort() 2 () 3 memset() 4 Alignment::createBootstrapAlignment(int*, char const*, int*) 5 SuperAlignment::createBootstrapAlignment(int*, char const*, int*) 6 evaluateTrees(Params&, IQTree*, std::vector<TreeInfo, std::allocator<TreeInfo> >&, std::vector<int, std::allocator<int> >&) 7 reportPhyloAnalysis(Params&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, IQTree&, std::vector<ModelInfo, std::allocator<ModelInfo> >&) 8 runPhyloAnalysis(Params&, Checkpoint*) 9 main() 10 __libc_start_main() *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT *** For bug report please send to developers: *** Log file: ANLTIO_DDD_aa_AU_fixtre01.log *** Alignment files (if possible) /cm/local/apps/slurm/var/spool/job1795200/slurm_script: line 12: 162032 Segmentation fault iqtree -nt 20 -st AA -s DDD_aa_mare.fas -spp DDD_aa_mare.partitions.nex -pre ANLTIO_AU_fixtre01 -te best_tree_boridae_nannoplusfleas_pistil_01.tre -gmedian -z three_tree_topologies.tre -zb 10000 -au ", "Dear Karen, this indeed looks like a bug, can you pls send me the data files via personal email? Thanks, Minh ", "Hey Minh, just did a minute ago! Thanks a lot for taking are :)! best karen ", "Dear Karen, thanks for the detailed report, based on which I was able to fix the bug. It is a memory overflow for tree topology testing with extremely long alignments (>500,000 sites). It does not affect shorter alignments. You can now try the beta version here: https://github.com/Cibiv/IQ-TREE/releases/tag/v1.5.0-beta Let me know if it works now Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, supercool, great! I will test and let you know! @Bernhard: this is also the version with the new -g option (constrained tree while more taxa can be included in analyses) Best, Karen ", "PS: if the log-LH for partitions are implemented, can you send me a short note ? Would be awsome. Best, Karen ", "Hi Minh and all: the analyses ran through without a crash; (100000 replicates); done in 1 h with version 1.5.0b. The result makes sense (did not check all detailes) but for me it apparently works :) Cool!! Thanks so much Karen ", "Hi Karen, that\u2019s cool. Thanks for letting me know, that IQ-TREE passed such a huge analysis. Moreover, when you wrote the results make sense, did you compare with CONSEL? Cheers, Minh ", "no, i did not compare it with consel - it runs with my computer only in WINE and when I tried it crashes. If you have the possibility to test it with consel, go ahaed and let me know. I just mean with \"it make sense\" that I had expected this result from the AU test... of course this is not a proper evaluation... cheers karen Gesendet: Montag, 26. September 2016 um 17:02 Uhr Von: minh...@univie.ac.at An: kmeus...@googlemail.com Cc: iqt...@googlegroups.com janj...@gmail.com bmi...@uni-bonn.de Betreff: Re: [iqtree] AU-test Hi Karen, that\u2019s cool. Thanks for letting me know, that IQ-TREE passed such a huge analysis. Moreover, when you wrote the results make sense, did you compare with CONSEL? Cheers, Minh On Sep 24, 2016, at 8:43 PM, Karen Meusemann < kmeus...@googlemail.com > wrote: Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "this can be well due to not enough RAM in your computer. Nevertheless I think CONSEL may take days (if lucky) to do this large analysis. That\u2019s why I decided to reimplement this test. Minh ", "Dear Karen, there is now an option \u201c-wpl\u201d to write partition log likelihoods to .partlh file, in the beta version: https://github.com/Cibiv/IQ-TREE/releases/tag/v1.5.0-beta Minh "]}, "bTOy1FJTl7s": {"topic": "SUGGESTION Phylogenetic Dating", "initializeDate": "Jun 10, 2020, 4:47:01 AM", "timeStamp": "Jun 10, 2020, 9:27:20 PM", "content": ["Some sequences are not dated at all, but one can find the research / paper they were used or / and the submission date. It would be great if on can say \"< DATE\" like \"<2010-10\", as in that scenario you know when it was submitted / published but not if the sequence is from 2010 or 2000 or even before. Or maybe integrate the whole smaller / bigger than to have it in-between , like \"1900<2010\",\"DateStart < DateEnd\" ", "Hi Sto, Unless I misunderstood something, this is already possible. Specifically, you can specify a date range like this: TaxonXXX 2018-02-01:2018-03-31 So in the case where you have an upper bound, you would simply want to put a sensible lower bound, which might be the root date, or in the absence of that some very ancient date. In your examples, this might look like: TaxonXXX 1900:2010 Details are here: http://www.iqtree.org/doc/Dating Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5e4c224d-196e-4567-8186-a4c5f888f8eco%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com "]}, "F849mrvGxqU": {"topic": "Building gene trees: IQ-TREE CRASHES WITH SIGNAL ABORTED", "initializeDate": "Feb 28, 2020, 11:06:35 AM", "timeStamp": "May 5, 2020, 9:14:42 PM", "content": ["Hello, I am using version: IQ-TREE multicore version 2.0-rc1 for Linux 64-bit built Nov 21 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. I am trying to run the command: iqtree -S aln/ --prefix loci -T AUTO This runs for a while and then exits with: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: loci.log ERROR: *** Alignment files (if possible) I can see no other info in the log file that pertains to this error, so I don't even know where to start to try and figure this out (hopefully I didn't miss something simple!). Just for reference, the command: iqtree -p aln/ --prefix concat -B 1000 -T AUTO completes successfully. The logfile is attached. I can send the alignments as well, but they were too large to attach here. Please let me know how to send those and if you need anything else. Thanks! -Gregg ", "Hi Gregg, Can you try rc2 version here: https://github.com/Cibiv/IQ-TREE/releases/tag/v2.0-rc2 Let me know if that works or not. Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/fc02272a-dda2-4e35-80bc-9be55d2e74b9%40googlegroups.com <loci.log> ", "Hi Minh, Thanks for the reply. Unfortunately that didn't work either. I'm now getting a segmentation fault. Version: IQ-TREE multicore version 2.0-rc2 for Linux 64-bit built Feb 19 2020 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Error in the log file: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: loci.log ERROR: *** Alignment files (if possible) The logfile is attached, and I can send the alignments if necessary. Thanks! -Gregg To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hey Minh and Gregg I am facing exactly the same problem with iqtree-1.6.12-Linux version. Error in the log file- \"ERROR: splitgraph.h:235: int SplitGraph::getNTaxa(): Assertion `size() > 0' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: iqtree-FcC_smatrix.log ERROR: *** Alignment files (if possible)\" Any suggestions? ", "Hi Minh, I wanted to follow up on this. This appears to occur only when specifying -T > 1 (or -T AUTO). Running this analysis on a single thread completes successfully, though obviously takes longer. I have tried this on both SLURM and TORQUE managed systems with the same result. Here is the log file from my latest attempt yesterday, with the latest release of IQ-Tree. Version: IQ-TREE multicore version 2.0.4 for Linux 64-bit built Apr 27 2020 Command I ran: iqtree -S aln-windows/125kb-0.5-0.5-aln/ --prefix 125kb-0.5-0.5-loci -T AUTO Error: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: 125kb-0.5-0.5-loci.log ERROR: *** Alignment files (if possible) Log file is attached. Happy to send alignments, though I should note that I have tried this on multiple datasets now to no avail. Thanks, -Gregg ", "Hi Gregg, Sorry for the delay \u2014 At the moment I really have limited time to support users. In this case, you can alternatively do a for-loop to run IQ-TREE for each alignment instead of -S option. So I suggest that you do this for the moment. Before I can get to fix the issue. Nevertheless, pls send me the alignments and I will come to that when time permits. Thanks for your understanding, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9ed166b2-dfb5-4993-9df5-17f6fd656f79%40googlegroups.com <125kb-0.5-0.5-loci.log> "]}, "tu9UuKrwM3U": {"topic": "BUG?: number of partitions taken into account in Windows version", "initializeDate": "Oct 1, 2018, 11:07:00 AM", "timeStamp": "Oct 2, 2018, 7:42:38 PM", "content": ["Dear all, I am trying to run a routinary partitioned analysis using version 1.6.7 for Windows (Windows 10 user), and I realized that the program is taking a maximum of three partitions into account. I mean, no matter how many partitions I include in the partition nexus file, only the first three are considered. I got no error message and I got the tree, parameter estimates, etc. (including bootstrap if I want to do bootstrapping) fine, but everything only from the first three partitions. Example: I have two alignments: XX.phy and YY.phy I want to do the partitioned analysis using this partition file (partitions.nex): #nexus begin sets; charset part1 = XX.phy: 1-538; charset part2 = YY.phy: 1-655\\3; charset part3 = YY.phy: 2-655\\3; charset part4 = YY.phy: 3-655\\3; charpartition mine = GTR+F+I+G4:part1, GTR+F+I+G4:part2, GTR+F+I+G4:part3; GTR+F+I+G4:part4; end; Then I call IQ-tree as follows: -spp partitions.nex And I get this in the log file (Seed: 934292): Subset Type Seqs Sites Infor Invar Model Name DNA 538 315 142 GTR+F+I+G4 part1 DNA 219 142 GTR+F+I+G4 part2 DNA 218 109 GTR+F+I+G4 part3 And no partition 4... If I change the order of the files, and I put alignment XX.fas as the fourth partition, then I get (Seed: 612795): Subset Type Seqs Sites Infor Invar Model Name DNA 219 142 GTR+F+I+G4 part1 DNA 218 109 GTR+F+I+G4 part2 DNA 218 206 GTR+F+I+G4 part3 Alignments XX.phy and YY.phy share some taxa, but not all, so in the second analysis I do not get in the tree those taxa only present in XX.phy. I have tried also with other partitions, other alignments, with both fasta and phylip formats, different models, changing names, etc., and the result is always the same: any partition beyond the third one is ignored. In addition, I do not get any concatenated alignment (no \".nex.conaln\" file). What may I be doing wrong? Sorry if it something obvious or something that has been asked before, I have searched for the same problem, but I could not find any other message on it. Thank you very much and best wishes, Juan Carlos ", "Hi Juan, This is simply because you have a semi-colon after \u201cpart3;\u201d, which means the end of charpartition. It should be replaced with a comma. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Thank you! Very obvious now that I say it. Sorry! Best wishes, Juan Carlos ", "Hi Juan, No worries, it\u2019s the purpose of this forum. And I admit that, there should be a syntax warning or error here\u2026 Minh "]}, "FUmvQHSBJOE": {"topic": "Substitution Rates per Site per Unit of Time.", "initializeDate": "Mar 28, 2018, 10:54:28 AM", "timeStamp": "Apr 2, 2018, 11:33:29 PM", "content": ["Hello, I was wondering if it is possible in IQ Tree to estimate substitution rates per site per unit of time (given partitions and associated models of evolution ) over a user-provided constrained dated phylogeny? I know that IQ Tree can estimate substitution rates (with model partitions) on a constrained tree but I wanted to know if it is possible to have the constrained tree have nodes in units of time (usually millions of years on dated phylogeny) so that substitution rates are now rates for each site over time (millions of years)? Thanks. Frank ", "Dear Frank, I\u2019m not sure if I understand you correctly. But firstly, the constraint tree only enforces the tree topology and its branch lengths are ignored. Secondly, do you mean that, you want to have branch lengths of the resulting ML tree expressed as the number of substitution per site per million year? This is only possible if you know the substitution rate per million year, called \\mu, (which can\u2019t be inferred just from the sequences). Then you can simply multiply the branch lengths with \\mu to have the wanted quantity. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "hjsBusT_xng": {"topic": "BUG\uff1aIQ-TREE CRASHES WITH SIGNAL ABORTED", "initializeDate": "Jan 6, 2021, 11:19:17 PM", "timeStamp": "Jan 18, 2021, 9:01:30 AM", "content": ["IQ-TREE multicore version 2.0.7 for Linux 64-bit. Command: iqtree -s FcC_supermatrix.fas -m LG+C60+FO+R -ft guide.tree -n 0 -T AUTO Seed: 666986 (Using SPRNG - Scalable Parallel Random Number Generator) ===> COMPUTING SITE FREQUENCY MODEL BASED ON TREE FILE guide.tree Model LG+C60+FO+R is alias for LG+POISSON+G+FMIX{C60pi1:1:0.0169698865,C60pi2:1:0.0211683374,C60pi3:1:0.0276589079,C60pi4:1:0.0065675964,C60pi5:1:0.0141221416,C60pi6:1:0.0068774834,C60pi7:1:0.0146909701,C60pi8:1:0.0067225777,C60pi9:1:0.0018396660,C60pi10:1:0.0102547197,C60pi11:1:0.0230896163,C60pi12:1:0.0057941033,C60pi13:1:0.0125394534,C60pi14:1:0.0204526478,C60pi15:1:0.0070629602,C60pi16:1:0.0117982741,C60pi17:1:0.0068334668,C60pi18:1:0.0433775839,C60pi19:1:0.0318278731,C60pi20:1:0.0222546108,C60pi21:1:0.0102264969,C60pi22:1:0.0150545891,C60pi23:1:0.0134159878,C60pi24:1:0.0148552065,C60pi25:1:0.0239111516,C60pi26:1:0.0128776278,C60pi27:1:0.0222318842,C60pi28:1:0.0247444742,C60pi29:1:0.0214274810,C60pi30:1:0.0115001882,C60pi31:1:0.0076017389,C60pi32:1:0.0130258568,C60pi33:1:0.0093701965,C60pi34:1:0.0467194264,C60pi35:1:0.0441940314,C60pi36:1:0.0322263154,C60pi37:1:0.0402999891,C60pi38:1:0.0150234227,C60pi39:1:0.0104589903,C60pi40:1:0.0214742395,C60pi41:1:0.0154957836,C60pi42:1:0.0101789953,C60pi43:1:0.0227980379,C60pi44:1:0.0123204539,C60pi45:1:0.0066777583,C60pi46:1:0.0004150083,C60pi47:1:0.0344385130,C60pi48:1:0.0113663379,C60pi49:1:0.0127143049,C60pi50:1:0.0124323741,C60pi51:1:0.0262124415,C60pi52:1:0.0064994957,C60pi53:1:0.0103203293,C60pi54:1:0.0142463512,C60pi55:1:0.0215600067,C60pi56:1:0.0199150700,C60pi57:1:0.0038964200,C60pi58:1:0.0113448855,C60pi59:1:0.0128595846,C60pi60:1:0.0117656776}+FO+R WARNING: Both Gamma and FreeRate models were specified, continue with FreeRate model NOTE: 419084 MB RAM is required! Measuring multi-threading efficiency up to 56 CPU cores ERROR: phylotreepars.cpp:63: void PhyloTree::computePartialParsimonyFast(PhyloNeighbor *, PhyloNode *): Assertion `!aln->ordered_pattern.empty()' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: FcC_supermatrix.fas.log ERROR: *** Alignment files (if possible) ", "Hi there, Thanks for the report. Can you please check, if it works in v1.6.12? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b0d65cb5-b89a-4941-8892-624a680a89f2n%40googlegroups.com "]}, "Bpd7V7yafgc": {"topic": "Tree taxa and alignment sequence do not match", "initializeDate": "Sep 5, 2018, 10:47:28 AM", "timeStamp": "Sep 6, 2018, 11:08:03 PM", "content": ["I'm trying to build a tree of 944 sequences (a single gene, 18S) using a constraint tree with 49 taxa. I have confirmed programmatically the following: 1) All the sequences are the same length 2) All the taxa in the tree are present in the fasta alignment (with the same name) I get the following error (a few seconds after launching the command): ERROR: Alignment sequence Ellisella_sp does not appear in the tree ERROR: Tree taxa and alignment sequence do not match (see above) This is a subset of taxa from a set that I successfully ran with the same parameters except there was no constraint tree. I am also currently running a non-constrained tree on this matrix on 160 processors, it has run for over an hour so it appears to be working correctly. I have temporarily posted the alignment and constraint tree here: http://ryanlab.whitney.ufl.edu/tmp/iqtree_error.tar.gz I ran the following command: iqtree -nt 170 -s 18s_noacc_nolt63_nodups_rmlongbranches.fa -g transcriptomic_constraint.v4.tre -m TN+G4 > iq.out 2> iq.err I'm using \"IQ-TREE multicore version 1.6.1 for Linux 64-bit built Dec 26 2017\" Any help would be greatly appreciated. Thanks! Joe ", "Hi Joe, There is an error in your constraint tree as reported in Figtree while loading: Moreover, please do not use that many cores (-nt 170) for this short alignment (<2000 sites!), which will substantially slow down IQ-TREE. You can use -nt AUTO to determine best number of cores, which I think between 2 and 4. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "oKp45KB9RtU": {"topic": "log-lh computation and branch length optimisation in tree topology tests", "initializeDate": "Apr 16, 2020, 5:28:15 AM", "timeStamp": "Apr 16, 2020, 4:18:10 PM", "content": ["Hi Minh, I have a question about the AU test or actually topology tree tests in IQ-TREE in general. When user trees are supplied with branch lengths, does IQ-TREE use these branch lengths as initial ones and then also optimises them or do you ignore branch lengths and estimate them from scratch? The dataset I use is super small with only 10 species. I input a set of alternative tree topologies + ML tree. Alternative topologies did not have any branch lengths, while the ML tree was with branch lengths. For some genes it happened that the ML tree was identical to one of the alternative trees. For a subset of such genes, based on the AU test (I did not check the outcome of other tests) ML tree was not rejected, while an identical tree from a set of alternative trees was rejected. I checked the log-lh scores of the ML tree and the identical topology from a list of alternative trees for genes, when an alternative tree identical to ML was rejected (-) and when it survived the test (+). For (+) the differences between log-lh scores for ML tree and identical tree from the set varied from 0 to 17 llh units. For (-) from 0.00048 to 64 llh units. The only difference between the identical trees was presence/absence of branch lengths. For such a small dataset with 10 species, I would expect that the differences would be super small and in the majority of cases they are small, but still there are some with up to 64 llh unit difference, it is large, isn't it? Maybe the optimisation of branch lengths is not thorough, when computing the score during the test? If the topologies are the same, I would expect the same behaviour of the test, but these small differences in log-lh appear to be important for the rejection by the test. Many thanks in advance! Olga ", "Hi Olga, On 16 Apr 2020, at 7:28 pm, Olga Chernomor < o.che...@gmail.com > wrote: Hi Minh, I have a question about the AU test or actually topology tree tests in IQ-TREE in general. When user trees are supplied with branch lengths, does IQ-TREE use these branch lengths as initial ones and then also optimises them or do you ignore branch lengths and estimate them from scratch? The former is true, i.e. IQ-TREE will use the current branch lengths and continue to optimize them further. In case the input tree has no branch lengths, then IQ-TREE will first approximate them with maximum parsimony and then further optimize by ML. The dataset I use is super small with only 10 species. I input a set of alternative tree topologies + ML tree. Alternative topologies did not have any branch lengths, while the ML tree was with branch lengths. I see. For some genes it happened that the ML tree was identical to one of the alternative trees. For a subset of such genes, based on the AU test (I did not check the outcome of other tests) ML tree was not rejected, while an identical tree from a set of alternative trees was rejected. That\u2019s strange, but I believe IQ-TREE will warn users about identical trees in the set and try to ignore these trees in the test. To be sure pls send me the log file. But why did you include identical trees in the first place? I checked the log-lh scores of the ML tree and the identical topology from a list of alternative trees for genes, when an alternative tree identical to ML was rejected (-) and when it survived the test (+). For (+) the differences between log-lh scores for ML tree and identical tree from the set varied from 0 to 17 llh units. For (-) from 0.00048 to 64 llh units. That I don\u2019t understand. I thought you have one T_ML tree and one tree T\u2019 = T_ML in the set. Then there is only one difference L(T\u2019)-L(T_ML), which is supposed to be close to zero. Why do you have SEVERAL differences? The only difference between the identical trees was presence/absence of branch lengths. For such a small dataset with 10 species, I would expect that the differences would be super small and in the majority of cases they are small, but still there are some with up to 64 llh unit difference, it is large, isn't it? Maybe the optimisation of branch lengths is not thorough, when computing the score during the test? Ah now I understand, you repeated this analysis many times. The purpose is to stress test IQ-TREE, right ;-) Yes that expectation is true, i.e. even for user trees without branch lengths, the MP starting branch lengths should be quite good enough, and the ML optimisation of branch lengths rarely got trapped in local optima. Let\u2019s have a zoom chat next week, so that we look at the issue together and hopefully solve it quickly. Minh If the topologies are the same, I would expect the same behaviour of the test, but these small differences in log-lh appear to be important for the rejection by the test. Many thanks in advance! Olga You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6f3f7145-7802-4b9f-94fd-0cbb560800a2%40googlegroups.com "]}, "QPJzdhuY92c": {"topic": "Protein Mixture CAT Models - is it possible to see (e.g.) the C10 profile (10x20 matrix)?", "initializeDate": "Aug 3, 2018, 5:14:52 PM", "timeStamp": "Aug 6, 2018, 7:09:55 AM", "content": ["Hello - thanks for developing such a great piece of phylogenetic software. I'm keen to see the details of fitted mixture models, particularly for the protein CAT models. There would be a 10profiles x 20aa matrix for C10, and a 20profiles x 20aa matrix for C20, and so on. I can the \"weights\" for each profile in the .log file, and I can see write options (e.g. -wspmr, -wslmr) to write out values for various classes per *site*. Is it possible to write out the mixture profiles? (apologies if I have missed something very obvious) Thanks again, Frank Wright BioSS, Scotland ", "Dear Frank, Thanks for your interests. For the amino-acid profiles have a look at the source code: https://github.com/Cibiv/IQ-TREE/blob/master/model/modelmixture.cpp It contains all definitions for protein mixture models. Search for \u201cC10pi1\u201d, \u2026, \u201cC10pi10\u201d which define the profiles of C10 model. Same for C20,\u2026,C60. You can also look up the original paper https://doi.org/10.1093/bioinformatics/btn445 Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Many thanks for the helpful link to the C10-C60 amino acid profiles. Apologies for not reading the original paper (Le Si Quang et al, 2008) properly before asking you. I had assumed (wrongly) that the profiles were estimated from the data. Thanks again, Frank "]}, "fhC2ixjpbDQ": {"topic": "IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT? - version 1.6.6", "initializeDate": "Apr 22, 2020, 6:05:39 AM", "timeStamp": "Apr 27, 2020, 11:14:48 PM", "content": ["Hello, I was wondering if anyone could help me. I am running a partition model using the following code. iqtree -s paths_cut-gb.seq -sp partition_list.txt -m TESTMERGE -bb 5000 -nt AUTO -alrt 1000 -redo However I keep getting the following error (end of log file) ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 ERROR: 3 pllPartitionsValidate() ERROR: 4 IQTree::initializePLL(Params&) ERROR: 5 startTreeReconstruction(Params&, IQTree*&, ModelCheckpoint&) ERROR: 6 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 7 main() ERROR: 8 __libc_start_main() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: partition_list.txt.log ERROR: *** Alignment files (if possible) Begining of log file: IQ-TREE multicore version 1.6.6 for Linux 64-bit built Feb 19 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: login1.pri.viking.alces.network (AVX512, FMA3, 187 GB RAM) Command: iqtree -s paths_cut-gb.seq -sp partition_list.txt -m TESTMERGE -bb 5000 -nt AUTO -alrt 1000 -redo Seed: 776800 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Apr 22 10:33:40 2020 Kernel: AVX+FMA - auto-detect threads (40 CPU cores detected) Reading partition model file partition_list.txt ... Reading alignment file paths_cut-gb.seq ... Fasta format detected Alignment most likely contains DNA/RNA sequences I have run this before with different sequences and not had any problems, I have checked the alignment and partition files and can't seem to find any problems. I have attached both these and the log file below. Thank you! ", "Hi Sarah, There is something wrong in the PLL library used internally in IQ-TREE to compute a parsimony tree. Therefore, please add option -t PARS to switch to IQ-TREE own kernel for this. This PLL version 1 is not maintained anymore, so I can\u2019t notify the developers. Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/62157e5f-46d5-4c39-b4ac-3bb859f17b9e%40googlegroups.com <partition_list.txt> <partition_list.txt.log> <paths_cut-gb.seq> "]}, "MiP1J4gKJpM": {"topic": "degrees of freedom and testing mixture model fit", "initializeDate": "Mar 7, 2018, 11:11:11 AM", "timeStamp": "Mar 8, 2018, 10:21:58 AM", "content": ["Hi Minh and others, Unless I am mistaken, for model comparison of mixture models, some models that are more complex have the same number of degrees of freedom to simpler models, e.g. such that LG+C60 and LG+C20 have an equal number of degrees of freedom, while both have fewer degrees of freedom than say LG+C20+F (If one does not use the -mwopt). Allowing that one wishes to use the precomputed mixture weights for phylogenetic analysis (i.e. not using -mwopt, which might be appropriate for a 'short' alignment with a complex evolutionary process), if model finder returns LG+C50, for example, as the best model from the set LG+C10 - LG+C60, can we be sure that this in fact is better fitting than the models LG+C10 - LG+C40? Perhaps I'm overlooking something obvious! Thank you, Anthony ", "Hi Anthony, On 8 Mar 2018, at 3:11 am, Anthony Redmond < anthon...@gmail.com > wrote: Hi Minh and others, Unless I am mistaken, for model comparison of mixture models, some models that are more complex have the same number of degrees of freedom to simpler models, e.g. such that LG+C60 and LG+C20 have an equal number of degrees of freedom, while both have fewer degrees of freedom than say LG+C20+F (If one does not use the -mwopt). Yes that\u2019s right. Thus to re-iterate, C20 or C60 have pre-defined mixture weights, which are not regarded as free parameters. LG+C20 or LG+C60 will apply its own pre-defined mixture weight vector, and that\u2019s why they have the same degree of freedom. If you use -mwopt (for ixture eight opt imisation), then the weights are free parameters being estimated from the current data and thus LG+C20 has higher degree of freedom. Note that LG+C20+F automatically turns on -mwopt, because the weight for +F component (as the 21st class in the mixture) is not known. Allowing that one wishes to use the precomputed mixture weights for phylogenetic analysis (i.e. not using -mwopt, which might be appropriate for a 'short' alignment with a complex evolutionary process), if model finder returns LG+C50, for example, as the best model from the set LG+C10 - LG+C60, can we be sure that this in fact is better fitting than the models LG+C10 - LG+C40? I would say Yes. In this case as these models have the same degree of freedom, the one with highest likelihood will be selected. Perhaps I'm overlooking something obvious! No you didn\u2019t overlook anything, Cheers Minh Thank you, Anthony You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thanks Minh, That was helpful. I guess my concern was that in a case where say LG+C60 gives a very slight improvement of fit over LG+C10, or even LG, there is a lot of hidden complexity in the real difference between the models themselves when the mixture weights are not free parameters. But I suppose this is really more of a philosophical factor. Thanks again, Anthony "]}, "HlZiXZnYdJo": {"topic": "error for constructing the concatenated tree", "initializeDate": "Sep 15, 2020, 7:59:22 AM", "timeStamp": "Sep 30, 2020, 4:40:11 AM", "content": ["Hi, I want to run the iq-tree2 for my data set (33097 windows with 10kb size) to construct the concatenated tree, by using this command: iqtree -s $input -o $outgroup -m GTR+I+G -B 1000 but I receive this error message in the log file: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: /work/alaeikak/fasta/10000bp.90perc.1R.36I.log ERROR: *** Alignment files (if possible) would you please help me debug The best Niloo ", "Hi Niloo, Can you send thee full log file? This error crash message alone does not help to figure out why. Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/87fbca28-5f9f-4eb1-8490-a6e524bc4113n%40googlegroups.com ", "Dear Minh I attached the log file, please find it Thanks Niloo ", "Hi Niloo, This is the relevant error message from the log file: terminate called after throwing an instance of 'std::bad_alloc' It means that the server ran out of memory. I did notice that it has a lot of RAM: Host: node009.eve.ufz.de (AVX2, FMA3, 377 GB RAM) But can you make sure that your job has no restriction on RAM usage? Because this is huge data set, with >33K alignments in the directory. So make sure that you have full control of the server, and that nobody else is running on that server. Cheers Minh <IQ-TREE-7048715.zip> ", "Hi dear Minh Thanks a lot for your help, The best Niloo "]}, "gW26j8hQ2Ns": {"topic": "specifying codon model", "initializeDate": "Dec 27, 2017, 5:29:03 PM", "timeStamp": "Dec 28, 2017, 4:59:48 PM", "content": ["I am attempting to use the codon model option for model selection on my chloroplast gene dataset: \" -s geneonly.nex -st CODON1 -m TESTONLYNEW\", but Model Finder is testing DNA models, not codon models: \" ModelFinder will test 286 DNA models.\" I have tried specifying -st CODON both online and in the command-line interface. IQ-tree doesn't seem to recognize the CODON model specification, because it continues to test DNA models instead of CODON models. Anyone have a similar issue, or can you shed light on my confusion? Thanks! ", "Hi, I assume that you have a NEXUS input file: in that case, unfortunately, the -st option has no effect. IQ-TREE just took the sequences as DNA as specified in the NEXUS file. As a work around, you can convert this file in to Fasta or Phylip format and then run IQ-TREE again. Then -st will be taken into account. Cheers, Minh On Dec 27, 2017, at 11:29 PM, Therese Balkenbush < theres...@gmail.com > wrote: I am attempting to use the codon model option for model selection on my chloroplast gene dataset: \" -s geneonly.nex -st CODON1 -m TESTONLYNEW\", but Model Finder is testing DNA models, not codon models: \" ModelFinder will test 286 DNA models.\" I have tried specifying -st CODON both online and in the command-line interface. IQ-tree doesn't seem to recognize the CODON model specification, because it continues to test DNA models instead of CODON models. Anyone have a similar issue, or can you shed light on my confusion? Thanks! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Great, thank you very much! "]}, "s76HfEeWrYY": {"topic": "LSD setting when rates are autocorrelated", "initializeDate": "Nov 23, 2020, 3:39:01 PM", "timeStamp": "Dec 4, 2020, 12:17:06 PM", "content": ["Hi, is there a LSD parameter we need to set in different ways when we suspect rates might be autocorrelated on the phylogenies? For example, I ran CorrTest ( https://academic.oup.com/mbe/article/36/4/811/5299489 ) to determine if rates might be autocorrelated in my trees. How can I tweak LSD to account for this observation. thanks for all the excellent work! ", "Hi Hien, Can you help answer this question? Minh On 24 Nov 2020, at 7:39 am, Arshan Nasir < arshan...@gmail.com > wrote: Hi, is there a LSD parameter we need to set in different ways when we suspect rates might be autocorrelated on the phylogenies? For example, I ran CorrTest ( https://academic.oup.com/mbe/article/36/4/811/5299489 ) to determine if rates might be autocorrelated in my trees. How can I tweak LSD to account for this observation. thanks for all the excellent work! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/71015687-2e8d-42b1-b2dd-dd524cdfaf01n%40googlegroups.com ", "Hi Arshan, No we don't have this option in LSD. The only close option we have is when you know a prior which part of the tree is evolving at a different rate from the other parts; then you can specify the tree partition using option -p so that the program will estimate a separate rate for each part. Regards, Hien ", "OK thank you. Would it be possible to get a branch-specific rate? I imagine it can be calculated by dividing the branch length of the likelihood tree against the branch length of the time tree. However, I noticed null branches in the time tree (and hence division would lead to an error). The -j option outputs some data for each branch but it is not obvious how one can calculate the rate for each branch from the -j output...Any comments will be helpful! thanks "]}, "te-CbizSodg": {"topic": "IQ-tree segmentation fault", "initializeDate": "Feb 17, 2017, 6:39:20 AM", "timeStamp": "Feb 18, 2017, 1:35:54 AM", "content": ["I am building trees for collections of M. tuberculosis samples as part of a Public Health initiative. For a small number of trees, iqTree (including the latest version, 1.5.3, run on Windows 64 bit with multi-processing) crashes. This occurs in safe mode, and with the --safe flag. The command invoking this is : >D:\\forest_software\\FOREST\\binaries\\iqtree\\bin\\iqtree-omp.exe -nt 8 -st DNA -s D:\\forest\\forestroot\\render\\c2056130fd5bc3e9979ec10da8055ca4\\trees\\iqTree\\alignment_samples_with_outgroup.fa -m GTR+I -blmin 0.00000001 -fconst 702909,1334756,1329443,703466 -pre iqTree \u2013safe The fasta file alignment_sample_with_outgroup.fa is attached. No .log file is generated. Any suggestions as to how to address/further debug this are gratefully received. This is what happens: D:\\forest_software\\FOREST\\src>D:\\forest_software\\FOREST\\binaries\\iqtree\\bin\\iqtr ee-omp.exe -nt 8 -st DNA -s D:\\forest\\forestroot\\render\\c2056130fd5bc3e9979ec10d a8055ca4\\trees\\iqTree\\alignment_samples_with_outgroup.fa -m GTR+I -blmin 0.00000 001 -fconst 702909,1334756,1329443,703466 -pre iqTree \u2013safe IQ-TREE multicore version 1.5.3 for Windows 64-bit built Jan 15 2017 Copyright (c) 2011-2016 Nguyen Lam Tung, Olga Chernomor, Arndt von Haeseler and Bui Quang Minh. \u2026.. 539 4d9a1a03-68a6-42fe-b567-b4d6baf94018 0.36% passed 99.60% 540 b0ae848f-1744-4aa7-b6d6-b8b6f370f7fd 1.80% passed 99.72% 541 b5820999-ad2c-4108-a118-2af5f1c8eb65 1.38% passed 99.83% 542 5815a479-bb74-42d1-96b6-bb0534877b86 1.25% passed 99.69% 543 a8a7b263-323a-48b1-8a38-c9176a2d5ed5 1.06% passed 99.92% 544 8fc4ee54-5ecc-49a2-bb46-7870c9df4e93 1.19% passed 99.96% 545 55c3df3c-6c10-4134-9278-ac3682955bb1 0.36% passed 98.68% 546 1f2ae089-fa96-404b-87f6-b3b072b2f11e 1.15% passed 95.57% 547 6e7949f2-9830-408a-b616-43ee981502bd 0.42% passed 98.30% 548 7a305d42-5a54-4f6e-87e7-6df103d9df3f 1.25% passed 99.97% 549 eb8d97f2-84ab-42cf-ab77-9d9ad203d1ca 1.15% passed 99.91% 550 0290f28d-8911-47cd-83fb-e00557191fca 0.42% passed 98.98% 551 28ac3644-694a-4976-b2cb-f41afde139cf 1.68% passed 98.46% 552 8b1ee73b-a8cd-44d9-879d-92f3492fd98e 0.36% passed 99.42% 553 d952e369-a69d-4c08-b91a-d84a47859d15 0.36% passed 99.15% 554 3692adbb-5161-484d-bc59-806a27f4c2ed 1.85% passed 97.48% 555 94822ef6-1a55-4cf2-a380-f04ab29f07b8 0.43% passed 99.94% 556 d0dbe2c4-e6df-474e-a95a-e7bc42b649dc 0.40% passed 99.43% 557 f19ad481-09e3-467f-9f3d-77f55b235f36 0.53% passed 98.54% 558 74a90279-0d46-48d9-89b1-65f300cff7a2 2.67% passed 99.62% 559 34ffae71-0f63-40d4-aebe-75259c5e100e 1.15% passed 99.72% 560 c8d334a0-3772-43a8-b3dd-38b3209b22d7 1.61% passed 99.61% 561 b97d6791-f9d2-48bd-84d2-1d539573685d 0.96% passed 99.40% 562 4239a0d0-3513-4c14-af98-1bee7fc5cf02 0.89% passed 99.53% 563 c6188587-904e-4ba4-9863-988a54b3c599 1.17% passed 99.79% 564 fd06a27a-7f37-4ce9-9d99-26c6903d7ae8 0.64% passed 99.21% 565 82e90ef8-1bbf-4a3a-8643-24c33f532507 0.40% passed 99.86% 566 d132cbea-f32c-4f5d-b863-ea84b5c9bfae 0.36% passed 98.79% 567 45b77f69-3548-4387-a5b3-f22e4c491476 1.25% passed 99.99% 568 8cb5e225-4038-46e5-9f3f-6d1c2194da62 0.36% passed 99.51% 569 ccd3f332-dcb4-46f4-a288-9bce0062f33f 1.10% passed 99.87% 570 9ab717ae-42c8-471c-8f94-90246d103cc8 0.53% passed 97.63% 571 07181ce2-ad86-4259-99b6-753c7914abef 0.47% passed 99.61% 572 86748ee6-a096-4818-a2ea-03ab404ef881 1.13% passed 99.97% 573 0283f1c1-be6d-413f-b5aa-9cc5eb30d0d6 0.87% passed 99.85% 574 454d0ad2-9573-471a-926d-bbaccd205c3d 0.40% passed 98.76% 575 4560cf45-453b-49d5-b660-c6b000f5fdee 0.36% passed 99.78% 576 60666cdf-6dff-4744-8de3-738d38c09b0e 1.32% passed 99.52% 577 55f63186-cbc7-4818-ac05-54a523cc2c38 0.38% passed 99.68% 578 9c3bf6b6-fbb2-4f8c-a00b-0b3a41c2b50d 2.34% passed 97.56% 579 3c967e03-b2dd-40da-8f0b-cb6af441ba93 1.44% passed 99.90% 580 2ccd3c7a-5200-41aa-90db-bcedb1c0bac1 2.61% passed 98.80% 581 1bebd309-e55d-48ed-9f6f-f56b4b739f64 0.38% passed 98.75% 582 0cf3f05d-e142-4eb4-8529-ca1a8a4b6dbd 0.43% passed 97.84% 583 c69210ce-71e6-4302-bbbc-4274d8396c3e 1.36% passed 99.79% 584 0fe93794-ce76-4b7a-b177-2b045ec129b7 1.49% passed 98.87% 585 d05fcc3d-eb83-47eb-999e-eab25f093b42 2.29% passed 99.72% 586 1e0883a8-119d-4ad4-bb7e-ffe5caba793a 1.30% passed 99.39% 587 6355e91c-ca13-49d7-82be-05227cdc7495 1.06% passed 99.27% 588 a2515144-58ef-4649-a223-9950d7ea9dc0 0.43% passed 98.78% 589 5901623c-fc74-4d62-949e-fb79d1bb9f7d 0.70% passed 99.82% 590 ec6fa4f4-43f3-44e5-b3cb-fa66fa3a2686 0.43% passed 98.80% 591 ce3c1382-95a0-489a-84cc-7682814e8d32 0.38% passed 97.68% 592 d33e1933-2e24-4535-9734-78025b7f33f9 0.57% passed 99.98% 593 a46c9a33-8c4b-4153-a8f5-3c60e6022e10 0.38% passed 99.76% 594 1ab8b8d5-c4bd-4fc2-bdfb-f925470dac2d 1.34% passed 99.09% 595 23b87c58-3427-4314-aba8-e32280363d9b 1.29% passed 99.60% 596 6fbb5268-771c-4d39-97e9-75f2ec6726bd 1.42% passed 99.97% 597 a9316562-e2f2-44dd-b4ea-880626f6985c 1.55% passed 99.66% 598 de7a3ff2-2551-49b8-9478-84d2cd69761d 0.76% passed 99.55% 599 307bec33-713c-49f9-ad95-65a46f54f9b4 0.74% passed 99.98% 600 04985390-2c99-4844-bd5b-a4439840e410 0.79% passed 99.56% 601 e8fbf13a-58e6-4f03-8cd3-97982cfbd77a 1.82% passed 98.71% 602 a00fe34e-e66b-4396-8dd7-438c22330721 0.87% passed 98.40% 603 d96f6d14-5710-4df4-b1e1-156603c2bce2 0.36% passed 99.24% 604 82e3d499-6c82-45d1-8b64-19cc04c54c8c 1.25% passed 99.99% 605 96417a48-103a-439a-84c4-4f9d1f54268a 0.57% passed 99.50% 606 8d551e0a-69df-4188-af8d-646cc701bb3a 0.40% passed 99.10% 607 4df88896-24c3-4e02-b30f-bbc43310dd06 1.47% passed 99.14% 608 c2faa9f0-d7b7-4e0e-aff7-deebc2b7a3cc 0.32% passed 99.18% 609 92a7225f-b43a-4f7c-a12d-1f301026ced2 1.36% passed 99.15% 610 d5f3927f-9dac-4067-b939-70c9b8e97068 0.42% passed 99.85% 611 8b7a50be-4088-4ce4-a5b0-3fb992a02b06 1.21% passed 99.53% 612 992e6601-7dd2-429a-8038-beaadfa3467f 1.08% passed 98.34% 613 523c5327-132d-47fe-a986-de7830e71dd4 0.43% passed 99.05% 614 1420ffa7-e8b6-49f0-bb64-c667ddae15d7 7.64% passed 17.04% 615 781b76ca-0736-481a-870e-17df7588bf31 0.36% passed 99.44% 616 7722d6fd-5ef9-4525-be7d-3f239a12a489 1.06% passed 99.90% 617 6baec0d2-e7ff-41c7-8610-4d42c894f07a 1.27% passed 99.76% 618 a9a711a5-977d-4e5c-8d39-c1d9ef6d3b46 1.08% passed 99.90% 619 31d0b936-cdc6-4fe1-8bf2-9855a3feaa5b 0.36% passed 96.00% 620 31c0550b-1901-4d16-b1b7-38a7e89b94e4 0.45% passed 99.77% 621 d2683b08-5572-4c5a-8b90-db7922fa6c53 0.36% passed 99.63% 622 9df11a78-c1a9-4a3b-93a7-921bc47b1b32 0.40% passed 98.52% 623 8fb48f19-eb72-4e30-8285-174f4ecbc1a1 0.51% passed 99.66% 624 13f06a05-0cf1-42d8-bb52-b49c4fd3097b 0.40% passed 96.91% 625 4e927090-6e6b-4354-9c88-25bbf01c7bca 1.12% passed 99.93% 626 576e37d0-49f0-46d1-b7d3-6c8238709d94 0.66% passed 99.95% 627 9678bf61-061b-4bcf-ae6e-add53306d78d 0.51% passed 98.90% 628 7707b60e-c1c1-4a59-b7bd-61016904b3b7 0.78% passed 98.31% 629 3d097716-4b2a-4e09-9c63-4783685374d4 2.82% passed 92.44% 630 01ada54a-e908-4431-ae32-7704a732f325 1.32% passed 99.61% 631 7537b909-66ec-4345-b163-7b5466435363 2.67% passed 99.59% 632 702534b6-7989-405c-b170-8871f0df0eeb 0.45% passed 99.57% 633 7d6c1c99-fd4e-4ead-93b9-ebdf5a2fd424 1.59% passed 99.91% 634 e5d87891-96a9-4909-91b2-b52888b4e674 0.96% passed 98.87% 635 4328ab25-5d1c-4f19-ae96-d393e1d2b4e2 0.38% passed 99.45% 636 81d1009a-6ddf-467e-a1f2-c0bd6f94849f 0.76% passed 98.47% 637 55d6df39-57f6-4a5c-a541-df6140e210b0 1.29% passed 99.95% 638 56fcd5ac-cb97-419a-9d43-3f506cc1c23f 1.47% passed 99.77% 639 b56fe33e-4f1e-48b5-973b-41ae71fdb1de 1.25% passed 99.68% 640 9fec26b5-d3af-402e-be6e-8a5e891b823a 1.40% passed 99.46% 641 ae85766b-74a8-4c5e-b5ee-77c759b762bb 1.87% passed 99.94% 642 d3869065-83e1-4831-b10d-fef4217cc1fc 2.06% passed 99.21% 643 fd7faafa-3057-4d0a-9f24-bb583eecdc25 1.10% passed 98.73% 644 afe8c736-54eb-4e6c-9d93-65af7cce0f7c 1.02% passed 99.55% 645 31087a7e-a4db-4558-a81f-e450fb714cab 1.55% passed 99.61% 646 d91c72fc-0b1f-4b89-bcfc-2b8a2cb9e697 0.72% passed 99.88% 647 56aee825-12b2-43c4-9bf6-bddf7b9441ea 0.76% passed 97.85% 648 80f2449b-c5eb-41ff-a46e-320673164e30 1.25% passed 98.71% 649 911ff53c-27e1-4a1f-b678-1cb0695c28b2 1.38% passed 97.32% 650 5915adb1-6444-4527-ac0b-49bd50e43029 1.27% passed 99.96% 651 0d0d9372-e38c-4c9c-ad51-1178d49b6f2a 0.36% passed 99.44% 652 bda330bb-41b6-463a-89df-9ada83128143 0.40% passed 99.45% 653 d3700209-b66e-44eb-be51-25272e04379a 1.23% passed 99.97% 654 a6464129-0238-4e3a-873f-4f4ab09bd279 0.78% passed 99.89% 655 9cb2d77b-6b47-4551-81bb-678b15bb4277 0.36% passed 99.26% 656 ccdb73ba-adab-4865-9577-756af8244364 0.70% passed 99.64% 657 ab33e10d-0c9a-4672-a574-1860081199b5 0.45% passed 99.12% 658 476cc750-7a82-4269-82df-b3e723c65883 1.44% passed 98.58% 659 78001b79-c143-4aa5-a30c-c4713bedfcd0 1.76% passed 98.88% 660 60b0176c-960c-4eea-b2c2-e02ea61942fe 0.70% passed 98.50% 661 3ec525e3-f5b1-4a44-9ce8-7ed56e78a7b5 0.34% passed 99.06% 662 ac7d72ca-23c5-4f53-8023-fa03ab0d49dc 1.29% passed 95.67% 663 e4cfeb71-5618-4c97-8a15-dd4a4bdd7074 0.43% passed 99.13% 664 b2e32ddb-c748-4ffc-8f01-2911daf9d1ee 1.27% passed 99.77% 665 2561ba73-b7ca-4f60-b46b-21905758db40 0.38% passed 99.67% 666 c9148ec3-20f6-4622-90f5-f02269823379 1.17% passed 99.22% 667 fd97434b-d371-4fd9-aeb0-f235bcfb639b 0.98% passed 99.21% 668 db893fd1-4456-4941-bf22-c056bea95fbb 0.81% passed 99.56% 669 ed074ca3-5a7a-4543-8f76-2a0794be79a4 1.89% passed 98.63% 670 978a9e7d-41dd-4cf6-b1f1-ff8e459ebb5f 0.89% passed 99.23% 671 c03d824e-e0f2-47d1-b4ef-d279403ddda7 1.08% passed 99.36% 672 b85bbcc4-20b2-4540-be87-67653c6a5938 0.34% passed 99.63% 673 aa3e7ae7-ac3e-4a53-ab62-f108c9895b64 0.93% passed 99.70% 674 6b536357-42fd-4374-ac1c-f8f51628a58e 0.36% passed 99.38% 675 5534a228-1d76-4ce3-9a1c-ae75f534ee01 0.66% passed 99.42% 676 82ecc963-9fe2-4257-8f19-57aa2cd06251 1.44% passed 99.61% 677 7fb049ac-7a2c-48eb-8a59-d2851701004c 1.02% passed 99.86% 678 b4f1a53d-39ca-4721-97de-4758f481f111 0.45% passed 98.97% 679 875b3dc6-ffa7-45f0-80e0-db47247b68d5 1.97% passed 99.28% 680 49d1cc0e-f2cd-45ca-b701-ee5e7e9bfe3a 0.34% passed 99.42% 681 3c891b40-1387-4360-9fc6-c0f7138d47d6 1.34% passed 98.24% 682 50d18aee-269a-435e-8b6c-704dd7ee5cd6 7.73% passed 94.63% 683 d92b0c9f-bc3b-4725-b36a-d76013e55cdf 0.36% passed 99.79% 684 934c0def-8aad-41ec-83d1-1738e4857ae5 0.45% passed 98.38% 685 392c98c5-1e17-40d0-9c24-527d6dd6c7ea 1.42% passed 99.34% 686 3cffd319-b982-4a75-917f-15d1c65f4b8e 0.34% passed 98.56% 687 537d4eb3-1b06-46f6-befa-c8a0fcaea593 1.95% passed 99.84% 688 001e077c-18e1-41f9-9b9a-f12191ac2dc2 1.06% passed 99.21% 689 0131fbe5-d403-4be6-b85d-781034ab9f12 0.38% passed 99.76% 690 689d2297-ca9e-4c70-ae62-636f91708702 0.34% passed 99.09% 691 158eca09-fcb2-4266-8fd7-9be97f82765c 1.21% passed 99.93% 692 27fb6cdf-d11d-43b6-8271-72310889d6cd 1.25% passed 99.38% 693 432bc5c6-fc1f-4cfa-a334-f12796416cf1 0.36% passed 98.17% 694 feb019b4-01f7-4e23-9b5c-dcb5fd785f5f 1.27% passed 99.48% 695 5c032f34-46c3-4c22-8ac2-a8a22e4ac60a 0.70% passed 98.95% 696 852f6cfb-0a12-4f78-822a-99e14445c080 0.72% passed 98.49% 697 2559b85a-b01d-4b9d-870d-eac32bfb1b7f 0.49% passed 99.64% 698 ecdb9878-43d8-4be6-8133-cf52e90e3a36 1.17% passed 98.75% 699 dd7bc569-16fb-4a00-81e3-1692db5fd302 1.10% passed 99.89% 700 00f133c7-d424-4062-ae53-65c24d0015ba 0.38% passed 99.52% 701 5578949f-75d7-4b6b-9f4e-fc5632efc68e 0.70% passed 98.57% 702 f0c54727-ca00-413e-ae73-1e007e5a878b 1.21% passed 99.98% 703 3051a51c-ef9d-4c58-8709-783c7b25905c 0.89% passed 98.90% 704 cfb61c88-8081-4635-9352-2e34335feaa0 0.96% passed 98.94% 705 d15554c0-71df-4ba4-9300-1423403a91eb 0.47% passed 99.47% 706 32108e49-8b8d-4798-be65-d229748ac13f 0.40% passed 99.39% 707 4baaa3d3-9c34-41be-b9ba-7d0641f60f42 1.00% passed 99.97% 708 15b290b7-2d8e-4061-8744-c23dc97cfe22 0.42% passed 99.96% 709 7bed4c38-2e3c-43fc-a026-1145f23b3cf7 0.36% passed 99.43% 710 6d1e3a44-64aa-4c39-91fb-bcab3188d678 0.95% passed 99.71% 711 1fb35ab1-97ae-4ce8-a1e4-67cfd69ed341 0.47% passed 97.03% 712 37213528-3e72-490f-88f3-d117fa13e08a 1.00% passed 99.28% 713 1122778b-936f-4662-b7db-c186905a3a10 0.38% passed 99.71% 714 b4db3863-a7e8-4828-be46-e29e57185879 0.40% passed 98.23% 715 2ca42495-827b-44cb-b842-73e5eeb868e6 0.34% passed 99.75% 716 200f8432-4507-43e3-8a5d-1a0edbf1db33 0.43% passed 99.97% 717 b85ef0d0-bfe2-466e-a1e1-30a4a37afab3 0.53% passed 99.85% 718 1fc787f6-1913-4c95-9cc6-a65eb5dc0967 0.93% passed 98.36% 719 63f28df3-3b3a-43d7-ae86-b8a6eb95d06f 1.40% passed 99.87% 720 b0e83891-7521-4508-a29b-5c5e5fc1e503 0.34% passed 98.31% 721 ee97a9ee-300e-4164-8701-7735d90c7a6d 0.40% passed 98.66% 722 21ff9cd6-a374-43d2-a033-82de2fda54dd 1.17% passed 99.66% 723 52c573fb-9df9-485a-8e92-cfc6591ba830 0.81% passed 99.61% 724 b4953012-8bf9-444b-803c-9396f90f36f0 0.26% passed 99.50% 725 bf7bd131-878f-4450-81e5-a56a23939047 1.17% passed 99.74% 726 db5172ee-35e4-48c7-a377-5758f1495838 1.06% passed 99.49% 727 de3f4698-2463-4973-9a7b-14cbf317b54d 0.85% passed 99.96% 728 64883335-990b-42b2-98ad-2f8a85626a57 2.31% passed 99.59% 729 6990509c-e843-41f8-836d-25ca06d84828 0.38% passed 99.08% 730 6db31d74-2c4a-4295-af82-3198ee963362 2.02% passed 99.94% 731 2195d8c1-d204-480b-9331-f989db0ac79e 0.91% passed 99.58% 732 0cfd68e8-7b51-4e12-886e-6d347b209362 0.61% passed 99.60% 733 34bbde98-18da-4253-9a69-6e575e58db48 3.61% passed 98.48% 734 7465eb67-2f00-4507-8bb1-ee71f3eaf322 1.63% passed 99.80% 735 59df9d93-f02f-43e4-94a3-7895e3cf9871 1.36% passed 99.97% 736 eef3d946-7e0b-48fd-be12-56199c75857b 0.49% passed 99.71% 737 007ae7af-c57b-4e35-83bd-0f2c37e2cf6f 0.40% passed 98.00% 738 69c9a479-be2e-4221-8c52-ea5956d1a09f 1.93% passed 99.72% 739 ec078017-590f-4c18-a569-047da2a84426 0.36% passed 99.92% 740 d8265990-0f37-4147-8217-51f61d25f855 0.42% passed 99.92% 741 a352ffca-9478-425e-aa27-d432e08a8bdb 1.12% passed 99.95% 742 a1cefc2a-e832-4aec-b4ca-a336d7594a51 1.25% passed 99.59% 743 2d24503e-52cb-480f-b6b6-00f6559974b6 1.68% passed 99.51% 744 4edce1c4-6cc3-4cc6-8f7b-3a056c86c0cd 0.34% passed 99.15% 745 b8f0d7c0-b10e-4785-89de-d58f7c4f82cf 0.36% passed 99.63% 746 96069409-c0fb-473d-9547-eaf37b9e8e04 1.27% passed 99.96% 747 f6e9378e-a66a-46c5-a865-af07385d6f95 0.36% passed 99.24% 748 d4f86548-4486-4bb5-9112-c65410f85adf 0.42% passed 99.15% 749 6adb7937-3721-4dec-aa06-6005461e57be 1.57% passed 98.16% 750 2c1e89db-1694-4cc6-88f6-e573bb0e0f31 0.38% passed 99.95% 751 8abc363e-b0b0-40d1-810d-953f0c29e766 1.08% passed 99.75% 752 a6d4f22b-e271-4ea6-8d55-400ac3a2105d 0.74% passed 97.30% 753 28b8c34c-c4a1-48c1-9aa5-bcc54226687e 1.21% passed 99.97% 754 038f05ed-bd5f-4a6f-b64b-e864574b80d3 0.40% passed 96.53% 755 4eccecdd-691c-49c5-ba7b-903a1248b5c7 0.36% passed 99.47% 756 06b515d5-2bc8-42df-bf72-9bea61121506 1.47% passed 99.77% 757 614d3fb5-b5df-4939-a595-e43804486507 0.43% passed 99.28% 758 42e61699-770a-43a4-af70-690d2fe6acaa 0.64% passed 99.45% 759 be3e69f7-2190-4e38-b7b1-c6251897cc69 0.61% passed 97.91% 760 ad44c14d-05a8-4c7c-b3d9-fc2f28c54c16 0.43% passed 98.88% 761 1347ed4c-2e9a-4be6-99f3-40eb507b0804 0.59% failed 0.00% **** TOTAL 1.01% 1 sequences failed composit ion chi2 test (p-value<5%; df=3) INFO: 4070574 const sites added into alignment NOTE: 13 identical sequences (see below) will be ignored for subsequent analysis NOTE: 7fc5e29d-610c-45b3-aaf4-7ccff2787847 (identical to 40366216-9af8-4c24-ab02 -928f024ccd93) is ignored but added at the end NOTE: 5059149d-6a77-4d34-bf24-bf38b69ba6a1 (identical to 08e86f2d-a40b-483e-91ce -d2ce43b1bfe4) is ignored but added at the end NOTE: 4239a0d0-3513-4c14-af98-1bee7fc5cf02 (identical to 65b6b61c-68fe-4b31-b2ef -86020cf7d655) is ignored but added at the end NOTE: 404ad263-491d-4238-aa4e-fbe4e297300b (identical to 90600593-6cd8-43db-a05d -7583d363a73b) is ignored but added at the end NOTE: 8fc4ee54-5ecc-49a2-bb46-7870c9df4e93 (identical to e19acaa7-9c64-4997-ad94 -fefd5cdb8668) is ignored but added at the end NOTE: 07baaaf5-460a-437f-ba23-12b02d4530ad (identical to 196b81e3-c9e3-49bc-8172 -923bcc6fdea0) is ignored but added at the end NOTE: 45eb73dd-cc59-432c-9906-66f31890d486 (identical to 10747d8a-b904-42d4-b5bd -4b1177655e7b) is ignored but added at the end NOTE: 04b5d4e7-987a-424d-a61f-3398d615b415 (identical to b6890206-5961-4242-91c4 -5340f554a343) is ignored but added at the end NOTE: c03d824e-e0f2-47d1-b4ef-d279403ddda7 (identical to c0ea8666-8e05-42b3-a450 -15fb4ad91894) is ignored but added at the end NOTE: 82e3d499-6c82-45d1-8b64-19cc04c54c8c (identical to 19c55fe5-7b88-4e06-b368 -b43dea5b3ba0) is ignored but added at the end NOTE: 158eca09-fcb2-4266-8fd7-9be97f82765c (identical to acc9f260-6626-45db-bf22 -020d58e1eb96) is ignored but added at the end NOTE: 06b515d5-2bc8-42df-bf72-9bea61121506 (identical to 56fcd5ac-cb97-419a-9d43 -3f506cc1c23f) is ignored but added at the end NOTE: 96069409-c0fb-473d-9547-eaf37b9e8e04 (identical to 5915adb1-6444-4527-ac0b -49bd50e43029) is ignored but added at the end For your convenience alignment with unique sequences printed to iqTree.uniqueseq .phy *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT *** For bug report please send to developers: *** Log file: iqTree.log *** Alignment files (if possible) ", "Sorry, the relevant initial iqTree output showing architecture etc was missing, ans is below: Copyright (c) 2011-2016 Nguyen Lam Tung, Olga Chernomor, Arndt von Haeseler and Bui Quang Minh. Host: COLHPAMMMSQL02 (SSE4.2, 31 GB RAM) Command: D:\\forest_software\\FOREST\\binaries\\iqtree\\bin\\iqtree-omp.exe -nt 8 -st DNA -s D:\\forest\\forestroot\\render\\c2056130fd5bc3e9979ec10da8055ca4\\trees\\iqTree\\alignment_samples_with_outgroup.fa -m GTR+I -blmin 0.00000001 -fconst 702909,1334756,1329443,703466 -pre iqTree Seed: 514915 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Fri Feb 17 10:21:17 2017 Kernel: SSE3 - 8 threads (8 CPU cores detected) Reading alignment file D:\\forest\\forestroot\\render\\c2056130fd5bc3e9979ec10da8055ca4\\trees\\iqTree\\alignment_samples_with_outgroup.fa ... Fasta format detected Alignment most likely contains DNA/RNA sequences Alignment has 761 sequences with 5289 columns and 3208 patterns (1811 informative sites) ", "Dear David, Thanks for reporting this crash. I suspect there is some problem with initial parsimony tree reconstruction by PLL. Therefore, can you please add option \u201c-t PARS\u201d to switch to another method, and let me know whether it works or not? Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "eqnbizGOg7I": {"topic": "forcing monophyletic groups in IQTREE - revisited", "initializeDate": "Aug 27, 2020, 10:30:08 AM", "timeStamp": "Aug 31, 2020, 7:22:58 AM", "content": ["Hi folks, Here is the problem I am running into when using the argument \"-g\" to constraint the monophyly of a given group. My intention is to test the constrained vs. unconstrained resulting topologies after ML run using IQTREE. Consider that this is my unconstrained result in IQTREE: ,----- LRP9887 ( TERMINAL USED AS ROOT | ,-- LRP9893 | ,----- LRP9892 | | ,-- LRP3922 | | ,----- LRP3894 | ,--| ,--| ,-- LRP3902 | | | | `----- LRP3900 | | `--| ,-- LRP8507 | | `--| ,-- LRP8513 | | `--| ,-- LRP8511 | | `--| ,-- LRP8518 `--| `----- LRP8514 | ,-- LRP8516 | ,----- LRP8512 | | ,-- LRP8506 | | ,--| ,-- LRP8517 | | | `--| ,-- BU058 `--| | `--| ,-- BU060 | | `----- BU059 | | ,-- LRP8509 `--| ,--| ,-- PN15_02_01 | | `--| ,-- PN15_07_01 | | `--| ,-- PN15_01_06 | | `--| ,-- PN15_07_02 | | `----- PN15_05_03 `--| ,-- LRP8510 | ,--| ,-- MZUSP7756 | | `----- MZUSP7754 | | ,-- LRP8515 `--| ,--| ,-- LRP8508 | | `----- LRP4219 | | ,-- L002_Anthoc `--| ,--| ,-- L003_Anthoc | | `----- L001_Anthoc `--| ,-- L005_Anthoc `--| ,-- L014_Anthoc `--| ,-- L008_Anthoc `----- L007_Anthoc The mononophyly of the RED-group is undermined by the phylogenetic position of the BLUE-clade BU### If I was to do a constrained search in any phylogenetic software I would use the following constraint: LRP9887,LRP9893,LRP9892,LRP3922,LRP3894,LRP3902,LRP3900,LRP8507,LRP8513,LRP8511,LRP8518,LRP8514,LRP8516,LRP8512, BU058,BU060,BU059 LRP8506,LRP8517,LRP8509,PN15_02_01,PN15_07_01,PN15_01_06,PN15_07_02,PN15_05_03,LRP8510,MZUSP7756,MZUSP7754,LRP8515,LRP8508,LRP4219,L002_Anthoc,L003_Anthoc,L001_Anthoc,L005_Anthoc,L014_Anthoc,L008_Anthoc,L007_Anthoc )); However, IQTREE2 keeps returning the best ML tree with BU### terminals within the RED-group . I assume that this is because of the way how IQTREE interpreters the constraint, which is explained in section \" Constrained tree search \" of http://www.iqtree.org/doc/Advanced-Tutorial My question is, is there a way of forcing the monophyly of red any other way? My question is, what is the best ML tree in which RED-group is monophyletic? Thank you, Feranndo ", "Hi Fernando, You need to use this constraint: LRP9887,LRP9893,LRP9892,LRP3922,LRP3894,LRP3902,LRP3900,LRP8507,LRP8513,LRP8511,LRP8518,LRP8514,LRP8516,LRP8512),( BU058,BU060,BU059) LRP8506,LRP8517,LRP8509,PN15_02_01,PN15_07_01,PN15_01_06,PN15_07_02,PN15_05_03,LRP8510,MZUSP7756,MZUSP7754,LRP8515,LRP8508,LRP4219,L002_Anthoc,L003_Anthoc,L001_Anthoc,L005_Anthoc,L014_Anthoc,L008_Anthoc,L007_Anthoc )); That means, having three groups of the back, blue and red. Otherwise, the constraint tree is unrooted and defining your way does not enforce the red ones to be monophyletic (which requires a rooted tree). Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f9d202b2-4e04-444a-af86-e870c1ccb758n%40googlegroups.com "]}, "mnnTTmMiUfM": {"topic": "Error when using +ASC because of 0 invariant sites in the alignment?", "initializeDate": "Oct 5, 2020, 9:37:01 AM", "timeStamp": "Oct 10, 2020, 7:20:25 PM", "content": ["Dear all, According to the last FAQ stated here: http://www.iqtree.org/doc/Frequently-Asked-Questions . I've filtered my variants to make sure that none of constant site, gap and ambiguous base contained in a file. I finally used the following command: iqtree -s /home/jumpp/project/sugarcane/phylo/sugarcane.L2.phy -st DNA -nt 30 -v -mem 70G -m GTR+ASC -bb 10000 PS. I'm quite new in phylogenetic analysis. So I don't know what kind of model that might suit my data. I just read IQTREE manual and found that GTR+ASC is recommended for SNPs data Here's an error I got: Command: iqtree -s /home/jumpp/project/sugarcane/phylo/sugarcane.L2.phy -st DNA -nt 30 -v -mem 70G -m GTR+ASC -bb 10000 Seed: 362115 (Using SPRNG - Scalable Parallel Random Number Generator) 64 bit Linear Congruential Generator with Prime Addend seed = 362115, stream_number = 0 parameter = 0 Time: Mon Oct 5 20:26:45 2020 Kernel: AVX+FMA - 30 threads (32 CPU cores detected) Reading alignment file /home/jumpp/project/sugarcane/phylo/sugarcane.L2.phy ... Phylip format detected Alignment most likely contains DNA/RNA sequences Alignment has 16 sequences with 21909 columns, 643 distinct patterns 773 parsimony-informative, 21135 singleton sites, 0 constant sites Empirical state frequencies: 0.1480327719 0.3563689580 0.3509060204 0.1446922498 Gap/Ambiguity Composition p-value 1 114684_SiS 0.00% passed 21.33% 2 114685_K88 0.00% passed 32.54% 3 114686_KK0 0.00% failed 0.62% 4 114687_UT1 0.00% passed 55.79% 5 114688_KK0 0.00% passed 90.44% 6 114689_UT1 0.00% passed 38.44% 7 114690_LK. 0.00% passed 9.36% 8 114691_KK0 0.00% failed 2.21% 9 114692_KK0 0.00% passed 99.49% 10 114694_KK0 0.00% failed 4.52% 11 114698_KK0 0.00% failed 1.69% 12 114700_NSU 0.00% failed 0.08% 13 114702_KK0 0.00% passed 97.86% 14 114704_KK3 0.00% failed 0.89% 15 114705_TRJ 0.00% failed 0.21% 16 114706_KK0 0.00% failed 0.71% **** TOTAL 0.00% 8 sequences failed composition chi2 test (p-value<5%; df=3) Empirical state frequencies: 0.1480327719 0.3563689580 0.3509060204 0.1446922498 Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.0158557687 seconds 64 bit Linear Congruential Generator with Prime Addend seed = 362115, stream_number = 0 parameter = 0 Generating 10000 samples for ultrafast bootstrap (seed: 362115)... Empirical state frequencies: 0.1480327719 0.3563689580 0.3509060204 0.1446922498 Alignment was printed to /home/jumpp/project/sugarcane/phylo/sugarcane.L2.phy.varsites.phy ERROR: For your convenience alignment with variable sites printed to /home/jumpp/project/sugarcane/phylo/sugarcane.L2.phy.varsites.phy ERROR: Invalid use of +ASC because of 0 invariant sites in the alignment So any suggestions on what might be going wrong here? ", "Hi there, This indeed strange, the error message is contradictory, because ASC model should work when you have 0 invariant sites. Which version of IQ-TREE did you use? Can you send me the alignment via personal email for further inspection? Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0ddf8be7-ba83-479b-8588-7297a6ec95f0n%40googlegroups.com ", "Hi Minh, Sorry for late reply. I use IQ-TREE version 1.6.1. I've also tried the input with raxml-ng using the same model and it works well. So I'll send you an input I used. Thank you for you help. ", "After looking into the run reproduced from the alignment you sent, I now see the problem. Your alignment has 21909 sites and there is just one site being invariant. If you look at .varsites.phy file IQ-TREE printed, you will see that it has 21908 sites. So why IQ-TREE printed 0 invariant sites? This is just a printing problem due to a rounding-down in the numerics: when I take the product of the fraction of invariant sites (internally stored as 0.000045643342918435343 ) with the number of sites (21909), this becomes 0.99999999999999988 . And for some reason, C++ decided to round it down. The correct error message should have been \u201cbecause of 1 invariant sites\u201d. My suggestion is to just re-run your analysis using .varsites.phy file that IQ-TREE provided. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/65a69eb5-63dc-4456-97f1-b420adc71a5fn%40googlegroups.com ", "I've tried using .varsites.phy file and it works. Thank you Minh. Best Phongphak ", "Hi Minh, > So why IQ-TREE printed 0 invariant sites? This is just a printing problem due to a rounding-down in the numerics: when I take the product of the fraction of invariant sites (internally stored as 0.000045643342918435343) with the number of sites (21909), this becomes 0.99999999999999988. And for some reason, C++ decided to round it down. I guess that the float result, a decimal number, is converted to an integer by a cast for printing (or just printed as an integer, which implies a cast). This is typically OK, because we expect integer numbers and no rounding effects. Here, however, by casting the number looses the part after the dot, thus changing to zero (the part before the dot). Am I right? Best wishes, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Hi Heiko, Yes that\u2019s exactly what happened, in the casting from double to int. Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/DD718D46-226A-40BE-89F7-4219472C6B0F%40univie.ac.at "]}, "nchW5XcyYjk": {"topic": "Re: [iqtree] -mrate being ignored?", "initializeDate": "Jun 26, 2020, 1:08:49 AM", "timeStamp": "Jun 26, 2020, 1:08:49 AM", "content": ["Hi Bruno, I can't see any evidence of +I or +G models in the output that you posted. The +F is just the base frequency vector, and has nothing to do with rates across sites. Maybe I misunderstood something though - if so please clarify. Rob On Wed, 24 Jun 2020 at 01:41, Bruno de Medeiros < brun...@gmail.com > wrote: Hi, I'm trying to run model finder to join partitions, constraining models to be GTR without rate heterogeneity. It seems that IQTREE is ignoring the -mrate flag and still testing +F, +I and +G. Is this how this is supposed to work? How should I proceed to test only models with homogeneous rates? I'm attaching the input partition file (not the phylip alignments, but let me know if this could help solving the problem). The command used was iqtree -nt AUTO -ntmax 8 -spp partitions.nex -m TESTMERGEONLY -mset GTR -mrate E --prefix concatenated and the result was #nexus begin sets; charset locus_105_locus_107_locus_150_locus_152_locus_155_locus_189_locus_198_locus_200_locus_214_locus_219_locus_221_locus_230_locus_240_locus_243_locus_263_locus_266_locus_268_locus_292_locus_295_locus_302_locus_314_locus_323_locus_33_locus_35_locus_372_locus_373_locus_48_locus_57_locus_58_locus_81_locus_91_locus_9 = locus_105.phy,locus_107.phy,locus_150.phy,locus_152.phy,locus_155.phy,locus_189.phy,locus_198.phy,locus_200.phy,locus_214.phy,locus_219.phy,locus_221.phy,locus_230.phy,locus_240.phy,locus_243.phy,locus_263.phy,locus_266.phy,locus_268.phy,locus_292.phy,locus_295.phy,locus_302.phy,locus_314.phy,locus_323.phy,locus_33.phy,locus_35.phy,locus_372.phy,locus_373.phy,locus_48.phy,locus_57.phy,locus_58.phy,locus_81.phy,locus_91.phy,locus_9.phy: * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *; charset locus_109_locus_111_locus_112_locus_118_locus_124_locus_130_locus_149_locus_14_locus_164_locus_166_locus_16_locus_173_locus_190_locus_19_locus_210_locus_224_locus_248_locus_24_locus_272_locus_279_locus_280_locus_291_locus_297_locus_34_locus_367_locus_36_locus_376_locus_39_locus_55_locus_65_locus_78_locus_82 = locus_109.phy,locus_111.phy,locus_112.phy,locus_118.phy,locus_124.phy,locus_130.phy,locus_149.phy,locus_14.phy,locus_164.phy,locus_166.phy,locus_16.phy,locus_173.phy,locus_190.phy,locus_19.phy,locus_210.phy,locus_224.phy,locus_248.phy,locus_24.phy,locus_272.phy,locus_279.phy,locus_280.phy,locus_291.phy,locus_297.phy,locus_34.phy,locus_367.phy,locus_36.phy,locus_376.phy,locus_39.phy,locus_55.phy,locus_65.phy,locus_78.phy,locus_82.phy: * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *; charset locus_114_locus_115_locus_121_locus_134_locus_135_locus_145_locus_147_locus_148_locus_151_locus_159_locus_171_locus_176_locus_197_locus_201_locus_202_locus_223_locus_227_locus_229_locus_234_locus_238_locus_244_locus_258_locus_25_locus_275_locus_28_locus_293_locus_294_locus_307_locus_308_locus_315_locus_316_locus_328_locus_332_locus_336_locus_343_locus_344_locus_346_locus_351_locus_47_locus_49_locus_64_locus_6_locus_74_locus_76_locus_93_locus_94 = locus_114.phy,locus_115.phy,locus_121.phy,locus_134.phy,locus_135.phy,locus_145.phy,locus_147.phy,locus_148.phy,locus_151.phy,locus_159.phy,locus_171.phy,locus_176.phy,locus_197.phy,locus_201.phy,locus_202.phy,locus_223.phy,locus_227.phy,locus_229.phy,locus_234.phy,locus_238.phy,locus_244.phy,locus_258.phy,locus_25.phy,locus_275.phy,locus_28.phy,locus_293.phy,locus_294.phy,locus_307.phy,locus_308.phy,locus_315.phy,locus_316.phy,locus_328.phy,locus_332.phy,locus_336.phy,locus_343.phy,locus_344.phy,locus_346.phy,locus_351.phy,locus_47.phy,locus_49.phy,locus_64.phy,locus_6.phy,locus_74.phy,locus_76.phy,locus_93.phy,locus_94.phy: * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *; charpartition mymodels = GTR{1.84724,3.75922,2.23913,1.64455,5.67883}+F{0.305302,0.216567,0.24259,0.235541}: locus_105_locus_107_locus_150_locus_152_locus_155_locus_189_locus_198_locus_200_locus_214_locus_219_locus_221_locus_230_locus_240_locus_243_locus_263_locus_266_locus_268_locus_292_locus_295_locus_302_locus_314_locus_323_locus_33_locus_35_locus_372_locus_373_locus_48_locus_57_locus_58_locus_81_locus_91_locus_9{0.17724}, GTR{1.93312,6.00579,1.29749,4.76164,6.06369}+F{0.350687,0.165083,0.186601,0.297629}: locus_109_locus_111_locus_112_locus_118_locus_124_locus_130_locus_149_locus_14_locus_164_locus_166_locus_16_locus_173_locus_190_locus_19_locus_210_locus_224_locus_248_locus_24_locus_272_locus_279_locus_280_locus_291_locus_297_locus_34_locus_367_locus_36_locus_376_locus_39_locus_55_locus_65_locus_78_locus_82{0.154722}, GTR{0.49594,2.38138,0.401874,0.747759,1.85741}+F{0.320003,0.18598,0.158148,0.335869}: locus_114_locus_115_locus_121_locus_134_locus_135_locus_145_locus_147_locus_148_locus_151_locus_159_locus_171_locus_176_locus_197_locus_201_locus_202_locus_223_locus_227_locus_229_locus_234_locus_238_locus_244_locus_258_locus_25_locus_275_locus_28_locus_293_locus_294_locus_307_locus_308_locus_315_locus_316_locus_328_locus_332_locus_336_locus_343_locus_344_locus_346_locus_351_locus_47_locus_49_locus_64_locus_6_locus_74_locus_76_locus_93_locus_94{0.201335}; end; Best, Bruno You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/04ca7b8b-be17-43c4-a711-5f67cba97ed9o%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com "]}, "Gnr0jVyACcA": {"topic": "Crash during analysis", "initializeDate": "Jan 23, 2018, 8:00:54 AM", "timeStamp": "Jan 26, 2018, 6:49:51 AM", "content": ["Hello, I am running a bootstrap analysis (regular, not ultrafast) using data from three genes with a partition file specifying nucleotide substitution models. I keep getting the following error: ===> START BOOTSTRAP REPLICATE NUMBER 329 Creating bootstrap alignment (seed: 8378)... Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.020 seconds NOTE: 10 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.100) Optimizing HKY+F+G4 parameters for partition part3 (226 free parameters) Optimizing HKY+F+I+G4 parameters for partition part2 (235 free parameters) Optimizing HKY+F+G4 parameters for partition part1 (238 free parameters) ERROR: NUMERICAL ERROR: Too many iterations in tqli ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: reddat_partition.txt.log ERROR: *** Alignment files (if possible) [glon.1@unity-1 reduced_dataset]$ The program has given me this error with a couple of different datasets and partition files, but always at a seemingly random replicate number (ranging from replicate numbers 300 to 670). I am using -nt AUTO. I'm able to restart the job and pick up where I left off, but I'm competing for time on a shared cluster and every time the app crashes I go back in the queue and have to wait a couple of days. I would appreciate any advice on fixing this issue. Thank you. ", "Hi there, Thanks for the report. Right now I don\u2019t know what is the cause, but technically this numerical error can occur during eigen-decomposition of the rate matrix if there is little data (i.e. very short partitions). Can you send me the log file via personal email? If necessary I may then ask for the data set. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout "]}, "0JwcSchymJo": {"topic": "Help with indipendent bootstrap runs", "initializeDate": "Oct 18, 2016, 10:53:29 AM", "timeStamp": "Oct 18, 2016, 3:59:20 PM", "content": ["Dear Minh, I am trying to run IQ-Tree on a very large dataset with the \"normal\" bootstrap replicates. I may be able to get the new 1.4.4 MPI version installed on a computer core, but in the meantime I would like to try and parallelize the 1.4.2-omp version. I read on the FAQ that I could save time by running independent bootstrap replicates, and then combine the results to create the consensus tree. What is not clear to me is how I can get the best ML tree with bootstrap values, can you please help? Thank you for the kind attention, Max Tagliamonte ", "Dear Max, I think what you need is described at the end of the FAQ: http://www.iqtree.org/doc/Frequently-Asked-Questions/#how-do-i-save-time-for-standard-bootstrap You can also perform the analysis on the original alignment: iqtree-omp -nt 4 -s input_alignment ... and map the support values onto the obtained ML tree: iqtree -sup input_alignment.treefile -t alltrees The ML tree with assigned bootstrap supports is written to .suptree file. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thank you! I had read that second part already, but for some reason I did not understand it properly. It makes sense now, sorry for the blunt question. Have a nice day, Max "]}, "dZjx6sf4-OA": {"topic": "Question: Rate matrix Q with GTR+F+G4", "initializeDate": "Jul 30, 2019, 11:11:47 AM", "timeStamp": "Aug 16, 2019, 3:22:50 AM", "content": ["A trying to reconstruct a tree within a bacteria CC group (expected to be very closely related). We removed expected recombinant sites, and worked with a core alignment. We choosen a standard Model of substitution: GTR+F+G4 (we have not done model testing yet, we are just learning ...) . We are not so surprized to observe that the G4 might be actually overfitting, because it seems we have a very low variation between heterogeneity rate classes if I understand well, wich we woud expect if we were working within a lineage/CC group. But we were wondering why the Rate matrix Q was not symetrical. Is it because of rounding/model approximation or scaling? I see all diagonal values are negative. Could you explain? Please extract of output corresponding to this question bellow Best regards Eve ``` SEQUENCE ALIGNMENT ------------------ Input data: 25 sequences with 1441 nucleotide sites Number of constant sites: 0 (= 0% of all sites) Number of invariant (constant or ambiguous constant) sites: 0 (= 0% of all sites) Number of parsimony informative sites: 481 Number of distinct site patterns: 226 SUBSTITUTION PROCESS -------------------- Model of substitution: GTR+F+G4 Rate parameter R: A-C: 0.7237 A-G: 5.0504 A-T: 1.3350 C-G: 0.2022 C-T: 5.0167 G-T: 1.0000 State frequencies: (empirical counts from alignment) pi(A) = 0.2086 pi(C) = 0.2908 pi(G) = 0.2811 pi(T) = 0.2195 Rate matrix Q: A -1.203 0.1316 0.8877 0.1832 C 0.0944 -0.8185 0.03554 0.6886 G 0.6588 0.03676 -0.8328 0.1373 T 0.1741 0.9121 0.1758 -1.262 Model of rate heterogeneity: Gamma with 4 categories Gamma shape alpha: 998.4- Category Relative_rate Proportion 1 0.9601 0.25 2 0.9894 0.25 3 1.01 0.25 4 1.041 0.25 Relative rates are computed as MEAN of the portion of the Gamma distribution falling in the category. ``` ", "Hi Eve, Sorry for the slow response. Q is not symmetric because q_ij = r_ij * pi_j, where r_ij is the symetric matrix R (the \u201cRate parameter R\u201d in iqtree output), and pi_j is the state frequency vector. Q is symmetric only if the model has equal state frequencies (e.g. the SYM model). See http://www.iqtree.org/doc/Substitution-Models#dna-models Note that this model still reversible, even though Q is not symmetric. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ed0343c7-f670-42af-b9e7-89ec09a8e381%40googlegroups.com ", "Thanks a lot for you answer and for your time All the best Eve ", "Hi Eve again, Regarding your other questions: the diagonal elements are negative because sum of rows of Q matrix should be 0. This follows a standard Markov process. Therefore, I suggest you have a look at text book, such as the Phylogenetic Handbook: It has a nice chapter on the derivation of the Q matrix. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/12abec51-82e2-445d-a2b6-0b5a3cbd8e3e%40googlegroups.com "]}, "B6kyoqSM4ws": {"topic": "Consensus trees (quick question)", "initializeDate": "Oct 20, 2020, 10:53:34 PM", "timeStamp": "Oct 20, 2020, 11:05:51 PM", "content": ["When I run: iqtree -con mytrees -minsup 0.5 What is the output filename? Is there any way to assign or specify? Does it print it to the command line unless I use \">\" to assign it to a file? ", "just checked its written to mytrees.contree If you run -con mytrees.lstree it becomes mytrees.lstree.contree "]}, "tFXQE7A_FZY": {"topic": "-asr with codons", "initializeDate": "Dec 1, 2018, 8:44:10 AM", "timeStamp": "Dec 19, 2018, 5:45:38 PM", "content": ["Is it possible to do ancestral sequence reconstruction with codons yet? I tried specifying -st CODON and giving a codon substitution model, but it spat out a developer error, which makes me think you may not have implemented it yet. Best wishes, Nat Walker-Hale ", "Hi Nat, You are right, ASR feature does not work with codon models yet, which I overlooked. Thanks for pointing this out. We will fix it for the next 1.6.x release. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Nat, Can you please tell me, if there is a numerical underflow message? Did you see have any NOTE about some state(s) not present in the alignment? If so, this is the problem and not specific to codon models. It would be helpful if you send me the log file as well. Thanks, Minh ", "Dear Minh, When I run it on e.g. the attached alignment, using the latest 1.7b release, I get the following error: Do NNI search on 20 best initial trees Estimate model parameters (epsilon = 0.100) BETTER TREE FOUND at iteration 1: -81606.280 ERROR: iqtree.cpp:3206: virtual pair<int, int> IQTree::optimizeNNI(bool): Assertion `curScore > appliedNNIs.at(0).newloglh - 0.1 && \"Using one NNI reduces LogL\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: Bv_genbank_lab_DODA_4a_1_1.cds.fa.fsaaa2cdn.aln-cln.log ERROR: *** Alignment files (if possible) Aborted (core dumped) I have attached the alignment and the log. Best, Nat ", "Dear Nat, I see, in this case I don\u2019t recommend to use codon models. Your alignment has only 275 codon sites for 471 sequences, which cause numerical problem for such complex codon models. Please switch to DNA models only. Cheers Minh <Bv_genbank_lab_DODA_4a_1_1.cds.fa.fsaaa2cdn.aln-cln> <Bv_genbank_lab_DODA_4a_1_1.cds.fa.fsaaa2cdn.aln-cln.log> ", "Hi Minh, This was actually just a dataset I grabbed to reproduce the issue, but in general will codon reconstruction work? (in cases where n >> k) Best, Nat ", "Yes, in general when you have enough data it should work. Minh "]}, "9QrN5t2sqwU": {"topic": "Estimating Site-wise log-likelihood for multifurcating tree", "initializeDate": "Sep 27, 2016, 6:05:17 PM", "timeStamp": "Sep 29, 2016, 7:56:40 PM", "content": ["Hi IQ-TREE development team, When I was trying to estimate site-wise log-likelihood for multifurcating tree using the IQ-TREE 1.4.3, the IQ-TREE always prints out the error \u201cCRASHES WITH SIGNAL ABORTED\u201d. Even I tried the latest version IQ-TREE version 1.5.0-beta, the issue still is there. Here is my command line: ./iqtree -te 46taxa_1361C12_partitioned_ML_polytomy.tre -s 1361C12_combined.fas -pre 46taxa_1361C12_partitioned_ML_polytomy -spp 1361P_C12.nex \u2013wsl Since the data is little big (~17 mb), I put them on my dropbox (see link: https://www.dropbox.com/sh/9eluwpuyurbg5vn/AADY6JCAmSjwy8m60z1afDW3a?dl=0 Could you help me figure out what issue is? Thank you! Xingxing ", "Dear Xingxing, thanks for the report, which helps to find the problem. This is indeed a bug specifically with multifurcating trees and partition model and missing data. I have fixed it now. Can you please try the beta version again and let me know how it goes: https://github.com/Cibiv/IQ-TREE/releases/tag/v1.5.0-beta Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "\u5728 2016\u5e749\u670829\u65e5\u661f\u671f\u56db UTC-5\u4e0b\u53484:15:15\uff0cBui Quang Minh\u5199\u9053\uff1a Dear Minh, Thanks for your nice help! Yes, it works well now. Best, Xingxing "]}, "shqu7zVnAIo": {"topic": "error: taxon not found in full tree", "initializeDate": "Oct 26, 2016, 9:22:28 AM", "timeStamp": "Nov 28, 2016, 7:03:03 AM", "content": ["Hi, I have a dataset with some identical sequences. I know I should remove them, but I still need them and I find it easier to have IQ-TREE inferring a phylogeny with my identical sequences rather than adding them myself manually to the final tree. So in the beginning of the run, I have the message NOTE: XXX (identical to YYY) is ignored but added at the end The problem is that the run does not end well. I have this at the end of the \".out\" file : Computing bootstrap consensus tree... Reading input file N_cp_17.splits.nex... 64 taxa and 515 splits. Consensus tree written to N_cp_17.contree Log-likelihood of consensus tree: -15135.751 Reading input trees file N_cp_17.contree ERROR: Taxon not found in full tree: XXX It seems to me that the taxon has been removed because it is identical to another one, but not added to the bootstrap trees... I run the 1.4.4 version, I did not see anything in the changelog of version 1.5 relative to that issue. Thanks, Julien ", "Ok, maybe I should have tested with version 1.5 before posting... I just did, and everything seems to work fine with this version. ", "Hi Julien, no worry, it is the purpose of this group to help users... Minh > On Oct 26, 2016, at 4:28 PM, julie...@gmail.com wrote: > Ok, maybe I should have tested with version 1.5 before posting... > I just did, and everything seems to work fine with this version. > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, I've encountered the same error with version 1.5.1 (OPM): a sequence with an identical pair is removed at the beginning of the process, and the process ends with the error \"ERROR: Taxon not found in full tree: XX\". Removing the offending sequence worked fine for me, but I'm commenting just so you know this is still an issue with the current version of the software. Cheers, Xavi ", "Dear Minh and Xavi, I observed the same with the exact same version of IQ-TREE two days ago, and was considering posting to the group :) Julien You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/shqu7zVnAIo/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com ", "Dear all, I am still investigating this problem. As a quick fix for now, you can use option \u201c-keep-ident\u201d to keep identical sequences in the analysis. Thanks, Minh "]}, "29RaA3D5WfE": {"topic": "IQ-TREE Crashes with signal aborted", "initializeDate": "Jan 1, 2018, 5:48:04 AM", "timeStamp": "Jan 2, 2018, 9:50:42 PM", "content": ["Hello, I met a problem \"IQ-TREE CRASHES WITH SIGNAL ABORTED\" when run the topology test, The command I used is \"bin\\iqtree -s Data5_20171209rev3.phy -z Data5-20171221rev3_tree1-2_Newick.treels\" in IQ-Tree, I tried also W-IQ-Tree but failed. Could you please help to fix it? Attached the reported .log file, alignment file (.phy), and newick file (.treels). Thank you! Best regards, ChiChuan ", "Hi ChiChuan, The abort was because the tree file does not exist. E.g., if I ran on a Mac: Reading trees in Data5-20171221rev3_tree1 ... ERROR: Cannot read file Data5-20171221rev3_tree1 There is a second problem with the trees: Reading trees in Data5-20171221rev3_tree1-2_Newick.treels ... 2 trees detected Tree 1ERROR: Alignment sequence LmSupCtw03 does not appear in the tree ERROR: Alignment sequence LmSupCtw07 does not appear in the tree as clearly notified \u2026 So pls fix them before rerunning IQ-TREE. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <Data5_20171209rev3.phy.log> <Data5_20171209rev3.phy> <Data5-20171221rev3_tree1-2_Newick.treels> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Thanks for the help, the problem was solved! Bui Quang Minh\u65bc 2018\u5e741\u67082\u65e5\u661f\u671f\u4e8c UTC+8\u4e0b\u53487\u664236\u520615\u79d2\u5beb\u9053\uff1a "]}, "k4oPqYIwl-A": {"topic": "Combined DNA and morphological data??", "initializeDate": "May 30, 2017, 10:35:36 PM", "timeStamp": "Jul 10, 2019, 11:45:11 AM", "content": ["Hi Minh, Thank you for the help all the time. As suggested by a number of users, is there any feature (or alternative way) to execute the IQ-Tree using the combined DNA & morphological data? While some other programs (MrBayes, BEAST, PAUP etc.,) will accept this combined dataset, I am not sure about the IQ-Tree. According to its manual and others' posts, this IQ-Tree will accept all morpholical data (0-9 and A-Z). However, I got this error message after testing in W-IQ-Tree; This job STOPPED because there was a problem! ERROR: Sequence N._afr has invalid character 0 at site 1 Sequence N._amp has invalid character 0 at site 1 Sequence N._ben has invalid character 0 at site 1 Sequence N._bur has invalid character 0 at site 1 Sequence N._cav has invalid character 0 at site 1 Or do I have to make a partition file for this? Any suggestion will be greatly appreciated! Cheers, Taek ", "Dear Taek, this is because IQ-TREE does not support mixed data types in one alignment. You have to put each data type into one alignment, and then specify a partition file, which references to each alignment. See this FAQ here: http://www.iqtree.org/doc/Frequently-Asked-Questions#can-i-mix-dna-and-protein-data-in-a-partitioned-analysis Unfortunately this means you can\u2019t use the web server for this, but the command line version. I planed to support mixed alignment, but did not have the time yet to do so\u2026 Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Thank you for the reply. Re command line version , see below what I did. 1. Followed \u201cPartitioned analysis with mixed data\u201d after making two .phy files (Morph.phy and DNA.phy). 2. Found a suitable model for both .phy files using W-IQ-TREE to make a Partition.nex file. 3. Executed iqtree \u2013sp Partition.nex (worked fine but could not see the consensus bootstrap values). See page 41 in iqtree-doc.pdf. 4. In order to obtain the consensus bootstrap values, I executed iqtree \u2013s Morph.phy DNA.phy \u2013ssp Partition.nex \u2013m MFP+MERGE (and/or TESTMERGE). This stage I have an error message \u201cERROR: Tree file does not start with an opening-bracket '(' (line 1 column 1)\u201d. See page 42 in iqtree-doc.pdf. Did I miss something? Or is there any quick command to generate the final consensus bootstrap values for \u201cPartitioned analysis with mixed data\u201d? Looking forward to your reply! Cheers, Taek ", "Hi Taek, Your command line is not valid, should be something like: iqtree -spp Partition.nex -m MFP+MERGE (omit -s because alignment file names are included in Partition.nex). Then add \u201c-bb 1000\u201d or \u201c-b 100\u201d to perform ultrafast bootstrap or standard bootstrap, respectively. Cheers, Minh ", "Thanks Minh. After following your recommendation, I have made some progress but have also stuck in another issue. Step 1: iqtree \u2013spp Partion.nex \u2013m MFP+MERGE \u2013bb 1000 [executed ok] Step 2: iqtree \u2013spp Partion.nex \u2013m MFP+MERGE \u2013b 100 [ERROR: -m TESTMERGE is not allowed when doing standard bootstrap. Please first find partition scheme on the original alignment and use it for bootstrap analysis] Step 3: iqtree \u2013spp Partion.nex \u2013m ORDERED+FQ+G4 [selected from Step 1 model selection] \u2013b 100 [Generating 98 parsimony trees... ERROR: Tree file does not start with an opening-bracket '(' (line 1 column 1)] The bottom line is I am trying to obtain a consensus tree file with bootstrap values. When I opened the \u2018Partition.nex.bionj\u201d generated from Step 1 in FigTree program, it doesn't look like the real consensus bootstrap values ((Nsua:0.00553211,(((Nvel:0.00384337,Nrot:0.00447283):0.00289089, \u2026\u2026.; Even when I opened the \u201cPartition.nex.treefile\u201d generated from Step 2 in in FigTree program, it was not the consensus bootstrap values either (Nafr:0.0118712275,((((((((((Namp:0.0064621569 \u2026\u2026\u2026; Any ideas? Regards, Taek ", "Dear Taek, On Jun 5, 2017, at 6:18 AM, HT Chung < chun...@gmail.com > wrote: Thanks Minh. After following your recommendation, I have made some progress but have also stuck in another issue. Step 1: iqtree \u2013spp Partion.nex \u2013m MFP+MERGE \u2013bb 1000 [executed ok] great ;-) Step 2: iqtree \u2013spp Partion.nex \u2013m MFP+MERGE \u2013b 100 [ERROR: -m TESTMERGE is not allowed when doing standard bootstrap. Please first find partition scheme on the original alignment and use it for bootstrap analysis] that\u2019s right. Step 3: iqtree \u2013spp Partion.nex \u2013m ORDERED+FQ+G4 [selected from Step 1 model selection] \u2013b 100 [Generating 98 parsimony trees... ERROR: Tree file does not start with an opening-bracket '(' (line 1 column 1)] Step 1 already generated a .best_scheme.nex file, which you can feed into this run via -spp option. Thus the command looks like: iqtree -spp xxx.best_scheme.nex -b 100 The bottom line is I am trying to obtain a consensus tree file with bootstrap values. When I opened the \u2018Partition.nex.bionj\u201d generated from Step 1 in FigTree program, it doesn't look like the real consensus bootstrap values ((Nsua:0.00553211,(((Nvel:0.00384337,Nrot:0.00447283):0.00289089, \u2026\u2026.; Even when I opened the \u201cPartition.nex.treefile\u201d generated from Step 2 in in FigTree program, it was not the consensus bootstrap values either (Nafr:0.0118712275,((((((((((Namp:0.0064621569 \u2026\u2026\u2026; because the run did not complete yet, these are still intermediate files. Cheers, Minh ", "Hi Minh, Thank you for the prompt reply. I have executed Step 1 (iqtree \u2013spp Partion.nex \u2013m MFP+MERGE \u2013bb 1000 ) in iqtree-1.5.5-Windows (some reason why the same command was not recognized in iqtree-omp-1.5.5-Windows: iqtree is not recognized as an internal or external command). I have also tested in iqtree-1.5.4-Windows but same outcomes. Anyway, after executing Step 1 in iqtree-1.5.5-Windows, I have found following files; Partition.nex.bionj Partition.nex.ckp.gz Partition.nex.log Partition.nex.mldist Partition.nex.model Unfortunately, there was no XXXX.best_scheme.nex file as you described. Any ideas? Cheers, Taek ", "Hi Minh, Here is what I have tried in Linux. Step 1: module load ctcb/iq-tree/1.5.4 iqtree -spp Partition.nex -m MFP+MERGE -bb 1000 -nt 4 Note: Did not accept -mem 20G so I had to run it without \u2013mem option. From Step 1, the Partition .nex.best_scheme.nex was generated (this was not successful in Windows cmd). Step 2: iqtree -spp Partition.nex.best_scheme.nex -b 100 -nt 4 Note: There are two different error messages for two different datasets. ERROR: Numerical underflow (lh-from-buffer). Run again with the safe likelihood kernel via `-safe` option ERROR: Too high (saturated) partition rates of the proportion partition model! Please switch to the edge-equal partition model via -q option instead of \u2013spp When I used \u2013q option, this time I got this error message; ERROR: Unsupported -spj. Please use proportion edge-linked partition model (-spp) Q1: What does the ERROR mean? Q2: Which output file contains the final consensus bootstrap values (Partition.nex.best_scheme.nex.bionj, Partition .nex.best_scheme.nex.boottrees, & Partition.nex.best_scheme.nex.treefile)? When I opened it up in FigTree, it does not look like the consensus bootstrap values. Looking forward to your reply! Cheers, Taek ", "Hi Taek, The error message speaks by itself: ERROR: Numerical underflow (lh-from-buffer). Run again with the safe likelihood kernel via `-safe` option Thus pls rerun with -safe option. Cheers, Minh ", "Hi all, I ran into the same \"numerical underflow\" program when trying to run a combined morphology+molecular analysis. I rerun with the -safe option but now I get the following error: WARNING: Numerical underflow for lh-branch ERROR: partitionmodelplen.cpp:142: virtual double PartitionModelPlen::optimizeParameters(int, bool, double, double): Assertion `cur_lh > tree_lh - 1.0 && \"partition rate opt reduces LnL\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: partitions.nex.log ERROR: *** Alignment files (if possible) I called IQtree with the following command: iqtree -spp partitions.nex -m TESTNEWMERGE -bb 1000 -safe My partition, log and alignment files are here: https://www.dropbox.com/s/etm6by8mdb0ewv8/Santos_IQtree_combined_alignments.zip.zip?dl=0 Would really appreciate any insight here! Thanks! "]}, "aBKnUk656ck": {"topic": "IQ-TREE release 1.3.13", "initializeDate": "Jan 28, 2016, 2:42:25 PM", "timeStamp": "Jan 28, 2016, 2:42:25 PM", "content": ["Jan 28, 2016 Dear users, IQ-TREE version 1.3.13 is just released with a bug fix ( http://www.cibiv.at/software/iqtree/release/ * Fix a numerical underflow with ascertainment bias correction [+ASC] model for large data sets (reported by Alex Riedel) Best, IQ-TREE development team "]}, "AkaifHuEhQk": {"topic": "BUG: IQ-TREE crashes when optimising candidate tree set", "initializeDate": "Nov 29, 2020, 2:26:29 AM", "timeStamp": "Dec 10, 2020, 7:34:29 AM", "content": ["Dear IQ-TREE users and developers, Can anyone please help to sort out the issue posted below which I encountered when running IQ-tree version 1.6.12 on macOS 64-bit version 11.0.1 (Big Sur)? ERROR: phylokernelnew.h:3159: double PhyloTree::computeLikelihoodFromBufferGenericSIMD() [VectorClass = Vec4d, FMA = true, SITE_MODEL = false]: Assertion `std::isfinite(tree_lh) && \"Numerical underflow for lh-from-buffer\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 2 _sigtramp() ERROR: 5 double PhyloTree::computeLikelihoodFromBufferGenericSIMD<Vec4d, true, false>() ERROR: 6 PhyloTree::getBestNNIForBran(PhyloNode*, PhyloNode*, NNIMove*) ERROR: 7 IQTree::evaluateNNIs(std::__1::map<int, std::__1::pair<Node*, Node*>, std::__1::less<int>, std::__1::allocator<std::__1::pair<int const, std::__1::pair<Node*, Node*> > > >&, std::__1::vector<NNIMove, std::__1::allocator<NNIMove> >&) ERROR: 8 IQTree::optimizeNNI(bool) ERROR: 9 IQTree::doNNISearch() ERROR: 10 IQTree::doTreeSearch() ERROR: 11 runTreeReconstruction(Params&, IQTree*&) ERROR: 12 runPhyloAnalysis(Params&, Checkpoint*) ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: ref6_1.best.phy.log ERROR: *** Alignment files (if possible) zsh: abort iqtree -s ref6_1.best.phy --sequential -st CODON11 -nt AUTO I can send the full log file and alignment file upon request. Many thanks. Best regards, E. Bundhoo. ", "Hi there, the codon models are known to be sometimes numerically unstable, depending on the data. So does it work if you add -m TEST option? With this option IQ-TREE will ignore the parameter-rich free-rate models, and might resolve the numerical problem (or not). If not, let me know. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/af2b95ef-ed47-4025-b534-95bb78a858ecn%40googlegroups.com ", "Dear Minh, Thank you for your reply. Unfortunately however it does not work when I add the -m TEST option. I get the same error at the same step (i.e. optimising candidate tree set). I copy the error message again below. Please advise. Thank you. Sincerely, Eshan. ERROR: phylokernelnew.h:3159: double PhyloTree::computeLikelihoodFromBufferGenericSIMD() [VectorClass = Vec4d, FMA = true, SITE_MODEL = false]: Assertion `std::isfinite(tree_lh) && \"Numerical underflow for lh-from-buffer\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 2 _sigtramp() ERROR: 5 double PhyloTree::computeLikelihoodFromBufferGenericSIMD<Vec4d, true, false>() ERROR: 6 PhyloTree::getBestNNIForBran(PhyloNode*, PhyloNode*, NNIMove*) ERROR: 7 IQTree::evaluateNNIs(std::__1::map<int, std::__1::pair<Node*, Node*>, std::__1::less<int>, std::__1::allocator<std::__1::pair<int const, std::__1::pair<Node*, Node*> > > >&, std::__1::vector<NNIMove, std::__1::allocator<NNIMove> >&) ERROR: 8 IQTree::optimizeNNI(bool) ERROR: 9 IQTree::doNNISearch() ERROR: 10 IQTree::doTreeSearch() ERROR: 11 runTreeReconstruction(Params&, IQTree*&) ERROR: 12 runPhyloAnalysis(Params&, Checkpoint*) ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: ref6_1.best.phy.log ERROR: *** Alignment files (if possible) zsh: abort iqtree -s ref6_1.best.phy --sequential -st CODON11 -nt AUTO -m TEST ", "Does it work, if you use DNA models? How long is your alignment? If it\u2019s too short or too sparse, you may actually don\u2019t have enough information to estimate codon models. Please send your full log file. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1b9cab93-27b0-4749-8b8d-5ff8b0812da3n%40googlegroups.com ", "My alignment is of length 2505 (835 codons). I'll try again with DNA models. In the meantime, I'll share the log file and alignment file. Thanks. Eshan. "]}, "hUNNfZxmMuA": {"topic": "ERROR: Alignment must have at least 3 sequences", "initializeDate": "Mar 8, 2021, 1:56:24 PM", "timeStamp": "Mar 9, 2021, 6:07:53 PM", "content": ["I have a huge file with many lines with this command: iqtree -s /../X/OG0000018.fa -nt 5 But in the middle of the analysis I got this message: ERROR: Alignment must have at least 3 sequences This happen in many alignments files, someone know how can I fix this? Or if I can jump the alignment that doesn't have at least 3 sequences? Best ", "Hi there, This error message speaks for itself. If you are processing a lot of files, just ignore those alignments with 2 sequences. It just doesn\u2019t make any sense to do tree reconstruction here. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ea6c9f94-53bb-48d7-b821-702ab5a73dd7n%40googlegroups.com "]}, "_7ubs7kXgRM": {"topic": "Log-odds score exchangeabilities matrix", "initializeDate": "Feb 12, 2021, 6:56:51 AM", "timeStamp": "Feb 24, 2021, 6:27:40 PM", "content": ["Hello there! I am trying to implement a specific substitution matrix into IQTREE, however I only have the log-odds matrix, which does not seem to work, as I get the following error when attempting to import and use the matrix from a nexus file with -mdef: ERROR: Negative rates found Is there a way to convert log-odds values to the format that IQ-TREE uses? Best wishes, Ben ", "Hi Ben, I haven\u2019t heard about the log-odds matrix used for phylogenetics. So someone else might be able to help\u2026 But something to note regarding IQ-TREE: make sure that you input an instantaneous rate matrix Q. This is different from a probability matrix, which is P(t) = e^{Qt}. And the rates must be positive, otherwise it does not biological make sense. That\u2019s what the error message is about. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8175af65-01ec-44e3-b339-049341447d82n%40googlegroups.com ", "Dear Minh, Thank you very much for the reply! So it seems then the blast format matrix I have below contains probabilities instead of instantaneous rates? Is obtaining a rate matrix a simple matter of conversion, or do I need to return to the author to ask for a rate matrix? Best wishes, Ben ", "Unfortunately I don\u2019t know what units is this. You need to ask the author. Minh On 24 Feb 2021, at 9:05 pm, 'Benjamin Schlossman' via IQ-TREE < iqt...@googlegroups.com > wrote: Dear Minh, Thank you very much for the reply! So it seems then the blast format matrix I have below contains probabilities instead of instantaneous rates? Is obtaining a rate matrix a simple matter of conversion, or do I need to return to the author to ask for a rate matrix? Best wishes, Ben <Screenshot 2021-02-24 at 10.03.53.png> On Monday, 15 February 2021 at 00:51:28 UTC Minh Bui wrote: Hi Ben, I haven\u2019t heard about the log-odds matrix used for phylogenetics. So someone else might be able to help\u2026 But something to note regarding IQ-TREE: make sure that you input an instantaneous rate matrix Q. This is different from a probability matrix, which is P(t) = e^{Qt}. And the rates must be positive, otherwise it does not biological make sense. That\u2019s what the error message is about. Minh On 12 Feb 2021, at 10:56 pm, 'Benjamin Schlossman' via IQ-TREE < iqt...@googlegroups.com > wrote: Hello there! I am trying to implement a specific substitution matrix into IQTREE, however I only have the log-odds matrix, which does not seem to work, as I get the following error when attempting to import and use the matrix from a nexus file with -mdef: ERROR: Negative rates found Is there a way to convert log-odds values to the format that IQ-TREE uses? Best wishes, Ben You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8175af65-01ec-44e3-b339-049341447d82n%40googlegroups.com You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/afd9469a-fa6d-433e-927f-2c28790684b0n%40googlegroups.com <Screenshot 2021-02-24 at 10.03.53.png> "]}, "ISf2Gd6xqPM": {"topic": "Re: [iqtree] File not found", "initializeDate": "Jan 20, 2019, 7:23:12 AM", "timeStamp": "Jan 24, 2019, 10:47:53 AM", "content": ["Hi, The first character of the file name is odd. I don\u2019t know what it is, but simply remove this character will resolve the problem. Cheers Minh On 18 Jan 2019, at 3:41 am, brma...@gmail.com wrote: Dear all, I am having a bit of an odd issue. I generated a fasta alignment using R (dat2fasta from phylotools), and IQ-TREE keeps telling me that it can\u2019t find the fasta file. I thought this might just be a generalized error message meaning there was something wrong with the file, so I tried opening the file in Aliview (opens just fine) and saving it as both fasta and as phy, but IQ-TREE is still not recognizing the file. Are there odd characters that are inserted using R that can carry over even in Aliview that I\u2019m just not able to see and that would be causing IQTREE not to recognize it? I have looked for hidden characters, but I'm still missing something. Or maybe in the file name? Any help would be greatly appreciated! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout < N01_sim1.fasta> <N01_sim1.fasta.log> <MCC_rootedR_BL1.nwk> ", "Thanks L. Lee Grismer, Director of Research Department of Biology, La Sierra University 4500 Riverwalk Parkway Riverside, CA 92515-8247, USA Tel. 951-785-2345 \"A risk free world is a very dull world, one from which we are apt to learn little of consequence.\" - Geerat Vermeij \"If people are good only because they fear punishment, and hope for reward, then we are a sorry lot indeed.\" - Albert Einstein ", "Thank you, Minh. Sorry for wasting your time! "]}, "yLjiR_Htf94": {"topic": "IQ-TREE release 1.4.0", "initializeDate": "Mar 4, 2016, 5:15:57 PM", "timeStamp": "Mar 4, 2016, 5:15:57 PM", "content": ["March 4, 2016 Dear users, After several beta testing phases we are pleased to release IQ-TREE version 1.4.0: New features: * Checkpointing to resume analysis from a stopped run. For more details see http://www.cibiv.at/software/iqtree/doc/Command-Reference/#checkpointing-to-resume-stopped-run * Likelihood mapping analysis to assess phylogenetic information of an alignment. For more details see http://www.cibiv.at/software/iqtree/doc/Command-Reference/#likelihood-mapping-analysis . A tutorial will be available shortly. * Approximately unbiased (AU) test to test tree topologies. For more details see http://www.cibiv.at/software/iqtree/doc/Advanced-Tutorial/#tree-topology-tests Bug fixes: * Fix a rare numerical issue when computing maximum likelihood distances for codon models (reported by Giap Nguyen) Special thanks to Karen Meusemann and Giap Nguyen for testing the beta versions. Best, IQ-TREE development team "]}, "FAbiidD5IoI": {"topic": "Re: [iqtree] Bootstrap on best ML tree", "initializeDate": "Apr 1, 2020, 6:18:14 PM", "timeStamp": "Apr 1, 2020, 6:18:14 PM", "content": ["Just for record: already answered in previous thread. On 2 Apr 2020, at 1:55 am, Wendy Valencia < valen...@gmail.com > wrote: Dear Mihn, I hope you are well I have run IQtree with the combination of parameters you suggested in the best practices posts, that is 500 runs, that is 100 runs under -pers from 0.1 to 0.5 and -nstop parameter set to 1000. From these 500 runs, I've picked the maximum likelihood tree. However, I'm not sure how to repeat this exact run to perform 10,000 ultrafast bootstrap replicates. I've tried to replicate the same analysis again, specifying the partition (-spp) and the best model (-mdef), and the same random seed (-seed) that I found for that best run, but with -bb 10,000. However, I'm always getting an ML tree that is worst than my best ML from the 500 runs. Probably this is very basic, but I have tried using this best tree as the initial tree (-t option). Nevertheless, I still get a final tree with a worse likelihood, even though it is apparently starting from the highest likelihood spot. The command that I'm running now is: $path_iqtree_2 -p $path_align -bb 10000 -alrt 10000 -T AUTO -spp $best_partition -mdef $best_model -pre $path_out/195spp_14g_best_tree_10kboot_t_12 \\ -o T_Semanga_superba_MWT93D002 -keep_empty_seq --no-terrace -pers 0.5 -nstop 1000 -seed 82291 -wbtl Any help will be very much appreciated. Thank you so much in advance! Wendy You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/015ed03a-5e9d-49c5-b121-8a83332fbc95%40googlegroups.com "]}, "WoNMjYJtmFk": {"topic": "ERROR: Rooted constraint tree not accepted", "initializeDate": "Dec 7, 2020, 4:56:03 AM", "timeStamp": "Dec 10, 2020, 4:14:13 AM", "content": ["Hello everyone, I'm using iqtree wish is by the way a really nice software ! In my project I need to constrain topologies of house keepng genes according to a well supported consensus tree of 100 species. In order to do that I put the tree topology into a file called : constrained_tree.nwk and run the following command : iqtree -s EOG091B0P2P_house_keeping_1.fasta -g constrained_tree.nwk -m TEST -nt 10 But I get the following issue : Reading constraint tree EOG091B0P2P_constrained_topology.nwk... ERROR: Rooted constraint tree not accepted I use the IQ-TREE multicore version 1.6.12 for Linux 64-bit built Mar 16 2020 Does someone have an idea? I do not understand why I cannot give a rooted tree since I need my gene_phylogeny to be rooted as well. ", "Hi there, This error message is there for a reason. In the tutorial there is an example: http://www.iqtree.org/doc/Advanced-Tutorial#constrained-tree-search . Users may confuse between monophyletic clades, which is only defined on a rooted tree, versus a bipartition, which is well defined in an unrooted tree. The constraint tree only enforces bipartition. Anyway v2 removes this message by converting the rooted constraint tree to unrooted. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/49e921cc-03a4-46d6-b712-3eb1c2dd2e83n%40googlegroups.com "]}, "FeADxT_wJf8": {"topic": "constraint tree - version 1.6.8", "initializeDate": "Nov 28, 2018, 7:07:30 AM", "timeStamp": "Dec 11, 2018, 4:32:41 AM", "content": ["Dear all, I am a bit confused about recent and older threats, therefore I open a new thread. Aim is to use a tree I received earlier with a large dataset to use to inferrelationships of taxa (much more) taking the previous tree as \"constraint\". 1) I do this with -g TREE_I_wanna_use.tre, correct? (containing ca. 40 species), - must the tree be rooted or not? - does it matter if brlength are included or shall I rather remove brlengths? (tree is based on AA dataset with ~ 500 protein coding genes) 2) is an overlap between OTU of the tree and new alignment (ca. 800 taxa, much smaller dataset, 10 genes) necessary or not? - must all spoecies of the contraint tree be part of the much bigger dataset? - Do I have to provide an outgroup during the analysis? - Do I get reliable brlengths, shall I fix brlenghts from the tree I wanna use (see also above)? 3) can I do / does it make sense to do addition non-param. BS analyses: how the BS values are inferred for the constraint tree? I looked in tutorials & google groups but could not fnd an example for what I aim to do 4) can I use 1.6.8 or should i use an earlier version? Thanks Karen ", "Hi Karen, On 28 Nov 2018, at 11:07 pm, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Dear all, I am a bit confused about recent and older threats, therefore I open a new thread. Aim is to use a tree I received earlier with a large dataset to use to inferrelationships of taxa (much more) taking the previous tree as \"constraint\". 1) I do this with -g TREE_I_wanna_use.tre, correct? (containing ca. 40 species), - must the tree be rooted or not? should be unrooted. - does it matter if brlength are included or shall I rather remove brlengths? (tree is based on AA dataset with ~ 500 protein coding genes) with or without branch lengths does not matter. IQ-Tree ignores this when loading the constraint tree. 2) is an overlap between OTU of the tree and new alignment (ca. 800 taxa, much smaller dataset, 10 genes) necessary or not? - must all spoecies of the contraint tree be part of the much bigger dataset? Yes. - Do I have to provide an outgroup during the analysis? it shouldn\u2019t matter, with or without outgroup. This is only to print the treefile. - Do I get reliable brlengths, shall I fix brlenghts from the tree I wanna use (see also above)? See above 3) can I do / does it make sense to do addition non-param. BS analyses: how the BS values are inferred for the constraint tree? All the bootstrap trees will obey the constraint. So if the constraint tree forces a particular split, then it will have 100% BS. I looked in tutorials & google groups but could not fnd an example for what I aim to do 4) can I use 1.6.8 or should i use an earlier version? Please use 1.6.8. It is still the most stable version. I think few recently reported bugs are just corner-case. Cheers Minh Thanks Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Minh, 3) can I do / does it make sense to do addition non-param. BS analyses: how the BS values are inferred for the constraint tree? All the bootstrap trees will obey the constraint. So if the constraint tree forces a particular split, then it will have 100% BS. I am not sure, if this response is actually correct. Let's say I have the following constraint tree topology: ((A,B),(C,D)) and let's say (A,B) and (C,D) have 100 % bootstrap support. Now I'm adding taxa E,F,G that are closely related to C and D and I get the following topology: ((A,B),((C,E),(D,F),G)). Now the split (C,D), albeit forced, is non-existent and the bootstrap support for the split (C,E),(D,F), which would be more or less equivalent, does not necessarily need to be 100, because the placement of E and F is not forced. We could have the following bootstrap tree for example: ((A,B),((C,E),(F,G),D)) in which (C,D) is still forced, but the addition of E,F,G has a different result than in the constraint tree search. I have observed this in my own constraint tree analyses. Apart from the nitpicking I have an actual question based on that distinction: We have generated a phylogenetic tree based on ~500 single copy genes from ~140 taxa, but have a maximum of 10 Sanger sequences for 160 additional taxa. What we would like to do is have a phylogeny that encompasses all ~300 taxa, so we have inferred a phylogenetic tree from the 500 gene supermatrix and used it as a constraint tree for the 10 gene supermatrix. We thought we could simply map the bootstrap support values for both the ~500 gene analyses and the 10 gene analysis on the tree with all 300 taxa. But that is actually not possible, since splits from the constraint tree (based on ~500 genes) do not necessarily exist in the tree based on 10 genes, due to the addition of more taxa. What would you suggest in this case? Two separate figures with the corresponding bootstrap values, or should I rather try adding the bootstrap values from the 500 gene tree search to the topology of the ten gene search. Two figures might look more or less redundant, while adding the bootstrap values feels very artificial to me. Best wishes, Thomas ", "Hi Thomas, On 10 Dec 2018, at 11:46 pm, Thomas Pauli < tpaul...@gmail.com > wrote: Dear Minh, 3) can I do / does it make sense to do addition non-param. BS analyses: how the BS values are inferred for the constraint tree? All the bootstrap trees will obey the constraint. So if the constraint tree forces a particular split, then it will have 100% BS. I am not sure, if this response is actually correct. Let's say I have the following constraint tree topology: ((A,B),(C,D)) and let's say (A,B) and (C,D) have 100 % bootstrap support. Now I'm adding taxa E,F,G that are closely related to C and D and I get the following topology: ((A,B),((C,E),(D,F),G)). Now the split (C,D), albeit forced, is non-existent and the bootstrap support for the split (C,E),(D,F), which would be more or less equivalent, does not necessarily need to be 100, because the placement of E and F is not forced. We could have the following bootstrap tree for example: ((A,B),((C,E),(F,G),D)) in which (C,D) is still forced, but the addition of E,F,G has a different result than in the constraint tree search. I have observed this in my own constraint tree analyses. That\u2019s right thanks. I forgot to mention that the 100% BS occurs for constrained search if all taxa in the corresponding clade appear in the constraint tree. Apart from the nitpicking I have an actual question based on that distinction: We have generated a phylogenetic tree based on ~500 single copy genes from ~140 taxa, but have a maximum of 10 Sanger sequences for 160 additional taxa. What we would like to do is have a phylogeny that encompasses all ~300 taxa, so we have inferred a phylogenetic tree from the 500 gene supermatrix and used it as a constraint tree for the 10 gene supermatrix. We thought we could simply map the bootstrap support values for both the ~500 gene analyses and the 10 gene analysis on the tree with all 300 taxa. But that is actually not possible, since splits from the constraint tree (based on ~500 genes) do not necessarily exist in the tree based on 10 genes, due to the addition of more taxa. What would you suggest in this case? Two separate figures with the corresponding bootstrap values, or should I rather try adding the bootstrap values from the 500 gene tree search to the topology of the ten gene search. Two figures might look more or less redundant, while adding the bootstrap values feels very artificial to me. You can use the brand new feature on concordance factor (see preprint https://doi.org/10.1101/487801 , which happens to work in this case because it can handle variable taxon sets between trees (the purpose is different but the machinery is the same). Let say you have a file boot.140, which contain bootstrap trees from 140-taxa. You also have an ML tree on 300-taxa with bootstrap supports already, called ml.300. Simply run iqtree -t ml.300 --gcf boot.140 when working with bootstrap trees, then concordance factor = bootstrap supports. Note that you need to use 1.7-beta6 version for this run. Cheers Minh Best wishes, Thomas ", "Many thanks for your response Minh, I will try out the concordance factor mapping. Best wishes, Thomas "]}, "81PJzJaxBT4": {"topic": "Concordance Factors: input file format not recognized", "initializeDate": "Jan 9, 2019, 2:08:58 AM", "timeStamp": "Jan 27, 2021, 11:55:05 PM", "content": ["Hi Binh, I was excited to try the new option for calculating concordance factors and downloaded 1.7-beta7-MacOSX. I was running a test to see how it would go to start with single locus alignments and used -p ALN_DIR --prefix concat -bb 1000 -nt 4 . There were two issues. First there were only 3 files in the directory but iqtree seemed to detect 4. Second, I received an error message indicating the sequence format was unknown. This happened three times with three different formats: fasta, full nexus, simplified nexus. The text from the log file pasted in below: IQ-TREE multicore version 1.7-beta7 for Mac OS X 64-bit built Dec 18 2018 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: beliskner-be (AVX2, FMA3, 8 GB RAM) Command: ./iqtree -p ALN_DIR --prefix -bb 1000 -nt 2 Seed: 986462 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Jan 9 17:48:07 2019 Kernel: AVX+FMA - 2 threads (4 CPU cores detected) Reading 4 alignment files in directory ALN_DIR Reading alignment file ALN_DIR/.DS_Store ... ERROR: Unknown sequence format, please use PHYLIP, FASTA, CLUSTAL, MSF, or NEXUS format It seemed to be reading the directory as the first file? Test analyses with example files were working fine. Thanks for any suggestions! Cheers, Sarah ", "Hi Sarah, .DS_Score is a hidden index file in Mac OS, which is generated for all indexed folders. Please simply remove this file from the folder. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi, I tried to run the -p and -S commands to infer the concordance factor. As Sarah posted, I had the same problem with the .DS_Score file, so I deleted it. However, when I tried to run each command again, a log file was created... and I had a similar problem because iqtree is reading this new log file as one of my alignments, so it is not working yet. Do you know how can I fix this? Thanks!! Giovani Command: /Applications/iqtree-2.1.2-MacOSX/bin/iqtree2 -S /Users/giovani/Desktop/mult/nex --prefix loci -T AUTO Seed: 483317 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Tue Jan 26 15:13:23 2021 Kernel: AVX+FMA - auto-detect threads (16 CPU cores detected) Reading 11 alignment files in directory /Users/giovani/Desktop/mult/nex Reading alignment file /Users/giovani/Desktop/mult/nex/loci.log ... ERROR: Unknown sequence format, please use PHYLIP, FASTA, CLUSTAL, MSF, or NEXUS format ", "Are you running IQ-TREE from the same folder that stores the alignment files? If so, simply change the current directory before running IQ-TREE. This will avoid loci.log being written in that folder. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ca85efcc-37e3-4dc0-a304-2579299a0a02n%40googlegroups.com ", "It worked! Thank you very much! "]}, "h63lNK7icmU": {"topic": "Format file for Combined analysis (DNA partitions + multistate morphology)", "initializeDate": "Aug 12, 2015, 2:44:23 PM", "timeStamp": "Aug 13, 2015, 5:03:04 AM", "content": ["Hello Minh, I\u00b4m trying to run a combined analysis, considering DNA partitions and (multistate) morphology. Using PartitionFinder (for DNA only), It gave me this result as the better partition strategy and models: Scheme Description in PartitionFinder format Scheme_step_1 = (16s) (Gene1_pos1) (Gene1_pos2) (Gene1_pos3, Gene2_pos3) (Gene2_pos1) (Gene2_pos2); RaxML-style partition definitions DNA, p1 = 1-404 DNA, p2 = 405-1037\\3 DNA, p3 = 406-1037\\3 DNA, p4 = 407-1037\\3, 1040-1403\\3 DNA, p5 = 1038-1403\\3 DNA, p6 = 1039-1403\\3 MULTI, p7 = 1404-1435 After that, I \"added\" the morphology dataset (p7) to my matrix. The selected models were for DNA (p1 to p6) DNA, p1 = K81uf+I+G DNA, p2 = TrNef+G DNA, p3 = HKY+I DNA, p4 = K81uf+G DNA, p5 = TrNef+I DNA, p6 = JC MULTI, p7 = MK In this case, I added the Mk model for morphology. My question is if I can run this analysis in IQTREE. Using the Nexus file format, I am not sure if this style would work (and how to add the respected models for every partition, in GARLI it didn\u00b4t work). #nexus BEGIN SETS; CHARSET 16s = 1-404; CHARSET coi_1 = 405-1037\\3; CHARSET coi_2 = 406-1037\\3; CHARSET coi_3 = 407-1037\\3; CHARSET coii_1 = 1038-1403\\3; CHARSET coii_2 = 1039-1403\\3; CHARSET coii_3 = 1040-1403\\3; CHARSET morfo = 1404-1436; charpartition pfinder = chunk1:16s, chunk2:coi_1, chunk3:coi_2, chunk4:coi_3 coii_3, chunk5:coii_1, chunk6:coii_2, chunk7:morfo; END; Thanks in advance, max maronna ", "Dear Max, Right now IQ-Tree does not support an alignment file that contain mixed data type (DNA & morphology in your case). However, IQ-Tree supports partitions coming from different alignment files if specified via Nexus file. Thus, you just need to put DNA data into one alignment (called dna.phy for now) and morphological data into another file (called morpho.phy for now). Then the partition file should look like (modified from yours): #nexus BEGIN SETS; CHARSET 16s = dna.phy: 1-404; CHARSET coi_1 = dna.phy: 405-1037\\3; CHARSET coi_2 = dna.phy: 406-1037\\3; CHARSET coi_3 = dna.phy: 407-1037\\3; CHARSET coii_1 = dna.phy: 1038-1403\\3; CHARSET coii_2 = dna.phy: 1039-1403\\3; CHARSET coii_3 = dna.phy: 1040-1403\\3; CHARSET morfo = morpho.phy: 1-33; [NOTE THAT POSITION RANGE IS ADAPTED HERE] charpartition pfinder = K81uf+I+G:16s, TrNef+G:coi_1, HKY+I:coi_2, K81uf+G:coi_3 coii_3, TrNef+I:coii_1, JC:coii_2, MK:morfo; [NOTE THAT MODEL NAMES ARE SPECIFIED in charpartition command] END; Then simply run IQ-Tree with this partition file and you don\u2019t need to specify alignment file (-s option) because the alignment file names are already embedded in the partition file. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at "]}, "02V7khZsEmY": {"topic": "Error when model testing with amino-acid exchange rate matrix and protein mixture models", "initializeDate": "May 22, 2019, 5:24:56 AM", "timeStamp": "May 22, 2019, 8:34:14 PM", "content": ["I run IQTREE 1.6.7 as follows: iqtree s $ InputAlignment nt $ SLURM_CPUS_PER_TASK spp $ PartitioningScheme mset LG WAG DCMUT JTT BLOSUM62 WAG DCMUT JTT BLOSUM62 LG4X m TESTMERGE rcluster max 2000 rcluster alrt 1000 1000 bnni pre $ SLURM_JOB_NAME which gives me following error: ERROR: ratefree.cpp:537: double RateFree::optimizeWithEM(): Assertion `score > old_score-0.1' failed. The same error returns also iqtree s $ InputAlignment nt $ SLURM_CPUS_PER_TASK spp $ PartitioningScheme mset BLOSUM62 LG4X m TESTMERGE rcluster max 2000 rcluster alrt 1000 1000 bnni pre $ SLURM_JOB_NAME But either iqtree s $ InputAlignment nt $ SLURM_CPUS_PER_TASK spp $ PartitioningScheme mset LG WAG DCMUT JTT BLOSUM62 WAG DCMUT JTT BLOSUM62 m TESTMERGE rcluster max 2000 rcluster alrt 1000 1000 bnni pre $ SLURM_JOB_NAME iqtree s $ InputAlignment nt $ SLURM_CPUS_PER_TASK spp $ PartitioningScheme m LG4X alrt 1000 1000 bnni pre $ SLURM_JOB_NAME runs without problem. I'd be thankful for any hints how to run IQTREE with selecting models from a list which includes both amino-acid exchange rate matrices and protein mixture models. ", "Hi Ales, The problem is that -mset option is supposed to only specify base substitution models, e.g.: -mset LG,WAG,\u2026 especially LG4X should not be included here. In your case, please change -mset to: -mset LG,WAG,DCMUT,JTT,BLOSUM62 And add two options: -mrate G -madd LG4X to only consider +G and also add LG4X model. Btw I don\u2019t why you want BLOSUM62 model: it is not an evolutionary model and mainly used with sequence alignment / database search. Therefore I recommend to exclude that model. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/63930470-56c2-47e1-b24b-636c8b9bf0c0%40googlegroups.com For more options, visit https://groups.google.com/d/optout "]}, "Ga0vPHKBkPs": {"topic": "Irregular support until end of July", "initializeDate": "Jul 10, 2018, 10:59:21 AM", "timeStamp": "Jul 10, 2018, 10:59:21 AM", "content": ["Dear users, I\u2019m travelling until the end of July. So please expect delay in answering your questions etc. till then. Thanks for your patience, Minh "]}, "-RmbvDOPNvM": {"topic": "Site-specific rates of evolution (-wsr option) and distribution of rates?", "initializeDate": "Sep 21, 2018, 3:31:44 PM", "timeStamp": "Sep 22, 2018, 5:59:18 AM", "content": ["Hi, I ran IQ-tree with the -wsr \"write site rates\" option, freerate model of evolution with 8 categories of rates, on a small set of Bat mitocjhondrial COI genes (alignment attached). In the output file, the relative rates of the categories (see below) ranged from 0.001884 for the invariant sites to 4.317 for the most highly variable sites, and the distribution of rates seemed fairly even with slightly more sites in the extreme categories (20% invariant, 14.7% most high rate) than in the middle categories (17% in rate 2, 13.4% in rate 3, etc). However, when I looked in the site-rates file to see which sites were \"fast\" and \"slow\" I instead found almost all the sites were either rate 1 or 7 and 8 and almost none of the sites were in rate bins 2 through 6. When I look more closely at the site-rates file, I see that there are indeed many sites with rates such as 0.05 which should thus be in the rate 4 bin but the output listed it as rate 1 with categorized rate of 0.0001884 So, it looks to me as though something has gone wrong here. =================. Run results ======== SEQUENCE ALIGNMENT ------------------ Input data: 80 sequences with 656 nucleotide sites Number of constant sites: 422 (= 64.3293% of all sites) Number of invariant (constant or ambiguous constant) sites: 422 (= 64.3293% of all sites) Number of distinct site patterns: 263 SUBSTITUTION PROCESS -------------------- Model of substitution: GTR+R8 Rate parameter R: A-C: 1.9131 A-G: 35.6992 A-T: 1.0904 C-G: 0.1484 C-T: 24.9728 G-T: 1.0000 State frequencies: (estimated with maximum likelihood) pi(A) = 0.2874 pi(C) = 0.2793 pi(G) = 0.1337 pi(T) = 0.2996 Rate matrix Q: A -0.7504 0.07115 0.6357 0.04351 C 0.07323 -1.072 0.002642 0.9964 G 1.367 0.005518 -1.412 0.0399 T 0.04174 0.9287 0.01781 -0.9883 Model of rate heterogeneity: FreeRate with 8 categories Site proportion and rates: (0.2041,0.001884) (0.1695,0.008243) (0.1343,0.02194) (0.09727,0.05545) (0.05605,0.1966) (0.07758,1.622) (0.1136,1.899) (0.1476,4.317) Category Relative_rate Proportion 1 0.001884 0.2041 2 0.008243 0.1695 3 0.02194 0.1343 4 0.05545 0.09727 5 0.1966 0.05605 6 1.622 0.07758 7 1.899 0.1136 8 4.317 0.1476 ... ==== ======= site rates file sample ======= ... 2.05038 1.89887 0.58063 0.1966 0.03647 0.00188 1.97291 1.89887 0.10436 0.00188 0.06375 0.00188 2.98899 4.31721 0.03647 0.00188 1.15635 1.89887 3.4261 4.31721 0.03647 0.00188 0.03647 0.00188 1.58139 1.89887 0.10436 0.00188 0.05538 0.00188 2.94116 4.31721 0.03647 0.00188 0.05538 0.00188 0.10436 0.00188 0.05538 0.00188 0.06375 0.00188 3.97554 4.31721 0.10436 0.00188 0.03647 0.00188 1.07511 1.89887 3.02868 4.31721 0.06375 0.00188 2.94838 4.31721 1.01747 1.89887 0.06375 0.00188 ... ====== ", "Hi Brian, This is because the posterior mean (PM; 2nd column of .rate file) estimates might be quite different from maximum a posteriori (MAP; 3rd and 4th columns of .rate file) estimate. To explain, let r_1 to r_8 the category rates (or the Relative_rates column you pasted). Using empirical Bayes, one can estimate the probability of each site i belonging each rate category j, say p_ij (not shown here). The PM rate for site i is then defined as: PM(i) = sum(r_j * p_ij) over j=1..8 Whereas the MAP rate is: MAP(i) = r_k where p_ik is the maximum over p_ij (j=1..8) In the most extreme case, where p_ij is uniform over j, then you can\u2019t determine MAP(i) and IQ-TREE just reported category 1. In less extreme case, but there are two maxima, say, p_i1 = p_i3, then again MAP can\u2019t be determine. In case p_ij are all different, but the maximum is only slightly >1/8, then MAP estimate is not stable. I think this is exactly what happened here for your alignment. In short, I would trust the PM estimate much more than MAP. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <Kerivoula_COI_IQtreePDF.pdf> <Kerivoula_COI_BLASTAligned.FASTA> <Kerivoula_COI_IQtreeSiteRates.txt> ", "Thanks Minh! I was assuming (without reading the documentation, sorry) that the rates were determined by observed state changes in each column of the alignment, given the tree, and then each site would be assigned to the rate bin closest to its observed rate. For most data sets I have looked at, this seemed to be the case, I have never before spotted any sites where the rate bin assigned was not the same as I would have thought it would be assigned to. Just \"eyeballling\" this data set, it looks pretty normal. It is only after seeing the 117118118118118 pattern in the rates that the extreme selection pressure jumps out. "]}, "aSIhmwa3SDw": {"topic": "Segmentation fault on 40 Mb alignment file", "initializeDate": "Aug 16, 2017, 12:55:48 PM", "timeStamp": "Aug 16, 2017, 7:00:19 PM", "content": ["Dear IQTree Team, I have a 40 Mb long alignment file, which gives me a \"Segmentation Fault\" error message when I try to run it in IQTree. When I cut the alignment up into chunks of 10 Mb, it runs perfectly. What could be the problem? Is my alignment too long, perhaps? Thank you for your help, Reka ", "Dear Reka, I think this is the same bug that another user (Rika) reported yesterday. Nevertheless can you pls send me the alignment via personal email? Moreover, in the mean time can you pls rerun with option -t PARS? And let me know how it goes. Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <CompleteMice.fa.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "_QRNZ9M4slA": {"topic": "what is the difference between .contree and .treefile? which one should I choose?", "initializeDate": "Apr 21, 2019, 10:38:29 PM", "timeStamp": "May 29, 2020, 2:51:01 AM", "content": ["what is the difference between .contree and .treefile? which one should I choose? when i draw ml tree. ", "Dear Guoqing, Thank you for your interest in IQ-Tree. > what is the difference between .contree and .treefile? which one should I choose? when i draw ml tree. If you do an ML-search including ultrafast-bootstrapping, than both files are created. The treefile contains the best tree found by ML with the UFboot support values added. The contree-file contains the consensus tree constructed from all UFboot trees (with the respective UFboot support values). Thus, you get both files. (You find more details also in the documentation.) Best regards, Heiko Schmidt ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) Campus Vienna Biocenter 5 (VBC5) A-1030 Vienna, Austria ----------------------------------------------------------------------------- Email: heiko.schmidt(AT) univie.ac.at Tel. : ++43 +1 / 4277 - 74321 http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "I wanted to ask a followup question to this. In an analysis using only ultrafast bootstrap in addition to standard tree search, the .contree file includes a single integer support number that is apparently the percentage support from UFBoot. The .treefile file on the other hand includes more than a single number. It instead appears to have two different numbers, one of which is a 0-1.0 decimal value while the other, separated by a forward-slash, is an integer value. From comparison it appears that the second, integer, value corresponds to the values in the consensus tree file. What are the additional decimal values present in the ML tree file? It is not mentioned in the narrative description in the .iqtree output file or in the documentation as far as I can tell. ", "Hi Jonathan, Can you please paste the command line used? Then we may be able to answer your question. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d5df5ee8-083b-4ea8-960d-b1523a9848d1%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "I used the following, with different names for the input alignment, tree, and output prefix. Perhaps this is related to the use of an input tree? iqtree -m LG+R10 -s input.faln -t input.nwk -nt 2 -bb 1000 -nm 25000 -pre output In the .iqtree output the first (ML) tree notes: Numbers in parentheses are ultrafast bootstrap support (%) but the support values look like (0.999/98) (0.824/14) (0.149/100) On the second tree output (consensus) it describes them the same way, but the support values look like (98) (14) (100) The Newick output for the first tree contains support values like )0.999/98: while in the second, consensus tree they look like )98: Thank you for your help, Jonathan Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Jonathan, Yes, these values were taken from the tree file input.nwk. IQ-TREE was trying to preserve those values for nodes that occur in both input tree and the final ML tree. So that\u2019s a feature. Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/96c292eb-25d7-473e-830e-c03d5d4f674f%40googlegroups.com ", "I have a similar question re .contree and .treefile (created using the following command: iqtree -s infile.txt -bb 1000 -bnni -alrt 1000 -bcor 0.99 -st AA -m LG+I+G4+F -pre output -nt AUTO) Only the .treefile contains both the SH-aLRT values and UF bootstrap values, while .contree contains UF bootstrap values only. Is it possible to transfer the SH-aLRT values to the . contree file, for those splits that are identical? If not, which tree should I use for further analyis/consider as the final tree: the best ML tree (.treefile) or the consensus tree? Thank you very much in advance! Wannes Op woensdag 3 juli 2019 01:30:21 UTC+2 schreef Minh Bui: Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree ", "Hi Wannes, The point why IQ-TREE doesn\u2019t compute SH-aLRT on the contree (consensus tree) is because this tree might be multifurcating, and this test only works on strictly bifurcating trees. However if the contree is indeed bifurcating, then you can do a 2nd run to compute SH-aLRT values on this tree with -te option, e.g.: iqtree -s infile.txt -te CONTREE_FILE -alrt 1000 -m LG+I+G4+F -pre alrt_output -nt AUTO Note here that these support values are now appended after the UFBoot values. Cheers Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d949552a-14f2-40f1-a490-b30355948d9c%40googlegroups.com ", "Hi Minh Bui Thank you for the clarification. THat worked! Op woensdag 6 mei 2020 03:26:48 UTC+2 schreef Minh Bui: To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "Vp6H5Xua4MY": {"topic": "SH-alrt runs only single core", "initializeDate": "Jan 10, 2018, 3:31:35 PM", "timeStamp": "Jan 11, 2018, 11:02:32 AM", "content": ["Hi, I am using the pre compiled binary on an ubuntu16.04 linux. I calculate SH-Alrt for a given tree topology (added using -te) and a large phylogenomic alignment file. After model optimization which runs on 90 cpu cores without problems, the SH calculation runs only on a single thread (every x minutes it goes up to 90 threads for a second then goes on single threaded). Is this behaviour normal? Best wishes, Heiner ", "Hi Heiner, Very good point! The SH-aLRT was not parallelized yet. Except that from time to time during this test, the log-likelihood of the NNI trees are computed and only this part is parallelized. Initially I did not think about parallelizing the whole SH-aLRT computation because this test is so quick. But as soon as you specify many replicates and the alignment has many sites, then this is becoming bottleneck. I guess this is your case and that\u2019s why you observed this behavior. I will create a TODO with improvement tag for the next update of the software. Thanks for pointing this out, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "uChQqErQBD8": {"topic": "format for protein mixture models", "initializeDate": "Dec 6, 2018, 10:54:35 PM", "timeStamp": "Dec 11, 2018, 2:15:37 PM", "content": ["I was looking at the \"models.nex\" file included with the IQ-TREE download and wanted to make sure I understood the format. For the CAT-C10 model you list the amino acid frequency profiles and then have the following: model C10 = POISSON+G4+FMIX{C10pi1:1:0.1191344178,C10pi2:1:0.0874372456,C10pi3:1:0.1037105070,C10pi4:1:0.0922584809,C10pi5:1:0.1070492801,C10pi6:1:0.1329945166,C10pi7:1:0.0538028458,C10pi8:1:0.0691986212,C10pi9:1:0.1319937434,C10pi10:1:0.1024203429}; model C10Opt = POISSON+G4+FMIX{C10pi1,C10pi2,C10pi3,C10pi4,C10pi5,C10pi6,C10pi7,C10pi8,C10pi9,C10pi10}; For the first line (C10) each frequency profile is followed by two numbers -- e.g., C10pi1:1:0.1191344178 Is the first number the expected rate and the second the probability of each frequency profile? Also, if there is a single number after the frequency profile (e.g., like {C10pi1:0.5,C10pi2:1.2,C10pi3:0.75, etc. ... } ) would the numbers be the expected rate or the probabilities (if the latter, I assume that all numbers would have to sum to 1 so the numbers in my example presumably wouldn't work) If the single number is the expected rate, is it possible to constrain the prior probability but estimate the rate by ML? I hope that I haven't missed anything obvious - apologies if I have. ", "Hi Ed, On 7 Dec 2018, at 2:54 pm, Edward Braun < ebra...@gmail.com > wrote: I was looking at the \"models.nex\" file included with the IQ-TREE download and wanted to make sure I understood the format. For the CAT-C10 model you list the amino acid frequency profiles and then have the following: model C10 = POISSON+G4+FMIX{C10pi1:1:0.1191344178,C10pi2:1:0.0874372456,C10pi3:1:0.1037105070,C10pi4:1:0.0922584809,C10pi5:1:0.1070492801,C10pi6:1:0.1329945166,C10pi7:1:0.0538028458,C10pi8:1:0.0691986212,C10pi9:1:0.1319937434,C10pi10:1:0.1024203429}; model C10Opt = POISSON+G4+FMIX{C10pi1,C10pi2,C10pi3,C10pi4,C10pi5,C10pi6,C10pi7,C10pi8,C10pi9,C10pi10}; For the first line (C10) each frequency profile is followed by two numbers -- e.g., C10pi1:1:0.1191344178 Is the first number the expected rate and the second the probability of each frequency profile? Yes, correct! In this particular case, all mixture components have the same rate. The \u201cprobability\u201d is also called mixture weights. Also, if there is a single number after the frequency profile (e.g., like {C10pi1:0.5,C10pi2:1.2,C10pi3:0.75, etc. ... } ) would the numbers be the expected rate or the probabilities (if the latter, I assume that all numbers would have to sum to 1 so the numbers in my example presumably wouldn't work) If there is a single number, then it\u2019s interpreted as rate. And IQ-TREE will automatically estimate the weights. If the single number is the expected rate, is it possible to constrain the prior probability but estimate the rate by ML? Yes, you can use *R syntax (it is same as free-rate model). For example, \u201cC10*R\u201d. Minh I hope that I haven't missed anything obvious - apologies if I have. Not at all, this is not explained anywhere. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Minh, Thanks for the clarification! I presume the same is true for mixtures of matrices - e.g., for the EX_EHO example: model EX_EHO = MIX{BUR_EXT:0.761816796788931,BUR_HEL:0.744425646802117,BUR_OTH:0.532457759429489,EXP_EXT:1.5639387472863,EXP_HEL:2.06403411829438,EXP_OTH:1.43336795177594}; In this case the numbers in are rates whereas, in this case, the mixture weights are omitted so they are estimated by ML. Is there a way to estimate rates but constrain mixture weights? (e.g., maybe if you had four components you could constrain each to be 0.25) "]}, "pewtlCFZIRo": {"topic": "IQ-tree fails when building phylogeny with constraint tree file", "initializeDate": "Sep 7, 2017, 2:53:03 PM", "timeStamp": "Sep 8, 2017, 9:11:00 AM", "content": ["Can someone help. I'm trying to do a phylogeny with a contraint tree, but it keeps failing due to a bug. ", "Dear Christian, The problem is this option: -o Cleptes_seoulensis,Sclerogibba_sp.,Chrysis_cembricola,Chrysis_principalis -o option will accept only one outgroup taxon and not a list of taxa. Thus please pick up one of these taxa for -o option. This is just for drawing purpose and you can re-root the tree in any tree viewer program. I admit however that IQ-TREE aborted like this, but should rather print informative error message. So thanks for reporting it! Cheers, Minh On Sep 7, 2017, at 8:53 PM, Christian Millan < c.mill...@gmail.com > wrote: Can someone help. I'm trying to do a phylogeny with a contraint tree, but it keeps failing due to a bug. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <Dry_28S_5.0READY.fasta> <Dry_28S_5.0READY.fasta.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thank you so much!!!!! "]}, "z60TeJI7pas": {"topic": "BUG: Mixed models IQtree  2.0-rc1", "initializeDate": "Mar 4, 2020, 5:28:46 PM", "timeStamp": "Mar 4, 2020, 6:45:00 PM", "content": ["One friend of mine, just send me a set of data including AA and DNA, and she ask me about Error 9 I tried the same set of data and I got exactly the same error after several minutes without echoing anything. Subset Type Seqs Sites Infor Invar Model Name DNA 128 1553 502 850 GTR+F+R5 part1 1551 684 697 LG+F+R8 part2 Degree of missing data: 0.129 Info: multi-threading strategy over alignment sites Killed: 9 Then I use the older version because I knew this mixed partition should work, and it worked flawlessly with the -spp (-p in the newer version) using the same nexus file she send me. #nexus begin sets; charset part1 = 16S_128.phy : 1-1553; charset part2 = rpoB_aa_95.phy : 1-1551; charpartition mine = GTR+F+R5:part1, LG+F+R8:part2; end; It seems like a bug to me, but I might be wrong. I also tried -spp in different partition approaches (specifying AA and DNA, *), even without partition file using -p to the directory and I got at least 10 times the same error. This never happened before in version 1.6.12 ", "She actually post a question https://groups.google.com/d/topic/iqtree/LYhF3oxafto/discussion , but so far the problem is only happening in the newest version. "]}, "uBRjxhd3eQ4": {"topic": "Tree topology p-values", "initializeDate": "Nov 21, 2017, 3:00:46 PM", "timeStamp": "Nov 29, 2017, 10:44:57 AM", "content": ["I used IQ-tree for topology incongruence test and got the following result: The p-value for all of the test except ELW, bp-RELL is greater than 0.05. If I focus particularly at the p-value of AU test, it's higher than 0.05 so I can not reject the null hypothesis that all trees are equally good explanation of data. My very basic question (perhaps stupid) is that why there are two p-values for each test? Since it's comparison between two topologies, shouldn't there be one p-value for each test indicating if it's significantly different or not? Could you please help me with an answer? Thank you! ", "Dear Bikash Shrestha, Thank you for your interest in IQ-Tree and testing trees. > I used IQ-tree for topology incongruence test and got the following result: > The p-value for all of the test except ELW, bp-RELL In fact, ELW and bp-RELL do not provide p-values. Here likelihoods are used in ELW to compute weights (which add to to 1.0 over all trees) or the bootstrap proportions in bp-RELL how often each tree is best for one of many RELL-bootstrap samples (which add to to 1.0 over all trees). The ones with high weights/proportions are assumed to be the best supported by the data, and the confidence set is build by collecting trees with decreasing weights/proportions until their cumulative sum hits 0.95. > is greater than 0.05. If I focus particularly at the p-value of AU test, it's higher than 0.05 so I can not reject the null hypothesis that all trees are equally good explanation of data. \u2026based on their likelihood. > My very basic question (perhaps stupid) is that why there are two p-values for each test? Since it's comparison between two topologies, shouldn't there be one p-value for each test indicating if it's significantly different or not? There IS a p-value telling you for each tree in the tested treeset wether that tree is significantly worse/different/etc (depending on the test\u2019s Null hypothesis of the respective test). If all p-values are above the chosen cut-off value (typically 0.05), this means that no tree can be discarded. Or the other way around none of the trees can be preferred over the other, even if one has a higher likelihood. It is of course not the aim of the test to find a tree (or some) which significantly worse, but to tell you IF there are any worse trees (i.e. not meeting the Null hypothesis for most test) and if so which ones. It is, however, not very meaningful to do most of the tests with just two trees. SH and AU are tests designed operate on sets of tree. And SH actually requires that THE maximum likelihood tree is among the tested trees. So it is very important to also keep the Null hypotheses tested and the requirements in mind, because they differ between the tests: (a) The Kishino-Hasegawa test (KH) was designed to test whether likelihood are significantly different, without any knowledge which of the trees is the better one. Thus, the Null (H0) and alternative hypothesis (HA) are: - H0: The two trees are equally supported by the likelihood, i.e. the expected difference between the likelihoods is 0 - HA: The two trees are not supported equally, i.e. the expected difference between the likelihoods is not 0 This means it just tests for difference, i.e. it is a 2-sided test. However, since often KH was (and is) used to test whether the likelihood of a tree is significantly worse than that of the best tree found. In this case the 2-sided approach is not a valid option to use. The only way to use KH in such a situation is to implement it as a 1-sided test, which is the one implemented in IQ-TREE: (b) The single sided Kishino-Hasegawa test (KH) has the following the Null (H0) and alternative hypothesis (HA): - H0: The two trees are equally supported by the likelihood, i.e. the expected difference between the likelihoods is 0 - HA: The 2nd tree has a worse support, i.e. the expected difference between the likelihoods (L(ML)-L(2)) is larger than 0. Note: This does not test whether the assumption 0 difference of the Null hypothesis is in anyway correct. (c) The Shimodaira-Hasegawa test (SH) is a proper test for sets of trees with more than 2 trees, and has the following the Null (H0) and alternative hypothesis (HA): - H0: All tested trees Tx of the treeset (including the ML tree!) are equally good explanations of the data. - HA: Some or all trees Tx of the treeset are not equally good explanations of the data. Note: - THE maximum likelihood tree is required among the tested trees. If it is not, the test tells you whether and which trees are significantly worse, but that does not mean that the best tree in the set is any close to being any good or correct. - A problem of this test is that number of trees selected in the SH test as not being significantly worse is strongly correlated with the number of trees in the treeset tested. That means, the more tree topologies are included in the test, the more trees are accepted. This is attributed to a selection bias. - Furthermore, in the case that you test just 2 trees with SH it basically does perform a KH test. (d) The approximately unbiased test (AU) tests the following: H0(Ta): the expected likelihood value of tree Ta is larger or equal to the expected likelihood values for all trees Tx in the treeset. HA(Ta): the expected likelihood value of tree Ta is smaller\u2026 Note: If many of the best trees in your treeset have almost equal likelihoods, you may gain an over-confidence into the wrong tree(s). For further information I suggest reading the chapter \u201cTesting Tree Topologies\u201d from \u201cThe Phylogenetic Handbook\u201d (Lemey et al. 2009). It aims at being more comprehensible than the original papers. > Could you please help me with an answer? I hope the above helped a little. Best wishes, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) Campus Vienna Biocenter 5 (VBC5) A-1030 Vienna, Austria ----------------------------------------------------------------------------- "]}, "ejWk6lm8Lk8": {"topic": "Missing bootstrap values", "initializeDate": "Mar 4, 2021, 4:54:07 PM", "timeStamp": "Mar 14, 2021, 9:29:05 PM", "content": ["Hello, I am using IQtree2.1.2-linux. I did a run using 18 strains of the same species with 1 outgroup strain. So 19 genomes total. I did the run using the command below. bin/iqtree2 -p \"Cpse_1390_C90\" --prefix Cpse_withOutgroup -alrt 1000 -B 1000 -T 16 -o (outgroup) The issue I am having is there is no bootstrap value at the node where the outgroup clades away and then also at the first node where my species of interest clades apart there is no bootstrap value. I am using the .contree file to visualize the tree. I also tried running the same code without defining the outgroup to see if that would fix the problem but it did not. Best, Tommy Tran ", "Hi Tommy, This looks like a tree viewing problem. Which tree viewer software are using? If you are sure that the tree viewer works fine, please paste the content of this tree file here, and I can have a look. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ce00f0df-5553-48a5-b019-806063ecc05fn%40googlegroups.com ", "I am using iTol. Below is the content of the .contree files (((((1:0.0077118753,(24:0.0040828171,29:0.0084324356)100:0.0032396918)100:0.0037660937,(3:0.0117773125,(21:0.0028495200,26:0.0028405714)100:0.0060654211)54:0.0012952358)54:0.0005265022,((((4:0.0057142938,6:0.0074357946)100:0.0018911489,(7:0.0004229426,17:0.0004636728)100:0.0053900040)100:0.0041043477,(12:0.0106423566,(15:0.0004861450,19:0.0003728784)100:0.0104707175)100:0.0025580991)91:0.0005788193,(((5:0.0085199366,(16:0.0011284369,28:0.0015456934)100:0.0080870666)100:0.0018832187,((8:0.0101734341,13:0.0080345678)100:0.0049229277,(18:0.0089931491,((20:0.0052842402,22:0.0040094857)100:0.0020481638,27:0.0048932175)100:0.0041251294)100:0.0020525078)100:0.0007628816)99:0.0006792354,23:0.0111398863)91:0.0006854477)100:0.0021682742)100:0.0038026906,25:0.0087424802)100:0.0269528701,2:4.2138595137,(((9:0.0005750658,10:0.0005939867)100:0.0026126252,14:0.0000420623)100:0.0105194365,11:0.0190223562)100:0.0296854579); Here is another tree I created where multiple bootstrap values are missing when I view it through iTol. (((((1:0.0263733331,13:0.0229839377)100:0.0327247367,14:0.0476602965)99:0.0179300356,24:0.0535086626)100:0.0800695615,((3:0.0740837075,6:0.1006697272)100:0.0360538537,18:0.0991996185)100:0.0454330564)100:0.1241092174,2:2.1375003230,(((((((4:0.0016015955,((5:0.0065088496,17:0.0075158358)100:0.0250011444,19:0.0025745165)100:0.0012354029)100:0.0021518098,(8:0.0000564921,21:0.0000657240)64:0.0000020016)100:0.0176313327,(9:0.0000623489,(((10:0.0018015416,(12:0.0308755193,22:0.0021573160)100:0.0009052839)100:0.0004890832,16:0.0021727481)100:0.0014994484,15:0.0000643073)100:0.0000135508)100:0.0178716010)100:0.0098716204,11:0.0210336543)100:0.0186393509,23:0.0539543856)98:0.0120334360,20:0.0254937358)100:0.2358233123,7:0.2446143140)100:0.1227286311); Tommy ", "Ok, there is nothing wrong. The tree is unrooted and thus there is a tri-furcation at the root. No support value will be put onto the root branch. On a side note, your sequence \u201c2\u201d has a very long branch length. Something is wrong with it. Please check the alignment carefully. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c6f231ba-61ac-48e7-b76b-2886f0e5d367n%40googlegroups.com ", "Sequence \"2\" is our outgroup (it is a different species from the same genus). Could we use the outgroup to root the tree when doing the analysis through iqtree2? ", "Yes, outgroup is a common way used to root the tree. But it\u2019s not straight forward how. See e.g. the references we cited here: https://www.biorxiv.org/content/10.1101/2020.07.31.230144v1 In our specific case, I believe sequence 2 cannot be used. It\u2019s just too far away from the ingroup sequences. I would check the sequence alignment first and also for the homology of this sequence. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b627152c-4cfa-420d-9f80-5d45d8e6cc49n%40googlegroups.com "]}, "7Ac9jjgipJ0": {"topic": "Question about mixture models", "initializeDate": "Nov 12, 2019, 7:06:34 PM", "timeStamp": "Nov 20, 2019, 7:30:16 AM", "content": ["Hi Panos (I\u2019m answering to the IQ-TREE forum as your questions might be of general interest): On 12 Nov 2019, at 11:56 pm, Panagiotis Adam < panagio...@uni-due.de > wrote: Hi Minh, I\u2019ll have to consider the divergence dating issue a little bit. I had a couple of concerns about using mixture models today: 1) In protein mixture models, e.g. LG+C60, I guess adding a +G will split by default the gamma distributions of the (Quang, 2008) profiles into four categories each. Yes. Moreover, please note that LG+C60 (and other Cxx) already includes +G model. So no need to specify +G: LG+C60+G is effectively the same of LG+C60. Is it possible to go with +G8? Yes it is, just use \u201c-c 8\u201d option. How does iqtree behave if one tries +R?, If you do LG+C60+R, this will override default behaviour and change +G to +R model. As you can see from the log file: WARNING: Both Gamma and FreeRate models were specified, continue with FreeRate model 2) For GTR20+C60+G (imitating Phylobayes), would there be a conflict between GTR20 and a potential addition of +F? Since GTR20 is estimated from the data and there are technically no model-given equilibrium frequencies, does GTR20 imply an estimated +F or does the latter somehow supersede it? There are two things to note here: 1. GTR20+C60 will actually create 60 separate GTR20 models with unlinked parameters. Since each GTR20 component has 189 free parameters, this will create 60 * 189 parameters. Therefore, I don\u2019t recommend to use this model. 2. Dominik, an iqtree team member, will be able to fully answer your question. But he created a version that allows to link GTR20 model parameters across 60 components, which would dramatically reduce the parameterisation (to 189), see his preprint: https://doi.org/10.1101/794263 We are in the process of merging this version into the mainstream version and we will change the default behaviour to link the GTR20 model parameters. I\u2019ll let you know once this is done. Cheers, Minh Thanks again for all the help. Cheers, Panos ", "Hi Panos, Sorry for the delay, I was too busy with releasing iqtree version 2. Comments below: On 13 Nov 2019, at 11:07 am, Panagiotis Adam < panagio...@uni-due.de > wrote: Hi Minh, Thanks for your answer. If I may ask for some further (perhaps superfluous at this point) clarifications: 1) Unless I\u2019m mistaken, with a different number of categories the gamma distributions of the Cxx profiles are retained, right? That\u2019s right, the number of categories for +G and for Cxx are separate. Say, if you have +G4 and +C10, this would actually create a mixture model with 40 components. With +R are they calculated and optimized for scratch for every profile? I\u2019d expect this to highly increase computation time. Yes, +R model parameters will be optimised, which usually take much more time than +G model. 2) This is very enlightening and probably explains a very strange phylogeny I obtained while messing around with CTR20+C60+G. I see. That\u2019s why I don\u2019t recommend using this model, as currently implemented in IQ-TREE. Still, doesn\u2019t explain the part about the +F parameter. Ok. For example, if you specify LG+C60+F, it actually creates a mixture model with 61 components, all share the same AA exchangibility rate from the LG matrix. The first 60 components \u201cinherit\u201d the AA frequencies from C60 (Le et al 2008) and the 61th component has the +F (empirical) frequencies from the current data. Does that answer your question? Until the linked GTR20 is implemented, would it be viable to calculate an amino-acid GTR through RaxML and then import it into IQTree as a custom matrix? That\u2019s actually a good work around, but you can actually estimate GTR20 model parameters directly in IQ-TREE. So I recommend doing this 2 steps: 1. Perform a GTR20 non-mixture model: iqtree -s ALN_FILE -m GTR20+G \u2026 This will estimate GTR20 model paramters, which will be printed in .iqtree file. Look at this file and extract the rate matrix following this line: Substitution parameters (lower-diagonal) and state frequencies in PAML format (can be used as input for IQ-TREE): Copy and paste the matrix into a file called, say, my_Q. 2. Perform the mixture model using my_Q: iqtree -s ALN_FILE -m my_Q+C60+F This 2-step procedure will partly overcome this issue, because my_Q is linked between the mixtures. Hope that helps, Minh Cheers, Panos "]}, "WLU_lBpRqNs": {"topic": "Modelfinder error", "initializeDate": "Jun 14, 2017, 8:06:55 AM", "timeStamp": "Jun 15, 2017, 1:32:14 PM", "content": ["Hi, I am trying to use modelfinder on different alignments, and if some are working perfectly some stopped after several tested models: the log file start with: IQ-TREE multicore version 1.5.5 for Linux 64-bit built Jun 2 2017 Copyright (c) 2011-2017 by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, and Arndt von Haeseler. Host: ucenci-iqtree-men (SSE4.2, 10 GB RAM) Command: /home/ubuntu/software/iqtree-omp-1.5.5-Linux/bin/iqtree-omp -s file.phy -m MF -mset LG,C10,C20,C30,LG+C10,LG+C20,LG+C30 -cmax 10 -omp 1 -pre file.phy.best_model Seed: 250263 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Tue Jun 13 10:25:37 2017 Kernel: SSE2 - 1 threads (8 CPU cores detected) Reading alignment file file.phy ... Phylip format detected Alignment most likely contains protein sequences Alignment has 71 sequences with 171 columns and 169 patterns (155 informative sites) the log file end with: *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: file.phy *** Alignment files (if possible) I also send in private the alignment and the full log. I hope you could help me. Best, ", "Hi, Please change option \u201c-mset LG,C10\u2026\u201d to -mset LG -madd C10,C20,C30,LG+C10,LG+C20,LG+C30 I admit that this abort is rather odd. For future release we will print informative error message instead. However, I would discourage using complex models (C10, etc) because your alignment is rather short (only 171 columns), which has not enough information to reliably estimate model parameters. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thank you for this quick answer. However, with -madd, the test for the rates across sites model, is not performed on other model than LG, especially the freerate models could be particularly interesting. Thanks also for the advice about the use of C10... models, I have discussed this issue with Andrew Roger from Dalhousie, and he told me that I could use some of those, but probably I should not go to more than C20, however I wanted to perform the test with C30 to see, also some of my alignments have more than 500 columns so I thought I could increase to C30. Also, I didn't find an article that discuss the minimum size for the use of the C... models. So if you have an idea of paper I will gladly read it. ", "Hi again, On Jun 14, 2017, at 6:25 PM, Ugo Cenci < ugo.pier...@gmail.com > wrote: Thank you for this quick answer. However, with -madd, the test for the rates across sites model, is not performed on other model than LG, especially the freerate models could be particularly interesting. I see, then you can add \u201cLG+C10+R3,LG+C10+R4,\u2026\u201d to the -madd option. I know that is quite inconvenient \u2014 will need to think how to make this easier for users\u2026 Moreover, I would also recommend to add \u201c+F\u201d into these models. Thanks also for the advice about the use of C10... models, I have discussed this issue with Andrew Roger from Dalhousie, and he told me that I could use some of those, but probably I should not go to more than C20, however I wanted to perform the test with C30 to see, also some of my alignments have more than 500 columns so I thought I could increase to C30. It might be fine to use these CAT models for your other alignments with >500 columns. Such models are intended for multi-gene (phylogenomic) alignments to capture compositional heterogeneity across sites or genes. Your first alignment (<170 columns) looks like a single gene, that\u2019s why I don\u2019t recommend. Moreover, from your log file sent me privately, only 14 sequences out of 71 failed composition chi2 test (for the interpretation of this test see http://www.iqtree.org/doc/Frequently-Asked-Questions#what-is-the-purpose-of-composition-test ). So this is another evidence to discourage using CAT models. Also, I didn't find an article that discuss the minimum size for the use of the C... models. So if you have an idea of paper I will gladly read it. I don\u2019t know neither. This is only my own intuition. The bottom line is that complex models can be overfitting, thus one should be careful before using them. Cheers, Minh "]}, "ZsXim-QZIc8": {"topic": "Constraint not found/incorrect input", "initializeDate": "Jan 6, 2021, 2:21:26 PM", "timeStamp": "Jan 18, 2021, 8:57:22 AM", "content": ["Hi, Happy new year! I am trying to constrain a group of taxa to a single clade, on version 2.1.2. My constraint tree is defined like this: (a,b,c,d,e) Where a-e are the taxa I want lumped together. I have this saved as a Text Edit file. Unfortunately whenever I try to run the constrained search, iqtree -s <fasta> -g <n.constr> I get the following: Reading constraint tree... ERROR: File not found or incorrect input, pls check it again. I'm not sure why it's displaying this, as this command worked well up until now. I have tried other constraints (without luck) like ((a,b,c,d),e) and ((a,b),(c,d,e)) Is there a specific file/application the constraint needs to be saved to? Or a name? Many thanks in advance ", "Hi there, A semi-colon is missing at the end of the file. Adding it should solve the problem. Moreover, a constraint (a,b,c,d,e); won\u2019t actually do anything. Because a constraint tree does not enforce anything about other taxa not appearing in the constraint tree. So other taxa might still be in the group of these 5 taxa. It make sure that the resulting tree pruned to those taxa a,b,c,d,e will obey the constraint. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/bf334911-4cc1-4b13-aabd-d2953aff9561n%40googlegroups.com "]}, "QZq8u3WUCUI": {"topic": "Questions about the Tree topology tests", "initializeDate": "Jan 21, 2019, 12:56:39 AM", "timeStamp": "Jan 23, 2019, 10:31:43 AM", "content": ["Dear IQ-tree groups, I'm trying to use the Tree topology test in iqtree-1.6.8-Windows, and I have some questions that have been bothering me. Command I used: iqtree -s sequences.phy -m model -z trees.newick -n 0 -zb 10000 -zw -au 1\u3001This feature of Tree topology test only ML trees? or BI trees and MP trees can also test? The trees.newick file was generated by myself, and I concatenate ML, BI, MP tress into a file, because I want to test those tress. Is that right? 2\u3001After finished the program, the resulting file contains a .treefile file, and this treefile only contain one tree. I can't find any notes about this file in manual, so could you tell me what is the basis/theroy of the tree? Thank you in advance! Best, Qiang. ", "Hi Qiang, On 21 Jan 2019, at 12:56 pm, laiqia...@foxmail.com wrote: Dear IQ-tree groups, I'm trying to use the Tree topology test in iqtree-1.6.8-Windows, and I have some questions that have been bothering me. Command I used: iqtree -s sequences.phy -m model -z trees.newick -n 0 -zb 10000 -zw -au 1\u3001This feature of Tree topology test only ML trees? or BI trees and MP trees can also test? The trees.newick file was generated by myself, and I concatenate ML, BI, MP tress into a file, because I want to test those tress. Is that right? That\u2019s right, you can test any set of trees. Please only note that if you do partition models, please use version 1.6.9 which fixes a bug in v1.6.8 with AU test. Whereas this non-partition analysis should be fine. 2\u3001After finished the program, the resulting file contains a .treefile file, and this treefile only contain one tree. I can't find any notes about this file in manual, so could you tell me what is the basis/theroy of the tree? .treefile here only stores a parsimony tree used to estimate model parameters, from which to perform topology test. You can look at .trees file, which is equal to your input tree file (trees.newick) but branch lengths are re-estimated for the test. Cheers, Minh Thank you in advance! Best, Qiang. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Qiang, > On 22 Jan 2019, at 06:22, Minh Bui < minh...@univie.ac.at > wrote: [\u2026] >> On 21 Jan 2019, at 12:56 pm, laiqia...@foxmail.com wrote: [\u2026] >> 1\u3001This feature of Tree topology test only ML trees? or BI trees and MP trees can also test? The trees.newick file was generated by myself, and I concatenate ML, BI, MP tress into a file, because I want to test those tress. Is that right? > That\u2019s right, you can test any set of trees. [...] Only one additional comment about \u201cany set of trees\u201d. As pointed out in publications by Shimodaira and in the Tree Topology Testing chapter in the Phylogenetic Handbook, one should take care to not test a group of very good trees against few bad trees in the same set, because that can lead to an over-confidence for the good ones just because of their majority in the set, at the cost of maybe missing the true tree. Best regards, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Hi Minh, Thanks for you kindly reply. 1\u3001I have used version 1.6.9, and got a bug\uff0cthe bug report is as follows: Reading trees in ML_BI_MPtrees.newick ... terminate called after throwing an instance of 'std::ios_base::failure' what(): basic_ios::clear ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: Fab_73_18_nostr_Cer.nex.log ERROR: *** Alignment files (if possible) But this bug not appear on all data, just for some data, and others can run successfully. I have check the dataset, and didn't get any information. 2\u3001I test 3 trees (tree1, tree2, tree3) topology(test1), and the result shows that the AU test excluded tree2, and not reject the tree1 and tree3. The result .iqtree file is as follows: Tree logL deltaL bp-RELL p-KH p-SH p-WKH p-WSH c-ELW p-AU ---------------------------------------------------------------------------------------------------------------------------------------------- 1 -815611.8888 0 0.406 + 1 + 1 + 0.821 + 0.97 + 0.451 + 0.88 + 2 -815612.0755 0.18672 0.413 + 0 - 0.499 + 0 - 0 - 0.375 + 0.000237 - 3 -815629.1836 17.295 0.182 + 0.179 + 0.179 + 0.179 + 0.179 + 0.174 + 0.179 + To test this result, I only set the tree1 and tree2 in the same set (test2), and tree1 and tree3 in the same set (test3), and tree2 and tree3 in the same set (test4), I think that if the test1 is completely right, the test2 and test4 will also excluded tree2. But the result show that only the test2 excluded tree2, and test4 didn't reject the tree2. And this analysis confused me, I\u2019m not sure which result should be accepted. Can you help me to explain it? Best regards, Qiang \u5728 2019\u5e741\u670822\u65e5\u661f\u671f\u4e8c UTC+8\u4e0b\u53481:35:47\uff0cMinh Bui\u5199\u9053\uff1a ", "Hi Heiko, \u5728 2019\u5e741\u670822\u65e5\u661f\u671f\u4e8c UTC+8\u4e0b\u53486:00:41\uff0cHeiko\u5199\u9053\uff1a ", "Hi Qiang, On 23 Jan 2019, at 9:05 pm, laiqia...@foxmail.com wrote: Hi Heiko, Thanks for you kindly reply. 1\u3001I have used version 1.6.9, and got a bug\uff0cthe bug report is as follows: Reading trees in ML_BI_MPtrees.newick ... terminate called after throwing an instance of 'std::ios_base::failure' what(): basic_ios::clear ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: Fab_73_18_nostr_Cer.nex.log ERROR: *** Alignment files (if possible) But this bug not appear on all data, just for some data, and others can run successfully. I have check the dataset, and didn't get any information. From this error message I believe something is wrong with your input tree file... 2\u3001I test 3 trees (tree1, tree2, tree3) topology(test1), and the result shows that the AU test excluded tree2, and not reject the tree1 and tree3. The result .iqtree file is as follows: Tree logL deltaL bp-RELL p-KH p-SH p-WKH p-WSH c-ELW p-AU ---------------------------------------------------------------------------------------------------------------------------------------------- 1 -815611.8888 0 0.406 + 1 + 1 + 0.821 + 0.97 + 0.451 + 0.88 + 2 -815612.0755 0.18672 0.413 + 0 - 0.499 + 0 - 0 - 0.375 + 0.000237 - 3 -815629.1836 17.295 0.182 + 0.179 + 0.179 + 0.179 + 0.179 + 0.174 + 0.179 + tree2 is also rejected by other tests (e.g. WSH). Though I admit its logL is only slightly worse than tree1. I can run CONSEL to test this result again if you like. To test this result, I only set the tree1 and tree2 in the same set (test2), and tree1 and tree3 in the same set (test3), and tree2 and tree3 in the same set (test4), I think that if the test1 is completely right, the test2 and test4 will also excluded tree2. But the result show that only the test2 excluded tree2, and test4 didn't reject the tree2. And this analysis confused me, I\u2019m not sure which result should be accepted. Can you help me to explain it? Nothing wrong here: in test4, you only have tree2 and tree3, where tree2 has higher logL than tree3. So it\u2019s totally expected that tree2 is not rejected here. Along this line, I suggest that you always include the ML tree into topology test. Cheers, Minh Best regards, Qiang \u5728 2019\u5e741\u670822\u65e5\u661f\u671f\u4e8c UTC+8\u4e0b\u53486:00:41\uff0cHeiko\u5199\u9053\uff1a Dear Qiang, > On 22 Jan 2019, at 06:22, Minh Bui < minh...@univie.ac.at > wrote: [\u2026] >> On 21 Jan 2019, at 12:56 pm, laiqia...@foxmail.com wrote: [\u2026] >> 1\u3001This feature of Tree topology test only ML trees? or BI trees and MP trees can also test? The trees.newick file was generated by myself, and I concatenate ML, BI, MP tress into a file, because I want to test those tress. Is that right? > That\u2019s right, you can test any set of trees. [...] Only one additional comment about \u201cany set of trees\u201d. As pointed out in publications by Shimodaira and in the Tree Topology Testing chapter in the Phylogenetic Handbook, one should take care to not test a group of very good trees against few bad trees in the same set, because that can lead to an over-confidence for the good ones just because of their majority in the set, at the cost of maybe missing the true tree. Best regards, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Dear Qiang, dear Minh, > On 23 Jan 2019, at 14:22, Minh Bui < minh...@univie.ac.at > wrote: >> On 23 Jan 2019, at 9:05 pm, laiqia...@foxmail.com wrote: >> Thanks for you kindly reply. >> 1\u3001I have used version 1.6.9, and got a bug\uff0cthe bug report is as follows: >> Reading trees in ML_BI_MPtrees.newick ... >> terminate called after throwing an instance of 'std::ios_base::failure' >> what(): basic_ios::clear >> ERROR: >> ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED >> ERROR: *** For bug report please send to developers: >> ERROR: *** Log file: Fab_73_18_nostr_Cer.nex.log >> ERROR: *** Alignment files (if possible) >> But this bug not appear on all data, just for some data, and others can run successfully. I have check the dataset, and didn't get any information. > From this error message I believe something is wrong with your input tree file\u2026 Sorry, I cannot say anything about this. However, do I understand this correctly, the this crash happens after the test is done and the table is written to the log-file/output? >> 2\u3001I test 3 trees (tree1, tree2, tree3) topology(test1), and the result shows that the AU test excluded tree2, and not reject the tree1 and tree3. The result .iqtree file is as follows: >> Tree logL deltaL bp-RELL p-KH p-SH p-WKH p-WSH c-ELW p-AU >> ---------------------------------------------------------------------------------------------------------------------------------------------- >> 1 -815611.8888 0 0.406 + 1 + 1 + 0.821 + 0.97 + 0.451 + 0.88 + >> 2 -815612.0755 0.18672 0.413 + 0 - 0.499 + 0 - 0 - 0.375 + 0.000237 - >> 3 -815629.1836 17.295 0.182 + 0.179 + 0.179 + 0.179 + 0.179 + 0.174 + 0.179 + > tree2 is also rejected by other tests (e.g. WSH). Though I admit its logL is only slightly worse than tree1. The results of these tests of course depend on the distribution of the site-log-likelihoods. The is a fundamental difference, whether all site-likelihoods of a tree are worse than those of the best tree (in such a case the worse tree should typically be rejected), or if there are sites with a much better likelihood and other with worse likelihood than the best tree (because after bootstrapping the latter may even gain higher likelihoods that the best tree). I admit I have rarely seen such a case that a tree much closer to the best tree gets rejected while a worse one is not. But still this is of course possible, based on the site-log-likelihood distributions. > I can run CONSEL to test this result again if you like. Maybe running CONSEL as well would be a good idea, just to be save. >> To test this result, >> I only set the tree1 and tree2 in the same set (test2), >> and tree1 and tree3 in the same set (test3), >> and tree2 and tree3 in the same set (test4), >> I think that if the test1 is completely right, the test2 and test4 will also excluded tree2. >> But the result show that only the test2 excluded tree2, and test4 didn't reject the tree2. >> And this analysis confused me, I\u2019m not sure which result should be accepted. Can you help me to explain it? > Nothing wrong here: in test4, you only have tree2 and tree3, where tree2 has higher logL than tree3. So it\u2019s totally expected that tree2 is not rejected here. Along this line, I suggest that you always include the ML tree into topology test. I cannot really add to this. Since there is no way of rejecting the best tree (in a test) as being significantly worse than itself, it cannot happen that tree2 gets rejected in test 4 (all site-likelihood differences between the tree and itself are 0.0 by definition). Cheers, "]}, "m3a00R-C54Q": {"topic": "How to exclude third codon position from an analysis", "initializeDate": "May 18, 2020, 3:12:09 PM", "timeStamp": "May 19, 2020, 7:02:42 AM", "content": ["Hi, I am trying to run an analysis of a multiple aligment in IQ-Tree, including a COI fragment gene, the third position of its codons is saturated ( charset Subset3 ). How can I exclude this third position? These are the parementers indicated by PartitionFinder2: #nexus begin sets; charset Subset1 = 1-1234; charset Subset2 = 1913-2524\\3 1914-2524\\3 1235-1912\\3 1236-1912\\3; charset Subset3 = 1237-1912\\3; charset Subset4 = 1915-2524\\3; charpartition PartitionFinder = TVM+I+G:Subset1, GTR+I+G:Subset2, TIM+I+G:Subset3, GTR+I+G:Subset4; end; Many thanks and stay healthy! Fernando Carbayo ", "Hi Fernando, Simply remove this charset line from the file, and also remove \"TIM+I+G:Subset3\u201d from the charpartition. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b3dba039-ba1a-4231-ab9c-07a935357e25%40googlegroups.com ", "Hi Minh, Many tahnks for your quick and direct reply! Best wishes, Fernando Carbayo "]}, "eEq6Yiqp5fk": {"topic": "How are date confidence intervals estimated using --date-ci?", "initializeDate": "Aug 11, 2020, 7:25:15 AM", "timeStamp": "Aug 12, 2020, 3:18:40 PM", "content": ["Dear IQ-TREE users & devs, I could use some help understanding how confidence intervals are estimated for node dates using the --date-ci option. Based on the documentation (pasted below for reference), I would guess that a branch-specific mutation rate is drawn for each branch from a lognormal(w, 0.2) distribution, where w is the least-squares estimate for the mutation rate under a strict molecular clock. Then, it seems that branch lengths are somehow generated based on these sampled branch-specific mutation rates and a poisson model. This is where I get confused. Could you clarify exactly how these branch lengths are generated and under what assumptions? Finally, I understand that this procedure is repeated 100 times and the 5th and 95th percentile dates for each node are reported. If you spot any errors in my understanding or could clarify, I would be very grateful! Best, Sarah --- pasted documentation below --- To infer the confidence interval of the estimated dates, use --date-ci option: iqtree -s ALN_FILE --date DATE_FILE --date-ci 100 which will resample branch lengths 100 times to infer the confidence intervals. Note that this is not bootstrap and the method is much faster but unpublished. Roughly speaking, it is based on a mixture of Poisson and lognormal distributions for a relaxed clock model. You can control the standard deviation of the lognormal distribution via --clock-sd option. The default is 0.2. If you set a higher value, the confidence interval will become wider. ", "Hi Sara, For confidence intervals, w e generate 100 trees with the same topology as the input tree, and this is how the length of each branch i is generated: b_i = Poisson(B_i*seq_len)*lognormal(1,std) The first term is a Poisson distribution of mean (B_i*seq_len) where B_i is the length of branch i estimated by lsd2, i.e B_i = L_i*rate L_i is the elapsed time on branch i estimated by lsd2). So (B_i*seq_len) is the expected number of substitutions on the branch i. The second term represents a relaxed lognormal clock of mean 1, standard deviation std (0.2 by default, settable by users, 0 means strict clock). And you're right about the last point, the 5th and 95th percentile dates of each node are reported. We\u2019re implementing another option to calculating confidence intervals which takes 100 bootstrap trees and generate the confidence intervals for dates and rates. Best, Hien You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/70a81fef-1d75-4644-b682-b9d5b55e7082o%40googlegroups.com "]}, "g12nMQ8F3Qg": {"topic": "Interpreting the matrix Q", "initializeDate": "Jan 24, 2018, 9:01:33 PM", "timeStamp": "Jan 28, 2018, 4:23:17 AM", "content": ["Dear IQ-TREE team, I have some difficulties to understand the results printed by IQ-TREE in the .iqtree file. Using an UNREST model, I got the following rate parameters from an alignment of nucleotides: A-C: 1.5847 A-G: 0.8785 A-T: 0.5367 C-A: 0.9639 C-G: 0.4934 C-T: 3.9507 G-A: 1.2790 G-C: 1.0033 G-T: 1.0000 T-A: 1.0000 T-C: 1.0000 T-G: 1.0000 The following equilibrium distributions: pi(A) = 0.2627 pi(C) = 0.1801 pi(G) = 0.2048 pi(T) = 0.3524 And this Q matrix: A -0.8592 0.4539 0.2516 0.1537 C 0.2761 -1.549 0.1413 1.132 G 0.3663 0.2874 -0.9401 0.2864 T 0.2864 0.2864 0.2864 -0.8592 The model of rate heterogeneity is uniform. I expected that, e.g., the entry A-C in the Q matrix would be equal to the A-C rate * pi(C). But, 0.4539 is not equal to 1.5847 * 0.1801. I am really interested to know how IQ-TREE calculates the Q matrix from a given set of rate parameters & equilibrium distributions. Cheers, ", "Finding a C -> T rate that is about 4X higher than T -> C, and not finding transitions higher than transversions, makes me think you have some very strange data. I have never seen anything like that. The values in the Q matrix are not supposed to be rate times percentage of each base. ", "Hi there, Firstly please refrain from using UNREST model, which is currently not maintained. Instead, use 12.12 model (which is part of Lie Markov models), which uses another parameterisation. Regarding your question: For non-reversible model the Q rate entries are not written as r_{ij} * pi_j like reversible models. Instead, Q entries are simply r_{ij} rescaled by a factor s.t. \\sum_i (q_{ii}*p_i) = -1. So the normalisation is still the same as for reversible models. Moreover, you can compute pi vector directly from Q matrix solving this linear algebra: Q*pi = 0. Does this help? Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Hi, On Saturday, 27 January 2018 09:22:15 UTC-3, Bui Quang Minh wrote: Hi there, Firstly please refrain from using UNREST model, which is currently not maintained. Instead, use 12.12 model (which is part of Lie Markov models), which uses another parameterisation. Ok. Regarding your question: For non-reversible model the Q rate entries are not written as r_{ij} * pi_j like reversible models. Instead, Q entries are simply r_{ij} rescaled by a factor s.t. \\sum_i (q_{ii}*p_i) = -1. So the normalisation is still the same as for reversible models. Moreover, you can compute pi vector directly from Q matrix solving this linear algebra: Q*pi = 0. Does this help? Yes, it does. Many thanks. Cheers, Minh Cheers, "]}, "a3bPuCmhbUM": {"topic": "IQ_tree version 1.5.3 WITH SIGNAL ABORTED", "initializeDate": "Mar 30, 2017, 11:05:46 AM", "timeStamp": "Mar 30, 2017, 2:27:45 PM", "content": ["i have this Error WARNING: 1 sequences contain more than 50% gaps/ambiguity **** TOTAL 3.66% 6 sequences failed composition chi2 test (p-value<5%; df=19) Reading input tree file cvel_10640 ... terminate called after throwing an instance of 'std::ios_base::failure' what(): basic_ios::clear STACK TRACE FOR DEBUGGING: 1 funcAbort() 2 () 3 gsignal() 4 abort() 5 __gnu_cxx::__verbose_terminate_handler() 6 () 7 () 8 () 9 std::__throw_ios_failure(char const*) 10 () 11 MTree::readTree(char const*, bool&) 12 PhyloTree::readTree(char const*, bool&) 13 IQTree::computeInitialTree(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, LikelihoodKernel) 14 runTreeReconstruction(Params&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, IQTree&, std::vector<ModelInfo, std::allocator<ModelInfo> >&) 15 runPhyloAnalysis(Params&, Checkpoint*) 16 main() 17 __libc_start_main() *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: cvel_10640.hits.fasta.fas.phylip.log *** Alignment files (if possible) Aborted When i apply this command line iqtree-omp -s cvel_10640.hits.fasta.fas.phylip -nt 10 -m LG+C40 -bb 1000 -con -t cvel_10640 Regards ", "Hi, this means that there was a failure when IQ-TREE tried to read the input tree file. so please check the input again\u2026 typically IQ-TREE would print such message, I don\u2019t know why it didn\u2019t with your run. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "0mwGhDokNns": {"topic": "Best practices for IQ-TREE tree search", "initializeDate": "Aug 18, 2015, 6:09:59 PM", "timeStamp": "Mar 27, 2021, 9:33:22 AM", "content": ["Dear IQ-TREE users, For most alignments, the default setting for the tree search in IQ-TREE should work fine. However, sometimes you might need or simply want to fine tune the tree search to get the best results. Here I will provide some recommendations for improving the search. Because the number of possible trees is astronomically large, no tree search heuristic can guarantee the optimal tree. The so-called maximum likelihood tree that you get from any phylogenetic reconstruction program is in fact only an approximation of the ML tree. However, if you have a lot of data (very long alignment), the chance of getting the optimal tree is increased. If your alignment is short and have a lot of taxa (very little phylogenetic signal), finding the true ML tree could be very difficult. In any case, it is recommended to runs IQ-TREE several times and compare the tree log-likelihoods. If the log-likelihoods (and the tree topology) are all the same, then there is a high chance that you already have the optimal tree. If you observe a large variance among the log-likelihoods, you might need to run the tree search as many times as possible and take the best tree. The log file / screen output also gives you some indication about whether repeating the search many times is necessary. During the tree search, IQ-TREE samples a lot of locally optimal trees and produce a locally optimal tree in each iteration. The log-likelihood of the locally optimal trees are printed after every 10 iterations. If you want to see the log-likelihood of all locally optimal trees, turn on the flag -v (verbose). Toward the end of the search, if the log-likelihoods seem to converge (some iterations produce the same log-likelihood) then you might only need to repeat the search few more times. If they do not, you should repeat the search as many times as possible. The following options are also useful: -pers <proportion>: adjust the strength of the perturbation method, which helps IQ-TREE escape local optima. The default value is 0.5. If you think that the search does not converge, it is sensible to reduce the perturbation strength (e.g. -pers 0.1 or -pers 0.2) -numstop <number>: adjust the stopping rule. In the default setting, IQ-TREE will stop if it cannot find a new best tree in the last 100 iterations. You can increase this number to make IQ-TREE search more thoroughly (e.g. -numstop 500) -wt: write all locally optimal trees into .treels. This option might be useful if you want to take a look at the alternative trees. You can also build a consensus tree from these trees. Sometimes the consensus tree might have higher log-likelihood than the best locally optimal tree. Last but not least, large log-likelihood variance among IQ-TREE runs often means that your data does not contain enough phylogenetic signal. In such case, you have do some statistical tests to access the branch support (UFBoot, aLRT, standard bootstrap). With little data, even if the optimal tree could be found, it might still look very different from the true tree. ", "Hi Tung, Thanks for the advice, it is quite useful. I just wanted to make an observation, the command -numstop gives an error. I think you meant -nstop. Best wishes, Santiago "]}, "sv6-lLEVrUg": {"topic": "iqtree-mpi warnings for Memory required per CPU-core and run cannot finish", "initializeDate": "Jul 15, 2020, 10:02:10 AM", "timeStamp": "Jul 15, 2020, 7:39:42 PM", "content": ["Dear IQ-tree team When I am running mpi version of iqtree both (1.6.12 or 2.0), it always reports message and usually the run will not finish WARNING: Memory required per CPU-core (24.1637 GB) is higher than your computer RAM per CPU-core (1 GB), thus multiple runs may exceed RAM! But in fact, my node has RAM either 32GB or 64GB command is /work/00412/mtang/local/bin/iqtree2-mpi_ls5 -s alignments_posi0.8_new.aliscore -p alignments_posi0.8_new.aliscore_codon_partitions -T AUTO -nt 32 -pre alignments_posi0.8_new.aliscore_partition_by_codon /home2/jzhang/locals/IQ-TREE/build/iqtree-mpi -s alignments_posi0.8_new.aliscore -spp alignments_posi0.8_new.aliscore_codon_partitions -nt 20 -pre alignments_posi0.8_new.aliscore_part_by_codon alingment is large and contains about 800 sequences with more than 100000bps. I tried to use -mem but somehow it is not compatible for partition analysis. ", "Can you please paste the first 10 lines and the last 10 lines of the log file. Also, paste the line where it prints the memory required for this run. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ed2f04fa-4c50-4ce8-88b2-d9d4d108fcfdo%40googlegroups.com "]}, "7gwg4jrxRGk": {"topic": "slow, non-parametric bootstrapping and start trees", "initializeDate": "Feb 16, 2018, 1:04:38 PM", "timeStamp": "Feb 22, 2018, 5:03:49 AM", "content": ["Dear all, recently in some workgroups we discussed whether it is reasonable a) to use the best tree found in ML tree searches b) parsimony starttrees (default) or c) completely random trees as start trees when bootstrapping. In additional question to b) in case of parsimony trees (this is the default, correct?) and since this is automated: Are the parsimony trees drawn from each BS replicate that was internally created or is a parsimony tree build from the original dataset? Any recommendation? What is the common setting you (the developers) would use? (In addition: is there a way to gett access to each BS alignment that internally is created?) Best and thanks Karen Thanks, & best, Karen ", "Hi Karen, Sorry I miss this email: On 17 Feb 2018, at 5:04 am, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Dear all, recently in some workgroups we discussed whether it is reasonable a) to use the best tree found in ML tree searches b) parsimony starttrees (default) or c) completely random trees as start trees when bootstrapping. In additional question to b) in case of parsimony trees (this is the default, correct?) Yes b) is the default in IQ-TREE. and since this is automated: Are the parsimony trees drawn from each BS replicate that was internally created or is a parsimony tree build from the original dataset? Parsimony trees will be constructed from bootstrap replicate (Assuming that you use -b option for standard bootstrap). Any recommendation? What is the common setting you (the developers) would use? Well, my recommendation is like above: performing BS tree search independently, including starting trees. This is the default in IQ-TREE and actually the way when the bootstrap was described in Felsenstein 1981. (In addition: is there a way to gett access to each BS alignment that internally is created?) Yes, there is an option -wba (write bootstrap alignments), which will write the set of bootstrap alignments into .bootaln file (continuously). Hope that helps, Minh Best and thanks Karen Thanks, & best, Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Minh MANY THANKS AND MUCH APPRECIATED! Best, karen "]}, "RnrNzopaRvg": {"topic": "PMSF model usage", "initializeDate": "May 6, 2019, 9:04:18 PM", "timeStamp": "May 7, 2019, 4:02:13 AM", "content": ["Hello, We had a discussion about the correct use of the PMSF model, and running it as described on the IQTREE webpage works fine for our data set. iqtree -s <alignment> -m LG+C20+F+G -ft <guide_tree> However, someone ran the command like this - assuming that IQTREE creates it's own maximum parsimony starting tree using the LG model and then computes ML distances based on PMSF. iqtree -s alignment_file.faa -m LG+PMSF+G -nt AUTO Now the above commend seems wrong, it doesn't even specify which mixture model to use, but it executes without any error. So I was wondering what model did IQTREE actually use? It's not obvious from the log file: ... Estimate model parameters (epsilon = 0.100) 1. Initial log-likelihood: -3707550.544 2. Current log-likelihood: -3640930.351 3. Current log-likelihood: -3640731.324 4. Current log-likelihood: -3640729.741 Optimal log-likelihood: -3640729.702 Gamma shape alpha: 1.419 Parameters optimization took 4 rounds (47.514 sec) Computing ML distances based on estimated model parameters... 1171.413 sec Computing BIONJ tree... 14.662 seconds Log-likelihood of BIONJ tree: -3661441.000 Best, Chris ", "Hi Chris, Quick answer: \"-m LG+PMSF+G\u201d is the same as \u201c-m LG+G\u201d. Long answer: iqtree does not strictly check the model name, the part of the name which is not recognised will be omitted. In this case, +PMSF is omitted, thus the behaviour is the same as LG+G model. Perhaps iqtree should give some warnings about such parts\u2026 Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thanks Minh, good to know that the trees created this way are regular LG+G trees. And yes, a warning message about omitting not recognized models would be helpful ;-) Cheers, Chris Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "-1VbQGkEbsQ": {"topic": "-mem and speed", "initializeDate": "May 17, 2018, 4:57:46 AM", "timeStamp": "May 19, 2018, 6:08:48 AM", "content": ["Hey, I would like to know the relationship between limiting the memory on a job with -mem and calculation time. I've noticed that limiting the memory increases the number of threads deemed optimal with -nt AUTO. Does that mean that speed is not lost when using -mem? Thanks for your insight, Fabien ", "Hi Fabien, That\u2019s an interesting observation, which I never thought of. Can you tell me: how many threads were detected as optimal with and without -mem? One possible explanation can be that with restricted memory, IQ-TREE has to do more computations per thread, which in turn increase parallel efficiency. Regarding this question: the relationship between limiting the memory on a job with -mem and calculation time. I did some rough testing about this. When restricting to 50% of the normally required RAM (which you can invoke via \u2018-mem 0.5\u2019), then IQ-TREE ran slower only by 5 to 10%. When limiting with the least possible RAM (proportional to log(n)/n, where n is the number of taxa), then it runs 2 to 3 times slower. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Thank you, good to know. 8 threads when no limitation was applied, otherwise it was 12 threads. Cheers, Fabien ", "Hi Fabien, That\u2019s a lot of difference \u2026 I would say, yes, the speed might not be lost. Cheers Minh "]}, "wbkt6epLVYo": {"topic": "Does -ntmax apply for initial parsimony tree building?", "initializeDate": "Oct 19, 2020, 6:29:23 PM", "timeStamp": "Oct 22, 2020, 11:21:52 PM", "content": ["I'm trying to run IQTREE (non-MPI) on a system scheduler (openlava) and the runs keep suspending during the initial parsimony tree stage. I have the run set to -nt AUTO -ntmax 10 and was wondering if it was possible that IQTREE uses more than the 10 allotted cores when it is building the initial parsimony tree and maybe that was what was holding it up? If this is the case, are there any possible fixes? Thank you ", "Running it with -nt 10 seems to have fixed the problem. ", "Actually it only fixed it for unconstrained trees, but the constrained trees are still taking a very long time at the initial parsimony step. ", "Hi, Bio Student. Does -ntmax apply for initial parsimony tree building? A: No. An explicit -nt setting (like -nt 10) takes effect before the construction of the initial parsimony tree. But -ntmax only matters to the code that figures out how many threads to use (if you've passed -nt AUTO). And the initial parsimony tree is always constructed before -nt AUTO takes effect (because the code that decides how many threads to use, when -nt AUTO is set, uses the time that it takes to calculate likelihoods on a tree, it has to have a tree to run!). So, yes, your initial guess was correct. In the initial parsimony tree stage, IQTree will \"feel free\" to use as many threads as are physically available (even if that is more than you specified via -ntmax) (because -ntmax won't have been honoured yet). In my opinion, this is a bug. The combination of -ntmax 10 and -nt AUTO should constrain IQTree to use no more than 10 threads, *including* in any processing, such as initial parsimony tree construction, that takes place before the number of threads to use for likelihood processing is figured out. As for why even an explicit -nt 10 setting doesn't seem to help for constrained trees, I cannot say. Regards, James You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/754955ff-9058-4f23-8ebb-571674a920b2n%40googlegroups.com ", "James gave a good answer to your 1st question. For the 2nd: >Actually it only fixed it for unconstrained trees, but the constrained trees are still taking a very long time at the initial parsimony step. Did you use IQ-TREE version 1? If yes, please switch to version 2. It significantly speeds up the constraint tree option, especially for datasets with many many sequences. Cheeers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1950005108.1286614.1603151072083%40mail.yahoo.com "]}, "ssFG0xaD_yM": {"topic": "IQ-tree distances very different than with PhyML, Neighbor-Joining, other programs?", "initializeDate": "Jan 16, 2015, 2:41:21 PM", "timeStamp": "Jan 25, 2015, 7:05:46 AM", "content": ["Hi, When I compare the distances computed by the IQ-tree online server , to PhyML and other methods, the distances given by IQ-tree are vastly larger. The distances between marburgviruses and ebolaviruses are rather large, beyond saturation of silent sites as illustrated by the Ts and Tv vs F84 distances plotted with DAMBE. But a distance of greater than 15 from the marbugviruses (MARV and TAVN) to the ebolaviruses (SUDV, EBOV, TAFV, RESTV, BUDV) seems exaggerated. When I build trees using sequences that are much more closely related to each other (Just the Ebola-Zaire EBOV data) the PhyML and IQ-Tree trees are nearly identical to each other. Both tree methods agree that the distance between the viruses of different outbreaks of the same virus are roughly 0.04. Brian Foley, PhD HIV Databases ", "Dear Brian, please send me the alignment directly, so that I can have a closer look. Best, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "I have attached the alignment so anyone can have a look. I have also attached the alignment of all coding regions. On Monday, January 19, 2015 at 5:18:05 AM UTC-7, Bui Quang Minh wrote: Dear Brian, please send me the alignment directly, so that I can have a closer look. Best, Minh ", "This is one alignment that give much larger distances across the whole tree (between marburgiruses and ebolaviruses) when I use IQ-tree than when I use PhyML at HIV Databases http://www.hiv.lanl.gov/content/sequence/PHYML/interface.html You received this message because you are subscribed to a topic in the Google Groups \"IQTREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/ssFG0xaD_yM/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com ", "We have no idea what the distance between ebolaviruses and marbugviruses should be. They don't leave any fossils. We do have a solid fossil record of vertebrate, and especially the tetrapods, evolution. My opinion on using just a few hundred bases of mtiochondrial DNA to reconstruct tetrapod evolution, is that it is foolish for a number of reasons. However, as a cartoon test case for comparing one method to another it is a set that at least has the advantage of having some fossil data behind it, so we can then discuss why one method is better or different than another. In my previous work on this data set, in August of 2013, I had thought the differences between a \"quick and dirty\" neighbor-joining tree and a PhyML maximum likelihood tree were important but rather subtle. The IQ-tree I just ran this week shows much more interesting changes in the scale. http://www.kuleuven.be/aidslab/phylogenybook/Data_sets.html "]}, "xxjD9xO7n0M": {"topic": "ERROR: C:\\Users\\minh\\Dropbox\\iqtree-git\\tree\\phylotree.cpp:2652:", "initializeDate": "Jul 11, 2019, 11:07:55 PM", "timeStamp": "Jul 31, 2019, 10:59:07 AM", "content": ["Hi Developers: I encounter one question. My data contains 422 protein sequences , then I run the iqtree with command: iqtree -s 422.phy -st AA -m WAG+G4+F -b 100 -nt AUTO But it doesn't work ERROR: C:\\Users\\minh\\Dropbox\\iqtree-git\\tree\\phylotree.cpp:2652: virtual double PhyloTree::optimizeAllBranches(int, double, int): Assertion `fabs(new_tree_lh-tree_lh) < max_delta_lh' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: 422.phy.log ERROR: *** Alignment files (if possible) while it works fine in the another computer win 7, using the same sequences file and command I am not sure the reason, So can you help this? Any help will be appreciated! ", "Hi Wu, THanks for the report. Can you please send the alignment file to my personal email, for further inspection? Cheers, Mih You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/520d66e3-823e-4a23-b648-bdd1efc8f77d%40googlegroups.com For more options, visit https://groups.google.com/d/optout <422.phy.log> ", "Hi Mih I'm sorry, I didn't notice your reply before. After several attempts, it works without the \" -nt AUTO \" parameter, but what exactly caused it is not clear. \u5728 2019\u5e747\u670815\u65e5\u661f\u671f\u4e00 UTC+8\u4e0a\u53488:19:59\uff0cMinh Bui\u5199\u9053\uff1a Hi Wu, THanks for the report. Can you please send the alignment file to my personal email, for further inspection? Cheers, Mih On 12 Jul 2019, at 1:07 pm, Wu < 5547...@qq.com > wrote: Hi Developers: I encounter one question. My data contains 422 protein sequences , then I run the iqtree with command: iqtree -s 422.phy -st AA -m WAG+G4+F -b 100 -nt AUTO But it doesn't work ERROR: C:\\Users\\minh\\Dropbox\\iqtree-git\\tree\\phylotree.cpp:2652: virtual double PhyloTree::optimizeAllBranches(int, double, int): Assertion `fabs(new_tree_lh-tree_lh) < max_delta_lh' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: 422.phy.log ERROR: *** Alignment files (if possible) while it works fine in the another computer win 7, using the same sequences file and command I am not sure the reason, So can you help this? Any help will be appreciated! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "gVpzUnLU8CE": {"topic": "support values in contre", "initializeDate": "May 21, 2018, 4:49:50 AM", "timeStamp": "May 22, 2018, 8:55:47 PM", "content": ["Dear Prof. Bui, I was running iqtree using -abayes and -alert 1000. I think the support values for these tests were only output along with the best tree file rather than the contre. Therefore is there a way to have these values in the contre as well? Best, Cacau ", "Hi Cacau, Right now .contree file is not annotated with such branch supports mainly because .contree can be multifurcating and such test does not work in that case. If .contree is bifurcating, then you invoke a second IQ-TREE run inputting this tree as fixed with -te option as follows: iqtree -s alignment -te CONTREE_FILE -alrt 1000 -abayes Then the support values will be appended to the bootstrap supports in the node name (with slash \u2018/\u2018 added to separate values). This run will probably complain with an error if your contree is not bifurcating. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "GQh_yMP4ySU": {"topic": "IQTREE 1.5.2 crash during optimizing candidate tree set", "initializeDate": "Jan 2, 2017, 6:04:03 AM", "timeStamp": "Jan 5, 2017, 5:17:47 AM", "content": ["To whom it may concern, I wrote this because IQtree crash during the optimizing candidate tree set step and I don't know if it's because of me or a real bug. ``` Estimate model parameters (epsilon = 0.100) ERROR : Could not find neighbors of node 4619 STACK TRACE FOR DEBUGGING: 1 splitnumtaxacmp(Split const*, Split const*) 2 _sigtramp() 3 splitnumtaxacmp(Split const*, Split const*) 6 splitnumtaxacmp(Split const*, Split const*) 7 splitnumtaxacmp(Split const*, Split const*) 8 splitnumtaxacmp(Split const*, Split const*) 9 splitnumtaxacmp(Split const*, Split const*) 10 splitnumtaxacmp(Split const*, Split const*) 11 splitnumtaxacmp(Split const*, Split const*) 12 splitnumtaxacmp(Split const*, Split const*) 13 splitnumtaxacmp(Split const*, Split const*) 14 splitnumtaxacmp(Split const*, Split const*) 15 splitnumtaxacmp(Split const*, Split const*) 16 splitnumtaxacmp(Split const*, Split const*) 17 splitnumtaxacmp(Split const*, Split const*) 18 splitnumtaxacmp(Split const*, Split const*) 19 splitnumtaxacmp(Split const*, Split const*) 20 splitnumtaxacmp(Split const*, Split const*) 21 splitnumtaxacmp(Split const*, Split const*) 22 splitnumtaxacmp(Split const*, Split const*) 23 splitnumtaxacmp(Split const*, Split const*) 24 splitnumtaxacmp(Split const*, Split const*) 25 splitnumtaxacmp(Split const*, Split const*) 26 splitnumtaxacmp(Split const*, Split const*) 27 splitnumtaxacmp(Split const*, Split const*) 28 splitnumtaxacmp(Split const*, Split const*) 29 splitnumtaxacmp(Split const*, Split const*) 30 splitnumtaxacmp(Split const*, Split const*) 31 splitnumtaxacmp(Split const*, Split const*) 32 splitnumtaxacmp(Split const*, Split const*) 33 splitnumtaxacmp(Split const*, Split const*) 34 splitnumtaxacmp(Split const*, Split const*) 35 splitnumtaxacmp(Split const*, Split const*) 36 splitnumtaxacmp(Split const*, Split const*) 37 splitnumtaxacmp(Split const*, Split const*) 38 splitnumtaxacmp(Split const*, Split const*) 39 splitnumtaxacmp(Split const*, Split const*) 40 splitnumtaxacmp(Split const*, Split const*) 41 splitnumtaxacmp(Split const*, Split const*) 42 splitnumtaxacmp(Split const*, Split const*) 43 splitnumtaxacmp(Split const*, Split const*) 44 splitnumtaxacmp(Split const*, Split const*) 45 splitnumtaxacmp(Split const*, Split const*) 46 splitnumtaxacmp(Split const*, Split const*) 47 splitnumtaxacmp(Split const*, Split const*) 48 splitnumtaxacmp(Split const*, Split const*) 49 splitnumtaxacmp(Split const*, Split const*) 50 splitnumtaxacmp(Split const*, Split const*) 51 comparePLLNNIMove(pllNNIMove const&, pllNNIMove const&) 52 comparePLLNNIMove(pllNNIMove const&, pllNNIMove const&) 56 splitnumtaxacmp(Split const*, Split const*) 57 splitnumtaxacmp(Split const*, Split const*) 58 splitnumtaxacmp(Split const*, Split const*) *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: iqtree_pilAE_7gene.log *** Alignment files (if possible) ``` Thank you for your help R\u00e9mi PS : I can't join the alignment file because it to big ", "Dear Remi, This looks weird, but it is not clear what went wrong - can you please send me the data file via my personal email? Just a quick note: there are so many identical sequences in your alignment. Thus I would pre-process it first before performing tree reconstruction. Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <iqtree_pilAE_7gene.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "scmsbGTAjO0": {"topic": "The file \"varsites.phy\" contains fewer sequences than the original matrix", "initializeDate": "Jan 8, 2020, 5:29:36 AM", "timeStamp": "Jan 9, 2020, 2:56:35 AM", "content": ["Hello, I usually convert a VCF file into a phylip matrix for phylogenetic analysis. I generally specify the model GTR+ASC, which conveniently filters the matrix to retain only \"true\" variable sites into a matrix with extension \"varsites.phy\" and then aborts. Then I can use the \"varsites.phy\" matrix to work. However I just noticed that when duplicate sequences exist in the original matrix, the \"varsites.phy\" matrix only contains the unique sequences, then obviously the tree calculated on \"varsites.phy\" doesn't contain all the tips in the original matrix. Is there a way to obtain a \"varsites.phy\" matrix that contains the original number of sequences? Thanks Edgardo ", "Hi Edgardo, Simple answer: you can use -keep-ident option. It\u2019s documented here: http://www.iqtree.org/doc/Command-Reference#general-options Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/cac4cb73-17f8-49f8-a7ee-c5b9965fb8d7%40googlegroups.com ", "Excellent, thank you very much, I missed that option somehow. Edgardo On Thursday, January 9, 2020 at 8:53:25 AM UTC+1, Minh Bui wrote: Hi Edgardo, Simple answer: you can use -keep-ident option. It\u2019s documented here: http://www.iqtree.org/doc/Command-Reference#general-options Cheers, Minh On 8 Jan 2020, at 9:29 pm, Edgardo Ortiz Valencia < e.o...@gmail.com > wrote: Hello, I usually convert a VCF file into a phylip matrix for phylogenetic analysis. I generally specify the model GTR+ASC, which conveniently filters the matrix to retain only \"true\" variable sites into a matrix with extension \"varsites.phy\" and then aborts. Then I can use the \"varsites.phy\" matrix to work. However I just noticed that when duplicate sequences exist in the original matrix, the \"varsites.phy\" matrix only contains the unique sequences, then obviously the tree calculated on \"varsites.phy\" doesn't contain all the tips in the original matrix. Is there a way to obtain a \"varsites.phy\" matrix that contains the original number of sequences? Thanks Edgardo You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "T9DcQraLiK8": {"topic": "Molecular Evolution Workshop 2018", "initializeDate": "Mar 22, 2018, 5:14:37 AM", "timeStamp": "Mar 22, 2018, 5:14:37 AM", "content": ["Dear All, Please find below the announcement for the Workshop on Molecular Evolution, which will cover state-of-the-art techniques and software for phylogenetic analysis. The application deadline is April 6, 2018. Cheers, Minh Begin forwarded message: From: Joseph Bielawski < J.Bie...@Dal.Ca Subject: MOLE 2018: spread the word Founded in 1988, the Workshop on Molecular Evolution is the longest-running workshop if its kind. The 2018 workshop will be held July 19-29, and this will be its 30th anniversary at the Marine Biological Lab in Woods Hole, MA. The Workshop is the premier program for integrating the methods, theory, and applications of molecular phylogenetics, statistical genetics, molecular evolution, and related disciplines. Students work closely with internationally-recognized scientists, receiving (i) high-level instruction in the principles of molecular evolution and evolutionary genomics, (ii) advanced training in statistical methods best suited to modern datasets, and (iii) hands-on experience with the latest software tools (often from the authors of the programs they are using). The material is delivered via lectures, discussions, and bioinformatic exercises motivated by contemporary topics in molecular evolution. A hallmark of this workshop is the direct interaction between students and field-leading scientists. The workshop serves graduate students, postdocs, and established faculty from around the world seeking to apply the principles of molecular evolution to questions of both basic and applied biological sciences. A priority of this workshop is to foster an environment where students can learn from each other as well from the course faculty. As the course progresses, participants learn how to use the following software to address questions concerning the origins, maintenance, and function of molecular variation: ASTRAL, BEAST2, BEST, FASTA, FigTree, GARLI, IQTree, MIGRATE, MAFFT, MP-EST, RaxML, RevBayes, PAML, PAUP*, SNaQ, and SVD Quartets. Students will have the opportunity to work with software on their own laptops as well as receive training on how to use the same programs on a high performance computer cluster. In 2018 the course instructors include C\u00e9cile An\u00e9, Peter Beerli, Joseph Bielawski, Belinda Chang, Casey Dunn, Scott Edwards, Laure Eme, Deise Josely Pereira Gon\u00e7alves, Tracy Heath, Mark Holder, John Huelsenbeck, Lacey Knowles, Laura Kubatko, Michael Landis, Paul Lewis, Emily Jane McTavish, Bui Quang Minh, Suman Neupane, David Swofford, Noor White, Rachel Williams and Anne Yoder. Deadline for applications is April 6, 2018: https://ws2.mbl.edu/studentapp/studentapp.asp?courseID=MOLE More information on the Workshop is available on the dedicated course website: https://molevol.mbl.edu/index.php/Main_Page The dates for the Workshop are designed to allow students to segue directly into the Strategies and Techniques for Analyzing Microbial Population Structures (STAMPS) course, though please note that applications must be submitted to, and are evaluated separately from, those submitted to the Workshop on Molecular Evolution. For further information, please contact Workshop co-Directors: Joseph Bielawski ( j.bie...@dal.ca ) and/or Mark Holder ( mtho...@ku.edu "]}, "AtVQH09GqEc": {"topic": "IQ-TREE not reading the list of models", "initializeDate": "Aug 10, 2017, 12:44:46 PM", "timeStamp": "Aug 15, 2017, 9:44:42 PM", "content": ["Hi all, I'm having trouble doing model selection and I think the problem is with IQ-TREE not reading the list of models in my command: /pool/genomics/roa-varona/Programs/iqtree/IQ-TREE-1.6.beta3/build/iqtree -nt $NSLOTS -rcluster 10 -safe -blmin 1e-6 -pre PF2_OD_q -s DNA_FcC_supermatrix.phy -q PF2_best_scheme.txt -mset JC,F81,K80,HKY,TPM2,TPM3,TIM3,TVM,SYM,GTR. Any information would be greatly appreciated (log file attached) Adela ", "Hi Adela, I am not certain of your problem as I haven\u2019t done this sort of analysis myself in the past. But the rest of the team are on annual leave at the moment so I\u2019ll try to help if I can. Your syntax for the -mset option seems fine, but I suspect you also need to provide the -m option, see the section \u201cAutomatic model selection\u201d: http://www.iqtree.org/doc/Command-Reference#automatic-model-selection I must confess I am not certain which argument you need to use for the -m option in your situation. You are supplying a best partitioning scheme text file so I presume you have already used partition finder to determine this? Does this file contain models for each partition or does it just define the partitions? Sorry I can\u2019t be of more help, Minh will return from leave next week to clarify further if need be. Cheers, Stephen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <PF2_OD_mset_RAxML.log> ", "Hi Adela, Stephen is right that you need to specify -m TEST or -m MFP to perform model selection. Otherwise, IQ-TREE applies GTR model for all partitions (since you input a RAxML-style partition file) and -mset option is ignored. However, if you used PartitionFinder to produce this best scheme file, I believe that PartitionFinder generated a partition file which is compatible with IQ-TREE \u2026 this also saves a lot of time to do model selection again. Cheers, Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Stephen and Minh, Yes, I used PF2 just to generate the best partition scheme and now I\u2019m trying to run IQ-TREE to perform model selection with the set of models in my command. I\u2019ll run it again including the \u2013m option. Thanks a lot for the suggestion! Adela "]}, "ZjcShtkwnEw": {"topic": "implementing GTR model for proteins in IQ-TREE?", "initializeDate": "Mar 17, 2016, 6:37:13 PM", "timeStamp": "Mar 21, 2016, 3:53:25 PM", "content": ["Hello, Is there a possibility to include GTR as one of the protein models that can be selected? I know it is slower than the others, but unfortunately it's what I need to use for my current dataset. I can get UFbootstrap support for my GTR tree (made using RAxML) easily enough, but I'd also like to be able to run the -alrt and -abayes options for an additional perspective on support for each node. Thanks, Des ", "Dear Des, we intentionally did not implement such GTR-like model for protein due to a huge number of parameters (20 choose 2), thus computationally expensive. Moreover, it is very difficult to estimate model parameters reliably. Thus one needs to design a robust estimation routine, which has to be then tested thoroughly using e.g. simulations. Finally, this model is only applicable for very large data sets, adding even more computations. But then people would apply partition or mixture models anyway. Thus, all these will take time. Can you btw give us rationale for using such model? What kind of data do you have, and why do you think GTR-like model is beneficial? Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, The short explanation: I asked about GTR because it is the typical model used for previous large-scale opsin phylogenies and because it ends up being beating other models when compared used BIC. The long explanation: I'm making a phylogeny of opsin proteins across animals. I've got ~1100 sequences from ~300 species. GTR+G (implemented in RAxML or a bayesian program) is by far the most common model used for other large scale opsin phylogenies in the past, based on model selection using BIC. Both ProtTest and IQ-TREE suggest some flavor of LG on my alignment. Based on your response above, I used IQ-TREE to test mixture models (specifically LG4M and LG4X), but both were still less good fits for the data compared to GTR+G when compared using BIC. Actually, they both were also ranked under LG+F+G also well as GTR. I also used Partition Finder to automatically select partitions for the dataset (using search=kmeans), but I restricted the models to flavors of LG and LG4X. While this gave me a much higher LnL and the single substitution matrix models, the bootstrap trees did not converge (at 0.99 correlation coefficient) after 1000 bootstraps, although it was close ~0.97. The resulting tree is a bit of a mess in terms of where some sequences have fallen based on where we expect them based on the species tree/previous analyses. I'm rerunning the analysis and have raised the threshold to 2000 bootstraps, so maybe that will help. I've also gotten the warning messages about the difference in size between the number of parameters and the sample size... my n is much lower than k, especially after partitioning the dataset. Part of the goal of the phylogeny is to include the widest possible phylogenetic breadth of opsins. I am considering reducing the number of sequences that I include-- there are definitely some clades that contain closely related species with similar sequences that I can pare down. At this point, I'm feeling a bit stuck! If you have any recommendations, I would be happy to hear them. Thanks for your time! Des "]}, "3-RO5LkpcOM": {"topic": "PLL Crash", "initializeDate": "Nov 23, 2014, 8:14:56 PM", "timeStamp": "Nov 25, 2014, 4:02:32 AM", "content": ["Hi, I got a crash message when starting to include PLL in the IQTREE program. Attached is the logfile. Any solution? Regards, Victor A. Jl. Pulomas Barat Kav. 88 Jakarta Timur 13210 Indonesia +6221 29567888 +6221 29617296 http://www.i3l.ac.id This e-mail and its attachments should be treated as confidential and privileged, and may only be used by the authorized recipients. If you are not the intended recipient, you are hereby notified that any dissemination, distribution or copying of this email or any of its attachments is strictly prohibited and you should delete all copies and notify us immediately. The contain of this email might not represent the official view of i3L (Indonesia International Institute for Life Sciences), except when it is clearly stated as such. ", "Hi Victor, thanks for reporting this bug. It was specifically a problem only with Windows-multicore version build while other other binaries work just fine with -pll option. The problem was that we built IQ-TREE with Intel C++ and PLL seems not to support this. To resolve it, I have now built these versions using a GCC for Windows (TDM-GCC) and uploaded them. Just go again to http://www.cibiv.at/software/iqtree/ , in the Download for Windows 64-bit section you find now two links to two versions: PLL-SSE3-multicore and PLL-AVX-multicore. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <example.phy.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, I have downloaded the PLL version of IQ-TREE. I ran the standard command like iqtree -s example.phy -m TEST and got no crash report for this. However it takes so much computing process (I saw the task manager and got all of the 8-cores process increasing to 100%) yet still doesn't give any result (of the model test) even after waiting for ~20 minutes. Is that normal? Oh one more question, how can I put the gamma shape parameter (alpha) into the nexus partition file? On the manual, you wrote: #nexus begin sets; charset part1 = 1-100; charset part2 = 101-384; charpartition mine = HKY+G:part1, GTR+I+G:part2; end; I had tried to change the charpartition mine into HKY+G+a0.5:part1 but it seems to give no effect (no report for such change in the iQTREE file) Regards, Victor A. ", "Dear Victor, there are a few things to note: On 25 Nov 2014, at 02:25, Victor Aprilyanto < victor.a...@i3l.ac.id > wrote: Hi Minh, I have downloaded the PLL version of IQ-TREE. I ran the standard command like iqtree -s example.phy -m TEST and got no crash report for this. However it takes so much computing process (I saw the task manager and got all of the 8-cores process increasing to 100%) yet still doesn't give any result (of the model test) even after waiting for ~20 minutes. Is that normal? Please use the non-PLL binary if you don\u2019t use \u201c-pll\" option. There is some problem specifically with GCC-OpenMP support under Windows and Mac, that breaks down the performance of multicore IQ-TREE version. That\u2019s why you see that slowing down behaviour. (In fact we compiled IQ-TREE with Clang for Mac and Intel C++ compiler for Windows, just avoiding this strange GCC behaviour). Second, the multicore version only works for long alignments. So having 8 threads for this small example is definitely unneccessary and also contributes to this speed-down. Please have a look at the manual for using -omp option to determine the number of cores to use. Third, please check whether your CPU is hyperthreading or not. The bottom line is to use maximally the number real cores you have. If you CPU was indeed hyperthreading (4 real cores and 8 \u201cdisplayed\u201d cores), then please only max 4 cores! Oh one more question, how can I put the gamma shape parameter (alpha) into the nexus partition file? On the manual, you wrote: #nexus begin sets; charset part1 = 1-100; charset part2 = 101-384; charpartition mine = HKY+G:part1, GTR+I+G:part2; end; I had tried to change the charpartition mine into HKY+G+a0.5:part1 but it seems to give no effect (no report for such change in the iQTREE file) the correct model usage when specifying parameter is HKY+G{0.5}:part1. Please consult the manual section 4.2 Hope that helps Minh "]}, "l-j48Knzswo": {"topic": "IQtree Error: using partitionFinder best_scheme.txt", "initializeDate": "Feb 2, 2020, 12:33:36 AM", "timeStamp": "Feb 6, 2020, 4:39:23 PM", "content": ["Hello experts, I'm using IQtree in CIPRES using partitionFinder best_scheme.txt but got an error. It will be an immense help if someone help to correct me. I have attached the partion file as well as the Error file. Thanks ERROR: Expecting integer, but found \"(COX1_pos1) (COX1_pos2) (COX1_pos3) (COX2_pos1 COX3_pos1 CYTB_pos1) (ATP6_pos2 COX2_pos2 COX3_pos2 CYTB_pos2 NAD3_pos2) (COX2_pos3 COX3_pos3 CYTB_pos3) (ATP6_pos1) (ATP6_pos3 NAD3_pos3) (ATP8_pos1 NAD2_pos1 NAD3_pos1 NAD6_pos1) (ATP8_pos2 NAD2_pos2 NAD6_pos2) (ATP8_pos3 NAD6_pos3) (NAD1_pos1 NAD4L_pos1 NAD4_pos1 NAD5_pos1) (NAD1_pos2 NAD4L_pos2 NAD4_pos2 NAD5_pos2) (NAD1_pos3 NAD4_pos3 NAD5_pos3) (NAD2_pos3) (NAD4L_pos3);\" instead srun: error: comet-14-67: task 0: Exited with exit code 2OMP_NUM_THREADS=24 Running: -lbp 1000 -s infile.txt -spp partition.txt -bb 1000 -bnni -alrt 1000 -abayes -alrt 0 -seed 1234 -st CODON5 -pre Dip_116 -o A_microrhi, E_biolleyi, A_mellifer, B_mori -nt 12 iqtree -lbp 1000 -s infile.txt -spp partition.txt -bb 1000 -bnni -alrt 1000 -abayes -alrt 0 -seed 1234 -st CODON5 -pre Dip_116 -o A_microrhi, E_biolleyi, A_mellifer, B_mori -nt 12 IQ-TREE multicore version 1.6.10 for Linux 64-bit built Feb 19 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: comet-14-67.sdsc.edu (AVX2, FMA3, 125 GB RAM) Command: iqtree -lbp 1000 -s infile.txt -spp partition.txt -bb 1000 -bnni -alrt 1000 -abayes -alrt 0 -seed 1234 -st CODON5 -pre Dip_116 -o A_microrhi, E_biolleyi, A_mellifer, B_mori -nt 12 Seed: 1234 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Sat Feb 1 10:04:02 2020 Kernel: AVX+FMA - 12 threads (24 CPU cores detected) Reading partition model file partition.txt ... Reading alignment file infile.txt ... Nexus format detected Skipping unknown block (mrbayes)... Alignment has 116 sequences with 11835 columns, 8333 distinct patterns 7729 parsimony-informative, 1255 singleton sites, 2851 constant sites Gap/Ambiguity Composition p-value 1 Blepharipa 5.65% failed 0.00% 2 P_chinensi 5.68% failed 0.11% 3 O_oryzae 9.13% failed 0.00% 4 D_longicor 5.63% failed 0.00% 5 S_variegat 5.48% failed 0.00% 6 P_papatasi 5.70% passed 37.83% 7 P_steineni 6.67% failed 0.00% 8 O_vigilax 5.53% failed 0.00% 9 A_culicifa 5.37% failed 0.00% 10 A_cruzii 5.37% failed 0.00% 11 A_hinesoru 5.42% failed 0.15% 12 A_deaneoru 5.42% failed 0.45% 13 A_albitars 5.42% failed 0.90% 14 A_cracens 5.42% failed 0.39% 15 Ptychopter 5.58% passed 34.27% 16 A_flava 5.65% failed 0.00% 17 C_spenceri 5.48% failed 0.00% 18 P_fitchii 5.73% passed 23.73% 19 S_fenestra 5.35% passed 45.37% 20 P_trichopt 5.60% failed 1.24% 21 T_bimacula 5.42% failed 0.00% 22 C_tepperi 5.45% failed 0.02% 23 A_gambie 5.37% failed 3.46% 24 C_pipiens 5.48% failed 0.01% 25 R_pomum 8.37% failed 0.00% 26 C_arakawae 5.36% failed 0.19% 27 A_quadrima 5.48% passed 27.83% 28 A_janconna 5.42% failed 1.57% 29 A_oryzalim 5.42% failed 0.44% 30 S_hybrida 5.48% passed 9.55% 31 A_homuncul 5.30% failed 0.05% 32 A_laneanus 5.30% failed 0.00% 33 T_cockerel 5.53% failed 0.00% 34 A_bellator 5.30% failed 1.64% 35 S_aureohir 5.48% failed 0.00% 36 D_aestival 5.50% failed 0.00% 37 C_tritaeni 5.48% failed 0.19% 38 H_janthino 5.93% failed 0.00% 39 P_vanderpl 5.58% failed 0.01% 40 B_zonata 5.73% failed 0.00% 41 B_scutella 5.04% failed 0.00% 42 B_tau 5.04% failed 0.00% 43 A_grahami 5.78% passed 6.37% 44 N_mamaevi 5.78% failed 0.00% 45 N_umbratil 5.70% failed 0.00% 46 M_stabulan 5.80% failed 1.14% 47 R_pernix 5.75% passed 47.46% 48 S_melanura 5.91% passed 18.72% 49 S_africa 5.78% passed 65.08% 50 D_incompta 6.19% passed 7.36% 51 D_pseudoob 5.83% failed 0.29% 52 S_portschi 5.88% passed 75.11% 53 S_similis 5.88% passed 75.94% 54 A_notoscri 5.55% failed 0.00% 55 C_pinguis 5.78% passed 35.77% 56 S_stercora 5.75% failed 0.00% 57 D_santomea 5.53% failed 0.00% 58 D_melanoga 5.86% failed 0.00% 59 S_peregrin 5.88% failed 0.85% 60 D_antiqua 5.73% failed 0.20% 61 P_utilis 5.70% failed 0.00% 62 C_albiceps 5.78% failed 1.02% 63 P_terraeno 5.78% passed 67.82% 64 C_saffrane 5.78% passed 71.17% 65 H_ligurrie 5.73% passed 42.19% 66 L_porphyri 5.73% passed 35.81% 67 R_goerling 5.95% failed 1.64% 68 C_bezziana 5.78% passed 69.87% 69 C_rufifaci 5.78% failed 0.96% 70 C_megaceph 5.78% passed 74.87% 71 B_correcta 5.73% failed 0.00% 72 E_flavipal 5.75% failed 0.00% 73 S_impatien 5.75% failed 0.01% 74 F_taylori 5.91% failed 3.33% 75 L_huidobre 5.65% passed 23.48% 76 L_bryoniae 5.63% failed 0.02% 77 C_hominivo 5.73% passed 81.84% 78 D_littoral 5.80% passed 9.72% 79 L_sativae 5.70% passed 14.92% 80 E_sorbilla 5.91% failed 0.00% 81 B_minax 5.78% failed 0.00% 82 H_lineatum 5.91% failed 1.39% 83 B_philippi 5.73% failed 0.00% 84 B_carambol 5.73% failed 0.00% 85 B_papayae 5.73% failed 0.00% 86 C_duplonot 5.65% passed 34.96% 87 T_punctata 5.53% failed 0.00% 88 S_grandico 5.55% failed 0.00% 89 D_hominis 5.73% passed 38.92% 90 C_putoria 5.75% passed 79.95% 91 S_crassipa 5.76% passed 88.68% 92 D_mauritia 5.86% failed 0.00% 93 H_irritans 5.75% failed 0.00% 94 C_phaonis 5.78% passed 49.13% 95 B_invadens 5.73% failed 0.00% 96 M_sojae 5.10% failed 2.47% 97 A_miser 4.89% failed 0.87% 98 G_pecorum 5.88% failed 0.00% 99 G_intestin 6.19% failed 0.00% 100 B_melastom 5.73% failed 0.00% 101 M_levida 5.96% failed 0.06% 102 B_umbrosa 5.73% failed 0.00% 103 L_coerulei 5.83% passed 99.09% 104 C_chinghai 5.45% failed 2.55% 105 D_formosan 5.82% failed 1.76% 106 S_albiceps 5.88% passed 99.30% 107 C_vomitori 5.78% passed 18.28% 108 C_nigripes 5.75% passed 62.14% 109 B_arecae 5.80% failed 0.00% 110 B_diaphora 5.73% failed 0.00% 111 L_illustri 6.21% passed 26.80% 112 L_caesar 6.03% passed 53.13% 113 A_mellifer 6.82% failed 0.00% 114 B_mori 5.86% failed 0.00% 115 A_microrhi 9.35% failed 0.00% 116 E_biolleyi 6.64% failed 0.00% **** TOTAL 5.77% 81 sequences failed composition chi2 test (p-value<5%; df=3) Partition file is not in NEXUS format, assuming RAxML-style partition file... ", "Hi Debajyoti, The ERROR message looks like an issue in your partition file. So please check it carefully. Moreover, the outgroup option -o should take a comma-separated list of taxon names WITHOUT empty-space. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7b499ba4-0aba-4003-9e79-9b51e636d4a6%40googlegroups.com <best_scheme.txt> ", "Dear Debajyoti, To follow up on Minh's comment - you cannot simply feed the output from PartitionFinder to IQ-TREE. The best_scheme.txt file contains the information you need, in a format that should work for IQ-TREE, but it also contains other (more detailed) information. You can use the best_schemes.txt file to make an input file suitable for IQ-TREE. Details of what's required for IQ-TREE are here: http://www.iqtree.org/doc/Advanced-Tutorial Rob To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6E8E98BC-70EE-46B4-BEC9-54542E72809F%40univie.ac.at Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com "]}, "czn208gP3WE": {"topic": "-o outgroup option causes error", "initializeDate": "Oct 6, 2017, 6:10:48 PM", "timeStamp": "Oct 11, 2017, 9:44:41 AM", "content": ["Dear Mihn, I am trying to iq-tree with the -o option, but I get an error (below). Do you have any ideas of what could be the problem? I believe the taxon I am assigning as outgroup is not present in all partitions, but not sure if this makes a difference in a concatenated analysis. Let me know if you would like the log file. Thanks! Tauana ERROR: phylotree.cpp:389: void PhyloTree::setRootNode(const char *): Assertion `root' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: 37taxa.log ERROR: *** Alignment files (if possible) /var/slurmd/spool/slurmd/job29592376/slurm_script: line 35: 52178 Aborted ../../scripts/IQ-Tree1.6.beta4/bin/iqtree -nt $cpus -st AA -ninit 10 -bb 1500 -pre $dataset -m MFP+MERGE -rcluster 10 -madd LG4M,LG4X -mrate G,R,E -msub nuclear -s ../matrices/$1/*.nex -sp $3 -o $2 ", "Dear Tauana, I think somebody else reported similar problem, which means that the taxon does not appear in the (concatenated) alignment. It\u2019s fine if this taxon does not appear in some partitions, as long as it indeed appears in at least one partition. Nevertheless can you send me the log file to know exactly where iqtree stopped? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "I sent Minh the log file and this was the problem, just in case anyone else gets the same error: Error: ERROR: phylotree.cppphylotree.cpp::389389: : void PhyloTree::setRootNode(const char *)void PhyloTree::setRootNode(const char *): Assertion `: Assertion `rootroot' failed.' failed. Minh: I see the problem now: ModelFinder will go through the partitions to find the best-fit model for each partition. And this happens for the partition that does not contain the outgroup. So as a quick solution right now, please do not use -o option. You can anyway reroot the tree later on in any tree viewer. Nevertheless, I log this bug and will fix it for the next release. Thanks for reporting the problem! Thanks, Minh! "]}, "gHNCkEdhMXA": {"topic": "BUG: Problem calculating a consensus network: 'Invalid \"-net\" option.'", "initializeDate": "Feb 5, 2018, 7:01:35 PM", "timeStamp": "Feb 5, 2018, 7:01:35 PM", "content": ["Hello, I am attempting to take a set of trees and produce a consensus network. It's not working. I suspect there is a bug in the program. Following the iqtree manual, I've tried \"./iqtree -net repTrees.nwk\" and \"./iqtree -net -t repTrees.nwk\" but both fail, producing the error: \"Invalid \"-net\" option.\" This is true regardless of whether the input trees are in newick or nexus format. By contrast, producing a standard consensus tree via \"./iqtree -con repTrees.nwk\" works fine. I'm using \"IQ-TREE multicore version 1.6.0 for Mac OS X 64-bit built Dec 24 2017\" Of course I may simply be doing this incorrectly\u2014if so, please let me know what I should be doing differently. Many thanks "]}, "4iAK95fbnSA": {"topic": "replacing [+I+G] with FreeRate model [+R]", "initializeDate": "Nov 5, 2015, 3:17:17 PM", "timeStamp": "Nov 6, 2015, 6:29:32 AM", "content": ["Dear IQ-TEAM, I am sorry, perhaps my question is a bit silly, but I need to ask this: When running \"Command: ../../iqtree -s ITS.fas -st DNA -m TESTONLYNEW -mtree\", several models with +I+G were also tested, even the best fit model contained +I+G. Is this normal? I must have misunderstood something. Thanks a lot for your help. J\u00f3zsef ", "Hi Jozsef, not a silly question at all. We have recently changed the behavior of TESTNEW (since ver. 1.3.6), that the FreeRate [+R] model is added into the candidate model set, instead of replacing +I+G. Thus, +I+G is included, and could be selected if it shows smaller AIC/BIC scores than +R. I just forgot to change the help usage. Will do that for the next release of IQ-Tree. In summary, -m TESTNEW will include all models of -m TEST. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Okay, its clear. Thanks for helping me. Cheers,J\u00f3zsef "]}, "Ek1ED2qKGY4": {"topic": "-mset", "initializeDate": "May 31, 2015, 7:28:17 PM", "timeStamp": "Jun 19, 2015, 9:17:14 PM", "content": ["Hi, When using the -mset flag, is there a way to pass a file with the list of models to be tested, rather than listing them on the command line? On a related note, if I want to test all the different permutations only on say the LG matrix (LG, LG+G, ..., LG+R10+F), do I need to specify all models or just LG is enough? Many thanks, Fabien ", "Hi Fabien, > On 01 Jun 2015, at 01:28, bur...@gmail.com wrote: > Hi, > When using the -mset flag, is there a way to pass a file with the list of models to be tested, rather than listing them on the command line? there is no way to pass a file, right now you have to list them all via command line. > On a related note, if I want to test all the different permutations only on say the LG matrix (LG, LG+G, ..., LG+R10+F), do I need to specify all models or just LG is enough? just LG is enough, i.e -mset LG. If you want to change the combination of rates and frequencies, use -mrate and -mfreq. > Many thanks, you are welcome Minh > Fabien > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, So when using the flag -mset LG, on a partitioned alignment of 250 partitions, can you estimate the number of tests that is going to be performed by the merging of partitions until no better fit is recovered? Fabien ", "Hi Fabien, IQ-Tree implemented the same algorithm of Lanfear et al (2012; MBE). They gave the formula for the maximum number of partitioning schemes that need to be examined: S = n^2 - n + 1 where n is the number of input partition (n=250 in your case). You can simply look at the model index IQ-Tree printed and compared with S to know approximately when it will stop. However, n=250 might be too large for this algorithm\u2026. they have developed a faster algorithm for such large data. Cheers, Minh ", "Hi Minh, Would it be possible to implement the faster clustering algorithm available in PartitionFinder (search=rcluster; search=hcluster) to deal with large partition schemes? Running it through iqtree is much better because unlike raxml it also compares the FreeRate model, which fits the data better in almost all cases I have seen. That would be really great. Thanks, Fabien "]}, "llhLMROi5Yo": {"topic": "Must the Lie Markov models have the same rates on each edge?", "initializeDate": "Aug 25, 2017, 1:57:46 AM", "timeStamp": "Aug 28, 2017, 12:17:03 AM", "content": ["Dear IQ-TREE Developers, Is it possible to have different rate matrices (different Qs) on different edges of the tree? For the Lie-Markov models, do you currently fit them to have the same matrix on every edge? Thanks very much, Ben Kaehler ", "Dear Ben, The short answer is No: right now IQ-TREE supports one Q matrix across all edges of the tree. I CC Michael here as he implemented the Lie-Markov models and may have further suggestions. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Thanks very much for the speedy response. (Hi Michael) Cheers, Ben "]}, "v_YmhffdRws": {"topic": "WARNING + ERROR: MF+LM+MERGE", "initializeDate": "Jul 16, 2020, 3:32:58 AM", "timeStamp": "Jul 20, 2020, 8:15:14 AM", "content": ["Hi all, I am trying to find the best model/partitition scheme for an alignment of concatenated ORFs (239 seqs, 8 ORFs). Everything works fine when I use the standard model selection (-m MF+MERGE) but whenever I add the Lie Markov DNA models (-m MF+LM+MERGE) I get quite a lot of warnings saying: 'evec not invertible'. What does this warning mean and is it safe to ignore it? Although iqtree generated a \u2018best_scheme\u2019 file, at the end of the run it apparently crashed. Is this a bug or is something wrong with my data? First 10 lines of log file: IQ-TREE multicore version 2.0.7 for Linux 64-bit built Jun 26 2020 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: bioit-molplat-prod (AVX, 125 GB RAM) Command: iqtree2 -s ORFs-T1.good.phy --seqtype DNA -p ORFs-T1.good.nex -m MF+LM+MERGE --prefix ORFs-T1-MF1 -T AUTO --safe Seed: 757769 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Tue Jul 14 10:56:13 2020 Kernel: Safe AVX - auto-detect threads (24 CPU cores detected) Last part of log file containing error: Best partition model BIC score: 1158181.410 (LnL: -575804.766 df:681) Partition information was printed to ORFs-T1-MF1.best_scheme.nex Partition information in Raxml format was printed to ORFs-T1-MF1.best_scheme All model information printed to ORFs-T1-MF1.model.gz CPU time for ModelFinder: 319324.281 seconds (88h:42m:4s) Wall-clock time for ModelFinder: 157977.507 seconds (43h:52m:57s) NOTE: 440 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.010) ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 () ERROR: 4 GOMP_parallel() ERROR: 5 double PhyloTree::computeLikelihoodBranchSIMD<Vec4d, true, 4, false, false>(PhyloNeighbor*, PhyloNode*) ERROR: 6 PhyloTree::computeLikelihood(double*) ERROR: 7 () ERROR: 8 () ERROR: 9 () ERROR: 10 clone() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: ORFs-T1-MF1.log ERROR: *** Alignment files (if possible) Best regards, Frank ", "Please avoid using Lie Markov with partition models. I\u2019m not sure if it works - we never tested it thoroughly when mixing reversible with non-reversible models in a partitioned analysis Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/bc842d9c-04d4-48a8-b3f4-96ae221754d0n%40googlegroups.com ", "Hi Minh, I have analysed the dataset without partition scheme and I keep getting the warning: 'evec not invertible'. Is it safe to ignore this warning? Best regards, Frank IQ-TREE multicore version 2.0.7 for Linux 64-bit built Jun 26 2020 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: bioit-molplat-prod (AVX, 125 GB RAM) Command: iqtree2 -s ORFs-T1.good.phy --seqtype DNA -m MF+LM --prefix ORFs-T1-NPMF1 -T AUTO --safe Seed: 251718 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Fri Jul 17 10:27:03 2020 Kernel: Safe AVX - auto-detect threads (24 CPU cores detected) 320 4.4a+R5 669516.100 487 1340006.199 1340037.805 1343731.913 333 6.7a+R5 582870.129 489 1166718.258 1166750.127 1170459.272 WARNING: evec not invertible WARNING: evec not invertible WARNING: evec not invertible WARNING: evec not invertible 346 9.20b+R5 582585.624 492 1166155.248 1166187.515 1169919.213 359 12.12+R5 582324.980 495 1165639.960 1165672.629 1169426.876 372 RY2.2b+R5 583847.277 485 1168664.555 1168695.897 1172374.967 385 RY3.3b+R5 583843.314 486 1168658.628 1168690.101 1172376.691 398 RY3.3c+R5 583567.375 486 1168106.750 1168138.224 1171824.813 ", "I already answered you\u2026 Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e1e780be-cacb-478c-9e23-5094afad328en%40googlegroups.com "]}, "g3JAz3nmMAE": {"topic": "-m TEST crash", "initializeDate": "Jul 10, 2015, 3:41:30 AM", "timeStamp": "Jul 13, 2015, 9:05:26 AM", "content": ["Dear all, Can anyone tell me why \"-m TEST\" stops IQ-TREE to run on my PC This command runs properly with the example file supplied with IQ-TREE: iqtree-omp -nt 8 \u2013s example.phy But \" iqtree-omp -nt 8 \u2013s example.phy -m TEST starts to run but stops after a short while The same happens to command \"-m TESTONLY\" I attached the example.phy logfile These are the detailes of the problem: Probl\u00e9maesem\u00e9ny neve: APPCRASH Alkalmaz\u00e1sn\u00e9v: iqtree-omp.exe Alkalmaz\u00e1sverzi\u00f3: 0.0.0.0 Alkalmaz\u00e1s id\u0151b\u00e9lyegz\u0151je: 558f17db Hiba \u2013 modul neve: StackHash_591c Hiba \u2013 modul verzi\u00f3ja: 6.1.7601.18869 Hiba \u2013 modul id\u0151b\u00e9lyegz\u0151je: 556366f2 Kiv\u00e9telk\u00f3d: c0000374 Kiv\u00e9tel \u2013 eltol\u00e1s: 00000000000bfc22 Oper\u00e1ci\u00f3s rendszer verzi\u00f3ja: 6.1.7601.2.1.0.256.4 Ter\u00fcletibe\u00e1ll\u00edt\u00e1s-azonos\u00edt\u00f3: 1038 Tov\u00e1bbi inform\u00e1ci\u00f3k 1: 591c Tov\u00e1bbi inform\u00e1ci\u00f3k 2: 591ccde81fd68856b3506e9093459cc4 Tov\u00e1bbi inform\u00e1ci\u00f3k 3: 812c Tov\u00e1bbi inform\u00e1ci\u00f3k 4: 812cb213e99b73b32b9c5c023d83be29 Thanks a lot for your help. J\u00f3zsef ", "Hi Jozsef, Could you please try to run it again with -nt 4 and -nt 2 on your machine instead? I suspect that your machine only has 4 cores. Are you using a laptop with Core i7? The reason why it showed 8 cores might be because of Hyper-Threading (HT). HT is not good for computationally intensive tasks like phylogenetic inference and could cause trouble (slower, crash, etc.) Cheers Tung You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Tung, Thanks for the prompt reply. Yes, the same crash happens with -nt 2, -nt 4 and -nt 7 (or whatever -nt is). Its is bit misterious. Note that when I replace \"-m TEST\" with \"-m GTR+G\" (or other models), IQ-TREE runs properly on my PC. (e.g. iqtree-omp -nt 8 \u2013s example.phy -m GTR+G\" I have got a PC (Lenovo E73) with 4 cores (Intel i7-4770S CPUs) and 8 threads, 12 GB RAM, and Win7 Enterprise SP1, 64bit. Interestingly, I have succesfully run my dataset with the next command without any problem (I just used -nt 7 to spare some capacity for other apps.): iqtree-omp \u2013nt 7 -s MG_IQ-TREE_infile.fas -spp MG_IQ-TREE_partitionfile_1.txt -b 1000 Any suggestion? Thanks alot! Cheers, J\u00f3zsef ", "Hi Jozsef, I could not reproduce the error here at work because we don't have Windows machines. Could you please re-run the -m TEST command with the following suffix (in bold): \"iqtree-omp -nt 4 -s example.phy -m TEST > iqtree_log.txt 2>&1 Then send us the iqtree_log.txt file so that we can see the error message. Thanks Cheers Tung ", "Hi Jozsef, We managed to reproduce the error on a windows machine and will take a look at it. Thanks for reporting. In the mean time, you can still run the sequential version of IQ-TREE or using iqtree-omp -nt 1 for the -m TEST command Cheers Tung ", "Hi Tung, Thanks! Just in case, I have run the command line you requested: iqtree-omp -nt 4 -s example.phy -m TEST > iqtree_log.txt 2>&1 Attached is the log. Cheers, J\u00f3zsef ", "Dear Jozsef, thanks for reporting, it was a minor memory deallocation problem for Windows version. I fixed this in version 1.3.4 just released. Cheers, Minh <iqtree_log.txt> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Dear Minh and others, Thanks, it works on my PC. Cheers, J\u00f3zsef "]}, "SPkja6U_ZXw": {"topic": "Re: [iqtree] is iqtree testing models properly?", "initializeDate": "Jul 17, 2015, 8:30:59 AM", "timeStamp": "Jul 19, 2015, 1:31:27 PM", "content": ["Dear Siby, On 16 Jul 2015, at 09:30, philips < phi...@nirmalagiricollege.ac.in > wrote: Hi all, I am in serious doubt that the program is not testing all available models with the \"-mset partitionfinder\" option (or without it). I have attached my log file for review. could anyone please check it and tell me if it is working properly. I can\u2019t see anything weird from the log file; the run looks fine for me. Please note that when doing partition model selection, I only print the best-fit model found for each partition instead of printing the scores for all 88 DNA models to shorten the log file - but in the background all models are considered. Moreover, the number of models with \u201c-mset partitionfinder\u201d is smaller than the default. More specifically, for DNA the following models are included with that option: \"JC\" \"F81\" \"K80\" \"HKY\" \"TNe\u201d \"TN\" \"K81\" \"K81u\" \"TIMe\" \"TIM\" \"TVMe\" \"TVM\" \"SYM\" \"GTR\" whereas the default is: \"JC\" \"F81\" \"K80\" \"HKY\" \"TNe\" \"TN\" \"K81\" \"K81u\" \"TPM2\" \"TPM2u\" \"TPM3\" \"TPM3u\" \"TIMe\" \"TIM\" \"TIM2e\" \"TIM2\" \"TIM3e\" \"TIM3\" \"TVMe\" \"TVM\" \"SYM\" \"GTR\" Thus I would not recommend to use this \u201c-mset\u201d command. Also I used the option \"-bb 1000\" (i was asking for 1000 ultrafast bootstrap replicates?) but the program stops after iteration 460 or so.. is this normal. Yes this is normal! these two numbers are for different purposes. The iteration number is meant for the tree search heuristic; IQ-Tree iteratively searches the tree space with the aim to escape local optima (see Nguyen et al 2015; MBE). IQ-Tree indeed generates 1000 bootstrap replicates. Hope that clarifies things Cheers, Minh if it is a problem of my executable I can change it. But I am unable to diagnose this. Any help would be appreciated. siby. You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <log_for_review.txt> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Thanks Minh, for the quick reply, I was seeing only a few models and had a doubt, thanks for clearing that off.. also thanks with the \"-mset partitionfinder\" details.. now I think I will have a clearer head while doing the analyses :P siby. Siby Philip, Ph.D., Assistant Professor - Zoology, Nirmalagiri College, Kannur, Kerala, India, 670701 http://scholar.google.co.in/citations?user=YKQvOc4AAAAJ&hl=en "]}, "vOOu9GoKKws": {"topic": "revPoMo N setup (and related questions)", "initializeDate": "Dec 30, 2019, 10:20:10 AM", "timeStamp": "Dec 31, 2019, 5:29:54 AM", "content": ["Hi, I've been using revPoMo for a series of species-tree inferences, on several datasets, playing a bit with the parameters, and have a couple questions: 1) was previously advised to set-up N for the avg nr seqs/species (species=populations), but because it varies quite a lot in my case I decided to play a bit with that parameter and see if/how inferences changed. They did changed (although not in respect to supported bipartitions, so that's not really terrible.. but they do change). I am considering my \"main\" analysis to be the oe where N is set closer to the average seqs/species, but in case this one varies a lot (say as bellow), how would you proceed? would make sense to pay consider more reliable the inference under the modal value? mean 10.2 median mode 2) I am still wondering a bit how to make sure data is appropriate for revPoMo and model violations are not messing up the inference. I am using it with loci-data, and not genome-wide SNP data, which easily leads to non-independence of sites, of course, but I assumed that if variability was low that would not be a severe problem (trees make sense indeed), but would be great to ear other users / author insights on this. 3) Also, what would be a good proxy for checking data is appropriate? a (low) estimate of theta per \"population\" (would Watterson estimator be an ok measure?)... and regarding the model/sites, should data be bi-allelic within a population or not really needed? thanks in advance, sara ", "Hi Sara, please find my comments below! All the best, Dominik Sara Rocha < spr...@gmail.com > writes: > Hi, > I've been using revPoMo for a series of species-tree inferences, on several > datasets, playing a bit with the parameters, and have a couple questions: > 1) was previously advised to set-up N for the avg nr seqs/species > (species=populations), but because it varies quite a lot in my case I > decided to play a bit with that parameter and see if/how inferences > changed. They did changed (although not in respect to supported > bipartitions, so that's not really terrible.. but they do change). I am > considering my \"main\" analysis to be the oe where N is set closer to the > average seqs/species, but in case this one varies a lot (say as bellow), > how would you proceed? would make sense to pay consider more reliable the > inference under the modal value? > mean 10.2 > median 8 > mode 4 To me it seems that your data fits the requirements of PoMo very well. In some discussions (some more recent than our publications about PoMo), we have seen that the name \"virtual population size\" for the variable N may be misleading. Rather, we can think about N as being the parameter describing the fineness of the discretization or the bin size. With this view, it becomes more apparent that intermediate bin sizes are advantageous because (1) we don't want to treat the system with bins too coarse to catch the allele frequency changes on the population level and (2) we don't want to have too many bins because we assume that mutations only happen at the boundaries. In conclusion, sticking to the default value N=9 is best for most use cases and I would say also for your data. > 2) I am still wondering a bit how to make sure data is appropriate for > revPoMo and model violations are not messing up the inference. I am using > it with loci-data, and not genome-wide SNP data, which easily leads to > non-independence of sites, of course, but I assumed that if variability was > low that would not be a severe problem (trees make sense indeed), but would > be great to ear other users / author insights on this. In my opinion, assuming independence between sites is valid if a moderate set of loci (say more than 30) is analyzed. I hope this is the case for your data. All methods based on substitution models have the same assumption. This includes multispecies coalescent based methods because gene trees are usually inferred using substitution models. > 3) Also, what would be a good proxy for checking data is appropriate? a > (low) estimate of theta per \"population\" (would Watterson estimator be an > ok measure?)... and regarding the model/sites, should data be bi-allelic > within a population or not really needed? This is a good question and I don't really have an answer out of my head. One could have a look at the site frequency spectra, or do a composition chi squared test for the fixed sites as it is done for normal analyses with substitution models. If a species has more than two alleles at a site, this site is ignored in the analysis with PoMo. If your data has many sites of this category, it may be too diverse. I hope that I could help you! > thanks in advance, > sara "]}, "BRsUuJ2ArSs": {"topic": "IQ-TREE version 1.1.4 is released", "initializeDate": "Dec 7, 2014, 3:38:08 PM", "timeStamp": "Dec 7, 2014, 3:38:08 PM", "content": ["Dear users, We have just released version 1.1.4 that fixes several bugs. So please update the new version. More information at http://www.cibiv.at/software/iqtree/ Best, Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at "]}, "N-JDNXg6L-g": {"topic": "Memory issues with IQ-TREE MPI for large phylogenomic dataset", "initializeDate": "Aug 22, 2019, 2:00:34 PM", "timeStamp": "Aug 25, 2019, 12:21:38 AM", "content": ["Hello! I've been trying to build a species tree with the MPI version of IQ-Tree for 1109 taxa using a phylogenomic dataset (279 partitions, GTR model). I've been running iqtree-mpi single threaded for each MPI worker / slurm task. I'm trying to run this on a HPC cluster that uses cgroups to limit CPU and memory usage, but I can't get past the step of initializing the candidate tree set with the total amount of memory I have available (~5100 G of RAM that I've tried spreading out over a various number of cores (50-100)). The furthest I've gotten (with checkpointing) is 181 iterations, and no further progress is being made. Many of my jobs have quit due to insufficient memory allocation, so it appears IQ-Tree is significantly underestimating the memory needed for a single core, unless there is additional overhead that isn't warned about. I've tried using anywhere from 50-100G, depending on the number of cores I've requested. I've taken a look at some of the posts regarding running IQ-Tree with some very large datasets, and I've incorporated some of the suggestions (namely I added the following to my script: - safe ninit pers 0.1), but if anything those additional options seem to have slowed things down further (or possibly even halted the program's progress entirely?). I know the student working on the MPI version has stopped doing so, but do you have any suggestions for how I might proceed to get this run actually moving along? My commands are as follows: srun iqtree mpi 75p _alignments phylip spp partition_file txt 1000 bnni st DNA pre 75p _alignment safe ninit pers 0.1 Thank you so much for your help, Ava ", "Hi Ava, I have improved the MPI version, so it should generally work. I\u2019ll explain below why it takes so much RAM, but my suggestion: Use the multicore version together with MPI. This will save a lot of RAM. Say for example, if you have 10 nodes, each with 16 cores, then you can do: mpirun -np 10 iqtree-mpi -nt 16 \u2026 [remaining options here] This should more efficiently utilise all 160 cores using less RAM. The only option I didn\u2019t test is: I don\u2019t know if -bnni works with MPI version\u2026 Now the explanation: The multicore version is shared memory, whereas MPI is not. Therefore, if a single run needs 10 GB RAM, then the above MPI-multicore run will need 10*10 GB in total for all 10 nodes. However, doing: mpirun -np 160 iqtree-mpi -nt 1 \u2026 will take 10*160 GB RAM. This is a factor of 16 times higher than previous run. Let me know how this configuration works. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/29b4dbfe-bc6f-4fbd-96af-01ea49ef6302%40googlegroups.com "]}, "mVYMa05XndI": {"topic": "iqtree errors after fixing in sequencematrix", "initializeDate": "Feb 7, 2021, 11:30:28 AM", "timeStamp": "Feb 9, 2021, 6:15:22 AM", "content": ["Dear iqtree group, I am trying to get data from iqtree using 6 genes, so I combined them by using sequencematrix. The First attempt was fine, but after I checked the result, I realized that I need to delete some unnecessary data so I deleted them. Thereafter, I used sequencematrix again to combine newly fixed data. And when I tried the iqtree again, it did not work at all. the error message is below: ERROR: Line 13: Sequence Epeolus_alpinus has wrong sequence length 3864 But the problem is that Epeolus alpinus has the only 657bp so I have no idea what the 3864 means. it would be very helpful and grateful if anybody could give me the advice since I have been struggling for a week. Thank you for your time and reply in advance. Best regards, Kayun. ", "Hi Kayun, I\u2019d say this error message speaks for itself, it gives you enough information to find and fix errors. Perhaps one thing to note here, is that 3864 includes also gaps and missing data. When you says it has only 657bp, I think you meant the raw sequence length before alignment. But in the alignment, gaps will be added. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/71e3f408-df40-4417-97fb-a03c295a2be2n%40googlegroups.com "]}, "ogfbZHD72Zo": {"topic": "Error:  cannot open shared object file: No such file or directory", "initializeDate": "May 1, 2018, 9:46:04 AM", "timeStamp": "May 1, 2018, 10:17:03 AM", "content": ["I'm getting this error (this is the full Run Log) using the web interface: ../../iqtree: error while loading shared libraries: libomp.so: cannot open shared object file: No such file or directory I first got this last night when using a new data file. This morning I tried running a file that had previously worked and got the same error/outcome. The server load is reported at 0%, which is unusual. I would appreciate if you could check into what might be causing this. Thanks! ", "Hi, Thanks for reporting this! It\u2019s because we didn\u2019t properly update the executable when upgrading the latest version 1.6.4 of IQ-TREE. Nevertheless it\u2019s just resolved now. You can now submit jobs again. Sorry for the inconvenience! Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Minh, Thank you for a fast reply and resolution of the problem. It is indeed working again! Best, Jessica "]}, "Doo1hu1dQ6U": {"topic": "Combine morphological and sequence data, including fossils (i.e., no-sequence-data tips)?", "initializeDate": "Feb 24, 2020, 3:29:04 PM", "timeStamp": "Mar 5, 2020, 8:41:55 PM", "content": ["Hello, I have found IQ-TREE to work well with morphological data, and I am very happy about the more-complex models available. However, because I have extinct taxa in my matrix (i.e., terminals lacking sequence data), I receive the following WARNINGS and the program quits with this ERROR: WARNING: Sequence Fedtschenkia_anthracina contains only gaps or missing data ... WARNING: Sequence Bethylonymellus_bethyloides contains only gaps or missing data ERROR: Some sequences (see above) are problematic, please check your alignment again The warning is thrown for all of the fossils in the alignment, and is fatal to my application of the program. If there were some way of flagging fossil terminals that allows them to be included in a combined morphological and molecular analysis, that would be extremely helpful. Thank you, Brendon ", "Hi Brendon, You can try -keep_empty_seq option. Still I\u2019m not totally convinced to do such analysis \u2014 can you send me me the command line and the log file? Then I can shed further light whether this is a valid analysis or not. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/64e15709-2626-4af7-a0f7-6953760bd281%40googlegroups.com ", "I am also very interested in the combined morphological and sequence data with fossils. Is it OK to do such analysis in IQ-tree? Has the problem been solved by -keep_empty_seq? Care for the progress, Thank you! Sincerely Luyan \u5728 2020\u5e742\u670826\u65e5\u661f\u671f\u4e09 UTC+8\u4e0b\u53485:34:21\uff0cMinh Bui\u5199\u9053\uff1a Hi Brendon, You can try -keep_empty_seq option. Still I\u2019m not totally convinced to do such analysis \u2014 can you send me me the command line and the log file? Then I can shed further light whether this is a valid analysis or not. Cheers, Minh On 24 Feb 2020, at 12:29 pm, Brendon Boudinot < boud...@gmail.com > wrote: Hello, I have found IQ-TREE to work well with morphological data, and I am very happy about the more-complex models available. However, because I have extinct taxa in my matrix (i.e., terminals lacking sequence data), I receive the following WARNINGS and the program quits with this ERROR: WARNING: Sequence Fedtschenkia_anthracina contains only gaps or missing data ... WARNING: Sequence Bethylonymellus_bethyloides contains only gaps or missing data ERROR: Some sequences (see above) are problematic, please check your alignment again The warning is thrown for all of the fossils in the alignment, and is fatal to my application of the program. If there were some way of flagging fossil terminals that allows them to be included in a combined morphological and molecular analysis, that would be extremely helpful. Thank you, Brendon You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Luyan, On 5 Mar 2020, at 1:31 pm, YanYan < lil...@163.com > wrote: I am also very interested in the combined morphological and sequence data with fossils. Is it OK to do such analysis in IQ-tree? Has the problem been solved by -keep_empty_seq? It should work in principle, without -keep_empty_seq. This option is only relevant when you see such warning: WARNING: Sequence Bethylonymellus_bethyloides contains only gaps or missing data Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/582007a3-8379-46d0-a04d-692669fa5a11%40googlegroups.com "]}, "fnOJcy6btj4": {"topic": "Using LG4X/LG4M in IQtree", "initializeDate": "Mar 31, 2016, 10:54:56 PM", "timeStamp": "Apr 1, 2016, 3:46:23 PM", "content": ["I am trying to use IQtree to do model selection on a tree with 2800 OTUs and an alignment of amino acids 3279 positions long. Whenever I attempt to use LG4X via \"-madd LG4X\" or \"-madd MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4\" then use \"-mset LG4x\" I get this error: Model LG4X is alias for MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4 ERROR: Invalid model name LG4X When I substitute \"LG4X\" in -mset to \"MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4\" I get an error where IQtree attempts to read/add a second starting tree starting with \"MIX....\". I also get a fair amount of these warnings during model selection \"WARNING: Numerical underflow caused by alignment sites 1844 1847\" do you know what might be causing these? I am at a loss on how to move forward here. Any advise you have is appreciated. ", "Dear Andrew, > On Apr 1, 2016, at 4:54 AM, swaffor...@gmail.com wrote: > I am trying to use IQtree to do model selection on a tree with 2800 OTUs and an alignment of amino acids 3279 positions long. > Whenever I attempt to use LG4X via \"-madd LG4X\" or \"-madd MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4\" then use \"-mset LG4x\" I get this error: > Model LG4X is alias for MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4 > ERROR: Invalid model name LG4X -madd LG4X is a valid option to additionally consider LG4X for model selection, whereas -mset LG4X is not. that\u2019s why the error. > When I substitute \"LG4X\" in -mset to \"MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4\" I get an error where IQtree attempts to read/add a second starting tree starting with \"MIX....\u201d. see above. > I also get a fair amount of these warnings during model selection \"WARNING: Numerical underflow caused by alignment sites 1844 1847\" do you know what might be causing these? Can you please send me the log file? Cheers, Minh > I am at a loss on how to move forward here. Any advise you have is appreciated. > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thank you for your reply! that makes much more sense. Just to double check that I'm understanding the solution - when attempting to include LG4x in a constrained set of models (JTT, etc..) through -mset I can just include \"-madd LG4X\" and it will be added into the comparison? Best! ", "Dear Andrew, > Thank you for your reply! that makes much more sense. Just to double check that I'm understanding the solution - when attempting to include LG4x in a constrained set of models (JTT, etc..) through -mset I can just include \"-madd LG4X\" and it will be added into the comparison? That\u2019s right, in fact this topic was discussed in details in a previous thread: https://groups.google.com/forum/#!topic/iqtree/7aBLeUraP7Q Minh > Best! ", "Dear Andrew again, from the log file there are two problems. The first was already discussed, from the command line: -madd LG4X,LG4M -mset LG,LG4X,LG4M,JTT,WAG you should remove LG4X and LG4M from the -mset list. The second problem about numerical underflow was due to many short partitions like this: ... Reading partition Subset18 (model=JTT, seq=AA, pos=41 400 482 1096 ...) ... 2862 sequences and 7 sites extracted Reading partition Subset19 (model=VT, seq=AA, pos=49) ... 426 sequences and 1 sites extracted 63 sequences and 2 sites extracted Reading partition Subset23 (model=VT, seq=AA, pos=87) ... 52 sequences and 1 sites extracted Reading partition Subset24 (model=JTT, seq=AA, pos=89 90) ... 54 sequences and 2 sites extracted ... any many more. I don\u2019t know how did you partition the data like this, but this is definitely over-parameterization and should be avoided. Since your: Alignment has 2876 sequences with 3499 columns and 3279 patterns (1850 informative sites) Why don\u2019t you just use a single model instead of partition model? Cheers, Minh On Apr 1, 2016, at 5:52 PM, Andrew Swafford < swaffor...@gmail.com > wrote: Hi Minh, Here's the log file for a job with the numerical underflows - thank you so much for taking the time to look at this! Best, -Andrew <IQTREE_Screen_LG4x.log> ", "Thanks again! I was trying partitionfinder - the number of partitions did seem quite extreme. I've set IQ tree going with the proper -madd and -mset commands and it's running well. Thank you for your time & feedback! Best, -Andrew "]}, "R3wFZllfOFY": {"topic": "Getting a branch-specific rate using LSD (option -j)", "initializeDate": "Dec 8, 2020, 1:28:18 PM", "timeStamp": "Dec 15, 2020, 3:00:15 PM", "content": ["Hi, When using LSD with option -j, we get some additional data about each branch (sample output is attached). The output prints node_id/tip-label, branch length (in units of substitutions/site), elapsed time on the branch, root-to-tip distance to the node, and the date of the node. Can you guide how can one calculate the rate of each branch separately from this output? I imagine it should be the branch length in substitutions divided by the elapsed time, however, it does not give the intended result. Moreover, LSD collapses null branches (internal and others). How does that affect the rate calculation? In other words, what will be the simplest way to get a branch-specific rate using this output? thanks! ", "Hi Arshan, The branch length in the output of option -j is the branch length of the input tree; not the output tree. That's why you didn't get what you expect when you divide them to the elapsed time. For your purpose, you can divide the branch lengths of 2 output trees (.nex). The one .date.nex presents the elapsed time, and the other one presents the nb of substitution per site. You can do that by, for example, read the 2 nexus trees in R. However, if you have specified a tree partition, then the rate of each part (so the rate of all branches in each part) is reported in the result file. Hence, you know the rate of each branch by just looking at which part it belongs to; you don't need to divide the branch lengths of 2 output trees. The small branches are collapsed before the analysis, so their rates are not estimated in both 2 output trees. If you get some null branch lengths in the output trees, it's due to the minimim branch length (-u) was set to 0. You can increase this if you want to avoid null branches; or just ignore them if you don't really need those branches. Hope that helps! Best regards, Hien You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b70545aa-085c-4e26-82f3-55989299c528n%40googlegroups.com ", "Dear Hein, thanks for your response. I attached my two nexus trees from the LSD output. It seems that dividing the branch lengths gives identical rate to each branch (0.023). I was under the impression that rates would be different for each branch. Am I missing or misunderstanding something? thanks for all your input. Best wishes You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/R3wFZllfOFY/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAKjtwTxCSOF-CuKGrHa-ub83hhw4wp4qAdKdiaG9T2vjb4foqQ%40mail.gmail.com ", "Hi Arshan, The rate of all branches in the time-scaled tree should be the same as you observed (and it is the rate reported in the result file). Except when you use option -E then internal and external branches have different rates, or option -p to specify tree partition then the branches in each part have different rates. Cheers, Hien To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAEyE%3DN1umRsRYcds-5jhUacw%2BcfWkKr9GYRSmDVw_FA2ZV0Gug%40mail.gmail.com "]}, "nu4WLSWmX2w": {"topic": "IQTREE hang after computer was herbinated", "initializeDate": "Jul 2, 2018, 7:59:13 AM", "timeStamp": "Jul 2, 2018, 10:50:55 PM", "content": ["Dear Developers, After put my computer sleep -> wake again => I do not see the program continuing run. I left it nearly a day, but nothing happen. Would you please help? Best regards, Giap Nguyen ", "Hi Giap, Which operation system are you using? There\u2019s a freezing problem just fixed in v1.6.6: Freezing caused by old Intel OpenMP library (reported by David Maddison). Thus, can you test this version and let us know? Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "vsw52-OO_5M": {"topic": "query about the protein model selection for phylogenetic tree in IQ-Tree", "initializeDate": "Aug 25, 2019, 9:00:17 AM", "timeStamp": "Aug 26, 2019, 9:28:49 AM", "content": ["Dear Dr. Bui Quang Minh I am a PhD student at NIBGE. I am trying to use IQ-TREE to generate a phylogenetic tree. There are 1700 amino acid sequences with thousands length from 32 plants. Our aim is to identify the evolutionary relationship of these plants. I have tried for model selection based on the tutorials and manual guideline but could not decide which one will be the best of this analysis. I search on internet bet did not find any perfect solution. We have two servers with 32CPU and 82CPU. Currently, I am using 32 CPU server. When I use default parameters, the Modelfinder finds above 400 models to test and the process is taking toom much time. So, please suggest me the best protein model for this analysis. I am looking forward to hear from you. Thank you Athar ", "Hi Athar, Do you have a single gene alignment? I\u2019m assuming Yes for now. Is it a nuclear gene? Again, I\u2019m assuming yes. If so, you can do the following the speed it up: iqtree -s ALN_FILE -m TEST -msub nuclear -mfreq F These options are described here: http://www.iqtree.org/doc/Command-Reference#automatic-model-selection Once you identified the best protein substutition model, you can continue with a more thorough model selection that will take into account the free-rate model (assuming that LG was selected from the command above): iqtree -s ALN_FILE -mset LG -mfreq F If you, however, have a partition data set, then there is anoother set of commands to speed things up. If that\u2019s the case, let me know. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ddbb3cbe-872a-4d76-8533-20a642eb0dd1%40googlegroups.com "]}, "Sq_PraGS7M4": {"topic": "IQ-TREE release 1.6.3", "initializeDate": "Mar 22, 2018, 12:01:15 AM", "timeStamp": "Mar 22, 2018, 12:01:15 AM", "content": ["Dear users, We are pleased to announce version 1.6.3, which improves software stability with bug fixes and new features like parallel SH-aLRT test, jackknifing or GTR model for multistate/morphological data. It is recommended for update for all users. Bugfixes: \u2022 Abort in ModelFinder when a user tree is supplied via -t option. \u2022 Erroneous message \u201cleaves and taxa_set do not match\u201d by rooted user tree (-t) and partition model (reported by Dieter Waechter). \u2022 Abort in ModelFinder by -sp option (edge-unlinked) and -mtree. \u2022 Error-checking partition with identical names. \u2022 Crash with rooted user trees via -z option. \u2022 Change ERROR about Too many iterations in tqli to WARNING. \u2022 Abort with combination of -nt AUTO and -mtree (reported by Mark Miller). \u2022 Crash with -bnni and -spp by temporarily turning on NNI5 instead of NNI1 (originally reported by Xiaofan). \u2022 Quitting by mixed data types (reported by Stephen Baca). \u2022 Crash with numerical underflow for lh-branch (reported by Karen Siu Ting). New features: \u2022 -ntmax option to specify maximum number of threads by -nt AUTO option (requested by @sjspielman). \u2022 SH-aLRT test is now parallelised over multiple cores (requested by Heiner Kuhl). \u2022 Support GTR model for multistate data (requested by Sergio Andres Munoz Gomez). \u2022 Support jackknife with new option -j (requested by Emmanuel Toussaint). \u2022 New option -version to display version number (requested by David Maddison). Kind regards, IQ-TREE development team "]}, "DOJIkIjB6Vw": {"topic": "Sequencing error model", "initializeDate": "Sep 1, 2020, 2:32:54 PM", "timeStamp": "Sep 7, 2020, 7:20:35 PM", "content": ["Hi Minh, I was browsing the IQtree recent releases and found a mention of a sequencing error model +E option in the 2.0.8 release -- is this described somewhere? (I'm not sure I need to use this but I was curious about it). It does not appear to be described in the options menu in 2.1.1. Best, Jake ", "Hi Jake, This is the model that we\u2019re experimenting right now, that\u2019s why it doesn\u2019t appear in the help usage yet. But you can use it with option like -m GTR+E+G. It\u2019s basically the sequencing error model described in Felsenstein 2004 book. It has an extra parameter epsilon, where we assume that every character in the alignment has a probability of epsilon to be wrongly sequenced. Epsilon will be estimated from the data. When epsilon = 0, it reduces to the standard GTR+G model. Typically I think it doesn\u2019t matter, as long as epsilon is small. But we\u2019re playing with some site-specific error (mixture) models for COVID-19 alignment. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/27258ba9-196f-4a44-a3a1-efca0b547513n%40googlegroups.com "]}, "J35d92DBgqs": {"topic": "source code compilation error", "initializeDate": "Apr 24, 2020, 10:39:43 AM", "timeStamp": "May 5, 2020, 9:09:02 PM", "content": ["Hi! I'm trying to compile IQTREE source code for Windows. When running the command : cmake -G \"MinGW Makefiles\" -DCMAKE_C_COMPILER=clang -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_FLAGS=--target=x86_64-pc-windows-gnu -DCMAKE_CXX_FLAGS=--target=x86_64-pc-windows-gnu -DCMAKE_MAKE_PROGRAM=mingw32-make ..\" I get the following error- CMake Error at C:/Program Files/CMake/share/cmake-3.17/Modules/CMakeTestCCompiler.cmake:60 (message): The C compiler \"C:/Program Files (x86)/LLVM/bin/clang.exe\" is not able to compile a simple test program. It fails with the following output: Change Dir: C:/Users/n1234/IQTREE_SOURCE_CODE/IQ-TREE-2.0.3/build/CMakeFiles/CMakeTmp\" I installed CMake,Eigen3 library and Clang. Any idea how to solve it ? Thanks!! ", "Hi there, It appears you used clang 32-bit version to compile 32-bit IQ-TREE, as the path for clang compiler is \"Program Files (x86)\u201d. This is not recommended, please install clang 64-bit, and the path to clang should be \"C:/Program Files/LLVM/bin/clang.exe\" If you still insist to compile 32-bit version, then please change the target to to i686 as written here: http://www.iqtree.org/doc/Compilation-Guide#compiling-32-bit-version Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/86522475-9bea-40c5-9a25-61a1df763090%40googlegroups.com ", "Hi Noa, You also need to install mingw-w64 ( http://mingw-w64.org/doku.php ) and then set PATH to the installed binaries, e.g.: set PATH=c:\\mingw-w64\\x86_64-8.1.0-posix-seh-rt_v6-rev0\\mingw64\\bin;%PATH% before compling. Clang needs to use the gcc libraries. Not sure why I missed this information in the compilation guide. Cheers Minh On 28 Apr 2020, at 11:16 pm, Noa Ecker < n12...@gmail.com > wrote: Thanks ! I installed the 64-bit version , but the problem persists. I get the following similar error: C:\\Users\\n1234\\IQTREE_SOURCE_CODE\\IQ-TREE-2.0.3\\build>cmake -G \"MinGW Makefiles\" -DCMAKE_C_COMPILER=clang -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_FLAGS=--target=x86_64-pc-windows-gnu -DCMAKE_CXX_FLAGS=--target=x86_64-pc-windows-gnu -DCMAKE_MAKE_PROGRAM=mingw32-make .. -- The C compiler identification is Clang 10.0.0 -- The CXX compiler identification is Clang 10.0.0 -- Check for working C compiler: C:/Program Files/LLVM/bin/clang.exe -- Check for working C compiler: C:/Program Files/LLVM/bin/clang.exe - broken CMake Error at C:/Program Files/CMake/share/cmake-3.17/Modules/CMakeTestCCompiler.cmake:60 (message): The C compiler \"C:/Program Files/LLVM/bin/clang.exe\" is not able to compile a simple test program. It fails with the following output: Change Dir: C:/Users/n1234/IQTREE_SOURCE_CODE/IQ-TREE-2.0.3/build/CMakeFiles/CMakeTmp "]}, "jP61ED2GezU": {"topic": "BUG: Crash during ASR using UNREST model", "initializeDate": "May 16, 2020, 11:58:24 PM", "timeStamp": "May 18, 2020, 1:49:53 AM", "content": ["Hello, Please note that when doing ASR, using UNREST as a model causes a crash, whereas its functionally similar model 12.12 works fine. Just thought you may want to know. If UNREST and 12.12 do differ, please advise. Thank you, Sergios IQ-TREE multicore version 1.6.12 for Mac OS X 64-bit built Aug 15 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: laptop (AVX2, FMA3, 16 GB RAM) Command: iqtree-1.6.12 -nt AUTO -s haps.fasta -m UNREST+G -te haps.iqtree.UNRESTG.tre -asr -pre haps.iqtree.UNREST4.ASR Seed: 948819 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Sat May 16 23:34:50 2020 Kernel: AVX+FMA - auto-detect threads (4 CPU cores detected) ...... ERROR: phylokernelnonrev.h:1081: double PhyloTree::computeNonrevLikelihoodBranchSIMD(PhyloNeighbor *, PhyloNode *) [VectorClass = Vec4d, nstates = 4, FMA = true]: Assertion `0 && \"Numerical underflow for non-rev lh-branch\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 2 _sigtramp() ERROR: 5 double PhyloTree::computeNonrevLikelihoodBranchSIMD<Vec4d, 4, true>(PhyloNeighbor*, PhyloNode*) ERROR: 6 PhyloTree::optimizeAllBranches(int, double, int) ERROR: 7 PhyloTree::testNumThreads() ERROR: 8 runTreeReconstruction(Params&, IQTree*&) ERROR: 9 runPhyloAnalysis(Params&, Checkpoint*) ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: haps.iqtree.UNREST4.ASR.log ERROR: *** Alignment files (if possible) ", "Hi Sergios, There is a bug in UNREST model in v1.6, which was fixed in v2.0. So please use v2.0 or just use model 12.12, which is exactly the same but differently implemented. Because they are the same, I didn\u2019t bother to fix it in v1.6. Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6d267229-e188-4dfa-9d36-9bcf03aac145%40googlegroups.com ", "Thank you, Minh, What is the difference between UNREST and NONREV in v2.0.5? Also, does IQtree relabel the tree nodes every time it computes an ASR? Best, Sergios Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Sergios, On 18 May 2020, at 1:03 pm, Sergios-Orestis Kolokotronis < kol...@gmail.com > wrote: Thank you, Minh, What is the difference between UNREST and NONREV in v2.0.5? In theory they are the same, but UNREST is for DNA and NONREV is for protein. Just different names for different data types. Also, does IQtree relabel the tree nodes every time it computes an ASR? Yes, the nodes are relabeled so that they match the output ASR file. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9486ab4e-5ad2-4a01-a348-c8ed05593e89%40googlegroups.com "]}, "SaHsGujckOI": {"topic": "IQ-TREE version 1.6.7 (Xeon Phi Knights Landing Linux)  Doesn's support parallelization?", "initializeDate": "Aug 30, 2018, 5:55:06 AM", "timeStamp": "Sep 4, 2018, 1:55:18 AM", "content": ["Below is the PBS job script used to run iqtree on a Xeon Phi Knights Landing Linux Cluster, application terminated soon after started running. my sequence length is small and number of sequence is more that 1000, hence the application terminate with a message segmentation fault and not utilizing the cluster cpus completely. I don't have direct access to cluster nodes to execute each bootstrap as a separate process using -bo option and generate consensus tree using that result. Is there any inbuilt option in iqtree to run bootstrap in parallel? #!/bin/sh #PBS -l select=1 #PBS -l accelerator_type=Intel #PBS -l place=scatter #PBS -S /bin/sh@sdb -V . /opt/modules/default/init/sh cd /mnt/lustre/bio/biosilva/software/iqtree-1.6.7-LinuxKNL/bin aprun -n 64 -N 64 iqtree -s protein_subfamily_final.msa -b 200 -nt AUTO -m MFP -mset JTT,LG,VT -mtree -safe Note: http://www.serc.iisc.in/facilities/cray-xc40-named-as-sahasrat/ (Cray XC40 was the super computer used to run iqtree) ", "Hi, Can you please paste the crash message and the stack trace here? (Note that you have to compile IQ-TREE for this cluster yourself, so that the stack trace works). I have only tested the Xeon Phi KNL version a little in a local cluster. Have you tried the normal version (non-KNL) there? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "I have installed successfully and ran iqtree but the program crash with the below error ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: protein_subfamily_final.msa.log ERROR: *** Alignment files (if possible) ERROR: STACK TRACE FOR DEBUGGING: ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: ERROR: *** Log file: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULTprotein_subfamily_final.msa.log ERROR: *** For bug report please send to developers:ERROR: *** Alignment files (if possible) ERROR: *** Log file: protein_subfamily_final.msa.log ERROR: *** Alignment files (if possible) [NID 00032] 2018-08-31 13:34:06 Apid 619273: initiated application termination output of logfile is as below Failed to read distance. Failed to read distance. Failed to read distance. Failed to read distance. Failed to read distance. Failed to read distance. Failed to read distance. Failed to read distance. Failed to read distance. Failed to read distance. Failed to read distance. Application 619273 exit signals: Segmentation fault, Killed Application 619273 resources: utime ~42273s, stime ~120s, Rss ~282876, inblocks ~122, outblocks ~797848 PBS file I used for the run is as below #!/bin/sh #PBS -l select=1 #PBS -l accelerator_type=Intel #PBS -l place=scatter #PBS -S /bin/sh@sdb -V . /opt/modules/default/init/sh cd /mnt/lustre/bio/biosilva/August/30 aprun -n 64 -N 64 /home/staff/bio/biosilva/Cray_XC40/Software/iqtree_1.6.7/bin/iqtree -s protein_subfamily_final.msa -b 100 -m MFP -mset JTT,LG,VT -mtree -safe Thanks ", "I have tried with the below command but its not using all the processor from KNL cluster has instead the program using only one cpu. I wanted to use all 256 CPU cores available on KNL cluster by splitting 100 bootstrap process into individual process and run independently and parallel. \"iqtree -s protein_subfamily_final.msa -nt AUTO -djc -b 100 -m MFP -mset JTT,LG,VT -mtree -safe\" Host: nid00033 (AVX512, FMA3, 94 GB RAM) Command: /home/staff/bio/biosilva/Cray_XC40/Software/iqtree-1.6.7_mpi_knl/bin/iqtree -s /mnt/lustre/bio/biosilva/September/1/nr_J-protein_subfamily_final.msa -nt AUTO -djc -b 100 -m MFP -mset JTT,LG,VT -mtree -safe Seed: 29251 (Using SPRNG - Scalable Parallel Random Number Generator)TTime: Sat Sep 1 10:31:50 2018 Kernel: Safe AVX-512 - auto-detect threads (256 CPU cores detected) ....... on chi2 test (p-value<5%; df=19 CCreate initial parsimony tree by phylogenetic likelihood library (PLL)... 14.095 seconds NOTE: ModelFinder requires 1499 MB RAM! ModelFinder will test 78 protein models (sample size: 691) ... ===> Testing model JTT Measuring multi-threading efficiency up to 256 CPU coreIIIncrease to 10 rounds for branch length7777 trees examined Threads: 1 / Time: 289.878 sec / Speedup: 1.000 / Efficiency: 100% / LogL: -3226TTTThreads: 2 / Time: 516.169 sec / Speedup: 0.562 / Efficie ncy: 28% / LogL: -322668 BEST NUMBER OF THREADS: 1 NOTE: 149 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.100)11. Initial log-likelihood: -165204.3OOOOptimal log-likelihood: -147891.761 Parameters optimization took 1 rounds (27.581 sec) Thanks Vigneshwaran ", "Hi, I just saw this document https://research.csc.fi/sisu-using-aprun-to-execute-parallel-processes because I don\u2019t know what is -n and -N option of aprun. And now I see the problem: Is it because you use MPI, but IQ-TREE executable does not support MPI! So please don\u2019t use this MPI feature\u2026 that caused the problem. Minh ", "Dear Minh Bui, iqtree compiled for KNL using only one processor, my machine has 256 cores and should be used through PBS batch system, I would like to run each bootstrap replications as individual process. Is the any chance to do like that? I have compiled MPI version of iqtree separately to use without KNL, Is it possible to tell iqtree to run bootstrap independently and individually, instead of running sequentially? like -bo option but using MPI to split job and run in a batch system. Thanks Vignesh "]}, "gr4NdIMte7E": {"topic": "bug fix release 1.2.1", "initializeDate": "Feb 18, 2015, 8:36:32 AM", "timeStamp": "Feb 18, 2015, 8:36:32 AM", "content": ["Dear all, yesterday I released version 1.2.1 that fixes a bug introduced in version 1.2.0 causing wrong SH-aLRT support values (if you use \u201c-alrt\u201d option). All previous releases (1.1.X or before) are not influenced by this bug. The IQ-Tree web server was also updated with this release. So in case you have run version 1.2.0 with -alrt option, please rerun the analysis. Sorry for any inconvenience that might have caused. Cheers, Minh "]}, "-b3hkVXfv3E": {"topic": "a question regarding -t RANDOM option", "initializeDate": "Oct 27, 2020, 7:45:24 AM", "timeStamp": "Oct 27, 2020, 10:20:23 PM", "content": ["Hey, I want to use the -t RANDOM option in IQTREE. How exactly is the random tree generated? Which algorithm is used for doing this? Thanks!!! ", "Hi there, The random tree is generated under the Yule model (birth only model), with branch lengths drawn from an exponential distribution with mean 0.1. See http://www.iqtree.org/doc/Command-Reference#generating-random-trees Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAG%2B0nbZQxsW1FNKRgNGNXN8TS%2BfT%3DVeyQX%2BhQxaLOCpq%2B8QQww%40mail.gmail.com "]}, "Cq_YT0_LIlU": {"topic": "IQ Tree Server Issues", "initializeDate": "Apr 9, 2018, 7:24:58 PM", "timeStamp": "Apr 10, 2018, 4:28:58 AM", "content": ["Currently, trying to upload a file results in: Your aln_file isn't valid, we couldn't upload it to our server When selecting to use example alignment instead, this results in: Cannot write log file. Sorry, there is an issue with the cluster system. We are trying to resolve it asap! The alignment file appears to be valid, as it works correctly from iqtree via cli: ./iqtree -s ~/Desktop/phy.txt File is also attached. Have tried in Chrome and Firefox on macOS and Ubuntu Linux. Any help would be appreciated. ", "Hi there, Yes there is currently some network maintenance, which might take time until tomorrow to finish. So the system is not working right now. We will send another message here once this is done. Sorry for the inconvenience\u2026 As alternative you can download and run IQ-TREE from the command line (as you did below) or use another web server at Los Alamos Laboratories: https://www.hiv.lanl.gov/content/sequence/IQTREE/iqtree.html Or at CIPRES: https://www.phylo.org Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <phy.txt> ", "The issue with iqtree.cibiv.univie.ac.at has been solved! You can now submit jobs again. Cheers Minh "]}, "-lir47w9kxE": {"topic": "Confusing support values", "initializeDate": "Mar 11, 2021, 3:34:18 PM", "timeStamp": "Mar 14, 2021, 9:31:33 PM", "content": ["Hello, I am trying to produce ultrafast bootstrap values with IQTREE2 and getting confusing support values. Below are the resulting trees produced from ten sequences with three different commands (I have the same issue on my much larger dataset): iqtree2 -s test.fasta -m GTR+G -T 8 --mem 100G -v --prefix test_B -B 1000 (leaf0:0.0184484606,(leaf1:0.0315314772,(((((leaf2:0.0157865403,leaf4:0.1360513726)7/36:0.0027623327,(leaf3:0.0178815741,leaf6:0.0177613912)5/66:0.0032142999)6/22:0.0000020072,leaf8:0.0241956621)4/59:0.0039770877,leaf7:0.0349197495)3/56:0.0021890937,leaf9:0.0293687475)2/53:0.0027901055)1/59:0.0033652742,leaf5:0.0302979423)0; iqtree2 -s test.fasta -m GTR+G -T 8 -alrt 1000 --mem 100G -v --prefix test_altr (leaf0:0.0184459054,(leaf1:0.0315274184,(((((leaf2:0.0157770803,leaf4:0.1359963112)8/52.3:0.0027646801,(leaf3:0.0178802350,leaf6:0.0177595826)8/82.9:0.0032153063)9:0.0000020074,leaf8:0.0241949805)4:0.0039770318,leaf7:0.0349162557)3:0.0021894164,leaf9:0.0293592859)2:0.0027910644)1:0.0033651265,leaf5:0.0302940033)0; iqtree2 -s test.fasta -m GTR+G -T 8 -alrt 1000 --mem 100G -B 1000 -v --prefix test_altr_B (leaf0:0.0184465841,(leaf1:0.0315399908,(((((leaf2:0.0157726981,leaf4:0.1361407226)8/53.8/35:0.0027747751,(leaf3:0.0178802162,leaf6:0.0177638393)8/79.9/65:0.0032119674)9/22:0.0000020053,leaf8:0.0241953734)4/55:0.0039752147,leaf7:0.0349244998)3/56:0.0021917228,leaf9:0.0293645816)2/54:0.0027848548)1/59:0.0033679264,leaf5:0.0303025009)0; How should I interpret double (or even triple, as in the last tree when combining ultrafast bootstraps with SH-aLRT) values of supports? I cannot understand why am I getting double values using the first command. Below are the details of the alignment (ready to provide if that helps): Alignment has 10 sequences with 1244 columns, 140 distinct patterns 75 parsimony-informative, 159 singleton sites, 1010 constant sites Thank you! ", "Is this the tree you get from the .treefile? On a side note, I\u2019d not use -v option for verbosity in a normal run. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ca7211cd-9a4c-4349-a1e6-a8302bbfe42fn%40googlegroups.com "]}, "KUFL9qO5fBI": {"topic": "Change Sequence names", "initializeDate": "Oct 30, 2020, 11:39:07 AM", "timeStamp": "Dec 2, 2020, 7:27:13 AM", "content": ["Hello! I'm trying to build a consensus tree via concatenation, the main tree is already built. for running IQ-Tree to generate separate gene trees I will loop it as so: for s in *.aln.fas; do iqtree -s $s -st DNA -m GTR+FQ+I+G; done then cat as so: cat *.treefile > all.aln.treefile then when running: iqtree -con -t all.aln.treefile I get the stderr of: Error: sequence names changed. Why are species names being changed when running IQtree on the individual alignments? How can I fix this so I can map the number of trees showing a particular partition to the branches on the original tree? Best, AAH ", "Hi AAH, This looks all good. But I can\u2019t find this error phrase in the source code. So can you please send the log file, which will contain the exact error message, before I can say something. Please note that the consensus tree option only works for trees with the same set of taxa (e.g. bootstrap trees). Here you have gene trees, so some taxa may appear in one tree but not the other. So to overcome this, you need to compute the gene concordance factors, which generalize consensus concept for this case. See this tutorial: http://www.iqtree.org/doc/Concordance-Factor FYI: Your for loop is now implemented directly in IQ-TREE 2 via the -S option (capital S; see this tutorial). It\u2019s not just for convenience, but also more time effcient than the for loop when you use multiple CPU cores: IQ-TREE will smartly schedule the jobs (big alignments first) such that the waiting time is minimised. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e8dbb408-4c47-47bf-b80a-fd58bf8fca20n%40googlegroups.com ", "Hi Minh, So I am trying the concordance pipeline now. The first step is trying to build a consensus tree from a directory with the >3000 core gene alignments. Doing so: iqtree -p aln_dir -m GTR+G+Fo -pre concat -nt AUTO only outputs a concat.uniqueseq.phy file but doesn't put out any tree file. what am I doing wrong? attached is the log file. Best, Austin ", "Hi Austin, My apology for the delay in replying. Just too much commitment at the moment. The problem is that your alignments seem to have completely different set of taxon names, from my quick skim through the log file. So it couldn\u2019t concatenate the sequences properly. So try to rename the sequences, such that they match each other, before running the analysis. Otherwise it doesn\u2019t make sense to run -p option. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5733a6d0-5be4-464b-924c-d02f1dd76688n%40googlegroups.com <concat.log.zip> "]}, "02p59IBRSMI": {"topic": "Can I divide up sequences to run IQTREE in parts and merge tree results later?", "initializeDate": "Jun 28, 2020, 10:03:37 PM", "timeStamp": "Jul 8, 2020, 7:44:48 PM", "content": ["Hi all, I am trying to draw a tree using nearly 20,000 sequences (from 80 species), but because it takes quite a while I am looking for ways to construct the tree quicker. In IQTREE-2, is there an option similar to partition models but for dividing up the sequences instead of sites? For instance, for analysis of 20,000 sequences, could I calculate four separate trees using 5,000 sequences each and then merge at the end to have a tree consisting of all 20,000 sequences? Thanks in advance. Best Regards, Jenny ", "Hi Jenny, There is no option to do this in IQ-TREE. There are a few challenges to this approach, but it's a very sensible thing to do if (and only if, in my opinion) you are willing to assume that your tree is composed of some number of completely independent sub-trees. In this case, you can estimate the sub-trees independently, then merge them back together. There are various ways of estimating the relationships among sub-trees, but a simple one is to select a few sequences from each sub-tree and estimate the interrelationships that way. And example of where this might be sensible - if you had 5000 species from each of four well-understood and non-controversial taxonomic groups. From what you've said it doesn't sound like this is what you've got. In the case where you need to estimate a good tree for 20,000 sequences, if you are looking for things to go quicker you have lots of option: 1. IQ-TREE with the `-fast` option (quick, less thorough tree search still good) 2. Just use an NJ tree: `-t BIONJ` in IQ-TREE 3. Just use a parsimony tree `-n 0 -m JC -fixbr` will give you this in IQ-TREE, and stop IQ-TREE from doing unnecessary additional calculations. Not recommended unless your sequences are exceptionally similar and you understand all the pitfalls of parsimony trees (e.g. long branch attraction etc) 4. Try RaXML-NG (this has far fewer options for complex models, but by the same token is better optimised for huge alignments; you can always re-estimte the branch lengths under complex models in IQ-TREE) 5. Try FastTree (even fewer options than RaXML-NG, but even better optimised for alignments with a LOT of tips) Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6d3a18a3-79ab-48eb-8104-b5bed963f805o%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Hi Rob, Thank you so much for your quick reply! We are trying out the fourth option you mentioned, but I'm having trouble finding the specific options for re-estimating the branch lengths in IQ-TREE once I have constructed a tree using RAxML. Could you give me more details on how to do this? Best, Jenny On Wednesday, July 1, 2020 at 9:05:21 AM UTC+9, Rob Lanfear wrote: Hi Jenny, There is no option to do this in IQ-TREE. There are a few challenges to this approach, but it's a very sensible thing to do if (and only if, in my opinion) you are willing to assume that your tree is composed of some number of completely independent sub-trees. In this case, you can estimate the sub-trees independently, then merge them back together. There are various ways of estimating the relationships among sub-trees, but a simple one is to select a few sequences from each sub-tree and estimate the interrelationships that way. And example of where this might be sensible - if you had 5000 species from each of four well-understood and non-controversial taxonomic groups. From what you've said it doesn't sound like this is what you've got. In the case where you need to estimate a good tree for 20,000 sequences, if you are looking for things to go quicker you have lots of option: 1. IQ-TREE with the `-fast` option (quick, less thorough tree search still good) 2. Just use an NJ tree: `-t BIONJ` in IQ-TREE 3. Just use a parsimony tree `-n 0 -m JC -fixbr` will give you this in IQ-TREE, and stop IQ-TREE from doing unnecessary additional calculations. Not recommended unless your sequences are exceptionally similar and you understand all the pitfalls of parsimony trees (e.g. long branch attraction etc) 4. Try RaXML-NG (this has far fewer options for complex models, but by the same token is better optimised for huge alignments; you can always re-estimte the branch lengths under complex models in IQ-TREE) 5. Try FastTree (even fewer options than RaXML-NG, but even better optimised for alignments with a LOT of tips) Rob On Mon, 29 Jun 2020 at 12:03, cgy < jenny...@gmail.com > wrote: Hi all, I am trying to draw a tree using nearly 20,000 sequences (from 80 species), but because it takes quite a while I am looking for ways to construct the tree quicker. In IQTREE-2, is there an option similar to partition models but for dividing up the sequences instead of sites? For instance, for analysis of 20,000 sequences, could I calculate four separate trees using 5,000 sequences each and then merge at the end to have a tree consisting of all 20,000 sequences? Thanks in advance. Best Regards, Jenny You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6d3a18a3-79ab-48eb-8104-b5bed963f805o%40googlegroups.com ", "Hi Jenny, You can input and fix the tree with -te option, IQ-TREE will then estimate the branch lengths on the fixed input tree. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7eefc0fb-7f73-4d3f-b03d-810784cc0f8eo%40googlegroups.com "]}, "FQ2quUATbgM": {"topic": "Tree calibration using fossil data", "initializeDate": "Jan 31, 2021, 7:25:26 PM", "timeStamp": "Feb 2, 2021, 4:47:43 PM", "content": ["Dear Minh and Hien, I am using LSD2 for calibrating the tree using fossil data. The commands that I am using are: ../bin/lsd2_unix -i tree.tre -s 226106 -o out.tree -f 100 -g outgroup -d dating.txt I am getting the following error: Error: There's not enough signal in the input temporal constraints to have unique solution. Can you please help me understand how to resolve this issue? On using IQ-TREE v.2.1.1, I get the error \"There's conflict or not enough signal in the input temporal constraints.\" Thank you. Best, Siddharth. ", "Hi Siddharth, In order to have an unique solution, you need to have at least one fixed calibration date, otherwise there can be multiple solutions. I saw in your date file, all your date constraints are either intervals or upper boundaries, there\u2019s not any calibration point with fixed value, so that\u2019s one of the reason for the error. Another thing is you need to specify the tips date as well (ex: -z 0 to set all tips date to be contemporary date). Let me know if there\u2019re still problems after fixing that. Best regards, Hien You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/efc902ea-dd0a-4f6b-9ee3-574eb6673892n%40googlegroups.com ", "Dear Hien, Thank you for your response. I added a fixed calibration point and -z 0 which ran successfully (this is great!). However, the output file has a tree topology with many polytomies. Do you know why that would happen? Thank you. Best regards, Siddharth. "]}, "Og0KHGlQMuo": {"topic": "Specifying tree searches", "initializeDate": "Apr 28, 2019, 1:37:44 PM", "timeStamp": "May 3, 2019, 4:06:24 AM", "content": ["Hello, Just a quick, and probably very basic question. I want to perform 100 ML tree searches in a single run. I wanted to confirm that I understand the correct command to use, is it -ntop 100? From what I understand there are 20 searches by default (from the 20 parsimony trees in the candidate set). So, if I were to use -ntop 100 should I also reasonably scale up -ninit as well (to 1000)? FYI my standard string of commands for an IQ-TREE run are: iqtree -s ALIGNMENT.fas -spp PARTITION.txt -m MFP -bb 1000 -bnni -alrt 1000 and I mainly want to figure out how to best tell IQ-TREE to conduct 100 searches with my usual commands in place. Thanks! Ryan ", "Hi Ryan, Sorry for the delay, the Easter break subsantially reduces my responsiveness. The option you wanted to ask is perhaps --runs 100. It invokes 100 independent tree searches, and then nicely summarises the 100 trees with log-likelihoods in a table in .iqtree file. This option is relatively new, thus not described in the documentation. We will update it. The other options you mentioned (-ninit, -ntop) are still related to one run, thus is not independent. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "TH0FlK3NYTo": {"topic": "Construction ML constrained topology- stuck at step \"Generating 99 parsimony trees\"", "initializeDate": "Jan 14, 2019, 8:58:06 AM", "timeStamp": "Jan 14, 2019, 8:58:06 AM", "content": ["Hello, I am trying to use IQ-Tree 1.6.6 for testing additional topologies. When I run the \"-g\" option to construct the ML tree given a constrained topology, iq-tree becomes stuck at the following step: \"Generating 99 parsimony trees\". I already tested multiple datasets and the same happens in all of them. I tested the same datasets in RAxML and everything works fine, so I believe it has nothing to do with the data itself. I am using ~900 taxa so I was wondering if this has something to do with the fact that I am using a large dataset. Thank you in advance! Best, Carla "]}, "hvzhr2QvGvc": {"topic": "Error with aminoacid symbols", "initializeDate": "Aug 14, 2017, 6:59:05 PM", "timeStamp": "Sep 27, 2018, 11:12:58 AM", "content": ["Hi all, I am running IQ-Tree for the first time (1.6.beta4), in a protein dataset. I am getting the following error ERROR: Error found at line 7, column 31 (file position 200): ERROR: State specified (I) for taxon 1, character 3, not found in list of valid symbols And I called as iqtree -nt $cpus -st AA -ninit 10 -b 500 -m MFP+MERGE -rcluster 10 -madd LG4M,LG4X -msub nuclear -s *.nex -spp partition_file -o outgroup_name Has anyone seen this before? Any ideas? I know having the letter I in the alignment should not be a problem, so I don't understand what it could be. Thank you, Tauana ", "Dear Tauana, This option looks strange: -s *.nex should have been a specific name of a .nex file, and not \u201c*.nex\u201d If the error still persists, please send me the input alignment via my personal email. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, In this case, the only file .nex that exists in the folder is the one I am targeting. I know this syntax works because the file was read by IQ-Tree and then it could not interpret the 3rd aminoacid specifically. I am sending you my file and the log. Thank you for helping! Best, Tauana ", "Hi Tauana, Having a look at the NEXUS alignment file you sent, the data type is mis-specified in this line: FORMAT DATATYPE = DNA Simply changing \u201cDNA\u201d to \u201cPROTEIN\u201d should fix this. Note that -st AA is ignored because this FORMAT command overrides it. Cheers, Minh ", "Dear Minh, I was looking for something else and realized I never answered to this thread again, but you were right about FORMAT issue, after that iqtree ran just fine! I am having another issue now, in which I have a few X in an amino acid alignment (X for any amino acid) and iqtree fails. Should I just replace those X for dashes? It's only a few samples downloaded from NCBI, genome data. Don't know how the X ended up there, but I have to deal with them now. Thanks! ", "Hi there, Yes you can replace all X by -. They have the same treatment. Alternatively, I think you can add \u201cmissing=X\u201d to the format command. Minh ", "Replacing X for dashes worked, thanks Minh. Just a heads up, I looked for the option to add X in the missing/format command, but on the manual it describes X as already part of the unknown AA characters, although it doesn't seem to be working. Thanks! ", "Dear all, just a short note: I ALWAYS have \"X\" in my aa matrices - and it always worked (using Linux binaries though). Do I miss something? Best, Karen ", "Hi Tauana and Karen, Because this discussion only regards the NEXUS file, where it has some strict syntax that you need to specify \"missing=X\u201d for the FORMAT command. So that it parses the nexus file properly. Whereas for all other formats (Phylip, fasta etc) no such restriction applies. Minh ", "Makes sense! Thanks Minh "]}, "bcTcP6ck9x4": {"topic": "IQ-tree book", "initializeDate": "Nov 22, 2019, 5:22:51 AM", "timeStamp": "Nov 25, 2019, 6:05:48 AM", "content": ["Dear IQ-tree developpers,do you plan to publish a book and explain in detail how to use IQ-tree? This would be definitely very useful very large audience. I know that developpers of Beast did that and their book had success. I wish I had such a book (with several explained example analyses + typical strategy/steps of an analysis) to solve lots of simple and more complicated questions about different IQ-tree options, parameters and their values. ", "Hi there, Thanks for your interests. I have never thought about publishing a book\u2026 How about this: http://www.iqtree.org/doc/iqtree-doc.pdf You should perhaps look at the workshop material that I taught about IQ-TREE at the Workshop on Molecular Evolution: https://molevol.mbl.edu/index.php/Schedule Cheers, Minh On 22 Nov 2019, at 9:22 pm, Philipp Chetverikov < philipp.c...@gmail.com > wrote: Dear IQ-tree developpers,do you plan to publish a book and explain in detail how to use IQ-tree? This would be definitely very useful very large audience. I know that developpers of Beast did that and their book had success. I wish I had such a book (with several explained example analyses + typical strategy/steps of an analysis) to solve lots of simple and more complicated questions about different IQ-tree options, parameters and their values. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c7d886da-1d85-450a-aab0-c253049d8734%40googlegroups.com "]}, "flT4ebhPM1w": {"topic": "modelfinder (without merge), mixed dataset", "initializeDate": "Jan 14, 2019, 9:47:38 AM", "timeStamp": "Jan 15, 2019, 12:20:06 PM", "content": ["Hi all, we have a mixed dataset (aa and nt, with several partitons each), for which we wanto run Modelfinder. I read recently that its not yet possible to do in 1kite but will be implemented soon. 1. is it already implemented or must we run it separately? 2. if its impelemted how the command (& partition files) must look like? Aim ist e.g. to run ALL models on NT level, but only -msub nuclear + 2 mixture models on protein level...? (we than plan to cncatenate and run it with a constraint tree since the nucleotide dataset has more taxa, but much less genes), but lalter on also test the concorcance factor stuff. Many thanks Karen ", "Hi Karen, On 14 Jan 2019, at 9:47 pm, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Hi all, we have a mixed dataset (aa and nt, with several partitons each), for which we wanto run Modelfinder. I read recently that its not yet possible to do in 1kite but will be implemented soon. 1. is it already implemented or must we run it separately? There have been a few bug fixes with mixed dataset but such analysis is always possible since a few years. Please use the latest version 1.6.9. 2. if its impelemted how the command (& partition files) must look like? See this tutorial: http://www.iqtree.org/doc/Advanced-Tutorial#partitioned-analysis-with-mixed-data Aim ist e.g. to run ALL models on NT level, but only -msub nuclear + 2 mixture models on protein level\u2026? Te first part \"ALL models on NT level, but only -msub nuclear\u201d is possible: iqtree -spp partition_file -msub nuclear But \"+ 2 mixture models on protein level\u201d is not possible. Therefore, I suggest that you perform 2 ModelFinder runs, one just NT partitions and the other with AA partitions, and then combine the best_scheme files for a mixed analysis. (we than plan to cncatenate and run it with a constraint tree since the nucleotide dataset has more taxa, but much less genes), but lalter on also test the concorcance factor stuff. I see. This should work fine. Cheers Minh Many thanks Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "ok thanks Minh. Since using LG4X etc gets very common, its not planned to implement soon that this is possible is it? (would be very convenient) ;) ## another thing: I was serching for the beta versions of this concordance facor thing but i cannot find a link. where can i download it again? many thanks karen ", "Hi Karen, All releases can be found on the IQ-TREE GitHub page where the source code is maintained. Just click on the \u201cGitHub repository\u201d link at the bottom of all pages at iqtree.org , which leads to https://github.com/Cibiv/IQ-TREE - then click on \u201creleases\u201d. This leads to the page listing all IQ-Tree releases: https://github.com/Cibiv/IQ-TREE/releases Cheers, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Many many thanks !!!! best Karen "]}, "7mmN_FEyTOg": {"topic": "Legitimate approach?? -t with -pers", "initializeDate": "Dec 7, 2016, 12:56:13 AM", "timeStamp": "Dec 13, 2016, 2:03:08 PM", "content": ["Is the following approach legitimate? I have adopted it because I find that the best LogL scores sometimes correspond to trees that look highly implausible when compared with the known species tree. 1) Repeat multiple (say 10) IQ-Tree runs with default parameters. 2) From these, choose the tree that appears most plausible in terms of its correspondence to the accepted species tree. 3) Re-run IQ-Tree, using that chosen tree as starting tree (-t), and with -pers 0.1, to avoid searching too widely. My impression is that this approach generates sensible results. But is it justifiable? Thanks, Trevor ", "Dear Trevor, I think you approach does not sound very objective. Can you describe a bit more about your data? Because such analysis is not trivial and varies from data to data. For example, the analysis with datasets having many short sequences (e.g. HIV) is different from datasets with long sequences (e.g. phylogenomic data). Moreover, if you are 100% sure about some branches that should be present in the resulting tree, you can use the constraint tree search (-g option), which may help to narrow down the decision. Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Very many thanks, both for your response, and also for your extremely helpful offline explanation of my subsequent detailed queries. The '-g' option for placing constraints on the tree search was exactly what I needed, and it works really impressively. Likewise the tree topology tests to compare the constrained and unconstrained tree. If you can add some explanation to the tutorials, along the lines you explained to me, I imagine other users might find that really useful. Overall, your IQ-Tree system is fantastic. The ultrafast bootstrap has saved me so much time, and now the addition of the -g constraint option is a really powerful addition. Plus, the support you provide through this forum is outstanding. Thanks so much to you and the team! Trevor ", "Dear Trevor, thanks for your kind words. As yes I will add some tutorial about the constraint tree, as other users may have similar question. Minh "]}, "KTK2Tu_5xpw": {"topic": "-blfix does not seem to work as expected", "initializeDate": "Oct 21, 2020, 1:04:12 PM", "timeStamp": "Oct 24, 2020, 11:08:49 AM", "content": ["I find that if I get IQTREE to calculate the likelihood on a fixed tree, and ask that branch lengths be fixed, the tree file that is generated by this call has different branch lengths from the original. For instance, using the example on github, initial inference: iqtree2 -s example.phy -spp example.nex -pre exampleInference -nt 4 evaluation of fixed tree and fixed branch lengths iqtree2 -s example.phy -spp example.nex -pre exampleEval -te exampleInference.treefile -blfix -nt 4 Trees then imported in R: > all.equal.phylo(t1, t2, use.edge.length = F) [1] TRUE > all.equal.phylo(t1, t2, use.edge.length = T) [1] FALSE ", "Hi Pascal, -blfix does not work with -spp option. If you look carefully, it will actually rescale branch lengths of the original tree by a factor. But that\u2019s the behaviour in conjuction with -spp option, which I can\u2019t do anything about it. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/83bae9ad-6596-4994-8101-957e0c80179fn%40googlegroups.com ", "Ah ok. So is there a way to calculate the likelihood of a fixed tree, without optimizing branch lengths, and only optimizing model parameters? ", "No, unfortunately this is not possible with -spp option. It\u2019s the proportional edge-link partition model, that during model optimization, there is one final step of rescaling the branch lengths and partition rates, such that the weight sum of partition rates (weighted by the length of partitions) becomes 1. This step resulted in the behaviour I mentioned. So in the documentation, I should add that -blfix will rescale branch lengths when used with -spp option. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ae61e40b-9325-4f15-8e6c-cd6c20d279a9n%40googlegroups.com ", "No, unfortunately this is not possible with -spp option. It\u2019s the proportional edge-link partition model, that during model optimization, there is one final step of rescaling the branch lengths and partition rates, such that the weight sum of partition rates (weighted by the length of partitions) becomes 1. This step resulted in the behaviour I mentioned. So in the documentation, I should add that -blfix will rescale branch lengths when used with -spp option. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ae61e40b-9325-4f15-8e6c-cd6c20d279a9n%40googlegroups.com ", "I understand now. Thank you for explaining! "]}, "x7W83vrhYMA": {"topic": "sCF, IQtree 2_\"ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT\"", "initializeDate": "Feb 27, 2021, 12:22:31 PM", "timeStamp": "Mar 3, 2021, 7:22:36 AM", "content": ["Hi, I am a beginner of your IQtree 2. I currently have difficulty executing sCF commands on my server. My command is: ~/iqtree-2.0.7-Linux/bin/iqtree2 -t topology1_rerooted.newick -s plastome_corrected.fas --scf 100 --prefix 01_concord_topology1 The following is my error message: Reading tree topology1_rerooted.newick ... un-rooted tree with 34 taxa and 65 branches Computing site concordance factor... ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: 01_concord_topology1.log ERROR: *** Alignment files (if possible) Does anyone know what happened to this? Best, Li-Yaung ", "Hi Li Yaung, This looks like a bug in IQ-TREE. Please send me the data for inspection? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAO9%2B9zOF%3DcYJedLfTjkPkjCdV-ePVfQMpa4fyYrL681Ayo84vA%40mail.gmail.com ", "Hi Minh, Thank you for your response! I already sent you the alignment, tree, and log file to your personal email. Best, Li-Yaung Minh Bui < minh...@univie.ac.at > \u65bc 2021\u5e743\u67082\u65e5 \u9031\u4e8c \u4e0a\u53488:32\u5beb\u9053\uff1a "]}, "-Flc-EHwPDM": {"topic": "iqtree failed with likelihood mapping", "initializeDate": "Feb 4, 2021, 10:45:19 PM", "timeStamp": "Feb 4, 2021, 10:45:19 PM", "content": ["Hi IQTREE team, I came across problem running likelihood mapping. The command I used is as follows. iqtree -nt 40 -st AA -s h1b_Dref_Ltax_aa.fas -spp h1b_partition -pre fclm_h1b -lmap ALL -lmclust hypo_1b.nex -te BIONJ -wql -safe The error message from the log file is in the following. *******************EEROR******************* Computing 1260 quartet likelihoods (one dot represents 100 quartets). WARNING: Numerical underflow for lh-branch Gamma shape alpha: 0.312 WARNING: Numerical underflow for lh-derivative Gamma shape alpha: 0.312 WARNING: Numerical underflow for lh-derivative Gamma shape alpha: 0.312 WARNING: Numerical underflow for lh-derivative Gamma shape alpha: 0.312 WARNING: Numerical underflow for lh-derivative Gamma shape alpha: 0.312 WARNING: Numerical underflow for lh-derivative ERROR: phylokernelnew.h:3159: double PhyloTree::computeLikelihoodFromBufferSIMD() [VectorClass = Vec4d, nstates = 20, FMA = true, SITE_MODEL = false]: Assertion `std::isfinite(tree_lh) && \"Numerical underflow for lh-from-buffer\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: fclm_h1b.log ERROR: *** Alignment files (if possible) *******************EEROR******************* I have tested the same command with other files, which worked pretty well. I have also checked the cluster file, but I don't see anything could be wrong. Any idea about how to fix this? Thanks a lot for the help. Cheers, Liping "]}, "UbFkYb3Twv8": {"topic": "BUG: \"ERROR: Invalid number of states\" with binary partitions", "initializeDate": "Jan 25, 2018, 3:28:01 AM", "timeStamp": "Jan 29, 2018, 2:30:58 PM", "content": ["Hello, I have found the following bug: when I input a mixed partition file, binary partitions included (0 and 1) and exclude these with the partition file, so that the will NOT be used fot the analysis, model finder will end in: \"ERROR: Invalid number of states\" All the best Dieter ", "Update: I see: same happens with \"tree inference\". All the best Dieter ", "Hi Dieter, Having an alignment with mixed DNA and binary data will make IQ-TREE think that you have a morphological data, which resulted in this error message. So please remove the binary partitions from the alignment\u2026 Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Thank you Minh, I already did. But with removing the binary data it causes that bug: https://groups.google.com/forum/#!topic/iqtree/Brlz-cog-ck I rechecked: only with tiny data sets (about 300 taxa) it looks like it works - so the error should have anything to do with the data size. All the best Dieter You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/UbFkYb3Twv8/unsubscribe To unsubscribe from this group and all its topics, send an email to "]}, "qCbcmveeaXE": {"topic": "BUG - constraint tree ERROR", "initializeDate": "Apr 11, 2019, 4:50:50 AM", "timeStamp": "Apr 18, 2019, 9:47:29 AM", "content": ["I'm trying to run an analysis with a constrained topology, at first I was getting a message saying certain sequences will be dropped due to being identical, when I removed these (from both the tree and alignment) I still get the same error which leads me to believe it is a different problem: IQ-TREE multicore version 1.6.2 for Linux 64-bit built Mar 28 2018 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: -- (AVX2, FMA3, 62 GB RAM) Command: iqtree -s reducedtestalignmentbac.faa -m GTR+F -g constraintree.tre Seed: 295241 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Thu Apr 11 09:38:34 2019 Kernel: AVX+FMA - 1 threads (40 CPU cores detected) WARNING: 61 sequences contain more than 50% gaps/ambiguity **** TOTAL 5.33% 24 sequences failed composition chi2 test (p-value<5%; df=3) Reading constraint tree constraintree.tre... Creating fast initial parsimony tree by random order stepwise addition... ERROR: phylotreepars.cpp:382: int PhyloTree::computeParsimonyTree(const char*, Alignment*): Assertion `taxon_order.size() == constraintTree.leafNum' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 6 PhyloTree::computeParsimonyTree(char const*, Alignment*) ERROR: 7 IQTree::computeInitialTree(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, LikelihoodKernel) ERROR: 8 initializeParams(Params&, IQTree&, ModelCheckpoint&, ModelsBlock*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&) ERROR: 9 runTreeReconstruction(Params&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, IQTree*&, ModelCheckpoint&) ERROR: 10 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 11 main() ERROR: 12 __libc_start_main() ERROR: 13 _start() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: reducedtestalignmentbac.faa.log ERROR: *** Alignment files (if possible) Aborted (core dumped) On a different version: IQ-TREE multicore version 1.6.5 for Linux 64-bit built May 8 2018 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: -- (AVX2, FMA3, 251 GB RAM) Command: iqtree -s reducedtestalignmentbac.faa -m GTR+F -g constraintree.tre Seed: 742718 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Thu Apr 11 09:39:41 2019 Kernel: AVX+FMA - 1 threads (40 CPU cores detected) ERROR: phylotreepars.cpp:382: int PhyloTree::computeParsimonyTree(const char *, Alignment *): Assertion `taxon_order.size() == constraintTree.leafNum' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: reducedtestalignmentbac.faa.log ERROR: *** Alignment files (if possible) ", "Hi there, It looks like some issue with the input constraint file, e.g. some taxa might not appear in the alignment or vice versa. Can you check that? If not, please send me the input files and I\u2019ll have further look. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Thanks yes it was a problem with the nexus file. Some characters were ambiguous (one species with multiple character states) and some characters had more than 9 states once I removed those it worked! Thanks again! "]}, "o_7WpvFLYgg": {"topic": "Is there a way to make the log output every tree the ML search visits in its search? Instead of just the last one.", "initializeDate": "Jul 15, 2016, 12:36:14 PM", "timeStamp": "Jul 19, 2016, 5:11:51 PM", "content": ["I would like to examine what trees it goes to and in what order. ", "On Friday, July 15, 2016 at 9:36:14 AM UTC-7, lola wrote: > I would like to examine what trees it goes to and in what order. To clarify, I mean like one finds in the -log output of FastTree or the --print_trace of PhyML ", "Hi there, is this: -wt Write locally optimal trees into .treels file the option you look for? Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Perhaps? I'm not sure what \"locally optimal\" means, though, because the only \"locally optimal\" tree ought to be the final one that the program hits upon... ", "ok here is the full explanation: the likelihood landscape of the tree space was known to have multiple local optimal trees. Thus, unlike FastTree or PhyML (which are hill-climbing algorithms), IQ-TREE implements a stochastic algorithm to escape local optima. It explores the tree space by repeatedly sampling many local optima. The -wt option will print all these local optimal trees, instead of just the final best among them. Note that one can never be sure that it is the \u201cglobal\u201d optimal tree, but we observed to usually obtain better trees than other methods. Refer to http://mbe.oxfordjournals.org/content/32/1/268 for full details. I hope that this option will print enough \u201ctrace\u201d for your need. If not, let us know - my co-author may be able to help. Minh > On Jul 17, 2016, at 8:17 AM, lib...@gmail.com wrote: > Perhaps? I'm not sure what \"locally optimal\" means, though, because the only \"locally optimal\" tree ought to be the final one that the program hits upon... ", "Thank you for the more detailed explanation! No, that's not really what I was looking for. It is neat though. ", "Hi, There is such an option in a beta version of IQ-TREE. I can provide the code if you want. Moreover, I would be interested in knowing what type of analysis you want to do with those trees. Cheers Tung On Mon, Jul 18, 2016 at 5:30 PM, lib...@gmail.com wrote: Thank you for the more detailed explanation! No, that's not really what I was looking for. It is neat though. ", "Hi Tung, I and my research group are examining how different programs traverse tree-space - the patterns that emerge from their different algorithms and parameters - and we would like to include IQ-TREE in this comparison. Having the code would be very helpful, if you don't mind! Thank you for your help. "]}, "1Cj9KwjzVlI": {"topic": "BUG: IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT", "initializeDate": "Jan 28, 2020, 11:37:54 PM", "timeStamp": "Jan 29, 2020, 3:20:49 AM", "content": ["Hi iqtree developers, I am running the command: iqtree -s Adelopetalum_Plastid_130taxa_61553bp_gene_annotated.phy -spp plastid_130taxa_61553bp_partitions.nex -pre plastid_standardModelAndPartitionTest_BEASTmodels -m TESTMERGEONLY -mset JC69,HKY,TN93,GTR -nt 10 It seems the analysis is well into \"Merging models to increase model fit (about 4831 total partition schemes)...\" when it crashes with the message \"IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT\" Thanks for your help, Lalita ", "This analysis was run on a linux machine random seed: 684592 end of log file: 2485 HKY+F+I 502727.813 psbT+rpl36 0h:12m:57s (0h:12m:14s left) Merging rpl32+rpl33 with BIC score: 502625.638 (LnL: -246587.470 df: 857) ERROR: ERROR: ERROR: ERROR: ERROR: ERROR: ERROR: ERROR: ERROR: **RROR: **RROR: * IQ-TREE CRASHES WITH SIGNAL *IQ-TREE CRASHES WITH SIGNAL ** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers:*** IQ-TREE CRASHES WITH SIGNAL *** IQ-TREE CRASHES WITH SIGNAL ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULTSEGMENTATION FAULTEGMENTATION FAULTEGMENTATION FAULT*** Log file: ERROR: plastid_standardModelAndPartitionTest_BEASTmodels.log*** IQ-TREE CRASHES WITH SIGNAL ERROR: SEGMENTATION FAULTSRROR: SEGMENTATION FAULTEGMENTATION FAULT ERROR: ERROR: ERROR: ERROR: ERROR: ERROR: *** For bug report please send to developers:*** For bug report please send to developers:*** Alignment files (if possible)*** Alignment files (if possible)*** For bug report please send to developers:*** For bug report plea2486 GTR+F+I+G4 503182.407 rbcL+ycf2 0h:12m:57s (0h:12m:13s left) e end to developers: ERROR: ERROR: ERROR: ERROR: ERROR: ERROR: ERROR: ERROR: ERROR: **RROR: * F2487 GTR+F+I+G4 503301.191 rpoC1+ycf2 0h:12m:57s (0h:12m:13s left) or 2488 GTR+F+I+G4 503207.166 atpB+ycf2 0h:12m:57s (0h:12m:12s left) u report please send to developers:*report please send to developers:** Log file: *** Log file: "]}, "CT64akAXXN8": {"topic": "failure reading alignment  ERROR: Cannot read file", "initializeDate": "Mar 22, 2021, 9:27:47 PM", "timeStamp": "Mar 25, 2021, 2:46:29 PM", "content": ["Hi Team, please could you help to resolve the following issue: iQtree 1.6.12 failure reading my fasta alignment - ERROR: Cannot read file What it could be? Thank you in advance! Anna ", "Hi Anna, The error speaks for itself\u2026 there is something with the file system, perhaps the file permission? (access denied or so). If you are sure that the file is readable, then please send the log file here for further inspection. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2e5b3ea6-ea89-41f7-ae9d-6f0f6293fcf0n%40googlegroups.com ", "Thank you so much Minh for your response! I just used sudo -s and everything is working now :)) All the best, Anna \u0447\u0442, 25 \u043c\u0430\u0440. 2021 \u0433. \u0432 13:04, Minh Bui < minh...@univie.ac.at "]}, "Zqt5DX1vH04": {"topic": "IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT", "initializeDate": "Aug 11, 2018, 12:55:02 AM", "timeStamp": "Aug 16, 2018, 7:27:04 PM", "content": ["When I run iqtree version 1.6.6 and previous version using batch submission script the program with a command \"aprun -j 1 -n 24 -N 24 iqtree -s /mnt/lustre/bio/biosilva/August/10/LG/nr_J-protein_subfamily_less_bootstrap-supported.msa -m LG+G4 -b 100 -safe\" Iam geting the below response. but when i run the same command with -nt 8 CPU option locally it works fine. what would be the reason and how to fix it. Iam using Cray XC40 super computer. # first few lines of log file IQ-TREE multicore version 1.6.3 for Linux 64-bit built Mar 22 2018 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: nid01134 (AVX2, FMA3, 125 GB RAM) Command: iqtree -s /mnt/lustre/bio/biosilva/August/9/nr_J-protein_subfamily_less_bootstrap-supported.msa -m JTT -b 100 -safe Seed: 864213 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Fri Aug 10 01:23:30 2018 Kernel: Safe AVX+FMA - 1 threads (48 CPU cores detected) HINT: Use -nt option to specify number of threads because your CPU has 48 cores! HINT: -nt AUTO will automatically determine the best number of threads to use. Reading alignment file /mnt/lustre/bio/biosilva/August/9/nr_J-protein_subfamily_less_bootstrap-supported.msa ... Fasta format detected Alignment most likely contains protein sequences Alignment has 1013 sequences with 401 columns, 399 distinct patterns 311 parsimony-informative, 61 singleton sites, 29 constant sites WARNING: Some sequence names are changed as follows: CDY24370.1|153|TIM14|Brassica_napus|3708 -> CDY24370.1_153_TIM14_Brassica_napus_3708 # Last few lines of log file ===> START BOOTSTRAP REPLICATE NUMBER 1 Creating bootstrap alignment (seed: 863633)... Create initial parsimony tree by phylogenetic likelihood library (PLL)... 1.118 seconds NOTE: 43 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.100) 1. Initial log-likelihood: -78715.650 Optimal log-likelihood: -72892.803 Parameters optimization took 1 rounds (1.777 sec) Computing ML distances based on estimated model parameters... 55.148 sec Computing BIONJ tree... ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: /mnt/lustre/bio/biosilva/August/9/nr_J-protein_subfamily_less_bootstrap-supported.msa.log ERROR: *** Alignment files (if possible) Thanks Vigneshwaran Department of biochemistry Indian Institute of Science Bangalore, India ", "Hi Vigneshwaran, Can you tell me, what is \u201caprun\u201d? (I never used Cray super computer). What if you run IQ-TREE without this? (Because the command line looks like with me, and I want to filter out the problem that might be caused by aprun). If it still persists, then pls send me the alignment. Thank you, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "aprun is the command to invoke parallel processing. its required command to run processes parallel. everything fine when I run Iqtree locally with 8 processors but getting segmentation fault when running in super computer with same alignment. ", "aprun is the ALPS (Application Level Placement Scheduler) application launcher must be used to run application on the XE/XC compute nodes interactively and in a batch job If aprun is not used, the application is launched on the MOM node (and will most likely fail) aprun man page contains several useful examples at least 3 important parameter to control: The total number of PEs: -n The number of PEs per node: -N The number of OpenMP threads: -d (the 'stride' between 2 PEs in a node) see also understanding aprun qsub is the torque submission command for batch job scripts. ", "Hi Vigneshwaran, My run here on your alignment works well too. So I rather think it\u2019s hardware-related problem, which we\u2019re unable to test. Can you please build IQ-TREE from source code directly on this Cray system and run this customarily compiled version? Moreover, I saw that it crashed at computing BIONJ tree step. You can disable this step by adding \u201c-djc\u201d option. Let me know if that helps to overcome the crash? Cheers Minh "]}, "zuTzkkawsOg": {"topic": "Error: There's conflict or not enough signal in the input temporal constraints.", "initializeDate": "Aug 17, 2020, 3:24:19 AM", "timeStamp": "Sep 16, 2020, 10:21:56 AM", "content": ["I recently estimated the divergence time of species in a tree using IQ-TREE v2.0.6 with command: \"iqtree2 -s alignment.fasta --date date.txt -te species.tree --date-ci 100 -nt 20 --date-tip 0\" I also run this with --date-options \"-u 0\" parameter, but this do not solve the problem for me and generate the same error ", "Hi Kai, We need to look at your input tree and date to see which causes the conflict or poor date signals. Could you send me the output tree of iq-tree, the date file, the length of your alignments via my email if possible? Cheers, Hien On Mon, Aug 17, 2020 at 9:24 AM kai han < kaker...@gmail.com > wrote: I recently estimated the divergence time of species in a tree using IQ-TREE v2.0.6 with command: \"iqtree2 -s alignment.fasta --date date.txt -te species.tree --date-ci 100 -nt 20 --date-tip 0\" I also run this with --date-options \"-u 0\" parameter, but this do not solve the problem for me and generate the same error You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/625237f5-f398-42d0-b3cd-adc157e29c89n%40googlegroups.com ", "Hien Here is the input files I used (species.tree and date.txt) as well as the output tree of iqtree (iqtree-output.treefile), my input DNA alignment is too large to send it via email, the length of the alignment is 489,769 bp. kai han < kaker...@gmail.com > \u4e8e2020\u5e748\u670818\u65e5\u5468\u4e8c \u4e0a\u53489:00\u5199\u9053\uff1a Hi Hien, Here is the input files I used, including alignment in fasta format, tree file and date file. Kai Han Hien To < toth...@gmail.com > \u4e8e2020\u5e748\u670817\u65e5\u5468\u4e00 \u4e0b\u53489:02\u5199\u9053\uff1a You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/zuTzkkawsOg/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAKjtwTzYbWoPXPAn1ka-TJLsObiM1RKDRt8hjsJRksSwHdQbkw%40mail.gmail.com ", "Hi Kai, Thanks for the data. It was actually the same bug as this issue and was fixed in the new version of lsd2. You can either run the dating step alone with the new version of lsd2 (can be found here https://github.com/tothuhien/lsd2 ) and the following command ./lsd2 -i iqtree-output.treefile -d date_lsd2.txt -s 489769 -z 0 -r a (the date file format is a bit different, see attachment) or wait until the new version is integrated into iq-tree. Cheers, Hien To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAMf7zi4h4a%2Bi9Q8Aoz1YGYp0%2BM_rSH7CQLvtpu5ig_%2BRxLwUSA%40mail.gmail.com ", "Hi Hien, installing and running new version of lsd2 solved the problem, great thanks! Kai Han ", "Hi Hien and others, I already integrated the new LSD2 version, right after you released 2 or 3 weeks ago, Hien. However, while testing we found some bugs newly introduced with other new features. That\u2019s why the delay. We hope to fix the issues soon. Thanks for your patience, Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/16da22c1-0f4d-4cf6-93eb-ad9d0de6a597n%40googlegroups.com ", "Dear All, I have just released IQ-TREE version 2.1.1 that includes the latest LSD2 code. The downloads are now available in www.iqtree.org , with pre-compiled binaries for Linux, Windows and Mac. @Hien, if you want a separate Windows binary for LSD2, let me know. I could compile it as well. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/FF55BBC3-D628-40B0-9A18-747104360A0D%40univie.ac.at ", "Hi Minh, The pre-compiled binary for Linux was missing in the tar file that I downloaded. Best regards, Wayne To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/17F12FB6-A76C-4B4B-9FA1-0AD2A86B4248%40univie.ac.at ", "This is fixed now, thanks Wayne. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5813B740-433E-405A-B654-B3429501F3D7%40sdsc.edu ", "", "I've been having the same error message and I wonder if it's a genuine problem in my data or not. I attach my input tree and dates. I used v2.1.1 with this command. My alignment is 78,000bp. ./iqtree-2.1.1-Linux/bin/iqtree2 -s align.phy -st DNA --date fossils.txt -te align.treefile --date-ci 100 -o Solanum_lycopersicum,Capsicum_annuum --clock-sd 0.2 --date-root 52.2 -u 0 Had this output: --- Start phylogenetic dating --- Reading date file fossils.txt ... 3 dates extracted Building time tree by least-square dating (LSD) with command: lsd -i align.phy.timetree.subst -s 78751 -o align.phy.timetree -f 100 -q 0.2 -g align.phy.timetree.outgroup -d align.phy.timetree.date -a 52.2 Reroot the tree 1 using given outgroups ... TREE 1 *PROCESSING: Reading the tree ... Collapse 0 (over 63) internal branches having branch length <= 6.35e-06 (settable via option -l) Parameter to adjust variances was set to 0.00133 (settable via option -b) Minimum branch length of time scaled tree (settable via option -u and -U): 0 Error: There's conflict or not enough signal in the input temporal constraints ", "Hi Pauline, Because the root date have to be smaller than other dates, you should have --date-root -52.2 (instead of 52.2). Moreover, all tips date should be specified to be 0 (--date-tip 0) if all of your sequences come from present species. Cheers, Hien ", "Thank you, unfortunatly it's still not working. ", "Hi Pauline, Just look at your input tree and date now. The 2 first date constraints refer to the same internal node in the tree, but you give them different date. That's why the program complains the conflict. Moreover, the third date is of a tip - does it come from a fossil or a present species? If it's a present species it should have date 0 and not a negative one. If it's really a fossil, then we could not use option --date-tips 0 because this option forces all tips to have date 0. Hien ", "Hi Hien, that's embarrassing, sorry for the waste of time. I got confused with my different topologies between datasets were the two dates doesn't refer to the same nodes... The third species is an extant one but we have fossil data claiming it was already there at least at the indicated date. ", "Hi Pauline, There's no problem. I see the fact that you have fossil data about that species; but does the sequence you're using in this analysis come from fossils or comes from a living one? because they may be different. If the sequence really comes from fossils, you can use the attached date file, which indicates that all tips have date 0 except that sequence. Hien To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/27bb8eae-e84b-4434-a770-d3069dbc1a2fn%40googlegroups.com ", "Thank you. The sequence doesn't come from a fossil so I can't used it as a calibration point neither. That means that with this dataset/topology I only have the root and one ingroup calibration. Running it that way returns the same error so I guess it's really not enough information this time. ", "I didn't have that error when I tried again with 1 calibration point, the root date, and tips date 0. Did you use --date-tip 0 for tips date as well? The command will include --date fossils.txt --date-root -52.2 --date-tip 0 Those date input should be sufficient for dating. To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/dad2f576-c07c-43b4-a732-65f50ad08b62n%40googlegroups.com ", "Thank you very much Hien! I looked a the wrong outfile on the cluster. Problem solved ! "]}, "1WrvzkLlsvY": {"topic": "32-bit version of iqtree for ubuntu", "initializeDate": "Aug 13, 2016, 8:41:23 PM", "timeStamp": "Aug 16, 2016, 8:54:30 AM", "content": ["Hi to all, I have 32-bit Ubuntu 14.04 and I do not find any iqtree versions that support 32-bit versions. Is that right? Thanks in advance, Veronica ", "Dear Veronica, The Debian Medical team (Andreas Tille) built a cool Ubuntu package for IQ-TREE here: https://launchpad.net/ubuntu/+source/iqtree This is currently at iqtree version 1.4.2. As far as I remember, they compiled both 32-bit and multicore versions. Thus you can try to install this package. Let me know if that works. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Veronica, To install IQ-TREE on Ubuntu, try the following command: sudo apt-get install iqtree Cheers Tung ", "Thanks Tung! the version from the Debian medical team depends on a few libraries that are not easily available for ubuntu 14.04, leaving the package with unmet dependencies. I could try to see if that can be fixed, but I'd rather install the 32-bit version Tung built and let you all know. I'm really thankful. You've given me more help than I expected! Regards Veronica On Tue, Aug 16, 2016 at 6:46 AM, Tung Nguyen nlt...@gmail.com wrote: Hi Veronica, To install IQ-TREE on Ubuntu, try the following command: sudo apt-get install iqtree Cheers Tung On Sun, Aug 14, 2016 at 8:13 AM Bui Quang Minh < minh...@univie.ac.at > wrote: Dear Veronica, The Debian Medical team (Andreas Tille) built a cool Ubuntu package for IQ-TREE here: https://launchpad.net/ubuntu/+source/iqtree This is currently at iqtree version 1.4.2. As far as I remember, they compiled both 32-bit and multicore versions. Thus you can try to install this package. Let me know if that works. Cheers, Minh > On Aug 14, 2016, at 2:41 AM, mbel...@gmail.com wrote: > Hi to all, I have 32-bit Ubuntu 14.04 and I do not find any iqtree versions that support 32-bit versions. Is that right? > Thanks in advance, > Veronica > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout You received this message because you are subscribed to a topic in the Google Groups \"IQTREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/1WrvzkLlsvY/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Ver\u00f3nica Beligni, PhD Investigadora Adjunta CONICET Instituto de Investigaciones Biol\u00f3gicas (IIB-CONICET-UNMdP) Fac. de Cs. Exactas y Naturales Universidad Nacional de Mar del Plata J.B. Justo 2550, 2do Piso B7608FBY, Mar del Plata Argentina ", "Hi Tung, iqtree32 and iqtree32-omp running on my computer. I'll let you know if I encounter any problems along the way. Thanks for the great work! Regards, Veronica "]}, "bjTttdIahpM": {"topic": "bionj tree only", "initializeDate": "May 11, 2020, 11:38:49 AM", "timeStamp": "May 13, 2020, 2:45:19 AM", "content": ["Hi all, Is it possible to infer a (bio)NJ tree only using IQ-TREE? The closest solution I could find was to use the \"-te BIONJ\" option, but even with this option a bunch of other calculations are performed (e.g. the likelihood score of the tree, composition tests). So is there a way to infer a (bio)NJ tree only? Best regards, Stijn ", "Hi Stijn, As far as I know you cannot get ONLY a BIONJ tree. However, you can reduce a lot of the other things that IQ-TREE is doing: -te BIONJ -n 0 -m JC -fixbr -n 0 stops IQ-TREE doing any iterations to improve the tree (not sure this is necessary with -te BIONJ but it won\u2019t hurt -m JC means you have a JC model so no parameters to estimate -fixbr means the branch lengths of the BIONJ tree won\u2019t be optimised IQ-TREE will still calculate the likelhood of the BIONJ tree under the JC model with the BIONJ branch lengths (it\u2019s ML software, after all), but this should be quick. If this still isn\u2019t what you want, you can use fastme https://anaconda.org/bioconda/fastme to get a pure BIONJ tree. (Or, for what it\u2019s worth, if you want a really fast NJ tree you can use rapidnj https://anaconda.org/bioconda/rapidnj Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/fa645af3-8edd-44e1-a541-622c835da7a0%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Hi Rob, Thanks a lot for the suggestions, they were very helpful! Stijn Op dinsdag 12 mei 2020 05:36:29 UTC+2 schreef Rob Lanfear: Hi Stijn, As far as I know you cannot get ONLY a BIONJ tree. However, you can reduce a lot of the other things that IQ-TREE is doing: -te BIONJ -n 0 -m JC -fixbr -n 0 stops IQ-TREE doing any iterations to improve the tree (not sure this is necessary with -te BIONJ but it won\u2019t hurt -m JC means you have a JC model so no parameters to estimate -fixbr means the branch lengths of the BIONJ tree won\u2019t be optimised IQ-TREE will still calculate the likelhood of the BIONJ tree under the JC model with the BIONJ branch lengths (it\u2019s ML software, after all), but this should be quick. If this still isn\u2019t what you want, you can use fastme https://anaconda.org/bioconda/fastme to get a pure BIONJ tree. (Or, for what it\u2019s worth, if you want a really fast NJ tree you can use rapidnj https://anaconda.org/bioconda/rapidnj Rob On Tue, 12 May 2020 at 01:38, Stijn Wittouck < stijn....@gmail.com > wrote: Hi all, Is it possible to infer a (bio)NJ tree only using IQ-TREE? The closest solution I could find was to use the \"-te BIONJ\" option, but even with this option a bunch of other calculations are performed (e.g. the likelihood score of the tree, composition tests). So is there a way to infer a (bio)NJ tree only? Best regards, Stijn You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/fa645af3-8edd-44e1-a541-622c835da7a0%40googlegroups.com "]}, "_oy2jeEcKGA": {"topic": "Analysis hangs at Generating 98 parsimony trees...", "initializeDate": "Nov 29, 2018, 5:51:35 AM", "timeStamp": "Nov 29, 2018, 7:56:43 AM", "content": ["Hello, I am running a quite large dataset with 51 sequences and 794205 columns and the parameters below using IQ-TREE multicore version 1.6.8 for Linux 64-bit built Oct 28 2018 -st AA -m LG+F+I+G4+C60 -nt 16 -bb 1000 -alrt 1000 -wbt Using these parameters, the analysis hangs at the same point (see below) regardless of the memory available to the analysis--up to 1TB. NOTE: Switching to memory saving mode using 490.455 GB (97% of normal mode) NOTE: Use -mem option if you want to restrict RAM usage further NOTE: 502225 MB RAM (490 GB) is required! Estimate model parameters (epsilon = 0.100) 1. Initial log-likelihood: -17200808.527 2. Current log-likelihood: -17112206.352 3. Current log-likelihood: -17051142.582 Optimal log-likelihood: -17056303.133 Mixture weights: 0.117 0.017 0.007 0.009 0.001 0.012 0.005 0.002 0.002 0.003 0.018 0.039 0.007 0.009 0.010 0.006 0.003 0.029 0.029 0.002 0.005 0.003 0.026 0.005 0.00 1 0.009 0.009 0.021 0.016 0.014 0.028 0.011 0.012 0.013 0.021 0.034 0.014 0.004 0.010 0.005 0.008 0.004 0.011 0.028 0.026 0.022 0.001 0.012 0.008 0.004 0.017 0.010 0 .013 0.006 0.024 0.016 0.002 0.003 0.008 0.008 0.002 Proportion of invariable sites: 0.175 Gamma shape alpha: 0.657 Parameters optimization took 3 rounds (12835.857 sec) Computing ML distances based on estimated model parameters... 60.320 sec Computing BIONJ tree... 0.004 seconds Log-likelihood of BIONJ tree: -17059531.896 -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Generating 98 parsimony trees... 1699.596 second In this current analysis, the progress has stalled here for about 16 hours--I am not confident it will proceed. Note: I have previously successfully run an an analysis on this dataset using the -m TEST option. I have NOT been successful allowing the +R models. When using the default model search the model testing progresses, but extremely slowly (e.g. finishing ~150 of more than 500 options on a full node over many days). This might complete in time if allowed. I am exploring subsampling my dataset and can find ways to move ahead. However, I wonder if there are additional things I should be changing to make the complete dataset complete successfully? Thank you for your advice and suggestions. Jenni ", "Hi Jenni, Firstly, this is a huge analysis! I think IQ-Tree is still running - at this stage it\u2019s evaluating the 100 starting trees. I recommend that you use the PMSF approach to speed up C60 analysis and reduce memory consumption, see this tutorial: http://www.iqtree.org/doc/Complex-Models#site-specific-frequency-models And the paper for the method: https://doi.org/10.1093/sysbio/syx068 Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "PWMPHFXpNWA": {"topic": "Problems with IQTREE in CIPRES", "initializeDate": "May 11, 2020, 10:45:20 PM", "timeStamp": "May 11, 2020, 10:45:20 PM", "content": ["Dear IQTREE community I am using IQTREE version 1.6.10, which is available in CIPRES. But the run fails and throws me this error: ERROR: alignment.cpp: 70: std :: __ cxx11 :: string & Alignment :: getSeqName (int): Assertion `i> = 0 && i <(int) seq_names.size () 'failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: output.log ERROR: *** Alignment files (if possible) I am using the command line: iqtree -s infile.txt -spp partition.txt -bb 1000 -bspec GENESITE -safe -bnni -alrt 1000 -abayes -st AA -nm 1000 -nt AUTO -pre output -m TESTNEW How can I fix the error? "]}, "1SFnyljkoW8": {"topic": "ModelFinder Parallelism", "initializeDate": "Sep 25, 2020, 12:20:22 PM", "timeStamp": "Sep 30, 2020, 12:19:22 AM", "content": ["Hey Minh, Am I correct in assuming that ModelFinder is not parallelized across models but only along the sequences? (both version 1.6 stable and 2.0) In other words, if the sequence length stays the same, then would increasing the number of models tested necessarily increase the wall time regardless of how much parallelism we are using? If my parallelism assumption is correct then it would be awesome if there happens to be little tricks we can employ to speed up the ModelFinder process. Thanks, Min ", "Hi Min, On 26 Sep 2020, at 2:20 am, Min Park < minpa...@gmail.com > wrote: Hey Minh, Am I correct in assuming that ModelFinder is not parallelized across models but only along the sequences? (both version 1.6 stable and 2.0) The answer depends on whether you have partitioning or not: 1. If you don\u2019t have any partitions: Yes, it parallelises the likelihood computation along the sequences. Not across the models. The reason is because we want to re-use some model parameters, such as Gamma shape, from a previously evaluated model to the next one. It helps to speed up the optimisation, as initialising the next model with good parameter will make optimisation much faster. 2. If you have partitions: IQ-TREE will parallelise over the partitions: they are completely independent. In other words, if the sequence length stays the same, then would increasing the number of models tested necessarily increase the wall time regardless of how much parallelism we are using? Yes that\u2019s right. Especially if the sequencing length is not large. But due to the dependency explained above, it\u2019s not easy to parallel over the models. If my parallelism assumption is correct then it would be awesome if there happens to be little tricks we can employ to speed up the ModelFinder process. If you come up with a better parallel strategy, feel free to improve ModelFinder! In fact we really welcome new developers for code contribution\u2026 Thanks Minh Thanks, Min You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9540a0cd-3be8-41e2-8aef-36048c4b828fn%40googlegroups.com "]}, "TMDYhCHZvKw": {"topic": "Polymorphism in morphology", "initializeDate": "May 26, 2020, 1:16:14 PM", "timeStamp": "May 27, 2020, 7:47:28 PM", "content": ["Greetings everybody, I would like to know how the IQ-Tree interprets polymorphisms in morphological data the software interprets it as missing data? (0,1) and {0,1} Thank you in advance! Felipe Francisco Barbosa ", "Hi Felipe, These special characters are accepted in IQ-TREE, however they are treated as missing data (like gaps). So you are right. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/37044cb2-a509-49ce-9abe-86b8bcd736be%40googlegroups.com "]}, "xxwuime3TTY": {"topic": "Fwd: [iqtree] gCF and sCF interpretation question", "initializeDate": "Jan 28, 2021, 9:24:51 AM", "timeStamp": "Jan 28, 2021, 9:24:51 AM", "content": ["Hi there, Forwarded below is the answer by Matt Hahn. Hope that it helps! Minh Begin forwarded message: From: \"Hahn, Matthew\" < m...@indiana.edu Subject: Re: [iqtree] gCF and sCF interpretation question Date: 19 January 2021 at 5:53:26 am AEDT To: Minh Bui < minh...@univie.ac.at Cc: Rob Lanfear < rob.l...@gmail.com Well, these data are clearly from bacteria, where it\u2019s not clear what sCFs should mean\u2014there\u2019s not \u201cnormal\u201d recombination, so no ILS as we imagine it should be measured by site discordance. In any case, given their numbers, I think it\u2019s perfectly possible that their sequences are not very informative, such that sCFs are close to 1/3. In this case I guess the genes are informative enough\u2014possible because they\u2019re very long, or because informative sites are clumped non-randomly\u2014to give the results they\u2019re seeing. But as I said: I would be wary of applying CFs to bacteria in the first place. It\u2019s not wrong, just a bit unproven. matt On Jan 18, 2021, at 9:04 AM, Minh Bui < minh...@univie.ac.at > wrote: Hi Rob and Matt, This is a question in the IQ-TREE forum. What would you say here? Thanks! Minh Begin forwarded message: From: Alexander Kneubehl < a-kne...@onu.edu Subject: [iqtree] gCF and sCF interpretation question Date: 8 January 2021 at 4:23:54 pm AEDT To: IQ-TREE < iqt...@googlegroups.com Reply-To: iqt...@googlegroups.com Hi all, This may be a naive question from a neophyte but I have a node that has some CF data that has me a little puzzled. The analysis was done on a concatenated dataset of 760 single copy core genome orthologs from 9 different strains of bacteria (same genus different species) following the directions on the iqtree website. The node in particular has a bootstrap/gCF/sCF of 100/62.2/37.7, a gCF/gDF1/gDF2/gDFP of 62.24/8.03/11.45/18.29, a gCF_N/gDF1_N/gDF2_N/gDFP_N of 473/61/87/139, an sCF/sDF1/sDF2 of 37.68/27.62/34.7 and an sCF_N/sDF1_N/sDF2_N of 10427.1/7646.89/9608.56. Now I would expect based on my limited understanding of concordance factors that if the sCF is low (approaching 33% indicating that there is little signal in the sites being analyzed) that the gCF would be low as well at least not as high as 62. However here we see that the gCF >> gDF1 and gDF2 but the sCF is somewhat similar to sDF1 and sDF2. How would one interpret these results? Any help would be greatly appreciated! Thanks. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d6b9f0c7-70c0-48b2-aa3c-9d449e8c3286n%40googlegroups.com "]}, "mpIRlBpzFtw": {"topic": "FcLM with Iqtree 1.6.12 error", "initializeDate": "Oct 30, 2019, 10:00:13 AM", "timeStamp": "Oct 31, 2019, 5:23:13 AM", "content": ["Hi all, I got an error - and its quite urgent unfortunately when doing FcLM (see below) with 1.6.12. Anyway, I used a partition file along with it, -spp. When I alternatively do -q instead, it also givves me an error - -spj could not be found so use -spp. what to do ? (or is it a RAM error? unlikely since I permuted some data and all these runs with the same dataset finish successfully. (problem is numerical underflow...?) command: iqtree -nt AUTO -st AA -salignment.fas -spp partitionfile.nex -lmap ALL -lmclust group.nex -te BIONJ -wql -pre fclm_hypo1a_v2__o -safe ... ... warnings like: WARNING: States(s) P, W rarely appear in partition EOG0004873 and may cause numerical problems .... or shall I try it without partition? (would be very unfortunately though... best Karen Computing 2250 quartet likelihoods (one dot represents 100 quartets). WARNING: Numerical underflow for lh-branch Proportion of invariable sites: 0.408 Gamma shape alpha: 0.640 WARNING: Numerical underflow for lh-derivative Proportion of invariable sites: 0.408 Gamma shape alpha: 0.640 WARNING: Numerical underflow for lh-derivative Proportion of invariable sites: 0.408 Gamma shape alpha: 0.640 WARNING: Numerical underflow for lh-derivative Proportion of invariable sites: 0.408 Gamma shape alpha: 0.640 WARNING: Numerical underflow for lh-derivative Proportion of invariable sites: 0.408 Gamma shape alpha: 0.640 WARNING: Numerical underflow for lh-derivative ERROR: phylokernelnew.h:3159: double PhyloTree::computeLikelihoodFromBufferSIMD() [VectorClass = Vec4d, nstates = 20, FMA = true, SITE_MODEL = false]: Assertion `std::isfinite(tree_lh) && \"Numerical underflow for lh-from-buffer\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: fclm_hypo1a_v2_original.log ERROR: *** Alignment files (if possible) run_fclm.sh: line 8: 27029 Aborted (core dumped) /home/meusemann/Programs/iqtree/iqtree-1.6.12-Linux/bin/iqtree -nt AUTO -st AA -s Lref_Ltax_hypo1a_v2_outgr_all.aa.original.fas -spp Lref_Ltax_hypo1a_v2_outgr_all.aa.original.partitions.nex -lmap ALL -lmclust Hypo1a_v2_outg_all.group.nex -te BIONJ -wql -pre fclm_hypo1a_v2_original -safe ", "Hi Karen, Can you pls send me and Heiko the input data to debug? It looks like a bug indeed. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/13fb9072-f3ef-401c-b324-43f694372c36%40googlegroups.com ", "yes, I will need it very urgtly though! (have altogether 4 runs to run! many thanks Karen Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "h2t3-X62FEo": {"topic": "node with SH-aLRT very high and UFBoot very low, should I trust?", "initializeDate": "Sep 4, 2018, 11:34:43 AM", "timeStamp": "Sep 5, 2018, 3:23:04 AM", "content": ["Hello, I'm analysing metabarcoding data from the 18S rRNA gene from a marine expedition. My dataset contains few short sequences (around 130 bp long) plus full-length 18S sequences (around 1700 bp). I've been using IQ-tree for a while and I realized that in general, UFBoot gives higher supports than SH-aLRT . However, in my dataset , I find some clades in where there is a striking difference in the supports, being the UFBoot much lower . I attach a screenshot of the part of the tree I'm most interested in. I would like to know if I can trust the group of OTUs (coloured in red) being within any of the other clades, if some of the nodes have these bootstraps: 100/57 or 96.5/57 I know that your suggestion is to trust a clade if SH-aLRT is over 80 and UGBoot over 95, but I just wonder what might cause UFBoot to be so low when it's usually the other way around. Is it normal? How could I interpret it? To run the tree I used this command: iqtree-omp -s papara_alignmentt.no_Holozoa_parv.fa -m TEST -alrt 1000 -bb 1000 -pre iq_no_Hol_parv -wsr -wbt -nt 8 in where the selected substitution model according to BIC was TN+I+G4 Thank you very much, ", "Hi Alicia, Yes we observed this trend as well, but this is not always happening. Sometimes UFBoot support values can be lower. The reason is that SH-aLRT only looks at the three trees around a branch of interest (that differs by exactly one nearest neighbour interchange - NII), and essentially performing an SH tree topology test for these 3 trees. Whereas UFBoot looks at many more trees during the tree sampling. So when this happens, SH-aLRT might \u201coverlook\u201d good trees that are two or more NNIs away from the ML tree. Does that make sense to you? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <iq_tree_question.png> ", "Yes, it makes sense. As UFBoot seems to be more reliable because the tree rearrangement is more exhaustive, I cannot trust my group of sequences to be in that position or within any of the immediate clades. A pity, but this is science! :) Thank you very much for the answer, "]}, "vp0lGlX1zI0": {"topic": "Volunteering to test beta version 1.7", "initializeDate": "Oct 28, 2018, 10:39:29 PM", "timeStamp": "May 31, 2019, 1:49:11 AM", "content": ["Dear users, We\u2019re pleased to announce beta version 1.7-beta5 with many cool features among others: * Much faster tree search under topological constraint. * Ability to infer separate trees across partitions or alignments in a directory. * Better support for non-reversible models (e.g. with bootstrap and partitioning). * Detection of phylogenetic terraces (Biczok et al. 2018), https://doi.org/10.1093/bioinformatics/bty384 * Transfer bootstrap expectation (Lemoine et al. 2018), https://doi.org/10.1038/s41586-018-0043-0 * Ability to find best-fit codon / protein / DNA models for protein-coding genes (Whelan et al. 2015), https://doi.org/10.1093/sysbio/syu062 Therefore we would like to ask for volunteers to test this beta version (those features above), which is very helpful before an official release. Please let me know if you can test this version and report any problem you may encounter. Download and details on the command options are available here: https://github.com/Cibiv/IQ-TREE/releases/tag/v1.7-beta5 Thank you in advance, Minh ", "In the latest version, is omp the default compile mode, and I don't need `-DIQTREE_FLAGS=omp` for compiling the parallel version any more? Is that right? If you want to compile the hybrid MPI/OpenMP version, simply run: cmake -DIQTREE_FLAGS=omp-mpi .. By following the docs, I tried to compile the the source code with both ` DIQTREE_FLAGS omp mpi ` and ` DIQTREE_FLAGS mpi `, but the resulting binary is identical. Is the document out of date, or I missed something? ", "Hi Chang, Yes the document is outdated, omp is the default version since 1.6. That\u2019s why these generated identical binaries. FYI, if you want to turn off OpenMP, then you need to add: DIQTREE_FLAGS =single Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8f25909c-5ed2-4ffa-a93f-ea1cfdddd853%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Hello Minh, I will try this version to test TBE. To run it I have to perform too Ufastboot or boot in the same command and save the bootrees? Is this command is correct: ./iqtree -s infile.fas -spp part.nex -bb/b 100 -wbt --tbe -pre test_TBE Thanks Nicolas ", "Hi Nicolas, That\u2019s the correct command line, except that the ultrafast bootstrap does not work with TBE. So only -b and not -bb. Thanks for testing! Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f4e317f8-7185-46a1-b7a7-3588f8d38af2%40googlegroups.com "]}, "OqlC89qGeVg": {"topic": "MULTISTATE MODEL FOR ANALYSES OF RECODED AMINO-ACID DATA", "initializeDate": "Jun 21, 2019, 8:45:57 AM", "timeStamp": "Jun 26, 2019, 4:06:40 AM", "content": ["Dear iqtree team, I was not able to find an appropriate answer to my question in the group so here it is: I have a long (genomic) amino-acid alignment which i would like to analyze as recoded (eg. 6 states). This means by reducing the states from 20 to 6 for example (in Dayhoff-6 recoding). Is there a multistate model implemented in IQ-TREE that can be used to analyze such data? For example i have done such analyses in raxml before by using the -m MULTIGAMMA model and the GTR matrix. Is there a similar model implemented in IQ-TREE to do such analyses? I guess one option is to use the morphological models available (e.g. GTR2, JC2) but those are only for 2 states (i.e. binary data). Is there a possibility to use a model that can accommodate any number of states (up to 20) depending on the analysis? Any help would be appreciated. Many thanks alex ", "Hi Alex, Just to begin: I attended a talk at the Evolution meeting yesterday (the presenter was Alexandra Hernandez), which concluded that 6-state recoding actually increases saturation. I\u2019m not sure how generalised this conclusion is, given their few simulations. But at least this gives us some warning, and one should compare it with the AA tree. Now the answers: On 21 Jun 2019, at 8:45 am, Alexandros Vasilikopoulos < alexva...@gmail.com > wrote: Dear iqtree team, I was not able to find an appropriate answer to my question in the group so here it is: I have a long (genomic) amino-acid alignment which i would like to analyze as recoded (eg. 6 states). This means by reducing the states from 20 to 6 for example (in Dayhoff-6 recoding). Is there a multistate model implemented in IQ-TREE that can be used to analyze such data? For example i have done such analyses in raxml before by using the -m MULTIGAMMA model and the GTR matrix. Is there a similar model implemented in IQ-TREE to do such analyses? Yes there is. Once you converted the alignment into 0-5 characters, simply run IQ-TREE with \"-mset GTR\". By default ModelFinder only tests the MK model for morphological data. This -mset option will change this to GTR. Cheers, Minh I guess one option is to use the morphological models available (e.g. GTR2, JC2) but those are only for 2 states (i.e. binary data). Is there a possibility to use a model that can accommodate any number of states (up to 20) depending on the analysis? Any help would be appreciated. Many thanks alex You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6d9dd092-4393-4a78-8044-d2920528883d%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Many thanks Minh! Alexandros Vasilikopoulos --------------------------------------------------------------------------------------------------- MSc, PhD candidate Centre for Molecular Biodiversity Research. Zoological Research Museum Alexander Koenig. Leibniz Institute for Animal Biodiversity Adenauerallee 160 53113 Bonn, Germany www.zfmk.de Tel: +49 228 9122-407 Fax: +49 228 9122-212 "]}, "Fm2JT8ve7nc": {"topic": "How to select model for binary irreversible sequence data?", "initializeDate": "Oct 7, 2018, 11:14:12 AM", "timeStamp": "May 29, 2019, 1:59:55 AM", "content": ["mix package in phylip is for building tree from binary irreversible sequence. Changes 0 --> 1 are much more probable than changes 1 --> 0 (Camin-Sokal) Seems that there is no model in iqtree to do this job. Which argument should I modify to make iqtree fit Camin-Sokal http://evolution.genetics.washington.edu/phylip/doc/mix.html ", "Is it possible to assign prior mutation rate for any kind of mutation? Just like GTR{1.0,2.0,1.5,3.7,2.8} but include more number in the blacket, XXX{1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0} ", "Hi there, I\u2019ve never heard of Camin Sokal model. The web page you sent talks about parsimony, whereas IQ-TREE does likelihood inference. So I don\u2019t know what is this model in the likelihood context\u2026 Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi again, I\u2019m assuming you want to perform non-reversible DNA model. This most general model is called 12.12, which belongs to the class of Lie Markov models. You can fix Lie Markov model parameters with: -m \u201c12.12{r1,\u2026,r11}\" However, r_i are parameters in the range (-1,1) and have a very different meaning than GTR model. For more details please have a look at this paper: Woodhams et al., 2015 Cheers Minh ", "Hi Minh, I read document about Lie Markov model carefully, and make some attempt to apply the model to BINARY data. But Seems that these models are for DNA only, even if I manually encode the 1, 0 chars into two DNA base, iqtree won't start... It is possible to run iqtree on Binary data with irreversible model? If I like to use such model with iqtree, what can I do? Could you please give me some suggestions? sincerely, Chang On Monday, October 8, 2018 at 2:39:58 PM UTC+8, Minh Bui wrote: Hi again, I\u2019m assuming you want to perform non-reversible DNA model. This most general model is called 12.12, which belongs to the class of Lie Markov models. You can fix Lie Markov model parameters with: -m \u201c12.12{r1,\u2026,r11}\" However, r_i are parameters in the range (-1,1) and have a very different meaning than GTR model. For more details please have a look at this paper: Woodhams et al., 2015 Cheers Minh On 8 Oct 2018, at 5:07 pm, Chang Ye < yech...@gmail.com > wrote: Is it possible to assign prior mutation rate for any kind of mutation? Just like GTR{1.0,2.0,1.5,3.7,2.8} but include more number in the blacket, XXX{1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0} On Sunday, October 7, 2018 at 11:14:12 PM UTC+8, Chang Ye wrote: mix package in phylip is for building tree from binary irreversible sequence. Changes 0 --> 1 are much more probable than changes 1 --> 0 (Camin-Sokal) Seems that there is no model in iqtree to do this job. Which argument should I modify to make iqtree fit Camin-Sokal http://evolution.genetics.washington.edu/phylip/doc/mix.html You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Also there is no useful error message for debugging... ```bash ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ``` ", "Hi Chang, Somebody may correct me. But currently I believe there is no non-reversible Markov process for binary data, unless this process is non-stationary, i.e. the state frequencies will change along the tree. However, non-stationary models are not supported in IQ-TREE and it\u2019ll take a large effort to implement it. Therefore, right now I suggest that you look for other software\u2026 Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2cee3f59-30ec-4000-a135-1b019c6589b4%40googlegroups.com ", "Hi Minh Thanks for your advice. "]}, "HOXXzp6FU1k": {"topic": "-rcluster-max in modelmerging with IQtree 1.6.3", "initializeDate": "Sep 28, 2018, 7:44:49 PM", "timeStamp": "Sep 28, 2018, 9:55:44 PM", "content": ["Hello Minh, I have a related question to previous discussion in the group for modelmerging in IQtree. I have a dataset with 1757 genes (initial partitions, amino acid sequences). I am running iqtree to find the best model and partition scheme using the following command: iqtree -nt 30 -st AA -s ChalCOS.1757genes.TrimManual.Mare.d5.fas -spp ChalCOS.1757genes.TrimManual.Mare.d5.charset.nex -m MF+MERGE -rcluster-max 10000 -mset LG,WAG,BLOSUM62,DCMUT,JTT,DAYHOFF,JTTDCMUT -madd LG4X,LG4M -pre 2.2_ChalCOS_1757gene.GO.TrimManual.MARE.d5.AA.IQtree.MFM.10k -cptime 60 -safe To get the analysis done in a reasonable amount of time, I set the rcluster-max to 10000. My understanding is that means the program will only look at the top 10000 merging options and then will stop. But when I look at the log file, it shows it is still running even after it has finished about 30000 merging schemes! Please help me out here... Why the rcluster-max doesn't help to terminate the merging at about 10000? I really hope the merging optimization on my dataset could be done in a few days, but not months. Did I missing something here? Model LG4X is alias for MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4 Model LG4M is alias for MIX{LG4M1,LG4M2,LG4M3,LG4M4}*G4 30914 JTT+F+R5 20970931.737 EOG091B02RP+EOG091B0EW7 215h:13m:47s (21265h:15m:1s left) Model LG4M is alias for MIX{LG4M1,LG4M2,LG4M3,LG4M4}*G4 30915 JTT+F+R4 20970886.097 EOG091B0JDJ+EOG091B03JH 215h:13m:52s (21264h:40m:49s left) Model LG4X is alias for MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4 Model LG4M is alias for MIX{LG4M1,LG4M2,LG4M3,LG4M4}*G4 30916 JTT+R4 20971100.763 EOG091B02AM+EOG091B0ADG 215h:14m:6s (21264h:21m:58s left) Model LG4M is alias for MIX{LG4M1,LG4M2,LG4M3,LG4M4}*G4 30917 JTT+F+R4 20971094.769 EOG091B0IOL+EOG091B05XS 215h:15m:6s (21265h:19m:31s left) Thank you very much for your help! Best, Junxia Junxia Zhang (PhD) Department of Entomology University of California, Riverside 900 University Avenue Riverside CA 92521 USA Website: https://www.zoology.ubc.ca/~jxzhang/ ", "Hi Junxia, Please also use option -rcluster (e.g. just add \u201c-rcluster 10\u201d). Otherwise, the -rcluster-max is not effective\u2026 We will change the behaviour in the next release so that -rcluster-max automatically activates the rcluster algorithm. Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "j884eSJiugY": {"topic": "how to use recoded protein alignments (for instance dayhoff4) with IQtree", "initializeDate": "Jun 25, 2016, 6:42:13 AM", "timeStamp": "Aug 4, 2016, 11:16:27 AM", "content": ["Hi, To reduce overall compositional heterogeneity across taxa, I often recode my protein alignments to dayhoff4 groups or SR4 (susko&roger, 4groups), using the nucleotide characters representing each group. When I then use that as input for PhyloBayes (CAT or CAT-GTR), it accepts the alignment because it believes its dealing with a nucleotide alignment. And as far as I understand, it doesnt matter if you use a protein alignment or nucleotide alignment for the CAT or CAT-GTR model. Now I would like to try out a mixture model from IQtree (C60, for instance), and I'm not sure whether its okay to use that on a recoded alignment. I'm guessing no, but I'm not sure. Kind regards, Joran ", "Dear Joran There is currently no such \"nucleotide\" mixture model in iqtree, i.e. C60 is only valid for protein data. However if you insist on using such model there is a way to specify it in iqtree. C60 consists of 60 aa frequency vectors. When you convert aa to nt as you described, you can also transform aa frequencies to nt frequencies, by summing up the aa freq belonging to the same nt character. Then specify such C60 transformed frequencies in a Nexus model file, see documentation on mixture models: http://www.cibiv.at/software/iqtree/doc/Complex-Models/#mixture-models and input it into iqtree via -mdef option. It may look something like this: #nexus begin sets; frequency C60NT1= piA1 piC1 piG1 piT1; frequency C60NT2= piA2 piC2 piG2 piT2; ... frequency C60NT60= piA60 piC60 piG60 piT60; model C60NT=POISSON+G+FMIX{C60NT1,C60NT2,...,C60NT60}; end; (here replace piA1,..., piT60 with the transformed frequencies explained above) then run iqtree with command like: iqtree -mdef this_model_file.nex -m C60NT ... If you need more help let me know Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "sorry there was a typo, please replace \"begin sets;\" by \"begin models;\" Minh ", "Aha I see that is a clever way of doing it! I'll look into it ", "Dear Minh, I am also interested in running a recoded tree. The model I use for the protein runs is -m LG+C60+F So I can not really get an equivalent on the recoded data, since I will not optimize the frequencies but I need to give them instead. I was wondering if I could get them from the run I did on the protein alignment but the optimized frequencies are not output in the log file. Or are they perhaps in one of the other output files? So the next available option is to look what are the set frequencies for the LG+C60 so that I could sum them the way they belong to the categories of the recoding I want to use (sr4, Susko and Roger). Could you help me out where to look for those numbers, I am not sure. thanks, Kasia ", "Dear Kasia, Joran might have produced such a transformed frequencies already. Thus, best is to ask Joran: can you pls provide us the transformed model? Also, the mapping from amino-acids to nucleotides. It would be good to have the transformed models for all C10 to C60 models. Then I may integrate it into the next release of IQ-TREE. Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh! the sr4 recoding is the following: A,G,N,P,S,T = A; C,H,W,Y = C; D,E,K,Q,R = G; F,I,L,M,V = T http://mbe.oxfordjournals.org/content/24/9/2139.long Joran is actually sitting next door. No he did not calculate it. I would do that but I still do not know where to take the frequencies from. I thought perhaps you simply had the numbers somewhere one could import them easily. I have now checked the publication: Quang, Le Si, Olivier Gascuel, and Nicolas Lartillot. 2008. Empirical profile mixture models for phylogenetic reconstruction. Bioinformatics 24:2317-2323. and I can see there are matrices in the supplementary tables. But first of all I am not sure which one is actually THE one used, since they differ slightly and there is more than one per mixture. Secondly, it is not frequencies, so I would like to make sure that what I am thinking is the proper way of turning these numbers into frequencies is actually what people do. Thirdly, one would want that in electronic format do easily do the calculations and not as pdf. http://bioinformatics.oxfordjournals.org/content/suppl/2008/08/21/btn445.DC1/bioinf-2008-0768-File009.pdf There is an excel sheet available at http://www.atgc-montpellier.fr/models/index.php?model=mixture but unfortunately it does not cover C20-C60. Should email the authors for the files that I would like to have? I guess you must have it as part of Iqtree, right? Also, I realized that once I am done with this, I CAN actually optimize the frequencies because it will simply be adding '+F' at the end of the specified model. Is that right? thanks a lot for your helpful and fast responses! Kasia ", "Oh I see, then have a look at IQ-TREE code: https://github.com/Cibiv/IQ-TREE/blob/master/model/modelmixture.cpp there you will see entries like: frequency C10pi1 = 0.4082573125 0.0081783015 0.0096285438 0.0069870889 0.0349388179 0.0075279735 0.0097846653 0.1221613215 0.0039151830 0.0125784287 0.0158338663 0.0059670150 0.0081313216 0.0061604332 0.0394155867 0.1682450664 0.0658132542 0.0018751587 0.0041579747 0.0604426865;\\n\\ note that the order of amino-acids is: A R N D C Q E G H I L K M F P S T W Y V Hope that you can proceed further with this. Minh ", "Dear Minh! I have now created the nexus file, that looks like this (I attach the file to the post): ------------- #nexus begin models; frequency C60NT1= 0.6671684132 0.0296031604 0.263873245 0.0393551815; frequency C60NT2= 0.1276338907 0.0209812196 0.7927062299 0.0586786597; frequency C60NT3= 0.0163962994 0.0051413956 0.0030074531 0.975454852; ... frequency C60NT60= 0.0386456469 0.0058035261 0.0121187396 0.9434320874; model C60SR4=POISSON+G+FMIX{C60NT1, C60NT2, C60NT3, C60NT4, C60NT5, C60NT6, C60NT7, C60NT8, C60NT9, C60NT10, C60NT11, C60NT12, C60NT13, C60NT14, C60NT15, C60NT16, C60NT17, C60NT18, C60NT19, C60NT20, C60NT21, C60NT22, C60NT23, C60NT24, C60NT25, C60NT26, C60NT27, C60NT28, C60NT29, C60NT30, C60NT31, C60NT32, C60NT33, C60NT34, C60NT35, C60NT36, C60NT37, C60NT38, C60NT39, C60NT40, C60NT41, C60NT42, C60NT43, C60NT44, C60NT45, C60NT46, C60NT47, C60NT48, C60NT49, C60NT50, C60NT51, C60NT52, C60NT53, C60NT54, C60NT55, C60NT56, C60NT57, C60NT58, C60NT59, C60NT60}+F; end; ------------- you can see the frequencies calculated from the C60 LG in the google sheet: https://docs.google.com/spreadsheets/d/1hj0OSlSPKPgg02R4p_hZdH3O-pHEvWYj4Cj64ihWaxg/edit?usp=sharing Everyone having this link should be able to edit, so go ahead if you would like to add other C-series. My model testing always pick C60 (which is no suprise knowing that in phylobayes it actually has 300-900 mixtures). I get an error though that seems to be complaining about the name of the frequency vector: ------------- Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.493 seconds Reading model definition file /local/bin/Iqtree_C60sr4.nex ... 48 models and 274 frequency vectors loaded Generating 1000 samples for ultrafast bootstrap (seed: 521544)... Model C60SR4 is alias for POISSON+G+FMIX{C60NT1, C60NT2, C60NT3, C60NT4, C60NT5, C60NT6, C60NT7, C60NT8, C60NT9, C60NT10, C60NT11, C60NT12, C60NT13, C60NT14, C60NT15, C60NT16, C60NT17, C60NT18, C60NT19, C60NT20, C60NT21, C60NT22, C60NT23, C60NT24, C60NT25, C60NT26, C60NT27, C60NT28, C60NT29, C60NT30, C60NT31, C60NT32, C60NT33, C60NT34, C60NT35, C60NT36, C60NT37, C60NT38, C60NT39, C60NT40, C60NT41, C60NT42, C60NT43, C60NT44, C60NT45, C60NT46, C60NT47, C60NT48, C60NT49, C60NT50, C60NT51, C60NT52, C60NT53, C60NT54, C60NT55, C60NT56, C60NT57, C60NT58, C60NT59, C60NT60}+F ERROR: Frequency mixture name not found C60NT2. ------------- I am not sure why it says 48 models, since I only define one, and 274 frequency vectors when it should only be 60. Perhaps something is wrong with the formatting, although I tried to follow your example. It seems to be reading first vector fine but not the next one and I am not sure why. Something should be different in the new line separation...? I have also tried model definition without '+F' but obviously this is not what the error is about so it does not make a difference. thanks a lot for your helpful assistance! Kasia ", "SILLY I just noticed there was an extra space, so this is corrected now ------------------ C60SR4=POISSON+G+FMIX{C60NT1,C60NT2,C60NT3,C60NT4,C60NT5,C60NT6,C60NT7,C60NT8,C60NT9,C60NT10,C60NT11,C60NT12,C60NT13,C60NT14,C60NT15,C60NT16,C60NT17,C60NT18,C60NT19,C60NT20,C60NT21,C60NT22,C60NT23,C60NT24,C60NT25,C60NT26,C60NT27,C60NT28,C60NT29,C60NT30,C60NT31,C60NT32,C60NT33,C60NT34,C60NT35,C60NT36,C60NT37,C60NT38,C60NT39,C60NT40,C60NT41,C60NT42,C60NT43,C60NT44,C60NT45,C60NT46,C60NT47,C60NT48,C60NT49,C60NT50,C60NT51,C60NT52,C60NT53,C60NT54,C60NT55,C60NT56,C60NT57,C60NT58,C60NT59,C60NT60}+F; ------------------ and I end up with the following error instead: ------------------ Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.262 seconds Reading model definition file /local/bin/Iqtree_C60sr4.nex ... 48 models and 274 frequency vectors loaded Generating 1000 samples for ultrafast bootstrap (seed: 581828)... Model C60SR4 is alias for POISSON+G+FMIX{C60NT1,C60NT2,C60NT3,C60NT4,C60NT5,C60NT6,C60NT7,C60NT8,C60NT9,C60NT10,C60NT11,C60NT12,C60NT13,C60NT14,C60NT15,C60NT16,C60NT17,C60NT18,C60NT19,C60NT20,C60NT21,C60NT22,C60NT23,C60NT24,C60NT25,C60NT26,C60NT27,C60NT28,C60NT29,C60NT30,C60NT31,C60NT32,C60NT33,C60NT34,C60NT35,C60NT36,C60NT37,C60NT38,C60NT39,C60NT40,C60NT41,C60NT42,C60NT43,C60NT44,C60NT45,C60NT46,C60NT47,C60NT48,C60NT49,C60NT50,C60NT51,C60NT52,C60NT53,C60NT54,C60NT55,C60NT56,C60NT57,C60NT58,C60NT59,C60NT60}+F ERROR: Invalid model name POISSON ------------------ which I guess is understandable considering that it is guessing that the alignment is DNA. But now I tried instead: ------------------ model C60SR4=GTR+G+FMIX{C60NT1,C60NT2,C60NT3,C60NT4,C60NT5,C60NT6,C60NT7,C60NT8,C60NT9,C60NT10,C60NT11,C60NT12,C60NT13,C60NT14,C60NT15,C60NT16,C60NT17,C60NT18,C60NT19,C60NT20,C60NT21,C60NT22,C60NT23,C60NT24,C60NT25,C60NT26,C60NT27,C60NT28,C60NT29,C60NT30,C60NT31,C60NT32,C60NT33,C60NT34,C60NT35,C60NT36,C60NT37,C60NT38,C60NT39,C60NT40,C60NT41,C60NT42,C60NT43,C60NT44,C60NT45,C60NT46,C60NT47,C60NT48,C60NT49,C60NT50,C60NT51,C60NT52,C60NT53,C60NT54,C60NT55,C60NT56,C60NT57,C60NT58,C60NT59,C60NT60}+F; ------------------ which is running and I think will do what I want! So I attach the final nexus file in case someone want to use it. cheers, Kasia ", "that\u2019s cool, thanks! regarding this line: > Reading model definition file /local/bin/Iqtree_C60sr4.nex ... 48 models and 274 frequency vectors loaded this is the total number of builtin models (like C10, EX, EHO, etc) and the user-defined models. That\u2019s why it is much more than the number of models you specified. Minh > <Iqtree_C60sr4.nex> "]}, "vm2JW_uDGMw": {"topic": "Running IQ-TREE on taxa with exclusively missing data", "initializeDate": "Mar 23, 2018, 10:27:14 PM", "timeStamp": "Mar 25, 2018, 8:07:01 PM", "content": ["Dear IQ-TREE users, I'm trying to run some gene tree analyses but in order to do that, I need to have gene trees with complete matching taxa sets. Unfortunately, I have some taxa that are missing from some loci. I can have complete taxa matching on all my loci by introducing gaps or missing data but IQ-TREE won't run on taxa consisting of exclusively missing data/gaps. Does anyone have any suggestions for this? Thank you in advance Chan ", "Hi Chan, I\u2019m not complete sure what you are doing. Let\u2019s assume, you infer a gene tree for each single gene, which IQ-TREE can do of course. Then having a set of reconstructed gene trees, you build a super tree, which you can do with a super tree method such as ASTRAL, which should work with gene trees having incomplete taxon set. So everything should work OK and I don\u2019t really know, what the problem is. Or you need to describe explicitly what you did (e.g., which programs, which command lines etc.). Then we may help. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "jGPIn1RPUek": {"topic": "ERROR: Rooted constraint tree not accepted ?", "initializeDate": "Oct 2, 2018, 3:11:31 PM", "timeStamp": "Oct 5, 2018, 3:35:55 AM", "content": ["Hi all, I'm trying to execute a constrained tree search on a large dataset using a newick-formatted constraint tree. However, I'm getting the following error when i attempt to run: `ERROR: Rooted constraint tree not accepted` I haven't encountered this problem with my smaller test datasets, and I'm not quite sure how a newick tree could be rooted. Or am I parsing this message incorrectly, and it's not accepting the constraint tree (which happens to be rooted) for unspecified other reasons? Any insights would be appreciated! Thanks, -jon ", "Hi Jon, The constraint tree should be unrooted. It could be likely due to something like this: ((A1,A2,A3),(B1,B2,B3)); This is a rooted tree with 2 clades A and B. To unroot it, simply remove the bracket around A or B: (A1,A2,A3,(B1,B2,B3)); The purpose of this error message is to avoid potential misuse, that users would like to have A and B monophyletic, whose definition is based on a rooted tree. Here, it only means that there is at least a branch separating taxa A from B. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Thanks so much for getting back to me! I'm not sure I quite understand. I haven't been able to replicate this behavior on my small test data: no matter what combinations of parentheses/tree splits I create with a small toy dataset, I can't get it to give me the rooted tree error. The only way I've been able to replicate this error is by adding a root branch length to the small test tree, as so: `((A1, A2, A3), (B1, B2, B3)):0.01` Just running with `((A1, A2, A3), (B1, B2, B3))` or `(((A1, A2), A3), (B1, B2, B3))` seems to work! I have discovered that i'm not getting the rooting error with the large (real) constraint tree when running on version 1.5.5. Any additional thoughts? Many thanks, ", "Hi Jon, On 4 Oct 2018, at 3:03 am, Jon Sanders < jon...@gmail.com > wrote: Hi Minh, Thanks so much for getting back to me! Sure ;-) I'm not sure I quite understand. I haven't been able to replicate this behavior on my small test data: no matter what combinations of parentheses/tree splits I create with a small toy dataset, I can't get it to give me the rooted tree error. The only way I've been able to replicate this error is by adding a root branch length to the small test tree, as so: `((A1, A2, A3), (B1, B2, B3)):0.01` That\u2019s right, adding a root branch length make the tree rooted. Please remove it. Just running with `((A1, A2, A3), (B1, B2, B3))` or `(((A1, A2), A3), (B1, B2, B3))` seems to work! I have discovered that i'm not getting the rooting error with the large (real) constraint tree when running on version 1.5.5. Right, v1.5.X converts all input rooted trees to unrooted. But this is not the case with v1.6.X because it implements non-reversible models, which work with rooted trees. Whereas previous versions have no such models. Hope that helps, Minh "]}, "-CIrYZcL6NI": {"topic": "Re: [iqtree] evolutionary rates and speed info: log and iqtree output", "initializeDate": "Mar 1, 2021, 9:21:27 PM", "timeStamp": "Mar 1, 2021, 9:21:27 PM", "content": ["already replied On 28 Feb 2021, at 12:16 am, 'kmeus...@ googlemail.com ' via IQ-TREE < iqt...@googlegroups.com > wrote: Dear all, just a quick question: the partition-specific rate in the log file, and the \"speed\" are suppsed to be similar, correct? and differences are only due to \"rounding\" the numbers? (from an earlier post 3 years ago: The Speed column is exactly as you asked: it is the partition specific rate. They are computed by maximum likelihood. The rates are normalized such that the weighted average is 1, where the weights are the partition alignment length divided by supermatrix length.) Thanks & best, Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/450ced4f-e54e-45fd-a450-356e2aa404b8n%40googlegroups.com "]}, "4YXMrWr8QeE": {"topic": "Error using \"-S\" to generate gene trees with UCEs data", "initializeDate": "May 30, 2019, 8:47:54 AM", "timeStamp": "May 31, 2019, 1:50:21 AM", "content": ["Hello, I am trying to use IQ-TREE to generate gene trees with my UCEs data, and I am receiving the following error message: ERROR: modelmarkov.cpp:1302: virtual void ModelMarkov::decomposeRateMatrix(): Assertion `(Q - Q.transpose()).cwiseAbs().maxCoeff() < 0.1 && \"transformed Q is symmetric\"' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: loci.log ERROR: *** Alignment files (if possible) Thanks for the support. Cheers, Felipe. ", "Hi Felipe, Thanks for testing the new version. Did you try the latest beta version? (beta12 I think). If so, can you pls send me the input files for debugging purpose? Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/747daf3c-b125-44dd-af5a-a4c611df8807%40googlegroups.com For more options, visit https://groups.google.com/d/optout "]}, "E6QPCgNDWZA": {"topic": "IQ-TREE CRASHES WITH SIGNAL ERRONEOUS NUMERIC", "initializeDate": "Mar 13, 2017, 8:59:38 PM", "timeStamp": "Mar 20, 2017, 11:44:01 AM", "content": ["Greetings! I'm attempting to run a partitioned dataset analysis with topological constraints, but I'm receiving an error. Here are the first and last 10 lines of the .log file: First 10: IQ-TREE multicore version 1.5.3 for Linux 64-bit built Jan 15 2017 Copyright (c) 2011-2016 Nguyen Lam Tung, Olga Chernomor, Arndt von Haeseler and Bui Quang Minh. Host: WARDBIOINFO (AVX2, FMA3, 62 GB RAM) Command: iqtree-omp -s temno_116_int_linsi_zorro_RY_CO_3rd_pos.phy -spp partitions_models.nex -b 200 -nt 4 -g constraint.newick Seed: 970105 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Mon Mar 13 17:38:16 2017 Kernel: AVX+FMA - 4 threads(24 CPU cores detected) Last 10: ===> START BOOTSTRAP REPLICATE NUMBER 1 Creating bootstrap alignment (seed: 970105)... Creating fast SIMD initial parsimony tree by random order stepwise addition... STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL ERRONEOUS NUMERIC *** For bug report please send to developers: *** Log file: partitions_models.nex.log *** Alignment files (if possible) What might be happening here? Many thanks, Matt ", "Dear Matt, This crash \u201cerroneous numeric\u201d indeed looks weird. Since I cannot explain now, can you send me the data files via personal email, so that I can reproduce the crash? Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Matt, I have fixed this problem, caused by a combination of partitioned analysis with bootstrapping and constraint tree. I will send you the version to test soon. However, I have a rather conceptual issue: Currently when performing bootstrap, the constraint tree is only imposed to the tree search on the original alignment, but NOT to the tree search for bootstrap replicates. Therefore, the bootstrap trees may not obey the constraint. Alternatively, one can force the bootstrap trees to obey the constraint. This effectively gives 100% support to all branches appearing in the constraint tree. Thus, I am not really sure, what should be the default option when combining bootstrap and constraint tree. Your (and other) opinions will be welcome here. Thanks, Minh ", "Dear Minh, Thank you very much! For this project I was aiming for the latter option, with the constraint imposed on the bootstrap trees as well. I'm not sure if this falls within the realm of what other users would find useful, though. Best wishes, Matt ", "Hi Matt, On the second thought, bootstrap trees should obey the constraint tree topology, otherwise there is no point in specifying both -b and -g options. Moreover, this will be consistent with the ultrafast bootstrap under constraint, because there the constraint is applied to all bootstrap trees. I will do this change and let you know a version to test. Thanks for the discussion. Minh ", "Hi Minh, a question related to this. If one bootstraps with constraints (and IQ-Tree knows about this), will there be support value reported on the branches? And if yes, what value will that be? 100? Due to the constraint there is no chance it cannot be in any of the trees\u2026 thus, reporting 100 might be misleading. In fact, constraint branches are now trivial once, like the external branches, because they cannot change. Please note, this is of course different if you bootstrap without constraint to get \u2018unbiased\u2019 (depends on the view point ;) support estimate for the constraint branches. Best, Heiko ", "Hi Heiko, On Mar 20, 2017, at 1:26 PM, Heiko Schmidt < heiko....@univie.ac.at > wrote: Hi Minh, a question related to this. If one bootstraps with constraints (and IQ-Tree knows about this), will there be support value reported on the branches? Yes. Every branch will have support values. And if yes, what value will that be? 100? Due to the constraint there is no chance it cannot be in any of the trees\u2026 thus, reporting 100 might be misleading. Not always: If the constraint tree has all species, then its branches will have 100% support. But if some species is not present in the constraint, it may jump around the resulting ML tree and may break that branch, i.e. having support lower than 100%. Minh "]}, "m6lUK4ZHuF0": {"topic": "bug report: iqtree crashes during model selection", "initializeDate": "Dec 28, 2016, 3:26:26 AM", "timeStamp": "Jan 3, 2017, 8:11:26 AM", "content": ["I am performing an iqtree analysis with ca. 7000 taxa and 1600 binary characters. When I try -m TESTNEW, iqtree-omp crashes with the error message: BEST NUMBER OF THREADS: 2 1 JC2+FQ 1864997.198 13767 3757528.396 382845640.396 3831853.486 2 JC2+FQ+ASC 1864997.194 13767 3757528.388 382845640.388 3831853.478 STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: iqalertSC.log *** Alignment files (if possible) Here are the beginning and end of the log file: IQ-TREE multicore version 1.5.2 for Linux 64-bit built Dec 3 2016 Copyright (c) 2011-2016 Nguyen Lam Tung, Olga Chernomor, Arndt von Haeseler and Bui Quang Minh. Host: cleo.uni-tuebingen.de (SSE4.2, 503 GB RAM) Command: iqtree-omp -nt AUTO -m TESTNEW -s sc.phy -alrt 1000 -pre iqalertSC -safe Seed: 2045 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Dec 28 08:54:21 2016 Kernel: Safe SSE3 - auto-detect(64 CPU cores detected) Reading alignment file sc.phy ... Phylip format detected [...] BEST NUMBER OF THREADS: 2 1 JC2+FQ 1864997.198 13767 3757528.396 382845640.396 3831853.486 2 JC2+FQ+ASC 1864997.194 13767 3757528.388 382845640.388 3831853.478 STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: iqalertSC.log *** Alignment files (if possible) Any help is appreciated. Thanks! Gerhard ", "Dear Gerhard, sounds like a bug \u2014 I rarely tried binary data. Therefore, can you send me your alignment via my personal email? Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "xuRUSaxRKHo": {"topic": "Approximately Unbiased test returns p-value of 1.0 while other tests are significant", "initializeDate": "Aug 14, 2018, 3:06:23 PM", "timeStamp": "Jan 31, 2019, 9:11:26 AM", "content": ["I want to use the Approximately Unbiased test to compare tree topologies. I want to compare the Maximum Likelihood tree to multiple other trees that have constraints on the monophyly of the taxa of interest. I obtained four trees using likelihood methods, and used those as the input in IQ-TREE to run the AU test. I'm actually most interested in comparing trees #2 and #3 (alternative phylogenetic hypotheses) to tree #1 (the ML tree) shown below. Tree #4 is a tree in which I included monophyletic constraints that I knew would produce a tree that was much worse than the ML tree. So the fourth tree is expected to differ significantly. I'm noticing a strange result with respect to the behavior of the AU test. I will share the results here, and if someone wishes to look at the input data files I'm happy to share them by email. USER TREES ---------- See belo509raxml_8loci_r1.phy.trees for trees with branch lengths. Tree logL deltaL bp-RELL p-KH p-SH c-ELW p-AU ------------------------------------------------------------------------- 1 -42271.306 0.000 0.5485 + 0.5937 + 1.0000 + 0.5457 + 0.5115 + 2 -42272.563 1.257 0.4140 + 0.4063 + 0.7919 + 0.4154 + 0.4794 + 3 -42296.487 25.181 0.0375 - 0.0546 + 0.3303 + 0.0389 - 0.4705 + 4 -42736.708 465.401 0.0000 - 0.0000 - 0.0000 - 0.0000 - 1.0000 + deltaL : logL difference from the maximal logl in the set. bp-RELL : bootstrap proportion using RELL method (Kishino et al. 1990). p-KH : p-value of one sided Kishino-Hasegawa test (1989). p-SH : p-value of Shimodaira-Hasegawa test (2000). c-ELW : Expected Likelihood Weight (Strimmer & Rambaut 2002). p-AU : p-value of approximately unbiased (AU) test (Shimodaira, 2002). Plus signs denote the 95% confidence sets. Minus signs denote significant exclusion. All tests performed 10000 resamplings using the RELL method. So just to be sure that I understand this correctly, the AU test compares each of the user trees to the user tree that has the greatest logL. In other words, I am making three comparisons: T2-T1, T3-T1, and T4-T1. Is that correct? Then I would interpret these results to say that T4 is significantly worse than T1 based on all tests except p-AU. For that test the p-value is 1.000. This seems strange to me. So I'm writing to ask whether this is an error in the way that I'm running the analysis, or interpreting the results, or whether there is a problem with the calculation of p-AU? I have compared the results from IQ-TREE v1.6.6 on XSEDE to those obtained using the IQ-TREE web server v1.6.6. Using both platforms, I am experiencing the same problem. I tried to run the same dataset using v1.6.2 on XSEDE, however, it completes the tree inference analysis, and when it arrives at the user trees it gives me an error in the log file: \"Tree 1ERROR: #leaves and taxa_set do not match!\" (even though the same exact files do work in 1.6.6). Thank you in advance for your help! ", "Dear Dan, The AU test implementation in IQ-TREE is currently suspended due to some fundamental problem, which I couldn\u2019t clarify with Shimodaira, CONSEL author. It happens when bp-RELL is zero (see discussion: https://groups.google.com/forum/#!topic/iqtree/Dw4rl-SYxqY ). So pls use CONSEL instead. Regarding: \"Tree 1ERROR: #leaves and taxa_set do not match!\" (even though the same exact files do work in 1.6.6). Yes this problem was fixed in v1.6.6 Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thank you for the clarification, Minh. ", "Hi, I run into the same problem with iqtree 1.6.8 where, as I understood, the problem with estimation of p-values of AU test was fixed. Topology test was run as follows: iqtree 1.6 Linux bin iqtree s $ WorkingDir InputAlignment nt $ SLURM_CPUS_PER_TASK spp $ WorkingDir PartitioningScheme z $ WorkingDir TreeGraph_trees tre te $ WorkingDir Fin24 treefile 10000 pre $ SLURM_JOB_NAME Tree logL deltaL bp RELL p KH p SH p WKH p WSH c ELW p ------------------------------------------------------------------------------------------- 5641283.195 414.44 1.5e-112 5641334.838 466.08 2.95e-120 5641324.895 456.14 8.73e-118 5641352.307 483.55 1.62e-124 5641387.955 519.2 1.88e-143 5640916.227 47.473 0.0065 0.0082 0.307 0.0082 0.0278 0.00659 0.458 5641312.867 444.11 2.15e-129 5641383.439 514.69 4.77e-152 5640868.754 0.994 0.992 0.992 0.993 0.542 5641393.774 525.02 8.57e-152 I'd be happy for any suggestions. I can share more details on inputs/outputs. Best, Ales ", "", "Hi Ales, This problem should have been fixed, not sure why\u2026. Can you please send me the dataset via personal email? Thanks, Minh On 17 Dec 2018, at 4:48 pm, Ales Bucek < bucek...@gmail.com > wrote: ", "Dear Minh, can you pls quickly check whether this was also an issue in earlier versions then (below 1.6.6 - 1.6.5, 1.6.4 and 1.5.5?) I need to know this since I am writing together a MS and when IO did the AU tests, it was a while ago - I need to check whether I have to repeat everything or not... Many thanks, see also other question on the Au test and quartet mapping pls! Many thanks Karen ", "Hi Karen again, Yes this problem with v1.6.8 was fixed in v1.6.9, see the release note: http://www.iqtree.org/news/ IMPORTANT: Incorrect AU test p-values with partition models, introduced in v1.6.8 (reported by Ales Bucek). That means, it does not affect any other version. Minh "]}, "Yd1iVpJ-wcs": {"topic": "Construction of tree using alignment with too many short reads", "initializeDate": "Feb 28, 2021, 1:14:44 AM", "timeStamp": "Mar 1, 2021, 7:43:49 PM", "content": ["How does iqtree make sure the proper integration of shorter sequences in the tree? Which algorithm does it use to integrate short sequences as optimally as possible? ", "Hi here, IQ-TREE is not for placement of short reads. Please use other software like EPA-NG. Cheers Minh On 28 Feb 2021, at 5:14 pm, Samragi Chatim < samragi...@gmail.com > wrote: How does iqtree make sure the proper integration of shorter sequences in the tree? Which algorithm does it use to integrate short sequences as optimally as possible? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1d7e3ec6-e3f8-45ab-87b6-1c2912090449n%40googlegroups.com "]}, "_n4eVLlI6dY": {"topic": "\"IQ-TREE CRASHES WITH SIGNAL ABORTED\", tree construction with codon model", "initializeDate": "Jun 17, 2020, 2:36:04 AM", "timeStamp": "Jun 29, 2020, 3:52:55 AM", "content": ["Hi, I launched a tree construction with a codon model and received this error message : | OPTIMIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Iteration 30 / LogL: -89992.939 / Time: 5h:30m:5s (13h:23m:1s left) Iteration 40 / LogL: -89249.789 / Time: 6h:50m:15s (10h:38m:24s left) ERROR: iqtree.cpp:3060: virtual pair<int, int> IQTree::optimizeNNI(bool): Assertion `curScore > appliedNNIs.at(0).newloglh - 0.1' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: /home/gdupre/work/HA_phylo/muscleAlign/tree_inferences/codon_models_trees/ali_dna_HA7_ntCDSlist.trim.aln.log ERROR: *** Alignment files (if possible) /bin/bash: line 1: 76638 Aborted iqtree -s /home/gdupre/work/HA_phylo/muscleAlign/tree_inferences/codon_models_trees/ali_dna_HA7_ntCDSlist.trim.aln -m MG+F1X4+R6 -st CODON -alrt 1000 -b 100 -redo -nt 8 Am I doing something wrong? How can I fix this issue? The logfile of this job is attached to this post. ps : I am using IQtree 2.0.4 in a cluster with a Linux environnement. Best regards Gabriel ", "I assume this is the same issue with codon + free-rate models. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/75778d96-2c72-4f0f-9fd1-1f24c6909fa9o%40googlegroups.com <ali_dna_HA7_ntCDSlist.trim.aln.log> ", "Hi Minh, If I may, I would like to get some feedback about this issue, which might be quite similar to another problem when I performed ASR jobs with codon models, in another post. Have you had the time to look into this problem? Best regards, Gabriel Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "DRoWy8h_BHk": {"topic": "Tree visualization", "initializeDate": "Mar 17, 2020, 4:15:32 PM", "timeStamp": "Apr 21, 2020, 10:22:22 AM", "content": ["Good morning, I did a phylogenetic analysis (DNA) using the SH-aLRT and UFBoot branches support (command line: -alrt 1000 -bb 1000). The IQTREE manual suggests using the Figtree software to visualize the trees, and in theory it should obtain for each branch the value between parentheses of SH-aLRT support (%) / ultrafast bootstrap support (%). However, I have tried to visualize the tree in different softwares and neither of them shows me both values, only one appears ... Why is this? Is it a tree error or is a error for the visualization software? How can I correct it? or is it normal?. In the output file (.iqtree) the tree appears with the two values (SH-aLRT support (%) / ultrafast bootstrap support (%)). Thank you very much for all your help and collaboration. ", "I work with something like this in R: require(phytools) contree_rpltrnNdh<-phytools::read.newick(paste0(getwd(),\"/iqtree/rpltrnNdh.contree\") ) is.rooted(contree_rpltrnNdh) # F length(contree_rpltrnNdh$tip.label)# require(ggtree) aLRTvaluesCons<-as.numeric(sub(\"([[:digit:]\\\\.]+)(\\\\/)([[:digit:]\\\\.]+)\",\"\\\\1\",contree_rpltrnNdh$node.label) ) FbootvalCons<-as.numeric(sub(\"([[:digit:]\\\\.]+)(\\\\/)([[:digit:]\\\\.]+)\",\"\\\\3\",contree_rpltrnNdh$node.label) ) valuesCons<-mapply(paste0,aLRTvaluesCons,\"/\",FbootvalCons) values2Cons<-character() values2Cons[(length(contree_rpltrnNdhDrop$tip.label)+1):(length(contree_rpltrnNdhDrop$tip.label)+contree_rpltrnNdhDrop$Nnode)]<-valuesCons require(ggrepel) mybigtreeCons<-ggtree(contree_rpltrnNdh, color=\"#cccccc\", branch.length = T) + geom_tiplab(align=F,linetype=1, linesize=.02, size=1.8, offset=0.0)+ geom_text_repel(aes(label=values2Cons), vjust=-1.2, hjust=0.7,size=4, fontface=\"bold\", colour=\"blue3\") On Tue, Mar 17, 2020 at 5:15 PM Patricia Gonz\u00e1lez Grande < patriciagon...@gmail.com > wrote: Good morning, I did a phylogenetic analysis (DNA) using the SH-aLRT and UFBoot branches support (command line: -alrt 1000 -bb 1000). The IQTREE manual suggests using the Figtree software to visualize the trees, and in theory it should obtain for each branch the value between parentheses of SH-aLRT support (%) / ultrafast bootstrap support (%). However, I have tried to visualize the tree in different softwares and neither of them shows me both values, only one appears ... Why is this? Is it a tree error or is a error for the visualization software? How can I correct it? or is it normal?. In the output file (.iqtree) the tree appears with the two values (SH-aLRT support (%) / ultrafast bootstrap support (%)). Thank you very much for all your help and collaboration. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/135c0c22-b395-442e-8859-7959e10190b7%40googlegroups.com ", "Thank you so much for your help! I will try to do it! To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAPApNyxugK15Y%3DW1FP-j5Qkw99CycABCw8ytS_RcijPQG3nvkw%40mail.gmail.com ", "Maybe you should write the extra value manually, there are many creative options, like over of 0.80 colour brown or something -Andr\u00e9s ", "I would recommend TreeGraph . Also, you can try iTOL which allows choosing which values you would like to show. \u5728 2020\u5e743\u670818\u65e5\u661f\u671f\u4e09 UTC+8\u4e0b\u53489:58:33\uff0cPatricia Gonz\u00e1lez Grande\u5199\u9053\uff1a Thank you so much for your help! I will try to do it! El mar., 17 de mar. de 2020 a la(s) 17:44, Fernando Roa ( fer...@gmail.com ) escribi\u00f3: I work with something like this in R: require(phytools) contree_rpltrnNdh<-phytools::read.newick(paste0(getwd(),\"/iqtree/rpltrnNdh.contree\") ) is.rooted(contree_rpltrnNdh) # F length(contree_rpltrnNdh$tip.label)# require(ggtree) aLRTvaluesCons<-as.numeric(sub(\"([[:digit:]\\\\.]+)(\\\\/)([[:digit:]\\\\.]+)\",\"\\\\1\",contree_rpltrnNdh$node.label) ) FbootvalCons<-as.numeric(sub(\"([[:digit:]\\\\.]+)(\\\\/)([[:digit:]\\\\.]+)\",\"\\\\3\",contree_rpltrnNdh$node.label) ) valuesCons<-mapply(paste0,aLRTvaluesCons,\"/\",FbootvalCons) values2Cons<-character() values2Cons[(length(contree_rpltrnNdhDrop$tip.label)+1):(length(contree_rpltrnNdhDrop$tip.label)+contree_rpltrnNdhDrop$Nnode)]<-valuesCons require(ggrepel) mybigtreeCons<-ggtree(contree_rpltrnNdh, color=\"#cccccc\", branch.length = T) + geom_tiplab(align=F,linetype=1, linesize=.02, size=1.8, offset=0.0)+ geom_text_repel(aes(label=values2Cons), vjust=-1.2, hjust=0.7,size=4, fontface=\"bold\", colour=\"blue3\") On Tue, Mar 17, 2020 at 5:15 PM Patricia Gonz\u00e1lez Grande < patriciagon...@gmail.com > wrote: Good morning, I did a phylogenetic analysis (DNA) using the SH-aLRT and UFBoot branches support (command line: -alrt 1000 -bb 1000). The IQTREE manual suggests using the Figtree software to visualize the trees, and in theory it should obtain for each branch the value between parentheses of SH-aLRT support (%) / ultrafast bootstrap support (%). However, I have tried to visualize the tree in different softwares and neither of them shows me both values, only one appears ... Why is this? Is it a tree error or is a error for the visualization software? How can I correct it? or is it normal?. In the output file (.iqtree) the tree appears with the two values (SH-aLRT support (%) / ultrafast bootstrap support (%)). Thank you very much for all your help and collaboration. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/135c0c22-b395-442e-8859-7959e10190b7%40googlegroups.com You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "2r0-1ZTJ7_4": {"topic": "Calculate AICc of fixed partitioning schemes under different models", "initializeDate": "Jul 9, 2020, 8:37:02 AM", "timeStamp": "Jul 13, 2020, 8:51:01 PM", "content": ["Hi all, I have a superalignment for which I have separately inferred trees based on a CAT-like model JTT+C60+F+R8 but also under a partitioned model and a site-homogeneous unpartitioned model and also with the PMSF model: 1) JTT+C60+F+R8 (unpartitioned) 2) LG+R10 (unpartitioned) 3) Partitioned with r-cluster (site-homogeneous models, edge-linked) 4) PMSF (with the LG+R10 tree as a guide tree) I am trying to find a way to compare the AICc under the different schemes after tree search, but it seems to me the information is not printed anywhere in the log files for 3, 4. Note for the first two I have the score already because they were included in a model selection phase. Is there an automatic way to calculate AICc for 3 and 4? (still have all output files for 3 and 4 except for the log files though) thanks Alex ", "I just found now there is an AICc score under the maximum-likelihood tree in the .iqtree file so this question is probably obsolete. ", "I also realized that the AIC scores under PMSF and all other models are not comparable as mentioned in the paper. Is this correct? Any solution to this problem? Thanks again Alex ", "Hi Alex, That\u2019s right, AIC and other information theoretic scores are not comparable between PMSF and mixture models. Perhaps Ed can give comments on this? From my perspective, PMSF is an approximation to the mixture model to save time and memory. So as long as mixture models fit best to your data (you can use ModelFinder to check that), then you can just use PMSF as a replacement for mixture models. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/037266ad-ae90-4965-8c9c-e3abf5e5a38en%40googlegroups.com ", "Hi Minh, Many thanks for the reply. I am referring to the case in which you have a tree both under the full site-heterogeneous model and under the PMSF approximation. If the topology is different how do we choose between the two based on an objective criterion? Does it make sense to select the tree under the full site-heterogeneous model because the PMSF is only an approximation? My confusion stems from the fact that in the paper is mentioned somewhere that the PMSF approximation might be more accurate than the full heterogeneous model it is derived from. Best and thanks Alex ", "Forwarded Ed answer below, Begin forwarded message: From: Edward Susko < edward...@gmail.com Subject: Re: [iqtree] Calculate AICc of fixed partitioning schemes under different models Date: 13 July 2020 at 10:56:53 pm AEST To: Minh Bui < minh...@univie.ac.at Hello Alex; I agree with what Minh said. If a mixture model is considered a good fit, then PMSF, which effectively fits or adjusts for that type of model in a computationally efficient way, can be considered a good model. In the paper, we discuss using the parametric bootstrap to compare PMSF to another model (p231 last par through to new section `Comparing PMSF ....'). The difficulty with this approach is that it is computationally intensive. So, again, I tend to agree with Minh's suggestion. If a mixture is considered a good model, for a fixed guide then PMSF is a good computationally efficient choice for tree-searching. One comment I would add, is that I believe AIC over-penalizes mixtures, particularly those with a large number of classes. The reason is that with mixtures you can have a number of weights that are estimated as effectively 0. AIC wasn't intended for this setting where parameters are on the boundary of their parameter space. So a mixture can be the best fitting model but not considered as such by AIC. In a recent paper Andrew Roger and I explored the use of cross-validation as an alternative. The difficulty, once again, is that cross-validation increases the computation required (and we probably need to work more on implementation) although it can be used with as few as two-folds if combined with bias correction. ", "Hi All, I'd like to weigh in here with a personal opinion. Others may disagree, I know some folks certainly would. My opinion: the AICc (or AIC, or BIC, or any metric) is a useful tool to help inform us of the 'best' model, but not the be-all and end-all. All such metrics make all sorts of assumptions about the data, many of which haven't really even been carefully considered with respect to phylogenetic data (e.g. do you really think the sample size should be represented as the number of alignment columns??? This implies that adding taxa to the alignment adds no information...). I don't think they're drastically wrong - it's obviously sensible to penalise the addition of new parameters somehow . And they of course provide a convenient shortcut. I just think we tend to give them too much prominence, and worry too much about estimating them for all models and always choosing the model with the best AICc. What I'd encourage people to do as well as (or instead of, although many would think of this as heretical!) using information theoretic approaches is to think carefully about the evolution of their sequences and choose a model that seems to best reflect the underlying biology with a sensible number of parameters. Mixture models are inherently sensible, and the PMSF is a great approximation that makes it possible to them with a very reasonable number of parameters. I think we've drifted to a tendency to think that the only way to defend model choice is to show that we've chosen the model with the best AICc. I'd like to see a shift back towards a biological defense of the models we choose. Rob To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/F9374FAE-BAA0-4BBD-A551-B76DFEC7499E%40univie.ac.at Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com "]}, "UQkyzn4uMaY": {"topic": "Re: [iqtree] IQTREE 2.0 PMSF slow", "initializeDate": "Feb 6, 2020, 9:18:30 AM", "timeStamp": "Feb 6, 2020, 9:18:30 AM", "content": ["Hi Courtney, Have you tried -nt AUTO option? You have quite short alignment: \"Alignment has 170 sequences with 315 columns, 309 distinct patterns\" with only 309 site patterns, and thus using more cores might even slow it down. This is explained in the tutorial: http://www.iqtree.org/doc/Tutorial#utilizing-multi-core-cpus Cheers Minh On 4 Feb 2020, at 3:48 am, Courtney Stairs < courtne...@gmail.com > wrote: Hi IQTREE fans! I am trying to run NP-bootstraps with the following command using the latest 2.0 release candidate. I noticed some weird things: iqtree 2.0 rc1 Linux bin iqtree m LG C60 ft treefile pre pmsf tbe s fasta 100 tbe the total run time of this was (all 100 BS): Total CPU time used 7970.002 sec 12m 50s Pretty quick!! Especially since I gave it only 2 of my 40 threads. I have been running quite a number of trees with this command with and without the alrt flag and noticed no difference in run time until my most recent attempts. I have since tried running this same dataset (plus or minus one or more taxa) and noticed it was taking a lot longer - in the last 4 wall clock hours it has not even finished one bootstrap (still on iteration 50 after 4 h). And thats on 4 threads! Time 47s So I thought maybe this was just because I was doing other things on my workstation. I tried to run the same command on an HPC cluster (6 threads on a 16G RAM node without any other users) and it has been stuck on the first bootstrap for 5+ hours which is nearly double what it was taking last week for 100 BS. I've now seen similar issues on 3 different system architectures. However, in each case, I am simply running the iqtree from the binary (that is, not in an environment). Could this be an issue? It might be using the wrong libraries or something? Still doesn't quite explain why it was working quickly last week. Any ideas of what I could try? I've attached the following files, please let me know if you need anything else: 1) FastRun.log 2) FastRun.alignment 3) FastRun.seedtree 4) SlowRun.log 5) SlowRun.alignment 6) SlowRun.seedtree Thank you for your time :) :) Courtney You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2019aa56-c831-4018-8f96-d896c0f57386%40googlegroups.com <SlowRun.alignment> <SlowRun.log> <SlowRun.seedtree> <FastRun.seedtree> <FastRun.alignment> <FastRun.log> "]}, "RxAsiQ_gij8": {"topic": "long branch and unrealible results in the runing", "initializeDate": "Jul 10, 2018, 5:15:51 AM", "timeStamp": "Jul 10, 2018, 5:15:51 AM", "content": ["I used the PF2 results into iqtree, and it runs successfully, but I got an unreliable result compared to the results from CIPRES(ML-tree), a clade has a very long branch, and contains ten species that belong to some different clades/taxon in real. The parematers as follows: iqtree -s XXXX.phy -spp XXXX.nex -bb 1000 And I also tried another method \u2014\u2014run every gene tree in iqtree used the command line: iqtree -s XXXX.phy -m MFP after that, I got the best fit model for every gene used BIC, and I write a NEXUS format file manually like this: #nexus begin sets; charset part1 = 1 -1530; charset part2 = 1531 -2112; charset part3 = 2113 -3114; ....... charpartition mine = TVMe+R3:part1 , K3Pu+F+R2:part2 ....... At last, I used : iqtree -s XXXX.phy -spp XXXX.nex -m MFP -bb 1000 There are warnning messages: WARNING: Too high (saturated) partition rates for proportional partition model! Current log-likelihood at step 1: -192589.529 But actually, I used plant mitochondrial genes, so generally, all of the genes have a relative lower evolutioan rate. I was very confused if I used a set of wrong parameters or if I had misunderstood these procedures. I look forward to your reply. Thanks. Yunxia "]}, "w7zZusvm1oA": {"topic": "Recoded dataset stationary frequencies, plus a feature suggestion.", "initializeDate": "Feb 5, 2021, 4:13:55 PM", "timeStamp": "Feb 9, 2021, 6:10:38 AM", "content": ["Hey again Minh, Another thing we've been messing with lately is protein sequence recoding, particularly SR4 and Dayhoff6. It took an embarrassing amount of time to pick up on the fact that \"X\"s in the sequences were causing the runs to fail. After converting those to dashes or question marks for ambiguous characters, everything went smoothly. So, here are a few questions that have come up in discussions. 1) For a 4-state alphabet, does it make a difference whether I recode to letters (ATCG) or numbers (0123)? Do the morphological MK and GTR4 behave the same as JC and nucleotide GTR? 2) To grossly misquote the literature (looking at the intro of doi:10.1093/molbev/msu044 atm) for a protein dataset, a +F model adjusts the empirical rate matrix Q based on the observed stationary amino acid frequencies (by going through the exchangeability matrix R; not even going to try posting the whole r\u03c0 business here). However, what happens in iqtree if I'm using a GTR model? (morphological GTRX in this case, but the question also applies for nucleotide GTR4 and protein GTR20) At first glance, I'd expect such an adjustment to be embedded in the GTRX estimation but adding FO and F to the model selection picks one of them instead. What am I missing here? For protein datasets, would using Qmaker make a difference? 2.5) As an offshoot of the previous question; for amino acid datasets, have you ever benchmarked if +FO on different starting matrices adjusts them to sth similar-looking? Again, I might be misunderstanding sth. 3) Is it possible to use PMSF to get from SR4 to SR4+C60+F+G or do I have to run the mixture model directly? 4) Little feature suggestion: would it be possible to implement a molecular clock test in iqtree i.e. an option that when providing a (rooted) tree, all branch lengths are set to equal, and an ML estimate of what that length would be; then it's fairly simple to do an LRT between the strict clock (more like ultrametric in this case?) and the unconstrained input trees. I was looking around for a while (including the options for dating), and what I ended up doing for fun was to include +Hk in the model selection. If a heterotachy model comes up as >10BIC better than the simple one, I'd say that rejects the clock hypothesis. What do you think? Sorry for being such a hassle again and thanks for your time. Best, Panos ", "Hi Panos, On 6 Feb 2021, at 8:13 am, Panagiotis Adam < panagiotis...@gmail.com > wrote: Hey again Minh, Another thing we've been messing with lately is protein sequence recoding, particularly SR4 and Dayhoff6. It took an embarrassing amount of time to pick up on the fact that \"X\"s in the sequences were causing the runs to fail. After converting those to dashes or question marks for ambiguous characters, everything went smoothly. So, here are a few questions that have come up in discussions. 1) For a 4-state alphabet, does it make a difference whether I recode to letters (ATCG) or numbers (0123)? Do the morphological MK and GTR4 behave the same as JC and nucleotide GTR? I\u2019d say there is no differerence between these 2 recodings, MK = JC and GTR4 = GTR. 2) To grossly misquote the literature (looking at the intro of doi:10.1093/molbev/msu044 atm) for a protein dataset, a +F model adjusts the empirical rate matrix Q based on the observed stationary amino acid frequencies (by going through the exchangeability matrix R; not even going to try posting the whole r\u03c0 business here). However, what happens in iqtree if I'm using a GTR model? If you are recoding to a DNA alignment, the default for GTR is +F. (morphological GTRX in this case, but the question also applies for nucleotide GTR4 and protein GTR20) At first glance, I'd expect such an adjustment to be embedded in the GTRX estimation but adding FO and F to the model selection picks one of them instead. What am I missing here? I believe if you are recoding to 0123, the default is then +FQ (for equal frequencies) for morphological data. So that the difference. For protein datasets, would using Qmaker make a difference? It only makes a difference with QMaker if you have a partitition model: while QMaker estimate a single Q matrix for all parititions, it actually allows different rate heterogeneity types between partitions. Whereas without QMaker, you will can only have a single model, i.e., non-partitioning, in order to estimate a joint Q matrix for all alignment sites. 2.5) As an offshoot of the previous question; for amino acid datasets, have you ever benchmarked if +FO on different starting matrices adjusts them to sth similar-looking? Again, I might be misunderstanding sth. For +FO, technically IQ-TREE will initialize the parameters with the observed frequencies (like from +F) and then try to estimate them further using maximum likelihood. So we also see that +FO improves the likelihood compared with +F. In terms of benchmarking (or testing), I didn\u2019t really perform a thorough test, but since +FO always returns better log-likelihood than +F, I didn\u2019t see anything unexpected. 3) Is it possible to use PMSF to get from SR4 to SR4+C60+F+G or do I have to run the mixture model directly? Yes, PMSF should also work with non-amino-acid models. If not, please follow up here. 4) Little feature suggestion: would it be possible to implement a molecular clock test in iqtree i.e. an option that when providing a (rooted) tree, all branch lengths are set to equal, and an ML estimate of what that length would be; then it's fairly simple to do an LRT between the strict clock (more like ultrametric in this case?) and the unconstrained input trees. I was looking around for a while (including the options for dating), and what I ended up doing for fun was to include +Hk in the model selection. If a heterotachy model comes up as >10BIC better than the simple one, I'd say that rejects the clock hypothesis. What do you think? Once upon a time there was indeed an idea to implement a strick clock model in IQ-TREE. However, I never got enough motivation to implement such feature, as strict clock will be rejected for most (say >95%) of the datasets anyway. So this model, while historically interesting, is almost useless nowadays\u2026. Sorry for being such a hassle again and thanks for your time. No worries, it\u2019s the purpose of this maillist. Minh Best, Panos You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e7995940-5846-4684-a2d7-55951c592747n%40googlegroups.com "]}, "G8qFNMmW30g": {"topic": "Adding weights to positions in likelihood function", "initializeDate": "May 21, 2020, 1:29:51 PM", "timeStamp": "May 27, 2020, 6:48:57 AM", "content": ["Hi Minh, Is there a built in option to add non integer weights to the likelihood function? (providing an array in the size of number of positions) If not, is there a simply way for me to change the code to enable this option? Thanks!! Noa ", "Hi Noa, There is no such option. But as far as I remember, Olga changed the code of IQ-TREE to accept non-integer weights of sites. She might have a version for that, or at least can tell how to change the code. @Olga, can you pls help Noa? Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/87f131e4-564d-4781-9787-dec47eee6c81%40googlegroups.com ", "That would be great! I will wait for an update from you... thanks!! Noa On Friday, May 22, 2020 at 3:51:42 AM UTC+3, Minh Bui wrote: Hi Noa, There is no such option. But as far as I remember, Olga changed the code of IQ-TREE to accept non-integer weights of sites. She might have a version for that, or at least can tell how to change the code. @Olga, can you pls help Noa? Thanks Minh On 22 May 2020, at 3:29 am, Noa Ecker < n12...@gmail.com > wrote: Hi Minh, Is there a built in option to add non integer weights to the likelihood function? (providing an array in the size of number of positions) If not, is there a simply way for me to change the code to enable this option? Thanks!! Noa You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Noa, indeed, for one of the projects I was using the non-integer weights for the sites, but they were not used in the tree search or any other IQ-TREE routines, but rather in a separate function, specialised on computing the score I needed. I will check the code and then let you know, if it might be useful. Cheers, Olga To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6462be96-dd06-4ce2-b035-2ffedcc4db7e%40googlegroups.com ", "Hi! What I need is a possibility to add weights per site to the likelihood computation , to be used in all the IQtree tree search routines. Do you think this is possible? or is it too complicated to implement? Thank you very much for your help! To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4BAE9873-6949-4FAA-9200-B6B47DBB0D6E%40gmail.com "]}, "h9IZrngiBoM": {"topic": "Re: [iqtree] Bootstrap on ML tree from 500 runs", "initializeDate": "Apr 1, 2020, 6:18:39 PM", "timeStamp": "Apr 1, 2020, 6:18:39 PM", "content": ["Just for record: already answered in previous thread. On 2 Apr 2020, at 1:50 am, Wendy Valencia < valen...@gmail.com > wrote: Dear Mihn, I hope you are well I have run IQtree with the combination of parameters you suggested in the best practices posts, that is 500 runs, that is 100 runs under -pers from 0.1 to 0.5 and -nstop parameter set to 1000. From these 500 runs, I've picked the maximum likelihood tree. However, I'm not sure how to repeat this exact run to perform 10,000 ultrafast bootstrap replicates. I've tried to replicate the same analysis again, specifying the partition (-spp) and the best model (-mdef), and the same random seed (-seed) that I found for that best run, but with -bb 10,000. However, I'm always getting an ML tree that is worst than my best ML from the 500 runs. Probably this is very basic, but I have tried using this best tree as the initial tree (-t option). Nevertheless, I still get a final tree with a worse likelihood, even though it is apparently starting from the highest likelihood spot. The command that I'm running now is: $path_iqtree_2 -p $path_align -bb 10000 -alrt 10000 -T AUTO -spp $best_partition -mdef $best_model -pre $path_out/195spp_14g_best_tree_10kboot_t_12 \\ -o T_Semanga_superba_MWT93D002 -keep_empty_seq --no-terrace -pers 0.5 -nstop 1000 -seed 82291 -wbtl Any help will be very much appreciated. Thank you so much in advance! Wendy You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/eae355a0-fd03-43bf-bbf7-14c890e6e550%40googlegroups.com "]}, "NAE7jGvV84U": {"topic": "MODEL TREES", "initializeDate": "Dec 11, 2019, 1:25:24 PM", "timeStamp": "Dec 14, 2019, 11:10:23 AM", "content": ["Hi! I want to compare topologies of several models for a class. I would like to know if there is any possibility of writing trees of different models computed by IQ-Tree in an output file. I'm currently using both 1.6.12 and 2.0 versions. Thank you!! ", "ModelFinder fixes the tree topology for model selection. So for all models evaluated, the tree is the same (while the branch lengths are different). Minh On 12 Dec 2019, at 5:25 am, Mois\u00e8s Gil i Bernabeu < moigil....@gmail.com > wrote: Hi! I want to compare topologies of several models for a class. I would like to know if there is any possibility of writing trees of different models computed by IQ-Tree in an output file. I'm currently using both 1.6.12 and 2.0 versions. Thank you!! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/08b50190-5996-4e77-8884-7001ed23a5ad%40googlegroups.com ", "Yes, but, is there any output file with these lengths? I've seen .treels have a lot of information, but I can't relate it with concrete model. Tanks for the answer! El dijous, 12 desembre de 2019 0:04:24 UTC+1, Minh Bui va escriure: ModelFinder fixes the tree topology for model selection. So for all models evaluated, the tree is the same (while the branch lengths are different). Minh On 12 Dec 2019, at 5:25 am, Mois\u00e8s Gil i Bernabeu < moigil....@gmail.com > wrote: Hi! I want to compare topologies of several models for a class. I would like to know if there is any possibility of writing trees of different models computed by IQ-Tree in an output file. I'm currently using both 1.6.12 and 2.0 versions. Thank you!! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi there, There is no such option\u2026so I\u2019ll need to run IQ-TREE for each model manually. The treels file (printed by -wt option) contain the trees encountered during tree search. So it has nothing to do with the model selection. Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/173bcb0a-2f9f-4ab8-afe2-812ecd4f1440%40googlegroups.com ", "The TreeRate tool at the HIV Databases: https://www.hiv.lanl.gov/content/sequence/TREERATEv2/treerate.html allows you to past in a Newick format treefile (such as output from IQtree) and then it creates a table of branch lengths. It gives you distance from a not to every other node and to each of the tips. So you could save each table to distances into a spreadsheet or file and then run some computations to compare them (sum total of distances; ratio of tip distances to intra-node distances, etc... ", "The HIV Databases also has an IQtree version so you can run IQtree there and at the bottom of the results page you select BranchLength to analyze the branch lengths. I also recommend saving the log files from IQtree to look at other parameters such as the rate matrix. "]}, "kBAV33aR5Wk": {"topic": "branch lengths shorter than expected", "initializeDate": "Jul 16, 2019, 4:01:06 PM", "timeStamp": "Aug 11, 2019, 3:46:39 AM", "content": ["Hello, Apologies, as I am probably missing something incredibly basic here, but I have a question regarding branch lengths. I am using a data set where there are known differences of at least several dozen variant sites between three clades. However, when I run IQ-Tree on the variant site-only alignment file, I am getting variant differences of <1 (estimated from: total variant sites * scale bar length). This cannot be right. Using the same alignment file in other tree building software gives me the expected branch lengths. So what is different about IQ-Tree? I must be missing something here. Below is the line of code I've been running. The model \"K3P+ASC\" was chosen via BIC in ModelFinder. iqtree s sample aln pre sample_K3P_ASC_bb1000 m K3P ASC nt AUTO ntmax 1000 Any help would be very much appreciated. Many thanks, Liz ", "Hi Liz, This is not a trivial question. Your command line looks fine. Just one thing to note when you wrote: I am getting variant differences of <1 (estimated from: total variant sites * scale bar length). Do you mean the scale bar length displayed by a tree viewer program? I\u2019d not rely on the scale bar length, as it may visually look short/long. What I\u2019d do, is to directly compare the tree length (sum of branch lengths, should be output by IQ-TREE) between two trees. If the tree lengths indeed differ substantially, then please get back to me. One more thing to note, if the other software uses a different model, then this may (substantially) influence the tree length. For example, using +G model may increase the length by a factor of 2 or so. So for the right comparison, you should make sure that both programs use the same model. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/06a20b56-900a-4e7f-9634-230f882f25b6%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Thank you for your reply. I think the difference is IQ-Tree's addition of the ascertainment bias correction (+ASC). For some reason, when ASC is included, the branch lengths shrink so that the entire tree only is about 1 variant difference total . We are working with very closely related strains, but this seems absurdly low given there are 646 total variant sites in the alignment file (564 sequences total). Is this to be expected with the inclusion of ASC? Is there any way to remove the inclusion of ASC in the ModelFinder model options? Thank you so much, Liz On Tuesday, July 23, 2019 at 6:35:52 PM UTC-5, Minh Bui wrote: Hi Liz, This is not a trivial question. Your command line looks fine. Just one thing to note when you wrote: I am getting variant differences of <1 (estimated from: total variant sites * scale bar length). Do you mean the scale bar length displayed by a tree viewer program? I\u2019d not rely on the scale bar length, as it may visually look short/long. What I\u2019d do, is to directly compare the tree length (sum of branch lengths, should be output by IQ-TREE) between two trees. If the tree lengths indeed differ substantially, then please get back to me. One more thing to note, if the other software uses a different model, then this may (substantially) influence the tree length. For example, using +G model may increase the length by a factor of 2 or so. So for the right comparison, you should make sure that both programs use the same model. Cheers, Minh On 17 Jul 2019, at 6:01 am, Liz < eamil...@gmail.com > wrote: Hello, Apologies, as I am probably missing something incredibly basic here, but I have a question regarding branch lengths. I am using a data set where there are known differences of at least several dozen variant sites between three clades. However, when I run IQ-Tree on the variant site-only alignment file, I am getting variant differences of <1 (estimated from: total variant sites * scale bar length). This cannot be right. Using the same alignment file in other tree building software gives me the expected branch lengths. So what is different about IQ-Tree? I must be missing something here. Below is the line of code I've been running. The model \"K3P+ASC\" was chosen via BIC in ModelFinder. iqtree s sample aln pre sample_K3P_ASC_bb1000 m K3P ASC nt AUTO ntmax 1000 Any help would be very much appreciated. Many thanks, Liz You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Minh, Just to follow-up on my previous email. I looked at the IQ-Tree output more carefully, I'm getting the following warnings. Could this be part of the problem? Alignment has 564 sequences with 646 columns 550 distinct patterns 217 parsimony informative 429 singleton sites constant sites **************************** WARNING **************************** Number of parameters model parameters and branch lengths 789 Sample size alignment length 646 Given that K the parameter estimates might be inaccurate Thus phylogenetic estimates should be interpreted with caution Ideally desirable that n When selecting optimal models use AIC BIC 40K use AICc BIC 40K be extremely cautious improve the situation consider the following options Increase the sample size Decrease the number of parameters to be estimated possible Remove the least important sequences from the alignment Specify some of the parameter values for the substitution model the nucleotide amino acid frequencies Specify some of the parameter values for the rates across sites model the shape parameter for the discrete Gamma distribution the proportion of invariable sites the rates of change for different rate categories under the FreeRate model Reference Burnham Anderson 2002 Model Selection and Multimodel Inference Practical Information Theoretic Approach Springer New York ************************ END OF WARNING *********************** WARNING 392 near zero internal branches 0.0015 should be treated with caution Such branches are denoted '**' the figure below ", "Just to follow-up again, I created a SNP distance matrix between samples using snp-dists and compared the resulting SNP differences to those calculated from the sum of branch lengths multiplied by the total number of SNPs. I find that including ASC is vastly underestimating the branch lengths; for two samples with a SNP difference of 6, I find their branch lengths to be 3.51E-4, which comes out to 0.33 SNP differences (3.51E-4 * total number of variant sites). Is this to be expected when including ASC or should the branch lengths match what I see on the snp-dists matrix? Thank you so much, Liz ", "Hi Liz, Sorry for the slow response. Can you pls send me (to my personal email) the alignment for further inspection? Right now I don\u2019t know, what the problem really is. Thanks, Minh On 1 Aug 2019, at 5:11 am, Liz < eamil...@gmail.com > wrote: Just to follow-up again, I created a SNP distance matrix between samples using snp-dists and compared the resulting SNP differences to those calculated from the sum of branch lengths multiplied by the total number of SNPs. I find that including ASC is vastly underestimating the branch lengths; for two samples with a SNP difference of 6, I find their branch lengths to be 3.51E-4, which comes out to 0.33 SNP differences (3.51E-4 * total number of variant sites). Is this to be expected when including ASC or should the branch lengths match what I see on the snp-dists matrix? To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/856ce7b7-105f-45e4-acf8-787a23fab2bc%40googlegroups.com "]}, "EVdKuRYY56o": {"topic": "Drastic difference in the running time", "initializeDate": "Mar 25, 2021, 12:59:49 PM", "timeStamp": "Apr 1, 2021, 5:18:28 AM", "content": ["Dear All, I am running a tree reconstruction for DNA sequences using GTR+G model. However depending which commands I use the running time changes drastically,. Namely if I use \"iqtree sequences.fasta -m GTR+G\" it runs 4 times faster than when using \"iqtree sequences.fasta -spp GTR_G.nexus\" where the nexus file is #nexus begin sets; charset part1 = sequences.fasta:DNA, x-y; charpartition mine = GTR+G:part1; end; Any explanation why this is happening? Thank you very much in advance! Alina ", "Dear Alina, the command lines you used trigger different internal routines and data structures within IQ-TREE code. \"iqtree sequences.fasta -m GTR+G\" The above line is meant for the analysis, when a single evolutionary model is assumed for a complete alignment (your case). \"iqtree sequences.fasta -spp GTR_G.nexus\u201d This line however, should be used, when a partition model is assumed, i.e. when different evolutionary models are employed for different parts of the alignment (for example, when the alignment consists of multiple genes). Partition model analysis requires more complex data structures and handling. Therefore, you see differences in runtimes. In principle, if you only have one partition/one model for a complete alignment, options \u201c-q -Q/-sp -p/-spp\u201d should not be employed. Just use \u201c-m\u201d. Best wishes, Olga You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c5cfd97f-8b06-4b1a-8f2a-b81619653e0fn%40googlegroups.com "]}, "3VxuGvFlsPE": {"topic": "Parallelization of candidate tree set calculation?", "initializeDate": "Dec 12, 2020, 5:15:41 AM", "timeStamp": "Jan 17, 2021, 8:19:29 PM", "content": ["Hi, I would like to propose more parallelization to improve speed of IQTREE2 on very large supermatrices. I found that the following step always uses a single CPU thread (IQ-TREE multicore version 1.6.12 for Linux 64-bit built Aug 15 2019): -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Generating 98 parsimony trees... On very large Supermatrices it runs for days and is a bottleneck for overall performance. I hope this can be parallelized. Best wishes and thanks for the great IQtree2 tool! Heiner ", "Dear Heiner, Sorry for the long delay, I\u2019m back from a long break. Thanks for your suggestion. Quick answer: use -t PARS option to resolve this issue. Long answer: This issue was known but we didn\u2019t focus on this because parsimony is typical fast. But you are right, it can (and should) be paralellised. Technically, IQ-TREE uses the phylogenetic likelihood library and due to the limited interface with this library, it is only called sequentially. However, I believe that if you use -t PARS option, IQ-TREE will then use its own parsimony kernel instead, which indeed parallelises this step. Let me know if using this option helps. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/29c71d69-c2fa-43b3-b2a0-7b50811024d6n%40googlegroups.com "]}, "qaz768HfiKk": {"topic": "Syntax for modelomatic?", "initializeDate": "Dec 12, 2019, 5:50:08 PM", "timeStamp": "Dec 13, 2019, 7:19:08 AM", "content": ["Hello all, I would like to test the implementation of ModeloMatic, but I am having trouble choosing parameters. I have tested it a couple of times, and am getting numerical underflow errors, but I suspect that is my own mispecifications. I have tried specifying modelomatic on a partitioned alignment, e.g. iqtree -s multigeneinput.phy -st CODON --modelomatic -sp multigeneinput.parts , but also on an individual gene alignment, e.g. iqtree -s gene.phy -st CODON --modelomatic . Am I missing something obvious? ", "Hi John, That\u2019s the correct syntax, I don\u2019t see any problem. Can you send me the log file for inspection? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/84db164f-9c8f-4943-94bf-f9f576672ed3%40googlegroups.com "]}, "4K0RHu8ROWA": {"topic": "Output trees with missing taxa in partitioned analyses", "initializeDate": "May 23, 2019, 5:18:41 PM", "timeStamp": "Jun 2, 2019, 6:05:56 PM", "content": ["Hello, I'm running analyses with a partition scheme (-q) and I noticed that in several cases the output trees have less taxa than the original alignment. I check the log and this happened when some species fail the chi2 test. The number of taxa removed is equal to the number of sequences failing the test, but the missing sequences are not necessarily the same that failed the test. I thought that IQ-TREE does not remove those sequences, so I'm confused when I missing those sequences. The command that I used was for example: iqtree -m TESTMERGE -s cluster9987_1rr.NT.aln-gb -nt 2 -bb 1000 -wbt -st DNA -q cluster9987_1rr.NT.aln-gb.partition and the partition file looks like this: DNA, codon1andcodon2 = 1-393\\3, 2-393\\3 DNA, codon3 = 3-393\\3 Thanks, Diego ", "Hi Diego, IQ-TREE internally removed identical sequences, but then added them back at the end to the final tree in random order but clustering the identical sequences together. So it has nothing to do with missing sequences and it\u2019s weird that some taxa are removed in the final tree. Can you send me the input files for further inspection? Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b1ddb132-846c-4602-b6a5-8ed76dc36e9e%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Hi Diego, Now I see the problem: it\u2019s due to missing data. Your alignment has 11 sequences, but two sequences ( TecpeSFB_Tecticornia_pergranulata, Amhypgen_Amaranthus_hyponchondriacus) have complete missing data within two input partitions, and thus removed as they don\u2019t contribute any phylogenetic signal. Thus, the final tree has only 9 taxa. If you, however, insist on keeping these sequences, then use option -keep_empty_seq. However, this is not recommended as such sequences can \u201cplug\u201d to any position in the tree and distort support values. Hope that helps, Minh On 1 Jun 2019, at 12:05 am, Diego F. Morales-Briones < dfmor...@gmail.com > wrote: Hi Minh, The input alignment has 11 taxa, so actually you ran into the same problem that me. Thanks for you're help, Diego On 31May, 2019, at 08:59, Minh Bui < minh...@univie.ac.at > wrote: Hi Diego, I just ran your data set, and the output .treefile has all 9 taxa\u2026 so nothing went wrong here, and I don\u2019t know what had happened in your case. Minh On 28 May 2019, at 11:31 am, Diego F. Morales-Briones < dfmor...@gmail.com > wrote: Hi Minh, Here are the the files and the log. It seems that it has to do with the partition because when running the same data without a partition the final tree has all taxa. The command I used was 'iqtree -m TESTMERGE -s cluster9987_1rr.NT.aln-gb -nt 2 -bb 1000 -wbt -st DNA -q cluster9987_1rr.NT.aln-gb.partition' Thanks, Diego <cluster9987_1rr.NT.aln-gb> <cluster9987_1rr.NT.aln-gb.partition> <cluster9987_1rr.NT.aln-gb.partition.log> "]}, "d4M1ouk3Cjo": {"topic": "Model selection in IQ-tree 1.6.1 crashes when merging partitions", "initializeDate": "Jan 29, 2018, 5:26:26 PM", "timeStamp": "Jan 30, 2018, 10:48:24 PM", "content": ["Hi, I'm attempting to do model selection and partition finding in IQ-tree 1.6.1, on a dataset consisting of 418 loci with a total of 256,988 bps on a cluster using the 64 bit linux executable downloaded from the website. When using the command: ./iqtree -s input.phy -spp part.txt -m MF+MERGE -safe -rcluster 10 -nt 12 it runs for a while but always crashes when starting the merging, with one of the following two error messages: ... 416 TIM3+F+R3 4387.463 L189_comb_no_empty_short 1h:11m:20s (36h:48m:53s left) 417 TN+F+I+G4 4410.836 L21_comb_no_empty_short 1h:11m:22s (36h:44m:35s left) 418 K2P+I+G4 3693.597 L222_comb_no_empty_short 1h:11m:23s (36h:39m:27s left) Full partition model BIC score: 4978284.867 (LnL: -2465941.600 df:3725) Merging models to increase model fit (about 13296 total partition schemes)... ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report plese send to developers: ERROR: ERROR: *** Log file: **part.txt.log* IQ-TREE CRA ERROR: SHES WITH* SIG** NA AligL ABORTEDnment files (if possibl ERROR: e)ERROR: e)*** Forbug ERROR: report or: ... 414 TNe+R4 5645.484 L179_comb_no_empty_short 3h:15m:21s (101h:18m:39s left) 415 TIM+F+R3 5617.071 L50_comb_no_empty_short 3h:15m:24s (101h:5m:11s left) 416 TIM3+F+R3 4392.687 L189_comb_no_empty_short 3h:15m:25s (100h:50m:52s left) 417 K3Pu+F+I+G4 7069.719 L5_comb_no_empty_short 3h:15m:33s (100h:39m:40s left) 418 TN+F+I+G4 4417.018 L21_comb_no_empty_short 3h:15m:34s (100h:25m:21s left) Full partition model BIC score: 4982142.199 (LnL: -2467832.895 df:3731) Merging models to increase model fit (about 13296 total partition schemes)... ERROR: ERROR: ERROR: ERROR: *** IQ-TREE CRASHE*** IQ-TREE CRASHESS WITH SIGNAL WITH SIGNAL SATACK BTAO ERROR: BROR*** IQ-TREE CRASHESR TTACE FOR DEBUGEGEDWITHDING: ERROR: ERROR: ERROR: ERROR: ERROR: *** For b*** For buug g report please sendr b*** For buug g report please send to ERROR: re*** IQ-TREEp dCoReArSHES tWITH pSlSeIvelopers:NALaseI GNAL ERROR: sAeBORTEDndnd to deveelopers: ERROR: ** ERROR: **** *A B*O RTED ERROR: L* LooFor bug report please send to developers: ERROR: *** Log file: part.txt.log ERROR: *** Alignment files (if possible) It only runs without crashing if I run -m MF without the merge option. I get the same error when using the TESTNEWONLY option, and with or without using -safe. I tried the same setup on a different cluster and received the same errors. Increasing memory also doesn't seem to work. Any help would be appreciated. The log files are attached. Best wishes, Marianne ", "Hi Mese, Thanks, can you send me the data set and all output files for debugging purpose to my personal email? I think this problem is similar to the one that Karen had. If so, I will mark this high priority. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <log_error1.log> <log_error2.log> "]}, "Chr1395MTl8": {"topic": "Numerical underflow error with GHOST model", "initializeDate": "Sep 27, 2017, 10:10:26 AM", "timeStamp": "Sep 29, 2017, 11:25:29 AM", "content": ["Dear Stephen, I've been getting 'ERROR: Numerical underflow (lh-derivative-mixlen)' every time I try to specify the GHOST model with more than 4 classes, even when I use the -safe argument. I have been trying the GHOST model on an amino acid dataset of 120 taxa and 54,400 sites. This is the command line I've been using: iqtree-1.6-beta3 -s 120x200.phy -nt 12 -pre iqtree3.3.4 -m LG+H5 -wspm -bb 1000 -alrt 1000. I've also tried LG+F0*H5 with no success. When I use the -safe mode, iqtree doesn't crash, keep running, but the log gets full of ERROR messages. I wonder whether I should ignore them and wait for the result. Thank you, Sergio ", "I got the same message and for small trees this does not seems to affect the result, but I have been obliged to stop the job for a much bigger tree as the test for optimal number of cores seems blocked. JPF ", "Hi Sergio, There are a couple of things to be wary of here. The error message you are receiving should not be ignored, especially if it is occurring many times. It usually occurs if many branch lengths are close to zero. The default setting for the minimum branch length in IQ-TREE is 10^-6, by increasing the minimum branch length might help. In order to set a larger minimum branch length you can use the option -blmin. So for example, add \u201c-blmin 10^-5\u201d to your command line. You can play around with the value and hopefully it helps. The second thing is the number of parameters you are estimating vs the amount of sites in your alignment. With 120 taxa and 5 classes you are trying to estimate (2*120 - 3)*5 = 1185 branch lengths. Adding the +FO option means estimating another 19 amino acid frequency parameters per class, so all up in the vicinity of 1300 parameters. It is not clear to us at this stage how the GHOST model performs when estimating so many parameters. We have not yet done simulation studies to test the limits of the GHOST model, but it is on our to do list. It would be great to get feedback (either positive or negative) from users about what they find when using GHOST on large datasets. Good have some luck getting some results, Stephen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thanks for the feedback JPF, I\u2019ve just replied to Sergio before I saw your message, I discussed the number of parameters as a possible problem. Would you mind telling me how big your dataset is that has given you trouble, and also the size of the datasets that have run well? Thanks, Stephen ", "Dear Stephen, I was running this bin/iqtree-1.6.beta4-MacOSX/bin/iqtree -s ACTINO_EXTENDED_WORKSHOP/METAPROT_H/TREES/concatenat.fst -m bin/RPRM-ACTINO.paml+FO*H4 -mredo -alrt 1000 -bb 1000 -nt auto -safe My tree is 813 leaves long for 6063 columns RPRM_ACTINO.paml is the specific exchange matrix for these data. I tried to set the -nt parameter to 4 but this does not help. The dataset is free of very similar sequences but I know that some internal nodes distances may be small. I have run a similar reconstruction with ~300 leaves, the error message was also massively present but the program has given a satisfying result. Of course (?) with other smaller datasets (subsets of the big tree) I dont get the error message or only a few time.. I will try your suggested solution. I am working on the OSX binaries Sincerely JPF ", "Dear JPF, As Stephen explained, the GHOST model is very parameter-rich. The number of free parameters is equal to k*(2n-3), where k is the number of classes and 2n-3 is the number of branches (n=number of taxa). For your analysis (k=4, n=813), you have more parameters than the sample size (typically #columns in the alignment), and thus you can\u2019t do statistical inference here. In the .iqtree report file there will be a WARNING about this issue, which in turn led to the numerical underflow problem. Thus you should try the GHOST model with smaller k. That also explains why the numerical problem did not occur for smaller data sets (smaller n). Hope that helps, Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thank you Minh I should have taken care of the number of parameter ! This is a very basic point that I have missed, I was too exited by the new possibility that GHOST give me. I tried to simplify the model, but the best will be to limit the number of leaves to well selected representatives. This will be done next week. Sincerely JPF "]}, "43gN8hDdOCw": {"topic": "Using IQ-Tree multicore on OpenSuse using qsub PBS jobs.", "initializeDate": "Jul 11, 2017, 6:36:15 PM", "timeStamp": "Jul 18, 2017, 11:39:17 AM", "content": ["Hi IQ-Tree, I've previously used PAML as a phylogenetic analysis tool. I've used it on my laptop as well as my university's supercomputer. I'm currently interested in applying the same multiprocessing techniques to the IQ-Tree pipeline. It is very well documented, when compared to PAML. Anyways, in order to start a multiprocessing job I'd have to first create a bash (PBS script) which would utilize iqtree -nt: #PBS -S /bin/bash #PBS -m bea #PBS -M em...@gmail.com #PBS -l select=8:ncpus=1:mem=4gb -l place=free #PBS -l cput=24:00:00 #PBS -l walltime=32:00:00 #PBS -N getgilists #PBS -o logs/iqtree.o${PBS_JOBID} #PBS -e logs/iqtree.e${PBS_JOBID} #PBS -j oe iqtree -s MSA.aa.aln -nt 8 The confusion comes to play in the PBS script. Whenever I submit a job, should I use the select=8 in the PBS scripting or should I use the -nt 8 in the iqtree command? I feel like it should be one or the other, but not both. I'm assuming the above would run the PBS.sh script on 8 nodes, and then iqtree would do whatever it's doing x8. Thanks for the awesome software! -Rob ", "Hi Rob, I am not familiar with the setup of your HPC, however, I think that you need to use both. I guess that `select=8` means that you reserve 8 cores for your computation. If the reserved cores are on the same node, you can use the multicore version of IQ-TREE (omp) with the `-nt 8` flag. The IQ-TREE process will then use 8 cores. You have to specify things twice because you have to tell the queue submission system that you want 8 cores and also IQ-TREE that it has 8 cores available. If you are unsure whether your cores will be on one node, then you should use the MPI version of IQ-TREE. Please also have a look at the documentation: http://www.iqtree.org/doc/Compilation-Guide#compiling-mpi-version Specifically: This can be used to start an MPI run with e.g. 4 processes and 2 cores each (i.e., a total of 8 cores will be used): mpirun -np 4 iqtree-omp-mpi -nt 2 -s alignment ... NOTE: Please be aware that OpenMP and OpenMPI are different! OpenMP is the standard to implement shared-memory multithreading program, that we use to provide the multicore IQ-TREE version iqtree-omp. Whereas OpenMPI is a message passing interface (MPI) library for distributed memory parallel system, that is used to compile iqtree-mpi. Thus, one cannot run iqtree-omp with mpirun! I hope that I could help. Kind regards, Dominik Dominik Schrempf PhD Student Vienna Graduate School of Population Genetics Vetmeduni Vienna Austria > -- > You received this message because you are subscribed to the Google > Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, > send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Hi Rob and Dominik, yes that\u2019s right, one should do both, i.e. reserve 8 cores for the submission system as well as specify 8 cores for IQ-TREE command line. Otherwise, IQ-TREE does not know that it was given 8 cores ;-) One more tip: I see that you reserve 4 GB of RAM. You can also add option \u201c-mem 4G\u201d into iqtree command line, then IQ-TREE will try not to exceed this upper limit. Cheers, Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thanks for the reply. This has given me some good insight. My system admin has been working on getting IQ-Tree onto the HPC cluster that I'm using so hopefully I'll be able to test it out this week! In the meantime I've developed a pipeline for IQ-Tree using BLAST, GUIDANCE2, PRANK, and PAL2NAL. So now I'll be able to run it whenever I get the chance. Thanks again!! -Rob ", "This is great too! I'll be doing much faster computations by the time I've got access to IQ-Tree on my HPC cluster. Thank you!! "]}, "QQNiSyoXm78": {"topic": "Robustness evaluation with no upper limit", "initializeDate": "Sep 7, 2018, 1:32:36 PM", "timeStamp": "Sep 12, 2018, 11:14:06 PM", "content": ["Hello everybody, I just read an interesting note explaining one of the limitations of the bootstrap values. According to this paper, the values of bootstraps do not always make it possible to well establish the robustness of the nodes since they have an upper limit (100). Here is the paper in question: https://onlinelibrary.wiley.com/doi/full/10.1111/cla.12356 The author proposes the use of \"Branch support\" such as Bremer support (BRS). Is there a way with IQ-TREE to have values on the robustness of the nodes and which has no upper limit? Thank you, Antony ", "Hi Antony, For your question, all branch support methods implemented in IQ-TREE generate values between 0% and 100%. I don\u2019t see any problem with this and personally can\u2019t see the benefit of giving a support value of +infinity. However, I don\u2019t have access to this journal, thus can\u2019t read and comment on this article\u2026 What\u2019s your opinion? Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hello and thank you for your answer. I am not an expert, but I believe that values ranging from 0% to 100% allow to say if nodes are strongly supported (UFBOOT> 95%) in absolute, but not at the relative level between the nodes of the same tree or between different analyzes. With genomic data, the number of characters becomes so large that it is relatively easy to obtain values at 100%. If two studies use different genes for the same organisms, they may eventually obtain 100% bootstrap values, even if topologies diverge between studies. By using values with no upper limit, it would probably be possible to find that the topology of one of the two studies is supported by a larger number of sites (at least for the diverging nodes). I do not know if my message is clear enough! ", "Another approach I propose: Annotation that lists alternative placements (2...n) and their support above a specified level. E.g. Branch may have 70% support relative to x node, but what about the unexplained 30%? It could have been placed 25% at y node, which is a significant alternative that may be indicative of unexplained sequence variation and in need of further investigation and consideration. Maybe this already exists and I am unaware. Nick ", "Hi All, I agree that bootstrap supports will tend to reach 100% for long phylogenomic alignments, no matter how much conflicting signals there are in the data. Thus, alternatively I would look at discordance between gene trees and species tree. One can apply some measure such as the number of times a branch is found among the gene trees. There is an undocumented feature for this in IQ-TREE via -sup2 option: iqtree -sup2 <target_tree_file> <trees_file> It will map the branch occurrence from <trees_file> onto a target tree. This option works even when trees do not have the same taxon set. You can also use the internode certainty (IC) measure from the Rokas lab. Cheers Minh "]}, "MFZ1WlI73vw": {"topic": "question about this command line \"iqtree -s example.phy -sp example.partitions -m GTR+I+G\"", "initializeDate": "Jun 16, 2017, 8:17:05 PM", "timeStamp": "Jun 19, 2017, 8:40:42 AM", "content": ["Hi IQ-tree users and developers, I am confused with the options in this command: iqtree -s example.phy -sp example.nexus -m GTR+I Will 'GTR+I+G' be applied to all gene partiotions? If that;s Thanks in advance for your answer! Kind Regards, Elzed ", "Hi Elzed, The answer is yes and no, depending on the input partition file: 1. If you specify \u201ccharpartition\u201d command in the nexus file like in the example: #nexus begin sets; charset part1 = 1-999\\3 2-999\\3; charset part2 = 3-999\\3; charset part3 = 1000-1998; charpartition mine = HKY:part1, GTR+G:part2, GTR+G: part3; end; Then -m GTR+I+G has no effect. That means, HKY model is assigned to part1, etc. 2. If you omit \u201ccharpartition \u2026\u201d line, then GTR+I+G model is applied to all partitions. Note that the model parameters are unlinked across partitions, despite having the same name. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Bui, Many thanks for your answer. It helps indeed. Elzed ", "Hi Bui, Thanks very much for your answer. I tried the fowllowing command: $ iqtree-omp -s concatenated.out -sp raxml_partitions.txt -m GTR+I+G -nt 10 -bb 2000 -redo raxml_partitions.txt is in the format below: AA, part1 = 1-141 AA, part2 = 142-801 AA, part3 = 802-972 AA, part4 = 973-1409 AA, part5 = 1410-1549 AA, part6 = 1550-1764 AA, part7 = 1765-2269 AA, part8 = 2270-2477 AA, part9 = 2478-2672 AA, part10 = 2673-2847 ... I got this error message \" Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.560 seconds Generating 2000 samples for ultrafast bootstrap (seed: 791271)... ERROR: Invalid model name AA \". I then tried: $ grep -v 'charpartition' nexus.partitions.txt > tmp.partitions $ iqtree-omp -s concatenated.out -spp tmp.partions -m GTR+I+G -nt 10 -bb 2000 -redo I got the same error message: Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.316 seconds Generating 2000 samples for ultrafast bootstrap (seed: 341634)... ERROR: Invalid model name GTR \" I tried 'iqtree-omp -s concatenated.out -nt 30 -sp nexus.partitions.txt -m GTR+I+G -bb 2000' before and it worked, so nexus file format should be correct. \"#nexus begin sets; charset part1 = 1-141; charset part2 = 142-801; charset part3 = 802-972; charset part4 = 973-1409; .... charpartition mine = LG+G4:part1, LG+R3:part2, .... end; It would be very nice if you can help me to figure out whats going wrong? Kind Regards, Elzed On Saturday, June 17, 2017 at 6:14:44 PM UTC+10, Bui Quang Minh wrote: Hi Elzed, The answer is yes and no, depending on the input partition file: 1. If you specify \u201ccharpartition\u201d command in the nexus file like in the example: #nexus begin sets; charset part1 = 1-999\\3 2-999\\3; charset part2 = 3-999\\3; charset part3 = 1000-1998; charpartition mine = HKY:part1, GTR+G:part2, GTR+G: part3; end; Then -m GTR+I+G has no effect. That means, HKY model is assigned to part1, etc. 2. If you omit \u201ccharpartition \u2026\u201d line, then GTR+I+G model is applied to all partitions. Note that the model parameters are unlinked across partitions, despite having the same name. Hope that helps, Minh On Jun 17, 2017, at 2:17 AM, elzedliu < elze...@gmail.com > wrote: Hi IQ-tree users and developers, I am confused with the options in this command: iqtree -s example.phy -sp example.nexus -m GTR+I Will 'GTR+I+G' be applied to all gene partitions? If that;s Thanks in advance for your answer! Kind Regards, Elzed You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Elzed, On Jun 19, 2017, at 1:38 AM, elzedliu < elze...@gmail.com > wrote: Hi Bui, Thanks very much for your answer. I tried the fowllowing command: $ iqtree-omp -s concatenated.out -sp raxml_partitions.txt -m GTR+I+G -nt 10 -bb 2000 -redo raxml_partitions.txt is in the format below: AA, part1 = 1-141 AA, part2 = 142-801 AA, part3 = 802-972 AA, part4 = 973-1409 AA, part5 = 1410-1549 AA, part6 = 1550-1764 AA, part7 = 1765-2269 AA, part8 = 2270-2477 AA, part9 = 2478-2672 AA, part10 = 2673-2847 ... I got this error message \" Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.560 seconds Generating 2000 samples for ultrafast bootstrap (seed: 791271)... ERROR: Invalid model name AA \u201c. AA is indeed not correct syntax (see RAxML manual). Please change it to LG (or any another protein model name). I then tried: $ grep -v 'charpartition' nexus.partitions.txt > tmp.partitions $ iqtree-omp -s concatenated.out -spp tmp.partions -m GTR+I+G -nt 10 -bb 2000 -redo I got the same error message: Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.316 seconds Generating 2000 samples for ultrafast bootstrap (seed: 341634)... ERROR: Invalid model name GTR \u201c because GTR is specifically a DNA model, not an AA model. Thus pls change the model to e.g. LG+I+G I tried 'iqtree-omp -s concatenated.out -nt 30 -sp nexus.partitions.txt -m GTR+I+G -bb 2000' before and it worked, so nexus file format should be correct. \"#nexus begin sets; charset part1 = 1-141; charset part2 = 142-801; charset part3 = 802-972; charset part4 = 973-1409; .... charpartition mine = LG+G4:part1, LG+R3:part2, .... end; yes that\u2019s the correct format. Cheers, Minh "]}, "aIDb6Ghbkak": {"topic": "ML tree root", "initializeDate": "Jun 1, 2020, 1:58:48 PM", "timeStamp": "Jun 2, 2020, 12:34:01 AM", "content": ["Hey, I'm using IQ-TREE2 to build phylogenetic tree of thousand of bacterial species using the iqtree -s <alignment> and additional default parameters. I wondering how the root was set- in the documentation it states that with the -o option I can set specify an outgroup taxon name to root the tree, but the default is the first taxon in the alignment. So it seems that the root is arbitrary. However while reading the iq-tree2 paper it seems that the main advantage of iq-tree2 is that it enables inference of rooted trees. If the case is that the tree is indeed unrooted and the root was set just for starting with some branch is there an option to do one of the following: 1. reroot an existing tree based on a specific taxon in the tree? 2. find the most likely root and reroot existing tree based on it? Thanks! Jes ", "Hi Jes, I'll start by clarifying the default options, then answer your questions. The default options with reversible models are: 1. No `-o` option: root tree with first taxon in alignment. This is completely arbitrary. All analyses with non-reversible models infer unrooted trees. 2. `-o` option: root on taxon provided as outgroup with `-o`. In this case, an unrooted tree is inferred (because that's all you can do with reversible models) and then rooted after the fact with whatever taxa are provided via `-o`. With non-reversible models, it's different. In a non-reversible model there is some notion of time, so the root of the tree is a parameter of the model itself, hence you have to infer the root of the tree as part of the analysis in the ML framework. In any of these cases, you can re-root the tree with an outgroup after the fact if you choose to do so. All the usual caveats about using outgroups apply here: you should be 100% sure that the outgroup falls *outside* the ingroup taxa, while at the same time trying to make sure it's as closely related as possible to the ingroup so as to avoid any issues with long branches, differences in molecular evolution (e.g. base composition) etc. To answer your questions: 1. You can re-root any tree however you like. In the case of using a reversible model, this is what people routinely do. In the case of a non-reversible model, it may well make sense most of the time, especially if you have strong a-priori information on the position of the root of a tree that you think overrides the information that might be provided by maximum likelihood inference of the root. 2. For this you need to use the non-reversible models in IQ-TREE. My suggestion would be that rather than re-root an existing tree, you perform the whole inference using a non-reversible model. I'd caution though that I think it would be sensible to first compare the reversible to the non-reversible models in a model-testing framework, e.g. using the AICc or similar, to make sure that there is sufficient information in your data to support the use of a non-reversible model. Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0d337c08-ee45-4bba-b3e4-297a725feddf%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Excellent answer! thanks Rob ;-) Just a quick typo: All analyses with non-reversible models infer unrooted trees. change \u201cnon-reversible\u201d to \u201creversible\u201d ;-) Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmogLOo39vstJYvFtpioDJycdXf7ypprE85k09B3Oar5Tw%40mail.gmail.com "]}, "WU5Bodj5wPE": {"topic": "DNA partitions and morphology with polymorphism (12)", "initializeDate": "Jul 1, 2019, 5:47:18 AM", "timeStamp": "Jul 1, 2019, 6:23:23 PM", "content": ["I would like to run an analysis that contains some DNA partitions and morphology with polymorphism (12), is it possible to provide a simple example with this type of coding? I stayed in doubt about the format. Do I have to load two files (DNA and Morphology) or can I just have one matrix (mixed like Mrbayes)? What about polymorphism coding, is it possible? I tried loading nexus, phy, but when the morphological partition arrives it does not recognize the characters. Sorry if it is basic, but I could not find an answer in the manual or in Cipres or in the examples of the web( iqtree.cibiv.univie.ac.at/ ). Best wishes Eric ", "Hi Eric, IQ-TREE does not support such polymorphism, everything like \"(12)\u201d will be treated as missing data. Otherwise, you can mix different dataypes, see: http://www.iqtree.org/doc/Complex-Models#partition-models . Note that you have to use the command line version here. The web server does not support mixed data types. Does that answer your question? Minh On 1 Jul 2019, at 7:47 pm, Eric Smidt < ecs...@gmail.com > wrote: I would like to run an analysis that contains some DNA partitions and morphology with polymorphism (12), is it possible to provide a simple example with this type of coding? I stayed in doubt about the format. Do I have to load two files (DNA and Morphology) or can I just have one matrix (mixed like Mrbayes)? What about polymorphism coding, is it possible? I tried loading nexus, phy, but when the morphological partition arrives it does not recognize the characters. Sorry if it is basic, but I could not find an answer in the manual or in Cipres or in the examples of the web( iqtree.cibiv.univie.ac.at/ ). Best wishes Eric You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b31b1462-6318-4575-a5aa-0f842509115a%40googlegroups.com For more options, visit https://groups.google.com/d/optout <Anathallis_MP_evitotal_iqtree.phy> ", "Hi Minh, yes, thanks a lot. I\u00b4m very happy with IQ-Tree All the best. Eric de Camargo Smidt Prof. Associado II Laborat\u00f3rio de Sistem\u00e1tica e Ecologia Molecular de Plantas Departamento de Bot\u00e2nica, sala 446 Setor de Ci\u00eancias Biol\u00f3gicas Centro Polit\u00e9cnico - UFPR Caixa Postal 19031 Cep 81531-990 Curitiba, PR - Brasil e-mail: ecs...@ufpr.br http://orcid.org/0000-0002-1177-1682 https://publons.com/researcher/2905687/eric-smidt/ http://lattes.cnpq.br/1539716845687200 https://sites.google.com/view/lsemp-ufpr "]}, "S15ruqLYKSo": {"topic": "PLL - Number of partitions exceeds PLL limit", "initializeDate": "Dec 1, 2014, 2:25:35 PM", "timeStamp": "Dec 5, 2014, 10:48:53 AM", "content": ["Hi, I am having troubles with PLL implementation with a partition analysis. I am getting the following error: ERROR: Number of partitions exceeds PLL limit, please increase PLL_NUM_BRANCHES constant in pll.h I have >350 partitions, do you know what I should set this constant to be for a re-compile? Thank you, Matt ", "Dear Matt, for a quick and dirty solution, if you e.g. have 351 partitions, please change this line pll/pll.h: #define PLL_NUM_BRANCHES 128 #define PLL_NUM_BRANCHES 351 It is just the hard limit of the PLL library. We have been aware of this problem and the PLL developers are working on this issue to remove this constant as a long-term solution. Then recompile the source codes as explained in the IQ-TREE manual (i.e. cmake and make). If you have difficulties compiling the codes let us know. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Thank you Minh. This worked for me. However I am having a RAM issue with this run. My cluster has 20CPUs and 68Gb of ram per node. IQtree keeps crashing out with the note \" NOTE: 11550.779 MB RAM is required! \". Does this mean that it needs 11550.779 MB RAM for each partition? thank you, Matt ", "Hi Matthew, Can you send us per email the complete log file or post in here the relevant part including error message in the log file. Thanks Cheers Tung "]}, "GkkcBqPUXIc": {"topic": "How to run iqtree using snp data?", "initializeDate": "Jun 28, 2015, 1:02:34 AM", "timeStamp": "Apr 9, 2019, 8:52:42 PM", "content": ["How do I run IQ-TREE using SNP data? I tried running it with my dataset that contained 723543 columns and 107852 patterns using -m TEST+ASC and it crashed: Create initial parsimony tree by phylogenetic likelihood library (PLL)... 5.973 seconds NOTE: MODEL SELECTION REQUIRES AT LEAST 4135.775 MB MEMORY! Testing 0 DNA models (sample size: 723543) ... No. Model -LnL df AIC AICc BIC Akaike Information Criterion: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT *** For bug report please send to developers: *** Log file: md5mc68p.10.phy.log *** Alignment files (if possible) Segmentation fault (core dumped) My data matrix is the output from PyRAD in phylip format. I also tried running it with a smaller dataset of only the snps and got the same error: Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.699 seconds NOTE: MODEL SELECTION REQUIRES AT LEAST 287.897 MB MEMORY! Testing 0 DNA models (sample size: 7544) ... No. Model -LnL df AIC AICc BIC Akaike Information Criterion: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT *** For bug report please send to developers: *** Log file: md5mc68p.10.unlinked_snps.log *** Alignment files (if possible) Segmentation fault (core dumped) Thanks in advance Chan ", "Dear Chan, it's not clear what's the problem. thus can you send me the whole log file? Minh Sent from my Samsung device You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Minh, Attached is the logfile. Thanks! You received this message because you are subscribed to a topic in the Google Groups \"IQTREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/GkkcBqPUXIc/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com ", "Apologies, I attached the wrong log file. Here is the correct one ", "Dear Chan, support for +ASC was accidentally removed. I have just released version 1.3.4 which fixes this problem Cheers, Minh <md5mc68_noinvariant.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Thanks for the update! Will try this out soon :) ", "Dear Chan, Thanks for your interest. You have several questions and I am trying to answer each now: firstly about model: it is recommended to always use simpler model if it fits data better than the more complex model. In such case, GTR+G overfits the data (we don\u2019t have enough information to infer the model parameters reliably) and might cause artifact. I understand that RAxML is geared towards large data sets where GTR+G is reasonable - but not for small data sets. about the tree topology: different model is one factor to influence the resulting tree. Moreover, the search heuristic has an impact. In our recent paper about IQ-Tree (Nguyen et al 2015) we observed better trees than RAxML (in terms of log likelihood using the same model GTR+G) for more than 90% of the cases. This is because IQ-Tree explores the tree space better and we gave some reason for this in the paper. about the support value: this was published in another paper (Minh et al 2013; ultrafast approximation for phylogenetic bootstrap - UFBoot). One of the main conclusion, is that IQ-Tree support values are more unbiased: 95% support correspond roughly to the probability of 95% that a clade is true. So this has a different meaning than the normal bootstrap supports (where you start to believe in the clade if it has >80% BS support). For our UFBoot, you should only start to believe in the clade if its support >= 95%. Thus, the interpretations are different and you should not compare BS% with UFBoot% directly. Moreover, to be more confident I would suggest you to also do SH-aLRT test (e.g. but adding \u2018-alrt 1000\u2019, similar to that of PhyML) into IQ-Tree command line - each branch will then be assigned with SH-aLRT and UFBoot supports. In my analysis I typically start to rely on the clade if its SH-aLRT >= 80% and UFboot >= 95%. Hope that helps and clarifies things now! Cheers, Minh > On 29 Jun 2015, at 19:07, kin onn chan < chank...@gmail.com > wrote: > Hi Minh, > Thanks! I'll try this out asap. I also have an unrelated question if you don't mind? I've been using IQ-TREE for the last couple of months on multiple datasets and have found it to sometimes produce different topologies but always much better bootstrap support values compared to raxml. I'm glad that it does but am also curious as to why? I've noticed that using the model testing function it always selects a less complicated model of evolution (eg TIM2+G4+I) as opposed to the GTRGAMMA model implemented in RAxML. Could that be the reason or is it just better at searching tree/parameter space? Thanks in advance. > Chan ", "I've been using IQ-TREE for the last couple of months on multiple datasets and have found it to sometimes produce different topologies but always much better bootstrap support values compared to raxml . I'm glad that it does but am also curious as to why? I just have one additional note. To avoid confusion, if you use UFBoot to access the branch support, don't call bootstrap support. Although UFBoot mimics bootstrap, it is in fact a diffrent method (see Minh's explanation). IQ-TREE also provides the standard bootstrap feature (like in RAxML) and you can use it if someone ask you for the bootstrap support. Bayesian programs like Mrbayes also have their own way of assessing the branch support. The intepretation of branch support values computed by bayesian programs is similar to those produced by UFBoot: you should only trust clades with suport value >= 95%. Cheers Tung ", "How do I run IQ-TREE 1.6.10 using SNP data? I tried running my data matrix is the output from PyRAD in phylip format. With GTR+ASC model. But I found this in the log: Reading alignment file AllSamplesMatrix.snps.phy ... Phylip format detected Alignment most likely contains protein sequences Alignment has 66 sequences with 491822 columns, 451793 distinct patterns 489822 parsimony-informative, 2000 singleton sites, 0 constant sites Create initial parsimony tree by phylogenetic likelihood library (PLL)... 35.399 seconds Generating 1000 samples for ultrafast bootstrap (seed: 979601)... ERROR: File not found GTR Why does IQ-TREE take my data as protein? ", "To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "How do I run IQ-TREE 1.6.10 using SNP data? I tried running my data matrix is the output from PyRAD in phylip format. With GTR+ASC model. ", "Hi there, IQ-TREE mis-detected your alignment because the fraction of A,C,G,T characters is too low, which is not surprising with SNP data. You can use option -st DNA to override this (incorrect) auto-detection. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree ", "Thank!! El mi\u00e9rcoles, 3 de abril de 2019, 20:26:32 (UTC-4), Minh Bui escribi\u00f3: Hi there, IQ-TREE mis-detected your alignment because the fraction of A,C,G,T characters is too low, which is not surprising with SNP data. You can use option -st DNA to override this (incorrect) auto-detection. Cheers, Minh On 4 Apr 2019, at 4:47 am, Yamila Paula Cardoso < yamilap...@gmail.com > wrote: How do I run IQ-TREE 1.6.10 using SNP data? I tried running my data matrix is the output from PyRAD in phylip format. With GTR+ASC model. But I found this in the log: Reading alignment file AllSamplesMatrix.snps.phy ... Phylip format detected Alignment most likely contains protein sequences Alignment has 66 sequences with 491822 columns, 451793 distinct patterns 489822 parsimony-informative, 2000 singleton sites, 0 constant sites Create initial parsimony tree by phylogenetic likelihood library (PLL)... 35.399 seconds Generating 1000 samples for ultrafast bootstrap (seed: 979601)... ERROR: File not found GTR Why does IQ-TREE take my data as protein? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hello, I resolved the auto-detection of my SNP data with the -st DNA. But when I run IQTREE, I can not use the +ASC to select model because the program said: Alignment has 119 sequences with 221463 columns, 212916 distinct patterns 87839 parsimony-informative, 56921 singleton sites, 76703 constant sites Gap/Ambiguity Composition p-value 1 MADR9 96.64% failed 0.00% 2 MADR_2 98.67% failed 0.00% 3 MADR_4 99.98% passed 39.48% 4 MADR_5 98.44% failed 0.11% 5 MADR_6 99.87% passed 11.29% 6 MDP1443 87.23% failed 0.00% 7 MDP_1434 97.35% failed 3.71% 8 MDP_1436 94.76% failed 0.00% 9 MDP_1439 38.26% passed 26.62% 10 MDP_1440 99.18% passed 13.21% 11 MIR_11 47.61% failed 0.00% 12 MIR_2 28.27% failed 0.00% 13 MIR_4 82.99% failed 0.00% 14 MIR_5 50.60% failed 0.00% 15 MIR_6 54.99% failed 0.00% ... why IQTREE detects contacts sites in a SNP data? Is because the high GAP/Ambiguity rates? Thanks, Yamila ", "Hi Yamila, This is explained in this FAQ: http://www.iqtree.org/doc/Frequently-Asked-Questions#why-does-iq-tree-complain-about-the-use-of-asc-model Minh "]}, "y_98UwiPYUg": {"topic": "Partitioned gene trees, extra run time", "initializeDate": "Aug 5, 2020, 7:24:19 PM", "timeStamp": "Aug 5, 2020, 7:37:51 PM", "content": ["Hi, I've been generating gene trees using the -S option. I've noticed that IQtree will generate the trees and then continue to run for much longer without seeming to generate any usable output files. Command call: ./../bin/iqtree-2.0.6-Linux/bin/iqtree2 -S sebasto_sebaste_acti_per_gene_aligned_filt --prefix sebasto_sebaste_acti_per_gene_aligned_filt_genetrees/loci -T 10 Here's a record of the output files with modification time -rw-rw-r-- 1 owens 1.1M Aug 4 22:11 loci.parstree -rw-rw-r-- 1 owens 91K Aug 4 23:51 loci.best_scheme.nex -rw-rw-r-- 1 owens 20K Aug 4 23:51 loci.best_scheme -rw-rw-r-- 1 owens 2.6M Aug 4 23:51 loci.model.gz -rw-rw-r-- 1 owens 2.5M Aug 4 23:57 loci.treefile -rw-rw-r-- 1 owens 13M Aug 5 02:18 loci.ckp.gz -rw-rw-r-- 1 owens 3.8M Aug 5 02:18 loci.log Based on this, it looks like the gene trees were generated at about midnight, and then for the next two hours it output to the ckp file and log file. What more is it adding to the checkpoint file that doesn't affect the gene trees? If I only cared about generating gene trees, could I just cancel the run after loci.treefile finished output? ", "Hi Greg, Be patient. The file sizes suggest that this is a very large data set. IQ-TREE is still running. The .treefile holds the current best trees, which are right now not the final trees. You could use a server and more threads to speed it up, if that\u2019s possible. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/28f55a9a-ef93-4524-b49b-a83c1b39e93ao%40googlegroups.com "]}, "_1NVuqvD6Uk": {"topic": "generate maximum likelihood distances (mldist file)", "initializeDate": "Aug 10, 2018, 5:47:37 PM", "timeStamp": "Aug 16, 2018, 2:31:49 PM", "content": ["Hi, I am been using the \".mldist\" files generated by IQTree, but is there a way to generate those without computing the tree? I tried using \"-n 0\" but it also doesn't report the ml distances... thanks, ", "Dear Thiberio, Please use option \u201c-te BIONJ\u201d. This will compute the ML distances and BIONJ tree, and quit the analysis. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thanks, it worked pretty well, but I noticed another \"problem\"... Older versions of IQTree (e.g. 1.5.4) added the identical sequences to the \".mldist\", while the newest one (e.g. 1.6.6) does not, describing distances only between unique sequences. Is there a parameter to ask for identical sequences to also be present in the \".mldist\" file? thanks, L. Thib\u00e9rio Rangel ", "Hi Thib\u00e9rio, > On 16 Aug 2018, at 19:44, L Thiberio Rangel < lthib...@gmail.com > wrote: > Thanks, it worked pretty well, but I noticed another \"problem\"... > Older versions of IQTree (e.g. 1.5.4) added the identical sequences to the \".mldist\", while the newest one (e.g. 1.6.6) does not, describing distances only between unique sequences. Is there a parameter to ask for identical sequences to also be present in the \".mldist\" file? Yes, there is. The manual states to use \u201c-keep-ident\u201d option ;) Best wishes, Heiko > On Mon, Aug 13, 2018 at 1:39 AM Minh Bui < minh...@univie.ac.at > wrote: > Dear Thiberio, > Please use option \u201c-te BIONJ\u201d. This will compute the ML distances and BIONJ tree, and quit the analysis. > Cheers > Minh >> On 11 Aug 2018, at 7:47 am, L Thiberio Rangel < lthib...@gmail.com > wrote: >> Hi, >> I am been using the \".mldist\" files generated by IQTree, but is there a way to generate those without computing the tree? >> I tried using \"-n 0\" but it also doesn't report the ml distances... >> thanks, >> -- >> You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. >> To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com >> To post to this group, send email to iqt...@googlegroups.com >> Visit this group at https://groups.google.com/group/iqtree >> For more options, visit https://groups.google.com/d/optout > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- "]}, "98Ku3HSysIg": {"topic": "Model selection for Lie Markov models", "initializeDate": "Mar 25, 2018, 6:04:32 PM", "timeStamp": "Sep 22, 2020, 9:48:39 PM", "content": ["Hi -- Is there a simple option (equivalent to -m TEST or -m MFP) to examine a complete set of the Lie Markov models from Woodhams et al. (2015) When I did the following: -m TEST -mset 1.1,2.2b,3.3a,3.3b,3.3c,3.4,4.4a,4.4b,4.5a,4.5b,5.6a,5.6b,5.7a,5.7b,5.7c,5.11a,5.11b,5.11c,5.16,6.6,6.7a,6.7b,6.8a,6.8b,6.17a,6.17b,8.8,8.10a,8.10b,8.16,8.17,8.18,9.20a,9.20b,10.12,10.34,12.12 it worked, although it only examined the RY versions of the models with RY, MK, and WS variants. Obviously, the line above works and I could add in the RY, MK, and WS variants for the models that have those variants. However, I just wanted to make sure I wasn't missing something obvious (and I apologize if I am) Thanks! ", "Hi Ed, Quick answer: \"-mset liemarkov\u201d will test all Lie-Markov models, including RY, ML and WS variants. However, I recommend: \u201c-m TEST+LM\u201d and ignore -mset command. This will test all usual reversible DNA models as well as Lie Markov models, thus exploring all DNA models available so far. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "As a follow up to this question -- it seems this may not work in 2.1.1. Is there a way to do a model+tree search with -m MFP+LM+MERGE, but restrict only to the suite of lie markov models? Combining with \"--mset liemarkov\" does not appear to generate the expected restriction. In another post, Minh indicated that one should not do a partitioned analysis combining reversible and non-reversible models, but it seems that restricting to lie markov models with --mset doesn't behave as expected. Best wishes, Jake ", "Hi Pauline, Sorry, I was a bit confused by the attachment you sent with this thread. For the Lie Markov models: I was not precise with my answer before: in fact the partition model does not support non-reversible models for each partition yet. So all partitions need to have reversible models. Minh On 9 Sep 2020, at 5:35 pm, Pauline Stud < studp...@gmail.com > wrote: Hi, I've been trying to analyse a alignment with heterogenous composition so wanted to force the use of non-homogeneous model to avoid artefact due to GC compostion bias. I've read that one sould avoid partitioned analysis combining reversible and non-reversible models, but is it safe if we only have non-reversible ones? I tried that way: iqtree -s alignment.phy -p partitions.nex -st DNA -B 1000 -mset liemarkov. Is it the right command? Do I have to pass a treefile or the name of the root? It resulted in several warning like these: WARNING: evec not invertible WARNING: Numerical underflow for non-rev lh-branch Noname And finally this error log: new_tree_lh: -3654.0248185988 tree_lh: -3195.2806600962 ERROR: phylotree.cpp:2806: virtual double PhyloTree::optimizeAllBranches(int, double, int): Assertion `fabs(new_tree_lh-tree_lh) < max_delta_lh' failed. To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/da22e636-aba8-4663-91a3-73a38dace31dn%40googlegroups.com ", "Thank you. What is the best options to use with nonreversible models: indicate the root? provide a rooted starting tree? As they are not reversible I reckon this model needed a specifed root but I didn't find anything particular in the tutorials/website, same with the parameters options (eg: can we specify equilibrium frequency?Gamma distribution?). I tried several option but I'm not sure what's fine. I also noticed ultrafast bootstrap isn't available when you provide a tree. ", "You don\u2019t need to provide a tree, IQ-TREE will find the root automatically. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/279faeec-4f8f-41cd-9cfc-bc2e7a6edf4fn%40googlegroups.com "]}, "rZzNTGGqwb0": {"topic": "restricting use of CPUs", "initializeDate": "May 20, 2016, 4:12:51 AM", "timeStamp": "May 20, 2016, 2:58:06 PM", "content": ["Dear Developers and all, I'm new to IQ-TREE and it's already starting to get my favorite tree inference software! Right now, I'm trying to get to run a moderate dataset (ca 350 specimen, 7 loci) on a linux mpi-cluster using iqtree-omp v.1.3.6. Therefore, I have to restrict the cores that iqtree uses. However, the -nt option seems not to do the job. After a while the average load of the used compute node (which was only used by myself) was 7-fold higher than the specified number with -nt. I'm not an expert in these things, but this seems to be odd. I also tried the -omp option but I think it is synonym to -nt, since it has the same effect. Or am I wrong? Using iqtree-omp v.1.4.2 on a 4-core Windows machine, '-nt 2' restricted the cpu-load to 50%; however, apparently all 4 CPUs were in use (at \u00b150% according to the System Monitor. I used the following command: iqtree-omp -sp partitions.txt -m TESTNEWMERGE -alrt 1000 -bb 1000 -nt 12 I'm a bit confused :) Any ideas to solve the problem are welcome! Best, Jonas ", "Dear Jonas, > On May 20, 2016, at 10:12 AM, eberle...@gmail.com wrote: > Dear Developers and all, > I'm new to IQ-TREE and it's already starting to get my favorite tree inference software! thanks, great that you like it! > Right now, I'm trying to get to run a moderate dataset (ca 350 specimen, 7 loci) on a linux mpi-cluster using iqtree-omp v.1.3.6. Therefore, I have to restrict the cores that iqtree uses. However, the -nt option seems not to do the job. After a while the average load of the used compute node (which was only used by myself) was 7-fold higher than the specified number with -nt. I'm not an expert in these things, but this seems to be odd. I also tried the -omp option but I think it is synonym to -nt, since it has the same effect. Or am I wrong? yes, -nt and -omp are synonym. I am quite sure that -nt option should restrict the number cores used within a single iqtree run. Did you start several runs? Is your CPU hyperthreading? If yes, do not specify -nt greater than the number of real cores, as hyperthreading is not beneficial in IQ-TREE. If nothing works out, I suggest that you consult a system admin. > Using iqtree-omp v.1.4.2 on a 4-core Windows machine, '-nt 2' restricted the cpu-load to 50%; however, apparently all 4 CPUs were in use (at \u00b150% according to the System Monitor. this is fine, right? ~50% matches \"-nt 2\u201d. 100% load in Windows corresponds to using all 4 cores, whereas 100% load in Linux corresponding to 1 core. > I used the following command: > iqtree-omp -sp partitions.txt -m TESTNEWMERGE -alrt 1000 -bb 1000 -nt 12 as said, this command tells IQ-TREE to use 12 cores. One thing just came up to my mind, please check that you have enough RAM for this analysis. If exceeded, the high load can be caused by regular swap between physical and virtual memory. Cheers, Minh > I'm a bit confused :) Any ideas to solve the problem are welcome! > Best, > Jonas > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, thank you for the fast answer! Yes, the behavior on the Windows machine is fine. From a gut feeling I expected that 2 cores should be used with 100% when specifying '-nt2'. So I thought that this might be related to the problem on the linux cluster. As I said, I'm not too familiar with these things... However, after some more reading I'm still concerned about the load average on the linux cluster. I started one job with '-nt 12' on a 24 core node. >100 of 106 GB physical RAM were available. The load average (load_avg) is the number of cores in use or requested for use (if I understood right). Normally it doesn't go far beyond the specified number of cores to use. After starting iqtree, the load_avg started to increase steadily until I aborted the job when it reached 70 (on 24 cores) after a few minutes: queuename qtype resv/used/tot. load_avg arch states --------------------------------------------------------------------------------- q...@compute-0-4.local BIP 0/12/24 71.60 linux-x64 a 26064 0.60500 inclwgl jeberle r 05/19/2016 14:03:16 12 --------------------------------------------------------------------------------- I'm not sure what the problem might be. Maybe it's not specifically iqtree-related. I'm also in contact with the sys-admin. Thank you very much for your time and efforts! Cheers, Jonas ", "Dear Jonas, one additional question about your cluster job. Does your cluster allow that you log into the node the IQ-TREE job is running on? Possibly named compute-0-4? If that is allowed, please try to start a \u201ctop\u201d there and look what load is actually caused by IQ-TREE. \u2026and possibly, what other processes cause load. The status output of you queuing system (it seems not to be Sun/Oracle GridEngine = SGE/OGE), does not necessarily tell you whether the reported load is caused by your program, or whether some other job(s) are running there (which depends on you local cluster configuration). Sometimes this is caused by a bunch of very small scripts which are too short to be visible in a default \u201ctop\u201d - then you may try also \u201ctop -d .5\u201d or \u201ctop -d .1\u201d (i.e. update time of 0.5s or 0.1s). To write the output to file (if required) you may run something like \u201ctop -b -n 5 -d .5 > top.txt\u201d, which means you run top in batch-mode (not on screen), output 5 updates, with an update time period of 0.5s, and write the output to top.txt (but you possibly know this). Best wishes, Heiko ", "Dear Heiko, thanks for joining the discussion! Unfortunately I'm not allowed to log into the node directly. I'll see if I can check this with the admin (probably next week). The queuing system should be OGS/Grid Engine 2011.11. I used 'qstat -f' to get the above output. Since one cluster node is currently completely unused, I experimented a bit. Of course I don't exaclty know, but the overload seems to be related to my iqtree-job: - immediatly before the job submission the node's load is 0.00. (Output from qstat -f) - after submitting the iqtree-job it steadily increases over the following minutes which might be due to the averaging over a couple of minutes I guess: 1 min: 0.41 2 min: 1.25 3 min: 1.59 4 min: 2.16 5 min: 2.38 6 min: 2.76 7 min: 2.91 8 min: 3.17 9 min: 3.27 10 min: 3.44 After 15 minutes, the load_short (I belive it's averaged over 1 min) is 3.99. (I just found it using 'qstat -F'.) Is it possible that I submitted iqtree 2 times? I did this the following way: I submitted the queue job like this: qsub -pe orte 2 -q no...@compute-0-5.local js_template_mpi.sh Within the jobscript, follwing line executes iqtree: /opt/openmpi/bin/mpirun /share/scientific_bin/iqtree/1.3.6/iqtree-omp -sp partitions.txt -m TESTNEWMERGE -alrt 1000 -bb 1000 -nt 2 Maybe something counter-intuitive happens when using the mpi run... In my first attempt I would have submitted 12 instances of iqtree with 12 threads each. Well, after 20 minutes of writing on this email, the short-average-load is still stable at 3.99. It seems that the '-nt X' is multiplied by the mpi-run instances. Thank you both a lot for your time and help! Keep on developing and have a nice weekend! Cheers, Jonas ", "Hi Jonas, yes you are right - it was not clear to us that you used mpirun within the submission. If I remember correctly (I haven\u2019t tried to run non-MPI-executables using mpirun for quite some years), mpirun starts the specified number of processes. If those are proper MPI-executables they will start talking with each other and act as a parallel program. If they are not each instance is not aware that it is part of a larger parallel job and acts as a \u2018normal\u2019 sequential (or at least non-MPI-parallel) program\u2026 and you had 12 of those. Due to the -nt in the iqtree-omp command line each of these non-MPI-programs will spawn 12 threads. This will produce 12 programs running 12 threads each. So theoretically this can easily lead to loads up to 144 and higher if the server starts swapping\u2026 having only 24 CPU-cores the program and do not manage to get to >100, but on a larger machine (and if the alignment is not too small) this might easily happen. What you should do, is submit a single non-MPI job with 12 threads\u2026 however, how this has to be done depends on your local SGE installation. Hence, you should contact you cluster administrator how this should be done. At least the reason for the high load is now clear ;) cheers, Heiko "]}, "axRODfQNS1E": {"topic": "IQ-TREE crash segmentation fault", "initializeDate": "Mar 19, 2016, 4:03:59 AM", "timeStamp": "Apr 18, 2016, 5:37:18 AM", "content": ["Hi, I've run the same model selection analysis on webserver (run1) and my PC (Windows 7, 6 MB RAM, 4 cores)(run2) On my PC (iqtree v 1.4.1) the analysis crashed (segmentation fault) Command lines were respectively >iq-tree -s infile -st CODON1 -m TESTONLYNEW >bin\\iqtree-omp.exe -s infile \u2013nt 4 -st CODON1 -m TESTONLYNEW Attached the log files. Best, Giorgio ", "Dear Giorgio, thanks for reporting the bug. Please send me the alignment via personal email. Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout > <run1_infile.fst.log><run2_infile.fst.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Giorgio, this bug is now fixed in version 1.4.2 Cheers, Minh "]}, "LnJYcBlpnNg": {"topic": "BUG: dataset reproducibly generating segmentation fault", "initializeDate": "Dec 4, 2018, 3:18:43 PM", "timeStamp": "Dec 17, 2018, 6:21:22 PM", "content": ["I've a dataset, comprising a collection of M. tuberculosis sequences, which reproducibly causes a segmentation fault when run on Windows using v. 1.5.0a and 1.6.8. Log is as below. The server does not run out of RAM. Data is available on request. best wishes David Q-TREE multicore version 1.6.8 for Windows 64-bit built Oct 28 2018 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: COLHPAMMMSQL02 (AVX, 31 GB RAM) Command: D:\\compass\\forest\\binaries\\iqtree\\bin\\iqtree.exe -nt 7 -st DNA -s D:\\forest_development\\forestroot\\render\\8a22c86a6469d460dc6e25ae1603b54a\\trees\\iqTree\\alignment_samples_with_outgroup.fa -m GTR+I -blmin 0.00000001 -fconst 662362,1253574,1249384,664323 -pre iqTree Seed: 908083 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Tue Dec 04 14:54:04 2018 Kernel: AVX - 7 threads (8 CPU cores detected) Reading alignment file D:\\forest_development\\forestroot\\render\\8a22c86a6469d460dc6e25ae1603b54a\\trees\\iqTree\\alignment_samples_with_outgroup.fa ... Fasta format detected Alignment most likely contains DNA/RNA sequences Alignment has 1154 sequences with 1772 columns, 318 distinct patterns 38 parsimony-informative, 1734 singleton sites, 0 constant sites Gap/Ambiguity Composition p-value 1 935f39b6-1806-43a3-acdd-df457cb6fefc 0.11% passed 100.00% 2 56a6d5bf-891f-44de-ba66-3c7bc7abff36 0.34% passed 99.79% 3 41ef71f3-8ebb-4a97-9b20-e3318b0aec38 0.34% passed 99.98% ... For your convenience alignment with unique sequences printed to iqTree.uniqueseq.phy ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: iqTree.log ERROR: *** Alignment files (if possible) ", "Hi David, Thanks for the report. A quick question for now: does it crash under Linux or MacOS? I suspect that: -fconst 662362,1253574,1249384,664323 caused numerical overflow or so. Anyway please send me the input file for debugging purpose via my personal email. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi David, Quick answer: please use option -t PARS to resolve this crash. Long answer: I could localise that the crash occurs in the PLL module ( http://www.libpll.org ) in the presence of -fconst option with such big numbers. Unfortunately, this PLL-1 is not maintained anymore and its developers now switch to PLL-2. So I won't be able to fix this problem and will remove PLL-1 from version 1.7 onwards. The option \u201c-t PARS\u201d will switch to IQ-TREE own parsimony kernel instead of PLL and solves the crash. Cheers, Minh "]}, "T9Brx_d6I-c": {"topic": "specify AA data partition file", "initializeDate": "Nov 16, 2020, 12:02:16 PM", "timeStamp": "Dec 2, 2020, 8:11:04 AM", "content": ["Hi! possibly a very dumb question, but I am new to protein data analyses (and iqtree) and I am not being able to find this. I have a mitogenome dataset (Aminoacids, i.e., already translated), for which I want iqtree to estimate the best model and do tree inference, somewhere around these lines: iqtree -s scuba_21octB_CDS_glaucum_AA.fasta -m MFP -B 1000 -bnni -p partition_file I see in the manual the partitions is something like this: DNA, part1 = 1-100 DNA, part2 = 101-384 but I don't find what I should use instead of \"DNA\" when the data is AA ...? can anyone help? thanks a lot in advance! ", "Hi Sara, Information on RAxML-style partition files can be found here: https://cme.h-its.org/exelixis/web/software/raxml/hands_on.html I\u2019d recommend using Nexus partition files instead. Those details are given here: http://www.iqtree.org/doc/Advanced-Tutorial An example where you don\u2019t specify the model would be something like: begin SETS; CHARSET gene1 = 1-100; CHARSET gene2 = 101-200; CHARSET gene3 = 201-300; CHARPARTITION loci = 1:gene1, 2:gene2, 3:gene3; end; Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/12722209-49f2-4702-8c1d-38a2a93f99d2n%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "thanks, my question was even simpler (dumber), sorry for misexplaining. I did manage to run it with part file looking like: PROT, COX1 = 1-520 PROT, CYTB = 521-896 ... what I did not know was if I needed to replace \"DNA\" for \"PROT\" (it worked), or if it just recognizes automatically its a protein alignment and looks for protein models. either way, it worked. thanks for the reply! To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmodm%3DmhqTmiMBGPux5CjypdZhKd9cex3BpRs1XWUW-LAQ%40mail.gmail.com Sara Rocha \u00b7 PostDoc Researcher CINBIO Phylogenomics Group Universidade de Vigo - Campus Universitario Lagoas Marcosende 36310 Vigo Tlf. +34 986 130 050 LAB WEB www.cinbio.es IUCN SSC Skink Specialist Group (Twitter: @skinks_IUCN) https://www.skinks.org/ Protecci\u00f3n de datos ", "Yes, this works. The nexus format also works, where you can simply ignore charpartition command. Without this command, IQ-TREE will automatically find the best models. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAG%3Ds9gxMhxPtDqK46-QrR0RGbH9g6b-rjTg0N1W%2BzBGTQJTnLQ%40mail.gmail.com "]}, "aP8Ge004rfA": {"topic": "Site log-likelihoods (-wsl) differences", "initializeDate": "Jun 13, 2018, 3:03:16 PM", "timeStamp": "Jun 15, 2018, 9:22:38 AM", "content": ["Dear Bui Quang Minh, I have searched the forum, but have not found an exact answer to the following question. I have noticed that for the same alignment and same IQ-TREE version (1.6.2) the site log-likelihoods (-wsl) appear with slight differences mostly at the right-most 2-3 decimal places. I have performed two runs and send the results in attachment. What could be the reasons for these differences? Is this considered a normal or accepted behavior? Is this also the same for the AU-test? Thanks for your attention, Emanuel. ", "Hi Emanuel, Different runs can produce different results, sometimes even different trees (depending on the data set), due to stochastic nature of the IQ-TREE algorithm. As a result, .sitelh file and other output files might be different as well. The only way to make them identical is to use the same random seed number. It is printed in this line of the log file: Seed: 668969 (Using SPRNG - Scalable Parallel Random Number Generator) You can experiment that by setting -seed option for the 2nd run and tell me if that\u2019s true or not ;-) Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <test.zip> ", "Dear Minh, Thanks for your reply. Yes it is confirmed, both sitelh files are the same. I was not aware of this option. Hence I need to ask, is there any benefit in not making this work by default? Thanks, Emanuel. ", "Hi Emanuel, This is in fact a good feature! Several studies suggested that one should run the same software several times. If the resulting trees are different, then one needs to be careful and sometimes go back to revise the data. So it\u2019s actually not good to have a deterministic tree search algorithm. Note that one thing is deterministic: if you input the same tree and just optimise model parameters on this tree (eg via -te option), then different runs will give you the same log-likelihood regardless of the seed number. Cheers Minh ", "One additional remark for completeness, even in the case that one uses the same seed there can be circumstances that a program can produce different results. In the case that one uses a parallel version, it can happen if the CPU cores or network is loaded differently at the two runs it may happen that some intermediate results are finished earlier by one CPU core that another and vice versa. Hopefully, this is rare (and is, I think, more likely if the network is involved, e.g. in the MPI version), but still it may happen. These fluctuations act somehow stochastic as well. Two runs of the same sequential version using the same random number seed, however, should always produce identical results. Best wishes, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) Campus Vienna Biocenter 5 (VBC5) A-1030 Vienna, Austria ----------------------------------------------------------------------------- Email: heiko.schmidt(AT) univie.ac.at Tel. : ++43 +1 / 4277 - 74321 http://www.cibiv.at/ ----------------------------------------------------------------------------- "]}, "2XfCNIYfRXo": {"topic": "IQtree numerical underflow error", "initializeDate": "Jul 31, 2020, 4:48:17 PM", "timeStamp": "Aug 2, 2020, 11:05:49 PM", "content": ["Hello, I'm running IQtree on a large set of genes, and its crashing during model parameter selection. I'm using the -S option to calculate gene trees for each sequence. Command: bin/iqtree-2.1.0-Linux/bin/iqtree2 -S ./ -T 32 --prefix fasta_directory/ -safe The error is: WARNING: Numerical underflow for lh-derivative ERROR: phylokernelnew.h:3268: double PhyloTree::computeLikelihoodFromBufferSIMD() [VectorClass = Vec4d, nstates = 4, FMA = true, SITE_MODEL = false]: Assertion `std::isfinite(tree_lh) && \"Numerical underflow for lh-from-buffer\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: file.log ERROR: *** Alignment files (if possible) Aborted There are genes in the set with no parsimony informative sites, I'm not sure if thats the issue but it does highlight that during the log. Thanks for your help, Greg ", "Hi Greg, Can you remove all genes with no parsimony informative sites and repeat the analysis? -safe option tries hard to overcome numerical issue. If that still occurs, then it may imply some odd characteristic of the data that causes numerical problem. If the problem persists, send me the log file for further inspection. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/62c2e711-3dc7-43f6-88bf-51eedded5394o%40googlegroups.com "]}, "qCJYQzpkpdI": {"topic": "IQ-TREE release 1.6.12", "initializeDate": "Aug 15, 2019, 2:43:32 AM", "timeStamp": "Aug 15, 2019, 2:43:32 AM", "content": ["Dear Users, We\u2019re pleased to release the maintenance version 1.6.12 with the following bugfixes: \u2022 Incorrect pairwise distance (.mldist file) with +I or +R rate models (reported by Sishuo Wang). \u2022 Crash with -o option when the outgroup is identical to another sequence (reported by Yang Song). \u2022 Crash in ModelFinder for mixed data types with edge-linked partition models -spp option (reported by Bernardo Santos). \u2022 Report error with -sup when target tree is not as \"rooted/unrooted\" as tree set (reported by Christian Rinke). \u2022 Crash with multi-threading (-nt option) in Windows due to Clang compiler flag (reported by Wo Niu and others). Regards, IQ-TREE development team "]}, "EpvxOO-z2VU": {"topic": "Two samples getting omitted from my phylogenetic tree \" Assertion `dad' failed\"", "initializeDate": "Feb 27, 2020, 3:35:53 PM", "timeStamp": "Mar 5, 2020, 7:52:34 PM", "content": ["For the command: $ iqtree -nt AUTO -s snpma.fasta -b 10 -redo I get the following logs: Estimate model parameters (epsilon = 0.100) 1. Initial log-likelihood: -10120.676 2. Current log-likelihood: -2888.165 3. Current log-likelihood: -2860.828 Optimal log-likelihood: -2860.798 Rate parameters: A-C: 1.00000 A-G: 3.90189 A-T: 1.00000 C-G: 1.00000 C-T: 3.90189 G-T: 1.00000 Base frequencies: A: 0.250 C: 0.250 G: 0.250 T: 0.250 Parameters optimization took 3 rounds (0.006 sec) Computing ML distances based on estimated model parameters... 0.003 sec Computing BIONJ tree... 0.001 seconds ERROR: phylokernelnew.h:1259: void PhyloTree::computePartialLikelihoodSIMD(TraversalInfo &, size_t, size_t, int) [VectorClass = Vec4d, SAFE_NUMERIC = false, nstates = 4, FMA = true, SITE_MODEL = false]: Assertion `dad' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: snpma.fasta.log ERROR: *** Alignment files (if possible) Aborted (core dumped) Any advice? ", "Hi there, That\u2019s strange. Can you send me the full log file? Thanks, Minh NOTICE: This message and the accompanying documents are intended only for the use of the individual or entity to which they are addressed and may contain information that is privileged, or exempt from disclosure under applicable law. If the reader of this email is not the intended recipient, you are hereby notified that you are strictly prohibited from reading, disseminating, distributing, or copying this communication. If you have received this email in error, please notify the sender immediately and destroy the original transmission. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7486c330-8557-4e80-8098-47ae18825839%40googlegroups.com "]}, "x33RS6UASn8": {"topic": "IQtree-Problem of constrained search", "initializeDate": "Nov 28, 2018, 3:06:37 AM", "timeStamp": "Nov 28, 2018, 4:42:35 AM", "content": ["Hello,everyone: I used Combinedgenes.phy & Partitions.nex to run unconstrained ML tree (Command: iqtree -s Combinedgenes.phy -spp Partitions.nex -pre Unconstrained00); Then I set two constrained conditions to run constrained ML tree, respectively (Command: iqtree -s Combinedgenes.phy -spp Partitions.nex -g Constrained01.txt -pre Constrained01) (Command: iqtree -s Combinedgenes.phy -spp Partitions.nex -g Constrained02.txt -pre Constrained02) Then according to the manuals, Concatenate all trees into a file (Command: type Unconstrained00.treefile Constrained01.treefile Constrained02.treefile > Test.treels) Test the set of trees (Command: iqtree -s Combinedgenes.phy -spp Partitions.nex -z Test.treels -n 0 -zb 1000 -au) here, problems came out surprisedly, After writting the 3 trees in Test.treels, it showed \"ERROR: Tree file does not start with an opening-bracket '(' (line 1 column 1)\" subsequently. I wondered it had already wrote all 3 trees in Test.treels, why it still showed there would be more trees in Newick format? Best wishes. 2018.11.28 ", "Dear \u201cwhatever-your-name-is\u201d, Thank you for your interest in IQ-Tree. Would it be possible to provide us with your treefile (which you seemed to have named Test.treels, which would be the preferred extension for a tree-likelihood file, AFAIR) - maybe just to my private email instead of the list. IF you did other analysis with \u201c-pre Test\u201d this file might have been overwritten, but this is just guessing from what you have written. Best regards, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- "]}, "DhQ3cJz24iI": {"topic": "EM algorithm in GHOST model", "initializeDate": "Mar 24, 2020, 12:56:46 PM", "timeStamp": "Mar 24, 2020, 7:12:21 PM", "content": ["Hi there, I'm trying to run the GHOST model on a fixed tree topology as follows: iqtree -s INT_CAT_221S109F_30_excep5.s.phy -m LG+C60+F+H4 -te Obazoa_rootINT.fasta.tre -nt 4 -safe -pre Obazoa_GHOST But this gives me the following error: ERROR: Please use option -optlen BFGS to disable EM algorithm Adding this option seems to allow it to run, but I am wondering why it is necessary? Thank you! Kelsey ", "Hi Kelsey, This is only for technical reason, if you want to know: the EM (expectation maximization) algorithm is used to estimate branch lengths for +H mixture model. Currently it does not work in the combination of two mixture models +C60 and +H model. The BFGS algorithm is an alternative, and it works for this combination. IQ-TREE could have switched internally, but we intentionally print this message to remind us that we can implement the EM algorithm for this case. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c9ee09f0-3ece-441b-b7dc-77192fb19298%40googlegroups.com ", "Hi Minh, Thank you for your help! I appreciate the clarification. Kelsey On Tuesday, March 24, 2020 at 6:35:08 PM UTC-3, Minh Bui wrote: Hi Kelsey, This is only for technical reason, if you want to know: the EM (expectation maximization) algorithm is used to estimate branch lengths for +H mixture model. Currently it does not work in the combination of two mixture models +C60 and +H model. The BFGS algorithm is an alternative, and it works for this combination. IQ-TREE could have switched internally, but we intentionally print this message to remind us that we can implement the EM algorithm for this case. Cheers, Minh On 25 Mar 2020, at 3:56 am, Kelsey Williamson < kelsey.wi...@gmail.com > wrote: Hi there, I'm trying to run the GHOST model on a fixed tree topology as follows: iqtree -s INT_CAT_221S109F_30_excep5.s.phy -m LG+C60+F+H4 -te Obazoa_rootINT.fasta.tre -nt 4 -safe -pre Obazoa_GHOST But this gives me the following error: ERROR: Please use option -optlen BFGS to disable EM algorithm Adding this option seems to allow it to run, but I am wondering why it is necessary? Thank you! Kelsey You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "1pHH144CKqk": {"topic": "warning: codon not present in alignment", "initializeDate": "Jul 5, 2016, 6:06:17 PM", "timeStamp": "Jul 6, 2016, 3:57:32 AM", "content": ["Hi, In an alignment with some very AT rich genes and while testing for the best codon model (-st CODON6 -m TESTNEW) I get warnings about the absence of some codons, e.g.: WARNING: CGG is not present in alignment that may cause numerical problems If this indeed does cause a numerical problem would I get an error or a warning? I would like to understand if the fact that I have some genes with extreme GC% will cause problems for the tree inference and if so how to deal with it. thank you very much, Diamantis ", "Dear Diamantis, > On Jul 6, 2016, at 12:06 AM, Diamantis Sellis < sel...@gmail.com > wrote: > Hi, > In an alignment with some very AT rich genes and while testing for the best codon model (-st CODON6 -m TESTNEW) I get warnings about the absence of some codons, e.g.: > WARNING: CGG is not present in alignment that may cause numerical problems > If this indeed does cause a numerical problem would I get an error or a warning? this warning serves as information. Please then look at the log file to see if there are any warnings like \u201cWARNING: Numerical underflow\u2026.\u201d. If many such warnings appear then IQ-TREE may terminate abnormally (with a CRASH message). If not, then you can rely on the results. So the short answer is: it may or may not lead to numerical problems, where one needs to judge the log file carefully. > I would like to understand if the fact that I have some genes with extreme GC% will cause problems for the tree inference and if so how to deal with it. This I cannot give an absolute answer - it depends on the data and the extent of model misspecification, which may deeply be involved with the modeling aspect of sequence evolution. My recommendation is to use a partition model, where every gene/partition has its own model to capture such compositional heterogeneity. In this case you can try PartitionFinder-like algorithm implemented in IQ-TREE (-m TESTMERGE) option, which works with codon data. Hope that helps a bit Minh > thank you very much, > Diamantis > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "gZsvFhMFxCM": {"topic": "BUG: IQ-TREE on XSEDE aborts", "initializeDate": "Apr 5, 2018, 9:06:35 PM", "timeStamp": "Apr 6, 2018, 1:57:24 AM", "content": ["IQ-TREE 1.6.1 on XSEDE on Cipres gateway aborts when analysing a morphological matrix (character states 0-6). Contents of output.log file pasted in below. Thanks! Sarah IQ-TREE multicore version 1.6.1 for Linux 64-bit built Jan 12 2018 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: comet-03-34.sdsc.edu (AVX2, FMA3, 125 GB RAM) Command: iqtree -s infile.txt -bb 1000 -st MORPH -pre output -nt AUTO Seed: 980641 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Thu Apr 5 17:47:40 2018 Kernel: AVX+FMA - auto-detect threads (24 CPU cores detected) Reading alignment file infile.txt ... Phylip format detected Alignment most likely contains binary sequences WARNING: Your specified sequence type is different from the detected one Alignment has 288 sequences with 382 columns, 380 distinct patterns 362 parsimony-informative, 13 singleton sites, 6 constant sites Gap/Ambiguity Composition p-value 1 Aglaophyton_major 80.89% passed 9.32% 2 Sawdonia_ornata 86.65% passed 30.87% 3 Huperzia_lucidula 71.47% passed 97.84% 4 Selaginella_moellendorffii 64.92% passed 96.94% 5 Isoetes_tegetiformans 66.75% passed 48.90% 6 Psilophyton_crenulatum 81.41% passed 7.05% 7 Psilotum_nudum 80.37% passed 80.51% 8 Tmesipteris_parva 80.37% passed 82.80% 9 Equisetum_hyemale 70.42% passed 61.32% 10 Equisetum_arvense 70.42% passed 55.17% 11 Botrychium_virginianum 69.90% passed 36.01% 12 Ophioglossum_hesperium 70.42% passed 57.73% 13 Angiopteris_evecta 63.61% passed 94.75% 14 Psaronius 70.42% passed 97.77% 15 Osmunda_cinnamomea 69.63% passed 52.80% 16 Polypodium_virginianum 69.90% passed 89.50% 17 Aneurophyton 70.42% failed 1.90% 18 Archaeopteris 59.69% failed 0.00% 19 Cecropsis_luculentum 64.66% failed 1.82% 20 Elkinsia_polymorpha 53.40% failed 1.25% 21 Heterangium 50.79% failed 1.97% 22 Lyginopteris_oldhamia 48.43% failed 0.22% 23 Medullosa_endocentrica 47.64% passed 10.95% 24 Medullosa_noei 48.69% passed 11.94% 25 Callistophyton_boyssetii 43.46% passed 86.52% 26 Phasmatocycas_bridwellii 87.43% passed 98.55% 27 Peltaspermum 80.63% passed 79.63% 28 Autunia 78.80% passed 95.94% 29 Dicroidium 63.87% passed 95.30% 30 Glossopteris 61.78% passed 71.69% 31 Pentoxylon_sahnii 61.52% passed 32.32% 32 Petriellaea_plant 62.04% failed 1.92% 33 Caytonia 82.46% passed 98.90% 34 Cycadeoidea 46.07% passed 84.93% 35 Williamsonia 47.64% passed 74.44% 36 Williamsoniella 70.16% passed 94.47% 37 Cordaixylon_dumusum 32.98% passed 73.87% 38 Mesoxylon_priapi 34.29% passed 69.98% 39 Shanxioxylon_sinense 38.74% passed 68.04% 40 Dicranophyllum_hallei 76.18% passed 99.32% 41 Emporia_lockardii 35.34% passed 99.70% 42 Barthelia_furcata 41.88% passed 87.90% 43 Thucydia_mahoningensis 45.03% passed 95.20% 44 Utrechtia_floriniformis 70.42% passed 99.58% 45 Otovicia_hypnoides 59.95% passed 86.98% 46 Ernestiodendron_filiciforme 70.42% passed 99.24% 47 Hanskerpia_hamiltonensis 41.36% passed 95.28% 48 Concholepis_harrisii 75.92% passed 79.89% 49 Kungurodendron_sharovii 64.92% passed 99.89% 50 Timanostrobus_muravievii 70.94% passed 97.34% 51 Ferugliocladus_riojanum 70.42% passed 58.94% 52 Genoites_patagonica 78.01% passed 77.77% 53 Dolomitia_cittertiae 78.01% passed 52.11% 54 Majonica_alpina 69.90% passed 99.58% 55 Ortiseia_leonardii 65.71% passed 57.99% 56 Lebowskia_grandifolia 74.08% passed 77.79% 57 Voltzia_hexagona 69.11% passed 94.04% 58 Aethophyllum_stipulare 53.93% passed 81.22% 59 Telemachus 43.46% passed 91.36% 60 Pseudofrenelopsis_parceramosa 67.02% passed 31.63% 61 Frenelopsis 67.54% passed 55.14% 62 Agathis_australis 27.75% passed 80.81% 63 Agathis_dammara 30.89% passed 72.11% 64 Agathis_robusta 31.41% passed 70.13% 65 Araucaria_mirabilis 47.12% passed 88.09% 66 Araucaria_araucana 28.01% passed 93.41% 67 Araucaria_bidwilli 29.06% passed 94.22% 68 Araucaria_cunninghamii 29.84% passed 92.54% 69 Araucaria_heterophylla 30.37% passed 91.56% 70 Wollemia_nobilis 33.51% passed 65.61% 71 Actinostrobus_acuminatus 31.41% passed 98.45% 72 Actinostrobus_pyramidalis 32.46% passed 98.72% 73 Athrotaxis_cupressoides 32.46% passed 99.96% 74 Athrotaxis_rhomboidea 59.42% passed 54.21% 75 Athrotaxis_selaginoides 45.03% passed 99.91% 76 Austrocedrus_chilensis 30.63% passed 99.98% 77 Callitris_macleayana 45.55% passed 94.27% 78 Callitris_rhomboidea 30.89% passed 98.82% 79 Callitropsis_nootkatensis 30.10% passed 99.53% 80 Callitropsis_vietnamiensis 43.98% passed 96.10% 81 Calocedrus_decurrens 32.98% passed 99.13% 82 Calocedrus_macrolepis 46.60% passed 92.12% 83 Chamaecyparis_lawsoniana 29.32% passed 99.79% 84 Chamaecyparis_obtusa 29.84% passed 99.66% 85 Cryptomeria_japonica 16.75% passed 99.92% 86 Cunninghamia_taylorii 58.64% passed 96.38% 87 Cunninghamia_lanceolata 29.84% passed 99.99% 88 Cupressus_arizonica 29.84% passed 99.97% 89 Cupressus_funebris 40.58% passed 99.54% 90 Cupressus_macrocarpa 28.53% passed 99.98% 91 Cupressus_sempervirens 28.27% passed 99.97% 92 Diselma_archeri 31.68% passed 99.97% 93 Drumhellera_kurmanniae 51.57% passed 80.95% 94 Elatides_harrisii 58.12% passed 88.42% 95 Elatides_williamsonii 60.21% passed 94.39% 96 Eletites_zhoui 65.45% passed 61.48% 97 Fitzroya_cupressoides 29.58% passed 99.97% 98 Fokienia_hodginsii 30.37% passed 99.80% 99 Glyptostrobus_pensilis 33.25% passed 99.90% 100 Juniperus_ashei 45.03% passed 95.72% 101 Juniperus_communis 30.63% passed 99.95% 102 Juniperus_drupacea 44.24% passed 99.79% 103 Juniperus_oxycedrus 43.98% passed 96.32% 104 Juniperus_phoenicea 44.50% passed 98.15% 105 Juniperus_procera 34.55% passed 99.80% 106 Juniperus_tibetica 50.52% passed 98.31% 107 Juniperus_virginiana 30.37% passed 99.34% 108 Libocedrus_austrocaledonica 45.03% passed 99.96% 109 Libocedrus_bidwillii 32.20% passed 99.97% 110 Metasequoia_occidentalis 58.90% passed 27.80% 111 Metasequoia_foxii 56.81% passed 27.37% 112 Metasequoia_millerii 36.65% passed 87.78% 113 Metasequoia_glyptostroboides 19.37% passed 99.88% 114 Microbiota_decussata 31.68% passed 99.94% 115 Neocallitropsis_pancheri 31.68% passed 98.82% 116 Papuacedrus_papuana 36.39% passed 99.95% 117 Pilgerodendron_uviferum 31.94% passed 99.90% 118 Platycladus_orientalis 31.15% passed 98.98% 119 Sequoia_sempervirens 31.41% passed 98.49% 120 Sequoidendron_giganteum 22.51% passed 93.77% 121 Sewardiodendron_laxum 64.92% passed 82.18% 122 Taiwania_cryptomerioides 26.44% passed 99.97% 123 Taxodium_distichum 32.46% passed 95.13% 124 Taxodium_mucronatum 33.77% passed 97.39% 125 Tetraclinis_articulata 31.41% passed 99.97% 126 Thuja_occidentalis 31.68% passed 99.88% 127 Thuja_plicata 31.15% passed 99.49% 128 Thuja_standishii 42.67% passed 99.38% 129 Thujopsis_dolabrata 34.82% passed 99.82% 130 Widdringtonia_cedarbergensis 50.79% passed 99.45% 131 Widdringtonia_nodiflora 33.25% passed 99.55% 132 Abies_mariesii 22.51% passed 11.20% 133 Abies_concolor 18.59% failed 4.45% 134 Abies_lasiocarpa 18.85% failed 3.93% 135 Cathaya_argyrophylla 35.86% passed 46.23% 136 Cedrus_deodara 25.13% failed 0.00% 137 Keteleeria_evelyniana 26.44% passed 25.54% 138 Larix_gmelinii 41.62% passed 70.36% 139 Larix_occidentalis 27.23% passed 82.38% 140 Nothotsuga_longibracteata 29.58% passed 38.48% 141 Picea_abies 18.85% failed 0.00% 142 Picea_sitchensis 19.11% failed 0.00% 143 Picea_glauca 19.11% failed 0.00% 144 Pinus_arnoldii 28.27% passed 59.41% 145 Pinus_contorta 25.39% passed 14.21% 146 Pinus_gerardiana 39.53% passed 11.90% 147 Pinus_krempfii 33.25% passed 15.56% 148 Pinus_lambertiana 31.15% passed 38.15% 149 Pinus_longaeva 27.75% passed 45.36% 150 Pinus_monophylla 30.37% passed 29.88% 151 Pinus_nelsonii 28.27% passed 19.81% 152 Pinus_pinaster 36.39% passed 20.20% 153 Pinus_ponderosa 30.10% passed 35.37% 154 Pinus_taeda 30.37% passed 32.88% 155 Pinus_thunbergii 27.75% passed 20.99% 156 Pseudolarix_amabilis 24.08% passed 28.21% 157 Pseudotsuga_menziesii 23.30% passed 18.62% 158 Tsuga_canadensis 17.80% passed 40.35% 159 Phyllocladus_asplenifolius 21.47% passed 97.96% 160 Phyllocladus_hypophyllus 27.23% passed 98.56% 161 Acmopyle_pancheri 26.44% passed 99.61% 162 Afrocarpus_falcatus 21.99% passed 99.96% 163 Dacrycarpus_imbricatus 19.90% passed 99.92% 164 Dacrydium_araucarioides 26.96% passed 99.25% 165 Dacrydium_balansae 26.96% passed 99.25% 166 Dacrydium_cupressinum 19.63% passed 99.65% 167 Falcatifolium_papuanum 28.27% passed 99.97% 168 Halocarpus_bidwillii 19.63% passed 99.74% 169 Lagarostrobus_franklinii 20.94% passed 99.12% 170 Lepidothamnus_fonkii 28.27% passed 98.93% 171 Lepidothamus_laxifolius 23.30% passed 99.33% 172 Manoao_colensoi 20.68% passed 97.10% 173 Microcachrys_tetragona 19.90% passed 97.31% 174 Microstrobus_fitzgeraldii 22.77% passed 94.45% 175 Microstrobus_niphophilus 27.75% passed 92.99% 176 Nagaeia_nagi 20.16% passed 99.93% 177 Parasitaxus_ustus 29.32% passed 98.87% 178 Podocarpus_chinensis 24.87% passed 99.99% 179 Podocarpus_coriaceus 26.96% passed 99.99% 180 Podocarpus_latifolius 20.42% passed 99.97% 181 Podocarpus_matudai 26.96% passed 99.99% 182 Podocarpus_rumphii 27.23% passed 99.99% 183 Podocarpus_salignus 19.63% passed 99.94% 184 Podocarpus_sylvestris 26.96% passed 100.00% 185 Podocarpus_totara 18.85% passed 99.87% 186 Prumnopitys_ladei 26.70% passed 99.98% 187 Retrophyllum_comptonii 25.92% passed 99.95% 188 Saxegothaea_conspicua 21.47% passed 99.97% 189 Sundacarpus_amarus 22.77% passed 99.99% 190 Sciadopitys_verticillata 15.18% passed 99.52% 191 Cephalotaxus_fortunei 17.80% passed 90.37% 192 Cephalotaxus_harringtonii 17.28% passed 91.26% 193 Cephalotaxus_sinensis 17.80% passed 90.37% 194 Amentotaxus_formosana 18.32% passed 86.12% 195 Austrotaxus_spicata 18.32% passed 91.98% 196 Pseudotaxus_chienii 18.59% passed 79.11% 197 Taxus_baccata 18.85% passed 88.25% 198 Taxus_brevifolia 18.85% passed 88.25% 199 Taxus_cuspidata 18.85% passed 88.25% 200 Torreya_grandis 18.59% passed 92.69% 201 Torreya_taxifolia 18.59% passed 92.69% 202 Antarcticycas_schopfii 71.99% passed 72.22% 203 Beania_gracilis 77.23% passed 75.64% 204 Cycas_circinalis 23.04% passed 84.43% 205 Cycas_multipinnata 23.04% passed 74.69% 206 Cycas_pectinata 23.04% passed 86.49% 207 Cycas_revoluta 23.04% passed 84.43% 208 Bowenia_serrulata 22.77% passed 73.65% 209 Ceratozamia_mexicana 22.77% passed 74.86% 210 Ceratozamia_miqueliana 22.77% passed 74.86% 211 Dioon_edule 23.04% passed 48.14% 212 Dioon_purpusii 23.04% passed 53.61% 213 Dioon_spinulosum 23.04% passed 53.61% 214 Encephalartos_barteri 23.04% passed 26.24% 215 Encephalartos_ghellinckii 23.04% passed 28.23% 216 Encephalartos_horridus 23.04% passed 31.53% 217 Lepidozamia_hopei 23.04% passed 28.23% 218 Macrozamia_macdonnellii 23.04% passed 21.61% 219 Macrozamia_moorei 23.04% passed 21.61% 220 Macrozamia_pauli 23.04% passed 26.43% 221 Macrozamia_platyrhachis 23.04% passed 28.28% 222 Microcycas_calocoma 22.77% passed 73.70% 223 Stangeria_eriopus 23.30% passed 85.22% 224 Zamia_furfuracea 22.77% passed 87.89% 225 Zamia_integrifolia 22.77% passed 87.89% 226 Zamia_neurophyllidia 22.77% passed 74.48% 227 Zamia_pumila 22.77% passed 87.89% 228 Zamia_restrepoi 22.77% passed 82.78% 229 Ginkgo_sp. 73.04% passed 35.92% 230 Ginkgo_biloba 14.92% passed 63.76% 231 Drewria_potomacensis 78.27% passed 90.99% 232 Ephedra_archaeorhytidosperma 92.93% passed 21.32% 233 Welwitschia_sp. 89.27% passed 25.94% 234 Ephedra_antisyphylitica 14.14% passed 96.33% 235 Ephedra_aphylla 14.14% passed 96.33% 236 Ephedra_californica 14.14% passed 96.33% 237 Ephedra_chilensis 14.14% passed 96.33% 238 Ephedra_compacta 14.14% passed 96.33% 239 Ephedra_distachya 14.14% passed 96.33% 240 Ephedra_fasciculata 14.14% passed 96.33% 241 Ephedra_foemina 14.14% passed 96.33% 242 Ephedra_laristanica 14.14% passed 96.33% 243 Ephedra_multiflora 14.14% passed 96.33% 244 Ephedra_pedunculata 14.14% passed 96.33% 245 Ephedra_saxilitis 14.14% passed 96.33% 246 Ephedra_sinica 14.14% passed 96.33% 247 Ephedra_viridis 14.14% passed 96.33% 248 Gnetum_gnemon 15.45% passed 74.60% 249 Gnetum_gnemonoides 15.45% passed 74.60% 250 Gnetum_klossii 15.45% passed 74.60% 251 Gnetum_latifolium 15.45% passed 74.60% 252 Gnetum_nodiflorum 15.18% passed 67.19% 253 Gnetum_parvifolium 15.45% passed 74.60% 254 Gnetum_tenuifolium 15.45% passed 74.60% 255 Gnetum_ula 15.18% passed 67.19% 256 Gnetum_woodsonianum 15.18% passed 67.19% 257 Gnetum_urens 15.18% passed 67.19% 258 Welwitschia_mirabilis 14.92% passed 90.60% 259 Archaefructus_sinensis 76.70% passed 30.56% 260 Eorhiza_arnoldii 50.26% passed 27.19% 261 Joffrea_speirsii 71.20% passed 93.49% 262 Macginitea 64.40% passed 81.51% 263 Limnobiophyllum_scutatum 83.25% passed 90.51% 264 Chloranthus 31.15% passed 44.09% 265 Piper 30.37% passed 73.62% 266 Drimys 30.89% passed 90.36% 267 Calycanthus 30.89% passed 93.82% 268 Eupomatia 30.89% passed 98.42% 269 Magnolia 30.10% passed 98.93% 270 Persea 30.63% passed 98.95% 271 Nymphaea 35.86% passed 98.52% 272 Lilium 34.82% passed 75.14% 273 Dillenia 31.68% passed 97.23% 274 Caltha 34.82% passed 96.01% 275 Trochodendron 30.37% passed 87.27% 276 Platanus 30.63% passed 84.59% 277 Hamamelis 30.63% passed 98.32% 278 Chrysolepis 31.15% passed 89.05% 279 Betula 30.63% passed 97.55% 280 Casuarina 32.46% passed 98.30% 281 Ceratophyllum 38.22% passed 55.52% 282 Acorus 34.03% passed 82.83% 283 Sagittaria 33.25% passed 86.94% 284 Amborella 29.84% passed 91.72% 285 Austrobaileya 29.58% passed 95.71% 286 Illicium 29.32% passed 98.32% 287 Saruma 34.55% passed 59.70% 288 Saururus 34.82% passed 79.00% WARNING: 69 sequences contain more than 50% gaps/ambiguity **** TOTAL 37.42% 13 sequences failed composition chi2 test (p-value<5%; df=6) NOTE: Dacrydium_balansae is identical to Dacrydium_araucarioides but kept for subsequent analysis NOTE: Podocarpus_matudai is identical to Podocarpus_coriaceus but kept for subsequent analysis NOTE: Cephalotaxus_sinensis is identical to Cephalotaxus_fortunei but kept for subsequent analysis NOTE: Taxus_brevifolia is identical to Taxus_baccata but kept for subsequent analysis NOTE: Torreya_taxifolia is identical to Torreya_grandis but kept for subsequent analysis NOTE: Cycas_revoluta is identical to Cycas_circinalis but kept for subsequent analysis NOTE: Ceratozamia_miqueliana is identical to Ceratozamia_mexicana but kept for subsequent analysis NOTE: Dioon_spinulosum is identical to Dioon_purpusii but kept for subsequent analysis NOTE: Macrozamia_moorei is identical to Macrozamia_macdonnellii but kept for subsequent analysis NOTE: Zamia_integrifolia is identical to Zamia_furfuracea but kept for subsequent analysis NOTE: Ephedra_aphylla is identical to Ephedra_antisyphylitica but kept for subsequent analysis NOTE: Gnetum_gnemonoides is identical to Gnetum_gnemon but kept for subsequent analysis NOTE: Gnetum_ula is identical to Gnetum_nodiflorum but kept for subsequent analysis NOTE: 20 identical sequences (see below) will be ignored for subsequent analysis NOTE: Taxus_cuspidata (identical to Taxus_baccata) is ignored but added at the end NOTE: Zamia_pumila (identical to Zamia_furfuracea) is ignored but added at the end NOTE: Ephedra_californica (identical to Ephedra_antisyphylitica) is ignored but added at the end NOTE: Ephedra_chilensis (identical to Ephedra_antisyphylitica) is ignored but added at the end NOTE: Ephedra_compacta (identical to Ephedra_antisyphylitica) is ignored but added at the end NOTE: Ephedra_distachya (identical to Ephedra_antisyphylitica) is ignored but added at the end NOTE: Ephedra_fasciculata (identical to Ephedra_antisyphylitica) is ignored but added at the end NOTE: Ephedra_foemina (identical to Ephedra_antisyphylitica) is ignored but added at the end NOTE: Ephedra_laristanica (identical to Ephedra_antisyphylitica) is ignored but added at the end NOTE: Ephedra_multiflora (identical to Ephedra_antisyphylitica) is ignored but added at the end NOTE: Ephedra_pedunculata (identical to Ephedra_antisyphylitica) is ignored but added at the end NOTE: Ephedra_saxilitis (identical to Ephedra_antisyphylitica) is ignored but added at the end NOTE: Ephedra_sinica (identical to Ephedra_antisyphylitica) is ignored but added at the end NOTE: Ephedra_viridis (identical to Ephedra_antisyphylitica) is ignored but added at the end NOTE: Gnetum_klossii (identical to Gnetum_gnemon) is ignored but added at the end NOTE: Gnetum_latifolium (identical to Gnetum_gnemon) is ignored but added at the end NOTE: Gnetum_parvifolium (identical to Gnetum_gnemon) is ignored but added at the end NOTE: Gnetum_tenuifolium (identical to Gnetum_gnemon) is ignored but added at the end NOTE: Gnetum_woodsonianum (identical to Gnetum_nodiflorum) is ignored but added at the end NOTE: Gnetum_urens (identical to Gnetum_nodiflorum) is ignored but added at the end For your convenience alignment with unique sequences printed to output.uniqueseq.phy WARNING: States(s) 4, 5 rarely appear in alignment and may cause numerical problems Creating fast initial parsimony tree by random order stepwise addition... 4.642 seconds, parsimony score: 2228 (based on 375 sites) NOTE: ModelFinder requires 58 MB RAM! ModelFinder will test 26 morphological models (sample size: 382) ... No. Model -LnL df AIC AICc BIC Measuring multi-threading efficiency up to 24 CPU cores Increase to 10 rounds for branch lengths 78 trees examined Threads: 1 / Time: 24.187 sec / Speedup: 1.000 / Efficiency: 100% / LogL: -46543 Threads: 2 / Time: 15.380 sec / Speedup: 1.573 / Efficiency: 79% / LogL: -46543 Threads: 3 / Time: 13.437 sec / Speedup: 1.800 / Efficiency: 60% / LogL: -46543 Threads: 4 / Time: 12.909 sec / Speedup: 1.874 / Efficiency: 47% / LogL: -46543 BEST NUMBER OF THREADS: 3 1 MK+FQ 13951.907 533 28969.814 598213.814 31072.723 2 MK+FQ+I 13950.293 534 28968.587 600348.587 31075.441 3 MK+FQ+G4 13686.063 534 28440.127 599820.127 30546.981 4 MK+FQ+I+G4 13685.257 535 28440.513 601960.513 30551.313 5 MK+FQ+R2 13703.486 535 28476.972 601996.972 30587.772 6 MK+FQ+R3 13675.414 537 28424.827 606236.827 30543.518 7 MK+FQ+R4 13670.266 539 28418.532 610538.532 30545.114 14 ORDERED+FQ 11748.175 533 24562.349 593806.349 26665.259 15 ORDERED+FQ+I 11744.815 534 24557.630 595937.630 26664.484 16 ORDERED+FQ+G4 11288.808 534 23645.615 595025.615 25752.470 17 ORDERED+FQ+I+G4 11288.796 535 23647.593 597167.593 25758.393 18 ORDERED+FQ+R2 11331.420 535 23732.841 597252.841 25843.641 19 ORDERED+FQ+R3 11217.353 537 23508.707 601320.707 25627.398 20 ORDERED+FQ+R4 11202.626 539 23483.251 605603.251 25609.833 21 ORDERED+FQ+R5 11198.261 541 23478.522 609922.522 25612.994 Akaike Information Criterion: ORDERED+FQ+R5 Corrected Akaike Information Criterion: ORDERED+FQ Bayesian Information Criterion: ORDERED+FQ+R4 Best-fit model: ORDERED+FQ+R4 chosen according to BIC All model information printed to output.model.gz CPU time for ModelFinder: 246.147 seconds (0h:4m:6s) Wall-clock time for ModelFinder: 88.508 seconds (0h:1m:28s) Generating 1000 samples for ultrafast bootstrap (seed: 980641)... NOTE: 24 MB RAM (0 GB) is required! Measuring multi-threading efficiency up to 24 CPU cores Increase to 10 rounds for branch lengths 45 trees examined Threads: 1 / Time: 24.430 sec / Speedup: 1.000 / Efficiency: 100% / LogL: -31115 Threads: 2 / Time: 15.802 sec / Speedup: 1.546 / Efficiency: 77% / LogL: -31115 Threads: 3 / Time: 13.101 sec / Speedup: 1.865 / Efficiency: 62% / LogL: -31115 Threads: 4 / Time: 11.750 sec / Speedup: 2.079 / Efficiency: 52% / LogL: -31115 Threads: 5 / Time: 11.140 sec / Speedup: 2.193 / Efficiency: 44% / LogL: -31115 BEST NUMBER OF THREADS: 4 Estimate model parameters (epsilon = 0.100) 1. Initial log-likelihood: -11267.445 2. Current log-likelihood: -11229.521 3. Current log-likelihood: -11210.947 4. Current log-likelihood: -11208.692 5. Current log-likelihood: -11208.069 6. Current log-likelihood: -11207.631 7. Current log-likelihood: -11207.229 8. Current log-likelihood: -11206.819 9. Current log-likelihood: -11206.392 10. Current log-likelihood: -11205.957 11. Current log-likelihood: -11205.530 12. Current log-likelihood: -11205.127 13. Current log-likelihood: -11204.763 14. Current log-likelihood: -11204.441 15. Current log-likelihood: -11204.163 16. Current log-likelihood: -11203.924 17. Current log-likelihood: -11203.716 18. Current log-likelihood: -11203.529 19. Current log-likelihood: -11203.352 20. Current log-likelihood: -11203.170 21. Current log-likelihood: -11202.985 22. Current log-likelihood: -11202.826 23. Current log-likelihood: -11202.707 Optimal log-likelihood: -11202.622 Site proportion and rates: (0.384,0.273) (0.387,0.887) (0.196,1.874) (0.032,5.690) Parameters optimization took 23 rounds (5.135 sec) Computing ML distances based on estimated model parameters... 1.151 sec Computing BIONJ tree... 0.048 seconds Log-likelihood of BIONJ tree: -11577.910 -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Generating 98 parsimony trees... 13.543 second Computing log-likelihood of 98 initial trees ... 7.948 seconds Current best score: -11202.622 Do NNI search on 20 best initial trees Estimate model parameters (epsilon = 0.100) BETTER TREE FOUND at iteration 1: -11083.124 ERROR: iqtree.cpp:3149: virtual std::pair<int, int> IQTree::optimizeNNI(bool): Assertion `curScore > appliedNNIs.at(0).newloglh - params->loglh_epsilon' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 6 IQTree::optimizeNNI(bool) ERROR: 7 IQTree::doNNISearch() ERROR: 8 IQTree::initCandidateTreeSet(int, int) ERROR: 9 IQTree::doTreeSearch() ERROR: 10 runTreeReconstruction(Params&, std::string&, IQTree*&, ModelCheckpoint&) ERROR: 11 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 12 main() ERROR: 13 __libc_start_main() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: output.log ERROR: *** Alignment files (if possible) ", "Dear Sarah, This crash might be due to too stringent assertion condition (recomputed log-likelihood difference < 0.001). So in version 1.6.3 IQ-TREE relaxes this condition a bit (by raising the threshold to 0.1). Thus can you please repeat with this latest version? If this crash still happens, then please send me the input alignment for debugging. There is however a WARNING that needs attention: WARNING: States(s) 4, 5 rarely appear in alignment and may cause numerical problems Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "tqiDVYMlAGI": {"topic": "partition by codon position + error in version 1.6.1", "initializeDate": "Jan 10, 2018, 12:29:23 AM", "timeStamp": "Jan 22, 2018, 10:56:58 PM", "content": ["Hi, I'm using iqtree (v.1.6.1) on a mixed dataset (2 alignments, one protein-coding and another non-coding). 1) I'd also like to further partition the protein-coding alignment according to codon positions. I've come across manuals/discussions that codon partitioning can be specified as below (but I haven't been able to find the text again to share here). Just to confirm, is this the correct way to write the nexus file if I want to partition codon positions 1, 2 and 3 into different partitions? What is the function of the 'charpartition' argument that I've seen in some tutorials? ----------- #NEXUS begin sets; charset coding1=coding.phy:DNA, 1-1233\\3; charset coding2=coding.phy:DNA, 2-1233\\3; charset coding3=coding.phy:DNA, 3-1233\\3; charset noncode=noncode.phy:DNA, 1-2145; end; ---------- 2) Also, using the same iqtree version, I tried to run a mixed dataset (one gene in Amino acid and another gene in DNA characters), and it terminated with an error. It runs to completion with iqtree v1.5.5 though. Has the command changed? Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.002 seconds NOTE: ModelFinder requires 7 MB RAM! ERROR: Cannot concatenate sub-alignments of different type Thanks mht ", "Hi mht, On Jan 10, 2018, at 6:29 AM, mht < mh.t...@gmail.com > wrote: Hi, I'm using iqtree (v.1.6.1) on a mixed dataset (2 alignments, one protein-coding and another non-coding). 1) I'd also like to further partition the protein-coding alignment according to codon positions. I've come across manuals/discussions that codon partitioning can be specified as below (but I haven't been able to find the text again to share here). Just to confirm, is this the correct way to write the nexus file if I want to partition codon positions 1, 2 and 3 into different partitions? What is the function of the 'charpartition' argument that I've seen in some tutorials? ----------- #NEXUS begin sets; charset coding1=coding.phy:DNA, 1-1233\\3; charset coding2=coding.phy:DNA, 2-1233\\3; charset coding3=coding.phy:DNA, 3-1233\\3; charset noncode=noncode.phy:DNA, 1-2145; end; ---------- That\u2019s the right input. You can input this partition file into IQ-TREE and it will automatically detect the best model for each partition. The optional \u2018charpartition' is the command to specify the model for each partition. So IQ-TREE will obey the model specification in charpartition command. 2) Also, using the same iqtree version, I tried to run a mixed dataset (one gene in Amino acid and another gene in DNA characters), and it terminated with an error. It runs to completion with iqtree v1.5.5 though. Has the command changed? Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.002 seconds NOTE: ModelFinder requires 7 MB RAM! ERROR: Cannot concatenate sub-alignments of different type There is one major change between v1.5 and v1.6, that v1.6 supports edge-linked partitionfinder whereas v1.5 doesn\u2019t (while both versions support edge-unlinked partitionfinder). Thus in case you specify partition file with -sp option, both versions operate identically. But if you use option -spp, then the two versions will be different: v1.5 (or earlier) will do edge-unlinked ModelFinder but subsequently do edge-linked tree search. v1.6 will do edge-linked ModelFinder and also edge-linked tree search. Unfortunately, in v1.6 the edge-linked ModelFinder does not support mixed data type yet, thus the ERROR you saw. This will be added in the next software update. As a work-around right now, you can do ModelFinder for each data type separately, then merge the resulting best_scheme and do tree search on the merged best_scheme. Cheers, Minh Thanks mht You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Thanks for your reply. Further expanding on the first question, if I have more than 1 gene and would like to partition both by gene AND codon position, I'd write a nexus file as below. Just wondering though, is there a difference between the below versus combining all of codon1 in just 1 line (e.g. charset all_codon1=coding.phy:DNA, 1-1233\\3 1234-1533\\3;)? ----------- #NEXUS begin sets; charset gene1_codon1=coding.phy:DNA, 1-1233\\3; charset gene1_codon2=coding.phy:DNA, 2-1233\\3; charset gene1_codon3=coding.phy:DNA, 3-1233\\3; charset gene2_codon1=coding.phy:DNA, 1234-1533\\3; charset gene2_codon2=coding.phy:DNA, 1234-1533\\3; charset gene2_codon3=coding.phy:DNA, 1234-1533\\3; end; ---------- Cheers, mht ", "Dear mht again, The difference between: > charset all_codon1=coding.phy:DNA, 1-1233\\3 1234-1533\\3; and > charset gene1_codon1=coding.phy:DNA, 1-1233\\3; > charset gene2_codon1=coding.phy:DNA, 1234-1533\\3; is that the first will apply the same model for codon position 1 of both gene1+gene2, whereas the second allows different models for gene1_codon1 and gene2_codon1. I recommend to declare the 6 partitions like you wrote below, and let ModelFinder find out whether to merge partitions or not. Cheers, Minh "]}, "-hVzK10k7qo": {"topic": "How many ultrafast bootstraps should be set in analyses based on single gene\uff1f", "initializeDate": "Dec 11, 2017, 8:49:00 PM", "timeStamp": "Dec 12, 2017, 10:17:42 AM", "content": ["Hello, In recent days, I used raxml and iqtree to construct phylogenetic tree based on 18s rDNA region, When I set the bootstraps to 1000, the topologies obtained from raxml and iqtree are almost the same. However, when I set 10000 for iqtree, the topology changes. The result of consel I used to test which tree is better reveals the tree constructed by 1000 bootstraps is better than 10000 bootstraps. However, the values and topology tree constructed by 10000 bootstraps are what I want. Could some tell me how many ultrafast bootstraps should be set in analyses based on single gene\uff1f Thanks a lot. Wang Jiazhe ", "Hi Wang, How many sequences do you have? I think your question has little to do with the number of bootstrap replicates; the fact that with 10,000 replicates you got more expected trees is rather pure chance. If you rerun IQ-TREE the 2nd or 3rd time, you may end up with different trees. Have a look at the NOTE here ( http://www.iqtree.org/doc/Command-Reference#tree-search-parameters NOTE : While the default parameters were empirically determined to work well under our extensive benchmark ( Nguyen et al., 2015 ), it might not hold true for all data sets. If in doubt that tree search is still stuck in local optima, one should repeat analysis with at least 10 IQ-TREE runs. Moreover, our experience showed that -pers and -nstop are the most relevant options to change in such case. For example, data sets with many short sequences should be analyzed with smaller perturbation strength (e.g. -pers 0.2 ) and larger number of stop iterations (e.g. -nstop 500 Your 18S alignment likely falls into this case. Therefore, I suggest that you repeat 10 runs and possibly adjust these parameters to improve the result tree. If more than one tree is found, you can do some tree topology tests (see Advanced Tutorial) to figure out the best likely tree. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "peSk68y_vtM": {"topic": "question to randomized starting trees", "initializeDate": "Sep 14, 2015, 10:38:24 AM", "timeStamp": "Sep 14, 2015, 1:01:51 PM", "content": ["Dear Minh and all, since its for me not quite clear in the manual (not in there yet) (and finally starting on final datasets more or less) how do I correctly invole the randomized starting tree option: is this correct: (example) ./iqtree-omp -omp X -s blabla.phy -spp partitionbla.nex -pre test -t RANDOM -numpars 200 -toppars 50 -numstop 50 -numcand 10 -alrt 1000 or is -numpars 200 -toppars 50 -numstop 200 not necessary because you start from randomized trees? or does it mean it will just use randomized (instead of parsimony trees - is it still meaningful to apply the optimization here ? in this example: start with 200 randomized trees, select the best 50 (number of unsuccesful iterations: is less more strict?) and how many tree searches are conducted in the above example then, 10 (default five)? How many tree searches you would recommend? Many thanks, cheers Karen ", "Dear Karen, On 14 Sep 2015, at 16:38, Karen Meusemann < kmeus...@googlemail.com > wrote: Dear Minh and all, since its for me not quite clear in the manual (not in there yet) (and finally starting on final datasets more or less) right, in fact there are many other features I should describe in the manual... how do I correctly invole the randomized starting tree option: is this correct: (example) ./iqtree-omp -omp X -s blabla.phy -spp partitionbla.nex -pre test -t RANDOM -numpars 200 -toppars 50 -numstop 50 -numcand 10 -alrt 1000 For -t RANDOM please see my previous post https://groups.google.com/forum/#!topic/iqtree/3YuZCFeTz2U Thus the option -numpars, -toppars have no effect right now. Please use a large -numstop: in your command line, IQ-Tree will stop if the last 50 iterations do not find a better tree. This might be too early. or is -numpars 200 -toppars 50 -numstop 200 not necessary because you start from randomized trees? or does it mean it will just use randomized (instead of parsimony trees - is it still meaningful to apply the optimization here ? See above. \"-numstop 200\u201d makes the tree search more thorough than \u201c-numstop 50\" in this example: start with 200 randomized trees, select the best 50 (number of unsuccesful iterations: is less more strict?) again, larger is better and how many tree searches are conducted in the above example then, 10 (default five)? only 1 tree search! \u201c-numcand\u201d is for number of candidate trees within 1 tree search. You need to manually run multiple tree searches. How many tree searches you would recommend? I recommend 10. Many thanks, cheers Karen you are welcome ;-) Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "pK8ZVlo4OEk": {"topic": "Question about collapsing based on SH-aLRT and UFBoot support", "initializeDate": "Mar 25, 2017, 8:16:28 AM", "timeStamp": "Apr 5, 2017, 12:25:49 PM", "content": ["Dear IQ-TREE, Greetings! I successfully ran IQ-TREE on my data with \"iqtree-omp -nt 4 -s or.mafft.fa -st AA -m JTT+G4+F -bb 1000 -alrt 1000\"; and according to your FAQ, I'm planning to collapse all splits with SH-aLRT<80% or UFBoot<95%. I was wondering which tool would allow me to do that? I tried Dendroscope, iTOL, and TreeGraph; but none of them seem to understand the fact that there're two kinds of support values and thus cannot automatically collapse. Is there a way to do so? Thank you so much in advance!! Best, Longzhi ", "Dear longzhi, i have no idea how to do this automatically. You may better ask the developpers of these tree viewer software. cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Minh, Thank you so much anyways for your kind help!! Best, Longzhi ", "Dear Longzhi, I just discovered that there is an option to do this in IQ-TREE ;-) which I implemented some time ago for a collaborator but then forgot. For your run you can do this: iqtree -t mafft.fa.treefile -minsupnew 80/95 assuming that mafft.fa.treefile is the tree file produced by a previous bootstrap and SH-aLRT run. This will write a tree file mafft.fa.treefile.collapsed, where the branches are collapsed as wanted. Hope this still helps. Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Thank you so much for telling me about this very useful option!! However, I'm having trouble running it with the following attempts. I'm also attaching the treefile and the iqtree file, in case there're any problems with my tree inference. Thanks a lot in advance! =====OS X, with -nt 4===== ../bin/iqtree-omp -nt 4 -minsupnew 80/95 -t or.mafft.fa.treefile IQ-TREE multicore version 1.5.3 for Mac OS X 64-bit built Jan 15 2017 Copyright (c) 2011-2016 Nguyen Lam Tung, Olga Chernomor, Arndt von Haeseler and Bui Quang Minh. Host: jumparound.local (AVX2, FMA3, 8 GB RAM) Command: ../bin/iqtree-omp -nt 4 -minsupnew 80/95 -t or.mafft.fa.treefile Seed: 367272 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Apr 5 12:19:40 2017 Kernel: AVX+FMA - 4 threads(4 CPU cores detected) STACK TRACE FOR DEBUGGING: 1 splitnumtaxacmp(Split const*, Split const*) 2 _sigtramp() 4 nodenamecmp(Node const*, Node const*) 5 nodenamecmp(Node const*, Node const*) 6 nodenamecmp(Node const*, Node const*) 7 nodenamecmp(Node const*, Node const*) 8 nodenamecmp(Node const*, Node const*) 9 nodenamecmp(Node const*, Node const*) 10 nodenamecmp(Node const*, Node const*) 11 nodenamecmp(Node const*, Node const*) 12 splitnumtaxacmp(Split const*, Split const*) 13 splitnumtaxacmp(Split const*, Split const*) *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT *** For bug report please send to developers: *** Log file: or.mafft.fa.treefile.log *** Alignment files (if possible) Segmentation fault: 11 =====OS X, with -nt 1, which sometimes gives the following error and a truncated output, but sometimes gives the same error as above===== ../bin/iqtree-omp -nt 1 -minsupnew 80/95 -t or.mafft.fa.treefile IQ-TREE multicore version 1.5.3 for Mac OS X 64-bit built Jan 15 2017 Copyright (c) 2011-2016 Nguyen Lam Tung, Olga Chernomor, Arndt von Haeseler and Bui Quang Minh. Host: jumparound.local (AVX2, FMA3, 8 GB RAM) Command: ../bin/iqtree-omp -nt 1 -minsupnew 80/95 -t or.mafft.fa.treefile Seed: 380288 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Apr 5 12:15:42 2017 Kernel: AVX+FMA - 1 threads(4 CPU cores detected) ERROR: Cannot write to file or.mafft.fa.treefile.collapsed =====CentOS, with sequential 64bit binary, which writes an output of approximately the right size, but contains strange characters inside===== ./iqtree -minsupnew 80/95 -t or.mafft.fa.treefile IQ-TREE version 1.5.4 for Linux 64-bit built Apr 2 2017 Copyright (c) 2011-2017 by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, and Arndt von Haeseler. Host: rclogin07.rc.fas.harvard.edu (SSE3, 15 GB RAM) Command: ./iqtree -minsupnew 80/95 -t or.mafft.fa.treefile Seed: 323778 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Apr 5 12:22:53 2017 Kernel: SSE2 NOTE: Consider using the multicore version because your CPU has 4 cores! Tree with collapsed branches written to or.mafft.fa.treefile.collapsed STACK TRACE FOR DEBUGGING: Segmentation fault Best, Longzhi "]}, "PbWngct3TvM": {"topic": "Correct use of ASC and polymorphic sites (SNPs only)", "initializeDate": "Oct 29, 2019, 5:37:58 AM", "timeStamp": "Oct 30, 2019, 1:38:58 AM", "content": ["Hi, There as been some discussion within a chat group I am member of and that let me to wonder If I understood well how to use iqtree. Please could you give some advises here? I was wondering about how to use +ASC when only using concatenated SNPs (concatenate SNPs from core alignement) - If I understand well providing the proportion of invariant sites +I{0.8} will correct/scale the branch lengths - but what is the effect of using concatenated polymorphic sites on the likelihood and \"best model\" infered from model test? ---> should we not provide nucleotide frequencies for constant sites? as substitutions models assume a certain nucleotide frequency - I assume that models will be affected if we do not provide that no? so should we provide the number of constant sites for each nucleotide? Best regards Eve ", "Hi Eve, On 29 Oct 2019, at 8:37 pm, Eve < eve...@gmail.com > wrote: Hi, There as been some discussion within a chat group I am member of and that let me to wonder If I understood well how to use iqtree. Please could you give some advises here? That\u2019s the purpose of this mail list. I was wondering about how to use +ASC when only using concatenated SNPs (concatenate SNPs from core alignement) - If I understand well providing the proportion of invariant sites +I{0.8} will correct/scale the branch lengths That\u2019s not the right way, because +ASC and +I models are mutually exclusive. From your description, let\u2019s assume that your alignment has only variant sites. Then setting p_inv = 0.8 like that is not valid, because p_inv must be bounded between 0 and the proportion of invariant sites (0 in this case). Perhaps, you can use -fconst option: -fconst f1,...,fN Add constant patterns into alignment (N=#nstates) To add number of the (missing) constant sites (As, Cs, Gs, Ts) into the alignment, if you know that information. - but what is the effect of using concatenated polymorphic sites on the likelihood and \"best model\" infered from model test? I don\u2019t really get what you meant here... ---> should we not provide nucleotide frequencies for constant sites? as substitutions models assume a certain nucleotide frequency - I assume that models will be affected if we do not provide that no? so should we provide the number of constant sites for each nucleotide? Perhaps the -fconst option above is what you wanted. Cheers, Minh Best regards Eve You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/30377d7b-64e7-4a22-bca2-136ea800a50c%40googlegroups.com "]}, "VQuDqZnX4Cg": {"topic": "Partitioned support values", "initializeDate": "Jun 15, 2016, 5:54:28 PM", "timeStamp": "Jul 12, 2016, 6:52:47 AM", "content": ["Hello, I have a question (or request?) about support methods considering partitioned analyses; Example: I have a dataset with 3 partitions (16S, 18S and 28S); after I get my ML tree I calculate support values (e.g., bootstrap and alrt) for this tree. Let\u00b4s say this my \"all-partition analysis\". Now, I would like to know how much \"support\" would be defined from each partition. I made this manually: I pick the ML tree obtained from the all-partition analysis, and calculate support values using as dataset just one of the original partition (e.g., 16S). IQ-TREE would implement a partitioned support values \"coming from each partition\"? It would be useful, specially when we have several partitions... I\u00b4m using this idea taking account the hidden branch support approach http://onlinelibrary.wiley.com/doi/10.1111/j.1439-0469.2012.00670.x/abstract http://sysbio.oxfordjournals.org/cgi/doi/10.1080/10635150701294733 10.1111/j.1096-0031.1999.tb00268.x Thanks in advance, max maronna ORCID: http://orcid.org/0000-0002-2590-639X ", "Dear max, I understand and think that your idea is interesting, given that there may be conflicting signals between genes, that can also contradict the species tree. I think such a strategy can be easily implemented if there is no missing data, i.e. you having all gene sequences for all taxa. Otherwise if some gene does not have sequences for some taxa, it is not clear how to map branch supports from such \"partial\" gene tree onto the branches of the species tree. Thus more thoughts are necessary... Minh Sent from my Samsung device You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hello Minh, Thank you for your fast response. Yes, my question-request is based on datasets with no \"missing taxa\". Considering datasets with missing taxa (at least for some molecular marker), I agreed with you: \"more thoughts are necessary\" -specially for branch tests like alrt and sh-alrt-. Best, max ORCID: http://orcid.org/0000-0002-2590-639X ", "Dear all, for us (1kite) it would be also awesome if this could be implemented as soon as possible to e.g. test if something comes from particular partitions that have strong signal and for example might lower/increase overall BS of the particular taxon. Few thought about partitions that don't have all taxa: * either here for the respecive braches will be simply no BS displayed or * partitioned BS are only provided for the partitions for which all taxa are available (e.g. include at least few unab\u1e3fbiguous sites) (I was wondering how this is implemented actually in the partitioned BS in general, because in some datasets of indeed some species might be missing (e.g. if three are other species that serve as representatives for the group / taxon of interest). ?? All the best Karen ", "Hi Karen, On Jun 20, 2016, at 9:19 PM, 'Karen Meusemann' via IQTREE < iqt...@googlegroups.com > wrote: Dear all, for us (1kite) it would be also awesome if this could be implemented as soon as possible to e.g. test if something comes from particular partitions that have strong signal and for example might lower/increase overall BS of the particular taxon. ok I see. I put this into the TODO list. For the moment some scripting is necessary like Max mentioned. Few thought about partitions that don't have all taxa: * either here for the respecive braches will be simply no BS displayed or * partitioned BS are only provided for the partitions for which all taxa are available (e.g. include at least few unab\u1e3fbiguous sites) that\u2019s what I am intending to do for the moment. (I was wondering how this is implemented actually in the partitioned BS in general, because in some datasets of indeed some species might be missing (e.g. if three are other species that serve as representatives for the group / taxon of interest). ?? For the partitioned analysis, these missing data are replaced by unknown characters (? or N) which are treated in the way described in the FAQ: http://www.cibiv.at/software/iqtree/doc/Frequently-Asked-Questions/#how-does-iq-tree-treat-gapmissingambiguous-characters . Since the genes are concatenated, each species is \u201crepresented\u201d by a long sequence, which can be \u201cgappy\u201d in some parts (due to missing data), but the other non-gappy parts help to resolve the tree and compute branch support. Thus there should be no problem, except if some sequence is too gappy (which you would remove in advance anyway). Does this answer your question? Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi all, sorry for the delayed answer (moving etc). If it could be implemented as soon as possible would be great (we immediately would apply this option. And Minh - thanks I got what you wrote ! best Karen ", "Hi Karen, unfortunately I underestimated the amount of work that is necessary to implement this option, especially concerning the checkpointing and parallel computation (as this will involve a lot of computation) and final \u201cvisualization\u201d of the results. E.g. if there are 1000 partition how can one effectively view 1000 support values (coming from 1000 partitions) onto each single branch of the species tree? Let alone the problem of partial gene trees that cannot be dealt with right now. Therefore it is better to write some scripting pipeline. This may repeatedly call IQ-TREE to perform bootstrap analysis for each partition. Then the bootstrap values can be assigned onto the species tree using `-sup` option (see http://www.cibiv.at/software/iqtree/doc/Command-Reference/#constructing-consensus-tree Sorry that I can\u2019t be more helpful this time Minh ", "Hey Minh, sure, I see; >unfortunately I underestimated the amount of work that is necessary to implement this option, especially concerning the checkpointing and parallel computation (as this will involve a lot of computation) and final >\u201cvisualization\u201d of the results. E.g. if there are 1000 partition how can one effectively view 1000 support values (coming from 1000 partitions) onto each single branch of the species tree? Let alone the problem of partial >gene trees that cannot be dealt with right now. I did not think of visualisation, my thought was e.g. to provide an extra text file where the support for each partition & branch are just listed... - but thinking about it yes I can see the dificulties. Therefore it is better to write some scripting pipeline. This may repeatedly call IQ-TREE to perform bootstrap analysis for each partition. Then the bootstrap values can be assigned onto the species tree using `-sup` option (see http://www.cibiv.at/software/iqtree/doc/Command-Reference/#constructing-consensus-tree ok I will somehow try this (so I do bs for each partition, so I would split up the supermatrix into X partition and run bs analyses for each -- and then seperately draw them onto the best tree, right? (I gt then 2000 files with the best tree but boostraps mapped from each single partition, correct?) Again (I think this was already a question before) I only can take partitions having all species with present data? Otherwise it will not work if I have e.g. species in single partitions completely missing? I will try to do this and let you know :)) many thanks, and thanks for always being helpful and try to find solution :) Cheers Karen ", "Hi Karen, yes this is what I (you) would do ;-) If you have such a script ready can you share with me, as I may reuse at some point. Thanks, Minh "]}, "1t1fd9dAKak": {"topic": "Ghost model error", "initializeDate": "May 9, 2020, 1:09:42 PM", "timeStamp": "Dec 3, 2020, 12:05:05 PM", "content": ["Hi I am trying to run my UCE data with GHOST model, I used the -mrate to determine the best model, and proceeded with the analysis from there. But now I have an error that I am not sure how to solve: ratefree.cpp:539: double RateFree::optimizeWithEM(): Assertion `score > old_score-0.1' failed. Thank you Miles ", "Hi Miles, Thanks for the report. I believe this is a bug in -bnni option with GHOST model, because everything works well until this step. So CC Diep. For now please refraining from using this option with GHOST model. @Diep: let\u2019s have a meeting to discuss this. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/16d7d27f-bad0-4aeb-83da-dc368b59c9ef%40googlegroups.com <ghost.log> ", "Hi Minh, I'm getting the same error using MFP+LM with -S on a directory of alignments for separate tree inference. IQtree crashes on one particular alignment, but it doesn't seem to be a weird alignment. When I remove that particular alignment from the directory, IQtree crashes again because it can't resume without the full set of alignments. Would you recommend trying with -optalg BFGS ? I suppose I would have to re-start my run in that case? This is on IQtree 2.1.1 compiled on linux. Best wishes, Jake Berv ", "Hi Jake, What is the full command line you used? @Diep: Can you please confirm if this bug with -bnni option was fixed or not? Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/520174c5-5d40-4bb8-bd0c-b1af942768den%40googlegroups.com ", "Hi Minh\u2014 Initially, I used: /iqtree2 -S /all_loci -m MFP+LM -T 63 --prefix MFP_LM -B 1000 --safe This crashed on that previous error after a certain point, so I re-started from checkpoint with the additional -optalg BFGS flag. This got much farther \u2014 seemingly through model selection (after a few additional crashes and re-starts from checkpoint) \u2014 however it is now crashing on the final tree inference steps. I keep restarting it and it keeps giving me a segmentation fault error using v 2.1.1. Note that these data work fine with the regular -m MFP search. Might you advise that I redo the whole analysis with -optalg BFGS ? The model selection procedure took a while. WARNING: Numerical underflow for lh-branch WARNING: Numerical underflow for lh-branch ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: MFP_LM.log ERROR: *** Alignment files (if possible) Segmentation fault (core dumped) Best, Jake ", "Hi Jake, does it work in v1.6.12? (It\u2019s more stable, but slower). Minh ", "Hi Minh, It does not appear that I can duplicate this analysis in 1.6.12, because the -S option is not available. Best, Jake "]}, "GBVelrhCttw": {"topic": "Best way to evaluate results (combine vs compare) from 10 independent runs", "initializeDate": "Oct 19, 2020, 7:23:11 PM", "timeStamp": "Oct 23, 2020, 12:01:02 AM", "content": ["I am running 10 independent IQTREE runs, and was wondering if my results would be more accurate by picking the tree with the best log-likelihood value, or using the runs to build a consensus tree with support values? And if the later is better, what is the best way to do that? The section on this in the manual seems to be meant for building consensus trees from other programs. Should I be building a consensus off of the 10 consensuses for the 10 independent runs? Would that be enough to generate useful support values? Thank you ", "I found a relevant post by Tung Nguyen ( Best practices for IQ-TREE tree search ) \" Dear IQ-TREE users, For most alignments, the default setting for the tree search in IQ-TREE should work fine. However, sometimes you might need or simply want to fine tune the tree search to get the best results. Here I will provide some recommendations for improving the search. Because the number of possible trees is astronomically large, no tree search heuristic can guarantee the optimal tree. The so-called maximum likelihood tree that you get from any phylogenetic reconstruction program is in fact only an approximation of the ML tree. However, if you have a lot of data (very long alignment), the chance of getting the optimal tree is increased. If your alignment is short and have a lot of taxa (very little phylogenetic signal), finding the true ML tree could be very difficult. In any case, it is recommended to runs IQ-TREE several times and compare the tree log-likelihoods. If the log-likelihoods (and the tree topology) are all the same, then there is a high chance that you already have the optimal tree. If you observe a large variance among the log-likelihoods, you might need to run the tree search as many times as possible and take the best tree. The log file / screen output also gives you some indication about whether repeating the search many times is necessary. During the tree search, IQ-TREE samples a lot of locally optimal trees and produce a locally optimal tree in each iteration. The log-likelihood of the locally optimal trees are printed after every 10 iterations. If you want to see the log-likelihood of all locally optimal trees, turn on the flag -v (verbose). Toward the end of the search, if the log-likelihoods seem to converge (some iterations produce the same log-likelihood) then you might only need to repeat the search few more times. If they do not, you should repeat the search as many times as possible. The following options are also useful: -pers <proportion>: adjust the strength of the perturbation method, which helps IQ-TREE escape local optima. The default value is 0.5. If you think that the search does not converge, it is sensible to reduce the perturbation strength (e.g. -pers 0.1 or -pers 0.2) -numstop <number>: adjust the stopping rule. In the default setting, IQ-TREE will stop if it cannot find a new best tree in the last 100 iterations. You can increase this number to make IQ-TREE search more thoroughly (e.g. -numstop 500) -wt: write all locally optimal trees into .treels. This option might be useful if you want to take a look at the alternative trees. You can also build a consensus tree from these trees. Sometimes the consensus tree might have higher log-likelihood than the best locally optimal tree. Last but not least, large log-likelihood variance among IQ-TREE runs often means that your data does not contain enough phylogenetic signal. In such case, you have do some statistical tests to access the branch support (UFBoot, aLRT, standard bootstrap). With little data, even if the optimal tree could be found, it might still look very different from the true tree. \" ", "Hi Bio Student, The information you found is indeed very helpful. To your question, I wouldn\u2019t use the consensus tree of the runs, but just use the consensus tree of the bootstrap trees. This is a typical way of getting support values in phylogenetics. Whereas the values on the consensus tree of the different runs only showed the variation between the runs. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f62e07f9-fafb-4c99-b78a-e53f81a087f4n%40googlegroups.com "]}, "oNS9YfhhWPA": {"topic": "Limited support until the middle of April", "initializeDate": "Apr 6, 2021, 5:18:46 AM", "timeStamp": "Apr 6, 2021, 5:18:46 AM", "content": ["Dear All, I\u2019m on vacation in the next 2 weeks, so I won\u2019t support during that time. But I do hope that others in the development team will be able to answer questions. Cheers Minh "]}, "Z4BhjPivn80": {"topic": "ERROR: PoMo does not yet support frequency mixture models (+FMIX)", "initializeDate": "Oct 13, 2017, 10:23:32 AM", "timeStamp": "Oct 16, 2017, 4:49:44 PM", "content": ["Dear Minh, Running a dataset without partitioning, and adding models LG+C10\u2026\u2026\u2026 I get ERROR: PoMo does not yet support frequency mixture models (+FMIX). Don't even know what that refers to. Below I pasted the command and then end of the log file. There are also several models that were skipped. Thanks for all the help via this google group! Tauana Command: ../../scripts/IQ-Tree1.6.beta4/bin/iqtree -nt 25 -st AA -ninit 10 -bb 1500 -pre 52taxa -m MFP+MERGE -rcluster 10 -madd LG4M,LG4X,LG+C10,LG+C20,LG+C30,LG+C40,LG+C50,LG+C60 -mrate G,R,E -msub nuclear -s ../matrices/Concatenated_52taxa/52taxa_concatenated.nex ModelFinder will test 206 protein models (sample size: 36479) ... No. Model -LnL df AIC AICc BIC 1 Dayhoff+G4 1075129.489 146 2150550.977 2150552.159 2151792.633 \u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026just to summarize 186 Blosum62+R10 Skipped 187 Blosum62 1192770.895 145 2385831.790 2385832.955 2387064.941 \u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026 197 Blosum62+F+R10 Skipped 198 Blosum62+F 1194192.292 164 2388712.584 2388714.075 2390107.321 Model LG4M is alias for MIX{LG4M1,LG4M2,LG4M3,LG4M4}*G4 199 LG4M 1064766.367 146 2129824.735 2129825. 916 2131066 .390 Model LG4X is alias for MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4 200 LG4X 1059790.996 151 2119883.993 2119885. 256 2121168 .171 Model LG+C10 is alias for LG+POISSON+G+FMIX{C10pi1:1:0.1191344178,C10pi2:1:0.0874372456,C10pi3:1:0.1037105070,C10pi4:1:0.0922584809,C10pi5:1:0.1070492801,C10pi6:1:0.1329945166,C10pi7:1:0.0538028458,C10pi8:1:0.0691986212,C10pi9:1:0.1319937434,C10pi10:1:0.1024203429} ERROR: PoMo does not yet support frequency mixture models (+FMIX). ", "Dear Tauana, Thanks for the report! This error is indeed strange but I know why: it only occurs with the 1.6 beta version. I will tell my co-developer to fix it. For now please repeat this run using the stable version 1.5.5. @Dominik: It is because of the \u2026+POISSON\u2026 in the model name, which is incorrectly detected as PoMo model. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thanks Minh! I will download the 1.5.5 version and keep an eye out for the next release. Tauana ", "Also Minh, should I be worried that some models are being skipped? E.g. from the log file: 186 Blosum62+R10 Skipped And finally, I am now using the 1.5.5 MPI version, but it gave me an error because model selection is still not able to be parallelized with MPI. Is it parallelized in any way then? For my 1000 gene dataset searching among the mixture cat-like models, selection is taking quite a bit of time. Can I speed that up by increasing the number of cores? Thanks! Tauana ", "Hi Tauana, On Oct 15, 2017, at 10:50 PM, taua...@gmail.com wrote: Also Minh, should I be worried that some models are being skipped? E.g. from the log file: 186 Blosum62+R10 Skipped Nothing to worry here. While testing models, IQ-TREE saw that +R9 is worse than +R8, thus there is no point in increasing the number of rate categories further. Thus +R10 is skipped. And finally, I am now using the 1.5.5 MPI version, but it gave me an error because model selection is still not able to be parallelized with MPI. Is it parallelized in any way then? For my 1000 gene dataset searching among the mixture cat-like models, selection is taking quite a bit of time. Can I speed that up by increasing the number of cores? Have you used iqtree-omp version? This one utilizes multiple cores\u2026 Minh ", "Thanks! Yes, I am using iqtree-omp-mpi (but with 1 mpi process because of model selection limit) I just was not sure that increasing the number of cores is doing anything for model selection. If it is, I might increase it even more to see if that accelerates this part. ", "Hi Tauana, No need to use iqtree-omp-mpi here. Please try the iqtree-omp one! The MPI and OMP (OpenMP) are two different parallel approaches that should not be confused. The iqtree-omp version fully supports parallel model selection via -nt option. Cheers, Minh "]}, "9cuqHSQTpAA": {"topic": "GHOST questions", "initializeDate": "May 23, 2019, 10:12:23 AM", "timeStamp": "May 28, 2019, 11:01:30 PM", "content": ["Dear Developers, I am interested in the GHOST model, and I have several questions: 1. If ModelFinder doesn't choose GHOST as the best-fit model, can I use GHOST directly to conduct the comparative topology analysis 2. When I use H5 with my working dataset, there are five trees in .treefile (corresponding to five classes). I compared these trees, and found that they all have identical topologies. Now I am wondering whether that is a default, or whether there may be cases (datasets) that may produce different topologies among these five trees (classes). 3. We chose GHOST model as it is able to account for rate variation across sites and lineages, and we are primarily interested in attenuation the LBA topological artefacts. We used itol to parse the tree file automatically, so we did not realize that there are mutiple trees. We relied on the tree that itol automatically parsed. Therefore, we are wondering if this was a methodologically sound approach, given that all five of our topologies were identical. Best, Dong ", "Hi Dong, 1. Yes, you can of course choose to use the GHOST model is you wish, even if ModelFinder does not select it. ModelFinder uses BIC (by default) to choose the best-fit model, you may have reasons for not wanting to rely solely on BIC (or AIC or AICc) to choose your model, but you should be able to justify your decision. 2. All the trees have the same topology when we fit a GHOST model, only the branch lengths differ between classes (the \u2018ST\u2019 in GHOST stands for Single Topology). 3. I think I need more detail on exactly what you are asking here. I gather you fit a GHOST model to your dataset and obtained a .treefile with 5 trees (of identical topology). You then parsed this .treefile to some other program? Or do you parse it back to IQ-TREE. To carry out tree topology tests? If the latter, then of course there is no point doing this as the topologies within the .treefile are identical by definition. I hope that helps a bit, thanks for your interest in using GHOST and IQ-TREE, Stephen Stephen Crotty, PhD Centre for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC 5, Ebene 1 A-1030 Vienna, Austria Email: stephen...@univie.ac.at You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1c7eabed-c4c4-4b94-9384-cc5a4959ccb7%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Dear Stephen, We noticed that our *.contree contains a single tree (topology-wise) with four different branch length value sets. Now we are wondering how to interpret that result. Does it imply that all four trees (branch length sets) are equally probable? Or have we missed an additional analysis that may help us resolve this? As other method only have one branch length set. As regards the parsing problem that I mentioned, I used \"iTOL\" webpage ( https://itol.embl.de ) to parse the tree file, but iTOL didn't report there are mutiple trees. Instead it appears that it randomly parsed one of the trees without a warning. Now I am wondering whether this was a major methodological error on my side. Best, Dong \u5728 2019\u5e745\u670826\u65e5\u661f\u671f\u65e5 UTC+8\u4e0a\u53484:28:31\uff0cStephen Crotty\u5199\u9053\uff1a Hi Dong, 1. Yes, you can of course choose to use the GHOST model is you wish, even if ModelFinder does not select it. ModelFinder uses BIC (by default) to choose the best-fit model, you may have reasons for not wanting to rely solely on BIC (or AIC or AICc) to choose your model, but you should be able to justify your decision. 2. All the trees have the same topology when we fit a GHOST model, only the branch lengths differ between classes (the \u2018ST\u2019 in GHOST stands for Single Topology). 3. I think I need more detail on exactly what you are asking here. I gather you fit a GHOST model to your dataset and obtained a .treefile with 5 trees (of identical topology). You then parsed this .treefile to some other program? Or do you parse it back to IQ-TREE. To carry out tree topology tests? If the latter, then of course there is no point doing this as the topologies within the .treefile are identical by definition. I hope that helps a bit, thanks for your interest in using GHOST and IQ-TREE, Stephen Stephen Crotty, PhD Centre for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC 5, Ebene 1 A-1030 Vienna, Austria Email: stephe...@univie.ac.at On 23 May 2019, at 4:12 pm, \u5f20\u4e1c < dongzh...@gmail.com > wrote: Dear Developers, I am interested in the GHOST model, and I have several questions: 1. If ModelFinder doesn't choose GHOST as the best-fit model, can I use GHOST directly to conduct the comparative topology analysis 2. When I use H5 with my working dataset, there are five trees in .treefile (corresponding to five classes). I compared these trees, and found that they all have identical topologies. Now I am wondering whether that is a default, or whether there may be cases (datasets) that may produce different topologies among these five trees (classes). 3. We chose GHOST model as it is able to account for rate variation across sites and lineages, and we are primarily interested in attenuation the LBA topological artefacts. We used itol to parse the tree file automatically, so we did not realize that there are mutiple trees. We relied on the tree that itol automatically parsed. Therefore, we are wondering if this was a methodologically sound approach, given that all five of our topologies were identical. Best, Dong You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Dong, The four different branch lengths are because you used a GHOST model with four classes. So essentially you have one tree topology, but four different sets of branch lengths. These are not equally probable, each class will have its own weight assigned to it, which will sum to one. You can find these weights in the .iqtree file (I think they are called \"Heterotachy weights\u201d). With regards to parsing the tree file, if you are only interested in the topology then it doesn\u2019t matter, as all the topologies are the same. It might help you to read up on the GHOST model, it is quite different to fitting a single model in which you only infer one set of branch lengths. Here is a link to the paper https://www.biorxiv.org/content/10.1101/174789v2 Cheers, Stephen Stephen Crotty, PhD Centre for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC 5, Ebene 1 A-1030 Vienna, Austria Email: stephen...@univie.ac.at To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/01c642da-257c-420b-b560-eafc4f71965d%40googlegroups.com ", "Hi Stephen, I get it, thank you very much for your help. Sincerely, Dong \u5728 2019\u5e745\u670828\u65e5\u661f\u671f\u4e8c UTC+8\u4e0b\u53485:35:20\uff0cStephen Crotty\u5199\u9053\uff1a Hi Dong, The four different branch lengths are because you used a GHOST model with four classes. So essentially you have one tree topology, but four different sets of branch lengths. These are not equally probable, each class will have its own weight assigned to it, which will sum to one. You can find these weights in the .iqtree file (I think they are called \"Heterotachy weights\u201d). With regards to parsing the tree file, if you are only interested in the topology then it doesn\u2019t matter, as all the topologies are the same. It might help you to read up on the GHOST model, it is quite different to fitting a single model in which you only infer one set of branch lengths. Here is a link to the paper https://www.biorxiv.org/content/10.1101/174789v2 Cheers, Stephen Stephen Crotty, PhD Centre for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC 5, Ebene 1 A-1030 Vienna, Austria Email: stephe...@univie.ac.at "]}, "N_Op9crc5Cw": {"topic": "change -rcluster proportion after a long run crashed", "initializeDate": "Jul 13, 2016, 3:26:20 PM", "timeStamp": "Jul 14, 2016, 4:18:51 PM", "content": ["I have been trying to analyze a larga dataset, I used iqtree omp s nuk 20.fa q partscheme m TESTMERGE rcluster I tried to experiment a little so I thought maybe decreasing this number could help but I got this Command iqtree omp s nuk 20.fa q partscheme m TESTMERGE rcluster WARNING Command line argument `2` differs from checkpoint `10` Is there a way to do this since I concluded that trying to search at this deep is too computational intensive at the moment. Thanks ", "Dear Andres, I am a bit confused, but did iqtree crash or just print this warning? IQ-TREE always prints a warning if the rerunning command line is different from the checkpoint \u2014 It serves as information that the behavior of the run may change. In some cases it may cause crash. However, in this specific case (changing -rcluster parameter) I am quite sure that IQ-TREE will continue with the new parameter. So you can safely ignore this warning. Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Yes, in fact it just printed the warning but continued searching. Is iqtree using then the previous results stored or completely calculating new scenarios from the scratch? Thanks for your reply. Postdoctoral Associate Instituto de Cs Ambientales y Evolutivas Universidad Austral de Chile Campus Isla Teja s/n Valdivia, Chile ", "Hi Andres, iqtree will use the previous results and continue from the last stopped point. So no waste of computation time. Minh "]}, "lM9n2isvkBw": {"topic": "Problem building version 1.5.2 from source", "initializeDate": "Dec 6, 2016, 11:37:17 AM", "timeStamp": "Dec 7, 2016, 4:46:05 AM", "content": ["Hi, I am trying to compile IQ-TREE version 1.5.2 from source using the following command: # cmake -DIQTREE_FLAGS=omp -DCMAKE_C_COMPILER=/opt/gcc/4.8.2/bin/gcc -DCMAKE_CXX_COMPILER=/opt/gcc/4.8.2/bin/g++ .. This resulted in the following warning/error message: -- The C compiler identification is GNU 4.8.2 -- The CXX compiler identification is GNU 4.8.2 -- Check for working C compiler: /opt/gcc/4.8.2/bin/gcc -- Check for working C compiler: /opt/gcc/4.8.2/bin/gcc -- works -- Detecting C compiler ABI info -- Detecting C compiler ABI info - done -- Check for working CXX compiler: /opt/gcc/4.8.2/bin/g++ -- Check for working CXX compiler: /opt/gcc/4.8.2/bin/g++ -- works -- Detecting CXX compiler ABI info -- Detecting CXX compiler ABI info - done IQ-TREE flags : omp Builde mode : Release Target OS : Unix Compiler : GNU Compiler (gcc) Target binary : 64-bit OpenMP : Yes MPI : NONE Vectorization : SSE3/AVX/AVX2 C flags : -pthread -O3 -g CXX flags : -std=c++11 -fopenmp -pthread -O3 -g -- Looking for gettimeofday -- Looking for gettimeofday - found -- Looking for getrusage -- Looking for getrusage - found -- Looking for GlobalMemoryStatusEx -- Looking for GlobalMemoryStatusEx - not found -- Looking for strndup -- Looking for strndup - found CMake Warning at CMakeLists.txt:393 (find_package): By not providing \"FindBacktrace.cmake\" in CMAKE_MODULE_PATH this project has asked CMake to find a package configuration file provided by \"Backtrace\", but CMake did not find one. Could not find a package configuration file provided by \"Backtrace\" with any of the following names: BacktraceConfig.cmake backtrace-config.cmake Add the installation prefix of \"Backtrace\" to CMAKE_PREFIX_PATH or set \"Backtrace_DIR\" to a directory containing one of the above files. If \"Backtrace\" provides a separate development package or SDK, be sure it has been installed. -- Could NOT find Eigen3 (missing: EIGEN3_INCLUDE_DIR EIGEN3_VERSION_OK) (Required is at least version \"2.91.0\") -- Found ZLIB: /usr/lib64/libz.so (found version \"1.2.3\") Using system zlib -- Configuring done -- Generating done -- Build files have been written to: /share/git/IQ-TREE/build Please note that our compiler is in a custom location. I have also tried gcc 5.2.0 with the same result. make does not complain after this and builds a binary that seems to work. Now my question is: Should I be worried about the backtrace and Eigen warnings? Or can they be ignored and everything is fine? Thanks, Alex ", "Dear Alex, you can safely ignore this warning \u2014 currently IQ-TREE does not use the Eigen3 library. It is reserved for the future version but not the 1.5.X versions. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Thanks a lot! :-) alex "]}, "oPmvclTEMZk": {"topic": "ERROR: Tree file does not start with an opening-bracket '('", "initializeDate": "Jul 13, 2018, 3:34:19 PM", "timeStamp": "Jul 13, 2018, 3:34:19 PM", "content": ["Hey there, I have been trying to figure out why my tree files are not being read. When I run the trees individually with -z they seem to work, however, when I run the file that contains both trees I get: ERROR: Tree file does not start with an opening-bracket '(' I have attached my trees. Any help would be much appreciated! -Amber Trujillo "]}, "gvPYKhD7Qrc": {"topic": "IQ-TREE crashed with signal aborted during NNI search", "initializeDate": "Jan 19, 2021, 8:04:35 PM", "timeStamp": "Feb 10, 2021, 1:08:49 AM", "content": ["Hi there, I am trying to estimate a tree with constrained topology, however IQ-TREE crashes in the NNI search for the 20 best initial trees: -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Generating 99 parsimony trees... 1287.488 second Computing log-likelihood of 99 initial trees ... 1235.368 seconds Current best score: -512746.393 Do NNI search on 20 best initial trees lambda = -0.000 NEGATIVE BRANCH len = -0.001 rate = 2.830 with the error: ERROR: phylosupertreeplen.cpp:383: virtual void PhyloSuperTreePlen::computeFuncDerv(double, double &, double &): Assertion `0' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: constrained_.log ERROR: *** Alignment files (if possible) scripts/IQTREEconstrained_HPC_SANGER.sh: line 32: 33605 Aborted /home/jc454633/applications/iqtree-2.1.2-Linux/bin/iqtree2 -s ../3d_final-alignments_concat/concat_aln.fasta --prefix constrained_ -p ../3d_final-alignments_concat/partitions.txt -g ../pruned_constrain_concat_gene_part.tre -m MFP+MERGE -B 1000 -T AUTO I am running the analysis on a RHEL Linux cluster. I've tried re-running the analysis twice but the same error occurs. Any idea what the issue might be? Many thanks Lizzy ", "Hi Lizzy, Thanks for this bug report. This seems to be a rare issue, I never saw it happening before. I just checked the IQ-TREE code and the error message occurred within the partition model, that Olga Chernomor implemented. So Olga might be able to say something here? Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b92fdebe-253b-44ae-b4a6-cad324d10adan%40googlegroups.com ", "Dear Lizzy, I think, this assertion might have been raised due to numerical issues, rather than a bug in the software, but I\u2019ll have to investigate it in more details. Does your data have many missing sequences or very gappy alignment? Cheers, Olga To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CA%2B%2B-8MQPnnffby%2B4ZTrvsadFvY%3DOw%2BUKybm%2Bv74uiTK1bOZfkg%40mail.gmail.com ", "Hi Olga and Minh, Thanks very much for getting back to me. It is a gappy alignment, so this may be the issue. I will rerun the analyses with a different alignment and see if that fixes the issue. Many thanks, Lizzy "]}, "HTKpe6i4puY": {"topic": "IQ-TREE server down", "initializeDate": "Feb 21, 2018, 8:14:24 PM", "timeStamp": "Dec 15, 2018, 5:17:06 AM", "content": ["Dear All, The web server hosting http://www.iqtree.org and http://iqtree.cibiv.univie.ac.at is temporarily down. We are working to resolve it and sorry for the inconvenience. There are alternatives in case you want to: - Download the binaries: https://github.com/Cibiv/IQ-TREE/releases/latest - Look at the documentation: https://github.com/Cibiv/IQ-TREE/wiki - Perform online computation: https://www.hiv.lanl.gov/content/sequence/IQTREE/iqtree.html or from the CIPRES portal ( https://www.phylo.org ) which additionally supported IQ-TREE since last December. Cheers, Minh ", "Can someone please tell me why all I can get is \"waiting\" when submitting data to run in IQTree. Is the server down? Thanks ", "Hi there, Thank you for letting us know. I\u2019m forwarding your email to the system admin. Note that it\u2019s weekend, so pls expect delay. In the mean time, use other solutions that you quoted. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "ElmgS9jbm9U": {"topic": "ERROR: #leaves and taxa_set do not match!", "initializeDate": "Mar 21, 2017, 3:50:49 PM", "timeStamp": "Mar 22, 2017, 1:38:20 PM", "content": ["I have a large alignment 25 MB available on my google drive link https://drive.google.com/open?id=0Bx0HgkEiulBtWkU3NUJjQl9pQnc Some loci/ are missing for some taxa. iqtree-omp -s iq_tree_rhynch.nex -spp charset_iq_tree.nex -m TESTNEWMERGE -rcl uster 10 -mtree -bb 1000 -wbtl -nstep 200 -bspec GENESITE -nt 6 -t PARS Cheers Chris ", "Dear Chris, this is a relatively old version (1.3.11). Thus can you please test the latest IQ-TREE version and let me know whether it works? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <charset_iq_tree.nex.log> <charset_iq_tree.nex> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "O3-qO3BF9Ww": {"topic": "Re: [iqtree] BUG: -mem option not wirking & question of \"speed\" again", "initializeDate": "Mar 1, 2021, 9:28:33 PM", "timeStamp": "Mar 3, 2021, 7:36:37 AM", "content": ["Hi Karen, On 1 Mar 2021, at 8:14 pm, 'kmeus...@ googlemail.com ' via IQ-TREE < iqt...@googlegroups.com > wrote: Dear Minh, 1) -mem option: are there plans to make it work on mixture models & partition models? I today tried with a dataset using mixture models, but it failed. or is there another problem? I thought that -mem only does not work on the -spp model? command: .../iqtree-1.6.12-Linux/bin/iqtree -s alignment.fas -mem 100G -st AA -m JTTDCMut+C60+FO+R5 -pre BS00_49_strict_mixmod -nt AUTO -gmedian -t RANDOM -bo 50 -safe; ERROR: phylotree.cpp:5216: bool PhyloTree::computeTraversalInfo(PhyloNeighbor *, PhyloNode *, double *&): Assertion `0 && \"No free/unlocked mem slot found!\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: BS00_49_strict_mixmod.log ERROR: *** Alignment files (if possible) -mem option is supposed to work with mixture models. This is the case here. So can you send me the log file? If you run without -mem, how much RAM does IQ-TREE requirement? It could be that -mem 100G is too restrictive, and in such case, it should say so, instead of assertion. So does it work, if you increase to, say, -mem 200G? 2) the partition-specific rates in the log file are the same like the speed value in the iqtree file correct? (slight difference due to rounding? from an earlier post: \"Speed column is exactly as you asked: it is the partition specific rate. They are computed by maximum likelihood. The rates are normalized such that the weighted average is 1, where the weights are the partition alignment length divided by supermatrix length.\" Yes, see an earlier reply. Minh Best, Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f232b315-9e63-488a-bd66-43c944aedfe2n%40googlegroups.com ", "Dear Minh, see in between the lines :) Minh Bui schrieb am Dienstag, 2. M\u00e4rz 2021 um 03:28:33 UTC+1: Hi Karen, On 1 Mar 2021, at 8:14 pm, 'kmeus...@ googlemail.com ' via IQ-TREE < iqt...@googlegroups.com > wrote: Dear Minh, 1) -mem option: are there plans to make it work on mixture models & partition models? I today tried with a dataset using mixture models, but it failed. or is there another problem? I thought that -mem only does not work on the -spp model? command: .../iqtree-1.6.12-Linux/bin/iqtree -s alignment.fas -mem 100G -st AA -m JTTDCMut+C60+FO+R5 -pre BS00_49_strict_mixmod -nt AUTO -gmedian -t RANDOM -bo 50 -safe; ERROR: phylotree.cpp:5216: bool PhyloTree::computeTraversalInfo(PhyloNeighbor *, PhyloNode *, double *&): Assertion `0 && \"No free/unlocked mem slot found!\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: BS00_49_strict_mixmod.log ERROR: *** Alignment files (if possible) -mem option is supposed to work with mixture models. This is the case here. So can you send me the log file? its attached here - or shall I sed it to an email address? (which one)? If you run without -mem, how much RAM does IQ-TREE requirement? It could be that -mem 100G is too restrictive, and in such case, it should say so, instead of assertion. So does it work, if you increase to, say, -mem 200G? It seems to need I think 170 GB RAM - currently I have no opportunity to more than ca. 100 GB RAM, so others doing for me now the analyses, so I cannot/could not try it out. Anyway, I also did not understand the error message. 2) the partition-specific rates in the log file are the same like the speed value in the iqtree file correct? (slight difference due to rounding? great thanks a lot!!!! (still no idea why my posts on monday got deleted from this googlegroup although subscribed... Best, Karen "]}, "0Q-bmz8hxzQ": {"topic": "v1.5.5 Likelihood support value", "initializeDate": "Nov 16, 2017, 11:06:54 AM", "timeStamp": "Dec 4, 2017, 2:58:06 PM", "content": ["Dear All, This may seems like the question of the guy who missed one episode: Moved from version 1.5.3 to 1.5.5, I cannot get the software to output likelihood branch support values on a treefile obtained from a single tree calculation, whatever the model chosen (i tried only with protein models). Is this a normal behavior? Is there a new parameter that I should know about? Thanks in advance. Philippe. ", "Hi Philippe, These 2 versions should be fully compatible, all options are supposed to behave the same (except for newly added options of course). Can you be more specific, like which command line did you used? What do you mean by \u201clikelihood branch support\u201d? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Thank you for your quick answer, and sorry for my delayed one. I'll try to be more specific. Let's say I run a single tree calculation with parameters LG+I+G. Iqtree will perform a single best tree search and will stop when reaching the max log Likelihood score during this run. The .treefile used to display branch lengths and supports, which I suppose is the likelihood that the branch is true given the data under the chosen model. So, I used to have these two values with version 1.5.3, and now with version 1.5.5, i only get branch lengths. Then my question was, is it expected? Thanks again. Philippe. ", "Dear Philippe, To do so you need to specify branch support methods, such as standard bootstrap (-b option), ultrafast bootstrap (-bb), and approximate likelihood ratio test (-alrt). I think you didn\u2019t use these options, thus only maximum likelihood tree search is performed. Cheers, Minh "]}, "HcCs2av2-EM": {"topic": "Morphological alignments", "initializeDate": "Mar 30, 2021, 8:31:36 AM", "timeStamp": "Apr 1, 2021, 9:54:37 AM", "content": ["Hi, I am using IQ-tree for analysis of morphological alignments (which are mentioned on p. 33 of the tutorial). It appears that there is a limit of possible states (10 digits +22 letters i.e. 32) when making a PHYLIP file. Can any other format than PHYLIP be used for this purpose? I will greatly appreciate an advice. Best regards, Ewa ", "Hi Ewa, No, it\u2019s not possible. However, please note that with very many state model, you will need a lot of data for ML estimates, which is not common in morphological data. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d58b07df-e43b-4237-b5aa-c512bd722c81n%40googlegroups.com ", "Hi, many thanks for the answer! Ewa "]}, "izn2fGd6OsY": {"topic": "quartet mapping from pre-defined groups", "initializeDate": "Sep 8, 2016, 3:24:35 AM", "timeStamp": "Sep 9, 2016, 7:26:28 AM", "content": ["Hi Minh, first, quartet mapping works very well, thank you and Heiko again for implementing this. Anyway, I was wondering if there can be an option added to switch of the final treesearch? (at least in my case, I just need the quartet mapping results and I am doing some permutations for comparison (phylogenetic signal destroyed) - that causes numerical underflow and often just leads to a crash in IQtree (however, I am not surpised because the dataset doen not contain phyl. signal anymore) - also negative loggLH values leads to a crash (Anyway, mldist & bioNJ tree are quite useful - but maybe also could be invoked as option not as default? This is not urgent but maybe a thing to consider in the next version? Best, Karen ", "Hi Karen, On Sep 8, 2016, at 9:24 AM, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Hi Minh, first, quartet mapping works very well, thank you and Heiko again for implementing this. great to hear! Anyway, I was wondering if there can be an option added to switch of the final treesearch? yes there is already, \"-n 0\" will skip tree search. (at least in my case, I just need the quartet mapping results and I am doing some permutations for comparison (phylogenetic signal destroyed) - that causes numerical underflow and often just leads to a crash in IQtree (however, I am not surpised because the dataset doen not contain phyl. signal anymore) - also negative loggLH values leads to a crash (Anyway, mldist & bioNJ tree are quite useful - but maybe also could be invoked as option not as default? and there is also such a hidden option, -djc will skip ML distance and BioNJ tree. Minh This is not urgent but maybe a thing to consider in the next version? Best, Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, thanks - absolutely perfect :))) (did miss or couln't find that in the documentation - if its missing can you add a little note in the manual? Best Karen ", "Hi Minh, me again: I tried -n 0 but then mldist and bioNJ are also NOT done (would be still useful though). I also try now -djc just to see what happens plus --wql... thanks in advance, best Karen Am Donnerstag, 8. September 2016 09:24:35 UTC+2 schrieb Karen Meusemann: ", "Hi Minh, thanks for the advice, -te BIONJ worked :) Best, Karen ", "Hi Minh & all, sorry to bother again. We have some tests datasets, testing for signal coming from non-phylogenetic bias: here the datasets crash either with -n 0, -te BIONJ or -wql... I have send you dataset(s) seperately via email. Any help appreceaited like always :) Best Karen "]}, "VDq3S18dZ3I": {"topic": "ERROR: Expecting ';' to terminate TAXLABELS command, but found Sobic.001G413900 instead", "initializeDate": "Mar 5, 2019, 8:41:41 PM", "timeStamp": "Mar 6, 2019, 2:21:36 AM", "content": ["Dear members, I used a nexus file exported from MEGA7 after alignment by MUSCLE. I am experiencing this problem. Can you please advise/help me what might be wrong? I removed the sequence mentioned in the error and tried another time but the system again shows the same error with some other gene ID and continues to do so. This job STOPPED because there was a problem! ERROR: ERROR: Error found at line 157, column 1 (file position 4425): ERROR: Expecting ';' to terminate TAXLABELS command, but found Sobic.001G413900 instead (For further information, please check the Run Log by selecting the corresponding tab above.) ", "Hi there, I think the error message speaks by itself. Please note that Nexus file is not recommended. Better use Fasta or Phylip format, which is simpler and faster to read. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "v2WXghNMOys": {"topic": "Calculating site log likelihood after already estimated tree (-wsl)", "initializeDate": "Aug 27, 2018, 7:09:06 PM", "timeStamp": "Aug 30, 2018, 12:04:16 PM", "content": ["Dear Minh, I just launched a couple jobs to search for best model (among LG+CXX) and infer a tree with a constraint (-g). I also added the -wsl flag to calculate the site log likelihoods. However, I had already run IQTREE unscontrained a while ago, and just want to calculate the site likelihoods to compare with the constrained analyses. Is it possible to use the results of my unconstrained search with the alignment to just calculate the likelihoods, without inferring the tree again, while also using the model selection results? Thanks! Tauana ", "Hi Tauana, You can just input a user tree with -te option, which will fix the tree topology and just compute estimate branch lengths and model parameters. This can be combined with -wsl option. You can also use option -z to input a bunch of trees and compute their log-likelihoods and do tree test. I think this tutorial is quite close to what you described: http://www.iqtree.org/doc/Advanced-Tutorial#testing-constrained-tree Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "wzAtV9EufwY": {"topic": "Clarification about \"Temporarily disable AU test due to unresolved numerical issue when bp-rell are all zeros\"", "initializeDate": "Sep 6, 2018, 3:38:53 PM", "timeStamp": "Sep 6, 2018, 11:27:42 PM", "content": ["I read that in version 1.6.7: \"Temporarily disable AU test due to unresolved numerical issue when bp-rell are all zeros\" Does this mean that the AU test is _only_ affected in version 1.6.7 or does this occurs in previous versions ? JP Flandrois LBBE-UMR5558 Lyon, France ", "Hi JP again, Unfortunately this affects earlier versions, when a tree has significantly worse log-likelihoods than the ML tree but the AU test does not return ~0 p-value, because it cannot do the inverse of 0. When the trees do not show much lower likelihoods, then AU p-values can be computed more reliably. So the implementation in IQ-TREE is not entirely buggy, it\u2019s just unclear how the CONSEL author resolved this edge case and that\u2019s why I decided to disable the AU test. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "XyBEqncO1qY": {"topic": "ERROR: File not found JTTDCMut", "initializeDate": "May 10, 2019, 4:11:39 PM", "timeStamp": "May 11, 2019, 4:57:21 AM", "content": ["Dear Minh, I'm trying to run an iqtree analysis of this dataset using the command line below: iqtree -spp partition.nex -bb 1000 -alrt 1000 When the analysis start, the following error appears: ERROR: File not found JTTDCMut It seem that the program is not recognizing the AA models in my dataset, because when I replace the \"JTTDCMut\" model by another one (e.g. TIM+F+I+G4) the error that the program shows is: ERROR: File not found mtMAM+I+G4 Finally, when I replace all the AA models by DNA ones, the program runs the analysis normally. Do you know how to fix this problem? Regards, Caio Gueratto ", "Hi Caio, Because your alignment contains DNA sequences. The Nexus file says: FORMAT DATATYPE=DNA FORMAT DATATYPE=DNA GAP=- MISSING=? ; Do you have coding sequences in these partitions? Are they in frame? If yes, you can do the following: 1. Convert Nexus alignment to phylip or fasta format and use the converted file instead. This is to avoid enforcing DNA datatype. 2. Modify partition file as follows: #nexus begin sets; charset part1 = concatenadas_sem_varios_terminais_08_05_19.nex: 1-429; charset part2 = concatenadas_sem_varios_terminais_08_05_19.nex: 430-813; charset part3 = concatenadas_sem_varios_terminais_08_05_19.nex: 814-1787; charset part4 = concatenadas_sem_varios_terminais_08_05_19.nex: NT2AA, 1788-2429; charset part5 = concatenadas_sem_varios_terminais_08_05_19.nex: NT2AA, 2430-2999; charset part6 = concatenadas_sem_varios_terminais_08_05_19.nex: NT2AA, 3000-3308; charset part7 = concatenadas_sem_varios_terminais_08_05_19.nex: 3309-3764; charset part8 = Teste_01.phy: CODON, 1-126; charpartition mine = TIM+F+I+G4:part1,TVM+F+G4:part2,TN+F+I:part3,JTTDCMut+G4:part4,mtMAM+I+G4:part5,Dayhoff+I:part6,TIM2+F+I+G4:part7,MK+FQ+G4:part8; end; That means, insert NT2AA for protein partitions and CODON for codon partitions. NT2AA tells IQ-TREE to translate DNA into protein sequences using the universal genetic code. If you have other genetic code, append its ID to this keyword: http://www.iqtree.org/doc/Substitution-Models#codon-models Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/021e8853-a210-4be6-bb35-f1fe5132b29e%40googlegroups.com For more options, visit https://groups.google.com/d/optout <concatenadas_sem_varios_terminais_08_05_19.nex> <partition.nex> <Teste_01.phy> "]}, "SzKCrDCv8OM": {"topic": "IQ-TREE output PAML compatible, i.e. Is it possible to save the gamma shape parameter of an IQ-TREE run?", "initializeDate": "Jul 19, 2017, 4:52:57 PM", "timeStamp": "Jul 21, 2017, 2:01:46 PM", "content": ["Hi, I am currently using IQ-TREE on several systems. I am aware that the new beta version of IQTREE can calculate ancestral sequences, but I would like to know if it is possible to use the IQ-TREE output for PAML ASR. For this I would need the estimated gamma shape parameter (alpha). While PhyML writes these statistics in a file, I am currently not seeing an option for this in IQ-TREE. Am I being blind or is there currently no option of saving these statistics in an output file? Thanks in advance, Marc ", "Dear Marc, This is written in .iqtree file, something like: Model of rate heterogeneity: Gamma with 4 categories Gamma shape alpha: 0.5639 Category Relative_rate Proportion 1 0.04576 0.25 2 0.2916 0.25 3 0.8617 0.25 4 2.801 0.25 Relative rates are computed as MEAN of the portion of the Gamma distribution falling in the category. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, thanks a lot, I must have been blind when looking through the .iqtree file, or by accident looked through one of the files where I used free rates. -Marc "]}, "zyIZtOEw1MY": {"topic": "Continuous characters", "initializeDate": "Oct 30, 2018, 10:04:45 PM", "timeStamp": "Oct 31, 2018, 9:45:17 PM", "content": ["Is there a way, or would it be possible, to analyze continuous characters under maximum likelihood in IQTREE? A few older programs will utilize the code and methods of Felsenstein (e.g. Contml in PHYLIP) but I've yet to find any more modern tools. ", "Hi Russell, Thanks for your interest. However, models for continuous characters are not available in IQ-Tree because such data seem not abundant\u2026 we focus on molecular data, thus discrete characters. If you have data and think that would be useful, we can implement but then a co-authorship is required because such an implementation is obviously not trivial. Cheers Minh On 31 Oct 2018, at 1:04 pm, Russell Minton < mint...@gmail.com > wrote: Is there a way, or would it be possible, to analyze continuous characters under maximum likelihood in IQTREE? A few older programs will utilize the code and methods of Felsenstein (e.g. Contml in PHYLIP) but I've yet to find any more modern tools. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "RhTPHzAEX8o": {"topic": "Identical sequences", "initializeDate": "Oct 9, 2020, 2:32:51 PM", "timeStamp": "Oct 10, 2020, 7:15:43 PM", "content": ["Hi, I've just started using iqtree, and I like many of its features a lot, including the one that deals with identical sequences. However, the output is a bit confusing. I get two types of messages from the same analysis. One identifies identical sequences, but says that they are retained. e.g.: MN012068_Nanorana_cf_blanfordii is identical to MN012072_Nanorana_cf_blanfordii but kept for subsequent analysis. And in fact, these two identical sequences are written to the \"uniqueseq\" file. The other type of message says that identical sequences are added at the end. e.g.: NOTE: MN012181_Nanorana_sp (identical to MN012178_Nanorana_sp) is ignored but added at the end Can you explain the difference? Thanks, Dave ", "Hi Dave, I believe this question was asked some time ago, but I faster write an answer here before looking up the forum. Among a group of identical sequences, IQ-TREE will keep the first two and ignore the rest. If the sequence is the 2nd one, it will be \u201ckept for subsequent analysis\u201d. If it is the 3rd or more, it will be \u201cignored but added at the end\u201d. The rationale for this is to still be able to calculate the bootstrap support for this group of identical sequences: it is not always 100%. Because by bootstrap resampling, on average only two third of the sites will be present in a bootstrap alignment (due to sampling with replacement), and suddenly another sequence not in this group may actually become identical to this group of sequences. In that case, the bootstrap value will be < 100%. Does that answer your question? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ec583741-7026-4259-adff-cfcaa987bc09n%40googlegroups.com "]}, "t2ynJNjcTbw": {"topic": "Specifying models for model testing but ignoring proportion of invariable sites (+I)?", "initializeDate": "Dec 21, 2017, 9:25:20 PM", "timeStamp": "Jan 16, 2018, 12:16:40 AM", "content": ["Hi, I would like to use IQ-TREE as part of a pipeline whereby I test for the best partitioning scheme, and for the best substitution model for each partition, and then estimate the ML tree. I also want to restrict the list of substitution models to be tested to the following: JC,TN93,K80,F81,HKY,GTR,JC+G4,TN93+G4,K80+G4,F81+G4,HKY+G4,GTR+G4. I used the following command: ./iqtree-omp -s alignment.phy -spp partitions.nex -m TESTMERGE -mset JC,TN93,K80,F81,HKY,GTR,JC+G4,TN93+G4,K80+G4,F81+G4,HKY+G4,GTR+G4 -nt AUTO This command works, except it also tests each different model with the +I option to account for a proportion of invariable sites. I don't want to incorporate +I. Is there a different command to do this? I could run it without estimating a tree and then choose the best model without +I for each partition, but this is time consuming and I'd prefer not to, if possible, because I'll be doing this for many data sets. Thanks, Charles ", "Hi Charles, The quick answer is: -mset JC,TN93,K80,F81,HKY,GTR -mrate E,G See http://www.iqtree.org/doc/Command-Reference#automatic-model-selection -mrate Specify a comma-separated list of rate heterogeneity types for model selection. DEFAULT: -mrate E,I,G,I+G for standard procedure, -mrate E,I,G,I+G,R for new selection procedure . (E means Equal/homogeneous rate model). Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Great, thanks for your help! Charles "]}, "e4Mja_Y1kaw": {"topic": "Re: [iqtree] Do you make a partition model file (example.nex) manually?", "initializeDate": "Jul 14, 2018, 8:11:59 AM", "timeStamp": "Jul 14, 2018, 8:11:59 AM", "content": ["Hi HT, This is not that big data set. To speed up you can use strong computer with many CPU cores and use -nt option to specify the number of cores. Moreover, I don\u2019t see the point why you wanted to run ModelFinder for each gene separately. You can prepare a partition nexus file like you wrote but without `charpartition` command. Then run something like: -s ALIGNMENT -spp PARTITION_FILE -m MFP This will do the first step you did manually (find best-fit model for each partition) and then tree search. You can look at .best_scheme.nex file to see the best partition model. Possibly you should do -m MFP+MERGE, which possibly merge partitions to improve model fit. See a bunch of options to speed this up here: http://www.iqtree.org/doc/Command-Reference#automatic-model-selection (e.g. -rcluster option). Cheers Minh On 12 Jul 2018, at 4:50 pm, Hyoung Tae Kim < rlad...@gmail.com > wrote: #nexus begin sets; charset part1=1-838; charset part2=839-1749; charset part3=1750-2409; charset part4=2410-3555; charset part5=3556-4244; charset part6=4245-5139; charset part7=5140-5976; charset part8=5977-6665; charset part9=6666-7851; charset part10=7852-8667; charset part11=8668-9215; charset part12=9216-10184; charset part13=10185-11003; charset part14=11004-11750; charset part15=11751-12693; charset part16=12694-13057; charset part17=13058-14008; charset part18=14009-14623; charset part19=14624-15250; charset part20=15251-16070; charset part21=16071-16843; charpartition mine=F81+R2:part1,HKY+R2:part2,K3Pu+I:part3,TIM+R2:part4,HKY:part5,K3Pu+G4:part6,K3Pu+G4:part7,K3Pu:part8,HKY+G4:part9,HKY+R2:part10,F81:part11,K3Pu+G4:part12,K2P:part13,HKY+G4:part14,K3P:part15,K3Pu+G4:part16,HKY+G4:part17,HKY:part18,HKY+G4:part19,HKY+I:part20,HKY+I:part21; end; I used modelfinder for each gene and got a *.phy.iqtree file. Then I opened *.phy.iqtree files and checked the best fit model for each gene. But, it seems to take a long time when I have a number of genes. Is there any fast way to get a same result? Sincerely, You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "LcT8kaTAWCg": {"topic": "Qmaker implemented for mixture models?", "initializeDate": "Mar 4, 2020, 2:58:50 PM", "timeStamp": "May 11, 2020, 10:15:05 AM", "content": ["Hi Minh, Is the Qmaker protocol implemented in such a way that one can use site-heterogeneous mixture models? That is, can I estimate the best Q-matrix under C60 + Gamma model? Sincerely Andrew ", "Hi Andrew, Thanks for checking out the QMaker ms. Right now, I\u2019d say combining GTR20 with C60 models does not work as one might expect. Because GTR20+C60 will actually invoke a mixture model with 60 unlinked GTR20 rate parameters, one for each of the 60 mixture components. So you will have 60*190 separate parameters, which are ways over-parameterized for most dataset. Dominik implemented a version of IQ-TREE where one can link the GTR parameters between mixture component, but this is in a separate development branch. He and I will merge the 2 versions in the coming weeks. I will let you know once done. Does that answer your question? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5760ab20-9c0b-4b0d-9883-d9eaa3b4e5ae%40googlegroups.com ", "Hi Minh, Yes that answers my question! Looking forward to that option (linked GTR20 across mixture classes). Cheers Andrew On Thursday, March 5, 2020 at 9:48:52 PM UTC-4, Minh Bui wrote: Hi Andrew, Thanks for checking out the QMaker ms. Right now, I\u2019d say combining GTR20 with C60 models does not work as one might expect. Because GTR20+C60 will actually invoke a mixture model with 60 unlinked GTR20 rate parameters, one for each of the 60 mixture components. So you will have 60*190 separate parameters, which are ways over-parameterized for most dataset. Dominik implemented a version of IQ-TREE where one can link the GTR parameters between mixture component, but this is in a separate development branch. He and I will merge the 2 versions in the coming weeks. I will let you know once done. Does that answer your question? Minh On 5 Mar 2020, at 6:58 am, Andrew Roger < andrew...@gmail.com > wrote: Hi Minh, Is the Qmaker protocol implemented in such a way that one can use site-heterogeneous mixture models? That is, can I estimate the best Q-matrix under C60 + Gamma model? Sincerely Andrew You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Andrew, great to hear that linked exchangeabilities are of interest to you! If you want to try this feature out right away, you can build the branch https://github.com/Cibiv/IQ-TREE/tree/linked_models ! This branch is very up to date and offers a flag --link-exchangeabilities. For example, iqtree -s $alignment -m \"GTR20+C60+G4\" -link-exchangeabilities However, it is an experimental feature, and bugs may occur (although I didn't encounter any obvious bug during my analyses). Best, Dominik Andrew Roger < andrew...@gmail.com > writes: > Hi Minh, > Yes that answers my question! Looking forward to that option (linked GTR20 > across mixture classes). > Cheers > Andrew > On Thursday, March 5, 2020 at 9:48:52 PM UTC-4, Minh Bui wrote: >> Hi Andrew, >> Thanks for checking out the QMaker ms. Right now, I\u2019d say combining GTR20 >> with C60 models does not work as one might expect. Because GTR20+C60 will >> actually invoke a mixture model with 60 unlinked GTR20 rate parameters, one >> for each of the 60 mixture components. So you will have 60*190 separate >> parameters, which are ways over-parameterized for most dataset. >> Dominik implemented a version of IQ-TREE where one can link the GTR >> parameters between mixture component, but this is in a separate development >> branch. He and I will merge the 2 versions in the coming weeks. I will let >> you know once done. >> Does that answer your question? >> Minh >> On 5 Mar 2020, at 6:58 am, Andrew Roger < andrew...@gmail.com <javascript:>> >> wrote: >> Hi Minh, >> Is the Qmaker protocol implemented in such a way that one can use >> site-heterogeneous mixture models? That is, can I estimate the best >> Q-matrix under C60 + Gamma model? >> Sincerely >> Andrew >> -- >> You received this message because you are subscribed to the Google Groups >> \"IQ-TREE\" group. >> To unsubscribe from this group and stop receiving emails from it, send an >> email to iqt...@googlegroups.com <javascript:>. >> To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5760ab20-9c0b-4b0d-9883-d9eaa3b4e5ae%40googlegroups.com >> < https://groups.google.com/d/msgid/iqtree/5760ab20-9c0b-4b0d-9883-d9eaa3b4e5ae%40googlegroups.com?utm_medium=email&utm_source=footer >> . ", "Hi Dominik, Thanks for this. We will try it asap. One question -- will this feature work for linking GTR matrices with fewer states (i.e. not just GTR20, but ones where the data have 2-19 different states?) Sincerely Andrew ", "Hi Andrew, I just wanted to let you know that we are working on improving the maximum likelihood search with linked exchangeabilities. At the moment, we still encounter some difficulties, and kindly ask you for a little more patience until the issues are resolved. Best, Dominik Andrew Roger < andrew...@gmail.com > writes: > Hi Dominik, > Thanks for this. We will try it asap. > One question -- will this feature work for linking GTR matrices with fewer > states (i.e. not just GTR20, but ones where the data have 2-19 different > states?) > Sincerely > Andrew > On Sunday, March 8, 2020 at 7:41:46 AM UTC-3, Dominik Schrempf wrote: >> Hi Andrew, >> great to hear that linked exchangeabilities are of interest to you! If you >> want >> to try this feature out right away, you can build the branch https://github.com/Cibiv/IQ-TREE/tree/linked_models ! This branch is very >> up to >> date and offers a flag --link-exchangeabilities. For example, >> iqtree -s $alignment -m \"GTR20+C60+G4\" -link-exchangeabilities >> However, it is an experimental feature, and bugs may occur (although I >> didn't >> encounter any obvious bug during my analyses). >> Best, >> Dominik ", "Hi Dominik, Great! No worries! Cheers "]}, "6Dz18VQApHo": {"topic": "config files for iqtree?", "initializeDate": "Nov 1, 2020, 5:22:40 PM", "timeStamp": "Nov 2, 2020, 9:33:12 PM", "content": ["Is there some way to give the commands to iqtree via config file? ", "Hi there, No, everything is via command line. Minh On 2 Nov 2020, at 9:22 am, Bio Student < nege...@gmail.com > wrote: Is there some way to give the commands to iqtree via config file? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9349562e-fdc9-4d6d-a08b-c439d7e16d9bn%40googlegroups.com "]}, "bgDvFxaLtoM": {"topic": "Tree Topology tests c-ELW values", "initializeDate": "Jan 9, 2018, 8:34:10 AM", "timeStamp": "Jan 12, 2018, 12:01:16 PM", "content": ["Hello, I would like to know more details regarding c-ELW values and the calculation of confidence set of trees. If there were some trees with very low ELW values, which tree is rejected and how is the ranking order defined. As an example if 4 tree topologies are tested and the elw values are as follows T1 is 0.8523 T2 is 0.0303 T3 is 0.0871 T4 is 0.0303 which tree would be rejected, T2 or T4, if both of them have same likelihood values while T1 is the best tree with highest likelihood. How is the decreasing order defined if two trees have same elw values and if the corresponding likelihood values are also same.How IQ-Tree assigns the \"-\" sign for tree models with same elw values. Thank you. ", "Dear Aditya, > I would like to know more details regarding c-ELW values and the calculation of confidence set of trees. If there were some trees with very low ELW values, which tree is rejected and how is the ranking order defined. To explain the whole method how would take too long here. I would like to refer you either to the ELW paper or the \u201cTesting Tree Topologies\u201d in \u201cThe Phylogenetic Handbook\u201d where I tried to explain it graphically. However, using randomisation ever tree gets a weight (where the weights of all trees add up to 1.0). Then the trees are ordered by their weights. Although some weights might look identical, in reality they rarely are (unless you used identical trees). So the printed (and thus rounded) weights may differ beyond the printed precision. Then you collect all trees until the summed-up weights reach 95%, and all those which are in are called the 95% confidence set. > As an example if 4 tree topologies are tested and the elw values are as follows > T1 is 0.8523 > T2 is 0.0303 > T3 is 0.0871 > T4 is 0.0303 > which tree would be rejected, T2 or T4, if both of them have same likelihood values while T1 is the best tree with highest likelihood. If the two really have the same likelihood and weight, I would rather check if the tree topologies are identical, because this should not happen and then remove all but one of them. A second possibility might be that you have identical sequences (or such that only differ by wildcards) in there, and than the programme (actually no programme) can tell the difference in likelihood. If these occur on the boundary of the confidence set, it might be better to remove the identical sequence except one and work with the reduced dataset. Identical sequences will end up anyway on the same subtree separated by near-zero branch lengths. > How is the decreasing order defined if two trees have same elw values and if the corresponding likelihood values are also same.How IQ-Tree assigns the \"-\" sign for tree models with same elw values. As mentioned above, the question is whether the values of the trees are really identical. And even if you have several trees with (almost) identical ELWs around the cutoff, one has to treat them with care anyway. In the ideal case you have very few trees with pretty high ELWs and the low ones don\u2019t even get close to the cutoff level. I hope that helps a bit. Best regards, Heiko ", "Dear Heiko, Thank you very much for the quick response and detailed explanation for all my questions. Actually I am interested in the trees which are not falling into the cut-off values. So, order of the elw values would affect which trees would be rejected. Is there a possibility where I can see the precision of the ELW values to make a clear inference. thank you, Best Regards, Aditya ", "Hi Aditya, On Jan 9, 2018, at 7:27 PM, aditya kumar < adina...@gmail.com > wrote: Dear Heiko, Thank you very much for the quick response and detailed explanation for all my questions. Actually I am interested in the trees which are not falling into the cut-off values. So, order of the elw values would affect which trees would be rejected. Yes the order will affect which trees being rejected, but only for the one tree at the margin of the 95% confidence set. Is there a possibility where I can see the precision of the ELW values to make a clear inference. No that\u2019s not possible unfortunately. The precision of 4 is hard-coded when writing .iqtree file. Minh thank you, Best Regards, Aditya You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Thank you very much. Best Regards, Aditya "]}, "YrJIsbvWFwA": {"topic": "Model selection on large genomic dataset", "initializeDate": "Nov 3, 2017, 10:03:17 AM", "timeStamp": "Nov 4, 2017, 2:36:30 PM", "content": ["Dear IQ-TREE Users, I'm trying to run iq-tree on a large concatenated alignment consisting of 14,000 exonic loci. I tried a preliminary run using a GTR+GAMMA model but the results were rather unsatisfactory. Does anyone have any recommendations on how to approach model selection for such a large dataset? Thank you in advance! Chan ", "Hi Chan, While I don\u2019t know your expectation about what is satisfactory or not, my recommendation right now is: Because the exon can be quite short, the partition model is likely over-parameterized with too many short partitions. To avoid this, you can reduce the number of partitions by e.g. using ModelFinder or PartitionFinder to merge the partitions. You can also use genes as partitions (i.e. merging exons of the same gene) and repeat the analysis. Also you should definitely do model selection, not just do GTR+G. IQ-TREE provided many other (simpler) DNA models to avoid overfitting if possible. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "JKwk9wIsCww": {"topic": "IQTREE Web Server results retrieval?", "initializeDate": "Mar 23, 2017, 4:25:50 PM", "timeStamp": "Mar 24, 2017, 6:38:54 PM", "content": ["Recently I became unable to retrieve results from jobs on the IQTREE Web Server. I was curious if there was an outage or the like, or if there was something wrong on my end. Thank you for the excellent tools! ", "Since this post is poorly explained in case this is not a widespread issue, on the Analysis Results tab, the left pane continues to load for an extended period of time, then stops loading and I am left with a full white box with no entries. This is after following links from emails, and I first noticed it when submitting a job. ", "I can retrieve results again as of this AM. ", "thanks for letting us know, I think it was some temporary issue with the server\u2026 Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "DGFCSk1NRqs": {"topic": "New citation for IQ-TREE 2", "initializeDate": "Feb 26, 2020, 4:49:16 AM", "timeStamp": "Feb 26, 2020, 3:27:54 PM", "content": ["Dear All, The IQ-TREE 2 paper was published in Mol. Biol. Evol., so please cite if you are using it: IQ-TREE 2: New models and efficient methods for phylogenetic inference in the genomic era Bui Quang Minh, Heiko A Schmidt, Olga Chernomor, Dominik Schrempf, Michael D Woodhams, Arndt von Haeseler, Robert Lanfear Molecular Biology and Evolution https://doi.org/10.1093/molbev/msaa015 Published: 03 February 2020 Thank you! The IQ-TREE development team ", "Dear Minh, I am trying iqtree 2 for some analyses, but it kept fail and I have no clue what is the problem. Attached is the log file for one of this analyses. Thank you for your help! Junxia ", "Dear Junxia, could you please send your alignment to my email, so I could reproduce the error? Cheers, Olga > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8EF047AC-D768-4FFD-8A78-BB15CC1D3719%40gmail.com > <18.8.3_115mt.proof.concat.rRNA.cDNARY.15part.MFM.log> >> -- >> You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. >> To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com >> To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/D5424B5A-B201-4EA6-9F38-1821DA7AB780%40univie.ac.at > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8EF047AC-D768-4FFD-8A78-BB15CC1D3719%40gmail.com ", "Hi Junxia, Quick answer: Please rerun with \u201c--no-terrace\u201d option. Longer explantion: This \u201cillegal instruction\u201d at the very end of the run looks like a problem with the terrace library that we recently integrated. Somebody else filed a similar bug report in GitHub ( https://github.com/Cibiv/IQ-TREE/issues/116 ). That option will turn this off and you can just safely re-run from the checkpoint \u2014 all other results are not affected. We\u2019ll try to fix it (Olga: perhaps try to contact the upstream terraphast people?). In case if it\u2019s not fixed in a month time or so, we\u2019ll turn it off by default. Thanks! Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6403B759-4954-4798-BBDF-1F8011DB366F%40gmail.com ", "Thank you! And Olga, attached is the alignment file in case you want to try it. Best, Junxia ", "Great, thank you. I\u2019ll check, if there is something weird with the terrace library itself or if it is wrongly called within IQ-TREE. Cheers, Olga <18.8.3_115mt.concat.rRNA.cDNARY.fas> "]}, "uVVJofdBAPY": {"topic": "Suggestion to implement additional bootstrapping method in IQtree", "initializeDate": "Jul 8, 2020, 1:40:38 PM", "timeStamp": "Jul 14, 2020, 10:38:31 AM", "content": ["Hello, I am wondering if it would it be possible to implement another bootstrapping method more similar to rapid bootstrapping in RAxML into a future IQtree update? I understand that the UFBoot values are known to be inflated, and accordingly, I have been finding some drastic differences in values using different bootstrapping methods on trees I am currently working with. For example I have constructed >225 single gene trees using LG+C20+G+F and have applied bootstrapping using UFBoot (-bnni -bb 1000), nonparametric bootstrapping using PMSF (100 replicates), and also rapid bootstrapping implemented in RAxML using LG4X (100 replicates). In general, the PMSF and RAxML rapid bootstrap values are similar, while UFBoot values are unexpectedly high. Furthermore, clades with UFBoot support over 95 are often falling extremely low with the other two approaches (the attached example is not uncommon and shows a drop from 98 with UFBoot (left), to 0 with rapid bootstrapping (middle), and 2 with PMSF (right)). It seems that having a method of obtaining more reliable estimates of support, while taking less computational resources than nonparametric bootstrapping using PMSF would be a huge asset. Cheers Eric ", "Hi Eric, Thanks for the thoughtful suggestion and illustration! For exactly implementing the rapid bootstrap strategy of RAxML, unfortunately we don\u2019t have resource to allocate the time. However, I recommend that you can use -fast option coupled with the standard bootstrap. I vaguely remember that Diep performed simulations that this \u201cfast\u201d bootstrap correlates with quite well the normal bootstrap. @Diep: can you pls comment on this. Let us know how this behaves compared with other strategies on your dataset. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/162689d3-cacf-4322-b295-3d3763c160d5o%40googlegroups.com <Screen Shot 2020-07-08 at 1.18.46 PM.png> ", "Hi Minh, Thanks for that suggestion. I used this for the tree in my example (attached a screenshot of the same region) and the results are quite similar across the entire tree to those generated using rapid bootstrapping in raxml and the using PMSF in IQtree. I will test this more broadly in the near future, but it looks like it could be a great solution that I was unaware existed. Is it just using the fast tree search mode to conduct bootstrap replicates? I'm not entirely clear on what this flag is doing under these circumstances. Any additional information is greatly appreciated. Cheers Eric ", "Hi Eric, The -fast option sort of resembles the FastTree algorithm. It will build a couple of starting trees (parsimony and neighbor joining) and then optimise them with nearest neighbor interchange under maximum likelihood. When coupled with standard bootstrap (-b), it will perform such fast tree search for each bootstrap replicate. I think that\u2019s OK for bootstrap analaysis. What I would do, is to perform a thorough tree search on the original alignment, and say 100 fast bootstrap search, and map the support values from 100 fast bootstrap trees onto the original tree. Cheers Minh On 14 Jul 2020, at 1:39 am, Eric Salomaki < eric.s...@gmail.com > wrote: Hi Minh, Thanks for that suggestion. I used this for the tree in my example (attached a screenshot of the same region) and the results are quite similar across the entire tree to those generated using rapid bootstrapping in raxml and the using PMSF in IQtree. I will test this more broadly in the near future, but it looks like it could be a great solution that I was unaware existed. Is it just using the fast tree search mode to conduct bootstrap replicates? I'm not entirely clear on what this flag is doing under these circumstances. Any additional information is greatly appreciated. Cheers Eric <Screen Shot 2020-07-13 at 11.28.16 AM.png> ", "Hi Minh, Thanks so much for your response and clarification of the -fast usage with bootstrapping. I never realized that is an option but preliminarily it looks to be a great one. I\u2019m looking forward to exploring how it performs across the entire dataset. I have been mapping the replicates (in all cases except UFBoot) to the C20 ML tree, so it seems like I am handling that as I should. I put the 4 screenshots together here just for comparison. Thanks again. Cheers Eric "]}, "c87V21TEJI0": {"topic": "Not enough memory", "initializeDate": "Jul 18, 2018, 5:07:12 AM", "timeStamp": "Aug 5, 2018, 8:11:36 PM", "content": ["Hi Minh, I was trying to calculate a tree and although in the log file it says \"NOTE: 170943 MB RAM (166 GB) is required!\" and I booked a node with >250 GB and also used the -mem option in the command (see below), I got the following error: ERROR: STACK TRACE FOR DEBUGGING: ERROR: Not enough memory, allocation of 111316391712 bytes failed (bad_alloc) Here is the command I used: Host: r1.uppmax.uu.se (AVX2, FMA3, 251 GB RAM) Command: /home/user/software/iqtree-1.6.5-Linux/bin/iqtree -s file.fasta -m LG+C60+G+F -bb 1000 -bnni -wbtl -nt 20 -mem 250G Seed: 743690 (Using SPRNG - Scalable Parallel Random Number Generator) Kernel: AVX+FMA - 20 threads (20 CPU cores detected) Do you have any idea what caused the crash? Best, Jurgen ", "Hi Juergen, The problem is that currently -bnni option will lead to double the amount of memory required. We\u2019ll fix this but for now, can you switch to another computer with twice RAM the amount reported in \"NOTE: 170943 MB RAM (166 GB) is required!\u201d. Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh. Thanks, this explains why it crashed. Do you have a fixed version already (maybe on GitHub) that can be used? I am asking because I need many trees that would take forever using the resources I have. Thank you, J\u00fcrgen ", "Hi J\u00fcrgen, Not yet, but one thing that could help: use \"-mem 120G\u201d. This will restrict the RAM for the tree search phase to this amount and the later -bnni phase as well. So in total IQ-TREE will not exceed 240G. Let me know if that works. Minh "]}, "-7NSVWu8_og": {"topic": "Re: [iqtree] Bug with dataset", "initializeDate": "Apr 13, 2020, 7:07:41 PM", "timeStamp": "Apr 16, 2020, 3:55:46 PM", "content": ["Hi there, This is a known issue (technically with the terrace library) that has now been turned on in version 2.0-rc2 by default. So you just need to download this version, which also fixes a numerical issue. Or you can also add --no-terrace option with 2.0-rc1 (but not recommended). Thanks, Minh On 13 Apr 2020, at 5:11 pm, Tous1 < emmanue...@gmail.com > wrote: Hey all, I am trying to run analyses on a large phylogenomic dataset (>1500 taxa / 400+ loci) but get error messages after about two weeks of run on our cluster. I need to fix this fast to avoid wasting that amount of computational resources. Here is the setup: IQ-TREE multicore version 2.0-rc1 for Linux 64-bit built Nov 21 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: c6a-s14.ufhpc (AVX, FMA3, 251 GB RAM) Command: /apps/iq-tree/2.0-rc1/bin/iqtree -s SVII.phy -spp Partitions.txt.best_scheme.nex -nt 32 -safe -pre STS5 Seed: 179886 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Fri Apr 3 06:44:11 2020 Kernel: Safe AVX+FMA - 32 threads (32 CPU cores detected) And the error message: Total number of iterations: 159 CPU time used for tree search: 19190326.420 sec (5330h:38m:46s) Wall-clock time used for tree search: 744680.709 sec (206h:51m:20s) Total CPU time used: 20668164.501 sec (5741h:9m:24s) Total wall-clock time used: 809352.581 sec (224h:49m:12s) ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ILLEGAL INSTRUCTION ERROR: *** For bug report please send to developers: ERROR: *** Log file: STS5.log ERROR: *** Alignment files (if possible) srun: error: c6a-s14: task 0: Illegal instruction (core dumped) Any idea what is going on here? Best, You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0ca9b6a8-6990-4ecc-be49-f45447a3784b%40googlegroups.com ", "I\u2019m sorry, just saw a typo in my answer: the sentence should read \u201c\u2026 has now been turned OFF\u2026\u201d, not \"turned on\u201d. Minh "]}, "V2Lnd3r9IHk": {"topic": "Questions in ancestral sequence reconstruction", "initializeDate": "Nov 2, 2020, 9:25:11 AM", "timeStamp": "Dec 3, 2020, 10:58:25 AM", "content": ["Hello! I'm attempting to do an ancestral sequence reconstruction, trying to reconstruct two sequences, and I have some questions. I used the following script: iqtree -s alignment.phy -asr -blfix -keep_empty_seq -m GTR+G+I -te newick_tree.txt -o Polypterus First question: I used \"-blfix\" to maintain the topology of the newick tree I'm using. The tree has no branch lengths, so, as far as I understand, branch lengths are estimated based on the sequences. Is this correct? To make this estimation more accurate, I decided to \"concatenate\" my two sequences, and reconstruct their ancestral state in one analysis. I figured the branch length and parameters estimation would be more accurate with a longer sequence. So I thought one \"big\" analysis was better than two smaller ones. Is this a good approximation? Second question: I was wondering if there is an error or something like that associated with the results I obtained. In the .log file, I can find information about the parameters determined (base frequencies, rate parameters, etc.), but no information regarding error. In the .state file, there is information of likelihood of state for each position in the sequence, for each node, but I can't find error information. Is there such a thing as error, or a confidence interval, or something like that in this type of analysis? Any help on this matter would be greatly appreciated. Vicente Mu\u00f1oz Walther Ph.D.(c) Laboratorio de Ontogenia y Filogenia Las Palmeras 3425 Universidad de Chile ", "Hi Vicente, On 3 Nov 2020, at 1:26 am, Vicente Mu\u00f1oz Walther < tente...@gmail.com > wrote: Hello! I'm attempting to do an ancestral sequence reconstruction, trying to reconstruct two sequences, and I have some questions. I used the following script: iqtree -s alignment.phy -asr -blfix -keep_empty_seq -m GTR+G+I -te newick_tree.txt -o Polypterus First question: I used \"-blfix\" to maintain the topology of the newick tree I'm using. The tree has no branch lengths, so, as far as I understand, branch lengths are estimated based on the sequences. Is this correct? If your tree has no branch lengths, please remove -blfix option and IQ-TREE will estimate branch lengths. The -te option is already fixing the tree topology of the given tree. To make this estimation more accurate, I decided to \"concatenate\" my two sequences, and reconstruct their ancestral state in one analysis. I figured the branch length and parameters estimation would be more accurate with a longer sequence. So I thought one \"big\" analysis was better than two smaller ones. Is this a good approximation? From my understand, you have two alignments for the same set of species, right? Yes, this is a good point, having more data in one analysis is better. You can concatenate them to a single alignment and run this same command line. For your convenience, -s option in IQ-TREE 2 allows a directory name, where you put two alignments. Running \"iqtree2 -s ALN_DIR \u2026 \u201c will load, concatenate them and do the analysis as usual. It also works when some species is missing in one alignment as IQ-TREE will match the sequence names. The question is now, whether you use a single model or a partition model? I suggest that you do both and compare the results. In the latter case, just replace -s ALN_DIR with -p ALN_DIR. Second question: I was wondering if there is an error or something like that associated with the results I obtained. In the .log file, I can find information about the parameters determined (base frequencies, rate parameters, etc.), but no information regarding error. Do you mean standard error in parameter estimates? No, IQ-TREE does not compute this. Although there is a formula to compute the s.e., but I don\u2019t find them useful (no body will look at it). In the .state file, there is information of likelihood of state for each position in the sequence, for each node, but I can't find error information. Is there such a thing as error, or a confidence interval, or something like that in this type of analysis? The information written in .state is already providing you enough information, right: it tells you the probability of a site being an A, C, G, or T. There is nothing like confidence interval, because we have a discrete number of states here. Perhaps you mean the confidence set? You can do that by ranking A,C,G,T by the probability (larger first) and include all states until the accumulated probability exceeds 0.95. Say for example: p(A) = 0.8 p(C) = 0 P(G) = 0.17 p(T) = 0.03 (which should sum to 1, of course). The ranking of states is A, G, T, C; and the confidence set is {A, G} because p(A) + p(G) = 0.97 > 0.95. So for this position, the state could be either A or G (although A is more likely, but we are not sure about that). Does that answer your question? Minh Any help on this matter would be greatly appreciated. Vicente Mu\u00f1oz Walther Ph.D.(c) Laboratorio de Ontogenia y Filogenia Las Palmeras 3425 Universidad de Chile You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CA%2BVmrY7rQMxFxuRm96yJ2OqOeG%2BwEgS5epFSzghecEHMh2RbvA%40mail.gmail.com ", "I think you answered my questions. Thank you very much. ", "Regarding this, I think I understand what you mean by partition and single models, but I prefer to ask, just to be sure. What are these? what's the difference between single and partition models. You've been really helpful already. Any further help would be greatly appreciated. ", "Hi Vicente, the doc will explain this: http://www.iqtree.org/doc/Complex-Models Minh ", "Thank you! Following your recommendation, I've been trying to use iqtree2 and a directory to automatically concatenate the sequences. I'm finding a problem nonetheless. I get the following errors: ERROR: Tree taxon Polypterus does not appear in the alignment ERROR: Tree taxon does not appear in the alignment I have double checked, and Polypterus is indeed in both alignment files. The second error I don't understand either. It seems to me that there is some taxon in the tree without a name, thus the blank space, but I have double checked and the tree is fine. What could be the problem? Any help would be truly appreciated. Just in case, the command I'm using is the following: bin\\iqtree2 -s Alignments -asr -keep_empty_seq -m GTR+G+I -te Full_tree_NOBL.txt Alignments is the name of dir with the alignments in Phylip format. Full_tree_NOBL.txt is a newick tree without branch lengths. ", "Hi Vicente, I suspect there is something wrong with the newick tree file. Please send it here, I\u2019ll have a look. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CA%2BVmrY7j%2B6A0kdDoLkZT47vUve1f79833ffBjEnLoZ5Y4qOsmA%40mail.gmail.com ", "The tree is in the attachment. I'll also paste in here, just in case. ((((((((((((((((((Xiphophorus,Poecilia)N29,(Cyprinodon,Fundulus)N28)N27,Kryptolebias)N26,Oryzias)N25,Pundamilia)N24,(Parambassis,Acanthochromis)N23)N22,(Scophthalmus,((Mastacembelus,Monopterus)N21,(Betta,Anabas)N20)N19)N18)N17,(Gasterosteus,(Takifugu,Labrus)N30)N16)N15,Hippocampus)N31,Periophthalmus)N14,Gadus)N13,(Esox,Hucho)N12)N11,(Clupea,(Danio,(Electrophorus,(Pygocentrus,Astyanax)N10)N9)N8)N7)N6,(Paramormyrops,Scleropages)N5)N4,Anguilla)N3,Lepisosteus)N2,(oxyrhinchus,ruthenus)N32)N1,Polypterus)NR; NR, N1, N2... and so forth are node labels. Thanks in advance! ", "Hi Vicente, Sorry for the delay. In case if it\u2019s still relevant, I just ran the command: iqtree2 -s Alignment_190.phy -asr -keep_empty_seq -m GTR+G+I -te Full_tree_NOBL.txt in my Mac. Everything works smoothly. No error message\u2026 so I don\u2019t know what happened at your side. Minh On 17 Nov 2020, at 1:04 am, Vicente Mu\u00f1oz Walther < tente...@gmail.com > wrote: Dear Minh, have you had any luck finding out what the problem might be? Any help would be appreciated a lot. Thanks in advance. On Thu, Nov 5, 2020 at 9:11 PM Vicente Mu\u00f1oz Walther < tente...@gmail.com > wrote: Attached are the two alignments. I'm using Iqtree 2.1.2 for windows. Thanks ina advance. On Thu, Nov 5, 2020 at 8:14 PM Minh Bui < minh...@univie.ac.at > wrote: Your newick tree looks fine. Please also send me the alignment, so that I can quickly reproduce the run. Which version of iQ-TREE are you using? Minh <Full_tree_NOBL.txt> Vicente Mu\u00f1oz Walther Ph.D.(c) Laboratorio de Ontogenia y Filogenia Las Palmeras 3425 Universidad de Chile ", "I think the problem might be related to the fact that I used a directory (containing two different alignments encompassing the same taxa) instead of a single file in the -s option. bin\\iqtree2 Alignments -asr -keep_empty_seq -m GTR+G+I -te Full_tree_NOBL.txt Alignments is a directory that contains the alignments Alignment_190.phy and Full_alignment_4.phy I'll try to solve this, by concatenating the two alignments, and using a single .phy document, instead of using a directory. Thanks! "]}, "d95q8ohHTPk": {"topic": "constrained tree search approach", "initializeDate": "Jun 6, 2019, 4:57:59 AM", "timeStamp": "Jun 12, 2019, 11:28:09 PM", "content": ["Hi all, i would like to carry out a constrained tree search to abtain a tree with specific relationship between clades, but without being interested in internal relations and then perform a topological test between the result obtained and another tree. Is the approach to write a newick file with politomies fo each clade correct? Thank you in advance for the help. Best Jacopo ", "Hi Jacopo, It\u2019s not clear to me, which trees are you comparing. But are you comparing a fully bifurcating tree with a polytomy (multifurcating) tree? If yes, I think this is unfair for the polytomy tree. A fully bifucating tree has 2n-3 branch lengths (n=#taxa). Whereas a multifurcating tree has fewer branch lengths, thus will tend to have lower log-likelihood and be likely rejected. Therefore, I would fully resolve the multifurcating tree by e.g. a constrained tree search. And then compare the resolved tree with the other bifurcating tree. Does that answer your question? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/98630a00-a44b-4752-8567-397183cb6adb%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Hi, thank's for the explanation,yes my idea was to use a multifurcating tree as constrains just because i'm not interested in the internal relathionship of the clades, making them resolved with the constrain tree search and then compare the result with others bifurcating trees. I've tried a search with an input constrain tree like ((((A,B,C,D),(F,G,H,I)),((L,M,N,O),(P,Q,R,S))),(U,V,Z)); but i get the error message \"constrain tree must be unrooted\", how can i solve it? Thank you for your patience and helpfulness. Jacopo. Il giorno venerd\u00ec 7 giugno 2019 02:34:12 UTC+2, Minh Bui ha scritto: Hi Jacopo, It\u2019s not clear to me, which trees are you comparing. But are you comparing a fully bifurcating tree with a polytomy (multifurcating) tree? If yes, I think this is unfair for the polytomy tree. A fully bifucating tree has 2n-3 branch lengths (n=#taxa). Whereas a multifurcating tree has fewer branch lengths, thus will tend to have lower log-likelihood and be likely rejected. Therefore, I would fully resolve the multifurcating tree by e.g. a constrained tree search. And then compare the resolved tree with the other bifurcating tree. Does that answer your question? Minh On 6 Jun 2019, at 6:57 pm, Jacopo Martelossi < jacopo.m...@gmail.com > wrote: Hi all, i would like to carry out a constrained tree search to abtain a tree with specific relationship between clades, but without being interested in internal relations and then perform a topological test between the result obtained and another tree. Is the approach to write a newick file with politomies fo each clade correct? Thank you in advance for the help. Best Jacopo You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Jacopo, Which version are you using? Can you please try the latest version? This restriction has been lifted, I think. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f93751e8-0fa1-4778-bdde-6461922405e3%40googlegroups.com ", "Hi Jacopo, This problem was discussed and answered here: https://groups.google.com/forum/#!topic/iqtree/o-Fmnfo1WBI And sorry, I thought this was changed, but only in the beta version 1.7. Minh On 12 Jun 2019, at 10:54 pm, Jacopo Martelossi < jacopo.m...@gmail.com > wrote: i've download the last version 1.6.11, but i've recived the same error message. "]}, "zkoXqNJyFhs": {"topic": "sCF of 100 for an alternative topology", "initializeDate": "Feb 26, 2021, 7:21:22 PM", "timeStamp": "Mar 23, 2021, 3:39:36 AM", "content": ["Hello, I'm trying to interpret some concordance factor values I got for a phylogeny combining 3 differents datasets (nuclear, mitochondrial and plastid loci). My idea is to use concordance factors to study the discrepancies between the topology I got for each dataset (Maybe the plastid dataset doesn't show an alternative topology but still some plastid sites support the combined topology etc?). However, I'm a bit puzzled looking at the result from one node. This branching isn't supported by one of the dataset (gCF=66%, not the topology presented in every individual tree) but the sCF value is 100. How is that possible? If all sites supports this relationship, why it is not the one represented in every datasets? What am I missing? Pauline ", "Hi Pauline, Can it be some display issue? Indeed I wouldn\u2019t expect any branch to have sCF of 100%, unless in an ideal case. Because you have only 3 trees here, can you post the zoom-in figure at this part of the trees containing that suspicious branch, and map the 3 locus-wise sCF values? This is to understand more the situation. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4552639d-8fa8-4e35-bef9-3a61a8637fd1n%40googlegroups.com ", "Hi Minh, branches are really short so it's not really informative anyway but I'd like to be sure I'm understanding concordance factors right... For next time! For uninformative branches, I would expect values around 33. So here are zoom-in of the different trees. Full is the tree I was talking about (3 datasets) and then mito/chloro/nucl present the respective loci-wise values for each dataset (lot of short loci, that's why we decided to compare the 3 whole datasets). Best regards, Pauline ", "Hi Pauline, There are 3 numbers on each branch. Can you help tell me specifically, what is the \u201cproblematic\u201d branch? And what number are what? Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/fd1bffc4-322f-4304-a0eb-e07417f1c1acn%40googlegroups.com <chloro.png> <nucl.png> <full.png> <mito.png> ", "Hi Minh, sorry, the numbers are UFbootstrap values/gCF/sCF. The branch I was talking about is the one between Awim3 and Mavim 2. ", "Hi Minh, do you have any insight about my issue? Thank you very much, Pauline "]}, "NWwPPg-0b3I": {"topic": "Phylogenetic dating: inferred root date outside of specified bounds", "initializeDate": "Sep 5, 2020, 5:40:18 AM", "timeStamp": "Sep 15, 2020, 6:09:14 AM", "content": ["Dear IQ-TREE and LSD devs, When checking the least squares dating output (.lsd file attached), I was surprised to see that the inferred root date (2019-12-26) is outside of the root date bounds I specified (2019.872, 2019.98), which correspond to 2019-11-15, 2019-12-24. Is this behavior expected? All the best, Sarah ", "", "Hi Sarah, I was wondering which version that you used. I saw in the log file that version 1.8.1 of lsd2 was used. Could you first try with the latest version 1.8.8 of lsd2, or the latest version of iq-tree and report if the issue persists? If it does, we may need the input tree, date and outgroup files to detect what happens. Cheers, Hien On Sat, Sep 5, 2020 at 11:41 AM sarahna...@gmail.com sarahna...@gmail.com > wrote: You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/00b0cb16-0960-48c4-aca9-507feffaa93fn%40googlegroups.com ", "Hi Hien, Sorry for the slow response from my end! I updated IQ-TREE to version 2.1.1 (COVID-edition) which uses LSD version 1.8.6 according to the log file and the problem persists. I\u2019ve attached the tree and outgroup files (the dates are in the sequence names). This is the command I ran: FASTA_FILE=$WORKDIR/main/rep_3_alignment.fasta DATADIR=\"$(dirname \"${FASTA_FILE}\")\" PREFIX=\"$(basename \"${FASTA_FILE}\" | sed 's/_alignment.fasta//g')\" TREEFILE=$DATADIR/${PREFIX}.treefile OUTGROUP=`cat $WORKDIR/tree_dating/${PREFIX}.treefile.outgroup.txt` $IQTREE \\ -s $FASTA_FILE \\ -te $TREEFILE \\ -m HKY+F+G4 \\ -keep-ident \\ -o $OUTGROUP \\ -nt 4 \\ --date TAXNAME \\ --date-ci 100 \\ --date-outlier 3 \\ --clock-sd 0.4 \\ --date-options -a b(2019.872,2019.98) -u 0 -t 0.0008 \\ -pre $WORKDIR/tree_dating_updated_iqtree_version/$PREFIX ", "Hi Sarah, Thanks for sending the data, I see the problem now. It's because your input tip dates are of format dd-mm-yyyy while the root date is a real, so the program made a mistake to round the root date intervals to wrong dates. I've fixed this in the new version of lsd2. For using the old version, you can specify for example --date-option -a 'b(2019-11-15, 2019-12-24)' Thanks for raising the issue. Hien You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/084ABBA4-848E-4B7B-BE79-6DB62C7B8475%40gmail.com You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/084ABBA4-848E-4B7B-BE79-6DB62C7B8475%40gmail.com You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/NWwPPg-0b3I/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAKjtwTzw98x%2BOA0fjLb-EdHaz-g913HNn%2B0Adnr8Qnb8xob6aA%40mail.gmail.com You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/084ABBA4-848E-4B7B-BE79-6DB62C7B8475%40gmail.com ", "Hi Hien, Great, thanks for the fix! Best, Sarah To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAKjtwTy-ygOXnRMMaosskypFPeCjER_rkJMcroeS54m%2B3D00bw%40mail.gmail.com "]}, "JZGB1qPsIWM": {"topic": "divergence times", "initializeDate": "May 11, 2020, 3:09:08 PM", "timeStamp": "May 12, 2020, 6:59:30 PM", "content": ["Hi all, I am playing around with the new divergence time estimation feature. I am particularly interested to see how results compare to MCMCTree. I ran the following command: ./iqtree2 -s anguid80_MCMCTree.phy -o Elgaria_kingii_MXH226Elki --date-root -20 --date-tip 0 -nt AUTO -m GTR+R10 Unfortunately, the time-tree looks strange (see attached). Also, why was the outgroup removed? On positive note, the rate estimate was virtually identical to MCMCTree! :) Best wishes, Chris ", "Hi Chris, In FigTree you should select \u201cNode Labels\u201d, not \u201cBranch Labels\u201d. Then the dates are annotated to the nodes. The root date is -20, negative as this is backward in time. So this is not strange. The ancestral node dates should be smaller than tip dates, according to our convention. What is the convention in MCMCTree? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c75c826e-6e0b-4039-a70b-358914064643%40googlegroups.com <Screen Shot 2020-05-11 at 3.04.45 PM.png> ", "Hi Minh, I guess my question was mostly related to the wonky branching pattern towards the root. Thanks. Chris <{===================~~~~~~~~~~~ /\\ /\\ Christopher Blair, Ph.D. Associate Professor Department of Biological Sciences New York City College of Technology and Ecology, Evolution and Behavior PhD Program Graduate Center The City University of New York 285 Jay Street Brooklyn, NY 11201 CBl...@citytech.cuny.edu cbl...@gc.cuny.edu Website: https://sites.google.com/site/christopherblairphd/home Office: Academic Complex 501A; Ph: 718-260-5342 Lab: Academic Complex 401 ", "Hi Chris, The pattern at the root is because of negative branch lengths. LSD2 by default allows negative branch lengths. You can enforce ancestral nodes to be older than their descendants with --date-options \"-c\" I agree it's an odd default, but I think the intention here is to just match the LSD2 defaults. And I'm guessing (I don't know) that LSD2 uses those defaults because it's the quickest algorithm. More details are here: http://www.iqtree.org/doc/Dating Rob To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAFXUWhJKkG9YUCPFyUuEpaEH2qcwK4XQG%3D0T2oo1No-hGxHP_A%40mail.gmail.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Thanks Rob. It also said that only relative dates were estimated. However, looking at the results it seems like these are absolute dates. Can you explain a bit more? Chris To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmornqi4F0Ly%2B97waUXuLPM1TeGZ%3Dg3Btp6G1w3N9WvJSA%40mail.gmail.com ", "Hi Hien, Chris asked a question about LSD2 and you are best to answer (see below): \" I guess my question was mostly related to the wonky branching pattern towards the root.\" Note that with that IQ-TREE command line, it will call LSD2 with something like: lsd -i TREE_FILE -s ALN_LEN -c -o OUT_FILE -g OUTGROUP_FILE -a -20 -z 0 Do you have any idea what happened at the the root? @Chris: the outgroup was removed by default in LSD2. If you want to keep it, use --date-outgroup option. @Hien: I think \u201c-c\u201d should be the default behaviour in LSD2, ancestral node dates must not be greater than the descendant dates, otherwise it does not biologically make sense. So can you change that? Right now IQ-TREE always call LSD2 with \u201c-c\u201d to enforce this. Thanks, Minh Begin forwarded message: You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c75c826e-6e0b-4039-a70b-358914064643%40googlegroups.com "]}, "Nbh4hIs_p64": {"topic": "Where should I put my input file?", "initializeDate": "Mar 9, 2020, 4:27:01 AM", "timeStamp": "Mar 10, 2020, 4:06:45 PM", "content": ["Whether its in my home or in my drive C, I always get this error: ERROR: File not found /home/kmtayaban/Alignment_MUSCLE_Gb.fa Please help! ", "Dear Kuselah Tayaban, > On 9 Mar 2020, at 09:27, Kuselah Tayaban < kmta...@gmail.com > wrote: > Whether its in my home or in my drive C, I always get this error: > ERROR: File not found /home/kmtayaban/Alignment_MUSCLE_Gb.fa Since you are talking about a C-drive, I guess that you are working on Windows. I do not have access to a Windows system at the moment, but as it seem, either the path (i.e. /home/kmtayaban/) or the filename (Alignment_MUSCLE_Gb.fa) is not correct. Specialties under Windows ist that (a) the \u201cC:\u201d might have to be added (b) it could be that one needs to use \u201c\\\u201d instead of \u201c/\u201c in the path Please check whether the path and filename are actually correct and please try the above mentioned substitutions in the path and file name? I hope that helps to solve the problem. It might also help to ask your local Window expert/admin for help, because this is not a specific IP-Tree problem, but relates to the commandline call in Windows. Best wishes, Heiko > Please help! > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/dd4c061d-ff50-40c7-9990-6215e5af6c7c%40googlegroups.com ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- "]}, "Nz_Q6M00kdQ": {"topic": "parallell (-mpi) execution of ModelFinder", "initializeDate": "Mar 22, 2019, 10:28:32 AM", "timeStamp": "Mar 25, 2019, 10:09:03 AM", "content": ["Hi, Is there any way to run ModelFinder in parallel? I have an relatively large dataset, and I would like to run it with -mtree option on HPC cluster. Am I right that in case of AA models 18 runs with different -mset options would perform separate analyses for each model? Sincerely, Michal Malszycki ", "Hi Michal, As you might have noted, MPI is not supported in ModelFinder. You have to \u201cmanually\u201d parallelise it by a series of runs with -mset option: iqtree -mset LG \u2026 iqtree -mset WAG \u2026 And then combine the outputs. But things will be tedious if you have a partition model\u2026 it\u2019s not easy to combine the manual runs from different partitions\u2026 is this the case you are asking here? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thank you for fast response. I'm not interested yet in partitioned analysis (but I'll have your point in mind when I'll plan one) Z wyrazami szacunku, Micha\u0142 Ma\u0142szycki "]}, "n8HwmK-22qA": {"topic": "Partitioned DNA analysis with \"-spp\" return equal rates among the 3 codon positions (= 1.0 each one)", "initializeDate": "Aug 14, 2015, 2:53:49 PM", "timeStamp": "Aug 17, 2015, 3:01:42 PM", "content": ["Dear IQTree developers, I've been using IQTree v1.3.5 with a dataset of 51 taxa and > 2M bp. When running a partitioned analysis with \"-spp\" option for a coding DNA alignment (which according to what I understood from the manual should be linked partitions with proportional rates across them) in which I chose GTR+I+G for all 3 partitions, the program runs fine, but it keeps reporting rates of 1.0 for all 3 partitions. Is it a logging issue, or is the program actually not finding the partition-specific rates? Cheers, Jose ", "Dear Jose, -spp stands for partition model with proportional rates. One would not expect rate of 1 for all three partitions. Could you please provide the data and the command line you used to run the program? cheers, Olga You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Sure Olga, can you give me your email so that I can send it inbox? Thks in advance for your help, Jose. ", "here it is: olga.ch...@univie.ac.at cheers, Olga ", "Dear Olga and Bui, IQTree was behaving correctly all the way, thks for spotting this error of mine in setting the nexus-partition file! IQTree now reported meanigful rates. Cheers, Jose ", "Dear Jose, sure, that\u2019s the purpose of the user group here Cheers, Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at "]}, "-4qs3-RDf1g": {"topic": "Linking the parameters of mixture models (e.g., C60) across partitions", "initializeDate": "Feb 4, 2020, 6:05:41 PM", "timeStamp": "Feb 5, 2020, 4:55:07 PM", "content": ["Hello, I've been experimenting with concordance factors in IQ-TREE 2. I'm working on datasets where model mis-specification is a concern, and often a cause of topological disagreement/error, so I'd like to infer the loci trees with a reasonable substitution model. Is it possible to fit a fairly parameter-rich mixture model like LG+C60+F+G/R (say) to a directory of (individually short) single-gene alignments, but have the weights of the mixture model shared between loci, to speed computation and (perhaps) also obtain better estimates of those parameters? My understanding from the documentation is that the free model parameters are learned independently for each locus. Thanks, Tom ", "Hi Tom, yes, free model parameters of different partitions are inferred separately. Do I understand correctly that you would like to use and infer a single evolutionary model for all partitions but allow inference of different trees (branch lengths and topologies) for each partition? Edge-unlinked models (-sp) allow inference of different branch lengths for each partition, but I do not know if inference of different topologies for different partitions is possible (yet). Minh, please correct me, if I am wrong! Best, Dominik ", "Hi Dominik, yes, that's right. Ideally some shared model parameters (like mixture weights, or even the parameters of the +R free rate model) but have different gene tree topologies and branch lengths. (Is this such a crazy idea?). I could imagine getting close to this by estimating the values of the model (weights, etc) on the concatenate, and just fixing on those for each gene tree inference (but maybe allowing the alpha parameter, or whatever, to vary among loci). Some middle ground between inferring very many parameters for each small locus separately, and the other extreme of fixing everything across all loci. My concern is that, if a simple model is used per locus, some of the disagreement between the concatenation and the single gene trees will be due to worse per-locus substituion process modelling. Best, Tom You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/-4qs3-RDf1g/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/87v9okn7iz.fsf%40gmail.com "]}, "DZ-JPaJtgDk": {"topic": "Using a rooted tree for ASR", "initializeDate": "Dec 11, 2018, 11:49:34 AM", "timeStamp": "Dec 12, 2018, 10:44:56 AM", "content": ["Hello, I know that iqtree always outputs an unrooted tree, but if I supply it with a fixed, rooted tree for asr, is there any way to trick iq-tree into reconstructing ancestral states at the root? ", "Hi there, That\u2019s a good question, as IQ-Tree converts a rooted to unrooted tree for reversible models. However, there is one way to overcome this: you can add a virtual sequence all missing data representing the root. For example, let\u2019s say the alignment has 4 sequences A,B,C,D and this tree: ((A:0.1,B:0.1):0.1,(C:0.1,D:0.1):0.1). Then following these steps: 1. Add a new sequence called R into the alignment with just gaps. 2. Modify the tree to: (R:0.0,(A:0.1,B:0.1):0.1,(C:0.1,D:0.1):0.1). That means, just add taxon R with zero branch length. 3. Run ASR reconstruction in IQ-TREE with option \u201c-keep_empty_seq\u201d, so that R is not removed from the alignment. You can use \u201c-blfix\u201d if you also want to fix the branch lengths. And perhaps we should directly support rooted tree for ASR... Cheers, Minh On 12 Dec 2018, at 3:49 am, brma...@gmail.com wrote: Hello, I know that iqtree always outputs an unrooted tree, but if I supply it with a fixed, rooted tree for asr, is there any way to trick iq-tree into reconstructing ancestral states at the root? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "This worked beautifully. Thank you, Minh!! "]}, "FRttgGZzk4A": {"topic": "Combinability of rcluster options in Modelfinder", "initializeDate": "Jan 24, 2020, 1:34:21 AM", "timeStamp": "Feb 3, 2020, 4:19:40 AM", "content": ["Dear IQ-TREE team, I have some questions regarding the combinability of rcluster commands in ModelFinder. 1) Is it possible to combine rcluster with rcluster-max on the same command? (e.g. -rcluster 10 -rcluster-max 2000). If yes, is the behaviour the same with PartitionFinder where the smallest of these two numbers is considered at each step? If yes this is not described in the online documentation unless i am wrong. 2) Is it possible to combine rclusterf with rcluster-max similarly and what is the behavior then? 3) I saw in another thread that the rclusterf flag should not be used with a number e.g. -rclusterf 10. This is a bit confusing in the manual where it is mentioned that this flag is similar to rcluster. Maybe this description could be improved in the manual? 4) Since i incorrectly used rclusterf with a number for a test analysis together with an rcluster-max (i.e. -rclusterf 10 -rcluster-max 5000) i would be interested to know what the behavior is in this case. Is only rcluster-max 5000 considered here and the rclusterf command ignored? Or could it be that both are ignored? many thanks in advance alex ", "Hi Alex, On 24 Jan 2020, at 1:34 pm, Alexandros Vasilikopoulos < alexva...@gmail.com > wrote: Dear IQ-TREE team, I have some questions regarding the combinability of rcluster commands in ModelFinder. 1) Is it possible to combine rcluster with rcluster-max on the same command? (e.g. -rcluster 10 -rcluster-max 2000). Yes If yes, is the behaviour the same with PartitionFinder where the smallest of these two numbers is considered at each step? If yes this is not described in the online documentation unless i am wrong. Yes that\u2019s right, the smaller of these two numbers. Indeed we didn\u2019t describe this in the manual, thanks for pointing it out. 2) Is it possible to combine rclusterf with rcluster-max similarly and what is the behavior then? Yes, you can, the behaviour is the same as above, i.e. the smaller of 2 numbers. 3) I saw in another thread that the rclusterf flag should not be used with a number e.g. -rclusterf 10. This is a bit confusing in the manual where it is mentioned that this flag is similar to rcluster. Maybe this description could be improved in the manual? -rclusterf option will need a number, as with -rcluster. I don\u2019t know who said not to. But I\u2019ll check the manual. 4) Since i incorrectly used rclusterf with a number for a test analysis together with an rcluster-max (i.e. -rclusterf 10 -rcluster-max 5000) i would be interested to know what the behavior is in this case. Is only rcluster-max 5000 considered here and the rclusterf command ignored? Or could it be that both are ignored? See above, Cheers Minh many thanks in advance alex You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f99a8f2b-ee0e-4a6f-a351-613bbb7797f5%40googlegroups.com ", "Hi Minh, many thanks for your response. I am still a bit unsure how rclusterf is different from rcluster in \u0399Q-TR\u0395\u0395. In the PartitionFinder manual it is mentioned about rclusterf: \" It works very similarly to the rcluster algorithm, but instead of putting together the best pair of subsets found at each step (as in the rcluster algorithm) it puts together the top 50% of subsets found at each step.\" Therefore it does not require a number (this is 50%). Should i assume that this changes in ModelFinder depending on the value you provide?: i.e. if you use rclusterf 10 it puts together the top 10% of subsets? To make my question more clear and so that i completely understand here is an example assuming you have used rclusterf 10 and you have 5000 subset pairs at one of the steps of the analyses: You take the top most similar 10% (i.e 500) and merge all 500 of them irrespective of AICc? or you take the top most similar 10% (i.e 500) and merge 10% of them based on the AICc value (i.e. 0.1 x 500 = 50)? This would merge only 50 subsets. In both cases this is different than rcluster where you would only merge 1 subset pair at each step the one which results in a scheme with the best AICc score. I hope the question is clear many thanks alex Hi Alex, To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Dear Alex, 1) PF puts (and ModelFinder does the same, I assume) at each step all possible pairs of data blocks (subsets) that could be combined into a long long list. It uses heuristics to determine which models might be similar and sorts the list of pairs according to this criterion. In PF one can specify rcluster-percent and rcluster-max. In ModelFinder one can specify rcluster-max and has to specifies rcluster-percent as a parameter to the rcluster or rclusterf parameter. The slow part in the analyses is to determine the best model and ML score for each of the pairs in the list of pairs. 2) To save time, both ModelFinder and PF evaluate only the most promising pairs in the list, namely to top rcluster-percent of the pairs, but not more than rcluster-max in each step. For some of the pairs, the AIC (AICc or BIC) suggests to combine them. PF with rcluster now combines only the best pair that should be combined before it starts the next step and goes back to 1). If there is no pair for a better the AIC (AICc or BIC) it stops. PF with rclusterf combines the best 50% of the pairs that AIC (AICc or BIC) suggest to combine. ModelFinder should do the same since the manual says that the options are similar to PF. One can criticise that the manual says similar and not identical to what PF does. There are two things that differ between PF and ModelFinder I think: a) The way that the parameter rcluster-percent is specified. While PF has a default value of 10 and allows the user to change this with the rcluster-percent option, ModelFinder requires that rcluster-percent is specified as a parameter to the rcluster/rclusterf option. b) In PF one can specify the heuristic sorting criterion for the list of pairs by specifying weights. The ModelFinder manual does not seem to describe the ordering of the list. Furthermore, it seems that one can only rely on the default parameters of the sorting criterion. It only says that it works similar to the PF for which the default ordering is described in the manual. Best Christoph To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1593633a-3654-4acb-b751-a7ae79ba302c%40googlegroups.com **************************************** Dr. Christoph Mayer Email: c.maye...@uni-bonn.de Tel.: +49 (0)228 9122 403 Zoologisches Forschungsmuseum Alexander Koenig - Leibniz Institut f\u00fcr Biodiversit\u00e4t der Tiere - Adenauerallee 160 53113 Bonn, Germany www.zfmk.de Stiftung des \u00f6ffentlichen Rechts; Interimsdirektor: Prof. B. Misof Sitz: Bonn **************************************** ", "Hi Christoph, Thanks. This makes somehow sense now that the parameter you pass in to rclusterf is actually the percentage for rcluster-percent and it does not have to do with rclusterf (that is fixed to 50% of the top pairs being merged). If Minh can confirm this i do not have something else to add here. best Alex To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1593633a-3654-4acb-b751-a7ae79ba302c%40googlegroups.com **************************************** Dr. Christoph Mayer Email: c...@uni-bonn.de ", "Dear Both, Christoph has nicely explained it! Yes, users need to specify the rcluster-percent in both -rcluster and -rclusterf options. The rclusterf algorithm always tries to merge half (50%) of the candidate paritition pairs. So this 50% has nothing to do rcluster-percent. Regarding: a) The way that the parameter rcluster-percent is specified. While PF has a default value of 10 and allows the user to change this with the rcluster-percent option, ModelFinder requires that rcluster-percent is specified as a parameter to the rcluster/rclusterf option. Yes, exactly right b) In PF one can specify the heuristic sorting criterion for the list of pairs by specifying weights. The ModelFinder manual does not seem to describe the ordering of the list. Furthermore, it seems that one can only rely on the default parameters of the sorting criterion. It only says that it works similar to the PF for which the default ordering is described in the manual. IQ-TREE always sorts the list of pairs by the similarity of the rates. There is no option to specify the weights like in PF. This came from a discussion of Rob, such weighting is unnecessary: rates are the most important factor to determine the best pairs for merging. So I decided not to implement the weighting feature. Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/04f3c017-31fd-46cb-84c8-58e59858161c%40googlegroups.com ", "Hi All, Just weighing in to apologise for sowing confusion, and to thank Minh and Christoph for sorting it out. In an attempt to continue to clarify things on this thread, when using the rclusterf algorithm the rclusterf number in IQ-TREE is equivalent to the rcluster-percent option in PartitionFinder. This option (combined with rcluster-max, as described earlier in this thread) defines the number of potential pairs of subsets that will have their joint likelihood evaluated. For example, if you have 100 subsets then there are 100 choose 2 = 4950 possible pairs of subsets. If you have rclusterf set to 10%, then IQ-TREE will evaluate the joint likelihood the 495 closest pairs of subsets, where 'closest' is defined as 'most similar according to their parameters'. The difference between rcluster and rclusterf is as follows: in the rcluster algorithm, we simply merge the two subsets in the single pair of subsets that leads to the biggest increase in e.g. BIC score, update the partitioning scheme, and start again; but in rclusterf we progressively merge the subsets in the top 50% of the best pairs of subsets before starting the process again. The upshot is that rclusterf will finish in fewer iterations. Rob To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9C82C47B-5CA0-42D4-9C57-5D2254E0B0BB%40univie.ac.at Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Dear all, Thank you all for your detailed explanations! Alex On Sunday, February 2, 2020 at 11:51:42 PM UTC+1, Rob Lanfear wrote: Hi All, Just weighing in to apologise for sowing confusion, and to thank Minh and Christoph for sorting it out. In an attempt to continue to clarify things on this thread, when using the rclusterf algorithm the rclusterf number in IQ-TREE is equivalent to the rcluster-percent option in PartitionFinder. This option (combined with rcluster-max, as described earlier in this thread) defines the number of potential pairs of subsets that will have their joint likelihood evaluated. For example, if you have 100 subsets then there are 100 choose 2 = 4950 possible pairs of subsets. If you have rclusterf set to 10%, then IQ-TREE will evaluate the joint likelihood the 495 closest pairs of subsets, where 'closest' is defined as 'most similar according to their parameters'. The difference between rcluster and rclusterf is as follows: in the rcluster algorithm, we simply merge the two subsets in the single pair of subsets that leads to the biggest increase in e.g. BIC score, update the partitioning scheme, and start again; but in rclusterf we progressively merge the subsets in the top 50% of the best pairs of subsets before starting the process again. The upshot is that rclusterf will finish in fewer iterations. Rob To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/04f3c017-31fd-46cb-84c8-58e59858161c%40googlegroups.com You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9C82C47B-5CA0-42D4-9C57-5D2254E0B0BB%40univie.ac.at "]}, "LVonlhAwc-k": {"topic": "ERROR: Invalid model name GTR", "initializeDate": "Dec 2, 2015, 8:44:14 AM", "timeStamp": "Dec 2, 2015, 8:59:28 AM", "content": ["Hi, I am using a data set where 3rd codon sites has been recoded to RY (purines and pyrimidines). Then I apply several partitions with different models. I applied a F81+G to 3rd codon sites and a GTR+G+Fo to 1st and 2nd positions. Then I got this error \"ERROR: Invalid model name GTR\". This is I guess because the program recognizes sequences as proteins due to the presence of RY and hence GTR model does not apply. If I am correct, how could I solve it? Thanks a lot for your great software. Joan ", "I confirm that program recognize sequences as proteins WARNING: N is not present in alignment that may cause numerical problems WARNING: D is not present in alignment that may cause numerical problems WARNING: Q is not present in alignment that may cause numerical problems WARNING: E is not present in alignment that may cause numerical problems WARNING: H is not present in alignment that may cause numerical problems WARNING: I is not present in alignment that may cause numerical problems WARNING: L is not present in alignment that may cause numerical problems WARNING: K is not present in alignment that may cause numerical problems WARNING: M is not present in alignment that may cause numerical problems WARNING: F is not present in alignment that may cause numerical problems WARNING: P is not present in alignment that may cause numerical problems WARNING: S is not present in alignment that may cause numerical problems WARNING: W is not present in alignment that may cause numerical problems WARNING: V is not present in alignment that may cause numerical problems ", "Hi Joan, please recode the 3rd codon sites into 0 and 1 (instead of R and Y). Then iqtree automatically detects it as a binary partition. And then for this binary partition please specify the model as GTR2+G instead of F81+G: http://www.cibiv.at/software/iqtree/doc/Substitution-Models/#binary-and-morphological-models This should resolve this problem. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "000oT_wpuuk": {"topic": "(only) Bootstrap and (only) SH-aLRT analysis on input ML tree", "initializeDate": "Mar 18, 2019, 9:25:38 AM", "timeStamp": "Mar 19, 2019, 6:31:19 AM", "content": ["Hi, I want to compare UFbootstrap, bootstrap and SH-aLRT support values on MLtree. Tree itself is already calculated. Somehow I fail to start 'only' bootstrap or SH-aLRT analysis. Program always starts with ML inferrence. The dataset is quite large and I don't want to waste time on another ML inferrences. sincerely, Michal Malszycki ", "Hi Michal, Similar question was answered here: https://groups.google.com/forum/#!topic/iqtree/mA7-OIaHm9Y Note that SH-aLRT can be quickly assigned onto an existing tree provided via -te option, but not UFboot. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Michael, > On 18 Mar 2019, at 21:51, Minh Bui < minh...@univie.ac.at > wrote: [...] > Similar question was answered here: https://groups.google.com/forum/#!topic/iqtree/mA7-OIaHm9Y > Note that SH-aLRT can be quickly assigned onto an existing tree provided via -te option, You may want to look for the use of the \u201c-alrt\u201d option in the manual/tutorials. > but not UFboot. The only way one can do to get UFboot support values assigned to an already computed tree, is the following: - you need to run a complete reconstruction with the UFboot option (-bb) switched on. In addition you have to tell IQ-Tree with \u201c-wbt\u201d to write all UFboot-trees to a *.ufboot-treefile. - this ufboot-treefile can then be used (using the \u201c-t\u201d option) to compute support values for the branches in the pre-computed target tree (using \u201c-sup\u201d). If the target tree is not the result of an ML search or if it is far away from the tree found during the ML tree search with the UFboot-option, it might be useful to set the number of UFboot trees to a higher value than default (e.g. -bb 10000) to obtain a wider sample of trees. I hope that helps. Best regards, Heiko >> On 19 Mar 2019, at 12:25 am, Michal Malszycki < michal.m...@gmail.com > wrote: >> Hi, >> I want to compare UFbootstrap, bootstrap and SH-aLRT support values on MLtree. Tree itself is already calculated. Somehow I fail to start 'only' bootstrap or SH-aLRT analysis. Program always starts with ML inferrence. The dataset is quite large and I don't want to waste time on another ML inferrences. >> sincerely, >> Michal Malszycki >> -- >> You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. >> To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com >> To post to this group, send email to iqt...@googlegroups.com >> Visit this group at https://groups.google.com/group/iqtree >> For more options, visit https://groups.google.com/d/optout > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- "]}, "pNx0dN_Z3IM": {"topic": "Re: Error in input data detected late in run.", "initializeDate": "Dec 22, 2017, 10:45:19 AM", "timeStamp": "Dec 24, 2017, 6:45:03 AM", "content": ["There actually was a \"warning\" posted to the job log before the model test began: IQ-TREE version 1.5.6 for Linux 64-bit built Dec 4 2017 Copyright (c) 2011-2017 by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, and Arndt von Haeseler. Host: muller (SSE3, 31 GB RAM) Command: ../../iqtree -s MCKENNA_Maddision_PROTsFASTA.FASTA -st AA -m TESTNEW -alrt 1000 Seed: 33575 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Thu Dec 21 01:35:55 2017 Kernel: SSE2 NOTE: Consider using the multicore version because your CPU has 16 cores! Reading alignment file MCKENNA_Maddision_PROTsFASTA.FASTA ... Fasta format detected Alignment most likely contains protein sequences Alignment has 319 sequences with 1747 columns and 1592 patterns (854 informative sites, 618 constant sites) Gap/Ambiguity Composition p-value 1 Cuc.Hel.Helota 0.00% passed 100.00% 2 Cuc.Mon.Rhizophagus 0.00% passed 100.00% 3 Sta.Agy.Ipelates 0.00% passed 100.00% 4 Ten.Pyt. ... 316 Cuc.Cer.Ostomopsis 49.80% passed 86.15% 317 Cuc.Lat.Corticaria 50.09% passed 78.18% 318 Cle.Mel.Listrus 50.31% passed 84.10% 319 Cur.Cur.Porthetes 50.49% passed 55.93% WARNING: 3 sequences contain more than 50% gaps/ambiguity **** TOTAL 15.76% 0 sequences failed composition chi2 test (p-value<5%; df=19) ", "Dear Brian, I checked your job. And the server log is: CPU time limit exceeded So that's the reason. The WARNING you mentioned is just for user information about gappy sequences. However, that doesn\u2019t stop iqtree from running. Cheers, Minh On Dec 22, 2017, at 4:41 PM, Brian Foley < brianf...@gmail.com > wrote: Hi, I was building a tree from published protein data. I started the job on the univie server and it ran for more than eight hours analyzing the various models of protein evolution to see which is best for this set, and then it quit with an error message saying that one of the sequences had more than 50% gap characters. It seems to me that the check for simple errors like that should come first, so the user can delete the offending sequences and restart the job sooner. The data set I was using is the protein set in this paper: The beetle tree of life reveals that Coleoptera survived end-Permian mass extinction to diversify during the Cretaceous terrestrial revolution Systematic Entomology (2015), 40, 835\u2013880 DOI: 10.1111/syen.12132 You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "K0KObjyX0J8": {"topic": "Comparable logLik between v2 and v1.6.2?", "initializeDate": "May 17, 2020, 11:05:40 PM", "timeStamp": "May 18, 2020, 1:51:04 AM", "content": ["Hello, Are logLik values comparable between v2.0.5 and v1.6.2? Thank you, Sergios ", "yes, 100% comparable. And also comparable with RAxML. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/43c80f71-81dd-4d08-aeae-8878348b49c7%40googlegroups.com "]}, "iKBgGk-qmlY": {"topic": "core dump from partitioned constrained analysis using 12.12 / Unrest model", "initializeDate": "Mar 31, 2020, 11:21:53 AM", "timeStamp": "Mar 31, 2020, 11:21:53 AM", "content": ["Hi all, I have inferred an unrooted tree from a \"small\" nucleotide dataset (15 taxa, ~300k positions, ~200 partitions) without outgroups. Now I am trying to use use the inferred topology as a constraint (-g) together with the UNREST model (aka 12.12) to place the root, just to see if/how it differs from the regular analysis with outgroups. It works fine as long as I do not consider the partitions, however, if I use partitions i get an error resulting in a core dump (iqtree 1.6.11 and 1.6.12 on two different clusters). I included the relevant part of the log below. Am I disregarding a specific property of the model that I am not aware of, or is this indeed a bug? I would be very happy to hear any suggestions you might have! Best, Jan Philip Log file: Converting unrooted to rooted tree... Converting unrooted to rooted tree... NOTE: 20 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.100) ERROR: pERROR: phERROR: phhphyphyyllooptortyheteryl.ee.cppotree.cppree.cpp::cpp:l:: 5135615316 :o t3re:6:e .:vcviv5136rtual void PhyloTree::reorie:iirpntrPtat urualaal5Lvirtu1lh (vPoh3yial vol dv6oid Ph PhyloTroNeighyi:eb:l odr P: rve*h,iNyoodroel o*T)eTr:t uArranlt Pvaerstseoiea:iedr tPihleoy:lLo:nhr(e :PohryiTreenert`:d:eorieaoNdPane_rbrsirhabnootciha-t>r *, prLihPartialLh(PN(aPrhtheyoidaeln_l otNPeyla*riloNei)tigh gaho:h&r * ,A&l L\" pharNbots(Poiserhtyr *, Node *alodNeilgiho_lh) bno ro:h&r * ,A&l L\" pharNbots(Poiserhtyr *, Node *alodNeilgiho_lh) bno r` **i,d as:Nd)_ obranch *): Assertion `dad_branch->partial_lh && \"partial_lh i:->pnas ontrAsser Asrseeto-tritailo roinr _tli`oeeohrndt iaee&d&ndt\"n_ebdr\" p' aanrcthi- aail'_>lpe`dad_branch->partial_lhaldh && \"ri ERROR: p ntoi fa farl_lh &&iS r\"apairlteTd.e-A ERROR: Cal_lhoKTRriiaAl ERROR: _ lhCeE s n*tneodF*O*Rt re-i DEBoUrsIG\"N inented'Q -f\"TRGE:E'i l efidl.ot re-orie ERROR: eCRnd.Ated\"' ERROR: SHES WITH SIGNAL ABORTED ERROR: ERROR: * ERROR: ERROR: faiee.*** *I ERROR: *** For b ERROR: *** IQ-TREE IQu-Qg TrCRASH-eportES WITR EpEHlT RC EeRaASsIEG eS HNsCEReAASn SdHW EISLTto de IAG WITHBNvAe OlLS oIprARsABL: ERROR: TEDR ERROR: TAE*D** R T *D** R T DoERROR: ERROR: *** For buERROR: ERROR: *** For bug r*g* eporti*l e F*:*op* nul eca_unfilr bFutgs_eor bug report please send to deve c lroseonppsoeend rrs: ERROR: t* tprlto de*eaaivs*e nelope ed.lors g es Lo fn ERROR: : ERROR: dtooile: *n***u d *ec _ve u* AnfiltLog l_lcifoogpnienmsernttr asifn:ieele: s (df ERROR: .nuc_unfiltlog ERROR: os tpr**osi* *ned.log** Alignment files ERROR: s i(iLfb** Alignment files ERROR: s i(iLfbopossgi bllef*i*)*e) ERROR: ERROR: l "]}, "i72zgB911ao": {"topic": "ERROR: Tree file does not start with an opening-bracket", "initializeDate": "Jan 15, 2019, 7:44:48 PM", "timeStamp": "Feb 19, 2019, 7:11:46 AM", "content": ["Hi, I am trying to run tree optimization on a partitioned data set. But the job fails with the message ERROR: Tree file does not start with an opening-bracket '(' (line 1 column 1) I wonder if the -bnni option is incompatible with using a partition file? Here are the command lines, the first fails, the second works iqtree_1.6.9_comet -wslr -s infile.txt -bb 1000 -sp partition.txt -wsl -bnni -st DNA -wsr -pre nop_cyc -nt AUTO if i remove the partition file, the job runs normally. iqtree_1.6.9_comet -wslr -s infile.txt -bb 1000 -wsl -bnni -st DNA -wsr -pre nop_cyc_noparts -nt AUTO Thanks for any advice Mark ", "Hi Mark, Thanks for reporting this, I confirm that this crash is a bug in the combination of two options -sp and -bnni. I\u2019ll have a closer look once back in ~2 weeks. Note that the edge-linked partition model (-spp) works fine with -bnni, which I actually recommend you to do, see a preprint on the comparison between the two partition models: https://doi.org/10.1101/467449 Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Mark, This issue is now fixed in version 1.6.10 just released. Thanks, Minh "]}, "H_XLsBIzprU": {"topic": "data input error", "initializeDate": "Jun 6, 2020, 3:39:51 AM", "timeStamp": "Jun 9, 2020, 3:57:24 AM", "content": ["Hello all, I'm using iq-tree for the first time. I have a sequence alignment in fasta format for reconstructing ML tree, but as I run it in iq-tree using the command iqtree -s gcspp.fas , it gives an error like this: Reading alignment file gcspp.fas ... ERROR: Cannot read file gcspp.fas I also tried it with phylip format, but still gives the same error. My sequences have same lengths, so what would be the possible problem? Sorry I can't find any answer/solution in the documentation online. Hope you guys can help... Thanks! ", "Hi Kuselah, It sounds like there is an error in your alignment file. If you can post the file here then we can take a look and advise. An example of an aligned fasta file is here: http://emboss.sourceforge.net/docs/themes/alnformats/align.fasta Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/42c15c55-7b56-4e4e-9341-20a490ceae68o%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Or perhaps because you ran IQ-TREE in a different folder, where this alignment does not exist? Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmoMHg05YWUjSOWe2yMG53UyajY7HEYAvFiBjCCEkjGdbQ%40mail.gmail.com ", "Hi Rob, Here is my fasta file. Thanks for taking a look. Best, Kuselah On Tuesday, June 9, 2020 at 8:17:50 AM UTC+8, Rob Lanfear wrote: Hi Kuselah, It sounds like there is an error in your alignment file. If you can post the file here then we can take a look and advise. An example of an aligned fasta file is here: http://emboss.sourceforge.net/docs/themes/alnformats/align.fasta Rob On Sat, 6 Jun 2020 at 17:39, Kuselah Tayaban < kmta...@gmail.com > wrote: Hello all, I'm using iq-tree for the first time. I have a sequence alignment in fasta format for reconstructing ML tree, but as I run it in iq-tree using the command iqtree -s gcspp.fas , it gives an error like this: Reading alignment file gcspp.fas ... ERROR: Cannot read file gcspp.fas I also tried it with phylip format, but still gives the same error. My sequences have same lengths, so what would be the possible problem? Sorry I can't find any answer/solution in the documentation online. Hope you guys can help... Thanks! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/42c15c55-7b56-4e4e-9341-20a490ceae68o%40googlegroups.com ", "Hi Minh, I'm in the right folder. If the file is in a different folder, the error would be \"file does not exist\", wouldn't it be? Thanks a lot, Kuselah On Tuesday, June 9, 2020 at 8:57:43 AM UTC+8, Minh Bui wrote: Or perhaps because you ran IQ-TREE in a different folder, where this alignment does not exist? Minh On 9 Jun 2020, at 10:17 am, Rob Lanfear < rob.l...@gmail.com > wrote: Hi Kuselah, It sounds like there is an error in your alignment file. If you can post the file here then we can take a look and advise. An example of an aligned fasta file is here: http://emboss.sourceforge.net/docs/themes/alnformats/align.fasta Rob On Sat, 6 Jun 2020 at 17:39, Kuselah Tayaban < kmta...@gmail.com > wrote: Hello all, I'm using iq-tree for the first time. I have a sequence alignment in fasta format for reconstructing ML tree, but as I run it in iq-tree using the command iqtree -s gcspp.fas , it gives an error like this: Reading alignment file gcspp.fas ... ERROR: Cannot read file gcspp.fas I also tried it with phylip format, but still gives the same error. My sequences have same lengths, so what would be the possible problem? Sorry I can't find any answer/solution in the documentation online. Hope you guys can help... Thanks! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/42c15c55-7b56-4e4e-9341-20a490ceae68o%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "It works just fine in my laptop (MacBook): ... Reading alignment file gcspp.fas ... Fasta format detected Alignment most likely contains DNA/RNA sequences Alignment has 134 sequences with 204 columns, 124 distinct patterns 55 parsimony-informative, 33 singleton sites, 116 constant sites So no idea what happened\u2026 which OS are you running? Mac, Windows, or Linux? Perhaps it has something to do with the file system, e.g. check the file permission. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8053551c-ed1f-4ded-904c-76317920387eo%40googlegroups.com ", "Hi Minh, I forgot to check file permission. It already worked! Thanks a lot, Kuselah To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8053551c-ed1f-4ded-904c-76317920387eo%40googlegroups.com "]}, "rFsm02Dy8Ps": {"topic": "Tratio in HKY model", "initializeDate": "Oct 1, 2018, 5:35:58 AM", "timeStamp": "Oct 1, 2018, 7:49:31 AM", "content": ["Hi, Does anyone know how to set the Tratio obtained for HKY model from Jmodeltest2 results in IQ-Tree? For example, my PAUP block from Jmodeltest is: BEGIN PAUP; Lset base=(0.2827 0.1944 0.1976 ) nst=2 tratio=2.0076 rates=gamma shape=0.6040 ncat=4 pinvar=0.4660; END; Thanks Olivier ", "Hi Olivier, You can use -m HKY{kappa} option. For your example incl. Gamma rate, the full model is: -m HKY{2.0076}+I{ 0.4660}+G4{ 0.6040 Minh PS: I don\u2019t know why you need to do jmodeltest, but ModelFinder (implemented in IQ-TREE) already does model selection automatically. See http://www.iqtree.org/doc/Tutorial You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Thank you for the help. I was using Jmodeltest because I wanted the models to be restricted for Mrbayes analysis but then I realised that I may specify it in my command using -mset mrbayes Now I need to sort your how to partition by gene and codon, finding the best partition scheme and setting the different models for each partition. I guess it should be fine. Many thanks Olivier "]}, "wHuVjiLDkPc": {"topic": "Is it possible for iqtree to output all 3 possible values of aBayes for a given internode?", "initializeDate": "Aug 9, 2017, 3:36:06 PM", "timeStamp": "Aug 21, 2017, 8:56:50 AM", "content": ["Hi, Minh. I would like to know if it is possible for iqtree to output all 3 values of approximate posteriors (aBayes) for a given internode. Thanks in advance, Filipe Moreira. ", "Dear Filipe, Do you mean to output not only the aBayes support for a current branch, but also the posteriors of the two nearest-neighbor-interchange branches? There is no such option\u2026 however, can you explain why such a feature can be useful? How are you familiar with C/C++? You can change the IQ-TREE source code in this function in phylotree.cpp file: double PhyloTree ::testOneBranch( double best_score, double *pattern_lh, int reps, int lbp_reps, PhyloNode *node1, PhyloNode *node2, double &lbp_support, double &aLRT_support, double &aBayes_support) { you will see this line: aBayes_support = 1.0 / ( 1.0 exp (lh[ ]-lh[ ]) + exp (lh[ ]-lh[ ])); Here, lh[0], lh[1], lh[2] are the log-likelihood for the current branch and the two swapped branches. You can add two lines of code like: double aBayes_support1 = 1.0 / ( 1.0 exp (lh[ ]-lh[ ]) + exp (lh[ ]-lh[ ])); double aBayes_support2 = 1.0 / ( 1.0 exp (lh[ ]-lh[ ]) + exp (lh[ ]-lh[ ])); And then output these 3 values in some way e.g. in the next function PhyloTree ::testAllBranches Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi, Minh. That is exactly what I need. I'm currently evaluating some large datasets and this quantities happen to be very usefull for comparisons. I'll try to change the IQ-tree source code. Thank you very much. Cheers, Filipe Moreira. ", "Hi, Mihn. I'm sorry for bothering you again with this. I tried to change IQ-tree source code as you sugested, but I failed to compile. I'm not really familiar with C/C++. I work better with perl and python. I edited the phylotree.cpp file as follows: double PhyloTree::testOneBranch(double best_score, double *pattern_lh, int reps, int lbp_reps, PhyloNode *node1, PhyloNode *node2, double &lbp_support, double &aLRT_support, double &aBayes_support) { const int NUM_NNI = 3; double lh[NUM_NNI]; double *pat_lh[NUM_NNI]; lh[0] = best_score; pat_lh[0] = pattern_lh; pat_lh[1] = new double[getAlnNPattern()]; pat_lh[2] = new double[getAlnNPattern()]; computeNNIPatternLh(best_score, lh[1], pat_lh[1], lh[2], pat_lh[2], node1, node2); double aLRT; if (lh[1] > lh[2]) aLRT = (lh[0] - lh[1]); else aLRT = (lh[0] - lh[2]); // compute parametric aLRT test support double aLRT_stat = 2*aLRT; aLRT_support = 0.0; if (aLRT_stat >= 0) { aLRT_support = Statistics_To_Probabilities(aLRT_stat); aBayes_support = 1.0 / (1.0 + exp(lh[1]-lh[0]) + exp(lh[2]-lh[0])); double aBayes_support1 = 1.0 / (1.0 + exp(lh[0]-lh[1]) + exp(lh[2]-lh[1])); // CHANGE! double aBayes_support2 = 1.0 / (1.0 + exp(lh[0]-lh[2]) + exp(lh[1]-lh[2])); // CHANGE! int SH_aLRT_support = 0; lbp_support = 0.0; int times = max(reps, lbp_reps); for (int i = 0; i < times; i++) { double lh_new[NUM_NNI]; // resampling estimated log-likelihood (RELL) resampleLh(pat_lh, lh_new); if (lh_new[0] > lh_new[1] && lh_new[0] > lh_new[2]) lbp_support += 1.0; double cs[NUM_NNI], cs_best, cs_2nd_best; cs[0] = lh_new[0] - lh[0]; cs[1] = lh_new[1] - lh[1]; cs[2] = lh_new[2] - lh[2]; if (cs[0] >= cs[1] && cs[0] >= cs[2]) { cs_best = cs[0]; if (cs[1] > cs[2]) cs_2nd_best = cs[1]; else cs_2nd_best = cs[2]; } else if (cs[1] >= cs[2]) { cs_best = cs[1]; if (cs[0] > cs[2]) cs_2nd_best = cs[0]; else cs_2nd_best = cs[2]; } else { cs_best = cs[2]; if (cs[0] > cs[1]) cs_2nd_best = cs[0]; else cs_2nd_best = cs[1]; if (aLRT > (cs_best - cs_2nd_best) + 0.05) SH_aLRT_support++; delete[] pat_lh[2]; delete[] pat_lh[1]; if (times > 0) lbp_support /= times; if (times > 0) return ((double) SH_aLRT_support) / times; else return 0.0; int PhyloTree::testAllBranches(int threshold, double best_score, double *pattern_lh, int reps, int lbp_reps, bool aLRT_test, bool aBayes_test, PhyloNode *node, PhyloNode *dad) { int num_low_support = 0; if (!node) { node = (PhyloNode*) root; root->neighbors[0]->node->name = \"\"; if (isSuperTree()) { int tmp = save_all_trees; save_all_trees = 2; bool nni5 = params->nni5; params->nni5 = true; // always optimize 5 branches for accurate SH-aLRT initPartitionInfo(); params->nni5 = nni5; save_all_trees = tmp; if (dad && !node->isLeaf() && !dad->isLeaf()) { double lbp_support, aLRT_support, aBayes_support; double SH_aLRT_support = (testOneBranch(best_score, pattern_lh, reps, lbp_reps, node, dad, lbp_support, aLRT_support, aBayes_support , aBayes_support1, aBayes_support2 ) * 100); // CHANGE! ostringstream ss; ss.precision(3); ss << node->name; if (!node->name.empty()) ss << \"/\"; if (reps) ss << SH_aLRT_support; if (lbp_reps) ss << \"/\" << lbp_support * 100; if (aLRT_test) ss << \"/\" << aLRT_support; if (aBayes_test) ss << \"/\" << aBayes_support; ss << \"/\" << aBayes_support1; // CHANGE! ss << \"/\" << aBayes_support2; // CHANGE! node->name = ss.str(); if (SH_aLRT_support < threshold) num_low_support = 1; if (((PhyloNeighbor*) node->findNeighbor(dad))->partial_pars) { ((PhyloNeighbor*) node->findNeighbor(dad))->partial_pars[0] = round(SH_aLRT_support); ((PhyloNeighbor*) dad->findNeighbor(node))->partial_pars[0] = round(SH_aLRT_support); FOR_NEIGHBOR_IT(node, dad, it) num_low_support += testAllBranches(threshold, best_score, pattern_lh, reps, lbp_reps, aLRT_test, aBayes_test, (PhyloNode*) (*it)->node, node); return num_low_support; I'm not entirely sure this makes sense in C/C++. I get the following error when compiling: [ 90%] Building CXX object tree/CMakeFiles/tree.dir/phylonode.cpp.o [ 91%] Building CXX object tree/CMakeFiles/tree.dir/phylonodemixlen.cpp.o [ 91%] Building CXX object tree/CMakeFiles/tree.dir/phylosupertree.cpp.o [ 92%] Building CXX object tree/CMakeFiles/tree.dir/phylosupertreeplen.cpp.o [ 93%] Building CXX object tree/CMakeFiles/tree.dir/phylotree.cpp.o //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/tree/phylotree.cpp: In member function \u2018int PhyloTree::testAllBranches(int, double, double*, int, int, bool, bool, PhyloNode*, PhyloNode*)\u2019: //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/tree/phylotree.cpp:4453:67: error: \u2018aBayes_support1\u2019 was not declared in this scope node, dad, lbp_support, aLRT_support, aBayes_support, aBayes_support1, aBayes_support2) * 100); // CHANGE! //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/tree/phylotree.cpp:4453:84: error: \u2018aBayes_support2\u2019 was not declared in this scope node, dad, lbp_support, aLRT_support, aBayes_support, aBayes_support1, aBayes_support2) * 100); // CHANGE! In file included from //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/tree/phylotree.cpp:23:0: //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/utils/bionj.h: In member function \u2018int BioNj::create(const char*, const char*)\u2019: //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/utils/bionj.h:676:24: warning: ignoring return value of \u2018int fscanf(FILE*, const char*, ...)\u2019, declared with attribute warn_unused_result [-Wunused-result] fscanf(input,\"%d\",&n); //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/utils/bionj.h: In member function \u2018void BioNj::Initialize(float**, FILE*, int, BioNj::POINTERS*)\u2019: //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/utils/bionj.h:141:36: warning: ignoring return value of \u2018int fscanf(FILE*, const char*, ...)\u2019, declared with attribute warn_unused_result [-Wunused-result] fscanf(input,\"%s\",name_taxon); /* read taxon\ufffds name */ //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/utils/bionj.h:156:36: warning: ignoring return value of \u2018int fscanf(FILE*, const char*, ...)\u2019, declared with attribute warn_unused_result [-Wunused-result] fscanf(input,\"%f\",&distance); /* read the distance */ make[2]: ** [tree/CMakeFiles/tree.dir/phylotree.cpp.o] Erro 1 make[1]: ** [tree/CMakeFiles/tree.dir/all] Erro 2 make: ** [all] Erro 2 I was hoping you could shed some light on it. Again, I'm sorry for bother. Respectfully, Filipe Moreira. ", "Dear Filipe, As I see it, the following might cause the problem: You have added the computation of the other two values (aBayes_support1, aBayes_support2) inside the routine PhyloTree::testOneBranch. However, you did not do that the same as it was for \"double &aBayes_support\u201d, that means in the first line of \u201cPhyloTree::testOneBranch\u201d which also defines its parameters. Thus, when you later try to call PhyloTree::testOneBranch with the two additional, but undefined, parameters, it has to fail. So, my suggestion is to add aBayes_support1 and aBayes_support2 after aBayes_support in the definition of PhyloTree::testOneBranch. In addition, remove the \u201cdouble\u201d before the computation of aBayes_support1 and aBayes_support2. Furthermore, you have to add the two variables to the line where aBayes_support is defined, that means in \"double lbp_support, aLRT_support aBayes_support;\u201d before the semicolon (this is causing the not defined in scope messages. I hope I did not miss anything. Please try\u2026 Cheers, Heiko ", "Hi, Heiko. I followed your suggestions and the code now looks like this: double PhyloTree::testOneBranch(double best_score, double *pattern_lh, int reps, int lbp_reps, PhyloNode *node1, PhyloNode *node2, double &lbp_support, double &aLRT_support, double &aBayes_support, double &aBayes_support1, double &aBayes_support2 ) { // change! const int NUM_NNI = 3; double lh[NUM_NNI]; double *pat_lh[NUM_NNI]; lh[0] = best_score; pat_lh[0] = pattern_lh; pat_lh[1] = new double[getAlnNPattern()]; pat_lh[2] = new double[getAlnNPattern()]; computeNNIPatternLh(best_score, lh[1], pat_lh[1], lh[2], pat_lh[2], node1, node2); double aLRT; if (lh[1] > lh[2]) aLRT = (lh[0] - lh[1]); else aLRT = (lh[0] - lh[2]); // compute parametric aLRT test support double aLRT_stat = 2*aLRT; aLRT_support = 0.0; if (aLRT_stat >= 0) { aLRT_support = Statistics_To_Probabilities(aLRT_stat); aBayes_support = 1.0 / (1.0 + exp(lh[1]-lh[0]) + exp(lh[2]-lh[0])); aBayes_support1 = 1.0 / (1.0 + exp(lh[0]-lh[1]) + exp(lh[2]-lh[1])); // CHANGE! double lbp_support, aLRT_support, aBayes_support , aBayes_support1, aBayes_support2 ; // change! I'm still unable to make it work. I get the following message on the terminal: //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/tree/phylotree.cpp:4358:8: error: prototype for \u2018double PhyloTree::testOneBranch(double, double*, int, int, PhyloNode*, PhyloNode*, double&, double&, double&, double&, double&)\u2019 does not match any in class \u2018PhyloTree\u2019 double PhyloTree::testOneBranch(double best_score, double *pattern_lh, int reps, int lbp_reps, In file included from //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/tree/phylotree.cpp:22:0: //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/tree/phylotree.h:1654:12: error: candidate is: double PhyloTree::testOneBranch(double, double*, int, int, PhyloNode*, PhyloNode*, double&, double&, double&) double testOneBranch(double best_score, double *pattern_lh, //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/tree/phylotree.cpp: In member function \u2018int PhyloTree::testAllBranches(int, double, double*, int, int, bool, bool, PhyloNode*, PhyloNode*)\u2019: //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/tree/phylotree.cpp:4453:99: error: no matching function for call to \u2018PhyloTree::testOneBranch(double&, double*&, int&, int&, PhyloNode*&, PhyloNode*&, double&, double&, double&, double&, double&)\u2019 node, dad, lbp_support, aLRT_support, aBayes_support, aBayes_support1, aBayes_support2) * 100); // CHANGE! //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/tree/phylotree.cpp:4453:99: note: candidate is: In file included from //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/tree/phylotree.cpp:22:0: //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/tree/phylotree.h:1654:12: note: double PhyloTree::testOneBranch(double, double*, int, int, PhyloNode*, PhyloNode*, double&, double&, double&) double testOneBranch(double best_score, double *pattern_lh, //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/tree/phylotree.h:1654:12: note: candidate expects 9 arguments, 11 provided In file included from //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/tree/phylotree.cpp:23:0: //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/utils/bionj.h: In member function \u2018int BioNj::create(const char*, const char*)\u2019: //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/utils/bionj.h:676:24: warning: ignoring return value of \u2018int fscanf(FILE*, const char*, ...)\u2019, declared with attribute warn_unused_result [-Wunused-result] fscanf(input,\"%d\",&n); //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/utils/bionj.h: In member function \u2018void BioNj::Initialize(float**, FILE*, int, BioNj::POINTERS*)\u2019: //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/utils/bionj.h:141:36: warning: ignoring return value of \u2018int fscanf(FILE*, const char*, ...)\u2019, declared with attribute warn_unused_result [-Wunused-result] fscanf(input,\"%s\",name_taxon); /* read taxon\ufffds name */ //mnt/c/Users/filip/Downloads/IQ-TREE-1.6.beta4/utils/bionj.h:156:36: warning: ignoring return value of \u2018int fscanf(FILE*, const char*, ...)\u2019, declared with attribute warn_unused_result [-Wunused-result] fscanf(input,\"%f\",&distance); /* read the distance */ make[2]: ** [tree/CMakeFiles/tree.dir/phylotree.cpp.o] Erro 1 make[2]: ** Esperando que outros processos terminem. make[1]: ** [tree/CMakeFiles/tree.dir/all] Erro 2 make: ** [all] Erro 2 I tried to to find my mistake on the error message, but as you can imagine, I could not find it. Cheers, Filipe. ", "Hi Filipe, you need to change the declaration in header file (phylotree.h) to make it the same, these lines: /** Test one branch of the tree with aLRT SH-like interpretation double testOneBranch( double best_score, double *pattern_lh, int reps, int lbp_reps, PhyloNode *node1, PhyloNode *node2, double &lbp_support, double &aLRT_support, double &aBayes_support); That should resolve this error. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi, Mihn. I did that and it works great now! Thank you very much, seriouslly. Best regards, Filipe Moreira. ", "Hi Filipe, great to hear this. Moreover, do you know Git and GitHub? If so, when you finished can you please possibly commit and submit a pull request in GitHub, so that I can merge your changes into the main code? The idea is that IQ-TREE is an open-source project, so people are very welcome to contribute code to it. Cheers, Minh ", "Hi, Mihn. Yes, of course! I'll do that as soon as I'm finished. Again, thanks a lot for your help. Best regards, Filipe. "]}, "xxz2iSY73Fs": {"topic": "Is it possible to use IQTREE to compare different gene tree topologies using AU/SH test ?", "initializeDate": "Apr 18, 2019, 4:26:06 PM", "timeStamp": "Apr 23, 2019, 8:53:14 PM", "content": ["Hi, I have four concensus ML gene trees (from IQTREE) that I would like to test for their congruency. I am wondering whether I can use the tree topology testing function for that. If it is possible pleasehelp me with the code. I am new to IQTREE and used the IQTREE web server to construct the ML trees Thank you ", "Hi, You will need to download and use the command line binary. Please have a look at: http://www.iqtree.org/doc/Advanced-Tutorial#tree-topology-tests Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "C0RnOpjf050": {"topic": "Question regarding using -allnni -ninit 1 -nstop 100", "initializeDate": "Feb 23, 2020, 8:21:12 AM", "timeStamp": "Feb 23, 2020, 10:31:52 PM", "content": ["Hi! When using -allnni -ninit 1 -nstop 100, I suppose that at each iteration we move to the best NNI. What move is taken by the algorithm when all NNI are worst than the current tree? does it move to the best one among them, or pick a random one and moves from there? Thanks! Noa ", "Hi Noa, If all NNIs are worse than the current tree in terms of likelihood, then we\u2019ll just retain the current tree as the best tree for the current iteration. That\u2019s the hill-climbing algorithm \u2014 we stop when we cannot climb further up. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ab4aa5b5-9349-4715-9633-a18a405883bb%40googlegroups.com "]}, "OS-MY79aPGM": {"topic": "Re: IQ-TREE \u201c-m C60+LG+G+F\u201d vs \u201c-m LG+C60+G+F\u201d", "initializeDate": "Nov 20, 2017, 7:14:04 AM", "timeStamp": "Nov 20, 2017, 7:14:04 AM", "content": ["Hi Ding, This is a very good remark, thus I\u2019m replying to the IQ-TREE forum here, in case other users observed this. IQ-TREE uses alias so that users can specify very complex models with a short model string. In this case, C60 is alias for POISSON+G+FMIX{\u2026}, which specifies the profile mixture model with Gamma rate and importantly, equal amino-acid substitution rate (reflected by POISSON matrix). Therefore: 1. C60+LG+G+F is interpreted as POISSON+G+FMIX{\u2026}+LG+G+F. While parsing this model string, the matrix, which comes first, \u201cwins\". Therefore, IQ-TREE applies POISSON matrix. 2. LG+C60+G+F is interpreted as LG+POISSON+G+FMIX{\u2026}+G+F. Therefore the LG matrix is used. That\u2019s why you should get a much higher log-likelihood with the 2nd model LG+C60+G+F. Hope that helps, Minh On Nov 20, 2017, at 10:15 AM, Ding He < din...@ebc.uu.se > wrote: Hi Minh, I happened to notice last week that the model settings for \"C60+LG+G+F\u201d and \u201cLG+C60+G+F\u201d are actually different, as I got drastic different lnL values. I know that the explanation in the manual seems always to be \u201cLG+C60+G+F\u201d, but I think that the model setting could be easily mistakenly wrongly used because of the order difference. Best, /Ding Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "7Jbi9_HMmLI": {"topic": "Homepage IQtree", "initializeDate": "Oct 28, 2016, 11:57:28 AM", "timeStamp": "Oct 28, 2016, 1:58:31 PM", "content": ["Hi all, I can get to the IQtree homepage but none of the pages is working anymore currently - is this a server issue? best Karen ", "Hi Karen, thanks for noticing this ... the problem is fixed now. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "poKUCGT3QzI": {"topic": "IQtree 1.6.5 crash - \"Assertion `freq_type != FREQ_UNKNOWN' failed\"", "initializeDate": "Jun 6, 2018, 1:53:20 PM", "timeStamp": "Jun 6, 2018, 1:54:49 PM", "content": ["Hi, I'm running IQtree on a very large alignment of ~17,000 genes. I just got this error: ERROR: modelmarkov.cpp:274: void ModelMarkov::init_state_freq(StateFreqType): Assertion `freq_type != FREQ_UNKNOWN' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: twilight_extended.log ERROR: *** Alignment files (if possible) /var/spool/torque/mom_priv/jobs/ 2259626.node96.SC : line 8: 5841 Aborted This is running on linux with the following command with 500GB of RAM available: iqtree -s long_aln.aln -nt 12 -m LG4X -bb 10000 -nm 10000 -abayes -alrt 1000 -pre twilight_extended The tail end of the log file reads: Create initial parsimony tree by phylogenetic likelihood library (PLL)... 25323.288 seconds Generating 10000 samples for ultrafast bootstrap (seed: 407400)... Model LG4X is alias for MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4 ERROR: modelmarkov.cpp:274: void ModelMarkov::init_state_freq(StateFreqType): Assertion `freq_type != FREQ_UNKNOWN' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: twilight_extended.log ERROR: *** Alignment files (if possible) Any help/insight would be greatly appreciated. Thank you! -Andrew ", "I noticed this is a possible bug when using LG4M and LG4X in 1.6.5, see thread here: https://groups.google.com/forum/#!topic/iqtree/Wgob9pyABtM "]}, "BQVdAjl4SNc": {"topic": "New citation for the ultrafast bootstrap (UFBoot)", "initializeDate": "Oct 25, 2017, 7:13:55 AM", "timeStamp": "Feb 13, 2018, 11:35:16 PM", "content": ["Dear users, We have now a new citation for the ultrafast bootstrap (UFBoot): D.T. Hoang, O. Chernomor, A. von Haeseler, B.Q. Minh, and L.S. Vinh (in press) UFBoot2: Improving the ultrafast bootstrap approximation. Mol. Biol. Evol., in press. https://doi.org/10.1093/molbev/msx281 Please change your citation accordingly for the UFBoot from now on. Kind regards, Minh (on behalf of co-authors) ", "Dear Minh I recognized that a job with -bb 1000 and -bnni crashed with the mpi version (release 1.6.1) and moi related error messages. Can UFboot run with the mpi version or is this not possible yet? Do i have to put in the command line in addition -fast? Best and thanks in advance Karen "]}, "ICyYCtpBn48": {"topic": "*** IQ-TREE CRASHES WITH SIGNAL ABORTED", "initializeDate": "Sep 8, 2016, 11:14:43 AM", "timeStamp": "Sep 9, 2016, 4:43:50 AM", "content": ["Bit of a novice here but I've just downloaded and am trying to run iqtree-omp on my dataset with -m test to see which model fits best but getting an error (log attached), however the dataset seems to run fine on the web server. Any help would be appreciated. ", "Hi there, thanks for noticing this bug early in the beta version 1.5.0-beta, which I have fixed. You can now download again. Cheers, Minh > On Sep 8, 2016, at 5:14 PM, 'wl284' via IQ-TREE < iqt...@googlegroups.com > wrote: > Bit of a novice here but I've just downloaded and am trying to run iqtree-omp on my dataset with -m test to see which model fits best but getting an error (log attached), however the dataset seems to run fine on the web server. Any help would be appreciated. > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout > <combinedgroups_trimal_headers.fasta.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "fiZl0--nU6Y": {"topic": "Finding the right partitioning scheme in IQTREE", "initializeDate": "Jun 3, 2020, 8:52:27 AM", "timeStamp": "Jun 5, 2020, 5:49:33 AM", "content": ["Hello, I'm trying to find the right partitioning scheme in iqtree for my dataset. I'm running the analysis on cluster and getting this error: Numerical underflow (lh-derivative). Run again with the safe likelihood kernel via `-safe` option Can anyone tell me the meaning of this error? ", "Hi Mukta, The error means that the log-likelihood computation is numerically underflown. It happens with very large datasets. So simply follow its suggestions by using -safe. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6ea75f5f-47c1-4419-a0fb-0e44008c286f%40googlegroups.com ", "Hi, I added -safe option as you suggested. I also increased number of nodes pee CPU. The problem seems to persist. I'm using IQTREE version 2. any chance the problem is due to that? ", "These are the multiple error messages I'm getting after using -safe option WARNING: Numerical underflow for lh-derivative ERROR: phylokernelnew.h:3273: double PhyloTree::computeLikelihoodFromBufferSIMD() [with VectorClass = Vec4d; int nstates = 4; bool FMA = true; bool SITE_MODEL = false]: Assertion `std::isfinite(tree_lh) && \"Numerical underflow for lh-from-buffer\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 5 () ERROR: 6 double PhyloTree::computeLikelihoodFromBufferSIMD<Vec4d, 4, true, false>() ERROR: 7 () ERROR: 8 GOMP_parallel() ERROR: 9 PhyloSuperTreePlen::optimizeOneBranch(PhyloNode*, PhyloNode*, bool, int) ERROR: 10 PhyloTree::optimizeAllBranches(int, double, int) ERROR: 11 PhyloTree::testNumThreads() ERROR: 12 computeFastMLTree(Params&, Alignment*, ModelCheckpoint&, ModelsBlock*, int&, int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) ERROR: 13 runModelFinder(Params&, IQTree&, ModelCheckpoint&) ERROR: 14 startTreeReconstruction(Params&, IQTree*&, ModelCheckpoint&) ERROR: 15 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 16 main() ERROR: 17 __libc_start_main() ERROR: 18 () ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: FcC_supermatrix_partition.txt.log ERROR: *** Alignment files (if possible) /var/spool/slurmd/job2626169/slurm_script: line 11: 97133 Aborted (core dumped) iqtree -s FcC_supermatrix.fas -p FcC_supermatrix_partition.txt -m MF+MERGE -T AUTO -safe ", "This information is helpful, Thanks. Does it work when you specify the number of threads, instead of -T AUTO? Minh ", "Hi, No, it still doesn't work "]}, "BnJ5iRDGDH0": {"topic": "BUG: iqtree 1.7-beta7 Concordance Factors - Assertion `!aln->ordered_pattern.empty()' failed", "initializeDate": "Feb 5, 2019, 4:18:45 PM", "timeStamp": "Feb 5, 2019, 10:22:13 PM", "content": ["Hello, I am trying to use the new concordance factor feature in iqtree 1.7-beta7. I am using Linux (CentOS 6.10). When I try to run the analysis, it throws errors when creating \"initial parsimony tree by phylogenetic likelihood library (PLL)\". ERROR: phylotreepars.cpp:63: void PhyloTree::computePartialParsimonyFast(PhyloNeighbor *, PhyloNode *): Assertion `!aln->ordered_pattern.empty()' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: concat.log ERROR: *** Alignment files (if possible) I have tried using a directory of NEXUS files as input, and I have also tried with a concatenated NEXUS file with NEXUS CHARSET partitions specified as the partitions file. Both give the same errors.I have also tried withboth UFBoot and standard non-parametric bootstraps. Here are the commands I have tried to run the analysis with: iqtree_beta77 -s $ALN_FILE -p $ALN_FILE --prefix concat -bb 1000 -nt 32 iqtree_beta77 -p $ALN_DIR --prefix concat -bb 1000 -nt 32 iqtree_beta77 -s $ALN_FILE -p $ALN_FILE --prefix concat -b 100 -nt 32 iqtree_beta77 -s $ALN_FILE -p $ALN_FILE --prefix concat -B 1000 -nt 32 I have attached a file with all WARNINGS and ERRORS from the log file. Could you please look into this? Thank you for your time. -Bradley Martin ", "Looks like the problem is fixed with version 1.7-beta8. Just saw that you pushed the new beta earlier today. Ran it with the new version and it got past the point where v. 1.7-beta7 would throw errrors. Sorry about that. ", "Hi Bradley, No worries, good that you realised the new version which just fixed this issue. Moreover, I\u2019m not sure if this is a bug or a feature. The assertion occurs when there is at least one gene with no variant sites, i.e. all sequences within this gene are identical, which is even less than parsimony-informative. So this gene tree will be essentially \u201crandom\u201d and will reduce the concordance factor. One can either be happy with that or can remove such genes from the analysis. In the beta8 version IQ-TREE will print a warning: WARNING: No variant sites in partition ... So that you know what to remove in the latter case. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hello, Thank you for your insight and prompt reply. I will probably filter out the non-informative loci. I did encounter another error that occurred during model selection and that I want to ask you about: 7995 JC 269.016 BOX_6219 0h:41m:14s (0h:27m:6s left) 7996 F81+F+I 281.284 BOX_12239 0h:41m:15s (0h:27m:6s left) 7997 K2P+R2 565.220 BOX_6888 0h:41m:15s (0h:27m:5s left) 7998 K3P+R2 415.668 BOX_9997 0h:41m:15s (0h:27m:5s left) ERROR: modelmarkov.cpp:1246: virtual void ModelMarkov::decomposeRateMatrix(): Assertion `(Q - Q.transpose()).cwiseAbs().maxCoeff() < 1e-4 && \"transformed Q is symmetric\"' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: concat.log ERROR: *** Alignment files (if possible) (END) In addition, there were multiple warnings that said: WARNING: ABNORMAL_TERMINATION_IN_LNSRCH I have attached another .txt file with all the warnings. Sorry to bother you again about this, but I wanted to ask you about it in case it might be something that can be fixed in the code. It might also be because I had a bunch of invariant and non-informative loci, so I will try pre-filtering those and re-running model selection in the meantime. "]}, "ImYyg4KcoP4": {"topic": "iqtree.cibiv.univie.ac.at - does not work", "initializeDate": "Jul 30, 2019, 4:29:54 AM", "timeStamp": "Jul 30, 2019, 7:05:17 AM", "content": ["I'm trying to analyze, but I get the answer: Sorry, there is an issue with the cluster system. We are trying to resolve it asap! Please, repair my favorite server! ", "Dear Dmitry Karabanov, Thank you for letting us know. However, I have just sent a test job and it ran fine. Could you give us any more information on how and what kind of job you ran? Best wishes, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7ecc0a03-6c13-43cb-8d26-2aa897acdab6%40googlegroups.com ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Thanks a lot! Oh, it was probably a problem with my file. My file's name had symbols ! and & - probably, this caused the server to crash. I renamed the file - Hallelujah - it's OK. Good luck CIBIV's WEB-IQ-TREE ! Dmitry \u0432\u0442\u043e\u0440\u043d\u0438\u043a, 30 \u0438\u044e\u043b\u044f 2019 \u0433., 12:22:20 UTC+3 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c Heiko \u043d\u0430\u043f\u0438\u0441\u0430\u043b: Dear Dmitry Karabanov, Thank you for letting us know. However, I have just sent a test job and it ran fine. Could you give us any more information on how and what kind of job you ran? Best wishes, Heiko > On 30 Jul 2019, at 10:29, Dmitry Karabanov < dkara...@gmail.com > wrote: > I'm trying to analyze, but I get the answer: > Sorry, there is an issue with the cluster system. We are trying to resolve it asap! > Please, repair my favorite server! > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "3RWDnAwBoTY": {"topic": "ERROR: Failure to initialize candidate tree set", "initializeDate": "May 7, 2019, 2:44:57 PM", "timeStamp": "Aug 25, 2019, 12:21:43 AM", "content": ["I'm attempting to debug an error on a PI-requested codon analysis (model and tree inference) of a large dataset when I get this error message: ERROR: ratefree.cpp:539: double RateFree::optimizeWithEM(): Assertion `score > old_score-0.1' failed. I've not found a similar issue in the forum or online, but please excuse this question if I've missed something simple. First 10 lines of .log file: IQ-TREE multicore version 1.6.9 for Linux 64-bit built Jan 22 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: cn29.nauhpc (AVX2, FMA3, 125 GB RAM) Command: iqtree -sp NucleotidePartitionsByGene.txt -s Concat_nucleotide.phy -m MFP -st CODON -nt AUTO Seed: 262564 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Tue Apr 9 11:15:25 2019 Kernel: AVX+FMA - auto-detect threads (24 CPU cores detected) Last 10 lines: Site proportion and rates: (0.4657870010,0.1283919747) (0.0490415774,0.5136251505) (0.0583198990,0.7246289329) (0.4268515227,2.0879156130) Partition ORTHOMCL7388 score: -16690.1238169364 old_score: -16688. 8208108865 ERROR: ratefree.cpp:539: double RateFree::optimizeWithEM(): Assertion `score > old_score-0.1' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: NucleotidePartitionsByGene.txt.log ERROR: *** Alignment files (if possible) Thank you for any help, Chris ", "Hi Chris, Thanks for the report (it\u2019s not been discussed before). Did you see any other WARNINGs in the log file? If so, pls paste them here. It seems like a problem with the EM algorithm or numerical issues with codon models. Can you please rerun with option: \"-optalg BFGS\" to use another algorithm. If that still does not work, then please send the input data to my personal email for further inspection. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/70cb6900-ad6d-4ee1-923a-c4ff936aaaa0%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Hi All, I'm having the same problem as Chris: When I run: iqtree -s HAP2_myrmeco.fas -m MFP -st CODON -bb 1000 I get: Site proportion and rates: (0.5000000000,0.3068528194) (0.5000000000,1.6931471806) ERROR: ratefree.cpp:530: double RateFree::optimizeWithEM(): Assertion `score < 0' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: HAP2_myrmeco.fas.log ERROR: *** Alignment files (if possible) Aborted _____________________________________ If I try with -optalg BFGS, it gives me a lot of Warnings like: WARNING: Numerical underflow for lh-branch Nonsynonymous/synonymous ratio (omega): 0.001 Transition/transversion ratio (kappa): 1.000 Site proportion and rates: (0.167,0.088) (0.167,0.290) (0.167,0.542) (0.167,0.882) (0.167,1.405) (0.167,2.792) Plus the error: ERROR: phylokernelnew.h:3184: double PhyloTree::computeLikelihoodFromBufferGenericSIMD() [VectorClass = Vec4d, FMA = true, SITE_MODEL = false]: Assertion `!std::isnan(tree_lh) && \"Numerical underflow for lh-from-buffer\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: HAP2_myrmeco.fas.log ERROR: *** Alignment files (if possible) Aborted _____________________________________________ If I do: iqtree -s HAP2_myrmeco.fas -m TEST -st CODON -bb 1000 -optalg BFGS I get: Generating 98 parsimony trees... 0.031 second Computing log-likelihood of 91 initial trees ... 3.773 seconds Current best score: 87564.246 Do NNI search on 20 best initial trees Estimate model parameters (epsilon = 0.100) BETTER TREE FOUND at iteration 1: 87387.553 ERROR: iqtree.cpp:3215: virtual pair<int, int> IQTree::optimizeNNI(bool): Assertion `curScore > appliedNNIs.at(0).newloglh - 0.1 && \"Using one NNI reduces LogL\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: HAP2_myrmeco.fas.log ERROR: *** Alignment files (if possible) Aborted ______________ Am I doing something wrong? Thank you, Caio ________________________________________ Mr. Caio A. Leal-Dutra PhD Candidate (Microbiology F28 Post room, Cledwyn Building, Penglais Institute of Biological, Environmental & Rural Sciences Aberystwyth University Aberystwyth SY23 3DD UK To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8856E2BB-8525-47DA-ABCF-8F7ECB4802F3%40univie.ac.at ", "Hi Caio, The original poster of this thread did not follow up, so I thought it was solved. From the output you pasted, it now looks like an issue with codon model optimisation, where the estimate of omega is close to 0 (0.001). I think that caused the numerical problem. Nevertheless, can you send me the alignment via my personal email for further inspection? Thanks, Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAEeBS4ySiMm%2BsfReYdK6PiJNu%2BR%2Ba0J7pTnDk9EZuKnfJzTHDw%40mail.gmail.com "]}, "lmXNZPGBJ20": {"topic": "infering species-tree (revPoMo) with variable numbers of individuals across genes", "initializeDate": "Apr 11, 2019, 4:18:52 AM", "timeStamp": "Apr 11, 2019, 6:44:12 AM", "content": ["Hi, [sorry, but I keep having many questions as I proceed on how to best analyse my (real) data] my doubts now are about how to best convert sequences in counts data when the data if multi-individuals and multigenes, where the nr of individuals/chromosomes is different across genes and species; goal being species-tree estimation. example: say I have this matrix: lines are loci (acm4, bfib, etc) and collumns are \"species\". numbers are the nr of sequences for each gene and species. nrs of sequences per species can vary widely across genes (see for example PA: 4 sequences for acm4 vs 10 for other genes) and thus I can not \"concatenate\" all genes in a fasta making a single count file. I can of course make separate count files for each gene and \"cat\" them a-posteriori (perhaps identifying them as different chromosomes so I don't have to change the \"POS\" numbering also...) Question: would the (largely) variable total counts across the \"genome\" (=at the different locus) for each species interfere with the inferences? will the program run at all when detecting it? I don't have a good feeling for this... would it somehow be advisable to have an identical nr of sequences across genes for a same species? Is coding each \"gene\" as a different \"chromossome\" the best way to deal with this multiple-loci problem (in practice, because of the coding of POS in the counts file)? many thanks again, sara ", "Hi Sara Sara Rocha < spr...@gmail.com > writes: > Hi, > [sorry, but I keep having many questions as I proceed on how to best > analyse my (real) data] > my doubts now are about how to best convert sequences in counts data when > the data if multi-individuals and multigenes, where the nr of > individuals/chromosomes is different across genes and species; goal being > species-tree estimation. > example: say I have this matrix: > [image: Captura de ecra\u0303 2019-04-11, a\u0300s 10.03.39.png] > lines are loci (acm4, bfib, etc) and collumns are \"species\". numbers are > the nr of sequences for each gene and species. > nrs of sequences per species can vary widely across genes (see for example > PA: 4 sequences for acm4 vs 10 for other genes) and thus I can not > \"concatenate\" all genes in a fasta making a single count file. *I can of > course make separate count files for each gene and \"cat\" them a-posteriori > (perhaps identifying them as different chromosomes so I don't have to > change the \"POS\" numbering also...)* I see. Since we did not have to deal with such a situation yet, we do not handle it in our conversion scripts. What you could do is create a fasta multi sequence alignment, where you could use gaps (-) or Ns for genes that are not present. These sites are ignored during conversion to the counts file. > *Question: would the (largely) variable total counts across the \"genome\" > (=at the different locus) for each species interfere with the inferences? > will the program run at all when detecting it?* I don't have a good feeling > for this... would it somehow be advisable to have an identical nr of > sequences across genes for a same species? Is coding each \"gene\" as a > different \"chromossome\" the best way to deal with this multiple-loci > problem (in practice, because of the coding of POS in the counts file)? Varying counts should not be a problem. We designed PoMo so that it can deal with this. Let me know, if you have trouble! Best, Dominik > many thanks again, > sara ", "Hi, On 11 Apr 2019, 10:38 +0200, Dominik Schrempf < dominik....@gmail.com >, wrote: Hi Sara Sara Rocha < spr...@gmail.com > writes: Hi, [sorry, but I keep having many questions as I proceed on how to best analyse my (real) data] my doubts now are about how to best convert sequences in counts data when the data if multi-individuals and multigenes, where the nr of individuals/chromosomes is different across genes and species; goal being species-tree estimation. example: say I have this matrix: [image: Captura de ecra\u0303 2019-04-11, a\u0300s 10.03.39.png] lines are loci (acm4, bfib, etc) and collumns are \"species\". numbers are the nr of sequences for each gene and species. nrs of sequences per species can vary widely across genes (see for example PA: 4 sequences for acm4 vs 10 for other genes) and thus I can not \"concatenate\" all genes in a fasta making a single count file. *I can of course make separate count files for each gene and \"cat\" them a-posteriori (perhaps identifying them as different chromosomes so I don't have to change the \"POS\" numbering also...)* I see. Since we did not have to deal with such a situation yet, we do not handle it in our conversion scripts. What you could do is create a fasta multi sequence alignment, where you could use gaps (-) or Ns for genes that are not present. These sites are ignored during conversion to the counts file. right\u2026 since individuals are actually different, this seems more cumbersome that doing different countfiles for the different genes/alignments and \"adding\" them up. will the program have any problem with identical \"POS\" labelings across the different \"genes\"? can I have different \"chromosomes\" (=genes) , each starting anew \"POS\", or I will have to edit the \"POS\" to be consecutive? [because it is supposed to consider all SNPs unlinked (I think) the \"CHROM\" should not matter here\u2026 but maybe in practice I run into problems] *Question: would the (largely) variable total counts across the \"genome\" (=at the different locus) for each species interfere with the inferences? will the program run at all when detecting it?* I don't have a good feeling for this... would it somehow be advisable to have an identical nr of sequences across genes for a same species? Is coding each \"gene\" as a different \"chromossome\" the best way to deal with this multiple-loci problem (in practice, because of the coding of POS in the counts file)? Varying counts should not be a problem. We designed PoMo so that it can deal with this. Let me know, if you have trouble! OK! Best, Dominik many thanks again, sara You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi again, sorry, I was not answering your question about the position POS. It is only for your reference, and not used by IQ-TREE, so you can set it to NaN, or anything you like! Dominik ", "great, all solved for now :S thanks again! Sara Rocha Post-Doc Researcher Phylogenomics Group University of Vigo (Spain) http://darwin.uvigo.es/sara-rocha/ "]}, "zBDVP_WFDo4": {"topic": "IQ-TREE heterotachy version", "initializeDate": "Apr 17, 2017, 6:03:31 PM", "timeStamp": "Apr 20, 2017, 7:57:24 AM", "content": ["Is there a solution for quickly viewing the trees that are outputted in the extended newick format you described? You said: \"it is an extended NEWICK format to store multiple branch lengths per branch of the same tree topology. For example:(A:0.1/0.2,B:0.2/0.3,(C:0.2/0.4,D:0.5/0.1):0.3/0.2);means a mixture of 2 trees:(A:0.1,B:0.2,(C:0.2,D:0.5):0.3); and(A:0.2,B:0.3,(C:0.4,D:0.1):0.2; How do I use this data in my case there are 3 branch lengths given. Do I have to just create the 3 trees by editing it by hand, or is there an R script or other for viewing the trees? Also I did not run the bootstraps; is there a way I can avoid the multiple day run it took just to get the tree and shortcut to run the bootstrap portion of the analysis based on the saved files? Finally how should I interpret the site probabilities? Here are a few lines of the 216947 I have.... Site p1 p2 p3 p4 1 0.0357489 0.726862 0.168243 0.0691462 2 1.08942e-08 0.229369 0.291766 0.478865 3 0.378487 0.570378 0.0157885 0.035346 4 0.100673 0.591423 0.0267024 0.281202 5 0.019303 0.769674 0.178257 0.0327659 6 0.0296788 0.717524 0.0558741 0.196923 7 4.69315e-06 0.13921 0.581559 0.279227 8 0.00229103 0.778053 0.0522895 0.167367 Have you submitted a manuscript about the method yet? Cheers Chris ", "Hi Chris, Unfortunately in the current version of IQ-TREE there is no quick and easy tree viewing options compatible with the output tree format of the heterotachy option. This is being addressed and the next version of IQ-TREE will output the heterotachy trees in a more user friendly format. Until then I can offer you the solution that I used when I was testing and validating the heterotachy model. I wrote a short R script that takes the tree string as it is output by the heterotachy model and separates it, storing separate Newick trees for each class in a list object. Here is the important lines: classNewickTrees <- list() for (i in 1:m){ classNewickTrees[[i]] <- str_replace_all(heterotachyTree, regex(paste(rep(\"(\\\\d+\\\\.\\\\d+)\", m), collapse=\"/\")), paste(\"\\\\\", i, sep=\"\")) In this code the variable \u2018m' is the number of heterotachy classes and the variable \u2018heterotachyTree' is the character string of the heterotachy tree you are trying to split into classes. If the code runs successfully then the variable \u2018classNewickTrees' should contain a separate tree for each class in Newick format. These can then be viewed easily in R using the \u2018ape\u2019 package or printed to a file so you can use another tree viewer. Unfortunately there is not sufficient information stored in the output files to enable a bootstrap analysis to be completed from these alone. So I am afraid if you want to do a bootstrap you must complete the whole analysis again. The site probabilities can be interpreted as the probability that a particular site evolves under each class. So for each site the probabilities should sum to one. To use the first site in your alignment as an example, we assume that the site evolved under one of the four classes in your model, but we cannot know for certain which one. We can see from the site probabilities that the probability that this site belongs to class 2 is 0.726862, the probability it belongs to class 3 is 0.168243, the probability it belongs to class 4 is 0.0691462 and the probability it belongs to class 1 is 0.0357489. I have not yet submitted the manuscript for the method, we have been making some final revisions and we expect to submit the manuscript in the next few weeks. Thanks for using the model, I hope you find it useful! Stephen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "This worked thanks: library(phytools) #or ape setwd(\"/yourpathtodirectorywithiqtreefiles\") dir() install.packages(\"readr\") library(readr) heterotachyTree <- read_file(\"iq_tree.phy.treefile\") m=4 # classNewickTrees <- list() for (i in 1:m){ classNewickTrees[[i]] <- str_replace_all(heterotachyTree, regex(paste(rep(\"(\\\\d+\\\\.\\\\d+)\", m), collapse=\"/\")), paste(\"\\\\\", i, sep=\"\")) class(classNewickTrees) mytrees<-read.tree(text=paste(classNewickTrees)) plot(mytrees, cex=0.4) ", "Hi Chris, thanks for the scripts... the next release with the heterotachy model (in a few weeks) will be more user-friendly. Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com "]}, "w_xsK4w5j9o": {"topic": "BUG: NUMERICAL ERROR: Too many iterations in tqli -Codon models", "initializeDate": "Jun 11, 2018, 5:18:09 AM", "timeStamp": "Jun 23, 2018, 7:26:41 AM", "content": ["Hello, I am running tree search for a superalignment of 14 taxa and ~ 3000 sites under an edge-linked partition model (-spp) for a set of protein coding nucleotide partitions by using codon models. I am using version 1.5.5. Initially, I performed one tree search with the option -m MFP for model selection (among codon models) and subsequent tree reconstruction which completed successfully. Subsequently i used the resulting partition nexus file (with the selected codon models) for additional tree searches and got the following error. /share/scientific_bin/iqtree/1.5.5/iqtree-omp -nt 12 -s supermatrix.fas -spp codon_all_ic=0_1.best_scheme.nex -st CODON -gmedian -pre codon_all_ic=0_3 -safe WARNING: TGG is not present in partition EOG090R0MBJ that may cause numerical problems WARNING: TGC, TGG are not present in partition EOG090R0JJ7 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0GVP that may cause numerical problems WARNING: GGA, TAT are not present in partition EOG090R07B5 that may cause numerical problems WARNING: AGG is not present in partition EOG090R0NCT that may cause numerical problems WARNING: TAC, TGG are not present in partition EOG090R092T that may cause numerical problems WARNING: AGA, AGG, CGA, CGG are not present in partition EOG090R0J1D that may cause numerical problems WARNING: GCC is not present in partition EOG090R0L3Y that may cause numerical problems WARNING: TGG is not present in partition EOG090R07WS that may cause numerical problems WARNING: TGG is not present in partition EOG090R058C that may cause numerical problems WARNING: TGG is not present in partition EOG090R0DQF that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R0DKJ that may cause numerical problems WARNING: TGC, TGG, TGT are not present in partition EOG090R0IML that may cause numerical problems WARNING: ATG is not present in partition EOG090R0IMW that may cause numerical problems WARNING: CAC, CGG are not present in partition EOG090R0J4P that may cause numerical problems WARNING: CCC, CCG, TAT are not present in partition EOG090R0LWV that may cause numerical problems WARNING: TGG is not present in partition EOG090R06AZ that may cause numerical problems WARNING: TGG is not present in partition EOG090R0E8S that may cause numerical problems WARNING: CGG, CGT, TAC, TAT, TGG are not present in partition EOG090R0IM5 that may cause numerical problems WARNING: GGG, TGG are not present in partition EOG090R0F35 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0GVF that may cause numerical problems WARNING: CAA, CAG, GGG, TCG are not present in partition EOG090R0BH9 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0KCA that may cause numerical problems WARNING: AAG, AGG, CGG, TGC are not present in partition EOG090R00YL that may cause numerical problems WARNING: CAT, CGA, CGG are not present in partition EOG090R04LJ that may cause numerical problems WARNING: TAT, TCC, TGG are not present in partition EOG090R0S1Y that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R0JAF that may cause numerical problems WARNING: ATT, TGC, TGT are not present in partition EOG090R075P that may cause numerical problems WARNING: TGG is not present in partition EOG090R0E0V that may cause numerical problems WARNING: CGC, GCG, TGC, TGT are not present in partition EOG090R08F2 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0EPI that may cause numerical problems WARNING: CAT, TGC, TGT are not present in partition EOG090R0JDV that may cause numerical problems WARNING: TGG is not present in partition EOG090R0FE8 that may cause numerical problems WARNING: TAC, TAT, TGG are not present in partition EOG090R0DYC that may cause numerical problems WARNING: AGC, TAC, TAT are not present in partition EOG090R0JKD that may cause numerical problems WARNING: TGG is not present in partition EOG090R0CJB that may cause numerical problems WARNING: AGG, CAT, TGG are not present in partition EOG090R0Q7N that may cause numerical problems WARNING: AGC, AGT, TGG are not present in partition EOG090R0MZV that may cause numerical problems WARNING: TGG is not present in partition EOG090R0EVX that may cause numerical problems WARNING: TGG is not present in partition EOG090R04PC that may cause numerical problems WARNING: TGG is not present in partition EOG090R0AHM that may cause numerical problems WARNING: TGG is not present in partition EOG090R0DOF that may cause numerical problems WARNING: GCC is not present in partition EOG090R0EIP that may cause numerical problems WARNING: CCA, CCC, CCG, CCT, TGC, TGT are not present in partition EOG090R0J8M that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R0EVD that may cause numerical problems WARNING: TTC, TTT are not present in partition EOG090R0JNP that may cause numerical problems WARNING: AGC, GGG, TGG are not present in partition EOG090R0H7Z that may cause numerical problems WARNING: GGA, GGC, GGG are not present in partition EOG090R0NUC that may cause numerical problems WARNING: TCA is not present in partition EOG090R0IUH that may cause numerical problems WARNING: CCT, CGC, CGG are not present in partition EOG090R0GH2 that may cause numerical problems WARNING: AGC, TGC, TGG are not present in partition EOG090R0GLJ that may cause numerical problems WARNING: TGG is not present in partition EOG090R0IZQ that may cause numerical problems WARNING: TGG is not present in partition EOG090R0GXU that may cause numerical problems WARNING: TGC, TGG are not present in partition EOG090R0IO2 that may cause numerical problems WARNING: TCC, TGC, TGG, TGT are not present in partition EOG090R0NOK that may cause numerical problems WARNING: TGG is not present in partition EOG090R0I69 that may cause numerical problems WARNING: CAT, TGG are not present in partition EOG090R0I7O that may cause numerical problems WARNING: TGG is not present in partition EOG090R0GVH that may cause numerical problems WARNING: TGG is not present in partition EOG090R0JPX that may cause numerical problems WARNING: TGC is not present in partition EOG090R0B83 that may cause numerical problems WARNING: GGG is not present in partition EOG090R02ZV that may cause numerical problems WARNING: TCC is not present in partition EOG090R0GR3 that may cause numerical problems WARNING: TGC is not present in partition EOG090R08M5 that may cause numerical problems WARNING: CGC is not present in partition EOG090R0F7A that may cause numerical problems WARNING: TGG is not present in partition EOG090R0DLX that may cause numerical problems WARNING: CCC, CGC are not present in partition EOG090R09R5 that may cause numerical problems WARNING: TGC, TGG are not present in partition EOG090R0IRP that may cause numerical problems WARNING: TGG is not present in partition EOG090R0MO6 that may cause numerical problems WARNING: CAC, CAT are not present in partition EOG090R0GWJ that may cause numerical problems WARNING: TGG, TGT are not present in partition EOG090R0PET that may cause numerical problems WARNING: AGG, AGT, CCG are not present in partition EOG090R0I2Q that may cause numerical problems WARNING: TGG is not present in partition EOG090R0E24 that may cause numerical problems WARNING: CGG is not present in partition EOG090R0IEV that may cause numerical problems WARNING: CGT is not present in partition EOG090R0CJK that may cause numerical problems WARNING: TGG is not present in partition EOG090R0E6W that may cause numerical problems WARNING: TGC, TGG, TGT are not present in partition EOG090R0LXQ that may cause numerical problems WARNING: ACT is not present in partition EOG090R055S that may cause numerical problems WARNING: TGG is not present in partition EOG090R0O2D that may cause numerical problems WARNING: TGG is not present in partition EOG090R070D that may cause numerical problems WARNING: TGG is not present in partition EOG090R0J75 that may cause numerical problems WARNING: CGC is not present in partition EOG090R023F that may cause numerical problems WARNING: TGC, TGG, TGT are not present in partition EOG090R0PX3 that may cause numerical problems WARNING: TGG is not present in partition EOG090R02UT that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R0KFF that may cause numerical problems WARNING: TGG is not present in partition EOG090R0BLW that may cause numerical problems WARNING: GGC, TGG are not present in partition EOG090R0PQS that may cause numerical problems WARNING: TGC is not present in partition EOG090R0H74 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0KPE that may cause numerical problems WARNING: TGG is not present in partition EOG090R0F71 that may cause numerical problems WARNING: CGG is not present in partition EOG090R0H6P that may cause numerical problems WARNING: CCC, CGG are not present in partition EOG090R0HNG that may cause numerical problems WARNING: TGG is not present in partition EOG090R0F29 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0I9Q that may cause numerical problems WARNING: TGG is not present in partition EOG090R0E90 that may cause numerical problems WARNING: TGT is not present in partition EOG090R0H59 that may cause numerical problems WARNING: ATC is not present in partition EOG090R0FIS that may cause numerical problems WARNING: TAC, TAT are not present in partition EOG090R0JJX that may cause numerical problems WARNING: TGG is not present in partition EOG090R0JEX that may cause numerical problems WARNING: TGG, TTG are not present in partition EOG090R0PIR that may cause numerical problems WARNING: TGG is not present in partition EOG090R0CE0 that may cause numerical problems WARNING: CGG is not present in partition EOG090R0K5G that may cause numerical problems WARNING: TGG is not present in partition EOG090R0CRC that may cause numerical problems WARNING: TTC is not present in partition EOG090R0FQQ that may cause numerical problems WARNING: TGC, TGG, TGT are not present in partition EOG090R0EX5 that may cause numerical problems WARNING: TGC is not present in partition EOG090R0P6W that may cause numerical problems WARNING: CCT is not present in partition EOG090R03GT that may cause numerical problems WARNING: TGG is not present in partition EOG090R0LT6 that may cause numerical problems WARNING: TGG is not present in partition EOG090R09TG that may cause numerical problems WARNING: TGG is not present in partition EOG090R0DCT that may cause numerical problems WARNING: TGG is not present in partition EOG090R0LGE that may cause numerical problems WARNING: CGG, TGG are not present in partition EOG090R0N4U that may cause numerical problems WARNING: TGG is not present in partition EOG090R0GFQ that may cause numerical problems WARNING: TGG is not present in partition EOG090R0JNG that may cause numerical problems WARNING: TGG is not present in partition EOG090R0FIT that may cause numerical problems WARNING: TGG is not present in partition EOG090R0H78 that may cause numerical problems WARNING: CTC, TTC are not present in partition EOG090R0QYZ that may cause numerical problems WARNING: TGG is not present in partition EOG090R0311 that may cause numerical problems WARNING: CAT is not present in partition EOG090R0FVE that may cause numerical problems WARNING: TGG is not present in partition EOG090R0C5W that may cause numerical problems WARNING: CCG, TGG are not present in partition EOG090R0MLG that may cause numerical problems WARNING: TCG is not present in partition EOG090R0GT1 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0576 that may cause numerical problems WARNING: AGT, TTT are not present in partition EOG090R0I7G that may cause numerical problems WARNING: ACA is not present in partition EOG090R0IX7 that may cause numerical problems WARNING: GGG is not present in partition EOG090R0CY8 that may cause numerical problems WARNING: TGT is not present in partition EOG090R0BAP that may cause numerical problems WARNING: TGC, TGG are not present in partition EOG090R0O4W that may cause numerical problems WARNING: TGG is not present in partition EOG090R0IAV that may cause numerical problems WARNING: CGT is not present in partition EOG090R02SW that may cause numerical problems WARNING: TGG is not present in partition EOG090R0E9R that may cause numerical problems WARNING: GAC, GAT are not present in partition EOG090R0MSH that may cause numerical problems WARNING: CCG is not present in partition EOG090R0GXE that may cause numerical problems WARNING: GGT, TCA are not present in partition EOG090R0I1B that may cause numerical problems WARNING: AGG is not present in partition EOG090R0LJZ that may cause numerical problems WARNING: TGT is not present in partition EOG090R0C2I that may cause numerical problems WARNING: TGC is not present in partition EOG090R0DS6 that may cause numerical problems WARNING: TGG is not present in partition EOG090R05A4 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0CCX that may cause numerical problems WARNING: TGC is not present in partition EOG090R0GVX that may cause numerical problems WARNING: TGG is not present in partition EOG090R0B96 that may cause numerical problems WARNING: CCA, CCC, CCG, CCT are not present in partition EOG090R0O6L that may cause numerical problems WARNING: CGC is not present in partition EOG090R0CL2 that may cause numerical problems WARNING: TGC is not present in partition EOG090R0DT1 that may cause numerical problems WARNING: AGG is not present in partition EOG090R095T that may cause numerical problems WARNING: CAC, TGG are not present in partition EOG090R0K2Y that may cause numerical problems WARNING: TGG is not present in partition EOG090R0FHC that may cause numerical problems WARNING: CGG is not present in partition EOG090R06TP that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R0K53 that may cause numerical problems WARNING: TGG is not present in partition EOG090R09OR that may cause numerical problems WARNING: TGG is not present in partition EOG090R0NZS that may cause numerical problems WARNING: TGG is not present in partition EOG090R0485 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0IIL that may cause numerical problems WARNING: TGG is not present in partition EOG090R030O that may cause numerical problems WARNING: TGG is not present in partition EOG090R0H00 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0N3L that may cause numerical problems WARNING: CGC is not present in partition EOG090R0E6Y that may cause numerical problems WARNING: TGG is not present in partition EOG090R0IM6 that may cause numerical problems WARNING: TGC is not present in partition EOG090R09KU that may cause numerical problems WARNING: TGC is not present in partition EOG090R0IWM that may cause numerical problems WARNING: TGG is not present in partition EOG090R03NL that may cause numerical problems WARNING: TGG is not present in partition EOG090R04HZ that may cause numerical problems WARNING: CGC is not present in partition EOG090R03HY that may cause numerical problems WARNING: CCG, TGT are not present in partition EOG090R0KW1 that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R0GX8 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0EXE that may cause numerical problems WARNING: TGG is not present in partition EOG090R0DSL that may cause numerical problems WARNING: TGG is not present in partition EOG090R06CM that may cause numerical problems WARNING: TGG is not present in partition EOG090R05GK that may cause numerical problems WARNING: CGG is not present in partition EOG090R04MC that may cause numerical problems WARNING: CAC, CAT, TGG are not present in partition EOG090R0LHX that may cause numerical problems WARNING: GGG, TGG are not present in partition EOG090R0MMG that may cause numerical problems WARNING: CCC, CCG, CCT are not present in partition EOG090R0J26 that may cause numerical problems WARNING: CGC is not present in partition EOG090R0GEX that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R04HQ that may cause numerical problems WARNING: CGA, TTC, TTT are not present in partition EOG090R0I3F that may cause numerical problems WARNING: TGC, TGT, TTT are not present in partition EOG090R0HHX that may cause numerical problems WARNING: TGG is not present in partition EOG090R09SW that may cause numerical problems WARNING: TGG is not present in partition EOG090R093K that may cause numerical problems WARNING: TGG is not present in partition EOG090R00EC that may cause numerical problems WARNING: CGT, GTC are not present in partition EOG090R03VE that may cause numerical problems WARNING: CGC is not present in partition EOG090R0K6X that may cause numerical problems WARNING: CGA, TGG, TGT are not present in partition EOG090R0K5V that may cause numerical problems WARNING: AGG, CGG are not present in partition EOG090R0AJP that may cause numerical problems WARNING: CGG is not present in partition EOG090R0D2W that may cause numerical problems WARNING: TGG is not present in partition EOG090R073W that may cause numerical problems WARNING: CAC, GCG, TCT, TGC, TGG, TGT are not present in partition EOG090R07H4 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0BY5 that may cause numerical problems WARNING: TGG is not present in partition EOG090R02YO that may cause numerical problems WARNING: CCG is not present in partition EOG090R0JJA that may cause numerical problems WARNING: TGC is not present in partition EOG090R0DLB that may cause numerical problems WARNING: TGG is not present in partition EOG090R0KR4 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0FCC that may cause numerical problems WARNING: TGC, TGG are not present in partition EOG090R0DJI that may cause numerical problems WARNING: ATG is not present in partition EOG090R0EZI that may cause numerical problems WARNING: TGG is not present in partition EOG090R0MT3 that may cause numerical problems WARNING: CCC is not present in partition EOG090R0L2D that may cause numerical problems WARNING: TGC, TGG are not present in partition EOG090R0I5B that may cause numerical problems WARNING: TGC is not present in partition EOG090R0P5A that may cause numerical problems WARNING: CCT, GAC, GAT, GGC, TCA, TCT, TGC, TGT are not present in partition EOG090R0FP4 that may cause numerical problems WARNING: CGG, TGC are not present in partition EOG090R0MSI that may cause numerical problems WARNING: TGG is not present in partition EOG090R096Y that may cause numerical problems WARNING: TGG is not present in partition EOG090R0AJK that may cause numerical problems WARNING: CCC, CGT, TGC, TGG, TGT are not present in partition EOG090R0MSJ that may cause numerical problems WARNING: TGT is not present in partition EOG090R0JLG that may cause numerical problems WARNING: TGC, TGG, TGT are not present in partition EOG090R0I2T that may cause numerical problems WARNING: CGC, CGT are not present in partition EOG090R0C47 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0BQS that may cause numerical problems WARNING: TGG is not present in partition EOG090R0AWX that may cause numerical problems WARNING: TGG is not present in partition EOG090R0KY7 that may cause numerical problems WARNING: TGG is not present in partition EOG090R05UF that may cause numerical problems WARNING: TGG is not present in partition EOG090R02ZI that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R01BH that may cause numerical problems WARNING: TGG is not present in partition EOG090R0LSQ that may cause numerical problems WARNING: TGG is not present in partition EOG090R0IMV that may cause numerical problems WARNING: AGC, AGT, TCA, TCC, TCG, TCT are not present in partition EOG090R0OE0 that may cause numerical problems WARNING: ACC, GGG are not present in partition EOG090R0KI5 that may cause numerical problems WARNING: TGC is not present in partition EOG090R0EBD that may cause numerical problems WARNING: TGC, TGG are not present in partition EOG090R0HMN that may cause numerical problems WARNING: CGC is not present in partition EOG090R02QS that may cause numerical problems WARNING: CCC is not present in partition EOG090R0GS2 that may cause numerical problems WARNING: TGC, TGG are not present in partition EOG090R0M0N that may cause numerical problems WARNING: TGG is not present in partition EOG090R0KM1 that may cause numerical problems WARNING: AAC, AGC, CCA, CCC, CCG, CCT, TTT are not present in partition EOG090R0NMC that may cause numerical problems WARNING: CAT, TGG are not present in partition EOG090R0PCU that may cause numerical problems WARNING: TGG is not present in partition EOG090R0D9I that may cause numerical problems WARNING: TGG is not present in partition EOG090R0LZF that may cause numerical problems WARNING: CTA, CTT are not present in partition EOG090R0JXJ that may cause numerical problems WARNING: CGA, CGG are not present in partition EOG090R0I4A that may cause numerical problems WARNING: GCG, GCT, TCG are not present in partition EOG090R0IFD that may cause numerical problems WARNING: TGG is not present in partition EOG090R0FII that may cause numerical problems WARNING: TGG is not present in partition EOG090R0KQB that may cause numerical problems WARNING: TAT, TGG are not present in partition EOG090R0QXX that may cause numerical problems WARNING: TGG is not present in partition EOG090R0J91 that may cause numerical problems WARNING: CGC is not present in partition EOG090R0GFH that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R0D8A that may cause numerical problems WARNING: TGG, TGT are not present in partition EOG090R0ET5 that may cause numerical problems WARNING: AGT, GCG are not present in partition EOG090R0G2O that may cause numerical problems WARNING: CGC, CTC, GGC, GGG are not present in partition EOG090R0E39 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0D0Y that may cause numerical problems WARNING: TAC, TGG are not present in partition EOG090R0OUG that may cause numerical problems WARNING: TGG is not present in partition EOG090R0JT8 that may cause numerical problems WARNING: CGA, CGC, CGG, CGT are not present in partition EOG090R0H5U that may cause numerical problems WARNING: TGG is not present in partition EOG090R08PW that may cause numerical problems WARNING: TGG is not present in partition EOG090R05T9 that may cause numerical problems WARNING: AGC is not present in partition EOG090R0NW4 that may cause numerical problems WARNING: AGG is not present in partition EOG090R0IQE that may cause numerical problems WARNING: TGG, TGT are not present in partition EOG090R0NPN that may cause numerical problems WARNING: TGG is not present in partition EOG090R0PJQ that may cause numerical problems WARNING: TGC is not present in partition EOG090R0BGD that may cause numerical problems WARNING: ACT, GGC are not present in partition EOG090R0N8G that may cause numerical problems WARNING: TCA, TCC, TCG, TCT are not present in partition EOG090R0FTO that may cause numerical problems WARNING: TGG is not present in partition EOG090R0GLD that may cause numerical problems WARNING: TGC, TGG are not present in partition EOG090R0EUR that may cause numerical problems WARNING: TCC, TGG are not present in partition EOG090R0FZQ that may cause numerical problems WARNING: TGG is not present in partition EOG090R0GVZ that may cause numerical problems WARNING: TGC is not present in partition EOG090R0ISS that may cause numerical problems WARNING: TGG is not present in partition EOG090R0ADL that may cause numerical problems WARNING: TGG is not present in partition EOG090R0FPJ that may cause numerical problems WARNING: TGG is not present in partition EOG090R0KBG that may cause numerical problems WARNING: TGC, TGG, TGT are not present in partition EOG090R0J0K that may cause numerical problems WARNING: TGT is not present in partition EOG090R081G that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R0GKB that may cause numerical problems WARNING: TGG is not present in partition EOG090R0B81 that may cause numerical problems WARNING: GGG is not present in partition EOG090R07QM that may cause numerical problems WARNING: ATG, CAA, CAC, CAG are not present in partition EOG090R0MZ0 that may cause numerical problems WARNING: CGC, GGC, GGG are not present in partition EOG090R0LR8 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0LF5 that may cause numerical problems WARNING: CAT is not present in partition EOG090R04HY that may cause numerical problems WARNING: TGC, TGT, TTG are not present in partition EOG090R0JEC that may cause numerical problems WARNING: CCC is not present in partition EOG090R0LPR that may cause numerical problems WARNING: TGC, TGG, TGT are not present in partition EOG090R0LCG that may cause numerical problems WARNING: TGG is not present in partition EOG090R0JQ7 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0B7W that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R0BSI that may cause numerical problems WARNING: ATG, TGC, TGG, TGT are not present in partition EOG090R0LOX that may cause numerical problems WARNING: TGG is not present in partition EOG090R0BTL that may cause numerical problems WARNING: CTT, TGG, TGT are not present in partition EOG090R0PG4 that may cause numerical problems WARNING: TGC is not present in partition EOG090R0C8L that may cause numerical problems WARNING: ATG, TGC, TGT are not present in partition EOG090R06BD that may cause numerical problems WARNING: CCC, CCG are not present in partition EOG090R09OG that may cause numerical problems WARNING: TGG is not present in partition EOG090R0FSO that may cause numerical problems WARNING: TGG is not present in partition EOG090R0BWO that may cause numerical problems WARNING: TGG is not present in partition EOG090R06B6 that may cause numerical problems WARNING: CGC is not present in partition EOG090R03Y9 that may cause numerical problems WARNING: TGT is not present in partition EOG090R0CAQ that may cause numerical problems WARNING: TGC, TGG, TGT are not present in partition EOG090R0KSG that may cause numerical problems WARNING: TGT is not present in partition EOG090R0N3B that may cause numerical problems WARNING: TGC, TGG are not present in partition EOG090R0DRA that may cause numerical problems WARNING: CAT is not present in partition EOG090R09JU that may cause numerical problems WARNING: TGG is not present in partition EOG090R0MVT that may cause numerical problems WARNING: TGG is not present in partition EOG090R0F5Y that may cause numerical problems WARNING: GGG is not present in partition EOG090R0JEG that may cause numerical problems WARNING: TAC, TAT are not present in partition EOG090R0Q6E that may cause numerical problems WARNING: TGG is not present in partition EOG090R0DWX that may cause numerical problems WARNING: TGG is not present in partition EOG090R02Q9 that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R01B9 that may cause numerical problems WARNING: CAC, CAT are not present in partition EOG090R0IID that may cause numerical problems WARNING: TCC is not present in partition EOG090R0L8Q that may cause numerical problems WARNING: TGG is not present in partition EOG090R0CRE that may cause numerical problems WARNING: TGC, TGG, TGT are not present in partition EOG090R098A that may cause numerical problems WARNING: TGG is not present in partition EOG090R0DSX that may cause numerical problems WARNING: CCC, TGG are not present in partition EOG090R01JC that may cause numerical problems WARNING: CGT, GGG are not present in partition EOG090R0N52 that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R0DR6 that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R0ADB that may cause numerical problems WARNING: TGG is not present in partition EOG090R0IVC that may cause numerical problems WARNING: TGC is not present in partition EOG090R069D that may cause numerical problems WARNING: TGG is not present in partition EOG090R0CM7 that may cause numerical problems WARNING: CGC, TGG are not present in partition EOG090R0B2V that may cause numerical problems WARNING: CGG is not present in partition EOG090R02JU that may cause numerical problems WARNING: TGC is not present in partition EOG090R0FBZ that may cause numerical problems WARNING: ACG, CAA, CAG, TAC, TAT, TGG are not present in partition EOG090R0NU9 that may cause numerical problems WARNING: CTA is not present in partition EOG090R0B4I that may cause numerical problems WARNING: TGG is not present in partition EOG090R08XB that may cause numerical problems WARNING: TAC, TAT, TGG are not present in partition EOG090R0P69 that may cause numerical problems WARNING: CCT is not present in partition EOG090R0M2V that may cause numerical problems WARNING: TGG is not present in partition EOG090R0DR7 that may cause numerical problems WARNING: CCG is not present in partition EOG090R0IGO that may cause numerical problems WARNING: CGC, CGT are not present in partition EOG090R0L29 that may cause numerical problems WARNING: TGG is not present in partition EOG090R02NG that may cause numerical problems WARNING: TGC is not present in partition EOG090R0GWM that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R0OLR that may cause numerical problems WARNING: TGG is not present in partition EOG090R0FIA that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R0DQ2 that may cause numerical problems WARNING: CGC is not present in partition EOG090R0H6S that may cause numerical problems WARNING: CGT is not present in partition EOG090R03CJ that may cause numerical problems WARNING: TGC, TGG, TGT are not present in partition EOG090R0J36 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0ENG that may cause numerical problems WARNING: TGG is not present in partition EOG090R0A1Y that may cause numerical problems WARNING: CGG is not present in partition EOG090R0J1R that may cause numerical problems WARNING: CAC, TGC, TGT are not present in partition EOG090R0LAB that may cause numerical problems WARNING: CGC is not present in partition EOG090R0AZR that may cause numerical problems WARNING: TGG is not present in partition EOG090R0926 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0KKF that may cause numerical problems WARNING: TGG is not present in partition EOG090R05E2 that may cause numerical problems WARNING: CCA, CCC, CCG, CCT, TGG, TGT are not present in partition EOG090R0LLG that may cause numerical problems WARNING: CCA, CCC, CCG, CCT are not present in partition EOG090R01R2 that may cause numerical problems WARNING: CGC, TCC are not present in partition EOG090R0NLB that may cause numerical problems WARNING: CGC, CGT, TGC, TGG, TGT are not present in partition EOG090R0J66 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0GBO that may cause numerical problems WARNING: TGG is not present in partition EOG090R0AUB that may cause numerical problems WARNING: ATC, CCC, CCG, TGC, TGG are not present in partition EOG090R0OYA that may cause numerical problems WARNING: TGG is not present in partition EOG090R0GPW that may cause numerical problems WARNING: TGG is not present in partition EOG090R0EAN that may cause numerical problems WARNING: TGG is not present in partition EOG090R0IU5 that may cause numerical problems WARNING: TGG is not present in partition EOG090R0CJU that may cause numerical problems WARNING: CTA is not present in partition EOG090R0GCL that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R0BEN that may cause numerical problems WARNING: TAC, TAT, TGG are not present in partition EOG090R0OP6 that may cause numerical problems WARNING: GGC is not present in partition EOG090R0FHX that may cause numerical problems WARNING: GGC, TGG are not present in partition EOG090R0EQH that may cause numerical problems WARNING: CAC is not present in partition EOG090R05AE that may cause numerical problems WARNING: AGC is not present in partition EOG090R0JMQ that may cause numerical problems WARNING: TGG is not present in partition EOG090R0GP9 that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R0GHQ that may cause numerical problems WARNING: CAC, CAT, CGC, CGG are not present in partition EOG090R0LNI that may cause numerical problems WARNING: CCC, CCG, CCT, TGG are not present in partition EOG090R0CER that may cause numerical problems WARNING: TGG is not present in partition EOG090R073U that may cause numerical problems WARNING: CGG, TGG are not present in partition EOG090R0MA1 that may cause numerical problems WARNING: TAC, TAT, TGC, TGT are not present in partition EOG090R0L9W that may cause numerical problems WARNING: TGG is not present in partition EOG090R0L5I that may cause numerical problems WARNING: TGG is not present in partition EOG090R0J8Q that may cause numerical problems WARNING: TGG is not present in partition EOG090R0K3V that may cause numerical problems WARNING: GGG, TGG are not present in partition EOG090R0BDT that may cause numerical problems WARNING: AGC, AGT are not present in partition EOG090R0E3E that may cause numerical problems WARNING: AGC, TGG are not present in partition EOG090R0N6M that may cause numerical problems WARNING: AGC, AGT, TGG are not present in partition EOG090R0K86 that may cause numerical problems WARNING: TGG is not present in partition EOG090R04YX that may cause numerical problems WARNING: CCC is not present in partition EOG090R0COX that may cause numerical problems WARNING: TGC, TGT are not present in partition EOG090R0B5A that may cause numerical problems WARNING: 624 states (see above) are not present that may cause numerical problems Computing Juke-Cantor distances... Computing BIONJ tree... 0.053 seconds NOTE: 25427 MB RAM (24 GB) is required! Estimate model parameters (epsilon = 0.100) Initial log-likelihood: -28901520.251 NUMERICAL ERROR: Too many iterations in tqli *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: codon_all_ic=0_2.log *** Alignment files (if possible) Many thanks alex ", "Sorry small correction the alignment has ~3000 partitions not 3000 sites. Best alex ", "Hi Alex, As you as using version 1.5.X, pls update to the latest release 1.5.6 in this series. It fixed this bug (see release note http://www.iqtree.org/release/v1.5.6 Improved numerical stability when some state is absent from the alignment, especially with codon or morphological data. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thanks a lot Minh. I will use a later version then. cheers alex To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Alexandros Vasilikopoulos --------------------------------------------------------------------------------------------------- MSc, PhD candidate Centre for Molecular Biodiversity Research. Zoological Research Museum Alexander Koenig. Leibniz Institute for Animal Biodiversity Adenauerallee 160 53113 Bonn Germany Tel: +49 228 9122-407 ", "Hi all, also using 1.5.5 (since to complete some earlier analyses - also with codon models. is the Erooro message \"WARNING: 106 states (see above) are not present that may cause numerical problems ERROR: pllPartitionsValidate\" due to the same problem best Karen "]}, "OpGZThkLYKE": {"topic": "constructing a consensus tree using .treefile", "initializeDate": "Dec 12, 2018, 2:54:25 AM", "timeStamp": "Dec 15, 2018, 4:56:54 AM", "content": ["Hi, instead of building consensus tree only with boot*.boottrees, including boot*.treefile will be reliable? or only building consensus tree with boot*.treefile and assigning support value using boot*.boottrees is advisable? cat boot*.boottrees > alltrees iqtree -con -t alltrees iqtree -sup input_alignment.treefile -t alltrees Thanks Vigensh ", "Hi Vigensh, As far as I understood, you asked whether building a consensus tree from the set of bootstrap trees plus the ML tree is advisable? I think in principle you can do this, which helps to avoid 0% bootstrap support because all splits in the ML tree are present in this set. Apart from this marginal increase in BS support, I don\u2019t really see much difference with just building a consensus from the bootstrap trees. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "UldtXxNLW6A": {"topic": "Help in running IQ-TREE", "initializeDate": "Sep 7, 2020, 6:03:01 AM", "timeStamp": "Sep 7, 2020, 7:48:57 PM", "content": ["Dear All I've gathered 4 levels information of a major gene triggering breast cancer e.g. genomic sequence, CDS, mRNA, AA. I'm new to IQ-TREE., really new. I'm looking for some helps. I've an idea that I would like to communicate with her/him. Regards Mostafa ", "Hi Mostafa, This page: http://www.iqtree.org/doc/Quickstart is for new users. If you have some other idea, simply post it here. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b7040202-f572-449b-a4b7-069315a30a9en%40googlegroups.com "]}, "1qgNdh4erJM": {"topic": "Iqtree2 covid19 version", "initializeDate": "Dec 14, 2020, 5:01:31 PM", "timeStamp": "Jan 17, 2021, 8:21:36 PM", "content": ["I was trying to use the windows version of IQtree2 for COVID-19 (iqtree-2.1.2-Windows), but the run finished after the evaluation of identical sequences. ", "Hi there, Sorry for the long delay, I\u2019m back from a long break. There has been some bug report with this version regarding this issue. We will try to release the fix soon. Thanks Minh On 15 Dec 2020, at 9:01 am, Santiago Justo Arevalo < santiago...@usp.br > wrote: I was trying to use the windows version of IQtree2 for COVID-19 (iqtree-2.1.2-Windows), but the run finished after the evaluation of identical sequences. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0644c5d2-376c-465c-9970-2b352a1ea60dn%40googlegroups.com "]}, "o09LBSIzz0M": {"topic": "IQ-TREE crashed while merging models.", "initializeDate": "Jun 5, 2017, 10:10:00 AM", "timeStamp": "Jun 8, 2017, 3:57:25 PM", "content": ["Hello, I got the following error when I was trying tried to choose the best substitution model by codon position of a large DNA dataset (~14.000 loci). It finished the model selection, but when the program started merging models, it crashed. *.err file terminating with uncaught exception of type std::out_of_range: vector STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: DNA_BFM.log *** Alignment files (if possible) /opt/gridengine/default/spool/compute-1-7/job_scripts/3609219: line 20: 41840 Aborted (core dumped) /pool/genomics/roa-varona/Programs/iqtree-omp-1.5.4/bin/iqtree-omp -nt $NSLOTS -rcluster 10 -safe -blmin 1e-6 -pre DNA_BFM -st DNA -mset raxml -s DNA_FcC_supermatrix.phy -spp DNA_FcC_supermatrix_CP.nex -m TESTMERGE *.log file 42622 GTR 318.408 Danio_rerio_18_5990415_5990110_aln_3 0h:23m:24s (1663h:31m:59s left) 42623 GTR 155.167 Gasterosteus_aculeatus_groupVI_1008845_1008555_aln_3 0h:23m:25s (1663h:30m:8s left) 42624 GTR 145.308 Gasterosteus_aculeatus_groupXIII_9490606_9490444_aln_3 0h:23m:25s (1663h:29m:18s left) Full partition model BIC score: 47061520.113 (lh=-9334636.018 df=1909170) Merging models to increase model fit (about 181716772 total partition schemes)... STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: DNA_BFM.log *** Alignment files (if possible) Thank you in advance for any advice, Adela ", "Hi Adela, thanks for reporting the bug. It suggests some \u201cout of range\", which can be due to extremely many loci. Can you send me all the data files and all output files via personal email? Minh PS: For such many partitions, I suggest that you use PartitionFinder2 \u2014 it implements a fast relaxed cluster algorithm, which is much faster than the \u201cslow\u201d algorithm currently available in IQ-TREE. We will include the fast algorithm at some point... You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Adela again, the beta release 1.6.beta3 fixed this bug, downloadable at www.iqtree.org Cheers, Minh ", "Hi Minh, Thank you very much for letting me know. Cheers, Adela Sent from my iPhone "]}, "lTki-7FQ5qo": {"topic": "ultrafast bootstrap interpretation", "initializeDate": "Jul 27, 2016, 9:18:24 PM", "timeStamp": "Sep 7, 2016, 6:40:57 PM", "content": ["Hi, My question is how can i interpret the results of ultrafast bootstrap if my results are like this 94.9/97 or like this 48.5/41, another example 98.8/100 thanks in advance. ", "Hi there, this is explained in the FAQ: http://www.cibiv.at/software/iqtree/doc/Frequently-Asked-Questions/ I guessed you used both SH-aLRT and UFBoot. The first number is SH-aLRT support and the second is UFBoot support. This is also written in .iqtree report file. Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Is correct, i use both, i will check the file. Many thanks, have a nice day. You received this message because you are subscribed to a topic in the Google Groups \"IQTREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/lTki-7FQ5qo/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Att.: Biol. Israel Mu\u00f1oz Velasco \" isra...@gmail.com isra...@ciencias.unam.mx Laboratorio de Origen de la Vida Edificio A de Biolog\u00eda primer piso Facultad de Ciencias, UNAM. ", "Hej Minh! And the tree that contains both the SH-aLRT and ultrafast bootstrap is only available as part of the .iqtree file right? It could be nice to have it like the .contree simply available for opening in a tree viewer. It is compatible with Figtree for example, but it would be nice to have the tree in one line - copy paste from iqtree gives it in several lines. Just an output file suggestion. Kasia ", "Hi Kasia, You can open .treefile, which is the ML tree with both support values. The .contree file is the consensus tree, which can be multifurcating, thus the SH-aLRT does not in such case. This why this .contree has only one support value per branch. Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. "]}, "MFBDiC7a6mA": {"topic": "partitioning by genes and codons", "initializeDate": "Oct 29, 2017, 9:05:13 AM", "timeStamp": "Oct 30, 2017, 4:34:32 AM", "content": ["Hi, I do not know how can I present a text file, including partitioning by genes and codons. I tried with a text file resemble which I had used for RaxML, bur I have received an error message. Therefore, I would like to ask you, if possible, could you please tell me how to cope with this issue? Indeed, how can I write my text file for partitioning by genes and codons? Thanks in advance. Arshia ", "Hi Arshia, Please read the section of the iqtree documentation (advanced tutorials) http://www.iqtree.org/doc/Advanced-Tutorial#choosing-the-right-partitioning-scheme Please copy paste the Nexus syntax that you see there and then make necessary changes according to your partition. Raxml partitioning scheme is also described there. In the charpartition section please make sure that your partition is just prefixed with a : (colon). And no model name while you are attempting model selection. #nexus charpartition mine = :part1, :part2, :part3, :part4, :part5; end; After model selection you will get a best partition (text) file, which can be used for the later tree searches. Hope I am right (I think I have asked a similar question in this forum few years back... When I was all lost attempting iqtree..), Other users and the developers will have better insight. Siby. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thanks Siby! I just want to add the link: http://www.iqtree.org/doc/Complex-Models#partition-models . It has a bunch of examples, including how to specify codon positions. Note that IQ-TREE can also read the RAxML partition file. @Arshia: you said you received an error message. If you paste it here, then we may be able to provide further help. Cheers, Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "xzbip9Edgf4": {"topic": "Plot SH-aLRT support values on tree", "initializeDate": "Jan 7, 2016, 2:50:32 AM", "timeStamp": "Jan 7, 2016, 12:52:38 PM", "content": ["Dear IQ-TREE users, Does anyone know how to visualize the support values of the SH-aLRT test on a tree using any tree visualization programs (eg. figtree). The SVG file has the support values but they are small and hard to read and the tree it is plotted on is unrooted an unordered. I was wondering if there was a better way to plot these values on a tree. Thank you in advance! Best regards, Chan Biodiversity Institute and Department of Ecology and Evolutionary Biology University of Kansas Dyche Hall, 1345 Jayhawk Blvd Lawrence, KS 66045-7593 ", "Dear Chan, For users of the IQ-TREE web server, the tree is visualized for a quick assessment in svg format in the analysis summary. For visualisation with figtree, you can use the treefile produced at the end of the run. (The treefile will also be included in the zip file you can download at the end of the run in the web server.) If you open the file with the suffix .treefile with figtree, the program will ask you to select a name for the support values. Just choose any name. Then, in figtree, you can specify that branch labels should be displayed by ticking the box 'Branch Labels'. In the corresponding 'Display' dropdown menu, just select the name that you chose for the support values! Best, Jana You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Jana, Thanks! I couldn't find it because i was looking at the contree file all along. "]}, "mrKVVNKu9Qs": {"topic": "IQ-TREE release 1.6.6", "initializeDate": "Jul 1, 2018, 12:13:31 AM", "timeStamp": "Jul 1, 2018, 12:13:31 AM", "content": ["Dear users, We are please to release IQ-TREE version 1.6.6. This version contains a number of bugfixes and is highly recommended for all users. Bugfixes: * Issue with internal tree node names changed from slash to underscore (reported by JP Flandrois). * Wrong FREQ_UNKNOWN assertion with protein mixture models, e.g. LG4X (reported by Giddy Landan). * Disallow specifying both `--runs` with `-lmap` option (reported by Giap Nguyen). * Reading nexus polymorphic characters for non-DNA data (reported by a web user). * Amino-acid O (22nd amino-acid) is accepted as missing data (reported by Cuong Dang). * Negative initial free-rates in rare cases (reported by Paul Frandsen). * Memory leak in reading NEXUS alignment. * Crash with resampling strategy (`-bsam`) for standard bootstrap (`-b`) and jackknife (`-j` option). * Crash with standard bootstrap and partition merging (`-m ...MERGE`) (reported by Guoqing Li). * Wrong error with codon models and `-t RANDOM` (reported by Karen Meusemann). * Parsing error with blank chars in partition file (reported by David Maddison). * Freezing caused by old Intel OpenMP library (reported by David Maddison). * Too strict assertion about one applied NNI (reported by Karen Meusemann). * Error message when specifying mixture with GHOST model (reported by Anja Spang). Happy computing! IQ-TREE dev team. "]}, "r93BYG2CKX0": {"topic": "BUG: iqtree abnormal termination", "initializeDate": "Sep 11, 2019, 11:28:42 PM", "timeStamp": "Sep 12, 2019, 9:36:20 PM", "content": ["Dear Sir I carried out a Maximum Likelihood (ML) analysis using iqtree-1.6.11-Linux. I submited the task via PBS. After nearly 12 hours run, the progress suddenly terminated. .err file are as follows: Can't find file /XX/home/XXX/.vnc/mu01:69.pid You'll have to kill the Xvnc process manually The first 10 lines and last 10 lines of the .log file are as follows: IQ-TREE multicore version 1.6.11 for Linux 64-bit built Jun 6 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: c0401 (SSE4.2, 125 GB RAM) Command: /xx/soft/iqtree-1.6.11-Linux/bin/iqtree -s /xx/soft/iqtree-1.6.11-Linux/aligned.fas -m GTR+F+I+G4 -b 100 -alrt 1000 -nt 24 Seed: 694114 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Sep 11 11:12:37 2019 Kernel: SSE2 - 24 threads (32 CPU cores detected) Estimate model parameters (epsilon = 0.100) BETTER TREE FOUND at iteration 71: -316216.868 Estimate model parameters (epsilon = 0.100) BETTER TREE FOUND at iteration 78: -316205.451 Iteration 80 / LogL: -316513.769 / Time: 0h:29m:4s (0h:36m:1s left) Estimate model parameters (epsilon = 0.100) BETTER TREE FOUND at iteration 84: -316204.760 Iteration 90 / LogL: -316311.688 / Time: 0h:31m:54s (0h:33m:40s left) Estimate model parameters (epsilon = 0.100) BETTER TREE FOUND at iteration 93: -316155.966 I do not konw how to solve this problem. Could you give me a hand\uff1f Thanks hiccup ", "Hi hiccup, This rather sounds like a problem with the cluster system, that suddenly killed IQ-TREE. I don\u2019t see any crash or error message from IQ-TREE alone. Therefore, can you please just rerun the same command line again to rule out this possibility? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ccba0e63-7b87-4a9c-8b3f-fc1b63eb365c%40googlegroups.com "]}, "J7_ybQZG9lg": {"topic": "ASR and PMSF", "initializeDate": "Dec 2, 2018, 8:37:54 PM", "timeStamp": "Dec 3, 2018, 7:36:54 AM", "content": ["Hello, Maybe it's a silly question, but it is valid to construct a guide tree using LG+F+G and use this tree for ancestral sequence reconstruction? Another question, are those commands in the right order? The asr outputs both tree and the .state files? So far, I think I should go with 3 commands. 1-) Construct a guide tree. iqtree -m LG+F+G -bb 1000 -s <fasta> 2-) Use the tree output as a guide tree to construct a tree iqtree -s <fasta> -m LG+C20+F+G -alrt 1000 -ft <treefile> 3-) Use the last tree to reconstruct ancestral sequence. iqtree -s <fasta> -m LG+C20+F+G -asr -alrt 1000 -te <treefile> Do I need to fix any command, or can I skip the second command? Will be any effect in performance or the results itself? Best regards, Gilberto Kaihami ", "Hi Gilberto, It\u2019s in fact a good question: yes it\u2019s valid that way. And you already gave the answer. I\u2019d do the same the 3 steps. I wouldn\u2019t skip step 2, because the tree from step 2 can be different from that of step 1. My only comment is on step 2, you can do ultrafast bootstrap (-bb 1000) as well. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "zxgT4hs_XXw": {"topic": "interpreting base substitution rates codes", "initializeDate": "Jun 2, 2020, 1:37:28 PM", "timeStamp": "Jun 2, 2020, 10:30:00 PM", "content": ["Hi! I used IQTree for model selection of a multilocus dataset with 17 partitions using the -m TESTMERGEONLY option. The program merged the dataset into 8 partitions and found best substitution models for each of them. I want to do an analysis in BEAST using fixed parameter values for substitution rates found by IQ-tree (\"Substitution process\" section in the output), but I am having issues understanding how the 6 digit codes for models translate into these fixed parameter values. I know this is mentioned in page 97 of the IQ-tree manual, but I am getting very confused by the wording there. I am especially confused by the TIM2 example provided which reads: Another example is for model TIM2 that has the 6-digit code 010232. Thus, TIM2 {4.39,5.30,12.1} means that A-C=A-T=4.39 (coded 1), A-G=5.30 (coded 2), CT=12.1 (coded 3) and C-G=G-T=1.0 (coded 0). This is, in turn, equivalent to specifying GTR{4.39,5.30,4.39,1.0,12.1}. If I understood correctly, the 6 letters represent these six rates (A-C, A-G, A-T, C-G, C-T, G-T). In the example above, it is indicated that A-C and A-T is coded \"1\", but based on this ordering I would have thought that \"1\" would correspond to A-G rate. I know there is a note that says: \"The digits in the codes do not necessarily have to have the same order as above\", but if this is the case, how would I know what is the order that applies to my data? Thanks! Joel ", "Hi Joel, Thanks for pointing it out. That\u2019s a typo, it should read: Another example is for model `TIM2` that has the 6-digit code `010232`. Thus, `TIM2{4.39,5.30,12.1}` means that A-C=A-T=4.39 (coded `0`), A-G=5.30 (coded `1`), C-T=12.1 (coded `3`) and C-G=G-T=1.0 (coded `2`). This is, in turn, equivalent to specifying `GTR{4.39,5.30,4.39,1.0,12.1}`. I fixed the doc internally and will update on the website soon. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/084ad16f-9177-4c90-af75-2fa7db22d1a7%40googlegroups.com "]}, "Fx4xNqlLE0k": {"topic": "\"ERROR: Tree file does not start with an opening-bracket '(' (line 2 column 0)\" after resuming from checkpoint", "initializeDate": "Oct 10, 2017, 5:36:10 AM", "timeStamp": "Oct 25, 2018, 6:37:31 PM", "content": ["Dear Minh, After resuming IQTREE analysis from checkpoint I got following error: ERROR Tree file does not start with an opening bracket '(' line column I'm sending you via e-mail a link to download the input and output files (except the *.model file which is several GB large). I observed the same error with two slightly different datasets and run parameters - let me know if you prefer to have also the files from the other run (the files are few hudnred MBs) for each dataset. Thanks and best, Ales ", "I have a similar problem. I am running a partitioned analysis the program ran up to 81 bootstrap replicates and at the 81st replicate it crashes with the same ERROR. When is reading trees generated by IQTree. ", "I believe such \u201cold\u201d problem was fixed\u2026 which version and command line did you use? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "q7vRlIIQU2k": {"topic": "Multiple runs and bootstrapping best tree", "initializeDate": "Sep 24, 2020, 5:40:22 AM", "timeStamp": "Sep 30, 2020, 12:30:41 AM", "content": ["Hello, I would like to run several independent runs using the -n run option. In the output summary of results from the runs, is the best tree also output? If so, is it possible to subsequently compute standard bootstrap support values for this tree and produce a consensus tree? Or is it possible to invoke multiple runs and bootstrapping in a single command? Many thanks for any feedback - gratefully received! Best wishes, Helen ", "Hi Helen, On 24 Sep 2020, at 7:40 pm, Helen Jenkins < hel...@mba.ac.uk > wrote: Hello, I would like to run several independent runs using the -n run option. I\u2019m assuming you used --runs option. In the output summary of results from the runs, is the best tree also output? Yes, the best tree of different runs will be output to .treefile and summarised in .iqtree file. The .runtrees file will contain trees of all runs. If so, is it possible to subsequently compute standard bootstrap support values for this tree and produce a consensus tree? Or is it possible to invoke multiple runs and bootstrapping in a single command? yes, that\u2019s possible, e.g.: --runs 10 -B 1000 will do 10 runs, each with 1,000 ultrafast bootstrap replicates, and the result will be from the best run. Cheers Minh Many thanks for any feedback - gratefully received! Best wishes, Helen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/34cf683a-8586-4f3b-b143-113b85dc6f62n%40googlegroups.com "]}, "LYeBKEeaYmA": {"topic": "Re: [iqtree] ERROR: File not found LG", "initializeDate": "Mar 27, 2018, 7:01:32 PM", "timeStamp": "Mar 28, 2018, 4:09:34 AM", "content": ["Hi Gert, Simply because you have a DNA alignment but LG is an amino-acid model\u2026 And the reason for \u201cFile not found\u201d message is when IQ-TREE detected that LG is not a valid DNA model name, it will search for a file named \u201cLG\u201d in the current folder, which stores the exchange rates and state frequencies of a user-defined rate matrix. And this file does not exist. Cheers, Minh On 28 Mar 2018, at 2:45 am, Gert W\u00f6rheide < g.woe...@palmuc.org > wrote: Hi, I am trying iqtree-1.6.3 on our linux-cluster (using slurm) with the example dataset and the following command (as taken straight from http://www.iqtree.org/doc/Complex-Models#mixture-models srun iqtree -nt 3 -s example.phy -m LG+C20+F+G -ft example.tre However, the job fails and the error log gives me: ERROR: File not found LG ERROR: File not found LG ERROR: File not found LG srun: error: mpcn3: tasks 0-2: Exited with exit code 2 It is the same with -m LG+F+G any idea what file it is looking for? (the file 'models.nex' is in the same directory with executable and data/tree files, if this is what might be needed?) thanks. Gert PS: iqtree -nt 3 -s example.phy runs just fine here are the first lines of the logfile with -m LG+F+G Host: mpcn3 (AVX512, FMA3, 93 GB RAM) Host: mpcn3 (AVX512, FMA3, 93 GB RAM) Command: iqtree -nt 3 -s example.phy -m LG+F+G -redo Host: mpcn3 (AVX512, FMA3, 93 GB RAM) Command: iqtree -nt 3 -s example.phy -m LG+F+G -redo Seed: 257922 (Using SPRNG - Scalable Parallel Random Number Generator) Command: iqtree -nt 3 -s example.phy -m LG+F+G -redo Seed: 256974 (Using SPRNG - Scalable Parallel Random Number Generator) Seed: 257431 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Tue Mar 27 17:26:40 2018 Kernel: AVX+FMA - 3 threads (80 CPU cores detected) You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "ha ha ha stupid me I better should have looked at the alignment first instead of searching the faq for the error... Maybe useful to indicate in filename that it is nucleotide and not amino acid to avoid similar stupid questions ;-) thanks for your time, best Gert "]}, "VqQfygY1Ve8": {"topic": "IQ-TREE release 1.3.7", "initializeDate": "Aug 23, 2015, 5:35:28 PM", "timeStamp": "Aug 23, 2015, 5:35:28 PM", "content": ["Dear IQ-Tree users, we are pleased to release version 1.3.7 with following news: August 23, 2015: Version 1.3.7 is released with following changes: Fix a bug introduced in 1.3.6 for new model selection procedure (-m TESTNEW). Include L-BFGS-B algorithm (code taken from HAL_HAS package of Jayaswal et al. 2014; Syst Biol 63:726-742) as the default to estimate model parameters. L-BFGS-B performs better than the previous BFGS implementation, for example, when optimizing LG4X and FreeRate models. New option -suptag (used with -sup) when assigning support values from a set of input trees into a given tree, each tagged branch in the given tree will be assigned values of form support@tree1@tree2@...@treeK, corresponding to the IDs of the input tree where this branch occurs (requested by Max Maronna). New option \"-t RANDOM\" to start tree search from a random starting tree (requested by Karen Meusemann). Best, IQ-Tree development team "]}, "PfsqipHxeqQ": {"topic": "Error due to stop codons in input alignment - any option to ignore them?", "initializeDate": "Aug 9, 2017, 6:11:39 AM", "timeStamp": "Aug 14, 2017, 4:01:03 AM", "content": ["Hi, I'm running IQ-TREE (iqtree-omp-1.5.5-Linux) and I'm getting error due to the presence of stop codons in my nucleotide alignment (I have a big matrix of thousands of concatenated protein-coding sequences derived from transcriptome sequencing so there were few stops there which I would otherwise not care about unless these were interrupting the IQ-TREE run) - is there a way how to run IQ-TREE with this data e.g. specifiying a particular command option (I did not find it in manual, though) or do I need to mask the stop codons in the alignment prior to running IQ-TREE with such a dataset? Thanks for any advice! Best regards, Ales ", "This is certainly a question best to be answered by Minh, but he is only available again next week. So, please be patient. Best wishes, Heiko You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Ales, There is no option to ignore stop codons. However, I believe the error messages look like: ERROR: Sequence XXX has stop codon YYY at site ZZZ So you can go through and replace the stop codons by --- (three dashes) to represent gaps. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, yeah, I did so - I was wondering if there is a parameter I could pass to IQ-TREE to deal with the stop codons for me but you are right that replacing STOPs in the alignment prior to IQ-TREE run is simple enough. Thanks for your response. Ales "]}, "c4eVY1MPoSk": {"topic": "Can IQTREE perform tree search under topology constraint?", "initializeDate": "Jan 18, 2016, 4:16:33 AM", "timeStamp": "Sep 21, 2016, 6:27:23 AM", "content": ["Dear all, I would like to ask whether IQTREE allows contraining topology search under a constraint? I know several programs such as FastTree, RAxML and PAUP* do that search, but in my case, I rely on IQTREE to infer the best supported phylogeny. Thank you in advanced! Best regards, Giap Nguyen ", "Dear Giap, Unfortunately, this feature is still a work in progress. However, we will prioritize it and let you know as soon as it is done. Bests Tung You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Yes, I hope that feature will be available soon! Thank you and best regards, Giap Nguyen ", "I'm also very interested in this feature! ", "Dear user, this feature is available in a beta version that you can try out here: https://github.com/Cibiv/IQ-TREE/releases/tag/v1.5.0-beta The relevant option is -g Since this is a new option, any feedback is much appreciated. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "hwOByzGFOok": {"topic": "Re: [iqtree] merge option merges all partitions", "initializeDate": "Jul 19, 2018, 1:53:21 PM", "timeStamp": "Jul 19, 2018, 1:53:21 PM", "content": ["Hi HT, I guess this question is redundant, as I might have answered another one already. Minh On 12 Jul 2018, at 4:21 am, Hyoung Tae Kim < rlad...@gmail.com > wrote: unfortunately, MF+MERGE option merges my 20 partitions into one. Is there any comments for me? Sincerely, You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "XebMSXApWAs": {"topic": "Modelfinder warning", "initializeDate": "May 21, 2020, 10:09:47 PM", "timeStamp": "May 28, 2020, 1:53:51 AM", "content": ["Dear Minh, Rob and everyone, I am fairly new at understanding the intricacies of selecting the best partitioning and models for less-than-ideal datasets, and have a question about the warnings I am receiving using IQTREE - I might just be missing something fundamental. When running the Model Selection tab on the IQTREE webserver (alignment of ~650 taxa, 4 genes, 10 initial partitions (3x codons for for COI & EF1a, then unpaired and paired 16S and 28S) 2174 bp total - so lots of short partitions, and there's also lots of missing data) - - under the BIC criteria whilst using the merge partitions option, the best scheme has five partitions, but I get the following warnings: WARNING: Partition merging found worse model than single model! WARNING: Please do not use partition model! - under AICc in IQTREE, there are no warnings and the best partitioning scheme suggests merging all partitions into a single partition. - Using Partition Finder with AICc, it suggests 7 partitions. Just curious about a) the warnings - does this mean I should not use that partitioning scheme, or just not use the models associated with that partitioning scheme? and b) I know that it is common to have different best partitioning schemes suggested under the two criteria (BIC and AICc) but wondering why it might be so different between Partition Finder and ModelFinder in IQTREE when they are both set to use AICc? Many thanks for your time, Erinn ", "Hi Erinn, That\u2019s an interesting observation. Can you pls paste the command line that the web server printed here? Which version of IQ-TREE is it? What IQ-TREE found here, is that you should better use no partitioning. Typically IQ-TREE and PartitionFinder give similar answer (difference can be due to different implementations) if you use the same parameters. Apart from criterion like BIC or AICc, there are also other options such as linking or unlinking edge lengths, that might influence the result. So please also give the input for PartitionFinder here. Rob is on this forum and can certainly say something. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/41e94b8c-2495-4c64-8c2f-ba75163dbed4%40googlegroups.com ", "Thanks so much for your time and your quick reply, Minh. The command line for the IQTREE webserver for the BIC analysis is: path_to_iqtree -s fourgene4.phy -st DNA -sp nexus_allpartitions.txt -pre fourgene4.phy -m TESTONLYMERGE -rcluster 10 and for the AICc analysis: path_to_iqtree -s fourgene4.phy -st DNA -sp nexus_allpartitions.txt -pre fourgene4.phy -m TESTONLYMERGE -AICc -rcluster 10 Version is: IQ-TREE multicore version 1.6.11 for Linux 64-bit built Jun 6 2019 Partition Finder2 was run on CIPRES, the parameters as linked branch lengths, greedy search with aicc, r cluster percent = 10, all models of evolution, phyml (not raxml). Not sure if any of that helps - many thanks for clarifying what the warnings mean! Cheers, Erinn To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Erinn, Alright as I expected, you used \u201c-sp\u201d option, which is the edge-unlinked model and different from PartitionFinder2. Change it to -spp for edge-linked model (I believe this is the default option in the web server when you upload a partition file, but if not, please check \u201cEdge-linked\u201d box). IQ-TREE v2 introduced a new option -p, which is synonymous to -spp. This is now the recommended option, as shown by a recent paper by David Duchene and co: https://doi.org/10.1093/molbev/msz291 Cheers Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0e0dd55f-a1e1-4db0-9624-4adc25f358c3%40googlegroups.com ", "Hi All, Jumping in late here, but just thought I'd make a couple of quick points. In case it's not already clear, the edge-unlinked model you used in IQ-TREE will tend to join more partitions together simply because every additional partition in the model adds 2N-3 branch length parameters on top of whatever model parameters are required. When you link the edges, it drops a lot to 1 relative rate parameter for each partition on top of the model parameters. As Minh mentioned, I'd expect for the most part that you'll get similar answers in PartitionFinder and IQ-TREE. There may be differences because the implementations are a little different, and because the models considered can also be different. Rob To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/75ADBAC8-CF54-42CF-9B4F-DDBE0ED9C106%40univie.ac.at Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Thanks so much Minh and Rob, I really appreciate you taking the time to reply and offer help! On Wednesday, 27 May 2020 19:11:46 UTC+9:30, Rob Lanfear wrote: Hi All, Jumping in late here, but just thought I'd make a couple of quick points. In case it's not already clear, the edge-unlinked model you used in IQ-TREE will tend to join more partitions together simply because every additional partition in the model adds 2N-3 branch length parameters on top of whatever model parameters are required. When you link the edges, it drops a lot to 1 relative rate parameter for each partition on top of the model parameters. As Minh mentioned, I'd expect for the most part that you'll get similar answers in PartitionFinder and IQ-TREE. There may be differences because the implementations are a little different, and because the models considered can also be different. Rob Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0e0dd55f-a1e1-4db0-9624-4adc25f358c3%40googlegroups.com You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/75ADBAC8-CF54-42CF-9B4F-DDBE0ED9C106%40univie.ac.at "]}, "yWp3Umbs4Vw": {"topic": "Perform non parametric bootstrap with specified partition scheme and model", "initializeDate": "Nov 9, 2020, 6:32:06 PM", "timeStamp": "Dec 2, 2020, 7:31:01 AM", "content": ["Hi group, I performed a search for the best partition scheme and selection of substitution models in conjunction with ultrafast boostrap approach. What I want to do next is to perform a standard boostrap analysis using the results from the previous run. So my question is if it is correct to fed the search with the best_scheme.nex and best_model.nex outputs, with the and flags, respectively. Like: iqtree -s msa.phy -p best_scheme.nex best_model.nex -b 1000 --prefix output Or I may be missing something with that command? Thanks in advance ", "My apology for the delay in replying. Just too much commitment at the moment. Use -p option, not -m (-m is for single model, not a partition model). Either you can do iqtree -s msa.phy -p best_scheme.nex best_model.nex -b 1000 --prefix output iqtree -s msa.phy -p best_model.nex -b 1000 --prefix output The difference is that best_model.nex stores not only the best partitioning scheme, but also model parameters. So the second run will actually fix all model parameters, whereas the first run will re-estimate model parameters. So the 2nd will be faster. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/56db4949-4e42-4b9b-9b0e-a62ab6bae93an%40googlegroups.com "]}, "bgN0QEVG8U0": {"topic": "Model Parameters", "initializeDate": "Dec 7, 2017, 2:27:48 PM", "timeStamp": "Dec 10, 2017, 6:05:06 PM", "content": ["Hello, short question. After I ran an analysis for a model selection, where can I find the rest of the missing model parameters (substitution rate parameters, Kappa or ti/tv and Alpha)? Same question for the not best fit models. I got a \"Run log\" and a \"full result\" file here: http://iqtree.cibiv.univie.ac.at/ (I'm new to IQ-Tree - sorry). All the best Dieter ", "Dear Dieter, I guess this is not possible via the web service. However, it is possible to look at model parameters for all tested models if you download and run IQ-TREE locally. All these information are printed in .model file. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "IRa15jZx2YE": {"topic": "how to use \"testnew\" commend?", "initializeDate": "Oct 4, 2017, 3:09:15 PM", "timeStamp": "Oct 4, 2017, 4:03:48 PM", "content": ["I installed IQ-tree on my mac and use \" bin/iqtree-omp -s example.phy -nt AUTO\" to run the example file, it works. However, when I follow the manual instruction and type \" iqtree -s example.phy -m TESTNEW \"in my terminal, it says \" -bash: iqtree: command not found\". Does anyone know what's the problem here? Thanks. ", "Hi, I don\u2019t think the problem is with the \u201cTESTNEW\u201d option. I notice that when you run the example you use \"bin/iqtree-omp\u201d and it works fine. When you try to use the TESTNEW option you only use \u201ciqtree\u201d. I think this is your issue, the error message suggests that iqtree is not a valid command. Try using \u201cbin/iqtree-omp\u201d if that worked for the example. Hope this helps, Stephen On 4 Oct 2017, at 9:09 pm, JChan < idjoan...@gmail.com > wrote: I installed IQ-tree on my mac and use \" bin/iqtree-omp -s example.phy -nt AUTO\" to run the example file, it works. However, when I follow the manual instruction and type \" iqtree -s example.phy -m TESTNEW \"in my terminal, it says \" -bash: iqtree: command not found\". Does anyone know what's the problem here? Thanks. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hello Stephen, I changed it to \"bin/iqtree-omp -s example.phy -m TESTNEW\" , it told me ERROR: Checkpoint (example.phy.ckp.gz) indicates that a previous run successfully finished Use `-redo` option if you really want to redo the analysis and overwrite all output files.\" Is it because I already run the example.phy successfully? Does it mean if I run a file successfully, then I can't use TESTNEW to run this file again? Thanks, Joanna ", "Hi Joanna, This error occurs to make sure that you don\u2019t accidentally overwrite the output from a previous run. If you do not care about the previous run and are happy to overwrite the output files then all you have to do is add \u201c-redo\u201d to your command. However if you want to keep the output for your old run and also do your new run you will need to use the \u201c-pre\u201d option. This gives you the opportunity to give your output files a name that is meaningful to you. So you could add \u201c-pre exampleTESTNEW\u201d and then all the output files would begin with \u201cexampleTESTNEW\u201d. Cheers, Stephen "]}, "Fo7MeD2yQfM": {"topic": "Run partitioned analysis with a user-selected model and MERGE option?", "initializeDate": "Sep 1, 2017, 3:57:59 AM", "timeStamp": "Sep 19, 2017, 6:08:04 AM", "content": ["Hi! I'm wondering if IQ-TREE running with a user definde model (e.g. \"-m GTR+I+G4\") might support partitioned analysis with MERGE option - i.e. to merge the user defined partions (e.g. based on genes and/or codon positions) into subsets and calculate partition-specific rates for these merge subsets instead for each partition? Thanks for any suggestions (or correction in case I misunderstood the principles of partitioned analysis and it does not make sense to do what I'm suggesting). Best, Ales ", "Dear Ales, you can use these option: -mset GTR -mrate I+G -m TESTMERGE which will force the model to be GTR and rate heterogeneity to I+G for all partitions. And TESTMERGE is the usual option to do the merge as you wished. More commands here: http://www.iqtree.org/doc/Command-Reference#automatic-model-selection Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, I run IQTREE with parametres -m GTR -mrate I,G,I+G -m TESTMERGE but it seems that IQTREE is not limited to GTR models but is testing also other models - I'm sending the logfile to your email. Just couple of lines from the logfile: Create initial parsimony tree phylogenetic likelihood library PLL )... 1.577 seconds NOTE ModelFinder requires 4199 MB RAM Selecting individual models for 762 charsets using BIC ... Model Score Charset K3Pu 31882.512 OrthoDB_OMA00233_pos3 TVM 36114.399 OrthoDB_OMA00326_pos3 TPM2 41210.481 OrthoDB_OMA00441_pos3 TPM2u 43562.909 OrthoDB_OMA00333_pos3 TIM2 42993.403 OrthoDB_OMA00188_pos3 TPM3u 48206.989 OrthoDB_OMA00455_pos3 Could you help to solve what is happening here? Thanks in advance Ales ", "Hi Ales, the quick answer is to change \u201c-m GTR\u201d to \u201c-mset GTR\u201d. Cheers, Minh "]}, "KEzsUbF4Vh0": {"topic": "Erroneous codon not present in alignnment message", "initializeDate": "May 9, 2017, 12:55:13 AM", "timeStamp": "Dec 6, 2017, 2:34:37 AM", "content": ["Hi there, I'm a new IQ-TREE user and ran the test data set, with all outcomes as expected, and am now testing a subset (50 sequences, 53,574 nt sites) of a larger matrix (1015 sequences, 53,574 nt sites) that I hope to analyze with IQ-TREE. I have run a few iterations, none of which have completed. After increasing the memory request in the batch file, the runs have aborted immediately after the message you will see below in the last 10 lines from the log file. You will see that I'm analyzing codons. IQ-TREE found some incomplete codons that I had missed. I fixed those after one of the early runs, but some ambiguities remain in some codons. The odd thing about the WARNINGS below, is that each of the codons listed as not being present in the alignment is in fact present, in some cases (e.g., TGG), numerous times. Thanks in advance for your help! Cheers, Sarah FIRST 10 LINES OF LOG FILE IQ-TREE multicore version 1.5.4 for Linux 64-bit built Apr 27 2017 Copyright (c) 2011-2017 by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, and Arndt von Haeseler. Host: c026 (AVX2, FMA3, 125 GB RAM) Command: iqtree -s plants3_gb50_smatrix_50seqs.phy -sp plants3_gb50_parts.nex -st CODON -nt AUTO -m MFP+MERGE -cmax 15 Seed: 676989 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Tue May 9 14:29:08 2017 Kernel: AVX+FMA - auto-detect threads (20 CPU cores detected) LAST 10 LINES Computing BIONJ tree... 0.004 seconds NOTE: ModelFinder requires 2990 MB RAM! NUMBER OF THREADS FOR PARTITION FINDING: 20 Selecting individual models for 81 charsets using BIC... No. Model Score Charset WARNING: TGG is not present in alignment that may cause numerical problems WARNING: ACG is not present in alignment that may cause numerical problems WARNING: CGG is not present in alignment that may cause numerical problems ", "Dear Sarah, thanks for the message. Are these really the last lines of the log (e.g. no other ERROR or CRASH message) before iqtree stopped? For your question: WARNINGs were printed because some of the partitions do not contain these codons (I will print the name of that partition for the next release). Parameter estimation for this partition is unstable. So I would remove such partition before the analysis\u2026 let me know how this goes then. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Sarah, On May 10, 2017, at 4:06 AM, Sarah....@csiro.au wrote: Dear Minh, Thanks for your prompt response! Yes, indeed, these are the exact and only last 10 lines of the log files from attempts to analyse this data set. If there had been any informative error or crash message I certainly would have sent it. That is, I think, a first principle of requesting help. sorry that\u2019s right. I was just surprised that IQ-TREE did not print anything else after reading the log you sent. Since I don\u2019t really know what went wrong, can you send me the data files via personal email? The message stated that the codons were not present in the alignment, not that they were missing from one of the 81 partitions. Since some of the partitions have a fair bit of missing data, this would not be surprising. right, I will correct the WARNING in the next release. I would prefer not to omit any partitions based on missing data. The structure of the data set is that a set of core taxa is represented by deep sampling of the plastid genome while many taxa are represented by fewer genes, in some cases just two, or even one. I understand the issues that this can present, and do have a more \u201ccomplete\u201d version of the matrix, but ultimately, it is also important to work with the matrix that has the highest taxonomic representation as possible. I see. But note that the absence of some codons might not be the real cause (as IQ-TREE printed warnings and not errors). Thus I want to examine your data set before further step. As a technical note: IQ-TREE internally sets the frequency of absent codons to a very small number (10^-4) to avoid numerical problems, but it might not work in all instances. A more (numerically) robust solution is to remove absent codons from the Markov process, but I want to consult Ziheng Yang first what he did in the PAML package. Cheers, Minh Thanks for your advice and help! Best, Sarah Dr Sarah Mathews Senior Research Scientist - CSIRO Australian National Herbarium | Centre for Australian National Biodiversity Research Honorary Associate Professor - The Australian National University | Research School of Biology --------------------------------------------------- GPO Box 1700, Canberra, ACT, 2601 +61 2 6246 5514 +61 0475 957 804 sarah....@csiro.au From: Sarah Mathews < sarah.y...@gmail.com Date: Wednesday, 10 May 2017 at 11:32 AM To: \"Mathews, Sarah (NCMI, Black Mountain)\" < Sarah....@csiro.au Subject: Fwd: [iqtree] Erroneous codon not present in alignnment message ", "Dear Sarah, I asked Ziheng Yang and he consulted me: \"this may be a problem for the F61 or similar models, with 60 frequency parameters, and less so for the F3x4 or similar models. if too many codons are missing in the F61 model, the states will not be commutative, which will cause problems. is this what you are talking about. if the chain is still commutative, perhaps there should be no problem.\" Thus for the moment to avoid delay while I am examining the your data set, can you please add the following option into iqtree command: \"-mfreq F1x4,F3x4\" This effectively disallows +F for your data set, and may reduce numerical problem. Let me know how this goes then. He also confirmed that PAML removes absent codons from the codon models, thus reducing the number of states in the Markov models. I will implement this more robust technique in a later 1.6.X release. Cheers, Minh On May 11, 2017, at 3:26 AM, < Sarah....@csiro.au > < Sarah....@csiro.au > wrote: Hi Minh, Thanks for all of your advice, and thanks for pursuing the question about absent codons with Ziheng. I\u2019ve attached the data set. The sequences are just the first 50 from the 1015-sequence matrix, with no scrutiny of how well the subset captured the diversity of the total set of sequences (which span the earliest land plants to derived angiosperms, so a high degree of phylogenetic breadth). Cheers, Sarah <plants3_gb50_smatrix_50seqs.fas> ", "Hi Binh, After incorporating the \u2013mfreq option, the run still fails, as before, after the warning about codons not being present. ", "Dear Sara, thanks for letting me know. Since a few users also reported similar problem with codon models, it is now my priority to fix it. Cheers, Minh ", "Hi Sarah, So I was able to improve numerical stability for codon models. However, there was still numerical issue. It is due to many absent codons as reported now by a local IQ-TREE version (see below). Therefore, I conclude that this data is not suitable for analysis with codon models. Please use DNA or protein models instead. For using protein models, you can simple specify \u201c-st NT2AA\u201d option instead of \u201c-st CODON\", which will automatically convert the alignment into protein alignment. Cheers, Minh WARNING: AGA, AGG are not present in partition petB_plants3.g50 that may cause numerical problems WARNING: TGC is not present in partition rps8_plants3.g50 that may cause numerical problems WARNING: ACG, AGT, CTG, GTC, TCG, TGC, TGG are not present in partition rps16_plants3.g50 that may cause numerical problems WARNING: AAG, ACG, AGA, AGG, ATG, CAC, CAG, CAT, CCC, CCT, CGC, CGG, GAG, GAT, GCA, GCC, GCG, GGC, GTC, TGC, TGT are not present in part ition psbL_plants3.g50 that may cause numerical problems WARNING: AGG, CAC, CAT, CGC, CGT, GAC, TGC, TGG, TGT are not present in partition atpH_plants3.g50 that may cause numerical problems WARNING: CAG, CTC, GCC, GCT, TGG are not present in partition rpl33_plants3.g50 that may cause numerical problems WARNING: ACG, AGC, CAC, CAG, CGC, CGT, GCG, TAC, TGC, TGG, TGT are not present in partition psbT_plants3.g50 that may cause numerical pr oblems WARNING: CAC, CAG, CCC, CCG, CCT, GGC, TAC, TGC are not present in partition ndhE_plants3.g50 that may cause numerical problems WARNING: ACG, CGG are not present in partition psbA_plants3.g50 that may cause numerical problems WARNING: CGG, TGC are not present in partition ndhG_plants3.g50 that may cause numerical problems WARNING: CGC is not present in partition ccsA_plants3.g50 that may cause numerical problems WARNING: ACC, ACG, AGA, AGC, AGG, CAC, CGA, CGG, CGT, GGG, TGC, TGG, TGT are not present in partition psaI_plants3.g50 that may cause nu merical problems WARNING: TGC, TGT are not present in partition rps7_plants3.g50 that may cause numerical problems WARNING: TGC is not present in partition rpl23_plants3.g50 that may cause numerical problems WARNING: AGA, AGC, AGG, ATG, CAA, CAC, CAG, CAT, CGA, CGC, CTG, TAC are not present in partition psaJ_plants3.g50 that may cause numeric al problems WARNING: AAC, AAG, AAT, ACG, AGC, AGG, AGT, CAC, CAT, CCC, CCG, GTC, TGC, TGG, TGT are not present in partition petG_plants3.g50 that ma y cause numerical problems WARNING: GTC is not present in partition ycf3_plants3.g50 that may cause numerical problems WARNING: CAA, CCC, CCT, CTC, GAT, GGC, GTG, TGC, TTC are not present in partition rpl32_plants3.g50 that may cause numerical problems WARNING: CCG, CCT, GCC are not present in partition rps15_plants3.g50 that may cause numerical problems WARNING: TAC, TGC are not present in partition atpE_plants3.g50 that may cause numerical problems WARNING: TGT is not present in partition rps19_plants3.g50 that may cause numerical problems WARNING: AAC, AAG, ACC, ACT, AGC, CAC, CAG, CAT, CCA, CCC, CCG, CCT, CGA, CGC, CGG, CGT, GAT, GGC, GGG, GTC, GTG, TAC, TCT, TGC, TGG, TG T are not present in partition psaM_plants3.g50 that may cause numerical problems WARNING: AGA, AGG, CAC, CAG, CAT, CCG, CGA, CGC, CGG, CGT, GAC, GAG, GGG, TAC, TAT, TGC, TGT are not present in partition psbZ_plants3.g 50 that may cause numerical problems WARNING: CTC is not present in partition ndhI_plants3.g50 that may cause numerical problems WARNING: TGG is not present in partition atpA_plants3.g50 that may cause numerical problems WARNING: TGC is not present in partition rps14_plants3.g50 that may cause numerical problems WARNING: AGC is not present in partition ndhJ_plants3.g50 that may cause numerical problems WARNING: AAG, AGG, TGC, TGT are not present in partition psbE_plants3.g50 that may cause numerical problems WARNING: AAA, AAC, AAG, AAT, AGT, CGC, CGG, CTC, CTT, GAA, GAC, GAG, GGC, TAC, TGC, TGT are not present in partition psbF_plants3.g50 th at may cause numerical problems WARNING: AAC, AAG, ACA, ACC, ACG, AGG, CAC, CGG, CGT, GGC, GGG, TGC are not present in partition psbK_plants3.g50 that may cause numeric al problems WARNING: CCG is not present in partition atpF_plants3.g50 that may cause numerical problems WARNING: CAC, CTG, GCC, GCG, TAC, TGC, TGG are not present in partition rps18_plants3.g50 that may cause numerical problems WARNING: ACG, ATG, ATT, CAG, CGC, CGG, CTG, GCG, GGC, TGG are not present in partition psbN_plants3.g50 that may cause numerical problem WARNING: ACC, ACG, AGA, AGC, AGG, AGT, CAA, CAC, CAG, CAT, CCG, CGC, CGG, GCC, GCG, GCT, GGT, TGC, TGG, TGT, TTG are not present in part ition psbI_plants3.g50 that may cause numerical problems WARNING: CCA, CCC, CCG are not present in partition rpl20_plants3.g50 that may cause numerical problems WARNING: CAC, CAT, CGC, TGC are not present in partition psbH_plants3.g50 that may cause numerical problems WARNING: CAC, CTC, CTG, GGC, TAC are not present in partition psaC_plants3.g50 that may cause numerical problems WARNING: CTG is not present in partition petD_plants3.g50 that may cause numerical problems WARNING: AGA, ATA, ATG, CAC, CAG, CAT, CCA, CGC, CGG, CGT, GAC, GAG, GAT, GCG, GGC, GGG, TCC, TGC, TGG, TGT are not present in partition psbM_plants3.g50 that may cause numerical problems WARNING: CAC is not present in partition ycf4_plants3.g50 that may cause numerical problems WARNING: AAC, CAG, CGG, GAC, TGC are not present in partition ndhC_plants3.g50 that may cause numerical problems WARNING: AAA, AAG, ACA, AGC, CAA, CAC, CAG, CAT, CCA, CCC, CCG, CGA, CGC, CGG, CGT, GAA, GAC, GAG, GCG, TCG, TGC, TGT are not present in partition psbJ_plants3.g50 that may cause numerical problems WARNING: ACA, ACC, ACG, ACT, AGC, CCT, CTC, GAC, GAT, GCG, GGC, GGT, GTC, TCA, TGG, TTC, TTT are not present in partition rpl36_plants3. g50 that may cause numerical problems WARNING: AGG, ATG, CAC, CAT, CCC, CCG, CCT, CGC, CGG, GAC, GAG, GAT, GTG, TGC, TGG, TGT are not present in partition petL_plants3.g50 th at may cause numerical problems WARNING: AAA, AAC, AAG, AAT, ACG, CAA, CAC, CAG, CAT, CCA, CCC, CCG, CCT, CGA, CGC, CGG, CGT, CTG, GAA, GAC, GAG, GCG, TAC, TGC, TGT, TT G are not present in partition petN_plants3.g50 that may cause numerical problems WARNING: AGC, ATG, CAC, GGG, TCG are not present in partition rps12_plants3.g50 that may cause numerical problems WARNING: CAC is not present in partition infA_plants3.g50 that may cause numerical problems WARNING: 372 states (see above) are not present that may cause numerical problems On May 26, 2017, at 7:45 AM, Sarah....@csiro.au wrote: ", "Hi Minh, Thanks! I realize that I should have anticipated this possibility, since some of the partitions are quite short. I have a nucleotide analysis running and it\u2019s in its second 24-h segment starting from the checkpoint file. Protein analyses are definitely on the to-do list. I may also try using the codon option again, after combining the partitions that have the same optimal nt model, to see if the larger partitions would have all the codons. I greatly appreciate the help! ", "Dear Sarah, This problem might be resolved now with version 1.5.6 just released. Absent states are now technically removed from the Markov process, thus improving numerical stability. Such messages are still printed, but as NOTEs instead of WARNINGs. If I remember correctly, there was another question about absent amino-acid(s) in protein alignments. This should have been resolved as well. Cheers, Minh "]}, "ksUxS-eLkJw": {"topic": "partition analysis problems", "initializeDate": "May 26, 2016, 10:52:37 PM", "timeStamp": "May 28, 2016, 2:10:30 AM", "content": ["I try to combine the DNA data and indel data (binary) to construct the phylogenetic tree, so i use two separated files: one fasta format for DNA data and one fasta format for indel data as in attachment file. Using these file separately to construct the phylogenetic try are ok. However, it doesn't work when i combined them. I try to convert these file to phylip, clustal format, but it still un Because i'm newbie, so i don't know how to solve these problems. I'm glad to receive any advice and suggestion. Sorry because of my bad English skill ", "Dear Quynh, The error message says that iqtree cannot find the alignment file - it is likely because you run iqtree from a folder different from the one that contains the input files. Therefore you need first to change to that folder (e:\\PED\\Nafostedsep\\Analysisdata\\finaldatabasecutoff\\RELINDELresult\\) and then execute this command. Second, there is a typo in the model name for the first partition, it should be \u201cGTR+G+I\u201d (or GTR+I+G) instead of \u201cGTG+G+I\u201d. And finally please try the beta version 1.4.3-beta ( https://github.com/Cibiv/IQ-TREE/releases/tag/v1.4.3-beta ) which fixes one problem with partition model that has binary data. Cheers, Minh On May 27, 2016, at 4:52 AM, Qu\u1ef3nh \u0110\u1ed7 H\u1ea3i < quynh...@gmail.com > wrote: I try to combine the DNA data and indel data (binary) to construct the phylogenetic tree, so i use two separated files: one fasta format for DNA data and one fasta format for indel data as in attachment file. Using these file separately to construct the phylogenetic try are ok. However, it doesn't work when i combined them. I try to convert these file to phylip, clustal format, but it still un Because i'm newbie, so i don't know how to solve these problems. I'm glad to receive any advice and suggestion. Sorry because of my bad English skill You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <partitionfile.nexus> <partitionfile.nexus.log> <finaldatabasecutoff.fas> <finaldatabaseindel.fas> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thank you for your support. I tried it again follow your recommendation. To be specific, i put the three file: partition.nex, finaldatabasecutoff.fas, finaldatabaseindel.fas into the same folder as iqtree. However, it still doesn't work. V\u00e0o 15:27:57 UTC+7 Th\u1ee9 S\u00e1u, ng\u00e0y 27 th\u00e1ng 5 n\u0103m 2016, Bui Quang Minh \u0111\u00e3 vi\u1ebft: ", "Dear Quynh, that\u2019s correct. However the file name specified in partition.nex is .phy, whereas you have .fas files here\u2026 Minh <partitionfile.nexus.log> ", "Dear Minh Sorry about my mistake, this log file created when i try to run iqtree with phylip format file. I did as you said, however, it still doesn't work. I don't know what i can not do it. I send you the sequence file, partition file and log file V\u00e0o 19:48:24 UTC+7 Th\u1ee9 S\u00e1u, ng\u00e0y 27 th\u00e1ng 5 n\u0103m 2016, Bui Quang Minh \u0111\u00e3 vi\u1ebft: "]}, "37RX58kZU3M": {"topic": "bug report: crash during tree search, partitioned DNA and codon data", "initializeDate": "Dec 30, 2016, 12:33:32 PM", "timeStamp": "Jan 5, 2017, 5:12:10 AM", "content": ["Dear IQ-Tree developers, IQ-Tree crashed while inferring a tree . . . interesting looking bits of log file are below (thanks!): IQ-TREE multicore version 1.5.2 for Linux 64-bit built Dec 30 2016 Copyright (c) 2011-2016 Nguyen Lam Tung, Olga Chernomor, Arndt von Haeseler and Bui Quang Minh. Host: _ (AVX, 15 GB RAM) Command: _/iqtree-omp -spp sequences/WGS_alnd_partitioned.nex -bb 1000 -nt 3 -redo -safe Seed: 266582 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Fri Dec 30 11:59:48 2016 Kernel: Safe AVX - 3 threads(4 CPU cores detected) Reading partition model file sequences/WGS_alnd_partitioned.nex ... Reading partition CR (model=MGK+F3X4+G4, aln=sequences/WGS_alnd_concat_CR.fna, seq=CODON, pos= 1-14160) ... Reading alignment file sequences/WGS_alnd_concat_CR.fna ... Fasta format detected Alignment most likely contains DNA/RNA sequences Converting to codon sequences with genetic code ... WARNING: Sequence MVs/Taunton.GBR/15.13 has ambiguous character GMA at site 4378 WARNING: Sequence MVs/London.GBR/28.12 has ambiguous character RGT at site 4510 WARNING: Sequence MVi/BritishColumbia.CAN/12.10/1 has ambiguous character CAR at site 8443 Alignment has 77 sequences with 4720 columns and 2137 patterns (1749 informative sites) WARNING: Some sequence names are changed as follows: ... **** TOTAL 0.07% 0 sequences failed composition chi2 test (p-value<5%; df=63) 77 sequences and 4720 sites extracted Reading partition NCR (model=TIM+G4, aln=sequences/WGS_alnd_concat_NCR.fna, seq=DNA, pos= 1-1548) ... Reading alignment file sequences/WGS_alnd_concat_NCR.fna ... Fasta format detected Alignment most likely contains DNA/RNA sequences Alignment has 77 sequences with 1548 columns and 485 patterns (492 informative sites) ... **** TOTAL 0.59% 0 sequences failed composition chi2 test (p-value<5%; df=3) 77 sequences and 1548 sites extracted NOTE: Mixed codon and other data, branch lengths of codon partitions are rescaled by 3! Degree of missing data: 0.000 Info: multi-threading strategy over alignment sites ... NOTE: 334 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.100) Initial log-likelihood: -55341.422 Current log-likelihood at step 1: -53563.312 Current log-likelihood at step 2: -53445.415 Current log-likelihood at step 3: -53445.315 Current log-likelihood at step 4: -53445.315 Partition-specific rates: 2.519 2.467 Parameters optimization took 3 rounds (111.987 sec) WARNING: Estimated model parameters are at boundary that can cause numerical instability! ... Iteration 100 / LogL: -53427.373 / Time: 2h:34m:36s (0h:1m:33s left) Log-likelihood cutoff on original alignment: -53498.585 NOTE: Bootstrap correlation coefficient of split occurrence frequencies: 0.980 NOTE: UFBoot does not converge, continue at least 100 more iterations WARNING: Numerical underflow for lh-derivative ... Iteration 170 / LogL: -53530.469 / Time: 4h:16m:0s (0h:45m:26s left) WARNING: Numerical underflow for lh-derivative WARNING: Numerical underflow for lh-derivative STACK TRACE FOR DEBUGGING: 1 funcAbort() 2 () 3 gsignal() 4 abort() 5 () 6 () 7 double PhyloTree::computeLikelihoodFromBufferGenericSIMD<Vec4d, true, false, false>() 9 GOMP_parallel() 11 PhyloSuperTreePlen::swapNNIBranch(double, PhyloNode*, PhyloNode*, SwapNNIParam*, NNIMove*) 12 PhyloSuperTreePlen::getBestNNIForBran(PhyloNode*, PhyloNode*, NNIMove*) 13 IQTree::evaluateNNIs(std::map<int, std::pair<Node*, Node*>, std::less<int>, std::allocator<std::pair<int const, std::pair<Node*, Node*> > > >&, std::vector<NNIMove, std::allocator<NNIMove> >&) 14 IQTree::optimizeNNI(bool) 15 IQTree::doNNISearch() 16 IQTree::doTreeSearch() 17 runTreeReconstruction(Params&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, IQTree&, std::vector<ModelInfo, std::allocator<ModelInfo> >&) 18 runPhyloAnalysis(Params&, Checkpoint*) 19 main() 20 __libc_start_main() 21 _start() *** IQ-TREE CRASHES WITH SIGNAL ABORTED ", "Dear user, Thanks for the report. This sounds like a bug. Can you please send me the alignments, partition file and the log file via my personal email? Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "Wy9XdtCsh3s": {"topic": "choose models for PMSF", "initializeDate": "Aug 10, 2020, 10:13:02 AM", "timeStamp": "Aug 13, 2020, 8:25:42 PM", "content": ["Hi all: Recently i want to try PMSF for my Amino acid matrix, but i was not sure which model i should first run to get a guide tree. Here is what i try, and i had four questions about it: 1, because my data is from mitochondrial genome, so i first run MFP to get best_scheme.nex (below show the details), how do i choose the model for PMSF? #nexus begin sets; charset ALICUT_c3.aa_ali = 2382-2652; charset ALICUT_c1.aa_ali = 2780-3303; charset ALICUT_n6.aa_ali = 2653-2779; charset ALICUT_a6.aa_ali = 1316-1539; charset ALICUT_n2.aa_ali = 633-858; charset ALICUT_n5.aa_ali = 859-1315; charset ALICUT_n4.aa_ali = 1915-2279; charset ALICUT_n3.aa_ali = 2280-2381; charset ALICUT_cb.aa_ali = 1540-1914; charset ALICUT_n4l.aa_ali = 323-399; charset ALICUT_c2.aa_ali = 400-632; charset ALICUT_n1.aa_ali = 1-289; charset ALICUT_a8.aa_ali = 290-322; charpartition mymodels = mtART+F+R8: ALICUT_c3.aa_ali, mtART+F+R6: ALICUT_c1.aa_ali, mtInv+F+G4: ALICUT_n6.aa_ali, mtART+F+R7: ALICUT_a6.aa_ali, mtZOA+F+I+G4: ALICUT_n2.aa_ali, mtART+F+R6: ALICUT_n5.aa_ali, mtART+F+R7: ALICUT_n4.aa_ali, mtInv+I+G4: ALICUT_n3.aa_ali, mtART+F+R7: ALICUT_cb.aa_ali, mtInv+F+G4: ALICUT_n4l.aa_ali, mtInv+R6: ALICUT_c2.aa_ali, mtART+F+R6: ALICUT_n1.aa_ali, mtInv+I+G4: ALICUT_a8.aa_ali; end; 2, i see some examples to use LG+C20+G for PMSF, dose this is the results from modelfinder\uff1f and in my case i should try mtART or mtInv rather than LG? 3, how to determine which class i should use from C10-C60? maybe i should use the command like -madd mtART+C10, C20,C30,C40,C50,C60 to get best model and a guide tree? maybe should like: $ iqtree -s FcC_supermatrix.fas -spp FcC_supermatrix_partition.txt -m MFP -alrt 10000 -bb 10000 -nt AUTO -bnni -abayes -madd -madd mtART+C10, C20,C30,C40,C50,C60 4, does use mpi version (-np) can give fast and accurate results than use threads (-nt)? Best regards Jiachen ", "Hi Jiachen, Yes, it makes sense for your dataset to use one of the mito. models, instead of LG. Simply use the mt rate matrix designed for your organisms, or if unsure, perform ModelFinder without partitioning. Then let\u2019s say if mtART+G is the best model, then you can try mtMART+C20. Note that C20 already implies +G, so mtART+C20+G is equivalent to mtART+C20. 3, how to determine which class i should use from C10-C60? maybe i should use the command like -madd mtART+C10, C20,C30,C40,C50,C60 to get best model and a guide tree? Yes, more precisely: -madd mtART+C10,mtART+C20,mtART+C30,mtART+C40,mtART+C50,mtART+C60 (do not insert space in the comma-separated list of models) maybe should like: $ iqtree -s FcC_supermatrix.fas -spp FcC_supermatrix_partition.txt -m MFP -alrt 10000 -bb 10000 -nt AUTO -bnni -abayes -madd -madd mtART+C10, C20,C30,C40,C50,C60 Looks good, except for -madd that I wrote above. 4, does use mpi version (-np) can give fast and accurate results than use threads (-nt)? How many species do you have? If many, say > 1000, then I\u2019d recommend MPI version. The accuracy should be the same, MPI may just run faster. You can even combine threading with MPI. Since your alignment has < 3000 aa, I suggest that you use a small number of threads (say 4) and several MPI processes, for example mpirun -np 10 iqtree2 -nt 4 -s ALN_FILE \u2026 Cheers, Minh Best regards Jiachen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d4a0c683-e159-4209-864d-48b54876c728o%40googlegroups.com "]}, "8VZdfnKTwXk": {"topic": "negative constraint tree search?", "initializeDate": "Oct 3, 2017, 8:43:03 AM", "timeStamp": "Oct 11, 2018, 4:38:52 AM", "content": ["Dear Minh & all, I was wondering whether it is possible to conduct a negative constrained tree search in IQTREE, similar to using the -g option. By negative constraint I mean the best ML tree that does not contain a given bipartition (e.g. best ML where A and B are not monophyletic). If not, do you plan to implement it in the future? Thank you very much for your time! Iker ", "Dear Iker, That\u2019s an interesting request - I haven\u2019t thought about negative constraint before. Can you give a rationale behind such a feature, i.e. why do you think it is useful? Does it mean, for example, that you want to test the monophyly of A and B by comparing an unconstrained ML tree (where A and B are monophyletic) and a constrained ML tree (where A and B are not). And draw a conclusion if e.g. the 2nd tree is rejected. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi, Yes, exactly! It is essentially the idea of a topology test, except that your unconstrained tree (null hypothesis) would have A+B as monophyletic and you want to compare this tree to the best ML where A+B are not monophyletic. This would tell you how much support there is for the monophyly of A+B, or give you the opportunity to compare site-likelihoods assuming or not this monophyly. I hope that makes sense. Would be great to see such an option in IQTREE :-) Thanks!! All the best, Iker 2017-10-03 15:06 GMT+02:00 Bui Quang Minh minh...@univie.ac.at Dear Iker, That\u2019s an interesting request - I haven\u2019t thought about negative constraint before. Can you give a rationale behind such a feature, i.e. why do you think it is useful? Does it mean, for example, that you want to test the monophyly of A and B by comparing an unconstrained ML tree (where A and B are monophyletic) and a constrained ML tree (where A and B are not). And draw a conclusion if e.g. the 2nd tree is rejected. Cheers, Minh On Oct 3, 2017, at 2:43 PM, Iker Irisarri < irisar...@gmail.com > wrote: Dear Minh & all, I was wondering whether it is possible to conduct a negative constrained tree search in IQTREE, similar to using the -g option. By negative constraint I mean the best ML tree that does not contain a given bipartition (e.g. best ML where A and B are not monophyletic). If not, do you plan to implement it in the future? Thank you very much for your time! Iker You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "dear minh and iker did the negative tree constraint option get implemented in any available version of IQtree? There is a second reason to implement it, be it rather esoteric and that is it is needed to obtain partitioned likelihood measures. congrats on developing an awesome program. Rob desalle ", "Hi Rob, Thanks for your interest. This feature is however not available. While it may sound simple from user perspective, the coding is actually challenging. Unless the implementation leads to a publication. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com "]}, "C31tWsR1BPM": {"topic": "BUG: issue with IQ-tree for codon+EQU model (among other codon models)", "initializeDate": "Sep 2, 2020, 9:59:14 AM", "timeStamp": "Sep 13, 2020, 11:26:19 PM", "content": ["I am a regular user of IQ-tree and often use the program to implement codon models. I usually infer trees for large gene families (e.g. olfactory receptors) and usually do not have a problem. However, I have one troublesome alignment that seems to fail when implementing the codon+EQU model. The run fails both on CIPRES, my home computer, and my lab server with the same error. I am able to infer a tree with nucleotide models for this alignment, but the codon model fails. For other similar gene family alignments, I am able to run the codon models successfully. The error is rather uninformative so I have not been able to troubleshoot much. I tried running the next best fit codon model (Fx1) and got the same error. However, when I run a nucleotide model for this alignment, it works fine. This error is recreated in both versions 1.6 and 2.1. Please let me know how I can attach the data files privately so that this error can be resolved. Thanks. Parameters optimization took 2 rounds (16.863 sec) Computing ML distances based on estimated model parameters... 1435.898 sec Computing BIONJ tree... 0.965 seconds Log-likelihood of BIONJ tree: -149751.024 -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Generating 98 parsimony trees... 33.416 second Computing log-likelihood of 98 initial trees ... 314.557 seconds Current best score: -148480.700 Do NNI search on 20 best initial trees Estimate model parameters (epsilon = 0.100) BETTER TREE FOUND at iteration 1: -148348.213 ERROR: phylokernelnew.h:3273: double PhyloTree::computeLikelihoodFromBufferGenericSIMD() [VectorClass = Vec4d, FMA = true, SITE_MODEL = false]: Assertion `std::isfinite(tree_lh) && \"Numerical underflow for lh-from-buffer\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: output.log ERROR: *** Alignment files (if possible) ", "I believe, there is a numerical issue recently reported for codon models. Unfortunately I can\u2019t find it in GitHub issue anymore. But a quick question: does it work if you don\u2019t use rate heterogeneity across sites model, by e.g. removing all +G or +R part of the model string? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7365f67e-6c1b-4f52-a4eb-293289eefb18n%40googlegroups.com ", "It seems to run through without error with the +G. My colleague ran the model through 'debug' mode, he noted that the suspicious lines might be line 3011 or 3039 in tree/phylokernelnew.h. Interestingly, after running it on a private linux server (i.e. not CIPRES), the program can finish after it crashes by picking up where it left off and run to completion. I'm not sure if it is neglecting an important calculation or not, or it is just running into a numerical error with one tree in tree space. ", "Hi there, I remember now that it was a problem with free-rate models, when combined with codon models. Gamma model is fine. So does it work, if you do -m TEST? (TEST will turn off free-rate models). Note that I wouldn\u2019t trust a run which crashed, even if you could resume from a checkpoint. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d62caccb-a3ee-4aba-8ee6-774f318f930bn%40googlegroups.com "]}, "EVjTq6GJca0": {"topic": "polytomies?", "initializeDate": "Nov 23, 2015, 8:59:25 PM", "timeStamp": "Nov 24, 2015, 4:24:15 AM", "content": ["Hello, I have been using IQTREE for phylogenetic estimation, and like it very much -- thanks! A quick question: if IQTREE infers a tree with a polytomy, how does it resolve it, for the sake of writing the output file? Is it resolved by choosing two sequences to be sister to each other at random? This seems to be suggested by the following thread: https://groups.google.com/forum/#!msg/iqtree/qeoLXzea3N0/3V3iWq2CCAAJ But I thought I would seek confirmation. Many thanks, Jason. ", "Dear Jason, > On Nov 24, 2015, at 2:59 AM, jason...@gmail.com wrote: > Hello, > I have been using IQTREE for phylogenetic estimation, and like it very much -- thanks! thank you for your interests > A quick question: if IQTREE infers a tree with a polytomy, how does it resolve it, for the sake of writing the output file? IQ-TREE always output strictly bifurcating ML trees like other ML software. If you have a trifurcation for example, the resulting trees may be different from run to run with very short branch lengths there (IQ-TREE will also issue a warning). > Is it resolved by choosing two sequences to be sister to each other at random? This depends very much on the likelihood of the 3 bifurcating trees around the trifurcating node.. If the 3 likelihoods are equal, then each of the 3 resolved bifurcation will be returned ~one third of the times. You would see this when performing bootstrap. > This seems to be suggested by the following thread: https://groups.google.com/forum/#!msg/iqtree/qeoLXzea3N0/3V3iWq2CCAAJ > But I thought I would seek confirmation. Hope that helps Minh > Many thanks, > Jason. > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "NFrNYqZgfjQ": {"topic": "CAT-like model", "initializeDate": "Jul 6, 2020, 12:20:49 AM", "timeStamp": "Jul 8, 2020, 7:53:10 PM", "content": ["I want to choose CAT-like model, it should be LG+C20+R4 or GTR20+C20+R4? IQ-tree model find Best-fit model is: LG+F+I+G4. ", "On 6 Jul 2020, at 2:20 pm, YanYan < lil...@163.com > wrote: I want to choose CAT-like model, it should be LG+C20+R4 or GTR20+C20+R4? IQ-tree model find Best-fit model is: LG+F+I+G4. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b868bdef-df1c-4d30-9216-9926dca6561bo%40googlegroups.com ", "Hi there gain, It should be LG+C20+R4, not GTR20+\u2026 Minh On 6 Jul 2020, at 2:20 pm, YanYan < lil...@163.com > wrote: I want to choose CAT-like model, it should be LG+C20+R4 or GTR20+C20+R4? IQ-tree model find Best-fit model is: LG+F+I+G4. "]}, "aulYMFz3dF4": {"topic": "ERROR: Too many threads for short alignments, please reduce number of threads or use -nt AUTO to determine it.", "initializeDate": "Apr 29, 2018, 5:14:51 AM", "timeStamp": "Apr 29, 2018, 8:20:40 PM", "content": ["I'm running iqtree 1.6.1 for phylogeny construction with about 50 partitions (that is 50 protein sequences with partition info) and 500 species. The command I'm using is iqtree -s 1.aln -spp 1.partition -m MFP+MERGE -mset LG,WAG -mrate I,G -bb 1000 -nt AUTO However, I was told the following and the analysis was distrupted. ERROR: Too many threads for short alignments, please reduce number of threads or use -nt AUTO to determine it. I've specified -nt AUTO already. Is there a solution? Do I have to specify the number of threads? ", "Hi there, This problem is known: the error message is not entirely correct, but the part \"please reduce number of threads\u201d gave the right hint. It happens when some partition is very short and -nt AUTO does not work properly. To resolve this issue we have to change the parallelisation scheme. But for now as a quick fix, please specify -nt with a number of threads smaller than the number of partitions for your data set. That should fix it. Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "vjyLDpc1e1Q": {"topic": "performance decrease for long alignments, even with same site patterns", "initializeDate": "Oct 23, 2019, 6:13:33 AM", "timeStamp": "Oct 24, 2019, 1:31:42 AM", "content": ["Hello! I've ran a small simulation to confirm that, under a simple model, the execution time should be approximately constant over the number of SITE PATTERNS, irrespective of the sequence length. This is true up to a certain length, but for longer alignments iq-tree execution time increases linearly with the alignment length (more details below). The only explanation I can find is due to the log-likelihood being very small, it needs to be rescaled more often. However from what I understand this is done at the internal nodes, when the number of taxa is very large (the pll library rescales by default). From what I understand the weights (pattern frequencies) are the last step of the log-likelihood calculation. What is going on? What am I forgetting? sincerely, Leo More details on the simulation: the alignment snp1.aln starts as a 32bp alignment over 31 taxa, and at every step of the simulation it doubles in size by concatenation ( goalign concat ). I confirm that the number of \"distinct patterns\" is 26 at every iteration. for i in `seq 1 16`; do mv snp1.aln o.aln; goalign concat -i o.aln o.aln > snp1.aln; echo -n $i \" \" >> timing2.txt; iqtree -m HKY+G -s snp1.aln -redo | grep wall >> timing2.txt; done These are the timings I observe: 1 Total wall-clock time used: 0.996 sec (0h:0m:0s) 2 Total wall-clock time used: 0.959 sec (0h:0m:0s) 3 Total wall-clock time used: 0.869 sec (0h:0m:0s) 4 Total wall-clock time used: 0.724 sec (0h:0m:0s) 5 Total wall-clock time used: 1.015 sec (0h:0m:1s) 6 Total wall-clock time used: 0.689 sec (0h:0m:0s) 7 Total wall-clock time used: 0.832 sec (0h:0m:0s) 8 Total wall-clock time used: 0.774 sec (0h:0m:0s) 9 Total wall-clock time used: 0.986 sec (0h:0m:0s) 10 Total wall-clock time used: 1.631 sec (0h:0m:1s) 11 Total wall-clock time used: 2.536 sec (0h:0m:2s) 12 Total wall-clock time used: 4.208 sec (0h:0m:4s) 13 Total wall-clock time used: 7.764 sec (0h:0m:7s) 14 Total wall-clock time used: 15.750 sec (0h:0m:15s) 15 Total wall-clock time used: 32.115 sec (0h:0m:32s) And this is figure showing the timings (up to ~10kbp it behaves as expected, and then the execution time explodes). The same behaviour happens without the Gamma model. ", "To (partially) answer my own question: PLL's parsimony calculation (both initial tree and generation of 98 parsimony trees) was responsible for the slowing down. By avoiding it (\"-t PARS -ninit 2\" for example) then the timing was constant, as expected. Why PLL is not using the site frequency info is another story... cheers Leo You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b9e99ace-f446-43c7-b1f0-0a28e2963a1a%40googlegroups.com Leonardo de Oliveira Martins, PhD https://quadram.ac.uk/people/leonardo-de-oliveira-martins/ ", "Hi Leo, CC Alexis, Thanks for looking into this. Alexis can better comment on this, but I vaguely remember that PLL indeed does not use site frequency for a reason. In your extreme case, the parsimony might dominate the run time, leading to this behavour. Cheers, Minh <iqtree_timing.png> You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b9e99ace-f446-43c7-b1f0-0a28e2963a1a%40googlegroups.com Leonardo de Oliveira Martins, PhD https://quadram.ac.uk/people/leonardo-de-oliveira-martins/ You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAFgzOBY8uVQ2_eK4QszHtPyhfs9U_SwYUSndGDgdASHNhG5_fg%40mail.gmail.com ", "As far as I remember (I implemented this a long time ago) the site frequencies are not used because they complicate the vectorization of the parsimony code, Alexis "]}, "kzwaa1GNWT0": {"topic": "Error: File not find", "initializeDate": "Apr 22, 2020, 5:36:17 AM", "timeStamp": "Apr 26, 2020, 9:46:02 PM", "content": ["I have added the file ( .txt) into the directory path of iqtree but when trying to construct a phylogenetic tree, it shows \"Error: File not found\". I'd appreciated if you can guide me to resolve this issue. Thanks PS: I have constructed successfully phylogenetic tree from example.phy file ", "Hi Dulaye, You'll need to provide some more specific details so we can help you. Could you show us: 1. The commandline you used to construct the tree from the example.phy file 2. The commandline you are using that doesn't work 3. The full log file from IQ-TREE for both runs 4. Your input files, if you are able to share them With that info, we should be able to help you out! Rob On Wed, 22 Apr 2020 at 19:36, Dulaye < abdoulayeas...@gmail.com > wrote: I have added the file ( .txt) into the directory path of iqtree but when trying to construct a phylogenetic tree, it shows \"Error: File not found\". I'd appreciated if you can guide me to resolve this issue. Thanks PS: I have constructed successfully phylogenetic tree from example.phy file You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/546c4140-de85-4d96-a2a0-8b2f0fa12641%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Thanks, Rob for your kind response! 1. The command line used to construct the tree from example.phy: C:\\Users\\Administrator/iqtree-2.0.2-Windows>bin\\iqtree -s example.phy 2. The command line that displayed error: C:\\Users\\Administrator/iqtree-2.0.2-Windows>bin\\iqtree -s ICTVRNA2.phy -m TEST -bb 1000 -alrt 1000 -nt 1000 3 & 4 response: Attached files Besides, I can't add a file from IQ-tree server. Reason: fakepath. How can I solve this issue? On Wednesday, April 22, 2020, at 6:04:16 PM UTC+8, Rob Lanfear wrote: Hi Dulaye, You'll need to provide some more specific details so we can help you. Could you show us: 1. The commandline you used to construct the tree from the example.phy file 2. The commandline you are using that doesn't work 3. The full log file from IQ-TREE for both runs 4. Your input files, if you are able to share them With that info, we should be able to help you out! Rob On Wed, 22 Apr 2020 at 19:36, Dulaye < abdoulayeas...@gmail.com > wrote: I have added the file ( .txt) into the directory path of iqtree but when trying to construct a phylogenetic tree, it shows \"Error: File not found\". I'd appreciated if you can guide me to resolve this issue. Thanks PS: I have constructed successfully phylogenetic tree from example.phy file You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/546c4140-de85-4d96-a2a0-8b2f0fa12641%40googlegroups.com ", "Hi Dulaye, 2. The command line that displayed error: C:\\Users\\Administrator/iqtree-2.0.2-Windows>bin\\iqtree -s ICTVRNA2.phy -m TEST -bb 1000 -alrt 1000 -nt 1000 In unix (this is not unique to IQ-TREE, this is for all commandline operations) if you specify a file name with no path, the system will look only in the current working directory. So, it works when you use example.phy because that file is in the folder that you are working in ( C:\\Users\\Administrator/iqtree-2.0.2-Windows ). My best guess as to why it doesn\u2019t work when you use your alignment is that your alignment ICTVRNA2.phy is not in that folder. To fix this is simple - just provide the full file path to the alignment. E.g. if it was in a folder called alignments/ under your user, your commandline might be something like this: bin\\iqtree -s C:\\Users\\Administrator\\alignments\\ICTVRNA2.phy -m TEST -bb 1000 -alrt 1000 -nt 1000 Rob "]}, "Rd077RN4iCM": {"topic": "Question about performance of partition models", "initializeDate": "May 7, 2020, 11:32:21 AM", "timeStamp": "May 7, 2020, 10:56:09 PM", "content": ["Hi, I have long DNA-Sequences and short AA-Sequences (1-10) and provide a partition file in the NEXUS-Format. While running these dataset on a cluster I recognized running IQ-Tree only on the DNA-Sequence is about 4 times faster compared to the run with the complex model. Multithreading also slows down the inference because of the short AA-Sequences of course. Does anyone has experience with such a setup or ideas how to speed up tree reconstruction? Thanks! ", "Hi there, Can you please provide more context about your data, e.g., how many partitions, sequences, sites? Also please paste the command line here and the log file (if confidential, just send to my email) Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/fdb3ddbf-3bfd-4f39-a3a5-5f55d592984e%40googlegroups.com "]}, "kla8-RA1eUs": {"topic": "Concordance Factor and number of parameters", "initializeDate": "Dec 26, 2020, 7:00:55 PM", "timeStamp": "Jan 17, 2021, 11:34:14 PM", "content": ["Hello, I'm trying to compute gene and site concordance factors. The input is composed of: `Input data: 225 taxa with 190 partitions and 46774 total sites (0% missing data)` I concatenated multiple single-gene alignments and I defined a partition for each gene. I estimated the best model for each partition using modeltest-ng and I passed the result to iqtree . When I estimate a species tree everything seems to work properly : ``` iqtree -s $msa -p $partition -B 1000 --bnni -alrt 1000 -nt AUTO -ntmax 24 --prefix all_blau_lrt ``` The problem appears when I try to estimate gene trees in order to compute Concordance Factors: ``` iqtree -s $msa -S $partition -nt AUTO -ntmax 24 --prefix blau-all_locus ``` $partition is the same partition file used to estimate the species tree (from modeltest ``` ... charset WP_015524823.1|GT718_RS07140 = 46135-46383; charset WP_022426467.1|GT718_RS07520 = 46384-46656; charset WP_022426381.1|GT718_RS02505 = 46657-46774; charpartition mine = LG+I+G4+F:WP_015524754.1|GT718_RS07525, LG+I+G4:WP_110103921.1|GT718_RS11690, LG+I+G4+F:WP_129975563.1|GT718_RS12570,... ... ``` Then I got a warning: ``` **************************** WARNING **************************** Number of parameters (K, model parameters and branch lengths): 86358 Sample size (n, alignment length): 46774 ``` When i try using way less species/sequences, around 30 instead of 220, this problem dissapears, but I would like to try to use all or most of the sequences (species) What can I do to try to solve this? Regards, Jose Luis ", "Hi Jose, Sorry for the long delay, I\u2019m back from a long break. Quick answer: You can ignore this warning. Long answer: This warning is meant for a partition model with unlinked branch lengths (-sp option in IQ-TREE 1 or -Q in IQ-TREE 2). But here you used -S option, so this warning does not apply. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/fdd872e0-a3f7-42f1-9f7b-707cd560e711n%40googlegroups.com "]}, "6SErRcyzZ6s": {"topic": "Interpretting Site-Specific Evolutionary Rates", "initializeDate": "Jul 21, 2020, 9:22:08 AM", "timeStamp": "Jul 22, 2020, 8:27:06 AM", "content": ["Hello IQTree Community, This may be a simple question, but I am not sure how to interpret the .rate file generated from IQTree when using the --rate flag. I have some sites with values close to one, while others are well above 1. My question is, what are the units for the Rate values in the second column? Additionally, what is the difference between the rate column and the categorized_rate column? Any insight would be greatly appreciated. Sincerely, Gio ", "Hi Gio, The Rate column shows the posterior-mean site rate for a specific site in the alignment. The scaling is between 0 and 100, with 1 being the average rate over all sites. Rate < 1 means that the site has evolved slower than normal and rate > 1 means that it has evolved faster. Rate ~ 0 means that the site is highly conserved. The Categorized_rate column show the posterior-maximum site rate: it is the rate of the category where this site most likely falls into (based on posterior probability). You will see that the Rate column is quite continuous. Whereas the Categorized_rate is discrete, having only 4 values if you have +G4 model, for example. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/82a1196a-8f5a-49a2-9ebd-c1fbc6b4d38bo%40googlegroups.com ", "Hello Minh, Yes, this was exactly what I was looking for, thank you! Gio To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/DE110453-52BC-4599-9298-0B518314DC4F%40univie.ac.at "]}, "1I6jKlx-_yM": {"topic": "IQ-TREE release 1.4.1", "initializeDate": "Mar 16, 2016, 3:33:12 PM", "timeStamp": "Mar 16, 2016, 3:33:12 PM", "content": ["Mar 16, 2016 Dear users, IQ-TREE version 1.4.1 is just released, which mainly provides hotfix for version 1.4.0: Fix bugs introduced in 1.4.0: * A crash with checkpointing for `-mtree` option (reported by a web server user). * A crash with likelihood mapping for partition models with sparse supermatrix (reported by Harald Letsch). New features: * Support cluster file (`-lmclust`) in RAxML-style format for likelihood mapping analysis. * Support alignments with >255 sequences for likelihood mapping analysis. * New option `--opt-gamma-inv` to optimize `+I+G` parameters thoroughly. Best, IQ-TREE development team "]}, "rljp0MfFfyk": {"topic": "Blank space PHY writer bug + ambiguous base symbol question", "initializeDate": "Sep 6, 2017, 10:31:35 PM", "timeStamp": "Sep 12, 2017, 7:18:30 AM", "content": ["Hi, My apologies if these have been raised before. I've tried searching but haven't found answers to the bug at least... The bug: I run $ iqtree-omp -nt 4 -s ant.phy -st DNA -m MFP -bb 1000 -pre ant The resulting ant.varsites.phy file has an extra blank space added between the sample name and the start of the loci block. This breaks the (awful) PHYLIP format spec, and you may now be losing a locus from consideration - I have no idea how the IQ-Tree PHYLIP parser handles this. The question: I want to retain ambiguous code DNA codes, however when I run: $ iqtree-omp -nt 4 -s ant.phy -st DNA -m MFP+ASC -bb 1000 -pre ant It fails. It looks like ASC cannot handle these at all. I'm running version 1.5.5. Is there some way I can keep both, or is this simply a nonsensical thing to ask of IQ-Tree? Many thanks, Cam ", "Hi Cam, On Sep 7, 2017, at 4:31 AM, Cameron Jack < cam.j...@gmail.com > wrote: Hi, My apologies if these have been raised before. I've tried searching but haven't found answers to the bug at least\u2026 no worry at all, this is exactly the purpose of this user mailing list. The bug: I run $ iqtree-omp -nt 4 -s ant.phy -st DNA -m MFP -bb 1000 -pre ant The resulting ant.varsites.phy file has an extra blank space added between the sample name and the start of the loci block. This breaks the (awful) PHYLIP format spec, and you may now be losing a locus from consideration - I have no idea how the IQ-Tree PHYLIP parser handles this. that\u2019s right, IQ-Tree will add at least one empty space between the sequence name and the sequence itself to allow the so-called *extended* Phylip format (that some people called), where sequence names > 10 characters can be specified. If you run IQ-TREE again inputing the .varsites.phy file, it will be read correctly. So I would not say it as a bug, but rather a feature. The question: I want to retain ambiguous code DNA codes, however when I run: $ iqtree-omp -nt 4 -s ant.phy -st DNA -m MFP+ASC -bb 1000 -pre ant It fails. It looks like ASC cannot handle these at all. I'm running version 1.5.5. Is there some way I can keep both, or is this simply a nonsensical thing to ask of IQ-Tree? Have a look at this FAQ: http://www.iqtree.org/doc/Frequently-Asked-Questions#why-does-iq-tree-complain-about-the-use-of-asc-model In brief, it only makes to use ASC correction if your alignment does not contain *invariant* sites, which is a superset of constant sites. Cheers, Minh Many thanks, Cam You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, thanks for the speedy reply! If I have this example test.phy file: test123456ACCAAN test2 ACTCTA test3 ACTGTA test4 ACCCTA test5 TCCAAN test6 ACTCTN ... and I run $ iqtree-omp -nt 1 -s test.phy -st DNA -m GTR+ASC -pre testb I'll get this testb.varsites.phy file: 6 4 test123456 ACAA test2 ATCT test3 ATGT test4 ACCT test5 TCAA test6 ATCT But this not longer matches either the original PHYLIP format, or the Relaxed PHYLIP format mentioned here: http://www.phylo.org/index.php/help/relaxed_phylip Do you have another format of your own? Because this testb.varsites.phy now doesn't match either format. Cheers, Cam ", "I should have added that it may be more helpful to create an actual Relax PHYLIP file as the output, which would look like: 6 4 test123456 ACAA test2 ATCT test3 ATGT test4 ACCT test5 TCAA test6 ATCT It pains me that none of these formats use tabs rather than spaces, but I guess that's history for you? :) Thanks and sorry to spam you, Cam ", "Dear Cameron, A few thoughts about \u2018the\u2019 extended/relaxed PHYLIP formats. In the past you only had two PHYLIP alignment formats - the sequential (i.e. One sequence after the other - not used much anymore) and interleaved format (in blocks with one line per sequence and then the next block separated by one empty line). Of course the point all original PHYLIP formats have in common that they reserve (only) 10 letters for each sequence name. With the need for longer sequence name to include useful informations (e.g. sampling location and date in viruses), several softwares came up with different solutions. The easiest that was usable without changing existing formats was placing the aligned sequences into a FASTA format, because this allows for longer sequence names (although they are typically only used up to the first blank/empty space of the \u2018>\u2019-line. The disadvantage is that this looses the property of the interleaved PHYLIP format, that you have all sequences aligned such that you can look at the alignment columns directly in the file. Several developers then came up with solutions to extend the (interleaved) PHYLIP format for longer sequence names. Unfortunately, they are not necessarily identical, although several just call them extended (or here relaxed) PHYLIP format. Most formats I know, require to put *at least* one blank/empty space between the name and the sequence to have a delimiter. Until your post I was not aware that there are could be cases which require exactly one blank (the relaxed PHYLIP format described at CIPRES). There are several disadvantages of requiring exactly one blank: (a) The characteristic of being able to view the alignment directly in the file does not work for the first block (but that from my knowledge was the reason to introduce the \u2018interleaved\u2019 format - otherwise why not use FASTA instead). (b) In the original PHYLIP format you could place blanks (and digits) everywhere into the sequence (\u201cdigits and blanks will be ignored\u201d see the original PHYLIP definition at http://evolution.genetics.washington.edu/phylip/doc/sequence.html ), e.g. to split the sequence alignment every 10 characters or annotate sequence positions. Only you had to make sure the sequences were starting the earliest at the 11th character in the 1st block and no blanks were allowed within a sequence name. (c) Moreover, requiring exactly one character also breaks the backward compatibility to the original PHYLIP format and thus the possibility to use it in ALL other phylogenetic software that can read original PHYLIP format in the case that the sequence names are still <=10 letters in length. Everytime you have names <=10, but at least one name <10, the original PHYLIP format is broken and not usable for quite a number of programs. :( So, I think it is a good thing to stay a bit less restrictive (than the relaxed PHYLIP format) to maintain the backward compatibility and still allow digits and blanks (for formatting and annotation as allowed in the original PHYLIP format). Example 1: > If I have this example test.phy file: > 6 6 > test123456ACCAAN > test2 ACTCTA > test3 ACTGTA > test4 ACCCTA > test5 TCCAAN > test6 ACTCTN > ... and I run $ iqtree-omp -nt 1 -s test.phy -st DNA -m GTR+ASC -pre testb > I'll get this testb.varsites.phy file: Example 2: > 6 4 > test123456 ACAA > test2 ATCT > test3 ATGT > test4 ACCT > test5 TCAA > test6 ATCT > But this not longer matches either the original PHYLIP format, or the Relaxed PHYLIP format mentioned here: http://www.phylo.org/index.php/help/relaxed_phylip > Do you have another format of your own? Because this testb.varsites.phy now doesn't match either format. Sorry, but both examples exactly match the original PHYLIP format (see http://evolution.genetics.washington.edu/phylip/doc/sequence.html and above) and fit most extended PHYLIP format implementations I know, which typically still can read the original format. Hence, the empty space/blank is not at all a bug. It just does not follow the one very restrictive definition of a \u2018relaxed\u2019 PHYLIP format aa on the CIPRES. On the other hand it is congruent with a number of other \u2018extended\u2019 PHYLIP format definitions. Example 3: > 6 4 > test123456 ACAA > test2 ATCT > test3 ATGT > test4 ACCT > test5 TCAA > test6 ATCT This on the other hand cannot be correctly read by many softwares I know. Could you possibly state what programs actually have problems reading the first two formats? Are these programs which can read the \u2018relaxed\u2019 PHYLIP format still able to deal with blanks within the sequences? BTW the program RAxML, which is one of the programs running on the CIPRES and which produces a \u2018relaxed\u2019 PHYLIP file if it finds identical sequences (I just tried this), has no problem to read the example 2, which means if the \u2018relaxed\u2019 format definition originates from RAxML, then the CIPRES definition should be changed from \u201ca single blank space\u201d to \u201ca single blank space (or more)\u201d - or something similar. The RAxML manual does only mention spaces, but not \u201ca single\u201d. Interestingly, RAxML is not able to read example 1, although this is a valid PHYLIP file - IQ-Tree on the other hand is able to read these as well. In the case that the program in question can deal with blanks in the sequence (or if there are no blanks in the sequences), you can easily convert the output of IQ-Tree by running the content through, e.g., sed -e \u2019s/ */ /\u2018 < ALI1.phy > ALI2.phy This I think is preferable over changing to a format which is actually not compatible to the original PHYLIP format, even in the case of names <11 letters. Just my tuppence worth to elucidate some details on the PHYLIP formats ;) \u2026and thanks for starting the post. Best wishes, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Dear Heiko, Thanks for your in-depth reply! My thinking this was a bug came from when you take Example 2: 6 4 test123456 ACAA test2 ATCT test3 ATGT test4 ACCT test5 TCAA test6 ATCT And reprocess it with IQ-Tree, we get: 6 4 test123456 ACAA test2 ATCT test3 ATGT test4 ACCT test5 TCAA test6 ATCT Appeared to report that sequences were not the expected length. This was only happening because we were rerunning IQ-Tree multiple times after removing uninformed samples, and then using IQ-Tree to remove constant loci, prior to actually running to get a tree. I rewrote my script to all filtering prior to running IQ-Tree and of course I have no issue. If you are happy with the example .phy given above, with the extra space, then there's no bug. Thanks again for the quick and thoughtful replies, Cam ", "Dear Cam, Short answer: Both example alignments are correct w.r.t. extended PHYLIP format. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) "]}, "7FMEy1O__PU": {"topic": "My iqtree doesn't open", "initializeDate": "Nov 3, 2019, 6:02:06 PM", "timeStamp": "Nov 5, 2019, 1:44:10 PM", "content": ["One month ago that I run some analysis but now my progam doesn't open ", "I use the 1.6.12 version ", "Dear Andr\u00e9s Chaparro Garc\u00eda, Thank you for your interest in IQ-Tree. To help you, we definitely need more information to understand what happened, like: - What operation systems are you working on? - How did you start IQ-Tree? E.g. what was the command line you used? Or did you start with a double click? If the latter exactly which executable did you click on? - What error message did you get, if any? Or did a window open and close again immediately? - Maybe also, how and where did you install the software? Looking forward to hear from you with more infos. Best regards, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1cdf4537-f450-46f8-9e3a-1657b04f8e09%40googlegroups.com ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Thank you for read my problem. I work in partitioned analysis of phylogenetic data. But the problem is that when I double click iqtree.exe, it open the black window for 1 second and after it close automatically. I use the OS windows 10. This happens in the two computers that I use. Bot have windows 10. Regards To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/DB6A48F7-AAD2-4350-8778-6B715F81D564%40univie.ac.at ", "Dear Andr\u00e9s Chaparro Garc\u00eda, > On 4 Nov 2019, at 21:18, Andr\u00e9s Chaparro Garc\u00eda < andr...@ciencias.unam.mx > wrote: > Thank you for read my problem. I work in partitioned analysis of phylogenetic data. But the problem is that when I double click iqtree.exe, it open the black window for 1 second and after it close automatically. I use the OS windows 10. This happens in the two computers that I use. Bot have windows 10. In this case, this is not a crash. IQ-Tree is a command line program and is not intended to be started by double click. In the case of a click-start, the software is started without any parameters like the alignment file or any other options. Thus, the program writes an error message (mentioning the missing parameters) to the screen and exits. As the click-started executable is not running anymore, the window it was running in is closed automatically by the Windows OS - too quickly for you to read the message. This problem and how to use the command line under Windows is described in chapter 2.3 of the PDF manual. (For those people who refuse to work on the command line, there is one way to enter parameters manually one-by-one. However, this way is tedious and error-prone, so we do not recommend to use it. Instead we highly recommend to get used to the command line, because it allows a much more flexible way to run analyses, not just with IQ-Tree.) Best regards, Heiko > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAOFhNS%2B2-J5ZEq4N91iWb8rw%2BCQGNjvAmxiCBXk6UisRNzgpxw%40mail.gmail.com ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs Campus Vienna Biocenter 5 (VBC5) A-1030 Vienna, Austria ----------------------------------------------------------------------------- Email: heiko.schmidt(AT) univie.ac.at Tel. : ++43 +1 / 4277 - 74321 http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Thank you very much for your time. Best regards > > To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com > > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1cdf4537-f450-46f8-9e3a-1657b04f8e09%40googlegroups.com > ----------------------------------------------------------------------------- > Heiko Schmidt > Center for Integrative Bioinformatics Vienna (CIBIV) > University of Vienna / Max Perutz Labs http://www.cibiv.at/ > ----------------------------------------------------------------------------- > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/DB6A48F7-AAD2-4350-8778-6B715F81D564%40univie.ac.at > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "Us5TouS0EuM": {"topic": "New paper - Heterotachy models", "initializeDate": "Aug 16, 2017, 8:54:52 AM", "timeStamp": "Aug 16, 2017, 8:54:52 AM", "content": ["Hi everyone, We have recently submitted a paper explaining the heterotachy models that have been available in IQ-TREE for some time. It is available for you to read on biorXiv at the link below: S.M. Crotty, B.Q. Minh, N.G. Bean, B.R. Holland, J. Tuke, L.S. Jermiin and A. von Haeseler (2017) GHOST: Recovering historical signal from heterotachously-evolved sequence alignments. http://www.biorxiv.org/content/early/2017/08/10/174789.full.pdf+html Please cite this paper from now on if you use the heterotachy models in your analysis. Thanks, Stephen "]}, "7aBLeUraP7Q": {"topic": "IQTree crashes with \u201c-mset\u201d command", "initializeDate": "Feb 5, 2016, 12:11:55 PM", "timeStamp": "Feb 8, 2016, 4:30:33 PM", "content": ["I wish to run IQTree using the \u201c-mset\u201d command and a set of comma-separated models, ultimately so that I can test models not used in the routine TEST or TESTNEW commands (such as the protein mixture models). To begin with, I have tried to use a simple set of models, whose output likelihood values I already know for my input alignment. The program crashes each time. My command string is of the form: iqtree \u2013s <alignmentname> -m TESTONLY \u2013mset LG,LG+G4,LG+R7 \u2013nt 4 I get the following output: <Alignment loads properly> Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.166 seconds NOTE: MODEL SELECTION REQUIRES 36 MB MEMORY! Testing 24 protein models (sample size: 126) ... No. Model -LnL AIC AICc BIC 76102.618 799 153803.235 1432203.235 156069.424 LG+I 76102.616 800 153805.232 1435405.232 156074.257 LG+G4 73387.228 800 148374.455 1429974.455 150643.481 LG+I+G4 73387.230 801 148376.460 1433180.460 150648.322 LG+F 76141.220 818 153918.440 1493802.440 156238.518 LG+F+I 76141.217 819 153920.434 1497080.434 156243.349 LG+F+G4 73709.354 819 149056.709 1492216.709 151379.623 LG+F+I+G4 73709.349 820 149058.697 1495498.697 151384.449 LG+G4 73387.228 800 148374.455 1429974.455 150643.481 STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file:<alignmentname>.phy.log *** Alignment files (if possible) Do I have the command syntax correct, or must I change it somehow? I will send both the log file and the alignment file to a developer, if you wish, if you reply to this post ", "Dear David, I must admit that the manual was not clear. There are a few relevant options: 1. -mset specifies a candidate list of \u201cbase\" models, where each model will be automatically appended with different rate heterogeneity types. For example: iqtree -s <alignment> -m TEST -mset LG will consider 8 models: LG, LG+I, LG+G, LG+I+G, LG+F, LG+F+I, LG+F+G, LG+F+I+G 2. -madd specifies a list of models that are NOT appended like above. For example: iqtree -s <alignment> -m TEST -mset LG -madd LG+R7 will consider 9 models: 8 above models plus LG+R7 3. If you want to test exactly 3 models that you wrote, the following command will do the job: iqtree -s <alignment> -m TESTONLY -mset LG -mrate E,G,R7 -mfreq \u201c\u201d Here, -mrate specfies a list of rate heterogeneity (E stands for equal rate), which will overwrite the default. -mfreq with empty list like this will exclude \u201c+F\u201d. Combined together, it results in exactly 3 models LG, LG+G, LG+R7 to be considered. Hope that helps Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh: Thanks for your kind response. If I understand your comments correctly, if I had three \u201cnon-standard\u201d amino acid matrices to test (i.e. those not run routinely with the \u201cTEST\u201d or \u201cTESTNEW\u201d commands), I would need to run two commands successively for each matrix: iqtree \u2013s <alignment> -m TESTONLY \u2013mset X [this will produce the \u201cstandard\u201d set of rate heterogeneity options with matrix X] iqtree \u2013s <alignment> -m TESTONLY \u2013mset X \u2013mrate E,G,R1,R2,R3,R4,R5,R6,R7,R8,R9,R10 \u2013mfreq [this will test all the \u201cnon-standard\u201d rate heterogeneity options with matrix X, with \u201c+F\u201d excluded in each case] I wanted to test each of the following: C10,C20,C30,EX2,EX3,EHO,UL2,UL3,EX_EHO,LG4M,LG4X,CF4,LG+CF4+G,LG+C10,LG+C10+G I tried the following command strings, and got the following errors, before giving up: iqtree \u2013s <alignment> -m TESTONLY \u2013mset C10 -nt 4 Got error: \"invalid model name C10\" [(alignment loaded correctly before the program crashed)] iqtree \u2013s <alignment> -m TESTONLY \u2013mset C20 -nt 4 Got error: \"invalid model name C20\" [(alignment loaded correctly before the program crashed)] iqtree \u2013s <alignment> -m TESTONLY \u2013mset UL3 -nt 4 Got error: \"invalid model name UL3\" [(alignment loaded correctly before the program crashed)] iqtree \u2013s <alignment> -m TESTONLY \u2013mset C10 \u2013mrate E,G,R1,R2,R3,R4,R5,R6,R7,R8 \u2013mfreq -nt 4 [alignment did not load] Got error: \"Please specify the number of cores to use ( -nt option)!\" Is it necessary to use some different command syntax for the \u201cmixture\u201d models than that which you sent me in response to my first query? Thanks again, Dave ", "Dear David, On Feb 8, 2016, at 6:14 PM, David Kerk < davi...@yahoo.com > wrote: Hi Minh: Thanks for your kind response. you are welcome, that\u2019s the purpose of this mail group If I understand your comments correctly, if I had three \u201cnon-standard\u201d amino acid matrices to test (i.e. those not run routinely with the \u201cTEST\u201d or \u201cTESTNEW\u201d commands), I would need to run two commands successively for each matrix: iqtree \u2013s <alignment> -m TESTONLY \u2013mset X [this will produce the \u201cstandard\u201d set of rate heterogeneity options with matrix X] correct. Note that you can also do this: iqtree \u2013s <alignment> -m TESTONLY \u2013mset X,Y for two any matrices X and Y, which will test combination of X or Y with standard set of rate heterogeneity. iqtree \u2013s <alignment> -m TESTONLY \u2013mset X \u2013mrate E,G,R1,R2,R3,R4,R5,R6,R7,R8,R9,R10 \u2013mfreq [this will test all the \u201cnon-standard\u201d rate heterogeneity options with matrix X, with \u201c+F\u201d excluded in each case] correct, except two things. Change `-mfreq` to `-mfreq FU`. FU stands for amino-acid frequency taken from the current matrix X (pls disregard my previous answer about -mfreq \u201c\u201d). Second, remove R1 from the -mrate list. Model X+R1 is essentially equivalent for model X, thus is redundant. I wanted to test each of the following: C10,C20,C30,EX2,EX3,EHO,UL2,UL3,EX_EHO,LG4M,LG4X,CF4,LG+CF4+G,LG+C10,LG+C10+G First, note that LG+C10 and LG+C10+G are equivalent because C10 assumes +G already. Thus the last model in your list is redundant. Second, I assume you mean CF4 with POISSON+CF4. Third, unfortunately, testing all these models at once are right now NOT supported (mainly because there is no way to input the last 4 models in your list). Therefore you need to execute the following commands: iqtree \u2013s <alignment> -m TESTONLY \u2013mset LG -nt 4 -madd C10,C20,C30,EX2,EX3,EHO,UL2,UL3,EX_EHO,LG4M,LG4X iqtree \u2013s <alignment> -nt 4 -m POISSON+CF4 -te <alignment>.treefile -pre <alignment>.POISSON+CF4 iqtree \u2013s <alignment> -nt 4 -m LG+CF4+G -te <alignment>.treefile -pre <alignment>.LG+CF4+G iqtree \u2013s <alignment> -nt 4 -m LG+C10 -te <alignment>.treefile -pre <alignment>.LG+C10 Here, the last 3 commands will test corresponding model, given the same tree used by the first command. -pre is to specify different output file prefix, so that output files are not overwritten. Then please manually look at the BIC (or AIC) scores printed in .iqtree file of these 3 runs, and compare them with the table from the first run, to decide on the model with the best (smallest) score. Hope that this is understandable. I will think of smarter way to do all these within one single run... I tried the following command strings, and got the following errors, before giving up: iqtree \u2013s <alignment> -m TESTONLY \u2013mset C10 -nt 4 Got error: \"invalid model name C10\" [(alignment loaded correctly before the program crashed)] because -mset does not accept mixture models\u2026 use my above commands. btw the program did not crash, it just printed an error and exited ;-) iqtree \u2013s <alignment> -m TESTONLY \u2013mset C20 -nt 4 Got error: \"invalid model name C20\" [(alignment loaded correctly before the program crashed)] iqtree \u2013s <alignment> -m TESTONLY \u2013mset UL3 -nt 4 Got error: \"invalid model name UL3\" [(alignment loaded correctly before the program crashed)] same! iqtree \u2013s <alignment> -m TESTONLY \u2013mset C10 \u2013mrate E,G,R1,R2,R3,R4,R5,R6,R7,R8 \u2013mfreq -nt 4 [alignment did not load] Got error: \"Please specify the number of cores to use ( -nt option)!\u201d because `-mfreq` like this is invalid. Use, for example, `-mfreq FU` (see above again) Cheers, Minh Is it necessary to use some different command syntax for the \u201cmixture\u201d models than that which you sent me in response to my first query? Thanks again, Dave "]}, "csu5G7-S3O4": {"topic": "Using IQ-Tree best fit model in mrBayes", "initializeDate": "Nov 30, 2015, 2:11:38 PM", "timeStamp": "Dec 1, 2015, 9:42:54 AM", "content": ["Dear Minh, Sorry about brothering you repeatedly with requesting your kind help. Could you please check out and correct my preliminary mrBayes revmat parameter settings? I am not sure about placing values of 1.0000 into the correct position or not. IQ-Tree best fit models: Cox:TIM2{4.39273,5.30843,12.1337} Nadh:TN{2.79622,5.41572} Btub:TIM{3.13,0.781515,10.5962} My preliminary revmat parameter settings for mrBayes: Cox: revmat=fixed(1.00000, 4.39273, 1.00000, 5.30843, 12.1337, 5.30843) Nadh: revmat=fixed(1.0000, 2.79622, 1.00000, 1.00000, 5.41572, 1.0000) Btub: revmat=fixed(1.0000, 3.13, 0.781515, 0.781515, 10.5962, 1.0000) Thank to you for your help, indeed. J\u00f3zsef ", "Dear Jozsef, this is a good question and I updated the user manual to answer your question: http://www.cibiv.at/software/iqtree/doc/Substitution-Models/#dna-models In principle you have to look at the 6-digit code and convert to GTR parameters. For your specific question, I don\u2019t know which order MrBayes specifies the substitution rates. But the corresponding GTR rates are: Cox:TIM2{4.39273,5.30843,12.1337} A-C: 4.3927 A-G: 5.3084 A-T: 4.3927 C-G: 1.0000 C-T: 12.1337 G-T: 1.0000 Nadh:TN{2.79622,5.41572} A-C: 1.0000 A-G: 2.7962 A-T: 1.0000 C-G: 1.0000 C-T: 5.4157 G-T: 1.0000 Btub:TIM{3.13,0.781515,10.5962} A-C: 1.0000 A-G: 3.1300 A-T: 0.7815 C-G: 0.7815 C-T: 10.5962 G-T: 1.0000 you can also run iqtree -s example.phy -m \"TIM{3.13,0.781515,10.5962}\" -n 0 and then look at .iqtree file to get this. Hope that helps Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, That helped! Thank you. NB: As I see, the order of substitution rates in MrBayes is the usual standard. Cheers, J\u00f3zsef "]}, "8hRrn8RkexA": {"topic": "-rcluster-max requires number? (no default value?)", "initializeDate": "Nov 16, 2018, 8:59:21 AM", "timeStamp": "Nov 19, 2018, 5:24:45 AM", "content": ["Hi! I was running iqtree-1.6. via iqtree s inputfile fas spp partitioningscheme txt m MFP MERGE alrt 1000 1000 bnni pre tree_out rcluster max and I received error Use -rcluster-max <num> From the manual ( http://www.iqtree.org/doc/Command-Reference#automatic-model-selection ) I was expecting that if no number is provided, -rcluster-max will be set to the default value. Thanks in advance for advice! Ales ", "Hi Ales, -rcluster-max expects a number. With the default, we meant that when you do \u201c-rcluster 5\u201d, for example, then IQ-Tree will consider the smaller of 5% of partition pairs or 10*#partitions. Does that explain? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "Jd_oc0pOnA8": {"topic": "IQTree edge unlinked error: Range 1-1482\\3 length is not multiple of 3", "initializeDate": "Feb 21, 2020, 11:01:09 AM", "timeStamp": "Feb 23, 2020, 10:37:26 PM", "content": ["Hello Experts, I was using IQTree in CIPRES using partition file, but it shows following error. I could not understand 1482 is divided by 3. So why it is showing this error! It would be an immense help if someone kindly help to understand this. ERROR: Range 1-1482\\3 length is not multiple of 3 (necessary for codon data) srun: error: comet-26-18: task 0: Exited with exit code 2 I have attached both partition file and sequence file. Thanks, Debajyoti ", "Dear Debajyoti, 1482 is a multiple of 3, but the length of that subset is 1482-1 = 1481, which is not a multiple of 3. That's my guess at what is happening. Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1636f1ec-a429-43f0-8a80-ee5c10167dbb%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Hi there, The partition file looks good for DNA models. But the message is for codon models, so perhaps you used -st CODON or --modelomatic option to test codon models? Then the range 1-1482\\3 has 494 sites, which is not divisible by 3, to be converted to codon alignments. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmrAk%3DL-5PXQn0PYOwk%3D7b%2BDp3BDxXx3WzR%2Br%3DGv3XAHgA%40mail.gmail.com "]}, "I_7tbxEjHEI": {"topic": "Visualising Bootstrap values", "initializeDate": "Feb 19, 2020, 2:58:13 PM", "timeStamp": "Feb 19, 2020, 3:23:38 PM", "content": ["Hi, I would like to know how I can show bootstrap values generated by iq-tree in percentage in my final tree output, e.g if visualizing with fig tree ? Its quite basic, but your assistance will be much appreciated ", "Dear Saad Sarfraz, This is quite simple. When loading the tree file with support values, Figtree asks about what type of value that is. I typically change this to something describing that type like ufboot or sbs (for standard bootstrap). Then in the column on the left in Figtree, you tick the box at branch labels to add displaying additional information at the branches. Then you open that menu clicking on the triangle and choose what to display. Here you choose the entry with the name you have given when asked for when loading the tree file. One ist also able to display these boostrap/ufboot values at the nodes, in which case they refer to the branch towards the root from that node. However, since the support values are defined for the branches (even though some people talk about node support, which would be something different), it is definitely preferable to display them at the branches. I hope that answers your question. Best regards, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Hi Heiko, It worked like a charm, Thanks alot for your comprehensive response. Bundle of thanks You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/92169760-D7F7-46B3-B080-F363B9EF00F5%40univie.ac.at "]}, "tz1zbOFy6uk": {"topic": "Generation of TreeList file for Tree Topology Tests?", "initializeDate": "Feb 22, 2017, 4:44:04 PM", "timeStamp": "Feb 22, 2017, 5:06:42 PM", "content": ["I am trying for the first time to do tree topology tests in IQTree. I have read the Tutorial materials, and they give the command syntax as follows: iqtree -s myalignment.phy -z myalignment.treels -n 1 -zb 1000 -zw \u2013au I have tried this with my own alignment, and it produced an error because it could not find the treelist (\u201c.treels\u201d) file. Apparently this file is not automatically generated by a run, but must be created by some other command syntax. Can anyone advise me what this command syntax is? ", "Dear David, the treels-file contains the tree topologies *you* want to test to see whether one or more tree generate significantly worse likelihood values than others. Hence, the software cannot generate this file because there is no way for the software to know or to guess what evolutionary hypotheses (trees) you want to assess. For more background information on tree topology testing and the assumptions involved you may want to refer to the chapter \u201cTree Topology Testing\u201d in \u201cThe Phylogenetic Handbook\u201d by Lemey et al. (2009). I hope I could help. Best wishes, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout "]}, "gww7aAFqkxM": {"topic": "Crash with Tree topology test using webserver", "initializeDate": "Jul 17, 2018, 2:48:56 AM", "timeStamp": "Aug 21, 2018, 5:59:05 PM", "content": ["Hy, I am using the tree topology test option in the IQ tree website in order to define the best tree topology amongst 10 trees but I always have this kind of error in the \"run logg\" winodw : Reading trees in PhyML_trees_topology.nwk ... 10 trees detected Note: 2.829 MB of RAM required! Creating 10000 bootstrap replicates... done Tree 1 / LogL: -1055.533 Tree 2 / LogL: -984.738 Tree 3 / LogL: -1109.133 Tree 4 / LogL: -944.768 Tree 5 / LogL: -948.212 Tree 6 / LogL: -946.338 Tree 7 / LogL: -1055.532 Tree 8 / LogL: -939.406 Tree 9 / LogL: -942.253 Tree 10 / LogL: -942.253 Performing RELL-BP test... Performing KH and SH test... Computing pairwise logl difference variance ... Performing WKH and WSH test... Performing ELW test... Performing approximately unbiased (AU) test... 7 MB required for AU test terminate called after throwing an instance of 'std::string' Generating 10 x 10000 multiscale bootstrap replicates... ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 5 __gnu_cxx::__verbose_terminate_handler() ERROR: 6 () ERROR: 7 () ERROR: 8 () ERROR: 9 convert_int_vec(char const*, std::vector >&) ERROR: 10 Alignment::createBootstrapAlignment(int*, char const*, int*) ERROR: 11 performAUTest(Params&, PhyloTree*, double*, std::vector >&) ERROR: 12 evaluateTrees(Params&, IQTree*, std::vector >&, std::vector ERROR: 13 reportPhyloAnalysis(Params&, IQTree&, ModelCheckpoint&) ERROR: 14 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 15 main() ERROR: 16 __libc_start_main() ERROR ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: Aln_0568_20souches_SouchesRef_357pb.log ERROR: *** Alignment files (if possible) What should I change ? The file format of my alignement and tree topology ? Should I download IQ tree on my computer ? Someone will have an idea in order to help me ? Thanks a lot ! Best Chlo\u00e9 ", "Hi Chloe, Please see a previous thread where we discussed this problem. Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi, Could you please link the previous thread as I can't seem to find it and I have the same error. Thanks David ", "Hi Chloe, Did you find a solution to this problem as I am have the same issue? Regards David ", "Hi David and Chloe, Here is the thread explaining it: https://groups.google.com/forum/#!topic/iqtree/Dw4rl-SYxqY Cheers, Minh "]}, "91oUreKkPf4": {"topic": "What is considered a large data set?", "initializeDate": "Oct 9, 2020, 12:27:42 AM", "timeStamp": "Oct 10, 2020, 7:24:16 PM", "content": ["Hello. I learned that if I have large datasets I have to performed multiple runs (-nrun). In previous mails, I have read that a dataset is considered large when the number of sequences is >500. This number would be 500 sequences included in a single partition? In other words, if I have a database that comprise 100 individuals and nine loci (or 9 partitions), should I perform multiple runs? Thank you Best regards ", "Hi Elsa, On 9 Oct 2020, at 3:27 pm, Elsa < folga...@gmail.com > wrote: Hello. I learned that if I have large datasets I have to performed multiple runs (-nrun). In previous mails, I have read that a dataset is considered large when the number of sequences is >500. This number would be 500 sequences included in a single partition? Yes. And actually an alignment with just one partition is rather short, and tree search is getting more difficult with increasing number of sequences. So defintely do multiple runs in this case. In other words, if I have a database that comprise 100 individuals and nine loci (or 9 partitions), should I perform multiple runs? Yes, please. It\u2019s better to be on the safe side. Your dataset is rather quick to run, and comparing the runs will indiciate how well the tree search converged. Cheers Minh Thank you Best regards You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/09d34187-35bc-4699-a5e4-026aa37f0edeo%40googlegroups.com "]}, "XxQswTu4b6k": {"topic": "Re: [iqtree] partition specific rates - evol. rates", "initializeDate": "Mar 1, 2021, 9:20:53 PM", "timeStamp": "Mar 1, 2021, 9:20:53 PM", "content": ["Hi Karen, Yes they are exactly the same, might look different due to rounding. Minh On 28 Feb 2021, at 12:11 am, 'kmeus...@ googlemail.com ' via IQ-TREE < iqt...@googlegroups.com > wrote: Dear all, just a quick question (using v.1.6.12) the difference between the \"partition specific rates\" in the *.log file and the \"speed\" in the *.iqtree file is the same correct (only differes according to rounding the numers) ? or I I would like to resport the \"evolut. rates\" should I stick to the \"speed\" value - and below is still valid? (from a post 3 years ago: \"Speed column is exactly as you asked: it is the partition specific rate. They are computed by maximum likelihood. The rates are normalized such that the weighted average is 1, where the weights are the partition alignment length divided by supermatrix length\") best Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/bc434479-b0a1-448e-82b7-d1738ba10baan%40googlegroups.com "]}, "MbKJd_cRJsI": {"topic": "Re: IQ-tree Crashing", "initializeDate": "Oct 7, 2019, 6:46:04 PM", "timeStamp": "Oct 7, 2019, 7:19:39 PM", "content": ["Hi Felipe, Thanks for report the bug. Since your data set is very large, making it hard to debug, can you please help me do the following: randomly sub-sample 10% of the partitions, and re-run the analysis. Do this up to 10 times until the crash happen again, and send me the details. If not, then I\u2019ll look at your original data set. Normally I would do this by myself, but given the current workload, it\u2019d be great that you can do this. Cheers, Minh On 8 Oct 2019, at 6:20 am, Felipe Freitas < felipevie...@gmail.com > wrote: Hi Minh, I am sorry for disturbing you again. I am having a problem using IQ-TREE to analyze one of my matrices. To build this matrix, I used SWSC-EN from Tagliacollo e Lanfear to partitioned my UCE data and after that, I used PartitionFinder to find the best partitioning scheme. It crashed many times and my analyzes never finish. I am sending the alignment, the partitioning file and the log file, you will see that this log is from my last analyzes when I used the file with the models from a previous run that crashed after the execution of ModelFinder. I hope you can help me to find a solution. Best, Felipe. Felipe Vieira de Freitas Mestre em Zoologia - Doutorando em Entomologia Master in Zoology - Doctorate degree candidate in Entomology Laborat\u00f3rio de Biologia Comparada e Abelhas Faculdade de Filosofia Ci\u00eancias e Letras de Ribeir\u00e3o Preto Universidade de S\u00e3o Paulo Bi\u00f3logo CRBio: 080856/04-D ", "Hi Felipe, Before doing this can you please check out this new beta version: https://github.com/Cibiv/IQ-TREE/releases/tag/v1.7-beta17 This reason is, Rob reported the same crash message, which I then fixed. So this bug might have been already fixed. But can you confirm it? Thanks Minh On 8 Oct 2019, at 10:06 am, Felipe Freitas < felipevie...@gmail.com > wrote: Thanks for answering, Minh! I will try to do that as soon as possible and I let you know about the results. Best, Felipe. "]}, "SgHY79Fp9kg": {"topic": "MPI running error", "initializeDate": "Jul 8, 2020, 12:05:41 PM", "timeStamp": "Jul 8, 2020, 8:00:59 PM", "content": ["Hi, When running IQ-TREE-mpi on >20,000 sequences I get the following error Q-TREE MPI multicore version 2.0.6 for Linux 64-bit built Jun 29 2020 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: compute-a-16-71 (AVX2, FMA3, 251 GB RAM) Command: ./iqtree2-mpi -m HKY+G -nt AUTO -s Subsampled_filtered.fasta Seed: 42361 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Jul 8 08:18:07 2020 Kernel: AVX+FMA - auto-detect threads (1 CPU cores detected) MPI: 64 processes Create initial parsimony tree by phylogenetic likelihood library (PLL)... 1486.960 seconds NOTE: 51645 MB RAM (50 GB) is required! NOTE: 2 processes are running on the same host compute-a-16-71. Measuring multi-threading efficiency up to 0 CPU cores ERROR: phylotree.cpp:829: size_t PhyloTree::getBufferPartialLhSize(): Assertion `num_threads > 0' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 7 PhyloTree::initializeAllPartialLh() ERROR: 8 PhyloTree::readTreeString(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) ERROR: 9 PhyloTree::testNumThreads() ERROR: 10 runTreeReconstruction(Params&, IQTree*&) ERROR: 11 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 12 main() ERROR: 13 __libc_start_main() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: Subsampled_filtered.fasta.log ERROR: *** Alignment files (if possible) Can anyone provide any assistance with this? Many thanks, Damien ", "Hi Damien, Can you please avoid -nt AUTO and explitcity provide the number of threads, e.g. -nt 2. Actually I don\u2019t know how to detect the number of threads for an MPI run. Each process might run on different computers, which have different CPU configurations (e.g. different number of cores). But right now, IQ-TREE only works in the case that all MPI processes should have the same number of threads. So -nt AUTO option does not work here, IQ-TREE should have printed an error message about that, instead of this crash. Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/853867d7-b7e5-402a-8660-003252cac417o%40googlegroups.com "]}, "imvtHfz_F14": {"topic": "question about +CF4 mixture", "initializeDate": "Jun 27, 2016, 3:16:32 PM", "timeStamp": "Jun 28, 2016, 4:14:37 PM", "content": ["I was wondering about the details of the implementation of the CF4 mixture for proteins. As I understand, it it has the four fixed mixture components from the Wang et al. 2008 paper and then the fifth component is the empirical frequencies. Then the weights of each mixture component are estimated by ML. Is that correct? The question I have is this -- is there is any way to optimize the first mixture component by ML rather than using empirical frequencies? i.e., if we look at the models block you have in the documentation page (copied below) could the last line be something like the following? frequency CF4model = FMIX{ml,Fclass1,Fclass2,Fclass3,Fclass4}; (I'm not sure if \"ml\" would be correct in this context, but basically the ML estimates of the 19 free aa frequency components) #nexus begin models; frequency Fclass1 = 0.02549352 0.01296012 0.005545202 0.006005566 0.01002193 0.01112289 0.008811948 0.001796161 0.004312188 0.2108274 0.2730413 0.01335451 0.07862202 0.03859909 0.005058205 0.008209453 0.03210019 0.002668138 0.01379098 0.2376598; frequency Fclass2 = 0.09596966 0.008786096 0.02805857 0.01880183 0.005026264 0.006454635 0.01582725 0.7215719 0.003379354 0.002257725 0.003013483 0.01343441 0.001511657 0.002107865 0.006751404 0.04798539 0.01141559 0.000523736 0.002188483 0.004934972; frequency Fclass3 = 0.01726065 0.005467988 0.01092937 0.3627871 0.001046402 0.01984758 0.5149206 0.004145081 0.002563289 0.002955213 0.005286931 0.01558693 0.002693098 0.002075771 0.003006167 0.01263069 0.01082144 0.000253451 0.001144787 0.004573568; frequency Fclass4 = 0.1263139 0.09564027 0.07050061 0.03316681 0.02095119 0.05473468 0.02790523 0.009007538 0.03441334 0.005855319 0.008061884 0.1078084 0.009019514 0.05018693 0.07948 0.09447839 0.09258897 0.01390669 0.05367769 0.01230413; frequency CF4model = FMIX{empirical,Fclass1,Fclass2,Fclass3,Fclass4}; end; ", "Dear Edward, On Jun 27, 2016, at 9:16 PM, Edward Braun < ebra...@gmail.com > wrote: I was wondering about the details of the implementation of the CF4 mixture for proteins. As I understand, it it has the four fixed mixture components from the Wang et al. 2008 paper and then the fifth component is the empirical frequencies. Then the weights of each mixture component are estimated by ML. Is that correct? that\u2019s correct. The question I have is this -- is there is any way to optimize the first mixture component by ML rather than using empirical frequencies? i.e., if we look at the models block you have in the documentation page (copied below) could the last line be something like the following? frequency CF4model = FMIX{ml,Fclass1,Fclass2,Fclass3,Fclass4}; (I'm not sure if \"ml\" would be correct in this context, but basically the ML estimates of the 19 free aa frequency components) no this is possible. This is because when having implemented this model, I think that would be too many parameters to estimate. Moreover, I think the ML frequencies will converge to the empirical frequencies anyway if you have enough data. If you, however, point out an evidence that adding this ML-frequency class is beneficial, I am happy to reconsider this. Cheers, Minh #nexus begin models; frequency Fclass1 = 0.02549352 0.01296012 0.005545202 0.006005566 0.01002193 0.01112289 0.008811948 0.001796161 0.004312188 0.2108274 0.2730413 0.01335451 0.07862202 0.03859909 0.005058205 0.008209453 0.03210019 0.002668138 0.01379098 0.2376598; frequency Fclass2 = 0.09596966 0.008786096 0.02805857 0.01880183 0.005026264 0.006454635 0.01582725 0.7215719 0.003379354 0.002257725 0.003013483 0.01343441 0.001511657 0.002107865 0.006751404 0.04798539 0.01141559 0.000523736 0.002188483 0.004934972; frequency Fclass3 = 0.01726065 0.005467988 0.01092937 0.3627871 0.001046402 0.01984758 0.5149206 0.004145081 0.002563289 0.002955213 0.005286931 0.01558693 0.002693098 0.002075771 0.003006167 0.01263069 0.01082144 0.000253451 0.001144787 0.004573568; frequency Fclass4 = 0.1263139 0.09564027 0.07050061 0.03316681 0.02095119 0.05473468 0.02790523 0.009007538 0.03441334 0.005855319 0.008061884 0.1078084 0.009019514 0.05018693 0.07948 0.09447839 0.09258897 0.01390669 0.05367769 0.01230413; frequency CF4model = FMIX{empirical,Fclass1,Fclass2,Fclass3,Fclass4}; end; You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thanks Minh! I'm not sure of the desirability of fitting all 19 aa frequencies on top of the weights either but I had noticed with one dataset that optimizing a single set of aa frequencies (i.e., by matrix+FO+G4) gave a better likelihood than matrix+CF4+G4. However, this was with a custom matrix I'm playing with (not LG or WAG etc) and it only manifested itself with one dataset. But I wanted to track down whether I was doing anything trivially wrong before I put too much thought into examining the issue further. I appreciate the feedback. If I see this issue manifesting itself more I'll share data with you Best, ", "Hi Edward, now I understand why you asked. For sanity check you can do the following instead. from your matrix+FO+G4 run, extract the estimated AA frequencies and put them into the fifth class in a partition model file, say: #nexus begin models; frequency Fml=\u2026.; frequency yourCF4=FMIX{Fclass1,Fclass2,Fclass3,Fclass4,Fml} end; then compute the likelihood of matrix+yourCF4+G4. This model must have a likelihood at least as high as matrix+FO+G4. Otherwise, something went wrong. And pls note that, the fact that matrix+FO+G4 may give higher likelihood than matrix+CF4+G4 is not unexpected. The former model is in fact more parameter-rich than the latter model. Moreover, CF4 has fixed frequencies pre-estimated from elsewhere, which may not fit well to your data. Minh "]}, "f2_t8jYXON4": {"topic": "Dating with branch length from codon models", "initializeDate": "Jun 22, 2020, 1:48:10 AM", "timeStamp": "Jun 23, 2020, 3:30:31 PM", "content": ["Maybe this is a naive question, but I want to date a tree that I created using codon models (values branch length are suppouse to be 3X). Should I (1) calibrate the tree as per the tutorial ( http://www.iqtree.org/doc/Dating ) and then divide the dates of the nodes 1/3X, except for the calibrated node? or (2) calibrate the tree using 1/3X times the divergence of the node as input and then consider the values of the output as the real divergence times? Thanks for your help ", "Hi G, Hien may correct me if I\u2019m wrong. From my understanding, If all the branch lengths are 3 times longer, the date estimates will stay the same. Only the rate estimate will increase by 3 times. So no need to adjust divergence times. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/69db2bb1-5da4-4e68-8819-3c1e2259a6a2o%40googlegroups.com ", "Hi, Yes you're right. If all of your branch lengths are 3 times longer, and your calibrated dates remain the same, then the rate will be 3 times faster and the estimated dates will stay the same. Hien On Tuesday, June 23, 2020 at 4:58:20 AM UTC+2, Minh Bui wrote: Hi G, Hien may correct me if I\u2019m wrong. From my understanding, If all the branch lengths are 3 times longer, the date estimates will stay the same. Only the rate estimate will increase by 3 times. So no need to adjust divergence times. Cheers Minh On 22 Jun 2020, at 3:48 pm, gusta10 < gus.sa...@gmail.com > wrote: Maybe this is a naive question, but I want to date a tree that I created using codon models (values branch length are suppouse to be 3X). Should I (1) calibrate the tree as per the tutorial ( http://www.iqtree.org/doc/Dating ) and then divide the dates of the nodes 1/3X, except for the calibrated node? or (2) calibrate the tree using 1/3X times the divergence of the node as input and then consider the values of the output as the real divergence times? Thanks for your help You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "2PQhJ92CROM": {"topic": "Why is IQ-Tree ignoring terminals with only morphological data in my total evidence analysis?", "initializeDate": "Nov 4, 2018, 2:55:47 PM", "timeStamp": "Nov 4, 2018, 8:46:20 PM", "content": ["Hello! GENERAL OBJECTIVES I want to access topological sensitivity to the addition of morphological characters under a total evidence analysis. OVERVIEW OF MY DATASET Morphological (185 characters) and nucleotide (13,686 characters) data for 338 terminals. Both matrices contain the exact same terminals. The partition scheme, including the models I selected, is attached here (partitions.nex). HOW I EXECUTED IQ-TREE I ran 10 replicates on IQ-Tree, folowwed by a final replicate in which I read all the tree files produced before. iqtree \\ -spp partitions.nex \\ -nt AUTO \\ -t totev_10reps.treefile \\ -pre totev_final \\ -cptime 30 \\ -pers 0.2 \\ -nstop 500 VERSION OF IQ-TREE IQ-TREE multicore version 1.6.1 for Linux 64-bit built Dec 26 2017. #36~14.04.1-Ubuntu SMP Fri Feb 26 18:49:23 UTC 2016. PROBLEM Output trees for all replicates have all but two terminals, named t119 and t40. Those are the only two terminals for which I have morphological data but no DNA data (i.e., they are included in the molecular dataset but their alignment contain only missing data). Standart error and standart output make no mentions to theses terminals except in the table of Gap/ Ambiguity (100% for both), Composition (both passed) and p-value (-nan% for both). See totev_final.log attached here. FINAL REMARKS Does anyone know why is IQ-Tree ignoring the terminals which have only morphological data? Is there any way to make IQ-Tree do not ignore these terminals? Thank you very much for your time and attention. Best regards, Denis Jacob Machado ", "Hi Denis, Thanks for the detailed description. The quick answer is because of semi-colon (instead of comma) in charpartition command: TRN+I: ncx1_1c; K81+G: Rag_1b; Semi-colon means the end of charpartition and IQ-Tree stops loading partitions there. You can see from this part of the log file: Subset Type Seqs Sites Infor Invar Model Name 1 DNA 21 850 76 705 GTR+I+G 28S_1 2 DNA 336 3308 2013 922 GTR+I+G h1_1 15 5 425 4 417 TRN+I ncx1_1c Since this same issue was reported a few weeks ago, we\u2019ll change the code to do better error-checking. Also please update the latest version 1.6.8. It fixes a number of issues (incl. crash when mixing data like this). Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <partitions.nex> <totev_final.log> ", "Dear Dr. Minh Bui, Thank you for the explanation, I was having difficulties finding this error by myself. Best wishes, Denis Jacob Machado "]}, "4DechVCtLz8": {"topic": "error message after tree construction and asr analysis with codon models (\"ERROR: File not found MG\")", "initializeDate": "Jun 11, 2020, 3:17:21 AM", "timeStamp": "Jun 12, 2020, 5:56:12 PM", "content": ["Hi, I had trouble when launching a tree construction and an asr analysis with providing codon models (MG+F1X4+R7 and MG+F3X4+R6). With both of the two types of jobs, I received the same error message (see below). I am wondering if that IQtree interprets the \"-m\" option as an input file name, and that seems quite weird to me. Job1: Command_job1 (tree_construction): iqtree -s alignement_file -m MG+F1X4+R7 -alrt 1000 -b 100 -redo -nt 8 ERROR: File not found MG Job2: Command_job2 (ASR): iqtree -s alignement_file -m MG+F1X4+R7 -te tree_file -asr ERROR: File not found MG Does someone encounter the same problem? How can I perform my jobs with these codon models (MG+F1X4+R7 and MG+F3X4+R6)? Best regards, Gabriel ", "Hi Gabriel, Simple answer: you forgot to set the sequence type as codon: -st CODON (for standard genetic code; for changing the genetic code see the docs). Due to this, IQ-TREE assumes you are using a DNA model. Because MG is not in the list of pre-defined DNA models, it assumes that MG is a file name containing a custom model. That\u2019s why it\u2019s trying to read that file, that obviously does not exist. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d5551f62-541b-4587-b016-28e4293fc90do%40googlegroups.com "]}, "1bUowqMY_BM": {"topic": "Killed: 9 message ?", "initializeDate": "Sep 8, 2018, 1:12:07 AM", "timeStamp": "Sep 11, 2018, 9:15:18 AM", "content": ["Hi Minh again... What does Killed: 9 means, and what can I do ? with iqtree-1.6.7-MacOSX/bin/iqtree -s RPROTS/Concat_rprot_JPF.faa -MFP -mset LG -madd LG+C10,LG+C20,LG+C30,LG+C40,LG+C50,LG+C60 -bb 1000 -wbt -wsr -nt AUTO all goes well until : \" Model LG+C40 is alias for LG+POISSON+G+FMIX{C40pi1:1:0.0223853788,C40pi2:1:0.0338891820,C40pi3:1:0.0577169375,C40pi4:1:0.0252416233,C40pi5:1:0.0108607921,C40pi6:1:0.0462373793,C40pi7:1:0.0102293175,C40pi8:1:0.0147523625,C40pi9:1:0.0143161352,C40pi10:1:0.0182302541,C40pi11:1:0.0204025079,C40pi12:1:0.0425505156,C40pi13:1:0.0248627269,C40pi14:1:0.0105892988,C40pi15:1:0.0188238725,C40pi16:1:0.0086663445,C40pi17:1:0.0148496147,C40pi18:1:0.0343037402,C40pi19:1:0.0225335203,C40pi20:1:0.0174068578,C40pi21:1:0.0112207827,C40pi22:1:0.0443532245,C40pi23:1:0.0392573370,C40pi24:1:0.0196756555,C40pi25:1:0.0287690328,C40pi26:1:0.0114441177,C40pi27:1:0.0112338740,C40pi28:1:0.0582694099,C40pi29:1:0.0444272279,C40pi30:1:0.0112010942,C40pi31:1:0.0145176111,C40pi32:1:0.0114629026,C40pi33:1:0.0239628061,C40pi34:1:0.0266266492,C40pi35:1:0.0481201159,C40pi36:1:0.0371147423,C40pi37:1:0.0160476688,C40pi38:1:0.0237249267,C40pi39:1:0.0235226203,C40pi40:1:0.0261998398} Killed: 9 \" The data : 414698 positions for 50 sequences Thanks for Help JP Flandrois LBBE-UMR5558 Lyon, France ", "Hi JP, As far as I know (but not 100% sure), signal 9 means that IQ-TREE was externally killed. It could be due to time or memory excess that operating system decided to stop it. In this case, I tend to think about memory limit, because it suddenly stopped when going from C30 to C40. Here, C40 needs 40 times more RAM than a standard model, whereas C30 still fits the RAM\u2026 Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi again, Quick recommendation: Use -mem option to reduce RAM requirement. You can do -mem 200G for example. You can also specify -mem 0.5, which reduce RAM by half without much sacrifice in speed (~10% slowdown in my observation). Long explanation: you can use the following rough formula to get the full RAM requirement in bytes: patterns * sequences * rate_categories * states * mixture_classes * 8 Where patterns = number of distinct site patterns (printed in log file) sequences = number of sequences (50 your case) rate_categories = number of Gamma rate categories (4 in your case) states = number of states (20 for amino-acid) mixture_classes = number of mixture classes (40 in your case) Let\u2019s assume patterns = roughly number of positions, then it is 414698*50*4*20*40*8 which is about 506 GB. Hope that helps, Minh ", "Thanks Minh ! I was guessing that \"Killed :9\" means an Hardware limitation, but this has to be confirmed. May be a more explicit sentence will be possible in a further version. Of course this \"Killed :9\" is due to the 64 GO memory computer I was using. Even if this remains possible on a 1TB memory machine here, I will wait to discuss of the need to test the whole set of models with my colleagues. Cheers "]}, "g-YqDKnbeWs": {"topic": "ancestral sequence reconstruction, confirmation about the command line to use and question", "initializeDate": "May 27, 2020, 9:58:23 AM", "timeStamp": "May 27, 2020, 7:57:32 PM", "content": ["Hi everyone, I would like to estimate the ancestral sequence of each internal node of my phylogenetic tree. I'd like to be sure about the command line to use. I am working with iqtree-2.0.4, an alignment file (aln.fasta) and the resulting tree (tree.txt) that I've constructed from the previous alignment (with the best-estimated substitution model, AIC score). Here below is the command line that I think to use to estimate the ancestral sequence for each internal node: > iqtree -s aln.fasta -te tree.txt -asr In this case, as the phylogenetic tree has already been constructed, it is not necessary to provide the model to use with the [-m] option. Is that correct? Moreover, I have a question about the algorithm used in this analysis. Is the empirical Bayesian method less precise or more biased than the standard Bayesian approach? Or, would the answer to that previous question depend on my data set (alignment, the biological assumptions)? Best regards, Gabriel ", "Hi Gabriel, On 27 May 2020, at 11:58 pm, Gabriel DUPRE < gabriel...@gmail.com > wrote: Hi everyone, I would like to estimate the ancestral sequence of each internal node of my phylogenetic tree. I'd like to be sure about the command line to use. I am working with iqtree-2.0.4, an alignment file (aln.fasta) and the resulting tree (tree.txt) that I've constructed from the previous alignment (with the best-estimated substitution model, AIC score). Here below is the command line that I think to use to estimate the ancestral sequence for each internal node: > iqtree -s aln.fasta -te tree.txt -asr The command line is correct. In this case, as the phylogenetic tree has already been constructed, it is not necessary to provide the model to use with the [-m] option. Is that correct? Yes, correct. But here ModelFinder will be invoked to find the model again. So it\u2019s better (faster) to provide a model if you already had it from a previous run. Moreover, I have a question about the algorithm used in this analysis. Is the empirical Bayesian method less precise or more biased than the standard Bayesian approach? Or, would the answer to that previous question depend on my data set (alignment, the biological assumptions)? The empirical Bayesian method for this has been used for years, with the first paper from Ziheng Yang in the 90s. Whether or not it\u2019s more or less \u201cprecise\u201d, I can\u2019t answer. But it will be much faster, as first a point estimate of model parameters will be obtained by maximum likelihood, which are then used to do the empirical Bayes. I don\u2019t know which \u201cstandard\u201d Bayesian approach you use, but why don\u2019t you just do both and compare the two approaches? My guess is that they might be 95% similar in the results. Cheers Minh Best regards, Gabriel You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/69063699-bcce-41d7-8f45-dd4f93af0b26%40googlegroups.com "]}, "5f0-cfnzTBo": {"topic": "constraint tree inquiry", "initializeDate": "Mar 14, 2021, 10:07:33 PM", "timeStamp": "Mar 15, 2021, 11:42:32 PM", "content": ["Hi Professor Minh Bui, I recently conducted a constrained tree search using IQ-TREE, v 2.0.6, and found that the resulting tree file (suffix .treefile ) had a different topology than the tree specified using the argument. I have attached the input and output files from an example constrained tree search run that resulted in an output tree with a different topology. The constrained tree specified with and the resulting treefile (suffix .treefile ) has an RF distance of 10. best, Jacob ", "Hi Jacob, Someone else asked the same question not long ago. It\u2019s due to the effect of identical sequences, causing this (see log file): \"5 taxa removed from constraint tree\" To avoid this effect, please use -keep_ident option. However, there are many these WARNINGs: WARNING: Constraint tree has all taxa and is bifurcating, which strictly enforces final tree! telling that -g option is not appropriate here. Please use -te option instead. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1ad8bc80-7d32-4d48-8def-10c1edf621e6n%40googlegroups.com <example.tar.gz> "]}, "_Q4NuAUm0mo": {"topic": "-write-branches", "initializeDate": "Jul 9, 2020, 4:35:58 PM", "timeStamp": "Jul 12, 2020, 8:14:37 PM", "content": ["Hello All, I would like to use the --write-branches function without a partitioned dataset. Is it possible to do that? I get the error \"Please only use this feature with partition model\" when I run it with example.phy but without partitions (iqtree -s example.phy -bb 1000 --write-branches). Thank you so much for your help! ", "You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8fb1a068-2800-43af-befd-ffbc66a5be5an%40googlegroups.com ", "Hi there, Why do you need to use this option? It was internally implemented for Rob, which prints for each branch of the tree, whether it appears in each of the partitions or not. Because due to missing data, some taxa might not be present in some partition, and thus the absence of some branches (both external and internal). Is this something you want to use the option for? Cheers Minh On 10 Jul 2020, at 6:35 am, Manpreet Kohli < mk...@njit.edu > wrote: "]}, "gt90ndNgL7E": {"topic": "BUG", "initializeDate": "Jun 14, 2019, 11:57:42 PM", "timeStamp": "Jun 25, 2019, 11:06:53 AM", "content": ["IQTree crashes with my alignment file when I try to run with -m MFP. Works fine with -m 8.8. This is the error I get: ERROR: C:\\Users\\minh\\Dropbox\\iqtree-git\\tree\\phylotree.cpp:2652: virtual double PhyloTree::optimizeAllBranches(int, double, int): Assertion `fabs(new_tree_lh-tree_lh) < max_delta_lh' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: Colony_CHRONICLE.fas.log ERROR: *** Alignment files (if possible) ", "Hi Zeeshan, Thanks for the report. But it\u2019s really hard to know what the problem is, given this little information. Can you pls send the full log file, with command line etc.? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4d255281-7ea2-4d54-bd9e-9188b0a2fb0d%40googlegroups.com For more options, visit https://groups.google.com/d/optout "]}, "EPA-wjvLpu0": {"topic": "IQ-tree reading SNPS as protein", "initializeDate": "Apr 20, 2017, 11:12:10 PM", "timeStamp": "Apr 21, 2017, 9:04:36 AM", "content": ["Hi, I'm a regular user of IQ-tree, and have been running it on SNPs with no problem whatsoever. However, I just ran my pipeline on a new dataset (which is generated using identical methods and pipelines as previous studies), and having problems getting it to run with the ascertainment bias correction. My pipeline specifically checks for/removes constant sites (i.e. where there are no individuals homozygous for the minor allele). I've run this on lots of data sets and then put it into IQtree, so I'm stumped why this is occurring now. In particular, I got a different data set back from the same sequencing facility, with the same sequencing protocol, on the same day, and ran the same pipeline. That one works in IQtree but this one didn't. I've attached a subset of the full alignment. When I run this using: iqtree-omp -s test.phy -m TEST+ASC -bb 10000 -alrt 10000 -nt 2 I get the below, and it fails to run the SNP models selection: Alignment most likely contains protein sequences Alignment has 101 sequences with 499 columns and 499 patterns (499 informative sites, 0 constant sites) If I then use: iqtree-omp -s test.phy -m TEST+ASC -bb 10000 -alrt 10000 -nt 2 -st DNA I get the below: Alignment most likely contains protein sequences WARNING: Your specified sequence type is different from the detected one Alignment has 101 sequences with 499 columns and 499 patterns (499 informative sites, 0 constant sites) It runs, but I don't know that it's running the ascertainment bias correction correctly (the tree is odd), versus just running it as a gene sequence. Any thoughts on what is wrong with my alignment, that it is suddenly not recognizable as a SNP? Cheers, Renee ", "Dear Renee, On Apr 21, 2017, at 5:12 AM, Renee Catullo < renee....@gmail.com > wrote: Hi, I'm a regular user of IQ-tree, and have been running it on SNPs with no problem whatsoever. great to know that IQ-TREE is useful for your pipeline! However, I just ran my pipeline on a new dataset (which is generated using identical methods and pipelines as previous studies), and having problems getting it to run with the ascertainment bias correction. My pipeline specifically checks for/removes constant sites (i.e. where there are no individuals homozygous for the minor allele). I am a bit confused from the log file you sent there is one constant site: \"Alignment has 101 sequences with 9999 columns and 9990 patterns (9776 informative sites, 1 constant sites)\" And iqtree printed this at the end: \" 44 GTR+ASC+G Skipped since +ASC is not applicable ERROR: No models were examined! Please check messages above\" I've run this on lots of data sets and then put it into IQtree, so I'm stumped why this is occurring now. In particular, I got a different data set back from the same sequencing facility, with the same sequencing protocol, on the same day, and ran the same pipeline. That one works in IQtree but this one didn't. I've attached a subset of the full alignment. When I run this using: iqtree-omp -s test.phy -m TEST+ASC -bb 10000 -alrt 10000 -nt 2 I get the below, and it fails to run the SNP models selection: Alignment most likely contains protein sequences Alignment has 101 sequences with 499 columns and 499 patterns (499 informative sites, 0 constant sites) please always use -st DNA for such kind of data, because iqtree mis-detected the sequence type due to many SNP/ambiguous characters. If I then use: iqtree-omp -s test.phy -m TEST+ASC -bb 10000 -alrt 10000 -nt 2 -st DNA correct this way. I get the below: Alignment most likely contains protein sequences WARNING: Your specified sequence type is different from the detected one Alignment has 101 sequences with 499 columns and 499 patterns (499 informative sites, 0 constant sites) WARNING can be safely ignored due to the reason above It runs, but I don't know that it's running the ascertainment bias correction correctly (the tree is odd), versus just running it as a gene sequence. Any thoughts on what is wrong with my alignment, that it is suddenly not recognizable as a SNP? Just for my information, how do you know that the tree is odd? Is this from comparing with and without ASC? Cheers, Minh Cheers, Renee You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <test.log> <test.phy> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Thanks for the response. I think I attached the wrong log file from a longer alignment of SNPS, the correct one is attached. I think the tree is weird because I get a tree that is an asymmetrical comb. In each clade, individuals further from the root have much longer branch lengths. This looks a lot like a virus phylogeny, but would be rather unexpected for frogs. I'm not saying it's not right, it's just a very unexpected result. Given these issues, I want to be sure that this is not an analytical error. The correct log file that I attached is certainly testing DNA models and not protein models - if this suggests it's doing it right, then I'll be happy to believe it (e.g. some sort of rapid expansion processes), but it seems unusual for a vertebrate. On a separate note, I am a bit confused about why this data set, on longer alignments, is finding constant sites (as per the first log file). My pipeline does two separate checks for this. Geneious doesn't spot any identical nucleotides, but on my ~20 k SNP alignment (the full data set), IQ-tree finds 4 constant sites. I have to figure out which 4 sites it is before I can get to that issue (4 among 20 k is a bit of a pain). Happy to get some help on figuring out which 4 nucleotides are coming up constant for IQtree, but preferably offline as I don't want to post my entire dataset. Thanks again for the response. Renee "]}, "0FkevDPT9r4": {"topic": "what does manual mean by \"repeat analysis\" (does it mean independent or sequential?)", "initializeDate": "Oct 21, 2020, 6:50:42 PM", "timeStamp": "Oct 22, 2020, 12:33:55 AM", "content": ["In the user manual it says: While the default parameters were empirically determined to work well under our extensive benchmark (Nguyen et al., 2015), it might not hold true for all data sets. If in doubt that tree search is still stuck in local optima, one should repeat analysis with at least 10 IQ-TREE runs. Moreover, our experience showed that -pers and -nstop are the most relevant options to change in such case. For example, data sets with many short sequences should be analyzed with smaller perturbation strength (e.g. -pers 0.2) and larger number of stop iterations (e.g. -nstop 500). Does that mean that they recommend 10 independent runs starting from scratch, or a single run 10 times, with the output of the last being a seed for the first? Thanks! ", "I am not sure but it seems using the same parameters or different but varying the seed. Sent from my Verizon, Samsung Galaxy smartphone You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/56299538-41bc-4543-96be-2900abbef572n%40googlegroups.com ", "Hi. It could be either, but in practice independent is probably the way to go (the first few times). Say you have a tree for which IQTree got stuck in a local optimum (there were no trees \"near\" enough to the tree it had, for IQTree to find them, that were better). You can either have it start again from scratch, hoping that IQTree will luck onto a better tree, this time, or you can turn up the perturbation strength (or turn up the number of stop iterations), and start with the tree that IQTree got stuck on last time, hoping that IQTree will be able to find a better tree, near to the place it got stuck the last time. If you've only run IQTree analysis once, you've got an even chance of getting a tree as good or better, starting from scratch, the second time. If you start IQTree from where it got stuck the first time, your odds of getting a better tree (with a higher likelihood) aren't as good. The more times you've repeated the analysis with the same parameters, the lower your odds of getting a better tree (if you've already done that 10 times, the odds against getting a better tree on the 11th try are... already ten to one). Regards, James "]}, "MgsoPA3dvfQ": {"topic": "ERROR IQTREE 1.5.1 option -nt AUTO", "initializeDate": "Nov 28, 2016, 5:40:38 AM", "timeStamp": "Nov 28, 2016, 7:09:40 AM", "content": ["To whom it may concern, When I want to use the new option -nt AUTO of the new version of IQTREE I have a bug : It decide to chose 0 thread and after it crash with and error ``` IQ-TREE multicore version 1.5.1 for Mac OS X 64-bit built Nov 8 2016 Copyright (c) 2011-2016 Nguyen Lam Tung, Olga Chernomor, Arndt von Haeseler and Bui Quang Minh. Host: bastet.gem.pasteur.fr (AVX, 32 GB RAM) Command: /Users/rdenise/Downloads/iqtree-omp-1.5.1-MacOSX/bin/iqtree-omp -s Documents/These/Analyses/Analysis_pilAE/28_11_16/aligned_pilAE_out.fas -nt AUTO -st AA -pre /Users/rdenise/Downloads/iqtree-omp-1.5.1-MacOSX/bin/iqtree_pilAE -bb 1000 -m TESTNEW -madd C10,C20,C30,C40,C50,EX2,EX3,EHO,UL2,UL3,EX_EHO,LG4M,LG4X Seed: 644234 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Mon Nov 28 11:39:09 2016 Kernel: AVX - 0 threads (16 CPU cores detected) ... Create initial parsimony tree by phylogenetic likelihood library (PLL)... 2.253 seconds NOTE: MODEL SELECTION REQUIRES 908 MB MEMORY! Testing 481 protein models (sample size: 881) ... No. Model -LnL df AIC AICc BIC Assertion failed: (limits.size() == threads+1), function computeBounds, file /Users/minh/Dropbox/iqtree-git/phylokernelnew.h, line 874. STACK TRACE FOR DEBUGGING: 1 splitnumtaxacmp(Split const*, Split const*) 2 _sigtramp() 6 double PhyloTree::computeLikelihoodFromBufferGenericSIMD<Vec4d, false, false, false>() 7 double PhyloTree::computeLikelihoodBranchSIMD<Vec4d, false, 20, false, false>(PhyloNeighbor*, PhyloNode*) 8 splitnumtaxacmp(Split const*, Split const*) 9 comparePLLNNIMove(pllNNIMove const&, pllNNIMove const&) 10 comparePLLNNIMove(pllNNIMove const&, pllNNIMove const&) 11 splitnumtaxacmp(Split const*, Split const*) 12 splitnumtaxacmp(Split const*, Split const*) 13 splitnumtaxacmp(Split const*, Split const*) 14 splitnumtaxacmp(Split const*, Split const*) *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: /Users/rdenise/Downloads/iqtree-omp-1.5.1-MacOSX/bin/iqtree_pilAE.log *** Alignment files (if possible) Abort trap: 6 ``` Did I used wrongly the option -nt AUTO ? Thank you for your help R\u00e9mi ", "Dear Remi, the -nt AUTO option does not work with model selection yet. So pls avoid using it for the current version. For now you can do -nt AUTO for other analyses (without -m TEST\u2026) and then use the determined number of threads for -m TEST. fyi it is in the TODO list for the next version. Thanks for your patience ;-) Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <iqtree_pilAE.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "itKcC_mA6X8": {"topic": "Can I trust highly significant tree topology test results?", "initializeDate": "Jul 4, 2017, 5:01:31 AM", "timeStamp": "Jul 13, 2017, 12:10:27 PM", "content": ["Dear Minh, I have a question about the tree topology testing. I would like to test if the three clades t-M, t-D and t-C (figure attached) have a significantly different topology from a star topology. The tree on the left shows the result of IQTree. The tree on the right has a manually collapsed internal branch that makes t-D and t-C sister clades. I submitted these two tree files to IQTrees topology test using this command: ~/Software/iqtree-omp-1.4.2-Linux/bin/iqtree-omp -nt 8 -s samples.fa -z topologies.treefile -n 0 -zb 1000 -redo I get a highly significant difference between the maximum likelihoods given by the two trees. SEQUENCE ALIGNMENT ------------------ Input data: 55 sequences with 35000001 nucleotide sites Number of constant sites: 3.49103e+07 (= 99.7437% of all sites) Number of site patterns: 21328 Tree logL deltaL bp-RELL p-KH p-SH c-ELW ------------------------------------------------------------------ 1 -3913333.260 0.000 1.0000 + 1.0000 + 1.0000 + 1.0000 + 2 -3915682.441 2349.181 0.0000 - 0.0000 - 0.0000 - 0.0000 - I was wondering how collapsing such a short internal branch in my tree can result in such a reduced log likelihood. Is this realistic, or am I doing something wrong? Are there enough SNPs supporting that small internal branch that the log likelihood is so disturbed by forcing the star topology? The trees are based on a 2 Mb region. Thank you very much for your help, Reka ", "Dear Reka, everything looks fine to me. What you did is in fact something like zero branch test \u2014 it showed that this branch length, though short, is significantly different from zero. It may seem odd at the beginning why such short branch has a high \u201csupport\u201d. However, the previous line of the report suggest an answer: Number of constant sites: 3.49103e+07 (= 99.7437% of all sites) Because 99.7% of the alignment sites are constant, most branch lengths will be close to zero anyway. Thus, there can be a substantial number of SNPs supporting this branch, which is somehow hidden because the branch lengths are normalized by the number of substitutions per site. Alternatively, you can also perform a bootstrap analysis to find the support for this branch as an alternative evidence. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <ex.pdf> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Have a look at your data, and you should be able to find the answer. It is not so important how long your sequences are, but how many informative sites there are. When comparing humans for example, you may need several million bases aligned to find a few dozen informative sites, but if you are comparing human to chimpanzee, gorilla, oragnutan and more distantly related species there may be a few dozen informative sites in just 10,000 bases aligned. If you have even one or two sites that are supporting the t-M, t-D and t-C as separate clades, then saying this is truly a star phylogeney means that those sites randomly changed many times (once for each of the OTUs) whereas only one change is needed for each clade in the tree showing three clades. ", "Both of the trees show t-M as the \"parent\" of the t-D and t-C clades, and I observe this nearly all the time with trees I build where I know for certain that there should be a three way split. In this tree, I suspect that t-M, t-C and t-D shared a common ancestor and not that t-C and t-D evolved from t-M. The artifact of placing the \"root\" of the t-M plus t-D and t-C clades within the t-M clade I have blamed on a \"long branches attract\" problem, but I could be wrong. At any rate, I would like to know of a tool to help me re-adjust where the root of a clade is placed so that I can do the tree test like this. See my attached modification of your figure, for a visual explanation. "]}, "BTwEK9Ejc1k": {"topic": "Problem with partitioned analysis", "initializeDate": "Mar 9, 2021, 5:00:27 PM", "timeStamp": "Mar 15, 2021, 11:58:34 PM", "content": ["Dear Minh: I was trying to merge partitions but the program crashes with the following error message (RADseq data, 117 individuals, ~40 bp each loci): Info: multi-threading strategy over partitions ERROR: phylotesting.cpp:537: std::__cxx11::string computeFastMLTree(Params &, Alignment *, ModelCheckpoint &, ModelsBlock *, int &, int, std::__cxx11::string): Assertion `subst_names.size() == rate_names.size()' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: out_part.log ERROR: *** Alignment files (if possible) Aborted (core dumped) This is the command: iqtree2 -nt 4 -s clust90_min23_117_full.phy -p part_raxml --merge-model GTR --merge-rate G --merge rclusterf -rclusterf 10 -m TESTMERGEONLY -mset GTR -mrate G -merit AICc --prefix out_part --seed 234234 -safe The bug persists with both, my personal 8 GB RAM laptop and a 62 GB server. The curious thing is that I assembled a dataset with fewer individuals (112) and the program runs on both computers without problems. I can send you the complete assembly and log file Cheers ", "Update: I was able to run with the stable release (v1.6.12) ", "Hi there, This assertion tells me that there is something wrong in parsing the input\u2026 I don\u2019t know what. Please send me the alignment and the partition files\u2026 however, not sure when I can get into this \u2014 currently I don\u2019t have much time for debugging. Cheers, Minh On 11 Mar 2021, at 11:09 pm, Kevin I. S\u00e1nchez < kevin.iman...@gmail.com > wrote: Update2: although I was able to run the analysis in iqtree1, the remaining run time is really really long (4780h:16m:33s left). I will need to return to iqtree2, but the crash report persists, what could be the reason? thanks You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f7f88c7b-6058-4e9a-8c1f-cf6891e59b51n%40googlegroups.com "]}, "3H4zMa0HuGM": {"topic": "IQ-TREE release 1.6.11", "initializeDate": "Jun 6, 2019, 11:01:54 PM", "timeStamp": "Jun 6, 2019, 11:01:54 PM", "content": ["Dear Users, We\u2019re pleased to release the maintenance version 1.6.11 with following changes: Important changes: \u2022 Amino-acid frequencies of DAYHOFF, DCMUT, JTT, MTREV, WAG, CPREV, LG, MTZOA, PMB, JTTDCMUT, FLU are modified with higher precision and normalised to 1 (thanks Ben Redelings). This may lead to tiny change in log-likelihood (i.e. from 3 digit after comma) but does not affect +F model. New features: \u2022 Support \u2018.\u2019 syntax for alignment length in partition file (requested by Teofil Nakov). Bugfixes: \u2022 Crash with -bnni option and GENE/GENESITE resampling (reported by Emmanuel Cantu). \u2022 Incorrect WARNING about bootstrap convergence with -bnni option (reported by Max_IT). \u2022 Numerical issue with likelihood scaling for gcc under -O3 optimisation. \u2022 Handling fixed substitution rates (reported by @bbuchfink). Cheers, The IQ-TREE development team "]}, "ryBuCaHpqG4": {"topic": "Error in partition format in iqtree 1.6.7 (worked in iqtree 1.5.5)", "initializeDate": "Oct 15, 2018, 12:37:28 AM", "timeStamp": "Oct 15, 2018, 1:54:45 AM", "content": ["With iqtree 1.6.7 I'm receiving following error regarding the format of partition which did not happen with iqtree 1.5.5 ERROR Expecting integer but found \"/3;\" instead More info: I run iqtree 1.5.5 as follows: iqtree omp InputAlignment spp PartitioningScheme m GTR rcluster alrt 1000 1000 pre $ SLURM_JOB_NAME where the PartitioningScheme has line formated like the one below: DNA EOG090W000W_pos1 9477 This partition can be read correctly and iqtree outputs Partition file not NEXUS format assuming RAxML style partition file ... Reading partition EOG090W000W_pos1 model GTR seq DNA pos 9477 ... sequences and 9477 sites extracted etc I have now upgraded to iqtree 1.6.7. When I run iqtree as above, with the same input data and partition, iqtree 1.6.7 fails with ERROR: Partition file not NEXUS format assuming RAxML style partition file ... ERROR Expecting integer but found \"/3;\" instead Am I missing something obvious? Let me know in case you want me to share some more files or information. Thanks for any hints! Ales ", "Hi Ales, The correct syntax is to use back-slash, i.e. \"1-9477\\3\". So the error message is right. Not sure why v1.5 didn\u2019t detect this, so pls check again that it reads in the number of sites properly. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, thanks for the quick reply. Backslash-formatted partition without semicolon at the end of line is running with v1.6.7. Ales "]}, "AT1SDFcB14E": {"topic": "BUG: IQTREE 1.6.1 with -fast and -bb", "initializeDate": "Feb 5, 2018, 11:17:26 AM", "timeStamp": "Feb 15, 2018, 11:53:40 PM", "content": ["To whom it may concern, I launched IQTREE 1.6.1 with this command line on MAC OS X : iqtree -s alignment_aligned_out.fas -fast -bb 1000 -nt 10 -m MFP And IQTREE said immediately Ultrafast bootstrap does not work with -te or -n option It is a know behavior ? If not, it is other kind of bug like that ? Because I had bug like that with incompatible option that was not on the command line but I don't remember the command line. Where I could find incompatible option list ? Thank you R\u00e9mi Denise ", "Hi Remi, Thanks for letting us know\u2026 the ERROR should have been \u201cUltrafast bootstrap does not work with -fast option\u201d. We will change in the next release. So it is not a bug but a correct behaviour, only a misleading error message. Note that you can do fast standard bootstrap by e.g. \"-fast -b 100\u201d. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Minh and all, I also tried to ru UF bootstraps on a dataset, first with mpi (which crashed 3 times) then with the normal multicore version. This crashed again after ca. 6 h run time - it always crashed after restart from a checkpoint but not immediately. Is my command wrong? Its quite urgent so any help yould be great (ca. 200 taxa, > 1300 partitions) - with having enough (500) GB RAM Error: below. begin / end of the log file: ****************************************************** CHECKPOINT: Resuming analysis from BS_ultrafast_KM_000_999.ckp.gz IQ-TREE multicore version 1.6.1 for Linux 64-bit built Jan 11 2018 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: c143 (AVX2, FMA3, 503 GB RAM) Command: iqtree -s alignment.fas -st AA -spp BestModels_aa_.best_scheme.nex -pre BS_ultrafast_KM_000_999 -t besttreefrom search.treefile -bb 1000 -bnni -nt 20 -wbtl -safe end of the logfile: Model LG4X is alias for MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4 Model LG4X is alias for MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4 Model LG4X is alias for MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4 Model LG4X is alias for MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4 Model LG4X is alias for MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4 Model LG4X is alias for MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4 Model LG4X is alias for MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4 Model LG4X is alias for MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4 NOTE: 129777 MB RAM (126 GB) is required! CHECKPOINT: Model parameters restored, LogL: -42341930.708 -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- CHECKPOINT: Candidate tree set restored, best LogL: -42341930.708 Finish initializing candidate tree set (1) Current best tree score: -42341930.708 / CPU time: 0.000 Number of iterations: 85 -------------------------------------------------------------------- | OPTIMIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Iteration 90 / LogL: -42343263.804 / Time: 2h:5m:58s (0h:14m:4s left) Iteration 100 / LogL: -42343025.330 / Time: 6h:7m:55s (0h:0m:0s left) Refining ufboot trees with NNI... ERROR: phylotree.cpp:4983: virtual void PhyloTree::reorientPartialLh(PhyloNeighbor*, Node*): Assertion `dad_branch->partial_lh && \"partial_lh is not re-oriented\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 6 PhyloTree::reorientPartialLh(PhyloNeighbor*, Node*) ERROR: 7 PhyloSuperTreePlen::reorientPartialLh(PhyloNeighbor*, Node*) ERROR: 8 PhyloSuperTreePlen::swapNNIBranch(double, PhyloNode*, PhyloNode*, SwapNNIParam*, NNIMove*) ERROR: 9 PhyloSuperTreePlen::getBestNNIForBran(PhyloNode*, PhyloNode*, NNIMove*) ERROR: 10 IQTree::evaluateNNIs(std::map<int, std::pair<Node*, Node*>, std::less<int>, std::allocator<std::pair<int const, std::pair<Node*, Node*> > > >&, std::vector<NNIMove, std::allocator<NNIMove> >&) ERROR: 11 IQTree::optimizeNNI(bool) ERROR: 12 IQTree::doNNISearch() ERROR: 13 IQTree::refineBootTrees() ERROR: 14 IQTree::doTreeSearch() ERROR: 15 runTreeReconstruction(Params&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, IQTree*&, ModelCheckpoint&) ERROR: 16 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 17 main() ERROR: 18 __libc_start_main() ERROR: 19 _start() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: BS_ultrafast_KM_000_999.log ERROR: *** Alignment files (if possible) /cm/local/apps/slurm/var/spool/job13766367/slurm_script: line 20: 118210 Aborted (core dumped) comand "]}, "yz5-CeiIpBw": {"topic": "Examples of converged IQTREE data?", "initializeDate": "Oct 21, 2020, 7:01:28 PM", "timeStamp": "Nov 30, 2020, 7:15:11 PM", "content": ["Does anyone have an example they can share of an iteration vs LogL plot showing converging data? It can even be a plot with fake data that would represent what a plot that can be considered converged looks like. Thanks! ", "Hi There, A converged analysis will typically show a line that increases rapidly at first, then flattens off to a gradient of ~zero. The 'convergence' is simply the analysis not being able to find any trees that improve on the current best tree. It tends to flatten off gradually because early moves in treespace lead to large increases in likelihood, while later moves give smaller improvements. If you have questions about your analysis, feel free to post the plot here and we can take a look. Hope that helps, Rob On Thu, 22 Oct 2020 at 10:01, Bio Student < nege...@gmail.com > wrote: Does anyone have an example they can share of an iteration vs LogL plot showing converging data? It can even be a plot with fake data that would represent what a plot that can be considered converged looks like. Thanks! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/a76bae4d-d20f-4eb8-afe7-fdb557752564n%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com "]}, "ClpsZUPlkPc": {"topic": "Site-wise likelihoods under PMSF and full mixture models", "initializeDate": "Apr 8, 2020, 11:10:09 AM", "timeStamp": "Apr 16, 2020, 3:53:48 PM", "content": ["Dear IQ-TREE team, I am interested in calculating site-wise log-likelihoods of a fixed user-defined topology based on an amino-acid supermatrix and a protein mixture model of site frequencies eg. (PMSF or full mixture). Is it possible to do this? My questions are the following: If i conduct a tree search under a full mixture model (eg. the LG+C20+F+G) l and use the option -wsl, i assume i am going to get as output the site-wise likelihoods under this model? If i use instead a fixed topology with the -te -wsl option and the same model as above, i suppose i will get the site-wise log-likelihood of the specified tree under this model? Lastly, are these calculations also possible to do when i use the PMSF approximation (i.e. a predefined site-specific frequency profile .sitefreq)? Many thanks Alex ", "Hi Alex, Quick answer: Yes, it is. -te TREE_FILE -wsl will print the site log-likelihoods for the given tree, no matter what model you have. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c085ae6a-2ffb-4e61-b327-bdd8159d6f5a%40googlegroups.com ", "Hi Minh, Many thanks for the clarification. Relating to first question i have an additional one. I tried to do model selection by including both free rate models as well as mixtures for the frequencies before calculating the tree, but i get some warnings (see below). This is an alignment of 49468 amino acid sites and 136 species. I am using iqtree v. 1.6.12. The warning is only for the the model with a combination of freerate among-site heterogeneity with compositional among-site heterogeneity models. Should i just ignore this warning? It seems that the combined CX+RX models have better scores so it makes sense to include them or? Any help would be appreciated. Many thanks Alex ####################################################### IQ-TREE multicore version 1.6.12 for Linux 64-bit built Aug 15 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: compute-0-3.local (AVX, 504 GB RAM) Command: /share/scientific_bin/iqtree/1.6.12/bin/iqtree -s FcC_supermatrix.sorted.fas -m MFP -mset LG,WAG,JTT,JTTDCMUT,DCMUT -madd LG4X,LG4M -mfreq FU,F,F+C20,F+C40,F+C60 -cmin 4 -mrate E,I,G,I+G,R -st AA -nt 20 -safe -merit AICC -t RANDOM -pre all_models_1 -bb 2000 -mem 300G -wsl Seed: 129990 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Thu Apr 9 16:12:19 2020 Kernel: Safe AVX - 20 threads (48 CPU cores detected) Reading alignment file FcC_supermatrix.sorted.fas ... Fasta format detected Alignment most likely contains protein sequences Alignment has 136 sequences with 49468 columns, 45178 distinct patterns 21917 parsimony-informative, 6842 singleton sites, 20709 constant sites Gap/Ambiguity Composition p-value ... ... Model LG+F+C20 is alias for LG+F+POISSON+G+FMIX{C20pi1:1:0.0559910600,C20pi2:1:0.0514824870,C20pi3:1:0.0812922124,C20pi4:1:0.0721976867,C20pi5:1:0.0556718858,C20pi6:1:0.0331003080,C20pi7:1:0.0589501763,C20pi8:1:0.0263756889,C20pi9:1:0.0307584220,C20pi10:1:0.0376701125,C20pi11:1:0.0303058290,C20pi12:1:0.0808775576,C20pi13:1:0.0263349134,C20pi14:1:0.0579101455,C20pi15:1:0.0371248064,C20pi16:1:0.0586867766,C20pi17:1:0.0561479138,C20pi18:1:0.0349810886,C20pi19:1:0.0544937394,C20pi20:1:0.0596471901} 23 LG+F+C20 1372983.649 309 2746585.299 2746589.196 2749307.305 Model LG+F+C20+I is alias for LG+F+POISSON+G+FMIX{C20pi1:1:0.0559910600,C20pi2:1:0.0514824870,C20pi3:1:0.0812922124,C20pi4:1:0.0721976867,C20pi5:1:0.0556718858,C20pi6:1:0.0331003080,C20pi7:1:0.0589501763,C20pi8:1:0.0263756889,C20pi9:1:0.0307584220,C20pi10:1:0.0376701125,C20pi11:1:0.0303058290,C20pi12:1:0.0808775576,C20pi13:1:0.0263349134,C20pi14:1:0.0579101455,C20pi15:1:0.0371248064,C20pi16:1:0.0586867766,C20pi17:1:0.0561479138,C20pi18:1:0.0349810886,C20pi19:1:0.0544937394,C20pi20:1:0.0596471901}+I 24 LG+F+C20+I 1392713.385 310 2786046. 770 2786050 .692 2788777.585 Model LG+F+C20+G is alias for LG+F+POISSON+G+FMIX{C20pi1:1:0.0559910600,C20pi2:1:0.0514824870,C20pi3:1:0.0812922124,C20pi4:1:0.0721976867,C20pi5:1:0.0556718858,C20pi6:1:0.0331003080,C20pi7:1:0.0589501763,C20pi8:1:0.0263756889,C20pi9:1:0.0307584220,C20pi10:1:0.0376701125,C20pi11:1:0.0303058290,C20pi12:1:0.0808775576,C20pi13:1:0.0263349134,C20pi14:1:0.0579101455,C20pi15:1:0.0371248064,C20pi16:1:0.0586867766,C20pi17:1:0.0561479138,C20pi18:1:0.0349810886,C20pi19:1:0.0544937394,C20pi20:1:0.0596471901}+G 25 LG+F+C20+G 1372983.649 309 2746585.297 2746589.195 2749307.304 Model LG+F+C20+I+G is alias for LG+F+POISSON+G+FMIX{C20pi1:1:0.0559910600,C20pi2:1:0.0514824870,C20pi3:1:0.0812922124,C20pi4:1:0.0721976867,C20pi5:1:0.0556718858,C20pi6:1:0.0331003080,C20pi7:1:0.0589501763,C20pi8:1:0.0263756889,C20pi9:1:0.0307584220,C20pi10:1:0.0376701125,C20pi11:1:0.0303058290,C20pi12:1:0.0808775576,C20pi13:1:0.0263349134,C20pi14:1:0.0579101455,C20pi15:1:0.0371248064,C20pi16:1:0.0586867766,C20pi17:1:0.0561479138,C20pi18:1:0.0349810886,C20pi19:1:0.0544937394,C20pi20:1:0.0596471901}+I+G 26 LG+F+C20+I+G 1391973.207 310 2784566. 414 2784570 336 2787297 .229 Model LG+F+C20+R4 is alias for LG+F+POISSON+G+FMIX{C20pi1:1:0.0559910600,C20pi2:1:0.0514824870,C20pi3:1:0.0812922124,C20pi4:1:0.0721976867,C20pi5:1:0.0556718858,C20pi6:1:0.0331003080,C20pi7:1:0.0589501763,C20pi8:1:0.0263756889,C20pi9:1:0.0307584220,C20pi10:1:0.0376701125,C20pi11:1:0.0303058290,C20pi12:1:0.0808775576,C20pi13:1:0.0263349134,C20pi14:1:0.0579101455,C20pi15:1:0.0371248064,C20pi16:1:0.0586867766,C20pi17:1:0.0561479138,C20pi18:1:0.0349810886,C20pi19:1:0.0544937394,C20pi20:1:0.0596471901}+R4 WARNING: Both Gamma and FreeRate models were specified, continue with FreeRate model 27 LG+F+C20+R4 1365494.238 314 2731616.476 2731620. 501 2734382 .528 Model LG+F+C20+R5 is alias for LG+F+POISSON+G+FMIX{C20pi1:1:0.0559910600,C20pi2:1:0.0514824870,C20pi3:1:0.0812922124,C20pi4:1:0.0721976867,C20pi5:1:0.0556718858,C20pi6:1:0.0331003080,C20pi7:1:0.0589501763,C20pi8:1:0.0263756889,C20pi9:1:0.0307584220,C20pi10:1:0.0376701125,C20pi11:1:0.0303058290,C20pi12:1:0.0808775576,C20pi13:1:0.0263349134,C20pi14:1:0.0579101455,C20pi15:1:0.0371248064,C20pi16:1:0.0586867766,C20pi17:1:0.0561479138,C20pi18:1:0.0349810886,C20pi19:1:0.0544937394,C20pi20:1:0.0596471901}+R5 WARNING: Both Gamma and FreeRate models were specified, continue with FreeRate model 28 LG+F+C20+R5 1363446.659 316 2727525. 318 2727529 .394 2730308.987 Model LG+F+C20+R6 is alias for LG+F+POISSON+G+FMIX{C20pi1:1:0.0559910600,C20pi2:1:0.0514824870,C20pi3:1:0.0812922124,C20pi4:1:0.0721976867,C20pi5:1:0.0556718858,C20pi6:1:0.0331003080,C20pi7:1:0.0589501763,C20pi8:1:0.0263756889,C20pi9:1:0.0307584220,C20pi10:1:0.0376701125,C20pi11:1:0.0303058290,C20pi12:1:0.0808775576,C20pi13:1:0.0263349134,C20pi14:1:0.0579101455,C20pi15:1:0.0371248064,C20pi16:1:0.0586867766,C20pi17:1:0.0561479138,C20pi18:1:0.0349810886,C20pi19:1:0.0544937394,C20pi20:1:0.0596471901}+R6 WARNING: Both Gamma and FreeRate models were specified, continue with FreeRate model 29 LG+F+C20+R6 1362888.814 318 2726413. 628 2726417 .756 2729214.916 Model LG+F+C20+R7 is alias for LG+F+POISSON+G+FMIX{C20pi1:1:0.0559910600,C20pi2:1:0.0514824870,C20pi3:1:0.0812922124,C20pi4:1:0.0721976867,C20pi5:1:0.0556718858,C20pi6:1:0.0331003080,C20pi7:1:0.0589501763,C20pi8:1:0.0263756889,C20pi9:1:0.0307584220,C20pi10:1:0.0376701125,C20pi11:1:0.0303058290,C20pi12:1:0.0808775576,C20pi13:1:0.0263349134,C20pi14:1:0.0579101455,C20pi15:1:0.0371248064,C20pi16:1:0.0586867766,C20pi17:1:0.0561479138,C20pi18:1:0.0349810886,C20pi19:1:0.0544937394,C20pi20:1:0.0596471901}+R7 WARNING: Both Gamma and FreeRate models were specified, continue with FreeRate model 30 LG+F+C20+R7 1362670.988 320 2725981.976 2725986.157 2728800.882 Model LG+F+C20+R8 is alias for LG+F+POISSON+G+FMIX{C20pi1:1:0.0559910600,C20pi2:1:0.0514824870,C20pi3:1:0.0812922124,C20pi4:1:0.0721976867,C20pi5:1:0.0556718858,C20pi6:1:0.0331003080,C20pi7:1:0.0589501763,C20pi8:1:0.0263756889,C20pi9:1:0.0307584220,C20pi10:1:0.0376701125,C20pi11:1:0.0303058290,C20pi12:1:0.0808775576,C20pi13:1:0.0263349134,C20pi14:1:0.0579101455,C20pi15:1:0.0371248064,C20pi16:1:0.0586867766,C20pi17:1:0.0561479138,C20pi18:1:0.0349810886,C20pi19:1:0.0544937394,C20pi20:1:0.0596471901}+R8 WARNING: Both Gamma and FreeRate models were specified, continue with FreeRate model On Thursday, April 9, 2020 at 1:14:05 AM UTC+2, Minh Bui wrote: Hi Alex, Quick answer: Yes, it is. -te TREE_FILE -wsl will print the site log-likelihoods for the given tree, no matter what model you have. Cheers Minh On 9 Apr 2020, at 1:10 am, Alexandros Vasilikopoulos < alexva...@gmail.com > wrote: Dear IQ-TREE team, I am interested in calculating site-wise log-likelihoods of a fixed user-defined topology based on an amino-acid supermatrix and a protein mixture model of site frequencies eg. (PMSF or full mixture). Is it possible to do this? My questions are the following: If i conduct a tree search under a full mixture model (eg. the LG+C20+F+G) l and use the option -wsl, i assume i am going to get as output the site-wise likelihoods under this model? If i use instead a fixed topology with the -te -wsl option and the same model as above, i suppose i will get the site-wise log-likelihood of the specified tree under this model? Lastly, are these calculations also possible to do when i use the PMSF approximation (i.e. a predefined site-specific frequency profile .sitefreq)? Many thanks Alex You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Alex, Yes please ignore that warning, it\u2019s only to notify the users about what IQ-TREE continues to do, and not something to be cautious. Cheers Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7caff030-010d-40bc-9cd2-ba8fe71326ad%40googlegroups.com "]}, "iodXVm4h34Y": {"topic": "Determine Bootstrap support in given tree", "initializeDate": "Jul 12, 2019, 7:12:47 AM", "timeStamp": "Jul 16, 2019, 11:32:24 AM", "content": ["Hi, I have a ML tree in which I just want to calculate the bootstrap support. I tested by running with the -te option but I am getting 100 bootstrap support in every node. I believe -te is not the correct option in this case? Thanks, ", "On Friday, July 12, 2019 at 12:12:47 PM UTC+1, Carla Gon\u00e7alves wrote: Hi, I have a ML tree in which I just want to calculate the bootstrap support (non-parametric bootstraps). I tested by running with the -te option but I am getting 100 bootstrap support in every node. I believe -te is not the correct option in this case? Thanks, ", "Hi Carla, -te is NOT the right option here, because it fixes the tree topology of the user tree. That\u2019s why you got 100% BS. Do you want to give IQ-TREE some initial tree and then let it optimise the tree further? If so, just use -t option. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/574574b1-4252-4ee9-b1f2-c39907404aa2%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Hi Minh, thank you, I think I just found the answer to my question in a previous thread: https://groups.google.com/forum/#!msg/iqtree/000oT_wpuuk/YlITCOjpBwAJ This is exactly what I am looking for. Thank you! On Monday, July 15, 2019 at 1:23:00 AM UTC+1, Minh Bui wrote: Hi Carla, -te is NOT the right option here, because it fixes the tree topology of the user tree. That\u2019s why you got 100% BS. Do you want to give IQ-TREE some initial tree and then let it optimise the tree further? If so, just use -t option. Cheers Minh On 12 Jul 2019, at 9:12 pm, Carla Gon\u00e7alves < carla.i...@gmail.com > wrote: Hi, I have a ML tree in which I just want to calculate the bootstrap support. I tested by running with the -te option but I am getting 100 bootstrap support in every node. I believe -te is not the correct option in this case? Thanks, You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "nhsLqfCROY4": {"topic": "Phylogenomics Workshop using IQ-TREE, Canberra, Australia", "initializeDate": "Aug 24, 2018, 7:06:29 PM", "timeStamp": "Aug 24, 2018, 7:06:29 PM", "content": ["Dear All, We\u2019re offering a one-day workshop on phylogenomics using IQ-TREE: Date: 7 December 2018 Location: Australian National University, Canberra Instructors: Rob Lanfear, Minh Bui (PartitionFinder and IQ-TREE key developers) For information and registration: http://cba.anu.edu.au/news-events/phylogenomics-workshop-using-iq-tree Cheers Minh "]}, "N_nZ8nHWdSo": {"topic": "No parsimony informative sites / sCF", "initializeDate": "Sep 7, 2020, 11:37:13 AM", "timeStamp": "Sep 14, 2020, 7:54:34 AM", "content": ["Hi, I'd like to evaluate the concordance factors between my different partitions. However, some of my partitions don't contain any parsimony infromative sites. As sCF is based on parsimony, can I still use it? Obviously, the sCF will be null for these partitions but should I remove them or can I leave them in without causing false results on the other partitons? Thanks ", "Hi Pauline, This is a good question. In that case sCF is 0. Same with discordance factor: sDF1 = sDF2 = 0. Because all these factors are 0, they don\u2019t add up anything to the result, and I believe it doesn\u2019t matter for site concordance. However, it will influence gene concordance factor or coalesence approach, as the gene trees for such partition are more or less random. This is when I would remove those partitions. Cheers Minh On 8 Sep 2020, at 1:37 am, Pauline Stud < studp...@gmail.com > wrote: Hi, I'd like to evaluate the concordance factors between my different partitions. However, some of my partitions don't contain any parsimony infromative sites. As sCF is based on parsimony, can I still use it? Obviously, the sCF will be null for these partitions but should I remove them or can I leave them in without causing false results on the other partitons? Thanks You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d28f7a44-f51a-4abc-8536-c9f452357ab6n%40googlegroups.com ", "Thank you very much for your quick reply. Why would that trees be random trees? I thought maximum likelihood would use all sites, not only parsimony informative ones. ", "Because without parsimony informative sites, you can\u2019t resolve internal branches, even under maximum likelihood. So you may get star-looking trees with very short internal branches. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/95a05191-2b16-4645-b627-7982dae63c92n%40googlegroups.com ", "Thank you Minh. I was confused as my trees were looking good without parsimony informative sites. Turns out there are informative sites but they're not counted by IQtree as I recoded my DNA with RY. "]}, "WmvXomEraBU": {"topic": "defaults for partition analyses", "initializeDate": "Jun 22, 2016, 9:01:13 AM", "timeStamp": "Jun 22, 2016, 9:14:31 AM", "content": ["Hi Minh, I've been trying out the automated partition finding methods, but its not clear to me what the defaults are. I am running a job with: iqtree-omp -s datafile -q partitionfile -m TESTONLYMERGE -rcluster 10 Will this build the partitions based on similarities in branchlengths and other parameters OR is it assuming that the branchlengths are all linked across partitions. I assume that because I didn't put -sp that it is assuming they are linked. Can you confirm this is the default? Cheers Andrew Roger ", "Dear Andrew, Quick answer: IQ-TREE only implemented the partition finding with unlinked edge lengths. I.e., -q or -sp will be the same here. I wanted to add the \u201clinked\u201d possibility at the some point, but was not entirely clear how this is done. Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Perfect! That is what I was hoping (that it was unlinked)! "]}, "rt3Hbv-qeJM": {"topic": "Re: Pruning of identical sequences in IQTREE", "initializeDate": "Mar 4, 2016, 9:56:01 AM", "timeStamp": "Mar 4, 2016, 9:56:01 AM", "content": ["Hi David, thanks for your interests. And yes there is indeed a switch \u201c-keep_ident\u201d, which will keep identical sequences for the analysis.I will add this info into the documentation. Cheers, Minh PS: I forwarded this information to the IQ-TREE forum as information for others as well. On Mar 4, 2016, at 3:15 PM, Labeda, David - ARS wrote: Dear Dr. Mihn, I recently discovered IQTREE as an alternative to jModelTest for use in my studies of the multigene systematics of Streptomyces species. One of the challenges of Streptomyces taxonomy is that many of the validly described species in the literature are identical with other valid species due to heavy reliance on morphological properties in earlier days. I am very impressed with the speed in which IQTREE does model selection on even relatively large datasets, but was dismayed when I realized that identical sequences were being pruned from the dataset prior to tree construction. In RAxML identical sequences are identified and a pruned dataset is created for future analysis, but these data are not removed from the analysis. Since visualizing identical strains is critical to my research, I wondered if a switch could be added to IQTREE to make it include these data in the analysis. Sincerely, David Labeda "]}, "pFZN7ki_VMo": {"topic": "question about rooting method in phylogenetic dating", "initializeDate": "Sep 23, 2020, 11:21:07 AM", "timeStamp": "Oct 14, 2020, 9:45:30 AM", "content": ["Hi everyone, I would like to perform molecular clock analysis and build a time tree with my datasets. I note that it is possible to automatically identify an unrooted-tree best-root position by specifying an additional option in the command-line: [--date-options \"-r a\"]. I have several questions about this rooting method: - Is it possible to use this option with a fixed tree-topology (-te option, existing DNA tree) ) ? - How can I check which sequence(s) from my data set (time tree and alignement) has been assigned as outgroup(s)? Best regards Gabriel ", "Hi Gabriel, On 24 Sep 2020, at 1:21 am, gabriel...@ gmail.com gabriel...@gmail.com > wrote: Hi everyone, I would like to perform molecular clock analysis and build a time tree with my datasets. I note that it is possible to automatically identify an unrooted-tree best-root position by specifying an additional option in the command-line: [--date-options \"-r a\"]. This is the default behaviour and you don\u2019t have to set this option: if the treee is unrooted, IQ-TREE/LSD2 will automatically determine the best root position. I have several questions about this rooting method: - Is it possible to use this option with a fixed tree-topology (-te option, existing DNA tree) ) ? YES - How can I check which sequence(s) from my data set (time tree and alignement) has been assigned as outgroup(s)? Once finished, you can simply look at the resulting tree\u2026. outgroup(s) may group together on one side of the tree. If this is not the case, I suggest that you specify the outgroup with -o option. Does that answer your question? Minh Best regards Gabriel You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f2fb6baf-b2fb-4cf7-a62e-f81cfe73d543n%40googlegroups.com ", "Dear Minh, Thank you for your response. Unfortunately, I do not understand how the software is behaving to determine the best root position. Maybe it would be more convenient if I send you my data and the resulting time tree. -As you could see, the iqtree report says that the first sequence of the alignment has been assigned as the outgroup. I think this sequence would not be the best outgroup. Is this behaviour normal? -Additionally, I do not notice any taxon positioned at one side of the timetree. Could you give me more information about this points? Best regards, Gabriel ", "Hi Gabriel, Could you send the log file as well so that I can see what command you've used? For the rooting method, it is done in the dating process. It has the same principle with root-to-tip rooting method. In general, we search on all branches, and the root position corresponds to the one that minimizes the sum of residues (the differences - variances adjusted - between the input branch lengths and the output branch lengths). You can find more details in our paper Best regards, Hieen To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/19e063e5-a69e-4dae-86f3-d949ced7a6a8n%40googlegroups.com "]}, "SrHmiIk4Wp4": {"topic": "Constrained topology", "initializeDate": "Nov 1, 2017, 10:38:26 AM", "timeStamp": "Nov 1, 2017, 2:23:13 PM", "content": ["Hi, I am tryning to run IQtree with constrained topology for several taxa (-g constrained tree in newick formate), but the results are not constrained and the tree is the same as from unconstrained analysis. I followed tutorial: 5.5 Constrained tree search without any success. I would like to ask if could someone help me to figure this out? version: IQ-TREE multicore version 1.5.5 for Linux 64-bit built Oct 22 2017 Copyright (c) 2011-2017 command: iqtree -s COI_Neo.phy -g constrained.tree -m JC -nt 2 part of log: Reading alignment file COI_Neo.phy ... Phylip format detected Alignment most likely contains DNA/RNA sequences Alignment has 25 sequences with 723 columns and 398 patterns (341 informative sites, 326 constant sites) Gap/Ambiguity Composition p-value 1 ELAR047Oxy 0.00% passed 75.97% .......... 25 LAMR110 0.00% failed 1.05% **** TOTAL 0.13% 9 sequences failed composition chi2 test (p-value<5%; df=3) Reading constraint tree constrained.tree... NOTE: BYRElLip is identical to BYRElLim but kept for subsequent analysis Creating fast initial parsimony tree by random order stepwise addition... 0.003 seconds, parsimony score: 1981 (based on 341 informative sites) Thanks for your comments in advance. Cheers, Michal ", "Hi Michal, The command line looks OK. However, it\u2019s hard to help here without looking at the trees. Thus can you please send the tree figures for both the input constraint tree and the resulting ML tree? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "Uulto_F-n30": {"topic": "segmentation error", "initializeDate": "Mar 16, 2021, 12:59:58 PM", "timeStamp": "Mar 18, 2021, 8:40:26 PM", "content": ["Dear Minh and Hien I was trying to dating a phylogenetic tree of SARS-CoV-2 with roughly 69 k sequences, but I am getting an error named segmentation fault. Can you tell me if that is because a bug? Thank you very much in advanced, I am attaching the log file of the run. --------------------------------------------------------------------------------------------------- Santiago Justo Ar\u00e9valo ", "IQ-TREE multicore version 2.1.2 COVID-edition for Linux 64-bit built Oct 22 2020 Developed by Bui Quang Minh, James Barbetti, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: compute-0-0 (AVX2, FMA3, 125 GB RAM) Command: iqtree2 -s genomes_sample_RaTG13.fasta --date final_data_dates.txt -te genomes_sample_RaTG13_fast_tree.nwk --date-ci 100 -o bat/Yunnan/RaTG13/2013 -nt AUTO -alrt 1000 -keep-ident -m GTR Seed: 852372 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Sat Mar 13 21:41:32 2021 Kernel: AVX+FMA - auto-detect threads (20 CPU cores detected) TREE 1 *PROCESSING: Reading the tree ... Collapse 0 (over 64698) internal branches having branch length <= 1.7e-05 (settable via option -l) Parameter to adjust variances was set to 0.000339 (settable via option -b) Minimum branch length of time scaled tree (settable via option -u and -U): 0 Estimating the root position on the branch defined by given outgroups ... Computing confidence intervals using sequence length 29472 and a lognormal relaxed clock with mean 1, standard deviation 0.2 (settable via option -q) ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: genomes_sample_RaTG13.fasta.log ERROR: *** Alignment files (if possible) /var/spool/slurmd/job02377/slurm_script: line 7: 24107 Segmentation fault iqtree2 -s genomes_sample_RaTG13.fasta --date final_data_dates.txt -te genomes_sample_RaTG13_fast_tree.nwk --date-ci 100 -o bat/Yunnan/RaTG13/2013 -nt AUTO -alrt 1000 -keep-ident -m GTR ", "Hi Santiago, Yes it looks like a bug when calculating confidence interval. Does it work without the option - - date-ci? I can try to detect where the bug comes from but I need the data you\u2019ve used for the dating step (the tree inferred by iq-tree and the date file). You can send them to me toth...@gmail.com if possible. Best regards, Hien You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ccfe53ce-66f8-4f15-b050-fc8e87194805n%40googlegroups.com ", "Hi Hien, Just some observation, that might help when debugging: this data set has n=69K sequences. n^2 is 4.7 billion, which exceeds the upper bound of int in C/C++. So if you have some int variable in the code, it will cause numerical overflow for any operations with n^2 or so. In IQ-TREE we did a lot (actually James) to change all int to int64_t (64-bit), which will avoid this problem. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAKjtwTxMWvp_O%3Di9gJoRib%2BMZpp%3Ds3uKq5v4fFs9qkr1rCnuOg%40mail.gmail.com "]}, "_xGKCr4g3BQ": {"topic": "Booster BS measure", "initializeDate": "May 24, 2018, 2:10:39 PM", "timeStamp": "May 25, 2018, 2:57:46 AM", "content": ["Dear Minh, do you plan in the near future also to implement the transfer bootstrap measure as recently published here https://www.nature.com/articles/s41586-018-0043-0 Anyways since its an own tool maybe there is no need / not so relevant as it can run by itself with e.g. BS trees from e.g. IQtree... Best, Karen ", "Dear Karen, currently if I want to the TBE support values I use the booster program or website on a set of (e.g. UFBoot) trees and a reference tree. There is the idea to incorporate that into IQ-Tree and Olivier already suggested to use their Booster-code directly in IQ-Tree. However, incorporating that code directly into IQ-Tree is not trivial, because the way IQ-Tree and Booster store the underlying tree set information in different ways. Thus, for the moment I suggest to use Booster itself. Best wishes, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Hi Heiko, Since the tree data structures are different between IQ-TREE and Booster, would it be easier to import Booster code as it is into IQ-TREE, and then write a wrapper function that calls Booster with .treefile and .boottrees file as input, then output another tree file? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "Yw345V-JIYU": {"topic": "IQTREE 1.5.4 crach mpi on cluster \"Tree logl gets worse after model optimization\"", "initializeDate": "Jul 12, 2017, 9:29:42 AM", "timeStamp": "Jul 18, 2017, 4:50:43 AM", "content": ["To whom it may concern, I launched IQTREE 1.5.4 MPI version on my cluster with -sp option. During optimisation it crash with a bug \"Tree logl gets worse after model optimization\". cmd line : /mount/gensoft2/exe/IQ-TREE/1.5.4/bin/iqtree-mpi -s concatenated_alignment_tadB_pilB.phy -sp concatenated_alignment_tadB_pilB.nex -st AA -pre concatenated_tree_tadB_pilB -bb 1000 -alrt 1000 -nm 8000 ``` Iteration 60 / LogL: -496754.283 / Time: 1h:3m:37s (1h:42m:25s left) / Process: 22 Estimate model parameters (epsilon = 0.100) BUG: Tree logl gets worse after model optimization! Old logl: -496754.283 / new logl: -501356.341 *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: /pasteur/homes/rdenise/These/Analyses/Analysis_choose_paralogs/20170711/tree/tree_system/MAFFT/tadB_pilB/concatenated_tree_tadB_pilB.log *** Alignment files (if possible) ``` Is it my nexus file or is it a bug of IQTREE known or not ? All the best R\u00e9mi Denise ", "Dear Remi, Thanks for reporting. Your nexus file looks fine. It seems like a bug associated with MPI version\u2026 were you able to run this with the multicore (non-MPI) version? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <concatenated_tree_tadB_pilB_anonym.log> <concatenated_alignment_tadB_pilB.nex> <concatenated_alignment_tadB_pilB.phy> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "zNAwoOyWIvI": {"topic": "Failure message IQTree CIBIV, Austria Webserver", "initializeDate": "Oct 12, 2020, 11:10:11 PM", "timeStamp": "Oct 23, 2020, 2:58:18 PM", "content": ["Hi Minh, I have been trying to use the CIBIV, Austria Webserver for running analysis. However, I am constantly receiving a failure message saying 'Too many submissions, please wait a second and try again'. I am attaching the screenshot of failure message herewith for your kind reference. The size of the nucleotide sequence matrix which I am uploading is of 700bp only. While attempting to run the analysis, i noticed that the server load was between 5-8%. Please help me with this. Best regards Ranjana ", "Hi Ranjana, Quick answer: please provide an email before submitting your jobs, and this error will be gone. Currently the web server does not work without an email, and we don\u2019t know why because of limited human resource to maintain the web server. Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/aa5e10b3-cdee-4be0-bf55-5199295ed660n%40googlegroups.com <Screen Shot 2020-10-13 at 8.29.09 AM.png> ", "Thanks a lot. It worked!! Best regards Ranjana ", "Hi Minh, I get the same error message, but I am also providing my email before submitting the job. Is there any other way around this? Thanks! Dietrich "]}, "diM3jFJYX3k": {"topic": "IQTREE 1.5.3 MPI version crash on cluster", "initializeDate": "Mar 24, 2017, 11:59:43 AM", "timeStamp": "Mar 24, 2017, 6:51:37 PM", "content": ["To whom it may concern, When I want to use iqtree-mpi on cluster but when I launch the command, iqtree crash before the model test. Is it normal ? Is the 1.5.3 version of iqtree-mpi could launch the model test ? Here my command line : ``` mpirun iqtree-mpi -s \"ATPase_noisy/ATPase_aligned_out.fas\" -st AA -pre \"ATPase/tree_ATPase\" -bb 1000 -alrt 1000 -nm 5000 -m TESTNEW ``` And here the backtrack of the error extract from the core file of openmpi : ``` #0 0x0000000000504284 in errstreambuf::overflow(int) () #1 0x00007f314a03348a in std::basic_streambuf<char, std::char_traits<char> >::sputc (__c=10 '\\n', this=<optimized out>) at /tmp/build/x86_64-unknown-linux-gnu/libstdc++-v3/include/streambuf:434 #2 std::ostream::put (this=this@entry=0xaa59c0 <std::cerr>, __c=<optimized out>) at /tmp/build/x86_64-unknown-linux-gnu/libstdc++-v3/include/bits/ostream.tcc:163 #3 0x00007f314a0336bf in std::endl<char, std::char_traits<char> > (__os=...) at /tmp/build/x86_64-unknown-linux-gnu/libstdc++-v3/include/ostream:565 #4 0x00000000004f60e1 in funcAbort () #5 <signal handler called> #6 0x0000000000504284 in errstreambuf::overflow(int) () #7 0x00007f314a03c515 in std::basic_streambuf<char, std::char_traits<char> >::xsputn (this=0xaa5c00 <_err_buf>, __s=0x7d6422 \"ERROR: \", __n=7) at /tmp/build/x86_64-unknown-linux-gnu/libstdc++-v3/include/bits/streambuf.tcc:98 #8 0x00007f314a033956 in std::basic_streambuf<char, std::char_traits<char> >::sputn (__n=7, __s=0x7d6422 \"ERROR: \", this=<optimized out>) at /tmp/build/x86_64-unknown-linux-gnu/libstdc++-v3/include/streambuf:451 #9 std::__ostream_write<char, std::char_traits<char> > (__n=7, __s=0x7d6422 \"ERROR: \", __out=...) at /tmp/build/x86_64-unknown-linux-gnu/libstdc++-v3/include/bits/ostream_insert.h:50 #10 std::__ostream_insert<char, std::char_traits<char> > (__out=..., __s=0x7d6422 \"ERROR: \", __n=7) at /tmp/build/x86_64-unknown-linux-gnu/libstdc++-v3/include/bits/ostream_insert.h:101 #11 0x000000000059027f in outError(char const*, bool) () #12 0x000000000051f831 in initializeParams(Params&, IQTree&, std::vector<ModelInfo, std::allocator<ModelInfo> >&, ModelsBlock*) () #13 0x0000000000526c9c in runTreeReconstruction(Params&, std::string&, IQTree&, std::vector<ModelInfo, std::allocator<ModelInfo> >&) () #14 0x0000000000530808 in runPhyloAnalysis(Params&, Checkpoint*) () #15 0x0000000000506e7d in main () ``` And the log file of Iqtree and the sequence data used [I use a link google drive because the file is to big for this message( https://drive.google.com/open?id=0B85PXClmUilmdzN2anBrdFBYcFE Thank you for your help R\u00e9mi PS : is you want all the information of the core file I could send you it. ", "Dear Remi, the log file shows an error message: \"ERROR: Please use only 1 MPI process! We are currently working on the MPI parallelization of model selection.\" So model selection does not work with MPI yet. However, you can perform the analysis in 2 steps: first do model selection with just 1 MPI process, and then for the subsequent analysis you can use the MPI version using the chosen model. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <tree_ATPase.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "KCSjCr5C-I4": {"topic": "IQTree 1.3.13 crashes during tree search with partitioned dataset", "initializeDate": "Feb 11, 2016, 10:13:51 AM", "timeStamp": "Feb 16, 2016, 3:19:47 AM", "content": ["Hi all, I am trying to construct a tree using partitioned scheme and model by codon. At every attempt to run, it crashes after few minutes. Command line: iqtree-omp -s citri_67_taxons_aln.phy -spp partition_PF.nex -nt 3 -vvv -bb 1000 -numpars 500 -toppars 200 -numcand 100 It is running on a server with 1TB RAM and 80 cores. Please, find bellow the log file. https://drive.google.com/file/d/0B2w8d6nWlwqKeXU2YXdnVlVBdTA/view?usp=sharing Any idea about what should be happening? Best regards, Joaquim ", "Hi Joaquim, Thanks for the report. The crash looks weird, but I could not see what the problem was from the log file. Therefore can you pls send me your input data files via personal email? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Unfortunately, my supervisor did not allowed me to send the dataset to you. We performed the same run with the same dataset using Windows version 1.3.12 and it ends ok! Now we will try Windows version 1.3.13. Maybe It could be a bug on linux version...? Thank you for helping. Best regards, Joaquim You received this message because you are subscribed to a topic in the Google Groups \"IQTREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/KCSjCr5C-I4/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Joaquim Martins Jr, Ph.D. Postdoctoral Fellow at LBI | IQ | USP Biologist - CV Lattes: http://lattes.cnpq.br/5170263061293078 Personal site: http://martinsjr.me Linkedin: http://br.linkedin.com/in/jmartinsjr/en -------------------------------------------------------------------------------------- LBI - Laboratory of Bioinformatics | http://lbi.iq.usp.br Instituto de Qu\u00edmica - IQ / USP Av. Prof. Lineu Prestes, 748 - Butant\u00e3, CEP: 05508-000, S\u00e3o Paulo-SP, Brazil Tel.: 55-11-3091.9162; Cel: 55-11-8708.2628 (TIM) Skype: joaquim.martins.jr ---------------------------------------------------------------------------------------------------- ", "Dear Joachim, as it turned out the crash was likely due to -vvv option (verbose mode). This option prints many messages to the screen (or log file) from many threads, which may at some point interfere which each other. Therefore I recommend NOT to use this option, unless for debugging purpose sometimes. Cheers, Minh "]}, "gnUBB0ml5Og": {"topic": "Bug:  splitgraph.h:235", "initializeDate": "Apr 27, 2020, 10:58:07 AM", "timeStamp": "May 6, 2020, 1:01:41 PM", "content": ["I am trying to run ultrafast bootstrapping with partition model and after creating bootstrap support values it crashes. Command: iqtree -s ./sample.phy -spp ./char.nex -m MFG -bb 1000 -bi 100 -minsup 0.5 It crashes in the same way with or without \"-bi 100 -minsup 0.5\" Attached you should find the log, alignment and the partition scheme. Cheers, ", "Hi Robert, The problem is -m MFG. It should have been \u201c-m MFP\u201d. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c2c68749-5d8e-4033-97f0-4ad1d391d264%40googlegroups.com <Raxml.nex.log> <Nucleotide alignment.phy> <Raxml.nex> ", "Thanks! Cheers, RED Ph.D. Candidate Bracken-Grissom Lab (MSB-330) Florida International University Biscayne Bay Campus Crustomics: Crustacean Genomics and Systematics Lab brackengrissomlab.com "]}, "ijxQ2Uv55Zs": {"topic": "bootstrap supports are 100% in all nodes  for long phylogenomic alignments", "initializeDate": "Dec 15, 2018, 9:53:02 PM", "timeStamp": "Dec 18, 2018, 2:55:44 PM", "content": ["Dear Iqtree developers an users I am running a iqtree for a long phylogenomic alignment. I get my alignment by concatenating the core orthogroups resulted from orthofinder output. I have a total of 16 nodes and all are 100% supported. However If make a tree with genes from the same orthogroups(short alignment) , the bootstrap supports vary so much. my problem is that , I never see yet in any paper were all nodes are 100% supported. Please do you think that this tree could confidently used and reported ? my analysis , is it wrong ? Note that I have the same results with Iqtree,raxml and Mrbayes. Thanks for your support. Regards ", "Dear Dieunel, In fact 100% BS values are not uncommon for phylogenomic alignments and that\u2019s exactly why we suggested to look at concordance factors. Please have a a look at an excellent blog post by Rob Lanfear: http://www.robertlanfear.com/blog/files/concordance_factors.html Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Minh Thank you very much for your reply and for sharing this blog post that is very useful for me. In this case when get 100% BS values for all nodes do you think that I should report the gCF and sCF as presented in the tree is in this post ? Cordially -------------------------- Derilus Dieunel Graduate Student Department of Environmental Sciences University of Puerto Rico, R\u00edo Piedras ", "My response would be that it depends a lot on what type of organism you are analyzing. The genomes of mammals are quite a bit different than the genomes of bacteria, for example. And analyzing the genomes of two Asian humans, two South African native humans and two South American native humans would give different types of results, than analyzing the genomes of one human 2 chimpanzees, 2 gorillas and one of each of a a few other great apes and non-human primates. For some organisms, humans have spent a great deal of effort defining what a \"species\" is, and form some organisms the species boundaries are clear-cut for good biological reasons. But for many other organisms, there is no clear boundary between \"species\" and/or there are biological reasons why there is copious gene flow between fairly well-defined groups where the concept of \"species\" does make sense. If 95 to 99% of the human genome is clearly closer to chimpanzee than to gorilla then bootstrapping should give 100% support for ((human, chimp)gorilla) because there are genes or regions of the genome where human is closer to gorilla, more than random points evenly distributed where human is closer to gorilla. Bootstrapping randomly samples from the alignment. Building gene trees, or sampling different types of data (mitochondria, MHC alleles, etc) is not the same as bootstrapping. For mammals and many other types of eukaryotes there are a few different reasons for gene trees being different than species trees. Some is due to incomplete lineage sorting, some is due to introgression, some is due to horizontal gene transfer, some is due to very odd selection pressures. For bacteria, most of the problem is said to be from horizontal gene transfer by phages, plasmids, and random DNA uptake. For many organisms, the difference between 100% bootstrap support and less bootstrap support is due to sampling. For example, if we leave gorillas out of the human, chimpanzee, other primate analyses, we get 100% support for human/chimpanzee. The same would be true if the gorillas had gone extinct, or if gorillas had split from the (gorilla/chimpanzee/human) common ancestor ten or twenty million years earlier than they did. For many organisms, we have very bised samplling. For example we have a lot of E.coli sampled from human and domesticated animal sources and not so much from marine mammals or Tibetan shrews or other sources that humans are less interested in. For viruses we tend to focus on human and domestic animal pathogens and to ignore the viruses that have little or no economic impact on humans. ", "Even within a small group like the mammals or the insects, different groups (families, genera, whatever) have different propensity for being genetically isolated or not. Birds and bats and flying insects for example are less prone to being cut off by a geographic boundary such as a river or mountain range. Solitary animals like cats have different mating habits than herd animals like deer. All of these things influence how cleanly one group of organisms splits off from the rest of its tribe to found a new species. On Monday, December 17, 2018 at 2:43:20 PM UTC-7, Brian Foley wrote: My response would be that it depends a lot on what type of organism you are analyzing. The genomes of mammals are quite a bit different than the genomes of bacteria, for example. .. ", "Thanks for all these details. Then in my case, I am working with Photosynthetic Picoeukaryotes (PPE) species and some microalgae. This is polyphyletic groups I would not expect 100 % BS support for all nodes. I am also involved in another project of comparative genomics of apicomplexan (40 species) , we are getting the same results, all nodes have 100 BS values. Please do know one or phylogenomic papers that present trees with all nodes supported at 100% ? this will be very useful for me. Note that I am a PhD student Environmental Sciences, I am new in this field and I am trying to understand my results in mores details. -------------------------- Derilus Dieunel Graduate Student Department of Environmental Sciences University of Puerto Rico, R\u00edo Piedras ", "I do not know of a paper with trees showing 100% bootstrap support of all nodes, but I would not find it surprising to see such a paper if I looked for one. I am not a big fan of bootstrap values, but they are useful in some cases. I don't know anything about Photosynthetic Picoeukaryotes, but it seems they would include organisms such as diatoms which have been evolving for quite a long time and hence could have a lot of diversity. It also seems likely that most species or lineages would not go through many \"genetic bottlenecks\" with population sizes reduced to just a few individuals. The wikipedia article on diatoms says they are diploid most of the time and form sperm and egg haploid cells sometimes which is a bit different than fungi typically which spend more of their time in the haploid state. Wikipedia says there are more than 100,000 species of diatoms, which is not surprising for a group of organisms with an ancient history. It is more like studying all bilateria, than like studying mammals or insects, each if which is a more recent \"crown group\" evolved out of bilateria. If someone made a phylogenetic tree using the genomes of one bee, one ant, one butterfly, one turtle, one snake, and one mammal I would expect 100% bootstrap support for all nodes. A tree that analyzes the complete genomes of mammals including 100 species of gazelles and antelopes, and 45 species of deer will have many nodes with low bootstrap support. Within a recently evolved group of the bilateria such as the vertebrates, there are many clades such as tetrapods, and within the tetrapods there are clades such as the amphibians and the mammals which are each very clearly monophyletic with 100% bootstrap support. Most of this agrees with the fossil record and we can understand why the \"tree\" of vertebrate life has major branches. I am guessing that organisms like diatoms are more difficult to distinguish as major branches based on fossils, so it is more difficult to know what to expect their tree to look like. ", "Thank you for this detailed explanation. Yu are right, the micro algae and Phoptosynthetique picoeukaryotes are polyphyletic groups. Then, high BS values output for phylogenomic tree could be discussed. Thanks again for your assistance, this was very appreciated Cordially -------------------------- Derilus Dieunel Graduate Student Department of Environmental Sciences University of Puerto Rico, R\u00edo Piedras On Tue, Dec 18, 2018 at 5:35 AM Brian Foley < brianf...@gmail.com > wrote: I do not know of a paper with trees showing 100% bootstrap support of all nodes, but I would not find it surprising to see such a paper if I looked for one. I am not a big fan of bootstrap values, but they are useful in some cases. I don't know anything about Photosynthetic Picoeukaryotes, but it seems they would include organisms such as diatoms which have been evolving for quite a long time and hence could have a lot of diversity. It also seems likely that most species or lineages would not go through many \"genetic bottlenecks\" with population sizes reduced to just a few individuals. The wikipedia article on diatoms says they are diploid most of the time and form sperm and egg haploid cells sometimes which is a bit different than fungi typically which spend more of their time in the haploid state. Wikipedia says there are more than 100,000 species of diatoms, which is not surprising for a group of organisms with an ancient history. It is more like studying all bilateria, than like studying mammals or insects, each if which is a more recent \"crown group\" evolved out of bilateria. If someone made a phylogenetic tree using the genomes of one bee, one ant, one butterfly, one turtle, one snake, and one mammal I would expect 100% bootstrap support for all nodes. A tree that analyzes the complete genomes of mammals including 100 species of gazelles and antelopes, and 45 species of deer will have many nodes with low bootstrap support. Within a recently evolved group of the bilateria such as the vertebrates, there are many clades such as tetrapods, and within the tetrapods there are clades such as the amphibians and the mammals which are each very clearly monophyletic with 100% bootstrap support. Most of this agrees with the fossil record and we can understand why the \"tree\" of vertebrate life has major branches. I am guessing that organisms like diatoms are more difficult to distinguish as major branches based on fossils, so it is more difficult to know what to expect their tree to look like. "]}, "Co5m83S3vRc": {"topic": "Partitioning by codon syntax", "initializeDate": "May 29, 2019, 5:33:21 PM", "timeStamp": "May 30, 2019, 3:08:37 AM", "content": ["Hi everyone, I wonder if there is a good way to simplify the syntax for partitioning by codon when one has hundreds or thousands of alignments. Instead of looking up the length of each alignment, to use a wildcard character for the alignment length. I think the syntax below, with a `dot` as a placeholder for the length of the alignment, worked in Paup and MrBayes, but doesn't in IQTree (integer is required). Are there any tricks for doing something similar in IQTree? If not, can a feature like this be implemented. #nexus begin sets; charset part1 = 1-.\\3; charset part1 = 2-.\\3; charset part1 = 3-.\\3; ... end; Thanks, Teo ", "Hi Teo, This syntax is not supported in IQ-TREE (actually I was not aware of it). But it\u2019s a reasonable request. I created a github issue as a reminder to implement it. https://github.com/Cibiv/IQ-TREE/issues/100 Thanks! Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/64ca7995-df3c-4936-9568-4b20d538bc38%40googlegroups.com For more options, visit https://groups.google.com/d/optout "]}, "rMSDs6i0Vg8": {"topic": "Error when compiling the MPI version under Linux", "initializeDate": "Oct 13, 2020, 8:55:44 AM", "timeStamp": "Oct 15, 2020, 11:19:44 PM", "content": ["Hi IQ-TREE, I have some problems when compiling the MPI version. Below is what I tried. module load openmpi/4.0.4 git clone https://github.com/iqtree/iqtree2.git cd iqtree2 mkdir build cd build export CC=/local/software/openmpi/4.0.4/gcc/bin/mpicc export CXX=/local/software/openmpi/4.0.4/g++ cmake -S /scratch/yw14n20/soft/iqtree2 -DEIGEN3_INCLUDE_DIR=/local/software/eigen/3.2.10/include/eigen3/ -DIQTREE_FLAGS=mpi -DCMAKE_C_COMPILER=mpicc -DCMAKE_CXX_COMPILER=mpicxx make -j4 and then it gave this error. Scanning dependencies of target phyloYAML [ 56%] Building CXX object utils/CMakeFiles/decentTree.dir/gzstream.cpp.o [ 57%] Building CXX object phylo-yaml/CMakeFiles/phyloYAML.dir/statespace.cpp.o /scratch/yw14n20/soft/iqtree2/utils/gzstream.cpp: In member function ' virtual int gzstreambuf::underflow() /scratch/yw14n20/soft/iqtree2/utils/gzstream.cpp:125:27: error: gzoffset ' was not declared in this scope compressed_position = gzoffset (file); ^~~~~~~~ /scratch/yw14n20/soft/iqtree2/utils/gzstream.cpp:125:27: note: suggested alternative: ' gzclose compressed_position = gzoffset (file); ^~~~~~~~ gzclose make[2]: *** [utils/CMakeFiles/decentTree.dir/gzstream.cpp.o] Error 1 make[1]: *** [utils/CMakeFiles/decentTree.dir/all] Error 2 make[1]: *** Waiting for unfinished jobs.... [ 57%] Building CXX object utils/CMakeFiles/utils.dir/eigendecomposition.cpp.o [ 58%] Building CXX object utils/CMakeFiles/utils.dir/gzstream.cpp.o [ 58%] Building CXX object alignment/CMakeFiles/alignment.dir/pattern.cpp.o /scratch/yw14n20/soft/iqtree2/utils/gzstream.cpp: In member function ' virtual int gzstreambuf::underflow() /scratch/yw14n20/soft/iqtree2/utils/gzstream.cpp:125:27: error: gzoffset ' was not declared in this scope compressed_position = gzoffset (file); ^~~~~~~~ /scratch/yw14n20/soft/iqtree2/utils/gzstream.cpp:125:27: note: suggested alternative: ' gzclose compressed_position = gzoffset (file); ^~~~~~~~ gzclose make[2]: *** [utils/CMakeFiles/utils.dir/gzstream.cpp.o] Error 1 make[2]: *** Waiting for unfinished jobs.... [ 58%] Building CXX object alignment/CMakeFiles/alignment.dir/alignment.cpp.o make[1]: *** [utils/CMakeFiles/utils.dir/all] Error 2 [ 59%] Building CXX object alignment/CMakeFiles/alignment.dir/alignmentpairwise.cpp.o [ 59%] Building CXX object alignment/CMakeFiles/alignment.dir/alignmentsummary.cpp.o [ 59%] Building CXX object alignment/CMakeFiles/alignment.dir/maalignment.cpp.o [ 59%] Linking CXX static library libphyloYAML.a [ 59%] Built target phyloYAML [ 60%] Building CXX object alignment/CMakeFiles/alignment.dir/superalignment.cpp.o [ 60%] Building CXX object alignment/CMakeFiles/alignment.dir/superalignmentpairwise.cpp.o [ 61%] Building CXX object alignment/CMakeFiles/alignment.dir/superalignmentpairwiseplen.cpp.o [ 61%] Building CXX object alignment/CMakeFiles/alignment.dir/superalignmentunlinked.cpp.o /scratch/yw14n20/soft/iqtree2/alignment/alignment.cpp:3391:92: warning: dynamic exception specifications are deprecated in C++11 [ -Wdeprecated void convert_range(const char *str, int &lower, int &upper, int &step_size, char* &endptr) throw (string) { ^~~~~ [ 61%] Linking CXX static library libalignment.a [ 61%] Built target alignment make: *** [all] Error 2 Could you give me some suggestions on how to address this? Thank you in advance! Kind regards, ", "Hi Yi. gzoffset() is a function in zlib (the library that provides support for reading and writing .gz files). It was added in version 1.2.5 of zlib. IQTree comes with the headers for version 1.2.7. But, if your Operating System has another version of zlib installed, IQTree will use the Operating System's version instead. That might too old (or it might even be too new!) . You might be able to get the compile to work by passing nozlib in IQTREE_FLAGS. Like this (hopefully the extra bit will appear in red)... cmake -S /scratch/yw14n20/soft/iqtree2 -DEIGEN3_INCLUDE_DIR=/local/software/eigen/3.2.10/include/eigen3/ -DIQTREE_FLAGS=mpi ,nozlib -DCMAKE_C_COMPILER=mpicc -DCMAKE_CXX_COMPILER=mpicxx I can't say for sure whether that will work (as I've only ever built IQTree under Mac OS and Windows). But it might. Failing that, perhaps installing a different version of zlib will do the trick. Regards, James You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f3d678cd-67ff-42a9-b3f9-f5daab3b3aadn%40googlegroups.com ", "Hi James, It worked!!! Thank you so much! Best wishes, "]}, "3ODiCpvB-hY": {"topic": "mrate E, F", "initializeDate": "Sep 21, 2017, 10:40:53 AM", "timeStamp": "Sep 22, 2017, 10:28:07 AM", "content": ["Hello, I don't want to allow for invariant sites +I option, so I am using --mrate G,R. But the E option is not described in the manual. What does it refer to? Also, the result of a preliminary run had some models chosen +F. What option is that? Thank you, Tauana ", "Dear Tauana, E stands for Equal rate model. We will add this to the manual, thanks. +F is explained in the manual: Empirical state frequency observed from the data. http://www.iqtree.org/doc/Command-Reference#specifying-substitution-models Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thank you, Minh! "]}, "igHocLoPJPY": {"topic": "Run is finished but log file not updated", "initializeDate": "Aug 5, 2016, 4:10:18 AM", "timeStamp": "Aug 5, 2016, 10:43:57 AM", "content": ["Dear IQtree team, For my standard bootstrap analysis, I noticed that my .iqtree file seemed to have all the information about the run (including a time stamp at the end indicating the end of the run), however the .log file has not been updated since the run started, judging by the time stamps. This was not the case for the same alignment run with the ultra fast bootstraps. Please see below for the command I ran, and the time stamps of the output files. Do you think this indicates that the program crashed before it could write to the log? Or perhaps it is just a small bug in the program. Thank you for your time! Courtney COMMAND:: iqtree-omp -s PFO_N233_030816_ma_selection_go.fasta -seed 1987 -nt 8 -v -b 100 -m LG+F TIMESTAMPS:: Aug 4 11:28 PFO_N233_030816_ma_selection_go.fasta Aug 4 11:29 PFO_N233_030816_ma_selection_go.fasta.log Aug 5 01:32 PFO_N233_030816_ma_selection_go.fasta.boottrees Aug 5 01:32 PFO_N233_030816_ma_selection_go.fasta.contree Aug 5 01:32 PFO_N233_030816_ma_selection_go.fasta.mldist Aug 5 01:32 PFO_N233_030816_ma_selection_go.fasta.bionj Aug 5 01:41 PFO_N233_030816_ma_selection_go.fasta.treefile Aug 5 01:41 PFO_N233_030816_ma_selection_go.fasta.iqtree Aug 5 01:41 PFO_N233_030816_ma_selection_go.fasta.ckp.gz ", "Dear Courtney, There is no indication that the program crashed\u2026 I have no idea what was going on. Can you repeat this behavior with the same command line on another machine? Just to exclude any possibility that is system-related (not because of IQ-TREE). Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Thanks for your email. I think I have solved the issue. I just tried a 'freshly unzipped' binary and it worked. So I'm not sure what happened. I will let you know if I see this problem again. Thanks for your help! Courtney ------------------------------------ Courtney Stairs, PhD Post-doctoral fellow Laboratory of Dr. Thijs Ettema Institute for Cell and Molecular Biology Uppsala University Sweden "]}, "a_HZxNHVvwM": {"topic": "Re: Constrained search format constrained topology problem", "initializeDate": "Jan 26, 2019, 6:12:48 AM", "timeStamp": "Jan 28, 2019, 8:43:43 PM", "content": ["Hi, Problem fixed with a polytomy for the outgroup. Le vendredi 25 janvier 2019 16:26:36 UTC, nicola...@gmail.com a \u00e9crit : Hello, I want to use iqtree to run constrained tree search for my genes on several topologies constrained monophyly of 5 clades but not relationships within them. I created 15 constrained trees with polytomy within each clade. But when I try to run iqtree i get this error message: ERROR: Redundant double-bracket \u2018((\u2026))\u2019 with closing bracket ending at (line 1 column 3603) I looked at my constrained trees in Figtree and they look correct. I tied an other version and get this error: ERROR: Rooted constraint tree not accepted Do you have an example of the format accepted for the constrained topology? Thank you in advance for the help Best Nicolas ", "Thanks for fixing the problem yourself, good to know that the error message is informative. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "L9NWrY8mHLo": {"topic": "Codon model rate heterogeneity", "initializeDate": "Apr 16, 2018, 11:53:27 AM", "timeStamp": "Apr 17, 2018, 10:47:28 AM", "content": ["I hope the answer to this isn't something obvious that I've missed. Apologies in advance if it is... I was curious about the +I, +G4, and +I+G4 versions of the MG, MGK, and GY models. Specifically, are the rates for codons or for non-synonymous substitutions? I'll illustrate my question with the GY model. I can see two ways for rate heterogeneity to work. First, one could imagine simply treating codons as 61 symbols (assuming the standard code) and then assuming that the rate of change among the 61 symbols is drawn from a gamma distribution (or gamma+invariants). It seems to me that this approach would imply that synonymous rates correlate with non-synonymous rates Alternatively, one could imagine that omega varies among codons but the synonymous rate is constant (I'm honestly not sure if this would work for a MG or MGK model, but I haven't really thought that through). I assume it is the first way (i.e., treat codons as 61 symbols). Also, I don't see any place where omega (or dN/dS) is output when I ran a test with the GY model. I also had the same result when I used -m TEST (the best model for my test dataset was the MGK model). I just wanted to make sure I wasn't confused about exactly what the models are doing. Thanks! ", "Hi Edward, On 17 Apr 2018, at 1:53 am, Edward Braun < ebra...@gmail.com > wrote: I hope the answer to this isn't something obvious that I've missed. Apologies in advance if it is\u2026 I was curious about the +I, +G4, and +I+G4 versions of the MG, MGK, and GY models. Specifically, are the rates for codons or for non-synonymous substitutions? No, the rates are codon substitutions, not just non-synonymous ones. In a nutshell it is similar to GTR+G for DNA models, that you allow nucleotide rates of change to vary across sites. So MG+G or GY+G have exactly the same behaviour, just at codon level. I\u2019m not sure if this was implemented in PAML, probably not because PAML focuses on detecting positively selected sites by varying omega (dN/dS ratio) across sites. But PAML does not use Gamma distribution for omega, right? I'll illustrate my question with the GY model. I can see two ways for rate heterogeneity to work. First, one could imagine simply treating codons as 61 symbols (assuming the standard code) and then assuming that the rate of change among the 61 symbols is drawn from a gamma distribution (or gamma+invariants). Yes! But to be precise, the rates of change between codon sites are drawn from a Gamma distribution, like I explained above. It seems to me that this approach would imply that synonymous rates correlate with non-synonymous rates You are right, it implicitly implies a correlation between these two rates. Alternatively, one could imagine that omega varies among codons but the synonymous rate is constant (I'm honestly not sure if this would work for a MG or MGK model, but I haven't really thought that through). Right, this is exactly a series of codon mixture models in PAML. It does not really matter if GY or MG models are used. Such models are not currently available in IQ-TREE. I assume it is the first way (i.e., treat codons as 61 symbols). Also, I don't see any place where omega (or dN/dS) is output when I ran a test with the GY model. I also had the same result when I used -m TEST (the best model for my test dataset was the MGK model). Omega will be printed for best-fitting model. Or do you mean to output omega for every model tested? (Which is not printed yet). I just wanted to make sure I wasn't confused about exactly what the models are doing. Good questions indeed! Minh Thanks! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Minh -- Thanks so much! This really cleared things up I found that the values for omega and kappa in the <prefix>.log file. I have to admit that I was looking for the <prefix>.iqtree file so I was also a bit confused about that. That was part of what was making me wonder if I wasn't missing something fundamental in how you were implementing the codon models. I asked this this for a course I'm teaching where one of my assignments is conducting analyses of phage coding regions that the students annotated. I'm having them estimate trees from all of the coding regions with clear homologs and wanted them to generate trees using both standard nucleotide models and codon models. IQ-TREE runs quickly enough for the students to use it on datasets of the size they are working with so I wanted them to learn that program. But I wanted to make sure I understand the codon model implementations before explaining them! Best, "]}, "DE287eXFAoA": {"topic": "Phylip file not imported", "initializeDate": "May 20, 2020, 12:20:33 AM", "timeStamp": "May 27, 2020, 3:50:42 PM", "content": ["Hi, I have a phylip file that I created from a .vcf using vcf2phylip. Raxml will read the file but iqtree will not? Any suggestions? ", "Hi there, We can\u2019t really help with such little information. Can you please provide details. E.g., what is the error message in IQ-TREE log file? In any case the phylip format is quite straightforward. So please check your alignment file directly, to make sure that it conforms with the format. Cheers, Minh On 20 May 2020, at 2:20 pm, Barbara Binney < 5apt...@gmail.com > wrote: Hi, I have a phylip file that I created from a .vcf using vcf2phylip. Raxml will read the file but iqtree will not? Any suggestions? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/fbbd4aa8-2f71-4f80-a170-a11e47b8e93a%40googlegroups.com ", "Hi Minh, Thank you for your reply. Please find attached the IQ-TREE log. The .phy file is a bit too big for an email. ", "Dear Barbara, Thanks for sending the log file. With this it was easy to figure out the problem. According to the log file you started iqtree with iqtree core.min4.phy -nt AUTO This means, you provided the PHYLIP files without the flag -s (=sequence data). Without that IQTREE tries to figure out what the file might contain, but does not expect an alignment. Please try again with: iqtree -s core.min4.phy -nt AUTO that should work well. @Minh: maybe we could make the message a bit more informative ;) Cheers, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/38645396-2B94-4048-B28B-BA432F44A93A%40gmail.com > <core.min4.phy.log> > Cheers > Barbara > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/38645396-2B94-4048-B28B-BA432F44A93A%40gmail.com ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Dear Heiko and Minh, Thank you for your help. I am sorry my first email was incomplete because I accidentally sent it before I had finished preparing it. Cheers Barbara > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9DF8965F-9F0A-4B9A-BD42-22807C5A4586%40univie.ac.at "]}, "mesZUD0rIB0": {"topic": "iqtree error double free or corruption (fasttop)", "initializeDate": "Jun 1, 2020, 1:36:38 PM", "timeStamp": "Jun 8, 2020, 8:41:24 PM", "content": ["I'm attempting to calculate concordance factors using ~5500 gene alignments in a single directory using the new '-S' option; however, in the middle of model parameter estimation IQTREE errors out with a 'double free or corruption (fasttop)' error. I'm wondering if this has to do with the program attempting to use more memory than has been allocated to me on the server. I tried using the '-mem' option to limit this but it is apparently does not work with partition models yet. Is there any way around this or should I just run this in a 'for loop'? Or does this indicate a problem with one or more of my alignments? ", "Can you pls send me the log file? Note that -mem option does not work with partition models or this -S option. I suggest that for the moment, do the \u2018for loop\u2019. -S option is relatively new and I can\u2019t guarantee that it works with every other option. Say for example, IQ-TREE had 100 options. so there are 2^100 combinations of options. By adding a single new option, this increases to 2^101 combinations\u2026 hence imposible to test every combination. Cheers Minh On 2 Jun 2020, at 3:36 am, 'Noah Gettle' via IQ-TREE < iqt...@googlegroups.com > wrote: I'm attempting to calculate concordance factors using ~5500 gene alignments in a single directory using the new '-S' option; however, in the middle of model parameter estimation IQTREE errors out with a 'double free or corruption (fasttop)' error. I'm wondering if this has to do with the program attempting to use more memory than has been allocated to me on the server. I tried using the '-mem' option to limit this but it is apparently does not work with partition models yet. Is there any way around this or should I just run this in a 'for loop'? Or does this indicate a problem with one or more of my alignments? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/170f77a2-02c3-46d4-be74-3cc5f3c3920f%40googlegroups.com ", "Sure, the log file and the stderr output are attached. Also for reference, the command used to generate these was 'iqtree2 -S $outdir/gene.aln --prefix loci -T 16'. You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/mesZUD0rIB0/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4C89DD55-59F5-48C7-A0F4-FB3F57B50362%40univie.ac.at Noah Gettle University of Minnesota Ecology, Evolution, and Behavior PhD Program ", "Hi Noah, There are a number of genes with just 3 sequences, such as (from the log file): 3370 448 364 YPS128_G0025540.aln.fa Does it work if you remove all these alignments, and only keep those with 4 or more sequences? Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAFgqaV-QrmqJ5SKDqQZ7nDNdmJZ-bOFXqSu1z-xq_YiYQGKZzg%40mail.gmail.com <stderr> <loci.log> ", "Still no luck. Got the same error. To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4E0C4F74-B8A2-48DC-A1B2-D253C9CE942B%40univie.ac.at ", "Ok, then pls switch to the \u2018for loop\u2019 approach. Right now we don\u2019t have resource to fix this, sorry. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAFgqaV_o4xTEoSxN8GOXs1LX8AYjy_-SLwDB7ob9vo9i1i9RMQ%40mail.gmail.com <stderr> <loci.log> "]}, "0MXLokuMGnY": {"topic": "-mset mrbayes FILE NOT FOUND", "initializeDate": "Apr 30, 2020, 11:03:59 AM", "timeStamp": "May 7, 2020, 4:28:54 AM", "content": ["Hello, Thanks for IQTree, great programme with fantastic documentation. I'm getting an error message when trying to limit model testing to the mrbayes models using -mset mrbayes. My command is as follows: iqtree \\ -spp my_partition.nex \\ -m TESTMERGEONLY \\ -mset mrbayes \\ -nt 9 And the ERROR message is simply: ERROR: File not found mrbayes When I remove the -mset argument it works perfectly. I've run IQTree v1.6.12 on both an HPC cluster (not installed by me) and my laptop and get the same error. Also get the same error when changing mrbayes to raxml or phyml. Many Thanks, Theo Llewellyn ", "Hi Theo, I just checked \u2014 everything works well on my test example alignment\u2026 So pls send me the log file. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/22503ddc-ef91-4f24-a5a8-2176cd69bd73%40googlegroups.com ", "Hi Minh, I sent it to your email. Thanks, Theo On Wednesday, May 6, 2020 at 2:33:30 AM UTC+1, Minh Bui wrote: Hi Theo, I just checked \u2014 everything works well on my test example alignment\u2026 So pls send me the log file. Cheers Minh On 1 May 2020, at 1:03 am, Theo Llewellyn < T.Lle...@kew.org > wrote: Hello, Thanks for IQTree, great programme with fantastic documentation. I'm getting an error message when trying to limit model testing to the mrbayes models using -mset mrbayes. My command is as follows: iqtree \\ -spp my_partition.nex \\ -m TESTMERGEONLY \\ -mset mrbayes \\ -nt 9 And the ERROR message is simply: ERROR: File not found mrbayes When I remove the -mset argument it works perfectly. I've run IQTree v1.6.12 on both an HPC cluster (not installed by me) and my laptop and get the same error. Also get the same error when changing mrbayes to raxml or phyml. Many Thanks, Theo Llewellyn You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Ok, It turned out that you have a partition model with mixed DNA and codon alignments. And \"-mset mrbayes\" does not work with codon data, causing the error message. This option only works with DNA and protein data. Cheers Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/121949f4-a631-46c0-9e39-5f88467a46ea%40googlegroups.com ", "Hi Minh, I see, thanks for your help. Much appreciated. Cheers, Theo To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/121949f4-a631-46c0-9e39-5f88467a46ea%40googlegroups.com "]}, "x45OhVTOLl0": {"topic": "iqtree crash after multi-threading strategy over partitions", "initializeDate": "Aug 30, 2020, 11:45:06 AM", "timeStamp": "Aug 31, 2020, 1:07:00 AM", "content": ["Hi there, This is the first time I experience a problem while setting partitions and its models and running iqtree. The difference now is that my partitions contains DNA and PROT. Basically iqtree run normally until \"multi-threading strategy over partitions\", then after some time, it just crash with no signal, and only with files of core.* in my cluster. Here is my partition scheme: #nexus begin sets; charset part1 = gene1: 1-117; charset part2 = gene2: 1-1346; charset part3 = gene3: 1-1077; charset part4 = gene4: 1-230; charset part5 = gene5: 1-728; charset part6 = gene6: 1-569; charset part7 = gene7: 1-98; charset part8 = gene8: 1-510; charset part9 = gene9: 1-51; charset part10 = gene10: 1-312; charset part11 = gene11: 1-168; charset part12 = gene12: 1-379; charset part13 = gene13: 1-226; charset part14 = gene14: 1-353; charset part15 = gene15: 1-456; charset part16 = gene16: 1-259; charpartition mine = mtMet+G4: part1, GTR+F+R3: part2, GTR+F+I+G4: part3, mtMAM+I+G4: part4, TIM3+F+I+G4: part5, mtMet+F+I+G4: part6, mtMet+I+G4: part7, mtZOA+I+G4: part8, mtMet+G4: part9, mtMet+F+I+G4: part10, mtInv+I+G4: part11, mtZOA+I+G4: part12, mtMet+I+G4: part13, mtVer+F+I+G4: part14, mtMet+F+R3: part15, mtMAM+I+G4: part16; end; Any help will be greatly appreciated, thanks ", "I am aware the partitions overlap, but when I edit the partition without overlaping, I got and error of \"Too large site ID\" ", "an update on this, after I reorder the partition scheme so the DNA partition comes after the PROT partition, I got an error related to the model: \"Unknown command GTR\" (on the old part2 partition) ", "OK, the problem is related to the IQ-tree version 2. I manage to make my analysis work with the version 1.6.10. "]}, "awx7wjxkoS0": {"topic": "Error: unable to process alignment for PMSF model", "initializeDate": "Jun 11, 2020, 4:14:02 AM", "timeStamp": "Jun 12, 2020, 6:02:18 PM", "content": ["Hi to all! I tried to trainthe PMSF model for my alignments and obtained the same error messages for all files: iqtree -nt AUTO -s cox2.G10.fas -m LG+C20+F+G -ft MEGAtree_mtREV_F.newick -n 0 ERROR: phylotreepars.cpp:63: void PhyloTree::computePartialParsimonyFast(PhyloNeighbor *, PhyloNode *): Assertion `!aln->ordered_pattern.empty()' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: atp6.G10.fas.log The alignment and the log files are attached. I would be very appreciated for assistance Yours sinserely, Alexey Neverov ", "The guide tree file is also attached. \u0447\u0435\u0442\u0432\u0435\u0440\u0433, 11 \u0438\u044e\u043d\u044f 2020 \u0433., 11:14:02 UTC+3 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c Alexey Neverov \u043d\u0430\u043f\u0438\u0441\u0430\u043b: ", "Just for record: this is a duplicated thread You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/eb8f09c7-821b-4786-872e-1423e6c1ac16o%40googlegroups.com <MEGAtree_mtREV_F.newick> "]}, "_zAnra__BFU": {"topic": "identical sequences", "initializeDate": "Apr 18, 2020, 11:12:14 AM", "timeStamp": "Apr 20, 2020, 1:40:31 AM", "content": ["Hi Minh, I have a question regarding the treatment of identical sequences. Upon execution of IQTREE, the program generated a new phylip file supposedly containing unique sequences. However, when I go to run this new file it tells me that I still have identical sequences in the alignment. Can you explain this a bit? Thanks. Chris ", "Hi Chris, This is a good question, the reason is: in a subset of k identical sequences, IQ-TREE only removes the 3rd, 4th, \u2026,k-th sequence, and still keep the 2nd identical sequence. So if you look more closely in the log file, there are two kind of warnings. The first looks like: \"NOTE: XXX is identical to YYY but kept for subsequent analysis\" This is for the 2nd identical sequence. The other is: \"NOTE: XXX (identical to YYY) is ignored but added at the end\" This for the 3rd and so on identical sequences. Why did we do this? Because even if A is identical to B, the bootstrap support of clade (A,B) might not be 100%. When doing bootstrap resampling, some columns are not resampled in the bootstrap alignment. Therefore, it may turn out that another sequence C might actually become equal to A and B after resampling, even though C is originally different from A and B. And so the three resolutions: (A,(B,C)), ((A,B),C), and ((A,C),B) have the same likelihood, hence lower than 100% bootstrap support for (A,B). This is the deep reason behind the scene. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e801626f-c7ec-4bd1-8537-25da357cc802%40googlegroups.com "]}, "2sHuhNqFbUk": {"topic": "Iqtree crahed", "initializeDate": "Apr 22, 2020, 4:52:10 PM", "timeStamp": "Apr 24, 2020, 10:45:01 AM", "content": ["I was running my codon alignment with Iqtree -s filename -st CODON -m TEST -bb 1000 -alrt 1000 -minsup 0.95 when it crashed kindly take a look at the screen CHECKPOINT: Initial tree restored NOTE: ModelFinder requires 107 MB RAM! ModelFinder will test 30 codon models (sample size: 283) ... No. Model -LnL df AIC AICc BIC 1 MG+F1X4 13498.220 327 27650.440 242162.440 28842.501 ERROR: phylokernelnew.h:3159: double PhyloTree::computeLikelihoodFromBufferGenericSIMD() [with VectorClass = Vec4d; bool FMA = true; bool SITE_MODEL = false]: Assertion `std::isfinite(tree_lh) && \"Numerical underflow for lh-from-buffer\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: Cp_A-K_cleaned.fasta.log ERROR: *** Alignment files (if possible) Thank you. ", "It happened again to my other file, but this time it went past codon model test, here is the screen. 0.031 seconds Log-likelihood of BIONJ tree: -20074.865 -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Generating 98 parsimony trees... 12.847 second Computing log-likelihood of 98 initial trees ... ERROR: phylokernelnew.h:3159: double PhyloTree::computeLikelihoodFromBufferGenericSIMD() [with VectorClass = Vec4d; bool FMA = true; bool SITE_MODEL = false]: Assertion `std::isfinite(tree_lh) && \"Numerical underflow for lh-from-buffer\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: RepA_A-K_cleaned.fasta.log ERROR: *** Alignment files (if possible) [1] 18660 abort Iqtree -s RepA_A-K_cleaned.fasta -st CODON -m TEST -bb 1000 -alrt 1000 -minsu You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f761e2a3-1a41-40d8-9609-5066560cbe38%40googlegroups.com Kehinde Adewole Oyeniran PhD Scholar | Computational Biology | Institute of Infectious Diseases and Molecular Medicine (IDM) | Faculty of Health Sciences | University of Cape Town | Health Sciences Campus, Anzio Road, Observatory, 7925 | Blog: www.electoralreform-ng.blogspot.com | UCT email: OYNK...@myuct.ac.za +27(0)619507372 +27(0)736207568 +234(0)8038294995 \u201cAs you rise you must lift the others up\u201d -- Justice Skweyiya (RIP) ", "These are the file details: 158 sequences, 283 codon sites and 164 sequences, 289 codon sites respectively Thanks ", "I eventually tried this on the web server and it worked perfectly. No worries again "]}, "HaQjtU8yawM": {"topic": "ML tree using output from PartitionFinder2", "initializeDate": "Feb 11, 2019, 3:59:11 AM", "timeStamp": "Feb 13, 2019, 5:28:33 AM", "content": ["Hi everyone, Im working on a multiple gene alignment dataset and I just performed a partition model analysis using PartitionFinder2. Now, I want to use these partition models I got in IQTree to make the ML tree but I do not know how to input my results from PartitionFinder2 into the program. I know that IQTree has its own partition finder counterpart but I just want to explore all my options. Thank you. Amor ", "Hi Amor, You can copy the results of PF2 best_scheme \"Nexus formatted character sets for IQtree\" to create a partition file for iqtree. Then use -spp or -sp your_partition_PF2.nex in your iqtree command. Nicolas ", "Hi Nicolas, Is it normal that it only took me 5 minutes to finish the tree with 1000 ultrabootstrap and 1000 alrt? I have 22 taxa and around 11kb sequence length. Amor You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Amor, Yes that\u2019s normal - the ultrafast bootstrap is meant to be so by its name ;-) Minh ", "Thank you Minh Bui! "]}, "c7HZ9UxqwG0": {"topic": "IQ-TREE and 6-state Dayhoff groups?", "initializeDate": "Dec 6, 2016, 8:51:50 PM", "timeStamp": "Feb 8, 2018, 8:09:40 PM", "content": ["Hi everybody, I have a set of proteins that seems to be saturated and I was wondering: 1) is it possible to reconstruct a ML tree using a protein alignment that was re-coded numerically using Dayhoff groups (i.e. 6-state groups : ASTGP(1), DENQ(2), RKH(3), MVIL (4),FWI (5),C (6)), and applying a site specific model (such as PSMF)?. (re-coding was done to account for saturation and has been used in papers such as http://www.nature.com/nature/journal/v432/n7017/full/nature03149.html if so, 2) Since the groups are mapped to the amino acids as multi-state characteres (1 to 6) is there a way to specify a multi-state character for any of those models or how should I deal with the numeric coding? any reply or advice will be greatly welcomed, Elsa ", "Dear Elsa, Yes there is a way, as IQ-TREE supports multi-state data. First, recode your protein sequences as you described but using characters 0-5 (instead of 1-6). The recorded alignment can be input into IQ-TREE, but then morphological models are used by default (see http://www.iqtree.org/doc/Substitution-Models/#binary-and-morphological-models ). In order to use mixture models (e.g. C10) you have to manually define the model using NEXUS model file \u2014 see this thread for more details: https://groups.google.com/forum/#!topic/iqtree/j884eSJiugY There we discussed the Dayhoff4 group, but the principle is the same. There is even a model file for C60-SR4 model. Hope that helps Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, many thanks for your reply, I managed to understand how to create the new profiles and run a preliminar tree. After reading Susko and Roger (2007), I decide to give a try to SR4(with C60)and PMSF, but I had a problem. I was able to obtain a guide tree by running: iqtree-omp -s alig_recoded.phy -nt 8 -pre iqtree -mdef IqtreeC60SR4.nex -bb 1000 -alrt 1000 but then when I try to use PMSF I get this error:('ERROR: No mixture model was specified!'). The command line I lauched for PMSF is: iqtree-omp -s alig_recoded.phy -nt 8 -pre iqtree -mdef IqtreeC60SR4.nex -ft iqtree.treefile -b 10 this is how the defined model lookslike in the Iqtree_C60SR4.nex file (I didn't paste the 60 profiles to save space): model C60SR4=GTR+G+FMIX{C60NT1,C60NT2,C60NT3,C60NT4,C60NT5,C60NT6,C60NT7,C60NT8,C60NT9,C60NT10,C60NT11,C60NT12,C60NT13,C60NT14,C60NT15,C60NT16,C60NT17,C60NT18,C60NT19,C60NT20,C60NT21,C60NT22,C60NT23,C60NT24,C60NT25,C60NT26,C60NT27,C60NT28,C60NT29,C60NT30,C60NT31,C60NT32,C60NT33,C60NT34,C60NT35,C60NT36,C60NT37,C60NT38,C60NT39,C60NT40,C60NT41,C60NT42,C60NT43,C60NT44,C60NT45,C60NT46,C60NT47,C60NT48,C60NT49,C60NT50,C60NT51,C60NT52,C60NT53,C60NT54,C60NT55,C60NT56,C60NT57,C60NT58,C60NT59,C60NT60}+F; do I need to use a different command line or I cann't use PMSF with SR4? Many thanks for your advise, ElSa ", "Hi Elsa, On Dec 8, 2016, at 3:31 PM, Elsa < dayana.sa...@gmail.com > wrote: Hi Minh, many thanks for your reply, I managed to understand how to create the new profiles and run a preliminar tree. you are welcome! After reading Susko and Roger (2007), I decide to give a try to SR4(with C60)and PMSF, but I had a problem. I was able to obtain a guide tree by running: iqtree-omp -s alig_recoded.phy -nt 8 -pre iqtree -mdef IqtreeC60SR4.nex -bb 1000 -alrt 1000 but then when I try to use PMSF I get this error:('ERROR: No mixture model was specified!'). The command line I lauched for PMSF is: iqtree-omp -s alig_recoded.phy -nt 8 -pre iqtree -mdef IqtreeC60SR4.nex -ft iqtree.treefile -b 10 this is how the defined model lookslike in the Iqtree_C60SR4.nex file (I didn't paste the 60 profiles to save space): model C60SR4=GTR+G+FMIX{C60NT1,C60NT2,C60NT3,C60NT4,C60NT5,C60NT6,C60NT7,C60NT8,C60NT9,C60NT10,C60NT11,C60NT12,C60NT13,C60NT14,C60NT15,C60NT16,C60NT17,C60NT18,C60NT19,C60NT20,C60NT21,C60NT22,C60NT23,C60NT24,C60NT25,C60NT26,C60NT27,C60NT28,C60NT29,C60NT30,C60NT31,C60NT32,C60NT33,C60NT34,C60NT35,C60NT36,C60NT37,C60NT38,C60NT39,C60NT40,C60NT41,C60NT42,C60NT43,C60NT44,C60NT45,C60NT46,C60NT47,C60NT48,C60NT49,C60NT50,C60NT51,C60NT52,C60NT53,C60NT54,C60NT55,C60NT56,C60NT57,C60NT58,C60NT59,C60NT60}+F; do I need to use a different command line or I cann't use PMSF with SR4? simply because your command line lacks \u201c-m C60SR4\u201d. Adding this option should work. Minh Many thanks for your advise, ElSa On Tuesday, December 6, 2016 at 9:51:50 PM UTC-4, Elsa wrote: Hi everybody, I have a set of proteins that seems to be saturated and I was wondering: 1) is it possible to reconstruct a ML tree using a protein alignment that was re-coded numerically using Dayhoff groups (i.e. 6-state groups : ASTGP(1), DENQ(2), RKH(3), MVIL (4),FWI (5),C (6)), and applying a site specific model (such as PSMF)?. (re-coding was done to account for saturation and has been used in papers such as http://www.nature.com/nature/journal/v432/n7017/full/nature03149.html if so, 2) Since the groups are mapped to the amino acids as multi-state characteres (1 to 6) is there a way to specify a multi-state character for any of those models or how should I deal with the numeric coding? any reply or advice will be greatly welcomed, Elsa You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Minh, thanks again for your prompt reply, and I'm sorry for keep asking questions but I forgot to mention that I also had tried that command line with the following error: iqtree-omp -s iqtree.uniqueseq.phy -nt 8 -pre iqtree -m C60SR4 -mdef IqtreeC60SR4.nex -ft iqtree.treefile -b 100 ERROR: Unknown morphological model name btw, the version I'm using is 1.5.1 would you have any other advise? ElSa On Tuesday, December 6, 2016 at 9:51:50 PM UTC-4, Elsa wrote: ", "Dear Elsa, Sorry I overlooked. This is because GTR is not a valid model name for multi-state data. To overcome, you just need to convert into DNA instead of 0-3. That means the sr4 recoding is the following: A,G,N,P,S,T = A; C,H,W,Y = C; D,E,K,Q,R = G; F,I,L,M,V = T Moreover, I recommend to try also C10 to C50, then look at the BIC/AIC scores to choose the model to avoid the danger of over-parameterization. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Minh, I followed your advise and initially did work. However, the core gets dumped and I don't see any indication of why. This situation is not always reproducible as it can be seen either while I try to generate the guide tree or after I obtained it (i.e. If I'm lucky and get the guide tree, then the core gets dumped while running PMSF) Could you please, help me figure out what is happening? Details of the problem: CASE: the job sometimes run and finishes properly,sometimes it fully stops, and it might get fixed fixed if I raise -b from 100 to 1000, I've been running PMSF with -b 100 without problems. DATA and MODEL: re-coded data as SR4-states (Susko and Roger 2007), customized C10SR4 model The following is one example when I am lucky an I get the guide tree, but PMSF (with -b) 100 fails. the problem gets fixed when I increase -b 1000 (I wish to be able to run it only with 100, as i had done it with other PMSF runs) command line for the guide tree: iqtree-omp -s TD2_promalsRec.uniqueseq.phy -nt 8 -m C10SR4 -pre TD2_promalsRec -mdef IqtreeC10SR4.nex -bb 1000 here I used -m C10SR4 because i kept getting info that the predet model was under-fitting the data. command line for PMSF: iqtree-omp -s TD2_promalsRec.uniqueseq.phy -nt 8 -pre PMSFTD2_promalsRec -m C10SR4 -mdef IqtreeC10SR4.nex -ft TD2_promalsRec.treefile -b 100 Bellow is the info i get (after chi2 test). BTW, I get this info regardless whether it failed while obtaining the guide tree or running PMSF. error log: ... 96 XP_008876480_1_A_invadans 30.63% passed 56.58% WARNING: 1 sequences contain more than 50% gaps/ambiguity **** TOTAL 13.92% 7 sequences failed composition chi2 test (p-value<5%; df=3) ===> COMPUTING SITE FREQUENCY MODEL BASED ON TREE FILE TD2_promalsRec.treefile Reading model definition file IqtreeC10SR4.nex ... 48 models and 224 frequency vectors loaded Model C10SR4 is alias for GTR+G+FMIX{C10NT1,C10NT2,C10NT3,C10NT4,C10NT5,C10NT6,C10NT7,C10NT8,C10NT9,C10NT10}+F NOTE: 22 MB RAM is required! system error file: STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL ILLEGAL INSTRUCTION *** For bug report please send to developers: *** Log file: PMSFTD2_promalsRec.log *** Alignment files (if possible) Illegal instruction (core dumped) many thanks for your help and advise, ElSa On Tuesday, December 6, 2016 at 9:51:50 PM UTC-4, Elsa wrote: ", "Hi Elsa, this illegal instruction sounds like IQ-TREE does not properly detect the right instruction set supported in your computer. Can you please add option \u201c-nofma\u201d to disable to FMA instructions, and let me know if it runs or not? Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, I used -nofma as you recommended (for both guide tree and PMSF). I was able to get a guide tree, but PMSF reconstruction failed with the message at the bottom of this message. do you think the error could be related with the data itself? Many thanks for all your advise :) INFO: Command line : (I used -safe because initially I got an error related with the kernel) iqtree-omp -safe -nofma -s TD2_fastarec.phy -nt 8 -pre PMSFiqtree -m C10SR4 -mdef IqtreeC10SR4.nex -ft TD2_fastarec.treefile -b 100 tail of PMSFiqtree.log: ===> CONTINUE ANALYSIS USING THE INFERRED SITE FREQUENCY MODEL ===> START BOOTSTRAP REPLICATE NUMBER 1 Creating bootstrap alignment (seed: 74768)... Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.035 seconds Reading model definition file IqtreeC10SR4.nex ... 48 models and 224 frequency vectors loaded Model C10SR4 is alias for GTR+G+FMIX{C10NT1,C10NT2,C10NT3,C10NT4,C10NT5,C10NT6,C10NT7,C10NT8,C10NT9,C10NT10}+F NOTE: 4 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.100) 1. Initial log-likelihood: -26233.260 Error reported: iqtree-omp: /home/CIBIV/minh/Dropbox/iqtree-git/phylokernelnew.h:2566: double PhyloTree::computeLikelihoodBranchSIMD(PhyloNeighbor*, PhyloNode*) [with VectorClass = Vec4d; bool SAFE_NUMERIC = true; int nstates = 4; bool FMA = false; bool SITE_MODEL = true]: Assertion `!std::isnan(tree_lh) && !std::isinf(tree_lh) && \"Numerical underflow for lh-branch\"' failed. STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: PMSFiqtree.log *** Alignment files (if possible) Aborted (core dumped) On Tuesday, December 6, 2016 at 9:51:50 PM UTC-4, Elsa wrote: ", "Hi Elsa, this sounds like a bug. Can you send me your recoded alignment, model file and the log-file via my personal email? One question: did the run under the original protein alignment work? Bottom line: I never tried this recoded stuff myself, thus I may have overlooked something. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Minh, I sent you the files to your email. Many thanks for checking into this, ElSa On Tuesday, December 6, 2016 at 9:51:50 PM UTC-4, Elsa wrote: ", "Dear Minh, Could you please give me some advise? I am getting an error (i.e. core gets dumped after some replicates). It happens when I run re-coded (SR4) data and PMSF... here is the command line I have launched: iqtree-omp -s MRE11_rec.phy -safe -nofma -nt 4 -pre MRE11_PMSF_rec_C20SR4 -m C20SR4 -mdef IqtreeC20SR4.nex -ft MRE11_rec_C10SR4.treefile -b 100 ***** Error ***: iqtree-omp: /home/CIBIV/minh/Dropbox/iqtree-git/phylokernelnew.h:2566: double PhyloTree::computeLikelihoodBranchSIMD(PhyloNeighbor*, PhyloNode*) [with Vec torClass = Vec4d; bool SAFE_NUMERIC = true; int nstates = 4; bool FMA = false; bool SITE_MODEL = true]: Assertion `!std::isnan(tree_lh) && !std::isinf(tre e_lh) && \"Numerical underflow for lh-branch\"' failed. STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: MRE11_PMSF_rec_C20SR4.log *** Alignment files (if possible) Aborted (core dumped) Many thanks for your advise, ElSa On Tuesday, December 6, 2016 at 9:51:50 PM UTC-4, Elsa wrote: ", "Dear Elsa, Sorry for the delayed reply: Right now PMSF model only supports amino-acid data \u2014 so it does not work with your recoded data. So please refrain from using it. Note that you can still use mixture models with your recoded data. Long answer: The reason is because empirical amino-acid models (e.g. LG) have fixed exchange rates, thus there is no need to optimize such model parameters. For your recoded data, the GTR model is used, and IQ-TREE has no idea how to optimize GTR parameters under PMSF scheme. I need to discuss this with my co-authors first before getting back to you. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Minh, If I insist on using a 6-character-state recoding scheme, how can I use the GTR model for such multi-state character dataset? Thank a lot, Sergio ", "Hi Sergio, right now MK and ORDERED are the only two models available for multi-state data, because I was reluctant to provide the parameter-rich GTR model. Here, parameter estimation might be unreliable, eps. for short alignments with little phylogenetic signals. However, if you provide some compelling reason why to do GTR, then I will be willing to add it. Cheers, Minh ", "Thank you for your reply, Minh. I think the GTR model for multi-state characters would be particularly useful for us who are interested in using amino acid-recoded data into 6 states. Some people in our lab have noted that when recoding amino acid data into 4 states, some phylogenenetic signal can be lost, but 6 states appear to conserve more signal while still simplifying the complex signal enough to account for the heterogeneity. We usually have 'phylogenomic' alignments that are long enough. The GTR model for multi-state data would also be quite versatile allowing to incorporate different amino acid recoding schemes (not only 4-, or 6-state), I suppose. Cheers, Sergio ", "Hi Sergio, ok I see. In fact we opened an enhancement ( https://github.com/Cibiv/IQ-TREE/issues/22 ), which will allow users to convert data type automatically. Thus, this will be included in the future version 1.6. Will let you know in that event. Cheers, Minh ", "Great, thanks for the update. ", "Hi Minh, I am also running analyses with the Dayhoff-6 recoding. Does the new 1.6 IQTREE contain the GTR model for multistate data? It would be so good to use IQTREE for all of my analyses! Thanks! ", "Hi Tauana, No, GTR model is not supported yet for multistate data. It's not difficult to implement, but one has to test the parameter optimisation thoroughly. In your case, the 6-state GTR model will have 19 free parameters (14 substitution rates and 5 state frequencies), which are harder to estimate accurately, compared with GTR for DNA (8 parameters). That's the main reason. However, since you do the recoding from protein sequences, then the amount of data is much larger than morphological data, leading to enough information to estimate model parameters... Therefor we may add such model in the near future. Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com ", "Thanks Minh! I\u2019ll keep an eye out for the next updates. You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/c7HZ9UxqwG0/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com "]}, "eenid6U3kdQ": {"topic": "LSD Error: There's conflict or not enough signal in the input temporal constraints.", "initializeDate": "Jul 27, 2020, 9:56:06 AM", "timeStamp": "Jul 28, 2020, 10:11:32 AM", "content": ["Dear IQ-TREE & LSD devs/users, I am running IQ-TREE (and LSD from IQ-TREE) to generate and date a SARS-CoV-2 phylogeny with the following command: $IQTREE \\ -s alignment.fasta \\ -m HKY+F+G4 \\ -nt 4 \\ -ninit 10 -n 4 \\ -czb \\ -o \"USA_WA1_2020|EPI_ISL_404895|2020-01-19,Wuhan_WH04_2020|EPI_ISL_406801|2020-01-05\" \\ --date TAXNAME \\ --date-ci 100 \\ --date-outlier 3 \\ --date-options \"-a 2019.784\" 2>&1 | tee prefix_run.log This yields the error: Error: There's conflict or not enough signal in the input temporal constraints. I am not sure what the problem is, since the earliest sequence date is after the root date I specified. The command runs fine if I allow the root to be earlier (e.g. --date-options \"-a 2019.7\"). Unfortunately the GISAID user agreement does not permit posting the alignment, but I have attached the log files for the runs with both root date options in case it helps diagnose the issue. ", "And here are the headers from the alignment file containing the tip dates. ", "Hi Sarah, I think the problem coming from the minimum branch length that is imposed on the time scaled tree. For a tree with lots of small branch lengths, to avoid bias, we should set the minimum branch length to 0, rather than use the estimated one (which is about 1/seqLength/rate for each branch). When the minimum branch length is positive, that may happen that the root date is forced to be older than a certain date, which causes a conflict with your input root date. For this, you can use --date-options \"-u 0\". Actually for the next version, we will set minimum branch length to 0 by default; and let users to set this as they want. Hope this helps, Hien You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/E70994B1-E909-4405-A493-5CE83A53020F%40gmail.com ", "Hi Hien, I think that a sensible default. Let me know when you can change this behaviour, so that I will integrate LSD2 into IQ-TREE. You can introduce an option that retain the previous behaviour, like -u e (e for estimate). Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/DB8P191MB11119BFDF098F398291BAF63A4720%40DB8P191MB1111.EURP191.PROD.OUTLOOK.COM ", "Hi Hien, I really appreciate your help. Re-running the analysis with \u201c-u 0\u201d as you suggested eliminated the error, even with a more realistic range for the root date in early December. Thanks for the answer! Best, Sarah To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/DB8P191MB11119BFDF098F398291BAF63A4720%40DB8P191MB1111.EURP191.PROD.OUTLOOK.COM "]}, "x2j3_q7IkvQ": {"topic": "Interpreting the brunch lengths difference between using PoMo and not using PoMo", "initializeDate": "Feb 19, 2021, 6:23:19 AM", "timeStamp": "Mar 1, 2021, 7:28:05 AM", "content": ["Hello! I tried to built phylogeny using concatenated variant sites (only SNPs) for ~30 con-generic species(some are multiple-sampled, some are not). I did three runs: 1) input with aligned fasta with only ATCGs (choose the major allele if it's heterozygous) 2) input with aligned fasta with IUPAC ambiguity codes 3) input with count file using PoMo. Treat each individual as a population, so the count file only contains 0/1/2 (diploid). Attached the results. The topology remains almost the same. What I am curious about is that the Brunch lengths varies a lot. 1) > 2) > 3). I found it's hard to explain this given that including heterozygous information should more or less increase the diversity level. But the results show the opposite. What's your opinion about why this happened? Please point out if did the analysis in a totally wrong way. I'm not sure whether 3) is a good way to do the job because the model requires specifying population size which could not be less than 3. What's a better way to do it if any? ", "Dear Wu, Your trees don\u2019t have the scale bar \u2026 Am I right, that the scale bars have the same length? That means, the branch lengths can be visually comparable? Dominik will be able to say something about 3. Run 1 is certainly sensible. Run 2: IUPAC has a different interpretation, it\u2019s not about SNP. See http://www.iqtree.org/doc/Frequently-Asked-Questions#how-does-iq-tree-treat-gapmissingambiguous-characters . For example, R means that the character can be either A or G, but we are unsure which one. But under SNP, R would be A and G. So using IUPAC to \u201ctrick\u201d IQ-TREE is not appropriate. Instead, one should introduce a new state in the Markov process that represent {A and G}. That explains why you got shorter branch lengths in Run2. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/23403c49-a972-48c9-b7ab-cd15371ed876n%40googlegroups.com <3 - PoMo.pdf> <2 - IUPAC.pdf> <1 - atcg ONLY.pdf> ", "Thank you very much for replying Minh! Sorry I can not understand 'one should introduce a new state in the Markov process that represent {A and G}\u2019. Could you please explain a bit more? Or is there already a method to do this that I can refer to? Also - hi Dominik, I am very interested in hearing your opinion about how to fit PoMo to this dataset. My best, ", "Hi Wu, I\u2019m not aware of method/software that can do this directly. But let\u2019s assume you have diploid genomes. Then each site can be homozygote (A, G, C, T) or heterozygote (R,\u2026). That means, there are 10 states: A, C, G, T, R, Y, W, S, M, K. where R = A/G, Y = C/T, W = A/T, S = G/C, M = A/C, K = G/T. What you can do in IQ-TREE is to convert these 10 states into character 0, 1, 2, \u2026, 9. So the converted alignment will have these digits. When you load this alignment in IQ-TREE, it will be detected as morphological alignment, and now you can use a morphological model to run the analysis: http://www.iqtree.org/doc/Tutorial#binary-morphological-and-snp-data . There are just 3 morphological models in IQ-TREE: MK, ORDERED and GTR. Do not use ORDERED which is not designed to such data. Also MK is too simplified. GTR is a bit too complex, but it depends on the phylogenetic information of your alignment (e.g. sequence length). I guess you can use GTR if you alignment is long enough. I think a model complexity somewhere between MK and GTR will be desirable, but this can be topic of a future research. Cheers Minh ", "I just saw that RAxML-NG can do this in their wiki (GENOTYPE): https://github.com/amkozlov/raxml-ng/wiki/Input-data#state-encoding--order It\u2019s however unclear to me what model they use\u2026 Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/F486EF57-513A-4F14-949E-1D53A5CFCC53%40univie.ac.at ", "Thank you Minh! Those information are very helpful. >> What you can do in IQ-TREE is to convert these 10 states into character 0, 1, 2, \u2026, 9. So the converted alignment will have these digits. This sounds like the 10 states are isolated states, so the transition possibility between any two of them is the same? Will the GTR model possibly aware that, say A -> W has a higher possibility than A -> T? I\u2019ll explore the RAxML-NG as well! My best, ", "Hi! Did I understand correctly that you run the analyses with SNP data only? That is, did you exclude sites where all species/individuals have the reference base? In this case, it is not really appropriate to use PoMo, because it needs to infer the heterozygosity in the data. The heterozygosity can only be inferred correctly if all sites are included in the alignment. Of course, one could filter, let's say, the first and second codon positions. But one cannot filter for sites with mutations. With respect to the branch lengths: the absolute branch lengths of PoMo differ a lot from other models. One can convert the branch lengths using the procedure described in [1], Section 2.8. The relative branch lengths are also different. Terminal branches are expected to be shorter with PoMo, because polymorphisms are correctly interpreted, and not mistaken for substitutions. Finally, the population size parameter N is more of a discretization factor describing how many bins are used to approximate the population dynamics. So, using 3 would be perfectly fine in your case. I hope I could help! Let me know if you have further questions! Best, Dominik [1] Schrempf, D., Minh, B. Q., De Maio, N., von Haeseler, A., & Kosiol, C., Reversible polymorphism-aware phylogenetic models and their application to tree inference, Journal of Theoretical Biology, 407(), 362\u2013370 (2016). http://dx.doi.org/10.1016/j.jtbi.2016.07.042 "]}, "ab98mXiuMYU": {"topic": "Deleting old jobs from IQ TREE webserver", "initializeDate": "Jun 10, 2018, 11:46:43 PM", "timeStamp": "Jun 12, 2018, 3:13:09 AM", "content": ["I'd like to delete old jobs from the \"Analysis Results\" tab for the jobs I've submitted to the webserver. I don't find a way to do this and don't find any instructions on this. I'm using the webserver site at http://iqtree.cibiv.univie.ac.at/ Thanks! Sarah ", "Hi Sarah, Unfortunately there is no such option, partly to prevent possible hack. However, jobs older than 6 months will be automatically deleted from the server. If you are concerned with data privacy, this is what clarified in the web server: Data Privacy Statement: All your personal data are strictly confidential and will not be shared with any third parties. Your data will be automatically deleted after 180 days.\" This is to explicitly accommodate with the new EU regulations, but we have followed this policy since the beginning. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "_bqhPHnCE0w": {"topic": "Problems with partitioned analysis on CIPRES", "initializeDate": "Jul 12, 2020, 2:12:51 PM", "timeStamp": "Jul 15, 2020, 11:52:27 AM", "content": ["Hello everyone, I am new to IQtree and I am trying to do a relatively complex analysis involving 7 partitions (6 for DNA, 1 for morphology). The analysis runs fine in my local machine (IQtree 1.6.12) and the results are similar to the ones obtained with other software (e.g. MrBayes) so I think the partition file is correctly recognized. However, when I try to run it in CIPRES, the homogeneity test is run for the entire DNA partition at once (not individually for each of the 6 DNA partitions), and the analysis terminates with an error: ===> START BOOTSTRAP REPLICATE NUMBER 1 Creating bootstrap alignment (seed: 50013)... WARNING: States(s) R, D, Q, E, H, I, L, K, M, F, P, S, W, Y, V rarely appear in partition coi12.0 and may cause numerical problems WARNING: States(s) R, D, Q, E, H, I, L, K, M, F, P, S, W, Y, V rarely appear in partition coi12.1 and may cause numerical problems WARNING: States(s) A, D, C, Q, E, G, H, I, L, K, M, F, P, S, T, W, V rarely appear in partition coi3ry.0 and may cause numerical problems WARNING: States(s) D, Q, E, H, I, L, K, M, F, P, W, V rarely appear in partition 28s_mus_ori.0 and may cause numerical problems WARNING: States(s) R, N, D, Q, E, H, I, L, K, M, F, P, S, W, Y, V rarely appear in partition 16s.0 and may cause numerical problems WARNING: States(s) R, N, D, Q, E, H, I, L, K, M, F, P, S, W, Y, V rarely appear in partition 16s.1 and may cause numerical problems WARNING: States(s) R, N, D, Q, E, H, I, L, K, M, F, P, S, W, V rarely appear in partition 16s.2 and may cause numerical problems Creating fast initial parsimony tree by random order stepwise addition... 6.457 seconds, parsimony score: 10097 (based on 2065 sites) ERROR: File not found GTR It also seems that the tree search step has been skipped. I tried to load the defaults for tree search parameters through the CIPRES Wizard, but the error keeps happening. I think this might be something with me not setting the job parameters in CIPRES correctly, since the analysis runs just fine locally. Has anyone had similar problems? Thanks in advance. Ivan Dr. Ivan L. F. Magalhaes Postdoctoral fellow \u2014 Divisi\u00f3n Aracnolog\u00eda Museo Argentino de Ciencias Naturales \"Bernardino Rivadavia\" Av. \u00c1ngel Gallardo 470, C1405DJR, Buenos Aires, Argentina +54 11 4982-8370 ext. 169 ResearchGate Twitter iNaturalist Lattes CV-Ar ORCID ", "Hi Ivan, You looks like you incorrectly specified a protein model. The WARNINGs list the states of the amino-acids. However, I don\u2019t really know how the interface of CIPRES can specify a partition model\u2026 I just use the command line version. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/dea0dd2c-21b0-471e-bbd8-809f97aa4c9do%40googlegroups.com ", "Hi Ivan, I confirmed that there is a problem with the CIPRES interface when multiple alignment files are specified in the partition file. I will follow up with Mark Miller to get the interface fixed. Best regards, Wayne To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/12995455-1670-414E-AC36-BC4F0A7BC708%40univie.ac.at ", "Dear Minh and Wayne Many thanks for the helpful answers. I would be grateful if you could post here when the problem with the CIPRES interface is solved. But since the problem is with multiple alignment files, perhaps I can work around this by providing a single interleaved nexus file with both morphological and DNA data, instead of two separate .phy files? Thanks again and best wishes, Ivan Em domingo, 12 de julho de 2020 23:45:43 UTC-3, Wayne Pfeiffer escreveu: Hi Ivan, I confirmed that there is a problem with the CIPRES interface when multiple alignment files are specified in the partition file. I will follow up with Mark Miller to get the interface fixed. Best regards, Wayne Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/dea0dd2c-21b0-471e-bbd8-809f97aa4c9do%40googlegroups.com You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Ivan, et al. The issue was a bug I introduced in the CIPRES interface. It should be fixed now. Please give it a whirl, and let me know if you see any further issues. IQ-Tree has a fairly complex set of commands and inter dependencies, hopefully I have it right this time. Best, Mark "]}, "Ykw3gvImu54": {"topic": "Create a constrained phylogenetic tree (in R)", "initializeDate": "Jan 7, 2020, 5:37:19 AM", "timeStamp": "Jan 10, 2020, 8:43:57 AM", "content": ["Hi, I want to perform topological test between constrained and unconstrained phylogenetic trees. I have gone through the advance tutorial given in the IQ-TREE ( http://www.iqtree.org/doc/Advanced-Tutorial#testing-constrained-tree ). My question is, how do I generate constrained phylogenetic tree especially when I have more than 200 taxa in the tree. I wonder, is there anyway (preferably in R) to generate constrained tree file ? Thanks, Chirag. ", "Hi Chirag, Perhaps someone else might be able to answer. But outside of R, you can use some tree editing software. I personally like TreeGraph 2 ( http://treegraph.bioinfweb.info ), that I started to use recently. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/3d5788b5-3029-4ce8-b750-9603e87b036f%40googlegroups.com ", "Thanks a lot. by the way, I wrote small function in R to get constrained tree. See below. #' get constrained tree #' @param tree an object of class phylo #' @param nodes a vector of integer values denoting node(s) to be constrained from a \\code{tree} #' @return a tree - an object of class phylo #' @export #' @importFrom treeio tree_subset #' @examples #' \\dontrun{ #' tree_text <- \"(((((((A:4,B:4):6,C:5):8,D:6):3,E:21):10,((F:4,G:12):14,H:8):13):13,((I:5,J:2):30,(K:11,L:11):2):17):4,M:56);\" #' tree_obj <- treeio::read.tree(text = tree_text) #' ggtree(tree_obj) + geom_nodelab(aes(label = node)) + geom_tiplab() #' ## impose constrain on 17 and 23 node #' tree_constr <- get_constranined_tree(tree_obj, node = c(17,23)) #' ## visualize constrained tree #' ggtree(tree_constr) + geom_nodelab(aes(label = node)) + geom_tiplab() #' ## By default it gives rooted tree. To convert it to unrooted tree ... #' tree_constr_unroot <- ape::unroot(tree_constr) #' } get_constranined_tree <- function(tree, nodes ){ #tree <- tr_reroot #nodes <- c(378,388,399,421,430,436,318, 324,329,536,474) sub_tree_list <- purrr::map(nodes, ~ tree %>% treeio::tree_subset(node = ..1 , levels_back =0) ) if(length(sub_tree_list) >= 1){ sub_tree1 <- sub_tree_list[[1]] } else { stop(\"No subtree found given nodes\") ## remove first elem from sub_tree_list sub_tree_list <- sub_tree_list[-1] con_tree <- sub_tree1 ## add remaining sub_tree to sub_tree1 for(i in sub_tree_list) {con_tree = con_tree + i } return(con_tree) Cheers, Chirag. ", "Hi Minh, I wonder, supplying branch length and support values in the constrained tree affect constrained tree search ? Cheers, Chirag. On 9 Jan 2020, at 3:18 PM, Minh Bui < minh...@univie.ac.at > wrote: ", "Hi Chirag, No, branch lengths and support values of the constraint tree do not have any effect. Minh PS: Thanks for sharing the R code. "]}, "5usloQwNOTQ": {"topic": "Option for minimum branch length", "initializeDate": "Nov 26, 2015, 10:04:02 AM", "timeStamp": "Nov 27, 2015, 8:35:15 AM", "content": ["Hi, I would like to request having a parameter for minimum branch length on the command line to accommodate building trees of very similar sequences. Thanks a lot Hang ", "Dear Hang, the minimum branch length in IQ-TREE is 0.000001 (1 over million) and hard-coded. This is fine for most cases. I can of course introduce an option to change this lower bound. However, can you tell me a bit more what kind of data you have, so that such an option might be helpful? Thanks, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, we are working on bacterial genome that are very closely related with each other and having the current minimum branch length setting to affect the resulting tree, making all the branches having similar length. So ideally we would like to set it much lower than that. Best regards Hang ", "Dear Hang, thanks for the info. I put this into the TODO list for the next release. Cheers, Minh "]}, "lkSfVUgNLHM": {"topic": "BUG - option mem in IQtree 1.6.12", "initializeDate": "Aug 5, 2020, 12:41:25 PM", "timeStamp": "Aug 26, 2020, 8:38:33 PM", "content": ["Hi, I am still using 1.6.12 for analyses (consistency reasons). When I add the -mem option (e.g. -mem 60G) it gives me a weired error and core dumped/analyses crashed. If I do not use -mem all is fine (but I have for one analyses at least restrict it). In other analyses, -mem is just ignored. Issue known, is this only for 1.6.12? Help appreciated! Best, Karen ", "Hi Karen, -mem option does not work with partition models, and for some reason the older IQ-TREE version didn\u2019t spit out an error message about that. Is that the case? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2b9fea0a-bf37-4a85-894c-2436de381ba0o%40googlegroups.com ", "Dear Minh, yes, it's partitioned :-( - so way around? (I cannot analyse it unpartitioned though). Will this option then maybe be implemented in the future - also for partitioned datasets? Best, Karen ", "Hi Karen, How much RAM does IQ-TREE require? How much RAM does your server have? Is there a chance to access a more powerful server? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/aaad7419-970a-411f-a60a-d4165f189a83o%40googlegroups.com ", "Dear Minh, this Job requires about 80 GB RAM - but I aso have otehr jobs that may require > 2 TB - currently I have unfortunately no cluster access, but even if I have i would be great if this -mem option will work on larttioned datasets... Best, Karen Am Freitag, 7. August 2020 03:44:32 UTC+2 schrieb Minh Bui: Hi Karen, How much RAM does IQ-TREE require? How much RAM does your server have? Is there a chance to access a more powerful server? Minh On 6 Aug 2020, at 7:16 pm, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Dear Minh, yes, it's partitioned :-( - so way around? (I cannot analyse it unpartitioned though). Will this option then maybe be implemented in the future - also for partitioned datasets? Best, Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Karen, It may sound simple for users: it\u2019s only an option. However, to make -mem option work with partition models is quite some coding effort, as partition models require an advanced tree data structure that can handle missing data and non-overlapping species between partitions. Especially -mem option needs to work directly on this data structure, a fair bit of programming is needed. So only if this option is necessary for more than a couple of users, then we\u2019ll consider implementing it. We need to prioritize on features that are used by many users. Sorry about that. Minh On 16 Aug 2020, at 9:58 pm, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Dear Minh, this Job requires about 80 GB RAM - but I aso have otehr jobs that may require > 2 TB - currently I have unfortunately no cluster access, but even if I have i would be great if this -mem option will work on larttioned datasets... Best, Karen Am Freitag, 7. August 2020 03:44:32 UTC+2 schrieb Minh Bui: Hi Karen, How much RAM does IQ-TREE require? How much RAM does your server have? Is there a chance to access a more powerful server? Minh On 6 Aug 2020, at 7:16 pm, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Dear Minh, yes, it's partitioned :-( - so way around? (I cannot analyse it unpartitioned though). Will this option then maybe be implemented in the future - also for partitioned datasets? Best, Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/aaad7419-970a-411f-a60a-d4165f189a83o%40googlegroups.com You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/47e3d332-d334-4eb0-8f9c-7429ce915a1ao%40googlegroups.com ", "Dear Minh / all, sure understandable! .I know at least six people (from 1kite) having / that had this issue as well,, but this is of course not enough! @USERS: pls leave a not if you would need this option...!! @MInh: not sure if this is read, can/should I post an \"issue\" with this question somewhere? or post a separate Post again? cheers Karen ", "Hi Karen, Best is to post an issue in github: https://github.com/iqtree/iqtree2/issues To keep track. Then if there are more people commenting on the issue that they wish to have this feature, we\u2019ll eventually implement it. Or simpler: they can also post a reply here. Thanks Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/3abd433e-299d-48da-b615-0c1341e5376cn%40googlegroups.com "]}, "nWxd4v1LRpg": {"topic": "nexus with mixed data for IQ web server", "initializeDate": "Apr 13, 2020, 3:50:30 PM", "timeStamp": "Apr 16, 2020, 3:48:52 PM", "content": ["Dear all, is it possibe to analyze binary and codon data through IQ web server? I have fasta file with concatenated morphology and codon data: 1-10 binary characters and 11-1726 nucleotides (a nuclear protein gene) My nexus: #nexus begin sets; charset part1 = bin,1-10; charset part2 = Codon1,11-1726; charpartition mine = JC2+FQ+ASC:part1, MGK+F3X4+R4:part2; end; IQ reports ERROR, saying that: ERROR: sequence... has invalid character 0 at site 1 ERRORR: sequence... has invalid character 1 at site 2 ERROR: ...many more... What is wrong? ", "Hi Philipp, The web server cannot process mixed alignment, because as input IQ-TREE requires each data type to be separate in an alignment, i.e. one alignment for binary, one for DNA, and so on. But the server does not accept more than one alignment. So you need to run from the command line. See how to prepare a partition file here: http://www.iqtree.org/doc/Complex-Models#partition-models Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/43b0d7da-458a-4eef-a73a-ea036e79a5c9%40googlegroups.com ", "Dear Minch, I followed your advice and installed IQtree 2. I tryed example files according to the Manual and that was ok. When I tryed my data (2 genes), IQ tree could not find one of the alignments while reading nexus. Could you please look through my nex and log files and tell me what is wrong? I struggled to indicate where the alignments and nexus files are. I had to indicate full adress (starting with disc F) for each of them (is it ok?). May be the way I indicate the file adress is wrong? Philipp \u0432\u0442\u043e\u0440\u043d\u0438\u043a, 14 \u0430\u043f\u0440\u0435\u043b\u044f 2020 \u0433., 4:24:26 UTC+3 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c Minh Bui \u043d\u0430\u043f\u0438\u0441\u0430\u043b: Hi Philipp, The web server cannot process mixed alignment, because as input IQ-TREE requires each data type to be separate in an alignment, i.e. one alignment for binary, one for DNA, and so on. But the server does not accept more than one alignment. So you need to run from the command line. See how to prepare a partition file here: http://www.iqtree.org/doc/Complex-Models#partition-models Minh On 14 Apr 2020, at 5:50 am, Philipp Chetverikov < philipp.c...@gmail.com > wrote: Dear all, is it possibe to analyze binary and codon data through IQ web server? I have fasta file with concatenated morphology and codon data: 1-10 binary characters and 11-1726 nucleotides (a nuclear protein gene) My nexus: #nexus begin sets; charset part1 = bin,1-10; charset part2 = Codon1,11-1726; charpartition mine = JC2+FQ+ASC:part1, MGK+F3X4+R4:part2; end; IQ reports ERROR, saying that: ERROR: sequence... has invalid character 0 at site 1 ERRORR: sequence... has invalid character 1 at site 2 ERROR: ...many more... What is wrong? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Philipp, In this case please remove \u201c-s \u2026\u201d option and then go inside this directory (e.g. with cd command) and run the analysis from there. Otherwise you have to specify the full path in the partition file: #nexus BEGIN SETS; CHARSET COI = \\IQtree\\COI_and_HSP_14_04_2020\\ALN\\COI.fas:CODON5, *; CHARSET HSP = \\IQtree\\COI_and_HSP_14_04_2020\\ALN\\HSP.fas:CODON1, *; charpartition mine = GY+F+R9:COI, MGK+F3X4+R4:HSP; END; Please note that do not add the drive \u201cF:\u201d into the path because it contains the colon, causing IQ-TREE to misparse the file. So you have to run IQ-TREE from the F drive. Cheers Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1a2faad1-7a91-482e-a6e0-dc02a399c605%40googlegroups.com <partitions_COI_hsp.nex.log> <partitions_COI_hsp.nex> "]}, "T6rMkzCgjwc": {"topic": "How to run iqtree in a slurm parallel system?", "initializeDate": "Sep 19, 2018, 11:56:22 PM", "timeStamp": "Sep 20, 2018, 4:15:07 AM", "content": ["The lastest version of iq-tree is MPI inplanted. But when trying to start a iq-tree job in slurm system, with command srun iqtree s seq 2000 ntmax48 There is 24 CUPs in each node, but iq-tree was interrupted with error message: ERROR You have specified more threads than CPU cores available --- srun iqtree s seq 2000 nt AUTO ntmax48 This command can run without error, but iq-tree only use 24 CUPs. --- Could you please shoe me how to utilize CUP for iq-tree in a slurm system. ", "Hello Ye, You need to use mpirun. E.g., srun -N2 -n48 mpirun -np 2 iqtree -nt 24 ... This will run two iqtree processes with 24 threads each. You just need to make sure that those two processes run on the two different nodes that you reserve! Regards, Dominik ", "I just checked, and it seems that slurm can now directly run MPI programs (--mpi). See https://slurm.schedmd.com/mpi_guide.html On September 20, 2018 5:56:22 AM GMT+02:00, Chang Ye < yech...@gmail.com > wrote: ", "Seems that there is multiple mpi type available on the cluster. Which one is the right choice for iq-tree? srun mpi list srun MPI types are ... srun mpi mpichgm srun mpi mpichmx srun mpi mpich1_p4 srun mpi pmi2 srun mpi mpich1_shmem srun mpi openmpi srun mpi none srun mpi lam srun mpi mvapich BTW, will the command become: srun n48 mpi openmpi iqtree ... ", "or just srun n48 mpi openmpi iqtree ... will `-nt AUTO` work in mpi process srun n48 mpi openmpi iqtree nt AUTO ... ", "It taking a very long time to initiate mpi process when run iqtree with this command. The the job failed with such error message: ``` error: cn7032: tasks 120-121,123-125,127,129-136,138-139,141-143: Floating point exception error: cn7032: tasks 122,126,128,140: Floating point exception (core dumped) ``` "]}, "3YuZCFeTz2U": {"topic": "Random Starting Tree: Algorithm implementation", "initializeDate": "Sep 14, 2015, 10:17:19 AM", "timeStamp": "Sep 14, 2015, 12:44:47 PM", "content": ["Hello, I am a new user trying out the 1.3.9 omp version for Linux. I would like to ask how does the algorithm proceed when you use a random starting tree (i.e. -t RANDOM). The default is 100 MP trees if i am not mistaken, which are being filtered for the candidate tree set. Is this the same with the -t RANDOM option, and if yes how is the candidate tree set generated in this case? Many thanks and best wishes Alex Vasilikopoulos ", "Dear Alex, > On 14 Sep 2015, at 16:17, alexva...@gmail.com wrote: > Hello, > I am a new user trying out the 1.3.9 omp version for Linux. please do not use the unreleased version 1.3.9, it is for my collaborators for thorough testing before the official release. The current release is 1.3.8 > I would like to ask how does the algorithm proceed when you use a random starting tree (i.e. -t RANDOM). The default is 100 MP trees if i am not mistaken, which are being filtered for the candidate tree set. Is this the same with the -t RANDOM option, and if yes how is the candidate tree set generated in this case? \"-t RANDOM\u201d right now starts tree search from one random starting tree (ver. 1.3.8). Thus, the initial candidate set contains only 1 tree. However, I am thinking about changing this to 100 random starting trees to be consistent with the default 100 MP trees. This also may give a better initial sampling of the tree space. Finally, to be sure: please note that for this random starting tree option, you may need a very long alignment (i.e. with a lot of phylogenetic information), such that the search algorithm is able to converge. Otherwise (short alignment) IQ-Tree may get stuck in local optimum because the starting trees are too far from optimum. Cheers, Minh > Many thanks and best wishes > Alex Vasilikopoulos > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at "]}, "vm2vHBj0l8E": {"topic": "-te with -bb", "initializeDate": "Jul 6, 2016, 5:48:49 PM", "timeStamp": "Jul 7, 2016, 4:45:56 AM", "content": ["Is it permissible to combine -te with -bb? The UFBoot values are then extremely high. But the -alrt and -abayes values look plausible. Thank you. ", "Hi there, > On Jul 6, 2016, at 11:48 PM, Trevo...@anu.edu.au wrote: > Is it permissible to combine -te with -bb? No, this should not be combined! -te is to fix one tree, whereas -bb does tree sampling to obtain UFBoot supports. That\u2019s why these two options do not fit together. I will disallow this combination for the next release, thanks for pointing this out. > The UFBoot values are then extremely high. due to the reason above > But the -alrt and -abayes values look plausible. Thank you. -te and -alrt and -abayes are perfectly fine, as these two branch tests work on a tree topology. Cheers, Minh ", "Thanks for clear explanation. Disallowing with message would be great. Cheers, T "]}, "95T3W03Hv_w": {"topic": "IQ-TREE release 1.5.1", "initializeDate": "Nov 8, 2016, 4:23:52 PM", "timeStamp": "Nov 8, 2016, 4:23:52 PM", "content": ["Nov 8, 2016 Dear users, We are pleased to announce version 1.5.1 with special focus on huge data sets and supercomputing with following new features: Merged the parallel MPI version with much better parallel efficiency and scalability. The old MPI version is deprecated. Memory saving mode via a new -mem option to restrict RAM usage, helpful for complex mixture models. For example, -mem 64G to use at most 64 GB. By default, IQ-TREE will try to fit the computer RAM size. Note that this mode does not work with partition models yet. Safe numerical mode for huge data sets to avoid \u201cNumerical underflow\u201d errors. This mode is automatically turned on when having more than 2000 sequences. It can be manually turned on via -safe option. New option -nt AUTO to automatically determine best number of threads in multicore version. Support AVX2 instructions. Best, IQ-TREE development team "]}, "mxxJuI9MUXk": {"topic": "invalid \"--tree-fix\" option", "initializeDate": "Nov 18, 2020, 8:46:31 AM", "timeStamp": "Dec 2, 2020, 8:34:10 AM", "content": ["Hi everyone, I think the help menu is not up to date. Up to version 2.0.7 iqtree2 -h gives this line: --tree-fix Fix -t tree (no tree search performed) But when I try to use this option I get the invalid \"--tree-fix\" option error message. Is there something obvious I'm missing? ", "Hi there, Thanks for noticing this. This is a bug in the code while parsing this option. For now please use -te TREE_FILE option. That will have the effect of fixing a user input tree. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4a1b9fea-3914-465a-852c-4299f716e6fdn%40googlegroups.com ", "Ok I will. Thanks! Julien "]}, "k8AJTUeEvew": {"topic": "Phylogenetic dating - calibration and confidence intervals", "initializeDate": "Jun 5, 2020, 8:32:03 PM", "timeStamp": "Jun 19, 2020, 9:36:19 PM", "content": ["Hello, I am trying the phylogenetic dating feature of IQtree2 (with Windows). I have run a few analyses on a DNA alignment with a starting tree from RAxML, and setting an ancestral date to calibrate the tree. To begin, I tried to calibrate one node with a date file. I made a date file listing the names of 9 taxa and an age for the common ancestor [taxa1,taxa2,taxa3,taxa4,taxa5,taxa6,taxa7,taxa8,taxa9 -20]. Command line: iqtree2 -s alignment.phy --date datefile3.txt --date-tip 0 -te RAxML_bestTree_rooted.newick However, in the output .nex tree file, a different node has this age; the node is 2 nodes basal to the intended node. It seems to me that the wrong node has been calibrated. I have checked the datefile, but it includes only the 9 taxa that descended from the node which I wanted to set as the calibration point. I've re-run the analysis, without a starting tree, but had the same problem with the calibration. In another analysis, I used the same alignment, the same tree, and the same datefile, but added a partition file to the command line. This resulted in a node from another clade having the age from the datefile. This remained the same if I added a second calibration point to the datefile. iqtree2 -s alignment.phy -p partition.txt --date datefile3.txt --date-tip 0 -te RAxML_bestTree_rooted.newick Is there a specific format for the date file that could be causing this problem? I have the names separated with commas and a tab separating the taxa from the age of the common ancestor. The second question I have is about the confidence intervals. In the analyses I've run, the confidence intervals are all one-sided, where I'm used to seeing 2-sided confidence intervals. I used \"--date-ci 100\" in the command line to get the confidence intervals. For most analyses I tried, the confidence intervals are all older (more negative) than the estimates (tMRCA -113.123 [-155.976; -113.123]) but for a few analyses I had confidence intervals that were younger than the estimates (tMRCA -73.0248 [-73.0248; -39.635]). Are these confidence intervals meant to be centered on the nodes? Or should an interval of equal size be applied to both sides of tMRCA? Thanks, Tricia ", "Hi Tricia, Sorry I overlooked your email. I forward to Hien, the author of LSD2, who may have an answer\u2026 Please update this version https://github.com/Cibiv/IQ-TREE/releases/tag/v2.0.6 . Hien has fixed several issues in LSD2. Your date file seems OK. If the problem persists pls let us know. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/01efc207-bc17-40cf-b3a4-4bf429ef2d9bo%40googlegroups.com ", "Hi Minh and Hien, Thank you for your responses to my issue. I have downloaded v.2.0.6 and this fixed the issue with the calibration of the node. I had another issue with not being able to visualize the confidence intervals in FigTree from the analysis I made in IQTree v.2.0.6 (Windows). I opened the nexus file in a text editor and removed all the quotation marks, and then the confidence intervals could be viewed in FigTree. Thank you both for your help. Best regards, Tricia Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "IbMwKcM39kY": {"topic": "BUG: Inconsistent behavior of UF Bootstrap", "initializeDate": "Jul 29, 2020, 6:39:07 PM", "timeStamp": "Aug 2, 2020, 10:58:42 PM", "content": ["Hi, I seem to have potentially stumbled onto a pathological edge case in the UF Bootstrap function for simulated four taxon alignments with very short branches. For sequences above ~10,000 nt, the sequence order in the FASTA file A,B,C,D consistently produces lower Ultrafast Bootstrap support values than C,A,B,D (support ~73 vs. ~81). This pattern is not found in shorter alignments or longer alignments. However, there seem to be pathologically higher support values <9,000 nt (support ~73) than >11,000 nt (support ~81), with a jump occurring when alignments are >10,000 nt. Happy to share the alignments, trees, and log files. Version: IQ-TREE multicore version 2.0.4 for Mac OS X 64-bit built Apr 27 2020 IQTree2 command: >iqtree2 -m JC -s FourTaxon.fasta -B 10000 Cheers, Joel Wertheim ", "Hi Joel, Can you tell me, how the true tree looks like? I don\u2019t really get, what you meant with \u201corder\u201d? When you say \"C,A,B,D\u201d, what tree topology is that? Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/71bda60b-b3c5-4e92-a8cd-d4e310c0d045o%40googlegroups.com "]}, "y87RYPp_2rA": {"topic": "protein partition model", "initializeDate": "Aug 25, 2015, 7:23:43 PM", "timeStamp": "Dec 10, 2015, 10:16:19 AM", "content": ["Hi Minh, Not sure if the following question was asked. For the partition model, is there a way that the alpha parameter and the branch lengths are NOT estimated separately for each partition? Huaichun ", "To clarify Huaichun's question, I guess we want to use the -spj option to have branchlengths for the whole alignment rather than for the partitions and we also don't want alpha shape parameter to be partition-speciifc -- rather we want it to be estimated on the whole alignment too. In this case, only the substitution model (amino acids) would be different for each partition. Is this possible? Cheers Andrew Roger ", "Dear Huaichun and Andrew, Unfortunately, it is currently not possible to estimate the alpha shape parameter on the whole alignment for the partitioned models. We can of course add this feature in the next release of IQ-TREE. Cheers Tung You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi all, I have also some questions related to this (and few more) 1) if using unlinked for the brlength in an partitioned analyses - are there all estimated indivudually and separately like in RAxML or is there also a scaling option included (you can choose) like e.g. in other software? If not - do you plan to implement this ? 2) I could not figure out from the latest release whether the LG4X model is also implemented in the partition merging approach (earlier it was not) - has this been implemented 3) Can you let me know as soon as been implemented to run ML tree searches based on completely randomized starttrees please (automatically) Many many thanks from Oz Karen ", "Hi Karen, On 26 Aug 2015, at 17:28, Karen Meusemann < kmeus...@googlemail.com > wrote: Hi all, I have also some questions related to this (and few more) 1) if using unlinked for the brlength in an partitioned analyses - are there all estimated indivudually and separately like in RAxML or is there also a scaling option included (you can choose) like e.g. in other software? If not - do you plan to implement this ? all these models are already implemented: -q <partition_file> Edge-linked partition model (file in NEXUS/RAxML format) -spp <partition_file> Like -q option but allowing partition-specific rates -sp <partition_file> Edge-unlinked partition model (like -M option of RAxML) 2) I could not figure out from the latest release whether the LG4X model is also implemented in the partition merging approach (earlier it was not) - has this been implemented no this was not implemented. But you can add candidate models for selection via -mset option. 3) Can you let me know as soon as been implemented to run ML tree searches based on completely randomized starttrees please (automatically) yes this is just added since version 1.3.7 via option: -t <start_tree_file> | BIONJ | RANDOM Starting tree (default: 100 parsimony trees and BIONJ) So \u201c-t RANDOM\u201d does the job Many many thanks from Oz sure ;-) Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Hi Minh,, thanks so much, just some short back questions 1) if using unlinked for the brlength in an partitioned analyses - are there all estimated indivudually and separately like in RAxML or is there also a scaling option included (you can choose) like e.g. in other software? If not - do you plan to implement this ? all these models are already implemented: -q <partition_file> Edge-linked partition model (file in NEXUS/RAxML format) -spp <partition_file> Like -q option but allowing partition-specific rates -sp <partition_file> Edge-unlinked partition model (like -M option of RAxML) so in the raxml google group we found this (see below) so from your description the -spp is similar to Model 2 ? (roughly?) that would be awesome :) https://groups.google.com/forum/#!topic/raxml/BXn1ETluavk \"Model 1 assumes that edge lengths for each partition are equal. This is an extreme model for partitions of varying rates, e.g. 2nd codon positions vs. 3rd codon positions, or protein-coding vs. non-coding; a pretty biologically unrealistic model. Model 2 breaks this restriction: although edge lengths must be perfectly proportional across partitions, they can nonetheless be of arbitrarily different magnitudes, say 50X different. This is an economical way to treat among-partition rate heterogeneity, as you are only adding P extra parameters to the model. At the other extreme (the unlinked EL model), you estimate distinct edge length vectors for each partition = P X (2N-3) extra parameters. In other words, a pretty statistically unrealistic model, especially if N is large. Model 2 is the best choice of the three, in accommodating rate heterogeneity while avoiding overparameterization. This is the default behaviour for many programs that allow among-partition rate heterogeneity, e.g. GARLI or MrBayes (and, I assume, RAxML). In MrBayes you can test each EL model. For trees of 13 taxa the unlinked model may fare well, but as N gets large you need an immense increase in likelihood to justify the extra parameters. This would be the case if ELs showed absolutely no correlation across partitions (while still sharing the same topology), but this isn't observed. Alexis: Actually my equation is correct, RAxML doesn't use branch length scalers in which case Joseph's equation would be correct, but RAxML does indeed conduct completely independent branch length estimates for each partition. 2) I could not figure out from the latest release whether the LG4X model is also implemented in the partition merging approach (earlier it was not) - has this been implemented no this was not implemented. But you can add candidate models for selection via -mset option. okay great. Are you planning implementing it? (or not because you can add it anyway? 3) Can you let me know as soon as been implemented to run ML tree searches based on completely randomized starttrees please (automatically) yes this is just added since version 1.3.7 via option: -t <start_tree_file> | BIONJ | RANDOM Starting tree (default: 100 parsimony trees and BIONJ) So \u201c-t RANDOM\u201d does the job cool :))))) (sorry I missed this (to many releases), but I really appreciate all bug fixes that are dome so quickly ! (we start on new analyses now with more final datasets so I will definitely come back to you. Currently you are still improving a lot - so shall I wait rather for new releases?) karen ", "Dear Karen, For 1) yes, -spp is exactly Model 2. I would recommend this option for partition model analysis. -q option (or -spj) is for compatibility with RAxML. 2) I added this into TODO list cool :))))) (sorry I missed this (to many releases), but I really appreciate all bug fixes that are dome so quickly ! (we start on new analyses now with more final datasets so I will definitely come back to you. Currently you are still improving a lot - so shall I wait rather for new releases?) 3) you are right - I will change the releasing behaviour, so that only stable release is announced, the minor change will only be updated as beta release. For your need: please wait until LG4M/LG4X stuff is done/added to model selection. I will tell you when it is ready. Cheers, Minh ", "Dear Andrew and Huaichun, such an option is not easy to implement. However, if you have a good reason for such linked alpha parameter to be beneficial, then I will consider implementing it. Nevertheless, right now you can input and fix an alpha parameter into IQ-Tree via nexus partition file. Such an alpha can be obtained from e.g. MrBayes, or a single model analysis on the concatenated alignment with IQ-Tree. Cheers, Minh ", "Hi Minh, > Nevertheless, right now you can input and fix an alpha parameter into IQ-Tree via nexus partition file. Such an alpha can be obtained from e.g. MrBayes, or a single model analysis on the concatenated alignment with IQ-Tree. I wondered how to input and fix an alpha parameter in an iqtree command line, for partition as well as non-partition models. Thanks. Huaichun ", "Hi Huaichun, For non-partition model: simply via -m command. For example: iqtree -s alignment -m \"GTR+G{0.5}\" to specify alpha = 0.5 for Gamma distribution across sites iqtree -s alignment -m \u201cGTR{1.0,2.0,1.5,2.0,3.0,1.0}+G{0.5}\u201d to additionally specify six rates of GTR model (dont forgot the quote for -m) For partition model: via Nexus partition file. An example of such partition file: #nexus begin sets; charset p1= 1-100; charset p2= 101-384; charpartition mine = GTR+G{0.5}: p1, GTR{1.0,2.0,1.5,2.0,3.0,1.0}+G{0.5}: p2; end; hope that helps, Minh ", "Dear Andrew, version 1.3.11 introduces option --link-alpha for this purpose. Cheers, Minh "]}, "MYzFAnxwVDc": {"topic": "How to create MrBayes block from ModelFinder results", "initializeDate": "Oct 3, 2018, 9:26:16 AM", "timeStamp": "Oct 5, 2018, 2:17:09 AM", "content": ["Hi, I've used the results obtained from ModelFinder to build a block for MrBayes, and I am experiencing some problems. So to recap, I've partitioned my alignment by codon (coding) and gene (non coding), and I've launched IQ-Tree to find the best partition scheme as well as build an ML tree as per manual (-spp partition.nex -m MFP+MERGE -bb 1000 -alrt 1000 -mset mrbayes) partition.nex contains information on the different alignments present and their lengths + positions. Note that from the manual it is stated that you should add your alignment file using the code -s but however I did not do that step as I had two different alignment files, IQ-Tree does not take concatenate alignment. From the resulting files, I've opened the .iqtree file to obtain all information on the models and parameters used. In my case, my data was partitioned as follows (obtained from best_scheme.nex file): #nexus begin sets; charset codon1 = cox3.nex: 1-415\\3; charset codon2_codon3 = cox3.nex: 2-415\\3 3-415\\3; charset noncoding = 28S.nex: 1-306; charpartition mymodels = GTR+F+G4: codon1, HKY+F+G4: codon2_codon3, HKY+F+I+G4: noncoding; end; and the parameters obtained from iqtree.file: ID Model Speed Parameters 1 GTR+F+G4 2.6061 GTR{0.28126,1.50408,0.166383,1.46124,2.90605}+F{0.464769,0.065939,0.0756066,0.393686}+G4{2.53161} 2 HKY+F+G4 0.8085 HKY{4.1595}+F{0.302225,0.174265,0.158477,0.365033}+G4{0.273164} 3 HKY+F+I+G4 0.4431 HKY{13.85}+F{0.170223,0.261076,0.358532,0.210168}+I{0.735756}+G4{0.487189} So my MrBayes block was constructed as per information above: Begin MrBayes; charset codon1 = 1-415\\3; charset codon2 = 2-415\\3; charset codon3 = 3-415\\3; charset noncoding = 416-721; partition my_partition = 4: codon1, codon2, codon3, noncoding; set partition = my_partition; outgroup 1; lset applyto=(1) nst=6 rates=gamma ngammacat=4; prset applyto=(1) statefreq=fixed(0.464769,0.065939,0.0756066,0.393686) shapepr=fixed(2.53161) revmat=fixed(0.28126,1.50408,0.166383,1.46124,2.90605); lset applyto=(2,3) nst=2 rates=gamma ngammacat=4; prset applyto=(2,3) statefreq=fixed(0.302225,0.174265,0.158477,0.365033) shapepr=fixed0.273164) revmat=fixed(4.1595); lset applyto=(4) nst=2 rates=invgamma ngammacat=4; prset applyto=(4) statefreq=fixed(0.170223,0.261076,0.358532,0.210168) pinvar=fixed(0.735756) shapepr=fixed(0.487189) revmat=fixed(13.85); However, this seems not to be working in MrBayes with an error in the prset command. I am not sure if I've missed a step somewhere. Any help will be appreciated. With thanks Olivier ", "Dear all, I think I 've sort out the error in MrBayes from model obtained from ModelFinder. I have not specified all 6 priors for the substitution rate categories in the \"revmat\" command. The priors are obtained in the .ckp file If there is anything which was done wrong, kindly let me know. With thanks Olivier ", "Hi Olivier, I see, the six rates are printed to the checkpoint file in the following order: A-C, A-G, A-T, C-G, C-T, G-T. If that same order is treated in MrBayes (I don\u2019t know for sure), then this should be fine. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "GnUR0k1ayBQ": {"topic": "BUG: IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT (core dumped)", "initializeDate": "Feb 23, 2021, 8:26:32 AM", "timeStamp": "Feb 24, 2021, 11:45:38 PM", "content": ["Dear developers, I have first been running IQ-TREE v1.6.12 on my alignment without specifying any partitions and the run went fine. However, when running now by specifying partitions, I get segmentation fault error. Please find beginning and end of the log file below. Thanks in advance for your reply. Best, Simon ------------------------------------------------------- BEGINNING ------------------------------------------------------- IQ-TREE multicore version 1.6.12 for Linux 64-bit built Aug 15 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: deigo010915.oist.jp (AVX2, FMA3, 503 GB RAM) Command: iqtree -s supermatrix.nex -spp all_partitions.nex -nt AUTO -ntmax 24 -mem 10G Seed: 566713 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Tue Feb 23 21:22:29 2021 Kernel: AVX+FMA - auto-detect threads (128 CPU cores detected) Reading partition model file all_partitions.nex ... Reading alignment file supermatrix.nex ... Nexus format detected ------------------------------------------------------- END ------------------------------------------------------- Loading 5 partitions... Subset Type Seqs Sites Infor Invar Model Name 1 320 2933 1664 916 rRNA 2 326 1922 975 716 tRNA 3 326 3939 2019 1561 coding_first 4 326 3939 2127 1493 coding_second 5 326 3938 2499 1097 coding_third Degree of missing data: 0.003 Info: multi-threading strategy over partitions Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.582 seconds NOTE: ModelFinder requires 1197 MB RAM! NUMBER OF THREADS FOR PARTITION FINDING: 5 Testing GTR+F+G on supermatrix... GTR+F+G4 / LnL: -1053664.626 / df: 658 / AIC: 2108645.251 / AICc: 2108699.413 / BIC: 2113725.950 Selecting individual models for 5 charsets using BIC... No. Model Score Charset 1 GTR+F+R5 137405.745 tRNA 2 GTR+F+I+G4 278265.320 rRNA 3 GTR+F+R5 485433.650 coding_first 4 GTR+F+R5 514751.069 coding_second 5 GTR+F+R5 655716.423 coding_third Full partition model BIC score: 2078001.114 (LnL: -1035466.819 df:727) Partition information was printed to all_partitions.nex.best_scheme.nex Partition information in Raxml format was printed to all_partitions.nex.best_scheme All model information printed to all_partitions.nex.model.gz CPU time for ModelFinder: 11042.569 seconds (3h:4m:2s) Wall-clock time for ModelFinder: 3254.475 seconds (0h:54m:14s) NOTE: 574 MB RAM (0 GB) is required! Measuring multi-threading efficiency up to 24 CPU cores ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: all_partitions.nex.log ERROR: *** Alignment files (if possible) /var/spool/slurmd/job5848028/slurm_script : ligne 57 : 95727 Erreur de segmentation (core dumped)iqtree -s $ALIGNMENT -spp ${WORKDIR}/${ANALYSIS_ALL}.nex -nt AUTO -ntmax ${SLURM_CPUS_PER_TASK} -mem 10G ", "Hi, I think I narrowed it to down to multi-threading issues. I restarted the run without specifying -nt and -ntmax with the below command and the run could complete: iqtree -s $ALIGNMENT -spp ${WORKDIR}/${ANALYSIS_ALL}.nex -redo Best, Simon ", "Hi Simon, Does it work, if you specify something like -nt 10, instead of -nt AUTO? That means, tell IQ-TREE the specific number of threads, instead of asking IQ-TREE to determine it. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b6d2d7ad-058d-47a0-9b43-c007d98b8bb9n%40googlegroups.com ", "Dear Minh, Thank you for your reply. Specifying the number of threads was actually my first test. I specified -nt to 24, which gave me a lot of the same warning followed by the same crash reported above: WARNING: Number of threads seems too high for short alignments. Use -nt AUTO to determine best number of threads. I am currently running it again with -nt set to 10 and will let you know how that goes. Best, Simon ", "Hi Minh, The job with -nt 10 crashed as reported with -nt AUTO. Best, Simon ", "Hi Simon, I look more carefully now. You have only 5 partitions. And IQ-TREE even said: NUMBER OF THREADS FOR PARTITION FINDING: 5 So can you rerun with -nt 5? Anyway please send me the data, I\u2019ll try to fix this bug. IQ-TREE shouldn\u2019t have crashed, but do something about small datasets like this to limit the number of threads. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/56783c6b-ac85-4b39-81d5-7a55b11ed6d1n%40googlegroups.com ", "Hi Minh, I just tried with -nt 5 but the same crash occurs unfortunately. I just sent you the data for you to have a look at it. Best, Simon "]}, "pNvokBzfioo": {"topic": "Comparing best scores between runs", "initializeDate": "Mar 17, 2018, 10:51:28 AM", "timeStamp": "Mar 20, 2018, 9:29:56 AM", "content": ["Hi, In RAxML loglikelihood values are not comparable between runs. Are log likelihood / best score values comparable between runs using IQ-tree? ", "Dear Jacob, If the underlying dataset and evolutionary model are identical, the log-likelihoods between trees from runs of the same program should be comparable. Do you know any reason why this should not be the case in RAxML? I seem to remember that the RAxML manual mentions that you have to re-estimale log-likelihoods from different programs with the same program to obtain comparable values. Best regards, Heiko > On 17 Mar 2018, at 15:51, Jacob Steenwyk < jlste...@gmail.com > wrote: > Hi, > In RAxML loglikelihood values are not comparable between runs. Are log likelihood / best score values comparable between runs using IQ-tree? > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "I have not run RAxML on this data set yet, but when I run PHYML and IQ-tree on the data I get essentially identical scores for both, using the same data and similar program settings (output below). An neighboring region of the same genomes gives quite different results. The tree topology is quite similar but many factors such as the relative rate of C-T vs A-G mutations observed is more than 4-fold different between the two regions. The two regions of the genome I tested are only a few hundred bases apart, each region is about 800 bases long. AT:GC content is quite similar between the two regions the entire genomes of these viruses are consistently A-rich and C-poor. I would suspect that the huge difference in the ratio of G-A:C-T mutations observed in the two neighboring regions is mostly or all due to selection pressure differences and not due to underlying base substitution rate differences. Anyway, I cannot think of any reason why a single program (RAxML) used the same way on the same data would not give the same results (or very very close) on each run. How different are your results from run to run? ========= IQ-TREE: A fast and effective stochastic algorithm for estimating maximum likelihood phylogenies. Mol. Biol. Evol., 32:268-274. http://dx.doi.org/10.1093/molbev/msu300 SEQUENCE ALIGNMENT ------------------ Input data: 63 sequences with 694 nucleotide sites Number of constant sites: 364 (= 52.4496% of all sites) Number of invariant (constant or ambiguous constant) sites: 364 (= 52.4496% of all sites) Number of distinct site patterns: 333 SUBSTITUTION PROCESS -------------------- Model of substitution: GTR+F+R8 Rate parameter R: A-C: 1.9776 A-G: 3.2692 A-T: 0.6819 C-G: 0.4257 C-T: 7.3702 G-T: 1.0000 State frequencies: (empirical counts from alignment) pi(A) = 0.3874 pi(C) = 0.1492 pi(G) = 0.2432 pi(T) = 0.2202 Rate matrix Q: A -0.7834 0.1864 0.5022 0.09483 C 0.4838 -1.574 0.06539 1.025 G 0.7998 0.04012 -0.979 0.1391 T 0.1668 0.6946 0.1536 -1.015 Model of rate heterogeneity: FreeRate with 8 categories Site proportion and rates: (0.2415,0.0001269) (0.1498,0.002529) (0.1293,0.2965) (0.109,0.3132) (0.05505,0.542) (0.1842,1.697) (0.09313,3.416) (0.03803,7.006) Category Relative_rate Proportion 1 0.0001269 0.2415 2 0.002529 0.1498 3 0.2965 0.1293 4 0.3132 0.109 5 0.542 0.05505 6 1.697 0.1842 7 3.416 0.09313 8 7.006 0.03803 MAXIMUM LIKELIHOOD TREE ----------------------- Log-likelihood of the tree: -8081.6459 (s.e. 367.3025) Unconstrained log-likelihood (without tree): -2921.4689 Number of free parameters (#branches + #model parameters): 145 Akaike information criterion (AIC) score: 16453.2918 Corrected Akaike information criterion (AICc) score: 16530.5545 Bayesian information criterion (BIC) score: 17111.9502 Total tree length (sum of branch lengths): 2.4551 Sum of internal branch lengths: 0.6526 (26.5832% of tree length) ======= ======= . Sequence filename: A1-A6_PlusRefs-4791-5478region.FASTA . Data set: #1 . Tree topology search : NNIs . Initial tree: BioNJ . Model of nucleotides substitution: GTR . Number of taxa: 63 . Log-likelihood: -8091.88275 . Unconstrained likelihood: -2921.46891 . Parsimony: 1447 . Tree size: 2.60881 . Discrete gamma model: Yes - Number of categories: 8 - Gamma shape parameter: 0.688 . Proportion of invariant: 0.345 . Nucleotides frequencies: - f(A)= 0.38735 - f(C)= 0.14923 - f(G)= 0.24324 - f(T)= 0.22018 . GTR relative rate parameters : A <-> C 2.01652 A <-> G 3.23357 A <-> T 0.68237 C <-> G 0.42950 C <-> T 7.59203 G <-> T 1.00000 . Instantaneous rate matrix : [A---------C---------G---------T------] -0.77548 0.18854 0.49280 0.09414 0.48940 -1.60221 0.06546 1.04736 0.78476 0.04016 -0.96288 0.13795 0.16561 0.70984 0.15240 -1.02785 . Run ID: none . Random seed: 1521408702 . Subtree patterns aliasing: no . Version: 20120412 . Time used: 0h2m29s (149 seconds) ======= ", "I used RAxML on the CIPRES server today, and it gives me essentially identical results as I got from PhyML and IQ-tree. ========= Final ML Optimization Likelihood: -8094.993189 Thorough ML search on Process 5: Time 3.737479 seconds processID = 5, bestLH = -8095.983564 Model Information: Model Parameters of Partition 0, Name: No Name Provided, Type of Data: DNA alpha: 0.871991 invar: 0.411325 Tree-Length: 2.750827 rate A <-> C: 2.000321 rate A <-> G: 3.213965 rate A <-> T: 0.683432 rate C <-> G: 0.425764 rate C <-> T: 7.604281 rate G <-> T: 1.000000 freq pi(A): 0.387350 freq pi(C): 0.149229 freq pi(G): 0.243239 freq pi(T): 0.220183 ML search took 15.577952 secs or 0.004327 hours Combined Bootstrap and ML search took 55.508033 secs or 0.015419 hours =========== https://www.phylo.org/portal2/home.action If you use the resources available from the CIPRES Science Gateway to complete published work, please cite us as follows: Miller, M.A., Pfeiffer, W., and Schwartz, T. (2010) \"Creating the CIPRES Science Gateway for inference of large phylogenetic trees\" in Proceedings of the Gateway Computing Environments Workshop (GCE), 14 Nov. 2010, New Orleans, LA pp 1 - 8. ", "Hi, Thank you very much for all of your replies. Regarding the difference between RAxML runs, I think this largely has to do with setting the seed and I think the same goes for IQ-tree with only small negligible differences much like RAxML. Again, thank you for all your answers! best, Jacob You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/pNvokBzfioo/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+unsubscribe@googlegroups.com ", "Ah I see what you mean now. IQ-TREE can also produce a different tree with different log-likelihood from different runs due to stochasticity. However, the log-likelihoods are still comparable. That was what confusing in the first place. Hope that things are clear now. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com ", "Sorry about the confusion and thank you again for everyone's helpful and prompt responses! Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com "]}, "ux9bvgnNBCk": {"topic": "Segmentation fault on IQtree mpi 1.5.4 on cluster", "initializeDate": "Apr 10, 2017, 7:22:28 AM", "timeStamp": "Apr 25, 2017, 2:51:56 AM", "content": ["Dear Minh, I launch IQtree 1.5.4 on the cluster of my institute and sometime it crashed with a segmentation fault during the optimizing step. I launch with the command line : iqtree mpi FirmicutesSmall grp aln st AA pre FirmicutesSmall grp 1000 wbtl 6000 m LG R10 And I backtrack the error from the core file : #0 0x00000000004e2d54 in errstreambuf::overflow(int) () #1 0x00007f8cdf8c048a in std::basic_streambuf<char, std::char_traits<char> >::sputc (__c=10 '\\n', this=<optimized out>) at /tmp/build/x86_64-unknown-linux-gnu/libstdc++-v3/include/streambuf:434 #2 std::ostream::put (this=this@entry=0xa44c00 <std::cerr>, __c=<optimized out>) at /tmp/build/x86_64-unknown-linux-gnu/libstdc++-v3/include/bits/ostream.tcc:163 #3 0x00007f8cdf8c06bf in std::endl<char, std::char_traits<char> > (__os=...) at /tmp/build/x86_64-unknown-linux-gnu/libstdc++-v3/include/ostream:565 #4 0x00000000004e3771 in funcAbort () #5 <signal handler called> #6 0x00000000004965b1 in IQTree::saveUFBoot(Checkpoint*) () #7 0x000000000049c04b in IQTree::syncCurrentTree() () #8 0x00000000004a0ac4 in IQTree::doTreeSearch() () #9 0x0000000000513448 in runTreeReconstruction(Params&, std::string&, IQTree&, std::vector<ModelInfo, std::allocator<ModelInfo> >&) () #10 0x000000000051dfd8 in runPhyloAnalysis(Params&, Checkpoint*) ( #11 0x00000000004f3e0d in main () Thank you for your help R\u00e9mi PS : is you want all the information of the core file I could send you it. ", "Dear Remi, from the trace I think it is the -wbtl option that caused the crash. I did not test this option for MPI version. Thus, will do some local test before getting back to you. But for the moment, you can still complete the run by removing this option\u2026 then IQ-TREE should be able to recover from the checkpoint and finalize the last step. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, I launched my analysis again without the -wbtl option, and it seems to have the same segmentation fault problem. The trace back of the segmentation fault : Program terminated with signal SIGSEGV Segmentation fault #0 0x00000000004e2d54 in errstreambuf::overflow(int) () [Current thread is 1 (Thread 0x7f8be2710720 (LWP 8706))] gdb #0 0x00000000004e2d54 in errstreambuf::overflow(int) () #1 0x00007f8be1d4a48a in std::basic_streambuf<char, std::char_traits<char> >::sputc (__c=10 '\\n', this=<optimized out>) at /tmp/build/x86_64-unknown-linux-gnu/libstdc++-v3/include/streambuf:434 #2 std::ostream::put (this=this@entry=0xa44c00 <std::cerr>, __c=<optimized out>) at /tmp/build/x86_64-unknown-linux-gnu/libstdc++-v3/include/bits/ostream.tcc:163 #3 0x00007f8be1d4a6bf in std::endl<char, std::char_traits<char> > (__os=...) at /tmp/build/x86_64-unknown-linux-gnu/libstdc++-v3/include/ostream:565 #4 0x00000000004e3771 in funcAbort () #5 <signal handler called> #6 0x00000000004965b1 in IQTree::saveUFBoot(Checkpoint*) () #7 0x000000000049c04b in IQTree::syncCurrentTree() () #8 0x00000000004a0ac4 in IQTree::doTreeSearch() () #9 0x0000000000513448 in runTreeReconstruction(Params&, std::string&, IQTree&, std::vector<ModelInfo, std::allocator<ModelInfo> >&) () #10 0x000000000051dfd8 in runPhyloAnalysis(Params&, Checkpoint*) () #11 0x00000000004f3e0d in main () Also there is a problem in the log I don't understand, it said : WARNING Memory required per CPU core 38.2197 higher than your computer RAM per CPU core thus multiple runs may exceed RAM But I gave 50Go by cpu when I launched my analysis All the best, R\u00e9mi ", "Hi Remi, then to reproduce this behavior can you send me the data and all the output files via my personal email? The warning can be ignored, it is only relevant if you run multiple iqtree on this same data set on the same machine, then the total RAM usages over all runs may exceed your RAM. Thanks, Minh ", "Dear Remi, I had a look and noticed from your log file: Alignment has 353 sequences with 76053 columns and 71244 patterns Your alignment is long enough and thus the multicore version should scale well. Therefore to avoid delay while I am examining the MPI version, can you please use the multicore version to complete the analysis? Note that you can use -nt AUTO to determine the best number of cores. Thanks, Minh ", "Dear Minh, I already finished the analysis with multicore version just after the mail, with the files you wanted, that I sent you. So now I'm just waiting to know if the problem could be solve or not for future analysis of the same kind. Thanks for your help R\u00e9mi ", "Dear Remi, I now rethink that the warning is relevant, if you run all MPI processes in this one node. ************************************************ * START TREE SEARCH USING MPI WITH 70 PROCESSES * ************************************************ ... Host: tars-108 (AVX2, FMA3, 252 GB RAM) ... NOTE: 39136 MB RAM (38 GB) is required! WARNING: Memory required per CPU-core (38.2197 GB) is higher than your computer RAM per CPU-core (21 GB), thus multiple runs may exceed RAM! Let\u2019s say one process needs ~39GB RAM, therefore all 70 processes will need 39*70 = 2730 GB RAM. If all processes reside in this one host, then you will definitely exceed its 252 GB RAM. So can you tell me the MPI configuration? how many nodes are involved, how many processes per node, what are the RAM size of each node? The multicore version has an advantage, that the RAM usage is not multiplied by the number of cores like MPI version, but stays constant. I think I will need to write in the documentation about strategies to analyze big data in IQ-TREE. Cheers, Minh ", "Dear Minh, The MPI configuration I use is : \u2022 70 tasks (when the cluster lauched the job it was on 39 nodes) In maximum there are 2 job per node, and the ram size of each node it's different sometimes 64Go or 252Go ... But I check for each node when I'm asking 40Go per cpu in the node with more than one process the allocated memory was the number I ask (if two process on the same node I ask for this node 80Go) and also than in the node with more than one process the allocated RAM does not exceed the total node RAM. And I also check if there is still memory left on the node to be sure than I don't have fake memory allocation. So I don't think the problem only come from only in the memory allocation. I think I tried also, to be sure of that, to ask 40Go per cpu for 70 cpu and only one process per node so at the end I ask for 70 nodes so on each node I have one process we 40Go of allocated RAM. And there are still the segmentation fault when IQTree try to wrote the checkpoint or the UFBOOT tree (I think). And the warning message is still there even if I ask for 70 nodes (1 cpu per node and 40Go per cpu). Thank you for your help, I hope the problem will be solve because it's a pleasure to have a tree quickly with the MPI version of IQTree R\u00e9mi ", "Dear Remi, thanks for the clarification, which greatly helps to rule out the possibility of RAM overflow. So the issue is by IQ-TREE itself. Will have a look shortly... Minh On Apr 24, 2017, at 2:04 PM, r\u00e9mi Denise < remi....@gmail.com > wrote: Dear Minh, Thanks, Minh WARNING Memory required per CPU core 38.2197 higher than your computer RAM per CPU core thus multiple runs may exceed RAM "]}, "c1-X3lkan64": {"topic": "Composition test for each partition", "initializeDate": "Mar 10, 2017, 12:08:52 PM", "timeStamp": "Mar 15, 2017, 12:18:13 PM", "content": ["Hi, I wonder if I'm forgetting something when running IQTree with a codon position-partitioned dataset with the -ssp option... I'm always getting the exact same composition report for each partition. I've already double-checked that codon positions in the .nex files start at 1-, 2-, and 3-positions, as expected, so that's not the issue. Output was (taxon and MSA names omitted): Command line: $ ./iqtree-omp -spp nnnnn.nex -m TESTNEWMERGE -bb 1000 -nt 8 -seed 12345 ... Alignment has 24 sequences with 867675 columns and 16472 patterns (231739 informative sites, 545120 constant sites) Gap/Ambiguity Composition p-value 1 Taxon_xxxx 2.23% failed 0.00% 2 Taxon_xxxx 1.55% failed 0.00% 3 Taxon_xxxx 1.86% failed 0.00% 4 Taxon_xxxx 1.86% failed 0.00% 5 Taxon_xxxx 1.84% failed 0.00% 6 Taxon_xxxx 1.85% failed 0.00% 7 Taxon_xxxx 1.85% failed 0.00% 8 Taxon_xxxx 2.11% failed 0.00% 9 Taxon_xxxx 2.11% failed 0.00% 10 Taxon_xxxx 2.01% failed 0.00% 11 Taxon_xxxx 2.03% failed 0.00% 12 Taxon_xxxx 2.01% failed 0.00% 13 Taxon_xxxx 2.00% failed 0.00% 14 Taxon_xxxx 1.90% failed 0.00% 15 Taxon_xxxx 1.56% failed 0.00% 16 Taxon_xxxx 1.91% failed 0.00% 17 Taxon_xxxx 1.91% failed 0.00% 18 Taxon_xxxx 1.91% failed 0.00% 19 Taxon_xxxx 1.89% failed 0.00% 20 Taxon_xxxx 1.89% failed 0.00% 21 Taxon_xxxx 1.89% failed 0.00% 22 Taxon_xxxx 1.67% failed 0.00% 23 Taxon_xxxx 1.88% failed 0.00% 24 Taxon_xxxx 2.12% failed 0.00% **** TOTAL 1.91% 24 sequences failed composition chi2 test (p-value<5%; df=3) 24 sequences and 289225 sites extracted Reading partition codon_2 (model=TESTNEWMERGE, aln=nnnnn.fas, seq=, pos= 2-867675\\3) ... Reading alignment file nnnnn.fas ... Fasta format detected Alignment most likely contains DNA/RNA sequences Alignment has 24 sequences with 867675 columns and 16472 patterns (231739 informative sites, 545120 constant sites) Gap/Ambiguity Composition p-value 1 Taxon_xxxx 2.23% failed 0.00% 2 Taxon_xxxx 1.55% failed 0.00% 3 Taxon_xxxx 1.86% failed 0.00% 4 Taxon_xxxx 1.86% failed 0.00% 5 Taxon_xxxx 1.84% failed 0.00% 6 Taxon_xxxx 1.85% failed 0.00% 7 Taxon_xxxx 1.85% failed 0.00% 8 Taxon_xxxx 2.11% failed 0.00% 9 Taxon_xxxx 2.11% failed 0.00% 10 Taxon_xxxx 2.01% failed 0.00% 11 Taxon_xxxx 2.03% failed 0.00% 12 Taxon_xxxx 2.01% failed 0.00% 13 Taxon_xxxx 2.00% failed 0.00% 14 Taxon_xxxx 1.90% failed 0.00% 15 Taxon_xxxx 1.56% failed 0.00% 16 Taxon_xxxx 1.91% failed 0.00% 17 Taxon_xxxx 1.91% failed 0.00% 18 Taxon_xxxx 1.91% failed 0.00% 19 Taxon_xxxx 1.89% failed 0.00% 20 Taxon_xxxx 1.89% failed 0.00% 21 Taxon_xxxx 1.89% failed 0.00% 22 Taxon_xxxx 1.67% failed 0.00% 23 Taxon_xxxx 1.88% failed 0.00% 24 Taxon_xxxx 2.12% failed 0.00% **** TOTAL 1.91% 24 sequences failed composition chi2 test (p-value<5%; df=3) 24 sequences and 289225 sites extracted Reading partition codon_3 (model=TESTNEWMERGE, aln=nnnnn.fas, seq=, pos= 3-867675\\3) ... Reading alignment file nnnnn.fas ... Fasta format detected Alignment most likely contains DNA/RNA sequences Alignment has 24 sequences with 867675 columns and 16472 patterns (231739 informative sites, 545120 constant sites) Gap/Ambiguity Composition p-value 1 Taxon_xxxx 2.23% failed 0.00% 2 Taxon_xxxx 1.55% failed 0.00% 3 Taxon_xxxx 1.86% failed 0.00% 4 Taxon_xxxx 1.86% failed 0.00% 5 Taxon_xxxx 1.84% failed 0.00% 6 Taxon_xxxx 1.85% failed 0.00% 7 Taxon_xxxx 1.85% failed 0.00% 8 Taxon_xxxx 2.11% failed 0.00% 9 Taxon_xxxx 2.11% failed 0.00% 10 Taxon_xxxx 2.01% failed 0.00% 11 Taxon_xxxx 2.03% failed 0.00% 12 Taxon_xxxx 2.01% failed 0.00% 13 Taxon_xxxx 2.00% failed 0.00% 14 Taxon_xxxx 1.90% failed 0.00% 15 Taxon_xxxx 1.56% failed 0.00% 16 Taxon_xxxx 1.91% failed 0.00% 17 Taxon_xxxx 1.91% failed 0.00% 18 Taxon_xxxx 1.91% failed 0.00% 19 Taxon_xxxx 1.89% failed 0.00% 20 Taxon_xxxx 1.89% failed 0.00% 21 Taxon_xxxx 1.89% failed 0.00% 22 Taxon_xxxx 1.67% failed 0.00% 23 Taxon_xxxx 1.88% failed 0.00% 24 Taxon_xxxx 2.12% failed 0.00% **** TOTAL 1.91% 24 sequences failed composition chi2 test (p-value<5%; df=3) 24 sequences and 289225 sites extracted Degree of missing data: 0.000 Info: multi-threading strategy over alignment sites NOTE: minimal branch length is reduced to 0.000000115251 for long alignment ", "Dear Jose, this is because the composition test was done right after reading in the alignment. Thus, it is the composition report of the entire alignment, and not of the codon positions. You specified the same alignment 3 times, that\u2019s why it is reported 3 times. If you want to see the composition report for codon positions, then you need to put them into 3 separate files and change the partition file accordingly. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Thks a lot, it works now! Cheers, -Jose "]}, "YxmRhR5EugQ": {"topic": "Is it possible to insert new sequences into existing phylogenetic tree?", "initializeDate": "Jun 18, 2020, 3:40:26 PM", "timeStamp": "Jul 3, 2020, 6:32:31 PM", "content": ["Hello iqtree community, I am wondering if it is possible to insert a new sequence into an existing phylogenetic tree. For instance, I have an existing tree with 500 nodes. Now I have 4 more sequences. It seems very inefficient to rebuild the entire tree. Rather, there should be an option to insert these new sequences into the existing tree. I searched on BioSTAR for relevant answers. Several packages like pplacer and treebest has this insertion functionality ( https://www.biostars.org/p/3490/#3499 ). I am wondering if this is already implemented in iqtree? Boxiang ", "Hi Boxiang, Quick answer is No. But I agree, it will be useful e.g. for COVID-19 data, where hundreds of new sequences will become available every day. Can you please create a GitHub issue to request this feature: https://github.com/Cibiv/IQ-TREE/issues Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b2722e2b-3a92-44e6-8614-19d5624acb48o%40googlegroups.com ", "Hi Boxiang, I hesitate to disagree with Minh here (because when I do I am almost invariably wrong). In a normal world I would walk down the hall and ask him this. But we\u2019re all at home so here goes for doing it public. I think there is a way to do this in IQ-TREE. How you do it depends on how rigorous you want to be. If you don\u2019t want to be too rigorous, you can ignore step 2. Let\u2019s say you have a tree called tree1.tree with 96 sequences from aln1.fa . Now you\u2019ve added your four new sequences to that alignment to get a 100 sequence alignment aln2.fa To add the new sequences to the tree, just do this: iqtree -s aln2.fa -g tree1.tree This will use tree1.tree as a constraint tree, and just add the 4 new sequences in the best place possible without changing any of the relationships in tree1.tree , giving you aln2.tree . This will often be good enough. But let\u2019s say you\u2019re concerned that adding the 4 new sequences may change some of the relationships in tree1.tree . Simply re-optimise aln2.tree to account for this: iqtree -s aln2.fa -t aln2.tree That\u2019s it! Minh - one thing we might be able to do in a future release is to link these two steps with one command. Boxiang, if you open up a github issue and tag me in it (@roblanf on github) we can discuss what this command could look like. Rob To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1DBDEB41-A783-42B4-9A52-5B94DF8E80A1%40univie.ac.at Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "That\u2019s actually a good advicee Rob! Perhaps we can also change the -t option, such that it accepts a partial tree. The remaining sequences in the alignment, which does not appear in the partial tree, will be added (e.g. by parsimony) and once full, will be further optimised as usual with the IQ-TREE algorithm. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmo%3DddsuWODixYUatQw4ginkqHbF4qnP4SZEQAPPP%3DDsVw%40mail.gmail.com "]}, "UqQ7oOHREvM": {"topic": "approximate equivalences between gamma distribution and R/free-rate models", "initializeDate": "Nov 23, 2016, 7:02:44 AM", "timeStamp": "Nov 23, 2016, 10:24:11 AM", "content": ["Hi everyone, I've been using IQ-Tree for phylogenomic analysis of a multigene dataset (~20000 aa positions). The TESTNEW analysis yielded LG+R7 as the best fitting model. Now I want to replicate the results using a bayesian approach in PhyloBayes, but free-rate R models don't exist there. So, I'm wondering which is the closest approximation to R7 in the gamma distributions supported by Phylobayes and other software. My guess is that a gamma distribution with 7 categories is the best approach (but maybe gamma and free-rate distributions are too fundamentally different for this to work). Any ideas? Thanks a lot in advance! Xavi ", "Dear Xavi (CC Lars Jermiin, in case you want to add something), You are right that LG+G7 is the closest match to LG+R7, though they are still quite different. Moreover, since you have such long sequences (20K aa), I suggest that you look at the composition test result (in the log file) and if many sequences failed the test, you would try the C10-C60 models as well (they are the ML version for PhyloBayes\u2019 CAT model). You can use LG+C10+R7 model, for example, and look if such model provides better fit to the data. This is because -m TESTNEW by default does not include complex models due to computational reason. In fact you can instruct IQ-TREE to consider these models by e.g.: iqtree \u2026 -m TESTNEW -madd LG+C10+R7,LG+C20+R7 And finally if the C10 model series takes too much time and memory during subsequent analysis, you can use the recently proposed site frequency model (see http://www.iqtree.org/doc/Complex-Models/#site-specific-frequency-models Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Thanks a lot for your prompt answer! Regarding the composition bias test, you are totally right: many sequences appear to fail to pass it. Thanks for the suggestion of the C10-60 and PMSF models, I've been playing around with those too. Is there a way to tell which is the best C-XX value for the C10-C60 and PMSF models? Would the following command work for that purpose? iqtree \u2026 -m TESTNEW -mset LG+R7 -madd LG+C10+R7,LG+C20+R7,LG+R7+PMSF Cheers, Xavi ", "Hi Xavi, > On Nov 23, 2016, at 3:35 PM, conxor...@gmail.com wrote: > Hi Minh, > Thanks a lot for your prompt answer! you are welcome ;-) > Regarding the composition bias test, you are totally right: many sequences appear to fail to pass it. Thanks for the suggestion of the C10-60 and PMSF models, I've been playing around with those too. > Is there a way to tell which is the best C-XX value for the C10-C60 and PMSF models? Would the following command work for that purpose? > iqtree \u2026 -m TESTNEW -mset LG+R7 -madd LG+C10+R7,LG+C20+R7,LG+R7+PMSF do this: iqtree \u2026 -m TESTNEW -mset LG+R7 -madd LG+C10+R7,LG+C20+R7,LG+C30+R7,LG+C40+R7,LG+C50+R7,LG+C60+R7 Remove LG+R7+PMSF. This is not valid syntax and, btw the PMSF model was not designed for model testing. Later on if LG+C20+R7 provides the best fit, then you can apply PMSF by: iqtree \u2026 -m LG+C20+R7 -ft <guide_tree> Minh ", "Hi Minh, Perfect, thanks! Xavi >>> To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com "]}, "ngEHdgMylck": {"topic": "Suggestion: Polymorphic scoring of morphological characters", "initializeDate": "May 22, 2017, 9:07:49 PM", "timeStamp": "Jul 5, 2018, 3:37:14 PM", "content": ["Hi Minh, IQ-TREE has great options, is smartly designed, is fast and accurate... and I really appreciate all your efforts! (link) https://groups.google.com/forum/#!topic/iqtree/ZcYvOFiGnsw Like the thread above discussing polymorphic scoring in morphological data matrices, I too would benefit greatly from IQ-TREE supporting this type of coding. I run combined DNA/morphology analyses often in MrBayes and would really like to complement those runs with IQ-TREE analyses of the same data sets. There are two types of polymorphic coding in the nexus format. (0 1) indicates the character is observed as both states 0 AND 1, while {0 1} indicates the character is observed as either state 0 OR 1. Three or more states for a single character are also possible. I have attached a screenshot of how these are entered into the software Mesquite during character scoring as well as the \"export > simplified nexus\" file that is output by Mesquite. MrBayes, PAUP and TNT all accept polymorphic coded characters but during analyses treat them as ambiguous/missing. RAxML requires that polymorphic characters are re-coded as missing before loading the alignment. This recoding is no small task with morpholgical matricies that often contain several hundred or even thousands of characters. Also, then there becomes two matrices to keep track of - one with polmorphic scores and one that has been recoded. If IQ-TREE could also accept polymorphic coding of morphological characters it would be a huge benefit! (which will add to the many other advantages IQ-TREE has over similar software) My initial thought is that when reading in a sequence file, if the character \"(\" is observed, the sequence would continue to be read until the character \")\" is found and then \"(...)\" is simply replaced by a question mark. Also, perhaps a notice could be printed to the screen that says something like \"polymorphic scoring of morphological data has been detected and these characters will be treated as ambiguous/missing\". The same would be done with the \u201c{\u201c and \u201c}\u201d characters. I hope this suggestion is helpful. You have certainly already made my research more flexible and efficient\u2026 thanks so much! Cheers, Steven ", "Hi Steven, Thanks for your kind words and clearly describing the advantage and how to treat such polymorphic states (e.g. as missing states). Indeed I was unaware of such treatments, which should be quite easy to implement. I put this into the TODO list for version 1.6. Will let you know once available. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <matrix.nex> <mesquite.jpg> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hello Mihn and Steven, Allowing IQ-TREE to accept polymorphism would indeed be very useful, as polymorphism is found very often in empirical data, and could be informative in some cases. To add to what Steven said, I understand that the treatment of \"morphological\" polymorphism and ambiguity in other programs is normally the same as ambiguity in nucleotide data, which would be equivalent to missing data only when the characters are binary. This is true at least for TNT (I checked) and for MrBayes (as far as I can tell from its manual). For speed, BEAST treats all kinds of ambiguous and polymorphic data as missing by default, but it has a switch to activate the other behaviour. PAUP allows two kinds of behaviour for polymorphism and ambiguity under parsimony, but both are different to the treatment of missing data. Cheers, Eduardo ", "Dear Eduardo, Thanks for further information. We will add support for polymorphism for morphological data in the future 1.5.5 release. They will be treated as missing data because this is easiest to do. Treating them in a complicated way like for DNA or protein data (see http://www.iqtree.org/doc/Frequently-Asked-Questions#how-does-iq-tree-treat-gapmissingambiguous-characters ) is programmatically much more complicated, will not be available in the near future\u2026 unless there is compelling reason to do so. Cheers, Minh ", "Hi Minh, It's been a little while since I last visited the IQTREE page. Congratulations on all the new features... very useful! Tonight I set up a new analysis and decided to upgrade my IQTREE version from 1.5.5 to 1.6.6 (both Windows 64 bit). When I attempted to load my morphology data matrix, the load failed when it reached the first column that contains polymorphic coding. The message given is: ERROR: Catopithecus_browni has invalid state at site 4. This particular cell in the matrix is coded as (0 1). I wondered if there is something wrong with my matrix or if there has been a software change, so I went to github and downloaded all recent IQTREE versions (from 1.5.5 through 1.6.6). I get the same error message with any 1.6.x version, but both 1.5.5 and 1.5.6 load and run my analysis with polymorphic scores successfully. Concerning IQTREE's treatment of morphological characters with polymorphic scores (i.e. loaded as missing)... Was this feature removed intentionally? Or is it something we can expect to come back in a future version? Thanks for your thoughts! Steven ", "Hi Steven, On 4 Jul 2018, at 11:09 am, steven.wad...@gmail.com wrote: Hi Minh, It's been a little while since I last visited the IQTREE page. Congratulations on all the new features... very useful! Thanks! Tonight I set up a new analysis and decided to upgrade my IQTREE version from 1.5.5 to 1.6.6 (both Windows 64 bit). When I attempted to load my morphology data matrix, the load failed when it reached the first column that contains polymorphic coding. The message given is: ERROR: Catopithecus_browni has invalid state at site 4. This particular cell in the matrix is coded as (0 1). I wondered if there is something wrong with my matrix or if there has been a software change, so I went to github and downloaded all recent IQTREE versions (from 1.5.5 through 1.6.6). I get the same error message with any 1.6.x version, but both 1.5.5 and 1.5.6 load and run my analysis with polymorphic scores successfully. Thanks for the report. You\u2019re right, this feature was, for unknown reason, unsupported in v1.6 (compared with v1.5), possibly due to the merge of the two versions. However, I\u2019ve checked that IQ-TREE reads Philip/fasta file wit such codes properly, whereas the error only occurs with Nexus file. Thus, can you pls convert your nexus file into phylip/fasta and then feed into IQ-TREE\u2026 we\u2019ll fix this for the next release. Concerning IQTREE's treatment of morphological characters with polymorphic scores (i.e. loaded as missing)... Was this feature removed intentionally? Or is it something we can expect to come back in a future version? See above. Cheers Minh "]}, "IJk7SoFxYXE": {"topic": "Hetertachy models in modelfinder", "initializeDate": "Dec 30, 2017, 2:05:58 PM", "timeStamp": "Jan 4, 2018, 2:02:45 PM", "content": ["Hello, I gather that in v1.6 the heterotachy models can be directly tested in ModelFinder (great addition!). I'm wondering if there's a flag to ask ModelFinder to test heterotachy models (ie. H1-H4), I can't find it in the documentation. I ran a quick test today with the latest release using -m TESTNEWONLY and didn't see the heterotachy models, so I assume you must need to specify with another flag. Thanks! ", "Dear Will, Thanks for your interest. We will add this soon to the documentation, but the quick answer is to use -mrate option. For example, \u201c-mrate G,R,H\u201d will test all combinations of base models (JC, \u2026, GTR) plus Gamma (+G), free-rate (+R) or heterotachy (+H) models. For +H the procedure is similar to +R, i.e., ModelFinder will increasingly test +H2, +H3, \u2026 up to a certain number of classes where there is no gain in AIC/BIC score. So the number of classes will be automatically determined. Note that since we haven\u2019t thoroughly tested this feature, feedback is welcome! Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, I tried this and got the heterotachy models to work. I did encounter numerical underflow issues with the +H models, but turning on safe mode allowed me to get around this (\"Numerical underflow for lh-derivative-mixlen\"). For reference my data is 608 sequences x 680 sites, and it's a rather gappy and divergent alignment, but this is the only model that I've encountered numerical underflow. Thanks for the help! ", "Hi Will, Then I\u2019m not surprised about the numerical underflow, because each extra heterotachy class will add 2n-3 branch length parameters (n=#sequences). Whereas you have only 680 sites, compared with n=608. Thus, fitting too many parameters will cause estimation problem, leading to numerical instability. Actually I wouldn\u2019t recommend to use +H model for such short alignments (ModelFinder might have concluded that anyway). Cheers, Minh ", "Indeed, heterotachy models were a poor fit for my data. A related question regarding cases where K>>n, as in my dataset. I can attempt removing closely related sequences (ie. cluster to remove sequences with >0.9 identity), which might help some, but I know that this will still leave me with K>>n when running modelfinder. Is it the case that when K>>n the parameter estimates are strictly unreliable, or are they just unstable. ie. If I run modelfinder on this data 10 times, and observe a low variance in the log likelihoods (or BIC/AIC values) can I conclude that the results are reliable, or do I need to be worried about a systematic issue with parameter estimates that could bias multiple runs. Would it be helpful to estimate gamma shape parameter, free rates parameters, etc. beforehand using iqtree and specify them for modelfinder? Details of my analysis: 608 sequences x 680 sites I've run modelfinder 5 times on this data, and it always returns WAG+R7 (BIC), WAG+R8 (AIC), or WAG+G4 (AICc) as the best model. I estimated a tree before running using Fasttree, and I've used that as the starting tree input (-t), I've also tried running modelfinder without a starting tree, and with a fixed topology, and it returns the same result regardless. Thank you, Will ", "Hi Will, This is a typically difficult data set due to short sequences. Reducing number of sequences is one way, and another way is to sequence more genes to increase the sequence length. If that is not possible: I would think toward unreliable estimates of the tree topology and not much concerned with model parameter estimates. Here, the trees may likely be different from different runs and also from different programs. Thus I will use different programs (ML, Bayesian) and multiple runs per program. Then collect all trees and do some tree topology tests. I would also perform some congruence test with the 16S/18S rRNA tree e.g. with Internode/Tree certainty (IC/TC) scores. Other people here may have further advice to deal with your short data set. Cheers, Minh "]}, "cL4yWyx3tqo": {"topic": "MPBoot multiple MP trees", "initializeDate": "Mar 22, 2019, 11:15:29 AM", "timeStamp": "Mar 31, 2019, 6:02:48 AM", "content": ["Will MPBoot always return a single tree if one does a minimal run as shown below? mpboot -s infile My goal is just to have a single \"good enough\" starting tree for another pipeline, so I'm not concerned if there are multiple MP trees (I'm also not concerned about support for clades). I noticed the -mulhits but that is described as \"Store multiple equally parsimonious trees per bootstrap replicate\". I assume that -mulhits will make the program store multiple trees but I wasn't sure if that applied in my case since I'm not bootstrapping. Basically, all I want is to make sure that I can count on the infile.treefile generated using the command above will always be a single tree Thanks! ", "Hi Ed, I think that command will print one single tree to .treefile, but not 100% sure. So to be safe, you can just take the first line of this file for your pipeline\u2026 Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "pZZ1JjVm11w": {"topic": "IQ-TREE release 1.3.10", "initializeDate": "Oct 15, 2015, 11:21:47 AM", "timeStamp": "Oct 15, 2015, 11:21:47 AM", "content": ["Dear IQ-TREE users, October 16, 2015: We are pleased to announce version 1.3.10 with following changes: \u2022 Support unlimited number of partitions for partition model analysis (no complaint about PLL_NUM_BRANCHES anymore). \u2022 Improved support for mixture models. \u2022 Fix a bug in ascertainment bias correction [+ASC] model causing incorrect branch length estimates (thanks to Marcus Teixeira for reporting it). \u2022 Fix a rare bug when branch lengths are close to upper bound (thanks to Huaichun Wang for reporting it). Best, The IQ-TREE development team "]}, "UiWGtIWCugQ": {"topic": "iqtree crush in beginning of constraint tree search", "initializeDate": "Apr 21, 2020, 1:32:06 PM", "timeStamp": "Apr 21, 2020, 8:32:24 PM", "content": ["Dear developpers, I started an constraint tree search in iqree and the program crushed when reading constraint newick file. Please, have a look at the log file and the newick file. What I am doing wrong? My guess is that something in the newick file is incorrect, but I do not see a mistake. best regards, Philipp ", "It seems that the sequences are missing? There is only the partition info in the nex file. \u5728 2020\u5e744\u670822\u65e5\u661f\u671f\u4e09 UTC+8\u4e0a\u53481:32:06\uff0cPhilipp Chetverikov\u5199\u9053\uff1a "]}, "YAwAVtvxYto": {"topic": "IQ-TREE release 1.3.9", "initializeDate": "Sep 28, 2015, 10:00:21 PM", "timeStamp": "Sep 28, 2015, 10:00:21 PM", "content": ["Dear all, September 29, 2015: We are pleased to announce version 1.3.9 with following notable changes: Several bug fixes improving software stability. Special thanks to Xiaofan, Karen Meusemann, Jozsef Bakonyi, Renee, Peter Hosner for reporting bugs. A more stable expectation-maximization (EM) algorithm is implemented to optimize parameters of the FreeRate [+R] and LG4X model. Special thanks to Edward Susko, Thomas Wong and Lars Jermiin. Several new features (requested by users): Option \"-wbtl\" to write bootstrap tree file (.ufboot) with branch lengths. Option \"-madd\" to include mixture models into model selection procedure (e.g. \"-madd LG4M,LG4X\"). Option \"-alrt 0\" to perform the parametric approximate likelihood ratio (aLRT) branch test (Anisimova and Gascuel 2006). Option \"-abayes\" to perform the parametric aBayes branch test (Anisimova et al. 2011). Maximum number of partitions is increased to 16384 instead of 1024. All users are strongly suggested to upgrade this version. Best regards, IQ-TREE development team Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at "]}, "saKBY4hIhgE": {"topic": "GHOST model- extraction of tree length according to class", "initializeDate": "Jun 29, 2018, 12:53:45 AM", "timeStamp": "Jun 29, 2018, 7:08:16 AM", "content": ["Dear Stephen, I would like to ask you more about how to extract each tree which belong to each of 4 classes? Because, in the log file, it was written that \"class branch lengths are given in [...] and separated by '/' \", but I do not know how to extract. Thank you for your help in advanced Bests Giap Nguyen ", "Hi Giap, If you look at the .treefile file that is generated you will find all the trees in there, on seperate lines. Let\u2019s say you fit a GHOST model with 3 classes, the .treefile will have 4 lines in it. The first line in the tree file will have the tree, with branches for all classes, separated by \u201c/\u201c as you describe. The second line will have the tree for Class 1 in standard Newick format, the third line will have the Class 2 tree in Newick format and the fourth line will have the Class 3 tree. Good luck, I hope you find some interesting results! Stephen Stephen Crotty, PhD Centre for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC 5, Ebene 1 A-1030 Vienna, Austria Email: stephen...@univie.ac.at You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Stephen, I got the information following your guidance. Once again, thank you so much! Bests, Giap Nguyen "]}, "_wgdpBkC9_o": {"topic": "Pairwise distance in .mldist", "initializeDate": "Jun 4, 2019, 2:23:16 AM", "timeStamp": "Jul 3, 2019, 9:18:13 PM", "content": ["Hi all, I wish to calculate the genetic distance for my DNA alignment using the best-fit substitution model estimated by IQ-Tree. The minimum sequence identity of my alignment was ~80% and the length of the alignment was ~1000 bp. It seemed that when +G was in the rate model, the pairwise distance appeared to be very high with many over 1.0 in the file .mldist . However, if +G was not specified, e.g., GTR or GTR+F was used as the model, the distances in the .mldist file seemed to me to make much more sense (maximum ~32%). So, my questions are: i) was the sequence identity of the alignment too low to use +G, and ii) would only -m GTR (or whatever the best substitution model) work for my purpose? Thanks. Best regards, Sishuo ", "Hi Sishuo, Without rate heteogeneity the genetic distances might be underestimated. However, Richard Neher recently observed that GTR+G4 might lead to overestimation due to just 4 rate categories. I suggest that you try GTR+G16, which should better approximate the Gamma distribution in theory. Moreover, did you test which model fits best to your data? I suggest that you also try the free-rate model, e.g. GTR+R, but let ModelFinder find the best number of categories. And then use the distances computed from the best-fit model. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2f83feeb-e19b-405a-869f-bfb957cf2c1c%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "FYI Here is the twitter thread on this issue: https://twitter.com/richardneher/status/1125399935191605251 To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2A294943-CF00-486C-B15A-A3969BDDA263%40univie.ac.at ", "Hi Minh, Thanks so much for your help! I double-checked my alignment, and it seemed that a few of them were likely not orthologous to the rest, which might lead to unexpectedly large genetic distance found in .mldist . After the removal of them, I followed your suggestions and it worked perfectly. I have one more question. It seemed that when was included in the best-model, the pairwise distance shown in .mldist could be even lower than the distance calculated as the \"raw\" distance (i.e., no. of different AAs between two sequences). So, should I use +I to calculate the pairwise distance of my alignment (it was often included in best-hit model, e.g., GTR+G+I) or would it be fine to ignore +I? Thanks. Best, Sishuo On Thursday, June 6, 2019 at 5:38:36 PM UTC+8, Minh Bui wrote: FYI Here is the twitter thread on this issue: https://twitter.com/richardneher/status/1125399935191605251 On 6 Jun 2019, at 7:36 pm, Minh Bui < min...@univie.ac.at > wrote: Hi Sishuo, Without rate heteogeneity the genetic distances might be underestimated. However, Richard Neher recently observed that GTR+G4 might lead to overestimation due to just 4 rate categories. I suggest that you try GTR+G16, which should better approximate the Gamma distribution in theory. Moreover, did you test which model fits best to your data? I suggest that you also try the free-rate model, e.g. GTR+R, but let ModelFinder find the best number of categories. And then use the distances computed from the best-fit model. Cheers, Minh On 4 Jun 2019, at 4:23 pm, Sishuo Wang < sishuow...@gmail.com > wrote: Hi all, I wish to calculate the genetic distance for my DNA alignment using the best-fit substitution model estimated by IQ-Tree. The minimum sequence identity of my alignment was ~80% and the length of the alignment was ~1000 bp. It seemed that when +G was in the rate model, the pairwise distance appeared to be very high with many over 1.0 in the file .mldist . However, if +G was not specified, e.g., GTR or GTR+F was used as the model, the distances in the .mldist file seemed to me to make much more sense (maximum ~32%). So, my questions are: i) was the sequence identity of the alignment too low to use +G, and ii) would only -m GTR (or whatever the best substitution model) work for my purpose? Thanks. Best regards, Sishuo You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2f83feeb-e19b-405a-869f-bfb957cf2c1c%40googlegroups.com For more options, visit https://groups.google.com/d/optout You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Sishuo, On 7 Jun 2019, at 6:48 pm, Sishuo Wang < sishuow...@gmail.com > wrote: Hi Minh, Thanks so much for your help! I double-checked my alignment, and it seemed that a few of them were likely not orthologous to the rest, which might lead to unexpectedly large genetic distance found in .mldist I see, that\u2019s the reason. I think we have an upper bound of 9.0 or so. If the distance gets almost there, then you might likely have non-homologous sequences. IQ-TREE also prints some WARNING about saturated distances. After the removal of them, I followed your suggestions and it worked perfectly. I have one more question. It seemed that when was included in the best-model, the pairwise distance shown in .mldist could be even lower than the distance calculated as the \"raw\" distance (i.e., no. of different AAs between two sequences). So, should I use +I to calculate the pairwise distance of my alignment (it was often included in best-hit model, e.g., GTR+G+I) or would it be fine to ignore +I? Thanks. I actually do not expect that GTR+I+G distances be lower than the \u201craw\u201d (Hamming) distances. How much lower are they? It\u2019s true that generally GTR+I+G distances will lower than GTR+G distances. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/56ba6c0c-a1d6-496e-bad9-7becbccf63d9%40googlegroups.com ", "Hi Minh, Could be 50% lower than the Hamming distance. I am providing the results and the alignment as attachment. The raw distance was calculated using dna.dist (pairwise deletion = false). I guess there were problems in the alignment? Thank you so much. Best, Sishuo Hi Sishuo, ", "Hi Sishuo, I had a thorough look and it looks like there is a bug in distance computation (.mldist file) in case of +I or +I+G model. The distances are not scaled properly, leading to more underestimation, when the proportion of invariable sites gets higher. We will fix the bug, but for now please don\u2019t use GTR+I+G distances, but GTR+G distances. So thanks for the discussion, that led me to find this issue! Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ab539f09-9302-4248-adf8-669c13961110%40googlegroups.com For more options, visit https://groups.google.com/d/optout <G.mldist> <G+I.mldist> <RAW.dist> <5.aln> "]}, "bkEb4J5zq6Q": {"topic": "mixture models AND partitioned data sets", "initializeDate": "Jun 22, 2016, 11:25:19 AM", "timeStamp": "Jun 22, 2016, 3:52:46 PM", "content": ["Am I right that it is currently not possible to run mixture models (e.g. LG+C60+F+G) together with a partitioned data set such that the different partitions get their own parameter estimates (branchlengths)? ", "Hi Andrew again, this is in fact possible! e.g via: iqtree -s alignment -sp partition_file -m C10+G However I have not tested such combination, as this is likely too parameter-rich. Please let me know if this indeed works as expected. Minh On Jun 22, 2016, at 5:25 PM, Andrew Roger < andrew...@gmail.com > wrote: Am I right that it is currently not possible to run mixture models (e.g. LG+C60+F+G) together with a partitioned data set such that the different partitions get their own parameter estimates (branchlengths)? You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "Jxiz7ipy1X4": {"topic": "pmsf", "initializeDate": "Apr 13, 2020, 12:37:55 AM", "timeStamp": "Apr 16, 2020, 3:50:20 PM", "content": ["Hello I have a question about the use of PMSF. In the paper of Wang 2018 and on the GitHub page ( https://github.com/Cibiv/IQ-TREE/wiki/Complex-Models ), you demonstrate that PMSF is (to do simple) as efficient as Cxx or CAT+GTR, but faster. You show that with LG+PMSF+\u0393 allows us to be faster for than LG+C60+F+G and LG+C20+F+G. My question is : If I do LG+C60+F+G with a guide tree, will it be faster than a LG+C60+F+G ? Is it a way to use PMSF ? I think there is something I don't understand well in this Table from your GitHub and Wang paper : In this Table Models CPU time Wall-clock time RAM usage LG+F+G 43h:38m:23s 3h:37m:23s 1.8 GB LG+C20+F+G 584h:25m:29s 46h:39m:06s 38.8 GB LG+C60+F+G 1502h:25m:31s 125h:15m:29s 112.8 GB LG+PMSF+G 73h:30m:37s 5h:7m:27s 2.2 GB What PMSF refer to ? Do I need to replace PMSF by a model (for ex. C60 or C20 ?) ? Are they use a Cxx instead with a guide tree ? Because I don't understand what model they use to save all this time in the paper. I have 500 fasta of 121 species and 35 000 positions. I tried with the following line command : for f in *-modified.fasta; do echo \"iqtree-mpi -s $f -m LG+C60+F+G -ft replica-1-concat.fasta-modified.treefile -nt 8 -mem 60G\"; done > all-jobs.cmds I succeeded in getting 15 trees (2 days of calculation, and it seems much compared to your data set of Brown who have results in 5h with 68 sequences, 43615 amino-acid sites, 16 CPU... and I use 32 CPU). Plus, for the 75 others, I had this erreur (not for the 15 first fasta, I don't understand) : ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 double* aligned_alloc<double>(unsigned long) ERROR: 2 PhyloTree::initializeAllPartialLh(int&, int&, PhyloNode*, PhyloNode*) ERROR: 3 PhyloTree::initializeAllPartialLh() ERROR: 4 computeSiteFrequencyModel(Params&, Alignment*) ERROR: 5 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 6 main() ERROR: 7 __libc_start_main() ERROR: Not enough memory, allocation of 59743927072 bytes failed (bad_alloc) Do you think my parameters -nt 8 -mem 60G are good ? According to you, using PMFS, what would be the most pertinent ? What we want is the equivalent of a C60, without having as much computing time. Best regards Richard GOUY ", "I forgot to mentioned that my guide trees results from standard LG+C60. ", "Hi Richard, On 13 Apr 2020, at 2:37 pm, Richard Benji < rgo...@gmail.com > wrote: Hello I have a question about the use of PMSF. In the paper of Wang 2018 and on the GitHub page ( https://github.com/Cibiv/IQ-TREE/wiki/Complex-Models ), you demonstrate that PMSF is (to do simple) as efficient as Cxx or CAT+GTR, but faster. You show that with LG+PMSF+\u0393 allows us to be faster for than LG+C60+F+G and LG+C20+F+G. My question is : If I do LG+C60+F+G with a guide tree, will it be faster than a LG+C60+F+G ? Is it a way to use PMSF ? No, you should use LG+F+G to make the guide tree. Otherwise there is no runtime benefit, of course. I think there is something I don't understand well in this Table from your GitHub and Wang paper : In this Table Models CPU time Wall-clock time RAM usage LG+F+G 43h:38m:23s 3h:37m:23s 1.8 GB LG+C20+F+G 584h:25m:29s 46h:39m:06s 38.8 GB LG+C60+F+G 1502h:25m:31s 125h:15m:29s 112.8 GB LG+PMSF+G 73h:30m:37s 5h:7m:27s 2.2 GB What PMSF refer to ? PMSF is abbreviation for Posterior mean site frequency. But please note that in the command line, you should use -m LG+C60+F+G -ft <GUIDE_TREE_FILE>. So a typical analysis has 2 steps: 1. Build a tree guide: iqtree -s ALN_FILE -m LG+F+G -pre guidetree 2. Use the .treefile from the above run to do this approximation: iqtree -s ALN_FILE -m LG+F+C60+G -ft guidetree.treefile ... Do I need to replace PMSF by a model (for ex. C60 or C20 ?) ? Are they use a Cxx instead with a guide tree ? Because I don't understand what model they use to save all this time in the paper. See above. I have 500 fasta of 121 species and 35 000 positions. I tried with the following line command : for f in *-modified.fasta; do echo \"iqtree-mpi -s $f -m LG+C60+F+G -ft replica-1-concat.fasta-modified.treefile -nt 8 -mem 60G\"; done > all-jobs.cmds I succeeded in getting 15 trees (2 days of calculation, and it seems much compared to your data set of Brown who have results in 5h with 68 sequences, 43615 amino-acid sites, 16 CPU... and I use 32 CPU). Plus, for the 75 others, I had this erreur (not for the 15 first fasta, I don't understand) : ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 double* aligned_alloc<double>(unsigned long) ERROR: 2 PhyloTree::initializeAllPartialLh(int&, int&, PhyloNode*, PhyloNode*) ERROR: 3 PhyloTree::initializeAllPartialLh() ERROR: 4 computeSiteFrequencyModel(Params&, Alignment*) ERROR: 5 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 6 main() ERROR: 7 __libc_start_main() ERROR: Not enough memory, allocation of 59743927072 bytes failed (bad_alloc) Do you think my parameters -nt 8 -mem 60G are good ? This is because the first phase uses a lot of RAM to estimate .sitefreq file. The doc shows you how to avoid this. Or you can use -mem option, but set smaller limit, e.g. -mem 20GB. According to you, using PMFS, what would be the most pertinent ? What we want is the equivalent of a C60, without having as much computing time. Yes, hope that I have answered your questions, Minh Best regards Richard GOUY You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/957939b0-efd8-478b-8435-ebe6d93be27d%40googlegroups.com ", "OK thank you for everything, I think I'm good. I just removed the -mem option, for now it works... It's been running for 1 day (I already have guide tree from previous analyses). Richard Le lundi 13 avril 2020 06:37:55 UTC+2, Richard Benji a \u00e9crit : ", "I see, that\u2019s a bug with -mem option that somebody else already reported, but we haven\u2019t had the time coming to that yet. But for now please ignore -mem option. Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/84d078a3-1989-458f-8f0c-acee370c8827%40googlegroups.com "]}, "NAtmC5RVz-U": {"topic": "Crash IQ-tree multicore version 1.4.2", "initializeDate": "Apr 26, 2016, 10:16:30 AM", "timeStamp": "Apr 28, 2016, 1:15:43 AM", "content": ["To whom it may concern, My problem is when I launch this command : iqtree -s $file2 -nt 15 -st AA -pre $file3 -bb 1000 -alrt 1000 -m TESTNEW -madd LG4M,LG4X,EX2,EX3 during the choice of the model the program crash with this output : 131 mtREV 88380.299 213 177186.598 177361.913 178166.080 new_tree_lh: -88352.917 tree_lh: -88189.980 Assertion failed: (fabs(new_tree_lh-tree_lh) < 1.0), function optimizeAllBranches, file /Users/minh/Dropbox/iqtree-git/phylotree.cpp, line 3408. STACK TRACE FOR DEBUGGING: 1 std::vector<std::vector<int, std::allocator<int> >, std::allocator<std::vector<int, std::allocator<int> > > >::reserve(unsigned long) 2 _sigtramp() 6 std::map<std::string, double, std::less<std::string>, std::allocator<std::pair<std::string const, double> > >::operator[](std::string const&) 7 std::_Rb_tree<char, std::pair<char const, char>, std::_Select1st<std::pair<char const, char> >, std::less<char>, std::allocator<std::pair<char const, char> > >::_M_insert_unique(std::pair<char const, char> const&) 8 std::vector<ModelInfo, std::allocator<ModelInfo> >::erase(__gnu_cxx::__normal_iterator<ModelInfo*, std::vector<ModelInfo, std::allocator<ModelInfo> > >, __gnu_cxx::__normal_iterator<ModelInfo*, std::vector<ModelInfo, std::allocator<ModelInfo> > >) 9 std::vector<ModelInfo, std::allocator<ModelInfo> >::~vector() 10 std::vector<ModelInfo, std::allocator<ModelInfo> >::~vector() 11 std::vector<PartitionInfo, std::allocator<PartitionInfo> >::operator=(std::vector<PartitionInfo, std::allocator<PartitionInfo> > const&) 12 std::vector<std::vector<int, std::allocator<int> >, std::allocator<std::vector<int, std::allocator<int> > > >::reserve(unsigned long) *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: /Users/rdenise/Documents/Analysis_reduction/tree_out/26_04_16/IMplatform_ONLY_TADC/IMplatform_ONLY_TADC.log *** Alignment files (if possible) Abort trap: 6 As I'm here to say thing : when I used the -madd CF4 the program said : Model CF4 is alias for FMIX{empirical,Fclass1,Fclass2,Fclass3,Fclass4} ERROR: Invalid -madd model CF4: FMIX: Rate entries could not be read And it finished. Thank you for your help R\u00e9mi ", "Dear Remi, On Apr 26, 2016, at 4:16 PM, r\u00e9mi Denise < remi....@gmail.com > wrote: To whom it may concern, My problem is when I launch this command : iqtree -s $file2 -nt 15 -st AA -pre $file3 -bb 1000 -alrt 1000 -m TESTNEW -madd LG4M,LG4X,EX2,EX3 during the choice of the model the program crash with this output : 131 mtREV 88380.299 213 177186.598 177361.913 178166.080 new_tree_lh: -88352.917 tree_lh: -88189.980 Assertion failed: (fabs(new_tree_lh-tree_lh) < 1.0), function optimizeAllBranches, file /Users/minh/Dropbox/iqtree-git/phylotree.cpp, line 3408. thanks for the bug report. This looks indeed strange, I will let you know further progress. As I'm here to say thing : when I used the -madd CF4 the program said : Model CF4 is alias for FMIX{empirical,Fclass1,Fclass2,Fclass3,Fclass4} ERROR: Invalid -madd model CF4: FMIX: Rate entries could not be read And it finished. this is because CF4 is declared slightly different from LG4X or other mixture models. I will change the behavior so that it works as other models. Cheers, Minh Thank you for your help R\u00e9mi You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <IMplatform_ONLY_TADC.log> <MSA.MAFFT.Without_low_SP_Col.With_Names> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "islWztdXcuc": {"topic": "Error message 'string too long' for TPM2u model", "initializeDate": "Nov 7, 2015, 3:23:35 PM", "timeStamp": "Nov 7, 2015, 4:51:55 PM", "content": ["Dear IQ-Team, I'd like to ask for a little help how to specify my best fit model and its parameters in iqtree command line. I get the error massage \"String too long 4.0751,7.0732,4.0751,1.0000,7.0732,1.0000\" when trying to use command line iqtree-omp nt 4 -s inputfilename.fas TPM2u 4.0751,7.0732,4.0751,1.0000,7.0732,1.0000 0.1837,0.217,0.2955,0.3038 0.6072 +G4 0.887 My best model of substitution: TPM2u+F+I+G4 Rate parameter R: A-C: 4.0751 A-G: 7.0732 A-T: 4.0751 C-G: 1.0000 C-T: 7.0732 G-T: 1.0000 State frequencies: (empirical counts from alignment) pi(A) = 0.1837 pi(C) = 0.217 pi(G) = 0.2955 pi(T) = 0.3038 Proportion of invariable sites: 0.6072 Gamma shape alpha: 0.887 I suppose I was wrog to specify all the 6 rate parameters for TPM2u in iq-tree command line. Could you please give advice how to correct it? Thanks a lot indeed, J\u00f3zsef ", "Dear Jozsef, please simply change \u201cTPM2u\u201d to \u201cGTR\u201d: GTR 4.0751,7.0732,4.0751,1.0000,7.0732,1.0000 or change the parameters of TPM2u to TPM2u{4.0751,7.0732} The bottom line is because the TPM2u model has only 2 rate parameters. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "FKWR2uxx0s4": {"topic": "Error when constructing species tree using concatenation", "initializeDate": "Oct 8, 2020, 11:44:36 AM", "timeStamp": "Oct 13, 2020, 2:39:32 PM", "content": ["Hello Minh et al. I am trying to establish gcf and scf for my data set. I have successfully conducted my gene tree analysis with 2413 genes. I am now trying to make a species tree using the concatenation approach which always give me an error (attached). I am not sure how to interpret this error. I am running the analysis on a computing cluster using \"iqtree-2.0-rc2\" . Thank you so much for your help. Manpreet ", "Hi Manpreet, Please remove -mem option, it does not work in combination with partitioned models (-p option). Normally an error message like that should have been printed. Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7756f51c-d8da-4f86-94d4-1428e7436dd8n%40googlegroups.com <output.txt> <PBS_SAMPLE_OpenMPI-Speciestree.sh> <error.txt> ", "Hello Minh, Thank you so much for your reply. Removing the -mem option and allocating a large amount of memory works (earlier I was using 64gb which failed, but 128 gb works). Manpreet "]}, "6gj-IDUvcZE": {"topic": "Errors when using ModelFinder", "initializeDate": "Jul 20, 2020, 8:45:40 PM", "timeStamp": "Jul 22, 2020, 12:12:43 AM", "content": ["Hi all, I have three datasets of the same kind (concatenated ddRad loci) with a partitions file delimiting every loci, and I am trying to find the best partitioning scheme. I am running version 1.7. One of the them works fine. The second one gives me this error: iqtree-beta -s NigromaculatusPartitioned.phy -nt 4 -m MFP+MERGE -p nigrotest_part.File -bb 1000 --prefix concat -rcluster 10 35202 GTR+F+I+G4 732915.098 0.285 part469fas+part510fas 0h:4m:29s (0h:30m:57s left) 35203 GTR+F+I+G4 732915.421 0.227 part1015fas+part1210fas 0h:4m:29s (0h:30m:57s left) iqtree-beta(88235,0x700005767000) malloc: can't allocate region *** mach_vm_map(size=8390876190137872384) failed (error code=3) iqtree-beta(88235,0x700005767000) malloc: *** set a breakpoint in malloc_error_break to debug libc++abi.dylib: terminating with uncaught exception of type std::bad_alloc: std::bad_alloc 35204 GTR+F+I+G4 732921.083 0.068 part207fas+part857fas 0h:4m:29s (0h:30m:57s left) ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: concat.log ERROR: *** Alignment files (if possible) 35205 GTR+F+I+G4 732916.107 0.096 part1047fas+part516fas 0h:4m:29s (0h:30m:57s left) Abort trap: 6 And the third one gives me this error: NEGATIVE SITE ID I can't find any difference in the style between the partition files, so really clueless about this Any idea? ", "Hi Damien, A couple of things. First, please try upgrading to the latest version 2 and see if you see the same issues. There is a lot of additional work done in ModelFinder in version 2. Second, can you post your data and log files for the 'NEGATIVE SITE ID' error? (Off list straight to me is fine). I'll take a look and see if I can see the issue. Cheers, Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2afece8f-47f0-4d9a-89b9-dc3dbf27ac80o%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Hi Damien, Thanks for sending me the files. The issue was that your partition file started like this: DNA, part1 = 0-249 The documentation describes how to format these files here: http://www.iqtree.org/doc/Advanced-Tutorial . The issue is that you are using zero-indexing, whereas the correct format is 1-indexing. I can make your file run by changing the first line of the partition file to: DNA, part1 = 1-249 But beware! It seems likely to me that your partition file was created with zero indexing throughout. In that case you might need to add 1 to every site in your partition file to make sure that your partitions are in the right place. I.e. in this case the correct first line would be: DNA, part1 = 1-250 Zero-indexing is common, for example Python uses it for everything. We use standard indexing in IQ-TREE (and they use it in RAxML too I think) because it\u2019s more intuitive to call the first site \u2018site 1\u2019 than \u2018site 0\u2019. Minh - do you think we could spit out a more informative error instead of \u2018NEGATIVE SITE ID\u2019? Perhaps give the site, and if possible print the line of the input file that contains the offending ID, and also point out that IQ-TREE uses 1-indexed site IDs, and give a link to the page to correctly format partition files here: http://www.iqtree.org/doc/Advanced-Tutorial Cheers, Rob "]}, "XxJUVJLakOk": {"topic": "BUG: iqtree repors that tree file does not begin with \"(\" when it in fact does", "initializeDate": "Feb 14, 2020, 9:25:34 AM", "timeStamp": "Apr 22, 2020, 1:01:29 PM", "content": ["Hello, I am running IQ-TREE multicore version 1.6.6 on Ubuntu 18.04.4 (I also received the same error when running this analysis on our University's high performance computing cluster which runs IQ-TREE multicore version 1.6.6, but I'm not sure what operating system they use on the cluster). The command and seed I used were: Command /home/ kevin IQ_TREE bin iqtree alrt 1000 Noctuidae_21_alignment txt 1000 spp part txt st DNA pre Noctuidae_21_IQ TREE m TESTNEWMERGE t BIONJ safe Seed 184793 Using SPRNG Scalable Parallel Random Number Generator Which results in the error: Current log likelihood at step 267607.229 Current log likelihood at step 267607.128 Current log likelihood at step 267607.047 Parameters optimization took rounds 125.950 sec WARNING Estimated model parameters are at boundary that can cause numerical instability Log likelihood of BIONJ tree 267607.047 -------------------------------------------------------------------- INITIALIZING CANDIDATE TREE SET -------------------------------------------------------------------- Generating parsimony trees ... ERROR Tree file does not start with an opening bracket '(' line column Any help you can provide will be greatly appreciated! I've also submitted a new issue on the IQ-TREE github page. Thanks! Kevin ", "Hi Kevin, This looks like something to do with -t BIONJ option. Are you able to run without that option? If want to restrict the starting trees, rather use -ninit, such as -ninit 2, where IQ-TREE will construct 2 starting trees, a parsimony and a BIONJ tree. I think that is better than just using the BIONJ starting tree. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2600869a-7cba-4f78-a8b7-e44edaefc84b%40googlegroups.com ", "Hi Minh, That solved the problem. Thank you so much! All the best, Kevin On Sunday, February 16, 2020 at 11:47:26 PM UTC-5, Minh Bui wrote: Hi Kevin, This looks like something to do with -t BIONJ option. Are you able to run without that option? If want to restrict the starting trees, rather use -ninit, such as -ninit 2, where IQ-TREE will construct 2 starting trees, a parsimony and a BIONJ tree. I think that is better than just using the BIONJ starting tree. Cheers, Minh On 15 Feb 2020, at 1:25 am, Kevin Keegan < kevin.l...@gmail.com > wrote: Hello, I am running IQ-TREE multicore version 1.6.6 on Ubuntu 18.04.4 (I also received the same error when running this analysis on our University's high performance computing cluster which runs IQ-TREE multicore version 1.6.6, but I'm not sure what operating system they use on the cluster). The command and seed I used were: Command /home/ kevin IQ_TREE bin iqtree alrt 1000 Noctuidae_21_alignment txt 1000 spp part txt st DNA pre Noctuidae_21_IQ TREE m TESTNEWMERGE t BIONJ safe Seed 184793 Using SPRNG Scalable Parallel Random Number Generator Which results in the error: Current log likelihood at step 267607.229 Current log likelihood at step 267607.128 Current log likelihood at step 267607.047 Parameters optimization took rounds 125.950 sec WARNING Estimated model parameters are at boundary that can cause numerical instability Log likelihood of BIONJ tree 267607.047 -------------------------------------------------------------------- INITIALIZING CANDIDATE TREE SET -------------------------------------------------------------------- Generating parsimony trees ... ERROR Tree file does not start with an opening bracket '(' line column Any help you can provide will be greatly appreciated! I've also submitted a new issue on the IQ-TREE github page. Thanks! Kevin You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "VVhCjLjn7rg": {"topic": "Errorin running tree", "initializeDate": "Jun 18, 2019, 8:24:16 AM", "timeStamp": "Jun 25, 2019, 11:42:06 AM", "content": ["Hello, I have been trying to run a tree using a model F81+F+I in iqtree for alignment of sequences. Every time I run a tree after determining the model using the model finder I am getting the same error message whose screenshot have attached below. Can someone please help me fix this. Thanks in advance for your help. Regards Swati ", "Dear Swati Udayraj, Thank you for your interest in IQ-TREE. From the little information you provide I can only guess, but\u2026 The output states that you have identical sequences in your dataset, and that some of the identical sequences are discarded (ignored) for the tree reconstruction. This happens for the sake of speed, because identical sequences will end up together anyway. Thus, some are discarded but inserted into the final tree at the end. Next the output states the IQ-TREE is reading a tree file. I guess that this treefile contains all sequences, while some have been dropped before. Thus, your tree has more sequences than used in the analysis, and IQ-TREE trows an error. Try running IQ-TREE with the \u201c-keep-ident\u201d command line option to prevent IQ-TREE from ignoring some identical sequences. If this does not fix the error, please write again providing more information (as requested at the end of your screenshot ;) Best wishes, Heiko > <image.png> > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CA%2BTV7CEwutd2B4JBvAUo%2BFZw%2BrCeC9aNpzkoXiyJUcKcwS-c-Q%40mail.gmail.com > For more options, visit https://groups.google.com/d/optout ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Hi, I think your input command is wrong, if that's what is along the top of the command prompt window. You need the -m between your alignment file name and the model you want to use. iqtree -s example.phy -m F81+F+I -bb 10000 ", "Thanks for your comments. Will try out these and see what I can do. Regards Swati To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1A20AD3F-E87F-4221-979D-2619FECFA2E3%40univie.ac.at ", "Hi Swati, I\u2019m not sure if you saw someone\u2019s answer (thank you!), but the problem is the missing -m option. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CA%2BTV7CFMCcx6wY5ZZXWKHuxEbS4HZXCH3Yjh%3DRXJa6_UO7zUTQ%40mail.gmail.com "]}, "1kGRMMf6ziU": {"topic": "IQtree crash \"Too many iterations in tqli\"", "initializeDate": "Sep 17, 2015, 7:17:41 PM", "timeStamp": "Nov 7, 2017, 7:19:27 PM", "content": ["Hi all, I've just downloaded and installed IQtree on my new computer, so this could be my fault. However, I've run IQtree before without any issues. I'm running the current version of IQtree-OMP, and running a multi-gene partitioned analysis with a 1000 replicate non-parametric bootstrap: iqtree-omp -s concat_alignment_m2.phy -sp partitionandmodels.nex -b 1000 -nt 4 It keeps crashing at different points in the analysis with this error: -------------------------------------------------------------------- | FINALIZING TREE SEARCH | -------------------------------------------------------------------- Performs final model parameters optimization Estimate model parameters (epsilon = 0.010) Optimizing K2P+I parameters for partition part5 (111 free parameters) Optimizing HKY+I+F parameters for partition part1 (114 free parameters) Optimizing HKY+F parameters for partition part2 (113 free parameters) Optimizing HKY+F parameters for partition part3 (111 free parameters) Optimizing K2P parameters for partition part4 (110 free parameters) BEST SCORE FOUND : -4994.736 Total tree length: 0.061 Total number of iterations: 160 CPU time used for tree search: 25.705 sec (0h:0m:25s) Wall-clock time used for tree search: 8.465 sec (0h:0m:8s) Total CPU time used: 26.219 sec (0h:0m:26s) Total wall-clock time used: 8.611 sec (0h:0m:8s) ===> START BOOTSTRAP REPLICATE NUMBER 29 Creating bootstrap alignment... Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.031 seconds NOTE: 0 MB RAM is required! Estimate model parameters (epsilon = 0.100) Optimizing K2P+I parameters for partition part5 (111 free parameters) Optimizing HKY+I+F parameters for partition part1 (114 free parameters) Optimizing HKY+F parameters for partition part2 (113 free parameters) Optimizing HKY+F parameters for partition part3 (111 free parameters) NUMERICAL ERROR: Too many iterations in tqli *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: partitionandmodels.nex.log *** Alignment files (if possible) Optimizing K2P parameters for partition part4 (110 free parameters) Abort trap: 6 It got through 29 replicates before it crashed this time, not sure why it worked to that point. Is this an out of memory error? Sorry, google groups is not doing anything when I click \"Attach a file\", otherwise would have attached the log. Thanks Renee ", "In addition, I have 32 GB of RAM, so putting the 4 processors onto it means I am giving it a massive amount of memory on what is not a huge dataset (56 individuals/5 partitions/~2000 bp. ", "Dear Renee, which platform (Windows, Mac, or Linux) that you ran IQ-TREE? can you please send me per personal email the log file and the input files? I will have a more careful look Thanks, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "I got the same Error message, any suggestion? "]}, "t4DxFVzvagM": {"topic": "constrained tree search on one clade somewhere in the middle of the tree, and not affecting the rest of tree topology", "initializeDate": "Aug 18, 2019, 1:53:26 AM", "timeStamp": "Aug 19, 2019, 7:42:03 AM", "content": ["Hey Minh I wanted to run a constrained tree search but want to restrict only a few samples to a clade, while keeping the rest of the tree as it is. For example, ((230-09,272-26,272-83,272-87,272-99,301-30,301-72,301-86,301-88,230-22),rest_of_samples). #the numbers are sample names. #the clade is not at the root of tree, it is some where in the middle of 200 sample tree. Is it possible? Thanks Jigs ", "Hi Jigs, I\u2019m assuming 230-09 is a sample name. If so, the constraint tree may look like: ((230-09,272-26,272-83,272-87,272-99,301-30,301-72,301-86,301-88,230-22),rest_1,rest_2,\u2026rest_k); Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7c698d15-4ca6-4097-b0f1-d30996ff6c14%40googlegroups.com ", "Hi Minh Thank you for replying! Would the order of rest_1,rest_2..rest_k with respect to the restrained clade- (230-09,272-26,272-83,272-87,272-99,301-30,301-72,301-86,301-88,230-22), and with respect to each other matter? For example- ((230-09,272-26,272-83,272-87,272-99,301-30,301-72,301-86,301-88,230-22),rest_k,rest_k-4\u2026rest_1,rest_100) or (rest_1,rest_2,rest_3,(230-09,272-26,272-83,272-87,272-99,301-30,301-72,301-86,301-88,230-22),rest_k-1,rest_100,rest_k-30) And, would the order of samples in the restrained clade matter? For example- ((230-26,272-83,272-09,272-87,272-99,301-30,301-80,301-72,301-86,301-30,230-22),rest_1,rest_2,\u2026rest_k) Regards Jigyasa ", "No, the ordering does not matter at all. All the variants you wrote correspond to the same constraint tree. Cheers Minh "]}, "G2yG0A0_rLk": {"topic": "Output order of trees when running -S", "initializeDate": "Jun 21, 2020, 4:03:43 PM", "timeStamp": "Jun 22, 2020, 12:46:02 PM", "content": ["Hello, Does IQ-Tree preserve the input order (sorted file names) in the output .treefile? For instance, if I have a directory called dir whose sorted contents are: aln1 aln2 aln3 And I run: iqtree S dir prefix loci Will the outpu t file loci.treefile have trees in the order: tree1 from aln1 tree2 from aln2 tree3 from aln3 or is this ordering lost? If the order is not preserved, is there an easy way to link the tree back to the alignment (from one of the log files perhaps)? Some log info appears to preserve this order while some does not. Does using multiple threads ( ) affect ordering of the output at all? Thanks! -Gregg ", "Hi Gregg, On 22 Jun 2020, at 6:03 am, Gregg Thomas < greg...@gmail.com > wrote: Hello, Does IQ-Tree preserve the input order (sorted file names) in the output .treefile? For instance, if I have a directory called dir whose sorted contents are: aln1 aln2 aln3 And I run: iqtree S dir prefix loci Will the outpu t file loci.treefile have trees in the order: tree1 from aln1 tree2 from aln2 tree3 from aln3 Yes the files in the directory will be sorted alphabetically. In the order of trees in treefile will follow this same order. You can look at .iqtree file, which prints the order of \u201cpartitions\u201d to link them back. or is this ordering lost? If the order is not preserved, is there an easy way to link the tree back to the alignment (from one of the log files perhaps)? Some log info appears to preserve this order while some does not. Does using multiple threads ( ) affect ordering of the output at all? As said above, the alphabetical order is preserved, no matter if it\u2019s multithreading or not. Do not look at .log file for this information, but the .iqtree file. This is because during the run, IQ-TREE actually orders the alignments by size, s.t. large alignments will be processes before small alignments, which will save the total waiting time. This is actually a greedy scheduling algorithm: one needs to do heavy jobs first, so that at the end the threads do not have to wait much for one thread finishing their job. Minh Thanks! -Gregg You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/49e1fb4e-b42d-4ee5-905a-631c971b6acao%40googlegroups.com ", "Great, thank you! -Gregg "]}, "WSJU_vE7BIk": {"topic": "Re: [iqtree] Segmentation error after resuming analysis from *.ckp.gz checkpoint", "initializeDate": "Sep 20, 2017, 8:39:49 PM", "timeStamp": "Oct 10, 2017, 5:04:54 AM", "content": ["Dear Ales, Thanks for the report. And yes can you pls send me all input and output files for debugging purpose via my personal email? Thanks, Minh On Sep 18, 2017, at 10:59 PM, Ales Bucek < bucek...@gmail.com > wrote: Hi, I got a \"SEGMENTATION FAULT\" after resuming analysis from a checkpoint (the previous analysis timed-out due to job limit) running IQTREE as follows: iqtree omp 1.5 Linux bin iqtree omp FcC_smatrix_nostops fas spp genepartitionsANDcodonpositions_grepped m GTR mrate E m TESTMERGE rcluster alrt 1000 1000 pre IQTREE55 See couple of last lines of the log file. 29755 K3Pu 11642592.150 OrthoDB_OMA01714_pos2 OrthoDB_OMA02382_pos2 34m 53s 30m 45s left 29756 TPM3u 11642580.078 OrthoDB_OMA01714_pos2 OrthoDB_OMA02729_pos2 34m 54s 30m 45s left Merging OrthoDB_OMA00372_pos2 OrthoDB_OMA02729_pos2 with BIC score 11642551.829 5112444.883 107563 29757 TIM2 11640894.681 OrthoDB_OMA00372_pos2 OrthoDB_OMA02729_pos2 OrthoDB_OMA01608_pos2 37m 53s 33m 39s left *** TREE CRASHES WITH SIGNAL SEGMENTATION FAULT *** For bug report please send to developers *** Log file IQTREE55 log *** Alignment files possible Please let me know if I should send you the complete logfile or any other files. Thanks for your advice, Ales You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Please feel free to remove this post - I was using incorrect run parameters in this case (I tried to set a model via \"-m GTR instead of -mset GTR\"...so there is no need to evaluate further the reason for a \"Segmentation\" error) Ales "]}, "qm7KCwteWj0": {"topic": "Robinson Fould's distance", "initializeDate": "Jul 7, 2016, 3:15:51 PM", "timeStamp": "Jul 7, 2016, 5:14:18 PM", "content": ["Dear users, I'm interested in calculating pairwise RF distances between a set of tree's. My dataset consists of genome-wide SNPs. I ran a ML analysis using IQTREE with the following flags: iqtree -m TEST+ASC -wbt -bb 1000 To calculate the RF distances between bootstrapped trees i ran the -rf flag with my .ufboot file as the input treeset: iqtree -rf mytreeset.ufboot However i get nothing in return. Am I doing something wrong? Thank you in advance Regards, Chan ", "Dear Chan, the right option is -rf_all instead. That means, > iqtree -rf_all mytreeset.ufboot See also: http://www.cibiv.at/software/iqtree/doc/Advanced-Tutorial/#computing-robinson-foulds-distance-between-trees Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "Ca9lKtjbdQU": {"topic": "test between types of complex models", "initializeDate": "Jan 25, 2019, 11:59:02 PM", "timeStamp": "Jan 30, 2019, 5:29:54 PM", "content": ["Hello community, I would like to test which category of model fits my data best. Such as simple model (LG+G), partition model (with a partition definition file), mixture model (say, LG+C60), PMSF (LG+C60 plus a guide tree), and GHOST model (LG+H4). For example, I want to know whether partitioning increases tree quality. Or, I want to know whether PMSF approximates C60 by using a guide tree without much cost. Is this doable in ModelFinder? If not, can I do this manually? Say, by using a log-likelihood ratio test between the output likelihoods of two separate runs? If so will I need to find the difference of degree of freedom somehow? Thank you very much! Best, Qiyun ", "Hi Qiyun, Except for the PMSF, you can manually compare BIC / AIC scores of different models from different runs printed in the .iqtree file, which looks like this: Log-likelihood of the tree: -22673.7811 (s.e. 344.8172) Unconstrained log-likelihood (without tree): -11402.5956 Number of free parameters (#branches + #model parameters): 43 Akaike information criterion (AIC) score: 45433.5623 Corrected Akaike information criterion (AICc) score: 45435.4988 Bayesian information criterion (BIC) score: 45674.3581 Alternatively, you can use -mfreq and -mrate options ( http://www.iqtree.org/doc/Command-Reference#automatic-model-selection ) for testing combinations of frequency and rate models within a single run, for example: iqtree -mset LG -mfreq F,F+C10,F+C60 -mrate E,I,G,I+G,H4 ... (Note that I use -mset option as you seem to only test LG substitution model). This will test all combinations of LG+F, LG+F+I, \u2026 LG+F+C60+G, etc. However, this might take a while to finish for large data sets. Thus, manually running with different models will save time. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "PS: For the PMSF, the degree of freedom is not known, thus you can\u2019t compare AIC / BIC scores. See \u201cThe Issue of Model selection under PMSF\u201d section: https://doi.org/10.1093/sysbio/syx068 Minh ", "Dear Minh, Thank you very much for the instruction! Very helpful to me! Best, Qiyun "]}, "Dlm6WzadnhE": {"topic": "For your convenience alignment with variable sites printed to file.phy", "initializeDate": "Jun 26, 2019, 2:33:07 AM", "timeStamp": "Jun 26, 2019, 11:36:47 PM", "content": ["Hi Developers: I encounter one question. My data is SNPs, then I concatenated them into fasta file format based on the genotype, then I run the iqtree with command: iqtree -s file.fasta -m GTR+G+ASC -b 100 -nt 10 -st DNA But I got one error: ERROR: For your convenience alignment with variable sites printed to file.fasta.varsites.phy ERROR: Invalid use of +ASC because of 912724 invariant sites in the alignment I am not sure the reason, So can you help this? And the next I run the iqtree with the file.fasta.varsites.phy, is this right? Any help will be appreciated! ", "Hi John, Please first have a look at this FAQ: http://www.iqtree.org/doc/Frequently-Asked-Questions#why-does-iq-tree-complain-about-the-use-of-asc-model How many sites are you left with, if these nearly 1M sites are removed? I believe for SNP data, character R is interpreted as \"A and G\u201d, and not \u201cA or G\u201d (see the above section of the FAQ). That\u2019s why the warning about too many invariant sites. Therefore, using a standard DNA substitution model might not be appropriate. Alternatively, you can use the \u201cpolymorphism aware\" model. Please look at the document as well. And some previous discussions here about the PoMo model. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1b4097db-38df-42de-a879-8fead4aff009%40googlegroups.com For more options, visit https://groups.google.com/d/optout "]}, "Xo8baNMJxAU": {"topic": "Disable sequence rename step", "initializeDate": "Mar 28, 2018, 7:58:18 AM", "timeStamp": "Dec 9, 2019, 6:31:52 AM", "content": ["Dear iq-tree users, I would like to know if there is a way to disable the sequence rename step in iq-tree. My sequences have a '@' character in their name which is automatically replaced by a '_' by iq-tree. This is a problem since my sequences also contains '_' symbol and would like to avoid to write another script for renaming the sequences after the iq-tree run. Thank you, Jean ", "Dear Jean, Thank you for your interest in IQ-Tree. The reason for the translation is that certain letters are by definition forbidden in the alignment or more specifically in the tree formats which are used internally and for output by phylogenetic programs. Thus, the renaming step is done on purpose and has to be done since otherwise one may run into troubles later on in the analysis, e.g., because the tree format might be invalid due to the characters used. A more obvious example would be using comma, semicolon, colon and brackets in the sequence names which would immediately break the tree format in most of the cases. To circumvent the problem you are seeing, I would suggest to substitute all occurrences of \u2018@\u2018 in the sequence names by something like \u2018__AT__\u2019 and then substitute it back at the end of the analysis. Just make sure the patters you substitute such \u2018illegal\u2019 letter with is uniquely recognised to be able the back-convert them. Furthermore, there is a tool called taxnameconvert ( http://www.cibiv.at/software/taxnameconvert/ ) that can be used converting taxon names using a table of tab-delimited columns. The tool would convert all names as provided in one specified column into the name found in the same row in another specified column of that table. And afterwards you can do the same thing the other way round to get the original names back. @Minh: are there other solutions you would suggest? Best regards, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) Campus Vienna Biocenter 5 (VBC5) A-1030 Vienna, Austria ----------------------------------------------------------------------------- ", "Heiko gave a good solution, thanks! The sequence names should contain the following characters: alphabet, numeric, underscore (_), dash (-) and dot (.). All other characters will be converted to underscore. This is hard coded in IQ-TREE (i.e. no way to disable it, unfortunately). Minh ", "Thanks for the above answer, but I'd like to hear a little more. In viral phylogenetics it is exceedingly common to have names that look like this: EBOV|380_EMLH|KU296377|SLE|?|2015-01-22 and these things do have meaning: the |'s separate chunks of information. When IQTREE changes the |'s to _, we can't parse things back out easily. | and ? are legal characters in the Newick standard, and I've never had a problem with any other program using them: not BEAST, RAxML or FastTree. I realize that we can do translation back and forth, but it would be easier for me to modify the IQTREE code to allow these characters. If I do so, will bad things happen? Thank you! Erick On Wednesday, March 28, 2018 at 10:10:44 PM UTC-7, Minh Bui wrote: Heiko gave a good solution, thanks! The sequence names should contain the following characters: alphabet, numeric, underscore (_), dash (-) and dot (.). All other characters will be converted to underscore. This is hard coded in IQ-TREE (i.e. no way to disable it, unfortunately). Minh > On 29 Mar 2018, at 12:12 am, Heiko Schmidt < heiko....@univie.ac.at > wrote: > Dear Jean, > Thank you for your interest in IQ-Tree. > The reason for the translation is that certain letters are by definition forbidden in the alignment or more specifically in the tree formats which are used internally and for output by phylogenetic programs. Thus, the renaming step is done on purpose and has to be done since otherwise one may run into troubles later on in the analysis, e.g., because the tree format might be invalid due to the characters used. A more obvious example would be using comma, semicolon, colon and brackets in the sequence names which would immediately break the tree format in most of the cases. > To circumvent the problem you are seeing, I would suggest to substitute all occurrences of \u2018@\u2018 in the sequence names by something like \u2018__AT__\u2019 and then substitute it back at the end of the analysis. > Just make sure the patters you substitute such \u2018illegal\u2019 letter with is uniquely recognised to be able the back-convert them. > Furthermore, there is a tool called taxnameconvert ( http://www.cibiv.at/software/taxnameconvert/ ) that can be used converting taxon names using a table of tab-delimited columns. The tool would convert all names as provided in one specified column into the name found in the same row in another specified column of that table. And afterwards you can do the same thing the other way round to get the original names back. > @Minh: are there other solutions you would suggest? > Best regards, > Heiko >> On 28 Mar 2018, at 13:58, Jean Keller < jean.k...@gmail.com > wrote: >> Dear iq-tree users, >> I would like to know if there is a way to disable the sequence rename step in iq-tree. My sequences have a '@' character in their name which is automatically replaced by a '_' by iq-tree. This is a problem since my sequences also contains '_' symbol and would like to avoid to write another script for renaming the sequences after the iq-tree run. >> Thank you, >> Jean >> -- >> You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. >> To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com >> To post to this group, send email to iqt...@googlegroups.com >> Visit this group at https://groups.google.com/group/iqtree >> For more options, visit https://groups.google.com/d/optout > ----------------------------------------------------------------------------- > Heiko Schmidt > Center for Integrative Bioinformatics Vienna (CIBIV) > University of Vienna / Max F. Perutz Laboratories (MFPL) > Campus Vienna Biocenter 5 (VBC5) > A-1030 Vienna, Austria > ----------------------------------------------------------------------------- > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Erick, I see. The problem was due to a library that we used internally (BIONJ) does not work with special characters. But we\u2019ll see what can be done to avoid that. Please note that if there is any change for this, it will only occur in v2.0 as this is considered as a new features. Whereas we stop adding feature to v1.X, which will only receives critical bug fix. Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9f17592a-3832-4c33-a01c-9fc6d6392ac4%40googlegroups.com ", "PS: Can you pls send me the link where the Newick format is formally defined? To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/67FC3670-E33D-4D38-87B3-42BDA2EB8922%40univie.ac.at ", "Hi Minh, I thing the oldest (and most original description, I have stumbled about are: - the one inside Joe Felsenstein's PHYLIP package: http://evolution.genetics.washington.edu/phylip/newicktree.html This links to this as the formal definition: - Gary Olsen's Interpretation of the \"Newick's 8:45\" Tree Format Standard http://evolution.genetics.washington.edu/phylip/newick_doc.html and to the Wikipedia page about the format: https://en.wikipedia.org/wiki/Newick_format The first defines: \u201cA name can be any string of printable characters except blanks, colons, semicolons, parentheses, and square brackets.\u201d Thus, \u201c|\u201d and \u201c?\u201d should better be allowed, BioNJ seems to have been too strict here. Furthermore, for several tree-drawing programmes the use of quoted labels do work, which then can also contain spaces, commas etc (as mentioned in the 2nd description). What I often do is substituting the names used in the alignment by other names later in the final tree after tree search using taxnameconvert ( http://www.cibiv.at/software/taxnameconvert/ ). All that is needed is a tab-delimited table of names and you can state names of which column shock be substituted by what other columns and you can tell the program to surround the names by singe or double quotes. Best wishes, Heiko > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4B9D91DE-4B7B-4FCA-8422-512572481067%40univie.ac.at ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs Campus Vienna Biocenter 5 (VBC5) A-1030 Vienna, Austria ----------------------------------------------------------------------------- Email: heiko.schmidt(AT) univie.ac.at Tel. : ++43 +1 / 4277 - 74321 http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Heiko and Minh-- Thank you for considering! And yes, v2 would be just fine. Erick Frederick \"Erick\" Matsen, Associate Member Fred Hutchinson Cancer Research Center http://matsen.fredhutch.org/ "]}, "QYhXz9_52Lg": {"topic": "Modelfinder heuristic", "initializeDate": "Feb 19, 2021, 10:08:08 AM", "timeStamp": "Feb 22, 2021, 3:01:12 AM", "content": ["Hi Minh, My question is related to at least one other question already asked here. When running Modelfinder on my data with IQ-TREE 2.1.2 with the following command: iqtree -s strict.fas -mset LG -madd C10+F+G,C20+F+G,C60+F+G,LG+C10+F+G,LG+C20+F+G,LG+C60+F+G all mixture models are ignored in the analysis: ModelFinder will test up to 32 protein models (sample size: 170140) ... ModelFinder will test up to 32 protein models (sample size: 170140) ... No. Model -LnL df AIC AICc BIC 1 LG 2943070.717 109 5886359. 435 5886359 .576 5887454.272 2 LG+I 2753622.735 110 5507465.471 5507465. 614 5508570 .352 3 LG+G4 2663121.791 110 5326463.582 5326463. 725 5327568 .463 4 LG+I+G4 2654337.413 111 5308896. 825 5308896 972 5310011 .751 5 LG+R2 2681429.118 111 5363080.235 5363080.381 5364195.161 6 LG+R3 2653494.544 113 5307215.088 5307215. 239 5308350 .102 7 LG+R4 2648416.029 115 5297062.059 5297062. 215 5298217 .162 8 LG+R5 2647403.863 117 5295041. 726 5295041 888 5296216 .918 9 LG+R6 2647294.536 119 5294827.073 5294827.241 5296022.353 10 LG+R7 2647250.998 121 5294743.997 5294744.170 5295959.366 11 LG+R8 2647243.450 123 5294732. 901 5294733 .080 5295968.359 23 LG+F+R7 2645420.440 140 5291120.881 5291121.113 5292527.093 WARNING: Log-likelihood -2.64544e+06 of LG+F+R8 worse than LG+F+R7 -2.64542e+06 24 LG+F+R8 2645438.749 142 5291161.499 5291161.738 5292587.800 Akaike Information Criterion: LG+F+R7 Corrected Akaike Information Criterion: LG+F+R7 Bayesian Information Criterion: LG+F+R7 Best-fit model: LG+F+R7 chosen according to BIC The same command in IQ-TREE 1.6.12 searches all of the models in the list: ModelFinder will test 32 protein models (sample size: 170140) ... No. Model -LnL df AIC AICc BIC 1 LG 2942916.704 109 5886051. 408 5886051 .549 5887146.245 2 LG+I 2753715.827 110 5507651.654 5507651.798 5508756.536 3 LG+G4 2663413.860 110 5327047. 719 5327047 .863 5328152.601 4 LG+I+G4 2654660.907 111 5309543. 814 5309543 .960 5310658.740 5 LG+R2 2681694.363 111 5363610. 726 5363610 .872 5364725.652 6 LG+R3 2653821.823 113 5307869.645 5307869.797 5309004.660 7 LG+R4 2648733.870 115 5297697.739 5297697.896 5298852.843 8 LG+R5 2647735.096 117 5295704.191 5295704.354 5296879.383 9 LG+R6 2647734.725 119 5295707.449 5295707. 617 5296902 .730 14 LG+F 2939855.844 128 5879967.688 5879967.882 5881253.368 15 LG+F+I 2750522.258 129 5501302. 516 5501302 .713 5502598.241 16 LG+F+G4 2661348.862 129 5322955. 724 5322955 .921 5324251.448 17 LG+F+I+G4 2652729.180 130 5305718.359 5305718. 559 5307024 .128 18 LG+F+R2 2679422.706 130 5359105. 413 5359105 .613 5360411.182 19 LG+F+R3 2651895.306 132 5304054. 613 5304054 .819 5305380.470 20 LG+F+R4 2646869.963 134 5294007.926 5294008.138 5295353.872 21 LG+F+R5 2645895.794 136 5292063.589 5292063. 808 5293429 .624 22 LG+F+R6 2645895.697 138 5292067.395 5292067.621 5293453.519 Model C10+F+G is alias for [..clipped..] 27 C10+F+G 2658098.597 139 5316475.194 5316475. 423 5317871 .362 Model C20+F+G is alias for [..clipped..] 28 C20+F+G 2612765.914 149 5225829. 829 5225830 .092 5227326.441 Model C60+F+G is alias for [..clipped..] 29 C60+F+G 2577243.864 189 5154865.728 5154866.150 5156764.115 Model LG+C10+F+G is alias for [..clipped..] 30 LG+C10+F+G 2596404.886 139 5193087. 772 5193088 .001 5194483.940 Model LG+C20+F+G is alias for [..clipped..] 31 LG+C20+F+G 2576136.297 149 5152570.594 5152570. 857 5154067 .206 Model LG+C60+F+G is alias for [..clipped..] 32 LG+C60+F+G 2560608.678 189 5121595.356 5121595. 778 5123493 .743 Akaike Information Criterion: LG+C60+F+G Corrected Akaike Information Criterion: LG+C60+F+G Bayesian Information Criterion: LG+C60+F+G Best-fit model: LG+C60+F+G chosen according to BIC From what I understood from your past answers is that IQ-TREE 2 has a heuristic that filters out non-promising models. Is this the reason why they are not tested? In my example, the mixture model favoured over the FreeRate model (in IQ-TREE 1.6.12). Is there a way to switch off this heuristic in IQ-TREE 2? Thanks a lot, Alex ", "Hi Alex, This is a bug in 2.1.2. We\u2019ll fix it. Thanks! Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/16f13642-d3e7-470d-9f5a-f9ce11285947n%40googlegroups.com ", "Hi Minh, Good to know - thanks a lot! Cheers, Alex "]}, "SA-wh932uMM": {"topic": "Missing bootstrap values from gene phylogeny", "initializeDate": "Oct 20, 2020, 12:46:10 PM", "timeStamp": "Oct 20, 2020, 1:02:57 PM", "content": ["Hi, I created a small gene phylogeny on IQTREE using the command iqtree -s filename.fa -bb 1000. The tree ran without any problems, but once visualising the tree on FigTree/iTOL I realised some branches do not possess bootstrap values. Why is this? Please find below the tree in newick format: (Calrhi.WP_088241988.1:0. 5708744107 ,(PlaSR0.WP_054468690.1:0.4674283759,(((((Artpla.WP_014277365.1:0.3574467866,Lynaes.WP_023067654.1:0.3971513379)67:0.0685462129,Phoamb.WP_073593169.1:0.0984121625)94:0.3707417681,Scy0HK.WP_073633229.1:0.2575368735)85:0.4278621519,Lephen.WP_075600544.1:0.7557370112)99:0.9529824278,(Photen.WP_073606747.1:1.5476647898,(((((((Dacsal.WP_015228585.1:0.0865298679,Rublac.WP_022605525.1:0.2372597142)75:0.0541069296,Phoamb.WP_073594235.1:0.0873684851)69:0.0478547978,(DesIPP.WP_069968018.1:0.0698609368,Lyncon.WP_039725555.1:0.2163940024)59:0.0552045765)23:0.0231135857,Hydriv.WP_073598751.1:0.1279005136)37:0.0471837868,Lepoha.WP_088892817.1:0.1673635248)65:0.0325471766,Lephen.WP_075597589.1:0.1088757179)78:0.1833133085,Photen.WP_073606613.1:0.0885481772)99:0.8323926423)59:0.4494892823)95:0.8089121355)68:0.1552075844,Hyd0CS.WP_094678010.1:0.5102097010); Thank you in advance, Best wishes, Maria ", "Dear Maria Mantas, I had a look at your Newick string. Actually all internal branches have a bootstrap value, which you can see by checking the closing brackets. All have a number (the bootstrap support) after the bracket and before the colon (:) after which follows the branch length. The only branches that do not (and cannot) have a branch length are the external branches leading to the leafs of the tree. These never have support values assigned because you will find them in every tree, otherwise the leaf would not be connected to the tree. Hence, the external branches are also called trivial splits, because they are always there and would always obtain a support of 100%. However, I have seen that some inner branches have support values as low as 23 or 37. It could be that the tree viewer you are using has a lower threshold under which it does not print the support values. (I often have done the manually in the past e.g. below 50% or 60%, because these branches do not really have support.) Does this answer you problem? Best wishes, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAFa6f8PM3hkRTOB46qPviiw1-f9E0VfcRU7_DODzVjt%2B%2BOEi9Q%40mail.gmail.com ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- "]}, "Sk3R5K0Ac-M": {"topic": "Map concensus support values on a user-specified tree", "initializeDate": "Feb 12, 2020, 6:31:26 AM", "timeStamp": "Feb 13, 2020, 4:09:29 PM", "content": ["Hi IQ-tree users, I'm dealing with a difficult dataset, on which different ML tree searches recover quite different trees, bringing to high variance in logL values. I've thought to run a high number of tree searches (like 100), then computes a consensus tree and compare it with the one with the best logL I am interested in mapping the support values of the consensus tree on the \"best\" ML tree founded in the previously runs. Is it possible? Cheers, Jacopo. ", "Hi Jacopo, This can be done with --gcf option: http://www.iqtree.org/doc/Concordance-Factor While it is about the gene concordance factor, it actually generalizes the consensus (by allowing input trees to have incomplete taxon set). So you can put all 100 trees into one file, and then run something like: iqtree -t BEST_ML_TREE_FILE --gcf 100_TREES_FILE Alternatively you can also use -sup option, which is faster (as it\u2019s only for consensus stuff): iqtree -sup BEST_ML_TREE_FILE -t 100_TREES_FILE Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9a93d3f1-696a-461e-8a8e-cf3c6136ce91%40googlegroups.com "]}, "M9cgWtsORAA": {"topic": "modeltest with partitioned dataset + heterotachy version", "initializeDate": "Nov 8, 2016, 12:28:41 PM", "timeStamp": "Nov 20, 2016, 5:27:59 PM", "content": ["hi all, sorry for this probably stupid question - if I want IQtree to estimate the best model for each partition, how my partitionfile (nexus) should look like then? (or will -m TEST or -m TESTNEW \"overrule\" something given in the partition file (nexus format) ? Moreover I was wondering if I can also to this with the \"heterotachy\" version (1.4.3 heterotachy) having partitions ready ? Thanks Karen ", "Hi Karen, On Nov 8, 2016, at 6:28 PM, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: hi all, sorry for this probably stupid question not stupid at all ;-) - if I want IQtree to estimate the best model for each partition, how my partitionfile (nexus) should look like then? (or will -m TEST or -m TESTNEW \"overrule\" something given in the partition file (nexus format) ? by default -m TEST (or -m TESTNEW) will overrule all models specified via \u201ccharpartition\" command in the NEXUS file. In fact it suffices to just have \u201ccharset\u201d command in NEXUS file. IQ-TREE will then find best model for each partition and disregard charpartition. Moreover I was wondering if I can also to this with the \"heterotachy\" version (1.4.3 heterotachy) having partitions ready ? does it mean, you want to have +H (rate heterotachy model) for each partition? This is not possible, as it can be well over-fitting with too many parameters (for example, +H2 adds 2*(2n-3) branch length parameters to estimate, where n=#taxa). Right now, +H is meant to be used with the whole length phylogenomic alignment, and not to combine with partition models. FYI: we are now modifying the heterotachy model to work with other mixture models, for example LG+C10+H4. I will let you know once that happens. Minh Thanks Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, thanks for the answer (I answered last week alreay but got lost somehow. Thanks for your comments. ok - I actually was thinking to try this because of the heterogeneity acros the tree (so lineages) - so if it only to make sense to apply here this on an unparetitioned dataset I probably will for now not try this version because I probably can't compare what is better, partitioned with all kins of models or unpartitioned mixtuer model). How is heterogeneity along the tree (taxon sampling) addresse in the heterotachy version (or is it at all?) Thanks Karen ", "Hi Karen, On Nov 14, 2016, at 11:06 AM, Karen Meusemann < kmeus...@googlemail.com > wrote: Hi Minh, thanks for the answer (I answered last week alreay but got lost somehow. Thanks for your comments. ok - I actually was thinking to try this because of the heterogeneity acros the tree (so lineages) - so if it only to make sense to apply here this on an unparetitioned dataset I probably will for now not try this version because I probably can't compare what is better, partitioned with all kins of models or unpartitioned mixtuer model). How is heterogeneity along the tree (taxon sampling) addresse in the heterotachy version (or is it at all?) I think it is right now controversial when to use partition or mixture models\u2026 several experts discussed about this in http://phyloseminar.org , see the recent series about heterogeneous substitution by Andrew Roger, Nathan Whelan and Nicholas Lartillot. I would personally recommend that one should apply both partition and mixture models to gain more confidence if the results agree. About the heterotachy version: we are still experimenting this model, thus more analysis and verification are needed. We will let you know when it is more ready to use. Cheers, Minh "]}, "CeNBGcLG8RQ": {"topic": "input alignment file", "initializeDate": "Mar 1, 2020, 6:31:11 AM", "timeStamp": "Mar 7, 2020, 2:22:28 AM", "content": ["DearSeniors! Please help me I have a query related to the input file of alignment. I aligned my sequences using mega software. and saved the output file in FASTA format. when I insert this file in iqtree for constructing the phylogenetic tree. they show an error of file not found. your guidance and expertise are needed. Thanks. ", "Hi Maryam, do you use a command line to run iqtree? if yes, check if you specified a full path to the alignment file. If you running iqtree in the same directory, where your alignment file is, check if the name of the file is correct. Cheers, Olga ", "Thankyou Olga for your kind response. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/359347d3-e4e5-4809-8db9-14353d52fa0d%40googlegroups.com "]}, "GWKQjwRu8h4": {"topic": "Does IQTREE use evolutionary placement algorithm?", "initializeDate": "Feb 24, 2021, 12:20:17 AM", "timeStamp": "Feb 24, 2021, 6:25:04 PM", "content": ["For my master thesis I am conducting a phylogenetic research and for this I'm using tools like MEGA, IQTREE, FigTree, etc to make a phylogenetic tree. I wanted to know if IQTREE integrates the evolutionary placement algorithm (EPA) when it calculates a phylogenetic tree. If it does not do this, then how does it go about the constructing of trees? ", "Hi there, On 24 Feb 2021, at 4:20 pm, Samragi Chatim < samragi...@gmail.com > wrote: For my master thesis I am conducting a phylogenetic research and for this I'm using tools like MEGA, IQTREE, FigTree, etc to make a phylogenetic tree. I wanted to know if IQTREE integrates the evolutionary placement algorithm (EPA) when it calculates a phylogenetic tree. Currently there is no efficient EPA implementation in IQ-TREE (we are working on one), but you can use the constraint tree option -g. IQ-TREE will then try to place taxa not in the constraint tree. If it does not do this, then how does it go about the constructing of trees? Yes it can. See above. Is that what you are looking for? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/12f27479-fc5f-48b8-9c52-7a69121b0467n%40googlegroups.com "]}, "3NgLSLRbB-Q": {"topic": "Feature suggestion: More than one user-defined constraint tree", "initializeDate": "Jun 3, 2017, 9:30:53 AM", "timeStamp": "Nov 26, 2020, 7:51:28 AM", "content": ["Hi Minh and the IQ-TREE team, Thanks again for the great software! My research has been made both more efficient and more flexible due to your efforts. Bravo! I have a suggestion for a future version of IQ-TREE which is being prompted by a project currently in progress. Suppose we have several ingroup taxa\u2026 some of which are living animals represented by both DNA and morphology, while other ingroup taxa are fossils represented only by morphology. Also suppose that the outgroup taxa are similarly represented\u2026 some are living and some are fossils. Let\u2019s also assume that the DNA data representing the living taxa is robust - maybe a 40 gene concatenated alignment with 50,000 positions. In a model and partition scheme test using IQ-TREE or PartitionFinder (or whatever software) we find it makes most sense to use 12 DNA partitions some of which use a GTR+G model and others a GTR+I+G model. If we want to force all ingroup taxa to form a monophyletic group, we can easily do so by using the -g option. This can be done with a constraint tree like the example \u201cmonophyly.constraint.tree.nwk\u201d attached below. To use this in IQ-TREE, I simply add \u201c-g monophyly.constraint.tree.nwk\u201d to the terminal call. However, if the DNA data has been used in a previous study to infer the relationships among the living taxa (and the support values for those relationships are strong), a different approach could be made. Suppose we eliminate the DNA data from the current analysis altogether and instead use only morphology . We could create a \u201cmolecular scaffold\u201d tree based on the previous study to lock down the relationships among living taxa and allow fossils to assume their most likely positions. If we are willing to assume that the inclusion of fossil taxa won\u2019t change the relationships among living taxa, this approach has a major advantage\u2026 the software does not have to deal with GTR+G and GTR+I+G parameters across 12 different partitions and can therefore greatly reduce processing time. This can be done with a scaffold tree like the example \u201cscaffold.constraint.tree.nwk\u201d attached below. To use this in IQ-TREE, I simply add \u201c-g scaffold.constraint.tree.nwk\u201d to the terminal call. But.... What if we want to use BOTH scaffold and monophyly constraints at the same time? This would be quite advantageous! The trick of course is that we need to provide scaffold and monophyly constraint trees that are fully congruent (like the two trees attached). This can be done in MrBayes using a combination of \u201chard\u201d (monophyly) and \u201csoft\u201d (backbone) constraints. TNT also offers the option to combine monophyletic group trees and skeleton trees. Both MrBayes and TNT run a congruence test on the user-defined trees before processing the data and stop if the trees fail this test. My suggestion for a future version of IQ-TREE would be to allow more than one constraint tree under the condition that they are congruent. Maybe the terminal call could be adapted to something like: \u201c-g1 momophyly.constraint.tree.nwk -g2 scafold.constraint.tree.nwk\u201d. One foreseeable issue would be to preserve the code of former IQ-TREE versions by setting -g and \u2013g1 to be synonymous commands. As far as I know, RAxML does not allow more than one set of user-defined constraints. If IQ-TREE could incorporate this feature, it would add to the growing list of items that make your software more versatile and better adapted to deal with diverse data sets. Thanks for hearing me out. Cheers! -Steven ", "Dear Steven, you are welcome. For your example, since the two constraint trees are congruent, you can merge them into one tree. And input this merged constraint tree into IQ-TREE, right? I agree that accepting more than 1 constraint tree is still more convenient. However, right now we have a more pressing thing to do, that the constrained tree search is quite slow for taxon-rich data sets because of an inefficient data structure to handle constraints. Thus, we have to improve this first, before adding further feature. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <monophyly.constraint.tree.jpg> <scaffold.constraint.tree.jpg> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "This is almost exactly what I am in need of doing. I have a trustworthy molecular tree which I can use as a scaffold my > 100 extant taxa, and I have > 400 fossils. The catch is that this requires the use of \"soft\" or \"partial\" constraints, which I have done extensively in MrBayes. Minh, would you clarify for me: If I specify a scaffold tree only including extant taxa ( i.e. , I omit the fossils from the constraint tree), can the fossils \"traverse\" the constrained node (as in a \"partial\" constraint), or will they be excluded from the clades designated in the scaffold tree? In other words, does the -g newick tree specify \"hard\" constraint or \"partial\" constraint? Thank you, Brendon ", "Hi Brendon, On 21 Feb 2020, at 2:08 pm, Brendon Boudinot < boud...@gmail.com > wrote: This is almost exactly what I am in need of doing. I have a trustworthy molecular tree which I can use as a scaffold my > 100 extant taxa, and I have > 400 fossils. The catch is that this requires the use of \"soft\" or \"partial\" constraints, which I have done extensively in MrBayes. Can you explain what is soft / partial constraints? Minh, would you clarify for me: If I specify a scaffold tree only including extant taxa ( i.e. , I omit the fossils from the constraint tree), can the fossils \"traverse\" the constrained node (as in a \"partial\" constraint), or will they be excluded from the clades designated in the scaffold tree? In other words, does the -g newick tree specify \"hard\" constraint or \"partial\" constraint? Any taxa not included in the constraint tree are free to move everywhere - the bottom line is that there is no constraint about them. Does that answer your question? (I don\u2019t know what is partial constraint, to be honest). Cheers Minh Thank you, Brendon On Saturday, June 3, 2017 at 6:30:53 AM UTC-7, steven.wa...@ gmail.com wrote: Hi Minh and the IQ-TREE team, Thanks again for the great software! My research has been made both more efficient and more flexible due to your efforts. Bravo! I have a suggestion for a future version of IQ-TREE which is being prompted by a project currently in progress. Suppose we have several ingroup taxa\u2026 some of which are living animals represented by both DNA and morphology, while other ingroup taxa are fossils represented only by morphology. Also suppose that the outgroup taxa are similarly represented\u2026 some are living and some are fossils. Let\u2019s also assume that the DNA data representing the living taxa is robust - maybe a 40 gene concatenated alignment with 50,000 positions. In a model and partition scheme test using IQ-TREE or PartitionFinder (or whatever software) we find it makes most sense to use 12 DNA partitions some of which use a GTR+G model and others a GTR+I+G model. If we want to force all ingroup taxa to form a monophyletic group, we can easily do so by using the -g option. This can be done with a constraint tree like the example \u201cmonophyly.constraint.tree.nwk\u201d attached below. To use this in IQ-TREE, I simply add \u201c-g monophyly.constraint.tree.nwk\u201d to the terminal call. However, if the DNA data has been used in a previous study to infer the relationships among the living taxa (and the support values for those relationships are strong), a different approach could be made. Suppose we eliminate the DNA data from the current analysis altogether and instead use only morphology . We could create a \u201cmolecular scaffold\u201d tree based on the previous study to lock down the relationships among living taxa and allow fossils to assume their most likely positions. If we are willing to assume that the inclusion of fossil taxa won\u2019t change the relationships among living taxa, this approach has a major advantage\u2026 the software does not have to deal with GTR+G and GTR+I+G parameters across 12 different partitions and can therefore greatly reduce processing time. This can be done with a scaffold tree like the example \u201cscaffold.constraint.tree.nwk\u201d attached below. To use this in IQ-TREE, I simply add \u201c-g scaffold.constraint.tree.nwk\u201d to the terminal call. But.... What if we want to use BOTH scaffold and monophyly constraints at the same time? This would be quite advantageous! The trick of course is that we need to provide scaffold and monophyly constraint trees that are fully congruent (like the two trees attached). This can be done in MrBayes using a combination of \u201chard\u201d (monophyly) and \u201csoft\u201d (backbone) constraints. TNT also offers the option to combine monophyletic group trees and skeleton trees. Both MrBayes and TNT run a congruence test on the user-defined trees before processing the data and stop if the trees fail this test. My suggestion for a future version of IQ-TREE would be to allow more than one constraint tree under the condition that they are congruent. Maybe the terminal call could be adapted to something like: \u201c-g1 momophyly.constraint.tree.nwk -g2 scafold.constraint.tree.nwk\u201d. One foreseeable issue would be to preserve the code of former IQ-TREE versions by setting -g and \u2013g1 to be synonymous commands. As far as I know, RAxML does not allow more than one set of user-defined constraints. If IQ-TREE could incorporate this feature, it would add to the growing list of items that make your software more versatile and better adapted to deal with diverse data sets. Thanks for hearing me out. Cheers! -Steven You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f04770cf-9daf-4d57-9355-9191344e6d05%40googlegroups.com ", "Dear Minh, My apologies for the very late reply! For some reason I did not receive a notice that this question had been answered; the project I was working on is done, but I have a similar application now. Anyway, the constraint system employed by IQTree is exactly what I needed! Any taxa not in the constraint list (in my case, fossils) can move about freely in the tree, which is termed a \"soft\" constraint in MrBayes. Another question which is more pertinent to hypothesis testing with molecular data: Can IQTree implement \"hard\" constraints, i.e., constraining a set of taxa and completely preventing other taxa from nesting in that set? Thank you so much! I am quite relieved and I will be proceeding soon. Cheers! Brendon "]}, "2nhMVkzvJFs": {"topic": "Re: [iqtree] Problem opening program", "initializeDate": "Jul 9, 2019, 10:47:57 PM", "timeStamp": "Jul 9, 2019, 10:47:57 PM", "content": ["Hi Sariana, Please have a look at this quick guide for Windows: http://www.iqtree.org/doc/Quickstart#for-windows-users Minh On 9 Jul 2019, at 4:08 pm, Sariana Faure < sarian...@gmail.com > wrote: Hi, I had a short break from running any IQtree analyses, doing other work, and now that I'm back the program doesn't want to open. When I click on iqtree.exe a window flashes for a second and then goes away again. Is there a supporting program that I need? Cheers, Sariana You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/58e9750e-649c-40a2-9939-2782545b23fb%40googlegroups.com For more options, visit https://groups.google.com/d/optout "]}, "e_RyzLD9EuU": {"topic": "directory of alignments", "initializeDate": "Feb 17, 2021, 11:49:39 AM", "timeStamp": "Feb 18, 2021, 12:38:24 AM", "content": ["Hi all, We are trying to run IQ-TREE on directories of alignments to obtain both ML gene trees and bootstrap trees. We are running into a couple challenges. (1) It looks like the bootstrap support values get mapped on the ML trees in the .trees file. Is there any way to get the bootstrap trees as well? We may want to use these in downstream ASTRAL analyses. (2) IQ-TREE crashed when we tried to run another directory of alignments. I am attaching the .log file as reference. Any thoughts? Best wishes, Chris ", "Hi Chris, On 18 Feb 2021, at 3:49 am, blai...@ gmail.com blai...@gmail.com > wrote: Hi all, We are trying to run IQ-TREE on directories of alignments to obtain both ML gene trees and bootstrap trees. We are running into a couple challenges. (1) It looks like the bootstrap support values get mapped on the ML trees in the .trees file. Is there any way to get the bootstrap trees as well? We may want to use these in downstream ASTRAL analyses. Use -wbt option ( rite ootstrap rees). If you want bootstrap trees with branch lengths, use -wbtl option. (2) IQ-TREE crashed when we tried to run another directory of alignments. I am attaching the .log file as reference. Any thoughts? Does it work, if you use a \u2018for loop\u2019 to run IQ-TREE on each alignment? Unfortuntately I have no idea why. Some user(s) also reported similar problem, and they could overcome by running IQ-TREE for each alignment separately. Cheers Minh Best wishes, Chris You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/57d78c8e-efe5-4b14-b563-98b0638037e8n%40googlegroups.com <loci.log> "]}, "F8StzYRNlKA": {"topic": "Dollo-like substituion model for binary characters", "initializeDate": "Sep 18, 2018, 7:26:33 AM", "timeStamp": "Oct 27, 2018, 10:19:28 PM", "content": ["Hi all, I have a presence absence matrix of retroposon insertion data (0, 1 encoded). For retroposon insertion, typically only the gain of a character is possible (0 -> 1) because there is no molecular mechanism to remove a insertion. I think it would be super interesting to analyse this data using the quartet likelihood mapping implemented in IQ-TREE. However, to my understanding, the implemented substitution models for binary data, don't capture the evolutionary mechanism properly. I was wondering it providing a own matrix for that is possible or if you have some other advice how such data can be analyzed with IQ-TREE. Thanks a lot Fritjof ", "Hi Fritjof, I\u2019m not sure if this is a valid phylogenetic Markov model or not. As the time goes by, you will only observe 1s because all 0s will become 1s. Whereas in a typical model, you can go from any one state to any other state either directly or indirectly (connectedness). However, your model is not connected\u2026 Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, thanks. That makes a lot of sense! Would it be possible to have a connected model with a really low rate for 1 -> 0 changes and define this as model within IQTREE? Best Fritjof ", "Hi Fritjof, Sorry for the slow response. I looked at such model and there is numerical issue with the model. So setting a low rate is still problematic. My conclusion right now is that the model does not work. Cheers Minh "]}, "ud-gSWUgLUM": {"topic": "nucleotide and binary mixture models", "initializeDate": "Jun 1, 2020, 10:11:12 AM", "timeStamp": "Jun 2, 2020, 12:10:29 AM", "content": ["Is it possible to constrain the state frequencies for nucleotide mixture model components. In other words, if I think my data are a mixture of (for example) high GC sites (say, 60% GC, equiprobable within the G and C and within A and T) and low GC sites (say 40% GC, same as above). I tried creating a mixture like this: MIX{GTR+F{0.2,0.3,0.3,0.2},GTR+F{0.3,0.2,0.2,0.3}) I tried embedding the GTR matrices in quotes (like this: \"GTR+F{0.2,0.3,0.3,0.2}\") and creating aliases in a models block of a nexus file. The next question, if something like this is possible, is whether it would be possible to give each mixture component a mean rate (or, better yet, to estimate the rate of each component by ML) I was doing this with version 1.6.12. If something like this is possible in the new release I could switch over to the newest release - I was just trying to finish up a project and do the analyses in the same version I have been using. Thanks in advance, Ed ", "I should have added a simple additional question - if something like this is possible, is it also possible with the GTR2 model for binary data? ", "Hi Ed, On 2 Jun 2020, at 12:13 am, Edward Braun < ebra...@gmail.com > wrote: I should have added a simple additional question - if something like this is possible, is it also possible with the GTR2 model for binary data? yes should work with DNA, binary, protein models. details below. On Monday, June 1, 2020 at 10:11:12 AM UTC-4, Edward Braun wrote: Is it possible to constrain the state frequencies for nucleotide mixture model components. In other words, if I think my data are a mixture of (for example) high GC sites (say, 60% GC, equiprobable within the G and C and within A and T) and low GC sites (say 40% GC, same as above). I tried creating a mixture like this: MIX{GTR+F{0.2,0.3,0.3,0.2},GTR+F{0.3,0.2,0.2,0.3}) I tried embedding the GTR matrices in quotes (like this: \"GTR+F{0.2,0.3,0.3,0.2}\") and creating aliases in a models block of a nexus file. This is possible with both versions 1.6 and 2.0. First prepare a models nexus file called, e.g., \u201cbraun.nex\": #nexus begin models; frequency F1=0.2 0.3 0.3 0.2; frequency F2=0.3 0.2 0.2 0.3; end; Then run iqtree -s ALN_FILE -mdef braun.nex -m \u201cGTR+FMIX{F1,F2}\u201d ... The keyword here is FMIX for frequency mixture model. Do not forget the quote around model string for -m option. This syntax is actually used in all protein mixture models. So it should work for binary data as well. The next question, if something like this is possible, is whether it would be possible to give each mixture component a mean rate Yes, something like: GTR+FMIX{F1:1.1,F2:0.8} to say that F1 and F2 has a mean rate of 1.1 and 0.8, respectively. By default, they both have rate of 1. You can even fix the mixture weights by adding: GTR+FMIX{F1:1.1:0.4,F2:0.8:0.6} To additionally specify that F1 and F2 have a weight of 0.4 and 0.6, respectively. (or, better yet, to estimate the rate of each component by ML) Yes, by combining mixture model with free-rate model: GTR+FMIX{F1,F2}*R I was doing this with version 1.6.12. If something like this is possible in the new release I could switch over to the newest release - I was just trying to finish up a project and do the analyses in the same version I have been using. Yes, 1.6.12 works perfectly fine. Actually nothing changes from version 1 to 2 re. mixture models. So IQ-TREE is quite flexible, I just didn\u2019t put all these into the docs as this is too advanced for normal users. Hope that helps, Minh Thanks in advance, Ed You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/cbc2d03f-a02e-4c28-a19f-cbc0ed552a9e%40googlegroups.com "]}, "SYxPLQ9YQiw": {"topic": "Profile mixture models crashes?", "initializeDate": "Jan 25, 2018, 5:45:38 AM", "timeStamp": "Jan 27, 2018, 7:22:57 AM", "content": ["Hi, I'm trying to run the following job: iqtree -nt 4 -s alignment.fas -m LG+C20+F+G -b 500 The alignment is fine when I do not specify C20. The issue is that I do not get any message error really... In the .log file, I get the following messages: Host: n65 (AVX2, FMA3, 94 GB RAM) Command: iqtree -nt 4 -s Concatenated_mamD-mms-prots-BMGE-g0.5-b3.fas -m LG+C20+F+G -b 500 Seed: 823846 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Jan 24 13:06:50 2018 Kernel: AVX+FMA - 4 threads (20 CPU cores detected) ... Alignment most likely contains protein sequences Alignment has 8 sequences with 625 columns, 566 distinct patterns 356 parsimony-informative, 190 singleton sites, 79 constant sites **** TOTAL 10.80% 0 sequences failed composition chi2 test (p-value<5%; df=19) ===> START BOOTSTRAP REPLICATE NUMBER 1 Creating bootstrap alignment (seed: 823846)... Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.001 seconds Model LG+C20+F+G is alias for LG+POISSON+G+FMIX{C20pi1:1:0.0559910600,C20pi2:1:0.0514824870,C20pi3:1:0.0812922124,C20pi4:1:0.0721976867,C20pi5:1:0.0556718858,C20pi6:1:0.0331003080,C20pi7:1:0.0589501763,C20pi8:1:0.0263756889,C20pi9:1:0.0307584220,C20pi10:1:0.0376701125,C20pi11:1:0.0303058290,C20pi12:1:0.0808775576,C20pi13:1:0.0263349134,C20pi14:1:0.0579101455,C20pi15:1:0.0371248064,C20pi16:1:0.0586867766,C20pi17:1:0.0561479138,C20pi18:1:0.0349810886,C20pi19:1:0.0544937394,C20pi20:1:0.0596471901}+F+G Then I do not get any more messages or file, and the job stops. Anything I'm doing wrong? Many thanks Caroline ", "Hi Caroline, Which version of IQ-TREE did you use? Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout "]}, "ostFKdN0shQ": {"topic": "Number of informative and uninformative parsimony sites", "initializeDate": "Nov 10, 2016, 1:36:21 PM", "timeStamp": "Aug 2, 2017, 1:36:33 PM", "content": ["After using tree-puzzle in for likelihood mapping analysis, I am able to see the number of informative and uninformative parsimony sites in the .puzzle file. Since i'm running whole genomes, TREE-PUZZLE is very slow and not very efficient. Is there a command i'm not finding in the documentation that would give me information on the informative and uninformative parsimony sites? Thanks! ", "Hi there, Right now there is no option to print these, so some coding is necessary. Moreover, do you have partitioned data and want to see the number of informative sites across partitions? Minh On Nov 10, 2016, at 7:36 PM, Taylor Paisie < tpai...@gmail.com > wrote: After using tree-puzzle in for likelihood mapping analysis, I am able to see the number of informative and uninformative parsimony sites in the .puzzle file. Since i'm running whole genomes, TREE-PUZZLE is very slow and not very efficient. Is there a command i'm not finding in the documentation that would give me information on the informative and uninformative parsimony sites? Thanks! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Taylor, there is the plan to integrate that feature into IQ-Tree as well. For the time being I would suggest, to use TREE-PUZZLE to determine the informative sites statistics while setting the \u2018Tree search procedure?\u2019 with the k-button to 'Pairwise distances only (no tree)\u2019 to stop without tree search. Best wishes, Heiko > On 10 Nov 2016, at 19:36, Taylor Paisie < tpai...@gmail.com > wrote: > After using tree-puzzle in for likelihood mapping analysis, I am able to see the number of informative and uninformative parsimony sites in the .puzzle file. Since i'm running whole genomes, TREE-PUZZLE is very slow and not very efficient. Is there a command i'm not finding in the documentation that would give me information on the informative and uninformative parsimony sites? > Thanks! ", "Thank you for answering! No i do not have partitioned data, it's some whole virus genomes and they take so long to run on TREE-PUZZLE it's unbearable. ", "Thank you! This is great to hear, I think my lab will be very happy to hear this!!! ", "Dear Taylor, I just realized that this information is already printed in the log file like this: Alignment most likely contains DNA/RNA sequences Alignment has 17 sequences with 1998 columns and 1152 patterns (1009 informative sites) meaning that the alignment has 1009 parsimony informative sites Minh ", "Hi, following up on this. I am now using IQ-Tree and, while I see that the information about informative sites is printed in the log file, I would like to ask if there is a way to exactly know which these informative sites are in the alignment. Thank you Fede ", "", "dear fede, unfortunately there is no such option, though it should be easy to implement. however tree-puzzle may have it. you can also check out the R package ape. Minh On Sat, 18 Feb 2017 at 07:09, Federico Gaiti < federic...@gmail.com > wrote: ", "Hi Minh, Thanks for your reply. I was also wondering, what is the logic behind determining these \u201cinformative\u201d sites? How are these determined? And what does actually \u201cinformative\u201d means? Thank you Fede You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/ostFKdN0shQ/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com ", "Dear Fede, \u201cinformative\u201d here actually means parsimony-informative, that means this sites which would be informative for parsimony analysis. A site is (parsimony) informative if (what I call) the 2,2,2-rule applies: An informative site: - contains at least 2 different (informative) characters (wildcards like \u2018X\u2019 in proteins, \u2019N\u2019 in DNA, \u2018-' etc. are typically regarded as not informative) - and of these (informative) characters at least 2 - occur at least twice (2x) That means a columns like: - A,A,C,C,C,C is informative (2xA + 4xC) - A,A,C,T,C,C is informative (2xA + 3xC) - A,A,G,T,C,G is informative (2xA + 2xG) - A,A,C,T,C,C is informative (2xA + 3xC) - A,A,T,T,C,C is informative (2xA + 2xC + 2XT) - A,A,-,N,C,C is informative (2xA + 2xC) - A,G,C,T,C,C is not informative - A,-,C,T,-,C is not informative - C,C,C,C,C,C is not informative This is often used as an approximate measure whether you have enough potentially informative sites to resolve a tree. One wants to have far more informative sites than the n-3 internal branches to resolve in a tree (where n is the number of sequences/leafs/taxa). If you have few informative sites, it is clear why a tree remains unresolved or why one cannot gain support for branches. However, this does not mean that the sites are informative for a certain tree/branch or that the informative sites are congruent among each other. Does that help? Best wishes, Heiko ", "Hi Heiko, Thanks for your explanation. Really helpful. Would the same rule apply to binary data with three types of characters (0, 1 and \u2018?' for missing)? Best Fede ", "Yes, this applies to all kinds of data character data. In the binary case each of the characters (0,1) have to occur at least twice for the site to be informative (and \u2018?\u2019 is an uninformative wildcard). Best wishes, Heiko ", "Hi Heiko, Thank you. Really helpful. Are you aware of a way to know exactly which these informative sites are in the alignment? With tree-puzzle I could get the unresolved quartets, but I think this is a different question than what I\u2019m looking for. Thanks Fede ", "For example, using the option -wsr I can write per-site rates to .rate file. I got an output that looks like this: Site Rate Category Categorized_rate 1 1.00000 1 0.31635 2 1.00000 1 0.31635 3 1.00000 1 0.31635 4 0.87711 1 0.31635 5 0.80212 1 0.31635 6 0.80212 1 0.31635 7 0.80212 1 0.31635 8 0.80212 1 0.31635 9 0.80212 1 0.31635 ... What do the category correspond to? Is the number of the site (i.e., Site 1) corresponding to the column number in the phylip input file? Thank you Fede ", "Dear Fede, Assuming that you used a Gamma rate heterogeneity model with 4 categories (the same holds true if you used FreeRate model). The columns of .rate file have the following meaning: Site: Column number of alignment file, starting from 1. Rate: Evolutionary rate of the site inferred by empirical Bayesian method (or posterior mean). Category: The index of the Gamma category that this site likely falls into (with highest posterior probability). Category 1 means that the site is slowly evolving whereas category 4 means fast evolving. Thus, you can use this column to quickly classify the sites in the alignment. Categorized_rate: The rate of the corresponding category. Note that if you also combine Gamma rate with invariant site model (I+G4), then there is another Category 0, meaning that the corresponding site is likely invariable. Further reading: a comparison paper by Mayrose et al (2004) ( https://doi.org/10.1093/molbev/msh194 ) showed a good performance of empirical Bayesian method. That\u2019s why it was implemented in IQ-TREE. Cheers, Minh ", "Great \u2014 thank you Minh. Other question, how are the likelihood distance (.mldist) estimated? Thanks Fede ", "Hi Fede again, A maximum parsimony tree is first constructed from the alignment, then parameters of the given model are estimated based on the parsimony tree. The estimated model parameters are now used to compute the pairwise distance between sequences. Thus, model parameters are not re-estimated for each pairwise comparison. This is because some parameters (like the Gamma shape) cannot be estimated from just 2 sequences. Hope that helps, Minh ", "Great \u2014 thank you. Really helpful. Fede ", "Hi Heiko, Thank you for your reply. Are you aware of a way to know exactly which these informative sites are in the alignment? Basically, a way to know which sites are being used by the algorithm to build the tree? Thank you Best, Fede > On Feb 21, 2017, at 12:34 PM, Heiko Schmidt < heiko....@univie.ac.at > wrote: ", "Dear Fede, I am thinking about implementing into the code such that one can get e.g. a letter for each site whether that on is informative or not. So far I did not have the time to do so. One thing to keep in mind - Parsimony informative and uninformative is an approximation to get an idea about the information in the data (besides likelihood mapping). The definition of this applies to (unweighted) parsimony, where a site is informative if it (a) contains at least 2 different characters [not including gaps or wildcards like N or X] and (b) from these characters at least 2 occur (c) at least twice. That means one can form at least two clusters of at least 2 sequences of equal characters. I call this the 2-2-2 rule. However, in ML the likelihood computation the evolutionary model can also exploit similarity of residues (like Purines or Pyrimidines). Depending on the parameterisation of the model (usually estimated from the data), typically transitions are more likely than transversions, thus two purines (or two pyrimidines) are more closely related than a purine and a pyrimidine. Since unweighted parsimony does not distinguish between mutation types, such informations is not reflected by parsimony (un)informative sites, so there is more information in the alignment. Best wishes, Heiko ", "Hi Heiko Thank you for your reply and detailed explanation. Really useful as usual. Implementing the info on whether a site is informative or not in the code would be amazing, if you have a chance to do it. Thanks again Fede ", "Dear Fede and Heiko, I just created an enhancement issue in GitHub: https://github.com/Cibiv/IQ-TREE/issues/34 It should be easily implemented. But what we need, is the output format. How do you think the output file best looks like? Thus, can you please add comments to this GitHub issue? (you will need a GitHub account for this). Thanks, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/ostFKdN0shQ/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/ostFKdN0shQ/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com ", "Thanks Minh, I will comment on GitHub. Best, Fede To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com "]}, "EzXhmBPlTCw": {"topic": "Help with sequence reconstruction", "initializeDate": "Oct 8, 2020, 4:05:49 PM", "timeStamp": "Oct 11, 2020, 5:22:34 PM", "content": ["Hello, I'm trying to reconstruct ancestral sequences. I'm using a Newick tree I built from branch lengths obtained from a publication, and I am most interested in reconstructing the basalmost node of the tree. The problem I have is that the algorithms only reconstruct internal nodes. I can't use an outgroup since the sequence I'm interested in (an enhancer sequence) is found only in the group I'm studying. So, I tried making up a \"mock\" outgroup with a sequence composed of just \"N\". I got a result with this strategy, but I am unsure if this result has any meaning or if it is an artefact of this methodology I'm using. Additionally, I'd like some help with the substitution models. I'm using a General Time Reversible model with a Gamma distribution and a proportion of invariable sites (GRT+G+I). From what I understand, the alpha of the gamma distribution and the proportion of the invariable sites can be fixed (+G{0.9} to change alpha parameter to 0.9, for example), but I don't know what the default parameters are. Also, how can I know what are the best parameters for a reconstruction? The script I'm using is the following: iqtree -s alignment.phy -asr -blfix -keep_empty_seq _m -m GTR+G+I -te newick_tree.txt \"-keep_empty_seq\" to use empty sequences (the \"mock\" outgroup\") \"-blfix\" to use the branch lengths of the newick tree I'm using as input. Any help with this matter would be tremendously appreciated. Vicente Mu\u00f1oz Walther Ph.D.(c) Laboratorio de Ontogenia y Filogenia Las Palmeras 3425 Universidad de Chile ", "Hi Vicente, On 9 Oct 2020, at 7:06 am, Vicente Mu\u00f1oz Walther < tente...@gmail.com > wrote: Hello, I'm trying to reconstruct ancestral sequences. I'm using a Newick tree I built from branch lengths obtained from a publication, and I am most interested in reconstructing the basalmost node of the tree. The problem I have is that the algorithms only reconstruct internal nodes. I can't use an outgroup since the sequence I'm interested in (an enhancer sequence) is found only in the group I'm studying. So, I tried making up a \"mock\" outgroup with a sequence composed of just \"N\". I got a result with this strategy, but I am unsure if this result has any meaning or if it is an artefact of this methodology I'm using. This has been answered. Additionally, I'd like some help with the substitution models. I'm using a General Time Reversible model with a Gamma distribution and a proportion of invariable sites (GRT+G+I). From what I understand, the alpha of the gamma distribution and the proportion of the invariable sites can be fixed (+G{0.9} to change alpha parameter to 0.9, for example), but I don't know what the default parameters are. Also, how can I know what are the best parameters for a reconstruction? There is no default, these parameters will be estimated by maximum likelihood from the alignment. The same with all other parameters of the model and branch lengths of the tree: maximum likelihood estimation. Cheers Minh The script I'm using is the following: iqtree -s alignment.phy -asr -blfix -keep_empty_seq _m -m GTR+G+I -te newick_tree.txt \"-keep_empty_seq\" to use empty sequences (the \"mock\" outgroup\") \"-blfix\" to use the branch lengths of the newick tree I'm using as input. Any help with this matter would be tremendously appreciated. Vicente Mu\u00f1oz Walther Ph.D.(c) Laboratorio de Ontogenia y Filogenia Las Palmeras 3425 Universidad de Chile You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CA%2BVmrY4w9-Sao3bqORudH2dBV9%3DMH7NMv0Z0Th0OE%3Donw4steQ%40mail.gmail.com ", "Thank you! "]}, "PZeQLoZG-Uk": {"topic": "Setting known transition rates for binary data", "initializeDate": "Sep 2, 2020, 8:30:55 PM", "timeStamp": "Sep 10, 2020, 10:39:41 PM", "content": ["This question may have been answered already (I saw some possible similars in the archives), so apologies for if it has... I have binary data, and need to fix the rates of change from 0->1 at a different rate than 1->0. I'm trying to follow the model of gene adjacencies from Hu et al. ( https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-014-0354-6 ) where one value is 2n less likely than the other given n genes in the genome (a value I can estimate). Is this possible in IQTREE? Thanks! -Russ ", "Hi Russ, IQ-TREE 2 allows to specify the frequencies of 0 and 1 states, which would make the binary model non-symmetric, for example with option: -m \u201cGTR2+F{0.1,0.9}\" In effect, that will make 0-1 rate 9 times higher than 1-0. Note however that this model is still reversible. And note that this syntax does not work in v1.6.12, where +F{\u2026} is ignored. Is that what you are looking for? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c0b3d394-9662-426a-ac4f-109aeb419688n%40googlegroups.com "]}, "flSpEAohUZs": {"topic": "xargs can be used to run iqtree bootsraps, each bootstrap as individual process in a cluster environment", "initializeDate": "Sep 14, 2018, 8:48:39 AM", "timeStamp": "Sep 16, 2018, 7:50:11 PM", "content": ["I have installed a non MPI version of iqtree in KNL environment, I couldn't able to install a MPI version since my compiler was not recognized by cmake , I used the below command to replicate the bootstrap process 64 times using xargs system command which helped me out change the output filename and input filename stored as a list in a file. #!/bin/sh #PBS -l select=1 #PBS -l accelerator_type=Intel #PBS -l walltime=24:00:00 #PBS -l place=scatter #PBS -S /bin/sh@sdb -V . /opt/modules/default/init/sh cd /XXX/iqtree/bin aprun -j 1 -n 64 -N 64 xargs --arg-file=list.txt -P 64 -I AA iqtree -s protein_AA.msa -m JTT+G4 -bo 2 -pre boots_AA Note ( list.txt: contains the number list from 1..64 separated by new line) input file was copied 64 times using the same xargs and seq command (seq 64 | xargs -I AA file.msa file_AA.msa ) Thanks Vignesh ", "Cool, thanks for the information! Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "XoU2AwAOjqw": {"topic": "Tree topology test", "initializeDate": "Nov 11, 2019, 5:01:46 AM", "timeStamp": "Nov 11, 2019, 3:46:15 PM", "content": ["Hi all, Is there a way to avoid the reconstruction of an initial tree for model parameters estimation during a tree topology test? ", "Hi, A tree is always needed to estimate model parameters. By default it is a parsimony tree. You can use -te option to provide an user-defined tree. For example, the same tree file passed to -z can be specified for -te option. In that case, the first tree in the file will be loaded for model parameter estimation. Cheers, Minh > On 11 Nov 2019, at 9:01 pm, Mattia Giacomelli < gree...@gmail.com > wrote: > Hi all, > Is there a way to avoid the reconstruction of an initial tree for model parameters estimation during a tree topology test? > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c06c47c9-a110-4ee2-9be3-c8e8fda01ff8%40googlegroups.com ", "Thank you very much for the info. Best, Mattia "]}, "HbYg5tw2EHs": {"topic": "Codon model error IQTree2, numerical underflow for lh-from-buffer failed", "initializeDate": "Apr 19, 2021, 10:50:39 AM\u00a0(9 days ago)\u00a0", "timeStamp": "Apr 20, 2021, 9:59:57 AM\u00a0(8 days ago)\u00a0", "content": ["Hello, I keep getting this error when I am trying to run a codon model, it seems to go through alright when I do a DNA model. I have it set with the -safe option and the gaps in the input are extremely minimal. I'm not sure what to do, thank you. -Kali Swichtenberg Command: iqtree2 -s FcC_smatrix.fas -p Ades_partitionfile.nexus --prefix v2_bs_codon -st CODON -B 1000 -T AUTO Seed: 827741 ERROR: phylokernelnew.h:3273: double PhyloTree::computeLikelihoodFromBufferGenericSIMD() [VectorClass = Vec4d, FMA = true, SITE_MODEL = false]: Assertion `std::isfinite(tree_lh) && \"Numerical underflow for lh-from-buffer\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: v2_bs_codon.log ERROR: *** Alignment files (if possible) ", "Hi Kali, What is the length of the alignment you are trying to run codon models? If you alignment is short or contains little phylogenetic information, then codon models might become numerically unstable and might not work. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f1b6989b-81c8-4f4d-84e1-41a9a3799e9bn%40googlegroups.com "]}, "u97nYmFsX6w": {"topic": "BUG? mixed binary/nucleotide analysis", "initializeDate": "Oct 10, 2018, 12:20:00 AM", "timeStamp": "Mar 31, 2019, 5:42:46 AM", "content": ["Dear Minh, I am working on a combined binary/nucleotide tree search. I am running version 1.6.7 on 64 bit Linux. I followed the instructions on the IQtree website for setting up the nexus partition scheme file and split the alignment into two phylip files as instructed. When I start the search ( iqtree-1.6.7-Linux/bin/iqtree -s aa_nuc.phy -pre aa_nuc -spp aa_part.nex -m MFP -nt 12 -safe -bb 1000 -bnni -g Trichop.edit10.TLcons.tree ), it reads the alignments fine, but then fails with the following error: Creating fast initial parsimony tree by random order stepwise addition... 308.958 seconds, parsimony score: 28591 (based on 1900 sites) NOTE: ModelFinder requires 105 MB RAM! Testing GTR2+G,GTR+F+G on supermatrix... ERROR: phylotree.cpp:760: size_t PhyloTree::getBufferPartialLhSize(): Assertion `num_threads > 0' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: aa_nuc.log ERROR: *** Alignment files (if possible) Is there anything clear that I might have done wrong? I'm happy to send log files and alignments along to your personal email. Many thanks, Paul ", "Hi Paul, That looks weird. Can you send me the input data for debugging? Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Migh, I had the same problem when I ran it with Linux. When I ran the analysis in widows version 1.5.5 it would start the analysis but it would crash after an n number of Bootstrap replicates. and will bive the following error: Tree Does not start with oppening bracket ", "I have also the same problem. It seems that you need to specify the appropriate model for each partition, and specifically a binary model for the binary dataset (e.g., MK), otherwise it cracks. e.g. #nexus begin sets; charset part1 = DNA1.fas: *; charset part2 = DNA2.fas: *; charset part3 = Binary.fas: *; charpartition mine = GTR+F+I+G4:part1, GTR+F+I+G4:part2, MK+ASC:part3; end; This will work. But the real problem is that the command \"-TESTMERGE\" will not work. So, I do not see how it is possible to have, at the same time, the binary dataset with the binary model (and perhaps the ASC correction if you need it) and test the partitioning scheme with PartitionFinder for the remaining datasets... Also, I do not know how to combine partitions included as independent alignments (or parts of alignments) in the NEXUS file, since between partitions you can only use \",\" to separate partitions or \";\" to end the block. I mean, you cannot use \"part1+part2\", or \"part1_part2\", etc. The only solution would be to run a previous analysis without the binary dataset to test the partitioning scheme for the other datasets, and then manually arrange the partitions to comply with that partitioning scheme. Very inconvenient, particularly if you have partitions by codon position, since you would have to split each codon position, then mergin them with others, etc. Or merge everything into a single long alignment, and then call the partitions as usually done for other software, but then the great versality of IQ-Tree for using independent alignments would be lost. Did you reach any other conclusion on this issue? Best wishes, Juan Carlos ", "Hi Juan, ModelFinder should work with mixed data. Did you use the latest version 1.6.8? There was a crash with mixed data type with ModelFinder, which was fixed in 1.6.8. If the problem still persists, please send me the log file. Thanks, Minh ", "Dear Minh, Well, now I am normally (see at the end!) getting the following message (command line: \"-spp partitions.nex -m TESTMERGE\"): ERROR: Numerical underflow (lh-branch). Run again with the safe likelihood kernel via `-safe` option An with the -safe option (\"-spp partitions.nex -m TESTMERGE -safe\") I am getting: ERROR: \\Users\\minh\\Dropbox\\iqtree-git\\model\\partitionmodelplen.cpp:142: virtual double PartitionModelPlen::optimizeParameters(int, bool, double, double): Assertion `cur_lh > tree_lh - 1.0 && \"partition rate opt reduces LnL\"' failed. This application has requested the Runtime to terminate it in an unusual way. Please contact the application's support team for more information. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED The DNA dataset alone always work well, the binary dataset alone always work well, and the combined dataset when specifying a model for each partition and not testing the partitioned scheme always work well. I am getting the error only when I want to test the partitioning scheme in the combined dataset via \"-m TESTMERGE\", like in the previous version but with a different error. HOWEVER, after several trials with \"-spp partitions.nex -m TESTMERGE\", it randomly works. I would say around one of each 4-6 trials works. Any idea why? When it works, the tree is perfectly fine, everything as expected. Best wishes, Juan Carlos ", "Hi Juan, Can you please send me via personal email the data set for debugging purpose? Also the log file would be good to quickly get what\u2019s going on. Thank you, Minh ", "Dear Minh, I had the same bug. Would you be so Kind to help me with this. Thank you so much Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Cristina, Did you try the latest version (1.6.10)? I believe this problem was fixed\u2026 Minh "]}, "M-pr_UPDRPQ": {"topic": "Segmentation fault (core dumped)", "initializeDate": "Dec 3, 2016, 11:22:51 AM", "timeStamp": "Dec 3, 2016, 12:40:09 PM", "content": ["Hello! I got the following error when tried to perform partitioned analysis with example files provided: IQ-TREE version 1.5.2 for Linux 64-bit built Dec 3 2016 Copyright (c) 2011-2016 Nguyen Lam Tung, Olga Chernomor, Arndt von Haeseler and Bui Quang Minh. Host: PORTEGE-Z830 (AVX, 9 GB RAM) Command: ./iqtree -s example.phy -spp example.nex -m TEST Seed: 429195 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Sat Dec 3 23:11:19 2016 Kernel: AVX NOTE: Consider using the multicore version because your CPU has 4 cores! Reading partition model file example.nex ... Reading alignment file example.phy ... Phylip format detected ... Reading partition part3 (model=GTR+G, aln=, seq=DNA, pos=1000-1998) ... 17 sequences and 999 sites extracted Degree of missing data: 0.000 Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.006 seconds *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT *** For bug report please send to developers: *** Log file: example.nex.log *** Alignment files (if possible) system message: 'Segmentation fault (core dumped)' The same error for mpi version. \"Reconstruct ML tree and assess branch supports with ultrafast bootstrap\" is working well. ", "Hi there, thanks for noticing this early. I was able to quickly fix this problem. The download is updated with the fix. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Yes, it works now! On Sunday, 4 December 2016 00:07:56 UTC+7, Bui Quang Minh wrote: > Hi there, > thanks for noticing this early. I was able to quickly fix this problem. The download is updated with the fix. > Cheers, Minh "]}, "b4gEmajlbuc": {"topic": "identical sequences", "initializeDate": "Mar 19, 2020, 11:19:36 AM", "timeStamp": "Mar 23, 2020, 9:13:14 PM", "content": ["Hello, I am working with the some identical sequences but differents patients, for me is very important working with all sequences but when I do the tree the identical sequences are shown separately. +--seq8 | +--seq1 | +----------------------------| (97) | | +--seq2 +-------------| (85) | | +--seq3 | +------------------------------------| (99) | | +**seq4 | | +--| | | | +**seq5 | +--| (44) | +--seq6 +-----------------------------------------------------------seq7 seq4. seq5 y seq6 are 100% identical. Which is the reason? Thanks ", "Hello, I think you need to review your aligment, or maybe you should do clusters of the secuences that you consider identical. Why you not try another analisys, only for testing that issue, like tnt o distance ", "Hi there, I assume, your question is why seq4, 5, 6 do not form a tri-furcation (polytomy), i.e. directly attach to the same ancestor? If so, the reason is IQ-TREE (and other ML software) always return strictly bifurcating tree, no matter if the sequences are identical or not. If they are identical, the bifurcation at the subtree will be randomised and you will get very low bootstrap support anyway, ~33% as there are 3 ways to resolve a tri-furcation. There is however a useful option, -czb (in v1.6.X) or --polytomy (in v2.0), that will collapse all near-zero branches, resulting in a polytomy. Does that answer your question? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/dc12d30a-2a5a-4051-a120-eb982f8301be%40googlegroups.com "]}, "9kb_oqzGRuY": {"topic": "Save time for standard bootstrap problem", "initializeDate": "Apr 20, 2021, 1:13:51 PM\u00a0(7 days ago)\u00a0", "timeStamp": "Apr 23, 2021, 4:10:36 AM\u00a0(5 days ago)\u00a0", "content": ["Hi all, I have checked several topics and could not immediately find a similar one. If it would exist, sorry for posting it again! To generate a more robust tree (after first running a -bb 1000 analysis), I decided to run a slow bootstrap tree (-b). However, this would take too long. Therefore, as posted in the FAQ, I decided to split this up into multiple runs by running the below command. Basically I started ~100 of these on a HPC. In the end, 96 finished and could thus be used to build the final tree (the other 4 ran out of time). iqtree -nt 4 -s input_alignment -bo 1 ... -pre boot1 Each of these runs gave me a .boottrees file. As said in the FAQ, I combined these into one file: cat boot*.boottrees > alltrees The next step is to create a consensus tree: iqtree -con -t alltrees This gives as output: Reading tree(s) file alltrees ... 96 tree(s) loaded (0 rooted and 96 unrooted) 0 split(s) discarded because frequency <= 0.000 447254 splits found Consensus tree written to alltrees.contree So far, all theabove steps run without any problem. At the end of the above step, I have the alltrees.contree file. According to the FAQ, the next step is to estimate branch lengths of the consensus tree using the original alignment, using the below command. This is where the problem starts. iqtree -s input_alignment -te alltrees.contree -pre alltrees.contree The first time I ran this exact command (of course I changed the alignment file name), it gave, just like the original tree commands, notes that some sequences are identical, but kept for subsequent analysis. Additionally it gave ~10 errors: ERROR: Alignment sequence AF425656.1.1384_Archaea_Crenarchaeota_Thermoprotei_Sulfolobales_Sulfolobaceae_Saccharolobus_Sulfolobus_sp._FF5/00 does not appear in the tree I found that this is because the / was changed to _ during the tree building. Therefore, for these entries, I changed the / to _ in the Alignment fasta file. Subsequently, I rerun the iqtree -s input_alignment -te alltrees.contree -pre alltrees.contree command. However, this time, I get a lot more of the above errors, for example: ERROR: Tree taxon AB798190 does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxa and alignment sequence do not match (see above) For the errors where a fasta header is given, it doesn't make sense, because these names are present in the alignment. And the errors without reference to a fasta header don't make sense at all to me. Would anyone know how I can fix this, so I can obtain a ML tree that is the result of the 96 single slow bootstraps? Thanks a lot!!! Guillaume ", "Hi Guillaume, Can you send me the log file for further inspection? Normally the error message should be \u201ccorrect\u201d... Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/051870be-d2a0-496d-946f-aa16d7cf8b2dn%40googlegroups.com ", "Dear Minh, Thank you for the reply. Please find attached the log files. There's 3 of them: nohup_contree.out: log file of the iqtree -con -t alltrees command nohup_originalalignment.out: log file of the iqtree -s input_alignment -te alltrees.contree -pre alltrees.contree command, before I changed the / to _ in the alignment file nohup_modifiedalignment.out: log file from the iqtree -s input_alignment -te alltrees.contree -pre alltrees.contree command after I changed the / to _ in the alignment file, for those entries that gave and error like \" ERROR: Alignment sequence AF425656.1.1384_Archaea_Crenarchaeota_Thermoprotei_Sulfolobales_Sulfolobaceae_Saccharolobus_Sulfolobus_sp._FF5/00 does not appear in the tree\" in the nohup_originalalignment.out file Thank you very much already for your help!! Guillaume Op donderdag 22 april 2021 om 02:02:15 UTC+2 schreef Minh Bui: "]}, "NjiLa_NQ6AM": {"topic": "rogue taxa search/tests", "initializeDate": "May 21, 2020, 12:46:44 PM", "timeStamp": "May 29, 2020, 11:35:14 AM", "content": ["Dear all, is there any rogue taxa search/tests implemented in iqtree? ", "Hi Phillipp, I'm 99% sure that the answer is a simple 'no'. Slightly longer answer: RogeNaRok seems popular for this https://github.com/aberer/RogueNaRok/wiki/Hands-On-1:-a-Basic-Rogue-Taxon-Search . In IQ-TREE one can of course get some idea about rogue taxa by examining bootstrap replicates and concordance factors. Rob On Fri, 22 May 2020 at 02:46, Philipp Chetverikov < philipp.c...@gmail.com > wrote: Dear all, is there any rogue taxa search/tests implemented in iqtree? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/87f33ea3-db82-4df9-8e05-b65b4c01f431%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Rob is right, there is no such option. But the 1% is to use --tbe option together with the standard bootstrap option (-b). This transfer bootstrap expectation method ( https://www.nature.com/articles/s41586-018-0043-0 ) computes an index for each taxon, how often it has to be transferred, i.e. some sort of stability index. IQ-TREE will print a file with that information. You can compare it with RogueNaRok. Cheers, Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmq7H%3DUkzO3Lmgwm3ACquH1ipwxx3RK%3DiDixJvtaC5-vNQ%40mail.gmail.com ", "Dear Rob and Minh, thanks for the answers. I will try RogueNaRok. This program wants me to upload ML tree and a bootstrap tree set. Which file of those obtained in iqtree analysis contains \"a bootstrap tree set\"? If I did not really get it in the analysis (because I did not ask iqtree about it), what is the command to calculte it? \u0447\u0435\u0442\u0432\u0435\u0440\u0433, 21 \u043c\u0430\u044f 2020 \u0433., 19:46:44 UTC+3 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c Philipp Chetverikov \u043d\u0430\u043f\u0438\u0441\u0430\u043b: ", "Hi there, If you did standard bootstrap (-b) then this is printed to .boottrees file automatically. If you did ultrafast bootstrap (-bb in v1 or -B in v2), then you need to add `-wbt` option to print .ufboot file, which contain the set of ufboot trees. If you didn\u2019t use -wbt option, you can still get the ufboot trees adding this option (assuming you are using iqtre v2): --undo -wbt --undo is a new option (I believe it\u2019s called --force-unfinish in v1) to ignore that IQ-TREE finished and won\u2019t complain, which is handy when you want to change a few options. It works in this case before all the bootstrap trees are actually stored in the checkpoint file. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/28ea50f4-9581-43c9-985f-12bdd0bf64d6%40googlegroups.com ", "dear Minh, thanks a lot. I did what you suggested (-wbt) and it worked perfect. thanks! \u0447\u0435\u0442\u0432\u0435\u0440\u0433, 21 \u043c\u0430\u044f 2020 \u0433., 19:46:44 UTC+3 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c Philipp Chetverikov \u043d\u0430\u043f\u0438\u0441\u0430\u043b: Dear all, is there any rogue taxa search/tests implemented in iqtree? "]}, "HVA9eeEQpD8": {"topic": "branch labels and iqtree annotations", "initializeDate": "Oct 5, 2020, 2:23:52 PM", "timeStamp": "Oct 6, 2020, 10:13:49 PM", "content": ["Dear Minh, I have a pretty basic question about how IQtree outputs branch labels (which I guess is also a basic question about newick format) -- when using two support metrics simultaneously, for example \"-alrt 1000 -B 1000\" -- I've noticed for years that IQtree prints the support values as a concatenated pair -ie \"100/100\" -- is there a particular reason for printing the support values this way instead of printing them as separate labels? I guess it appears that the standard newick format does not support this, but the extended formats do. Is that correct? I ask because I often forget which value in the 100/100 pair represents which support metric (I suspect this can get even more confusing when doing more than those 2 metrics) and have wondered if there was a way of more explicitly keeping track of this information in the tree output. Might you have any tips for doing just that? Best wishes, Jake Berv ", "Hi Jake, You can find this information in .iqtree file, which has a line like: Numbers in parentheses are SH-aLRT support (%) / ultrafast bootstrap support (%) I don\u2019t know how the newick format allows to specify the labels. But the nexus format that FigTree uses certainly does. Can you please post a feature request in GitHub (in the \u2018issues' tab), and we will come to that when we have the time. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/03ba4d6e-00e5-4ae3-b621-b3a4a3616b39n%40googlegroups.com ", "Hi Jake, I recommend to try TreeGraph for visualization of the newick-formatted tree with UFB/alrt supports. See also an old thread https://groups.google.com/g/iqtree/c/DRoWy8h_BHk/m/ZYRbFO75AAAJ Sishuo ", "Thanks, this is helpful! Sent from my iPad On Oct 6, 2020, at 6:45 PM, Sishuo Wang < tomas...@gmail.com > wrote: \ufeffHi Jake, To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/25a3c6c7-e2ac-4ac1-baac-29459778d3c9n%40googlegroups.com "]}, "SW7vwQXDR5Q": {"topic": "IQTree crashes with Signal Aborted", "initializeDate": "Jul 11, 2017, 4:54:17 PM", "timeStamp": "Dec 3, 2017, 3:18:37 AM", "content": ["Hi, I wanted to do a topology evaluation for a set of trees I have from a Phylobayes run. I have as input file the consensus tree that I hand over as -te parameter. Then the list of trees generated during Phylobayes run (for trouble shooting purposes I just choose to use the last 100sampled trees) is handed over as -z. The command used is: iqtree omp latest s alignment_final fas st AA te tree newick z all trees 50000 I attached the files as well as the error log file. The exact error I get when IQtree crashes: 155 ERROR 156 ERROR *** TREE CRASHES WITH SIGNAL ABORTED 157 ERROR *** For bug report please send to developers 158 ERROR *** Log file alignment_final fas log 159 ERROR *** Alignment files possible ", "Hi Marc, I also get a similar error when running IQ Tree. I was running the beginner's tutorial when I ran into the problem. I've tried on two various windows machines (both running intel core i5 processors), but both seem to fail. I didn't get any error log files, but attached is a screenshot and the alignment file from the tutorial. Cheers, James Bickerstaff ", "That is interesting. I should add that I tried it both with the latest version from the github as well as the stable release. I get the error reproducible for both compilations. Also I tested both linux (blade server) architecture as well as my local macbook. I do get the same error on both architectures. -Marc ", "And I just tested the latest release on a MacBook too (also intel i5), and still the same issue - James ", "Dear James and Marc, I am not the main developer of IQ-TREE who is not in office this week. However, I have some comments, that may help you. I believe that your problems are unrelated. James, it looks like IQ-TREE is unable to read the example data file `example.phy`. I tried to reproduce your error but the analysis succeeded. Can you check that `example.phy` is available in your folder of analysis and complete (maybe do an md5sum check)? However, it may be a problem of having different operating systems (I run Linux here). Marc, I am afraid that the error might be a consequence of a weak multisequence alignment. I can redproduce your error. It basically says, that during parameter estimation, it does not know what to do, because any change in the parameters leads to a big difference in the likelihood (Minh, please correct me if this is wrong). When I check your alignment, I notice that there are shifts in the sequences. Lets compare the second and third sequences sp_A0A1U8DSZ3_JAK3_Alligator_sinensis and sp_H0VSL1_JAK3_Cavia_porcellus. The first three measured amino acids are MAP, but they are shifted by two. Is there a way to improve your alignment before further analysis? I hope that I could help. Best wishes, Dominik Dominik Schrempf PhD Student Vienna Graduate School of Population Genetics Vetmeduni Vienna Austria > -- > You received this message because you are subscribed to the Google > Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, > send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Hi Dominik, thanks for the reply, I will see what I can do about the alignment. I will let you know how it goes. -Marc ", "Dear All, Dominik had good points - thanks for that. I confirm that the problem James had is because there is no alignment (example.phy) in the current folder (C:\\Users\\James). But I admit that error message is not informative, it should have been like failure reading alignment. We will fix that. Marc reported a different problem, which seems like a bug - I will have a look. Cheers, Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Marc, I can\u2019t reproduce this behavior with the stable release 1.5.5. I noticed that you used beta version 1.6.beta5. Did you compile the code from GitHub? There is an issue with with beta version which I fixed recently. Thus, this crash may have been fixed as well. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <BOOTSTRAP.e7400578> <BOOTSTRAP.o7400578> <alignment_final.fas.log> <alignment_final.fas> <all.trees> <tree.newick> "]}, "ULJmzhRr4zA": {"topic": "Possible addition of \"BOOSTER\" - Bootstrap support by Transfer (Lemoine et al, Nature, 2018)?", "initializeDate": "Sep 18, 2018, 7:01:02 AM", "timeStamp": "Apr 9, 2019, 9:14:18 PM", "content": ["Hi, I came across the BOOSTER method that seeks to modify Joe Felsenstein's bootstrap method for the era of Big Data. This was after comments on this list about the performance of the bootstrap on long phylogenomic datasets - these stimulated my curiousity. I then came across BOOSTER which is looking instead at \"moderate signal\". QUOTE \"With large trees and moderate phylogenetic signal, BOOSTER tends to be more informative than the standard Felsenstein bootstrap method\". It is discussed in an April 2018 paper by Lemoine et al: https://www.nature.com/articles/s41586-018-0043-0 There is also a BOOSTER webpage: https://booster.pasteur.fr/ which mentions that the method is implemented in PhyML and RAxML-NG and also provides a link to the BOOSTER source code on Github. Perhaps it is already on the things-to-add list IQ-TREE? I guess it is already a very long list but it would be great if BOOSTER could be added. Thanks again for proding such a brillant piece of software, Frank Wright BioSS Edinburgh ", "Dear Frank, Thank you for your interest and suggestion. If I understood Minh correctly, the transfer bootstrap expectation (TBE) values are currently tested in the latest beta version of IQ-Tree (available from the IQ-Tree Github repository). Best wishes, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Yes, Heiko is right. The beta version has a new option --tbe to perform TBE after standard bootstrap. You can download from here: https://github.com/Cibiv/IQ-TREE/releases/tag/v1.7-beta . For example you can do iqtree -s ALN_FILE -b 100 --tbe will create 2 more files: ALN_FILE.tbe.tree (for ML tree with TBE supports) and ALN_FILE.tbe.stat (for some statistics to identify rogue taxa). Cheers Minh ", "Hi, TBE cannot works with UFBoot (-bb) ? Antony ", "Hi Antony, That\u2019s right. Because TBE was designed to correct Felsenstein\u2019s bootstrap, not UFBoot. In fact, UFBoot already has a bias correction, thus doing a double correction (UFBoot+TBE) is not valid. I clarified this with Booster author ( https://github.com/evolbioinfo/booster/issues/1 Cheers Minh ", "Thank you for your answer ! ", "Dear Minh, We are interested in getting the TBE feature released in CIPRES, but we usually do not release beta versions into production. Do you know what the timeline is for going form beta to full release for 1.7? And do you think there are any concerns for putting it into production to a broad audience? Best, Mark ", "Dear Mark, On 10 Nov 2018, at 4:22 am, Mark Miller < mark.ala...@gmail.com > wrote: Dear Minh, We are interested in getting the TBE feature released in CIPRES, but we usually do not release beta versions into production. Do you know what the timeline is for going form beta to full release for 1.7? Thanks for asking. Ver 1.7 release plan is February next year. There are a couple of features we want to put in for this release. And do you think there are any concerns for putting it into production to a broad audience? More testings are still needed... Cheers, Minh ", "Dear Minh, How to use --tbe option with pre generated .bootstraptrees files using \"iqtree -s input-alignmentfile -bo 20 -pre boot1\" is it available to use with \"iqtree -con -t alltrees\"? Thanks Vignesh ", "Hi Vignesh, This not is possible in IQ-Tree yet, but can you use the Booster code directly for this: https://github.com/evolbioinfo/booster Minh ", "Hi Minh, I would appreciate some clarification concerning this point. TBE is computed from a set of bootstrap trees and in the cas of UFB we have also a set of 'FSB-like'-bootstrap trees. This set is conceptually similar to the set of Felsestein bootstrap trees. After a careful reading of the first and second paper concerning UFB, I cannot find the indication of a 'correction' of the set of trees or individual UFB tree. Even if there are build under another assumptions and by another way, the UFB bootstrap trees set remains a set of \"possibles\" trees. So I do not understand why TBE cannot be computed from the UFB bootstrap set. I think that the early position of the BOOSTER team was close to mine and that the answer you received was mainly due to a misunderstanding. Of course I agree that much precautions have to be taken in the interpretation as the demonstration of the interest of TBE is dealing only on FSB. JPF ", "Hi, I also had the same thoughts and referenced back to this question on an issue at the github repository . The only correction I could find on the UFBoot paper was concerning polytomies, but I couldn't say if this correction would be enough to invalidade using TBE with UFBoot Matt ", "Hi Matt, There was a follow-up discussion here (in next thread): https://groups.google.com/forum/#!topic/iqtree/HAxyKySfAXI So it is not just about polytomies. As JPF termed it \u201cquasi-bootstrap trees\u201d, which can\u2019t be used as input for TBE, which work on Felsenstein\u2019s bootstrap trees. Cheers, Minh ", "Hi again Minh, I've re-read (once more) the UFBoot paper and the discussion you just linked and I think I have a clearer image of the problem of UFBoot with TBE and why it's a bad idea. Thanks you for your patience enlightening me! Regards, Matt Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "BjtpHtQz3nk": {"topic": "How to specify out group in web server", "initializeDate": "Nov 30, 2017, 12:31:48 AM", "timeStamp": "Nov 30, 2017, 4:18:43 AM", "content": ["I am running the iqtree using web server, however there is no option to specify an outgroup. How to fix it using webserver. Also when I ran the stand alone iqtree I successfully got the results. But next time I ran it, it shows me the following error even on the data which was run successfully on the previous data. *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: -s.log *** Alignment files (if possible) Aborted (core dumped) The alignment file is attached herewith. command used was: iqtree -s trimmed-shruti2 -bb 1000 -alrt 1000 -nt 10 -o MD00G4* How can I fix it. Thanks ", "Hi Aasim, Unfortunately there is no outgroup option at http://iqtree.cibiv.univie.ac.at , but you can try an alternative IQ-TREE web server here (hosted at LANL): https://www.hiv.lanl.gov/content/sequence/IQTREE/iqtree.html as there is such an option. I don\u2019t know exactly why this abort message, but it seems associated with * in the outgroup taxon name. Please remove this star sign in the sequence name. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <trimmed-shruti2> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "D6ULh6g78tU": {"topic": "Estimate branch length for a fixed topology", "initializeDate": "May 16, 2017, 7:04:07 PM", "timeStamp": "May 18, 2017, 6:52:14 AM", "content": ["Hi All, I want to estimate branch lengths under a fixed topology by given a protein alignment, but each time I got an estimated ML tree instead. The command shows as following: iqtree -s msa.fa -st AA -m JTT -te topology.nw -nt 1 -pre brlen -quiet' msa.fa is an amino acid alignment file in fasta format topology.nw is a newick file stores topology I wanted, the name corresponding to taxa name in alignment file Can any of you help me figure out what's wrong with my command? Or IQ-Tree does not have the ability to estimate branch length under a fixed topology? Thank you! FEI ", "Dear Fei, your command line is correct, nothing wrong. This should print the tree with estimated branch lengths to brlen.treefile. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Fei, I see the problem now. Your tree is rooted, but it was automatically converted to unrooted tree because the model is reversible. So the treefile has the same topology as the input tree, but is drawn at a different root taxon, giving the wrong impression that they are different. What you can do, is to use `-o` option to specify the outgroup taxon (in your case, \u201c-o ORNAN\u201d). Hope this helps, Minh On May 17, 2017, at 5:32 PM, FEI YUAN < yuanfe...@gmail.com > wrote: Hi Minh, Thank you for your replying. By using the command pasted, I did get a ML tree, but the topology does not match the one I specified. Moreover, I read the doc and it seems even I input a rooted tree, the final tree output by IQ-Tree will be an unrooted tree, is that true? How can I get exact tree topology I input and only let IQ-Tree estimate branch length without alter my topology? The following is the command line I used and I also attached the output of IQ-Tree: iqtree -s concatenation.fa -st AA -m JTT+R2 -te mammals.topology -nt 1 -pre concate -quiet The tree in concate.treefile is an unrooted tree and the topology does not match the tree I specified in file mammals.topology. From the log file, it seems iq-tree does not search tree space because of -te parameter, but how could it give me a tree that is different from my specified tree? <concate.ckp.gz> <concate.iqtree> <concate.log> <concate.treefile> <concatenation.fa> <mammals.topology> "]}, "TJFS2MLp8ys": {"topic": "Bootstrap trees", "initializeDate": "Oct 29, 2014, 4:37:40 AM", "timeStamp": "Oct 30, 2014, 11:39:08 AM", "content": ["Hi! Is there an option to write bootstrap trees from an uf-boot analysis to a file? Is it possible at all? Thanks! Misha ", "Hi Misha, the command line option for this is \"-wbt\" (for \"write bootstrap trees\"). All the bootstrap trees will then be written to .ufboot file. Cheers, Minh ", "Thanks, Minh! One more question: can it be that the bootstrap trees have less taxa than the main tree? Maybe because duplicate sequences are removed... I get 147 taxa in the .treefile file vs. 102 taxa in each of the ufboot trees. ", "that's true the identical sequences were removed from the bootstrap trees... .treefile still contains all taxa because we added them back at the end (randomly in the clade of identical sequences). we did it that way because identical sequences do not contain any information... If you still need all these identical sequences in the ufboot trees let me know Minh ", "Yes, would be really nice to get them so I can draw the bipartition information from those trees onto a Bayesian tree. Otherwise I have to do normal bootstrap which is really very slow... Is there a way? Misha ", "Hi Misha, I just posted the beta version 1.1.1 to fix this issue in the IQ-TREE web site: http://www.cibiv.at/software/iqtree/ Please scroll down to the bottom to download this developmental version. Let me know if it works now. Minh "]}, "Y0cRDaU7Rv0": {"topic": "Implementing Jackknifing", "initializeDate": "Nov 20, 2017, 9:04:08 AM", "timeStamp": "Dec 3, 2019, 9:53:29 AM", "content": ["Hello, Are you thinking of implementing the jackknife as a mesure of support in addition to the bootstrap and UFBoot? I believe the use of jackknifing would be an interesting complement to assess topological robustness and it would certainly be interesting to be able to estimate jackknife support for phylogenomic datasets in IQ-TREE. Best, Emmanuel ", "Hi Emmanuel, This is a reasonable request. I will add this to the TODO list as I don\u2019t see any difficulty to implement jackknife. Just one question: how many sites will one typically subsample (without replacement) in a jackknife analysis? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, if you implement this, would you in addition also (recommend)implement taxon jacknifing? Best, Karen ", "Hi Minh, Thanks for the quick reply, I think this will be useful. I don't think there is a consensus on the jackknife rate to use but based on several studies on the topic I think 40% is a good starting point. Emmanuel ", "Hi Emmanuel, Then the best is some option like -j 0.4 to specify jackknife rate of 40%. @Karen: taxon jackknife can be implemented, but the final step of consensus tree does not work as trees do not have the same taxon set. Then you have to use some other supertree method to summarize the trees. Minh ", "Hi, Thanks for implementing the jackknife procedure. This is very useful, especially when working on very large multiple alignments. I tried to use it recently with the command line : iqtree -s alignment.phy -j 0.1 -m GTR+F+R4 The ML tree was accurately inferred (using all positions of the alignment), but the jackknife procedure did not start (and no supports are associated to branches). I am using IQ-TREE multicore version 1.6.12 for Linux 64-bit built (Aug 15 2019). One more question, how many jackknife replicates are performed with the default parameters ? Is it possible to choose the number of replicates ? Many thanks in advance Best wishes C\u00e9line Brochier ", "Hi Celine, There are differences between IQ-TREE 1.X and 2.0 for the jackknife option (will be clarified soon in the documentation): For v1.X, you need to specify the jackknifing proportion via -j option and the number of replicates either via -b or -bb. For example, \"-j 0.1 -b 100\" will invoke the standard jackknife with 100 replicates and 0.1 jackknife proprotion. \u201c-j 0.1 -bb 1000\u201d will invoke 1000 ultrafast jackknife, in the same manner as the ultrafast bootstrap. So this will be much faster, but the jackknife support values might have a different interpretation. However, we didn't examine this: one can perform a simulation study as in our paper ( https://academic.oup.com/mbe/article/30/5/1188/997508 ) to investigate its behaviour compared with the \u201cstandard\u201d jackknife. So \u201c-j 0.1\u201d alone does not have any effect, as you didn\u2019t specify the number of replicates. For v2.0, we change the semantic of the -j option, which is to specify the number of replicates, where the default jackknife proportion is 0.5 (there was a paper claiming that this is the best parameter, but I can\u2019t recall right now). This can be changed via --jack-prop option. So for example, \u201c-j 100\u201d will perform the standard jackknife with 100 replicates and jackknifing proprotion 0.5. \u201c-J 1000\u201d will perform the ultrafast jackknife with 1000 replicates and jackknifing proprotion 0.5. \u201c-j 100 --jack-prop 0.1\u201d will perform the standard jackknife with 100 replicates and jackknifing proprotion 0.1. \u201c-J 1000 --jack-prop 0.1\u201d will perform the ultrafast jackknife with 1000 replicates and jackknifing proprotion 0.1. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ddee439e-ef35-49b9-b6ca-7d886297628e%40googlegroups.com ", "Many thanks Best wishes C\u00e9line Le mardi 3 d\u00e9cembre 2019 02:08:30 UTC+1, Minh Bui a \u00e9crit : Hi Celine, There are differences between IQ-TREE 1.X and 2.0 for the jackknife option (will be clarified soon in the documentation): For v1.X, you need to specify the jackknifing proportion via -j option and the number of replicates either via -b or -bb. For example, \"-j 0.1 -b 100\" will invoke the standard jackknife with 100 replicates and 0.1 jackknife proprotion. \u201c-j 0.1 -bb 1000\u201d will invoke 1000 ultrafast jackknife, in the same manner as the ultrafast bootstrap. So this will be much faster, but the jackknife support values might have a different interpretation. However, we didn't examine this: one can perform a simulation study as in our paper ( https://academic.oup.com/mbe/article/30/5/1188/997508 ) to investigate its behaviour compared with the \u201cstandard\u201d jackknife. So \u201c-j 0.1\u201d alone does not have any effect, as you didn\u2019t specify the number of replicates. For v2.0, we change the semantic of the -j option, which is to specify the number of replicates, where the default jackknife proportion is 0.5 (there was a paper claiming that this is the best parameter, but I can\u2019t recall right now). This can be changed via --jack-prop option. So for example, \u201c-j 100\u201d will perform the standard jackknife with 100 replicates and jackknifing proprotion 0.5. \u201c-J 1000\u201d will perform the ultrafast jackknife with 1000 replicates and jackknifing proprotion 0.5. \u201c-j 100 --jack-prop 0.1\u201d will perform the standard jackknife with 100 replicates and jackknifing proprotion 0.1. \u201c-J 1000 --jack-prop 0.1\u201d will perform the ultrafast jackknife with 1000 replicates and jackknifing proprotion 0.1. Hope that helps, Minh On 3 Dec 2019, at 3:46 am, Celine Brochier-Armanet < celine.bro...@gmail.com > wrote: Hi, Thanks for implementing the jackknife procedure. This is very useful, especially when working on very large multiple alignments. I tried to use it recently with the command line : iqtree -s alignment.phy -j 0.1 -m GTR+F+R4 The ML tree was accurately inferred (using all positions of the alignment), but the jackknife procedure did not start (and no supports are associated to branches). I am using IQ-TREE multicore version 1.6.12 for Linux 64-bit built (Aug 15 2019). One more question, how many jackknife replicates are performed with the default parameters ? Is it possible to choose the number of replicates ? Many thanks in advance Best wishes C\u00e9line Brochier You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "cI5ewDKuPJI": {"topic": "topology test crash", "initializeDate": "Aug 26, 2015, 7:16:51 PM", "timeStamp": "Aug 26, 2015, 7:16:51 PM", "content": ["Dear IQTREE developer, IQTREE crashed when I was running a topology test. Please find attached the data files and the log. Thanks! Best, Xiaofan "]}, "ASTWSZOtQC8": {"topic": "IQ-Tree consistency", "initializeDate": "Mar 9, 2020, 7:58:15 AM", "timeStamp": "Jan 17, 2021, 11:28:24 PM", "content": ["Hello, Thanks for providing this software, its easy to use and remarkably quick for our dataset. I just wanted to ask for your advice regarding IQ-TREE parameters. I am running IQ-TREE with a concatenated dataset of RAD loci composed of 1829548 sites and 14599 SNPs for 260 samples. I initially ran the analysis using the command below iqtree -s populations.all.edit.phylip -m MFP -bb 1000 -alrt 1000 -pre out -nt 16 To see if our tree search is consistently identifying the sample topology, I ran the same analysis multiple times and found that the best tree identified is different for each analysis. I saw the suggestions for the best practices in IQ-TREE here https://groups.google.com/forum/#!topic/iqtree/0mwGhDokNns and changed the input for -pers and -nstop as follows for two different runs: -pers-0.2 -nstop-500 -pers-0.1 -nstop-1000 However, I found similar results. I have attached a plot showing the comparison of the best trees from two separate analyses using -pers-0.1 -nstop-1000 and you can see that there are a lot of differences. Below are the \"BEST SCORE FOUND\" values from the log files of 10 runs using -pers-0.1 -nstop-1000. -2773113.415 -2773098.037 -2773100.456 -2773193.719 -2773110.434 -2773140.700 -2773146.741 -2773120.365 -2773076.027 -2773115.223 There is some variation in the Lnl values above. Am I correct in assuming that the tree search has not identified the optimum tree for this dataset? If so, can you recommend additional parameters that I could test? Thanks again and best wishes Ollie ", "Hi Ollie, This is a great question, the details really help. The ultimate answer is: there is unfortunately no way to guarantee a global optimum, because IQ-TREE (and other software) rely on heuristic algorithms. You can repeat as many runs as possible to narrow the gap to the global optimum. Therefore I suggest that you perform 100 runs for each setting: -pers 0.1 -nstop 1000 -pers 0.2 -nstop 1000 -pers 0.3 -nstop 1000 -pers 0.4 -nstop 1000 -pers 0.5 -nstop 1000 And then take the tree with highest likelihood from these 500 runs. Another way is to look back at the data and try to clean it up. Often there are \u201crogue\u201d taxa, whose positions in the tree are unstable and move around the tree from different runs. I would suggest that you use some tools like RogueNaRok to identify and remove them from the analysis. This tool need the bootstrap trees, so you just add option -wbt to print the bootstrap trees and feed them into RogueNaRok. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1756e0e9-18ef-4e73-81f6-9b3a6a8e808d%40googlegroups.com <plot_comparison_iqtree_1_2_blacklist_pers_0.1_nstop_1000_array_repeat.pdf> ", "Hi Minh, Just wanted to thank you for your reply and advice with this. And thanks also for your recommendation of RogueNaRok. Both worked well for me. Best wishes Ollie On Wednesday, March 11, 2020 at 7:14:54 AM UTC, Minh Bui wrote: Hi Ollie, This is a great question, the details really help. The ultimate answer is: there is unfortunately no way to guarantee a global optimum, because IQ-TREE (and other software) rely on heuristic algorithms. You can repeat as many runs as possible to narrow the gap to the global optimum. Therefore I suggest that you perform 100 runs for each setting: -pers 0.1 -nstop 1000 -pers 0.2 -nstop 1000 -pers 0.3 -nstop 1000 -pers 0.4 -nstop 1000 -pers 0.5 -nstop 1000 And then take the tree with highest likelihood from these 500 runs. Another way is to look back at the data and try to clean it up. Often there are \u201crogue\u201d taxa, whose positions in the tree are unstable and move around the tree from different runs. I would suggest that you use some tools like RogueNaRok to identify and remove them from the analysis. This tool need the bootstrap trees, so you just add option -wbt to print the bootstrap trees and feed them into RogueNaRok. Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Dear Mihn, I hope you are well I have run IQtree with the combination of parameters suggested herein, and now I have 500 runs from which I've picked the maximum likelihood tree. However, I'm not sure how to perform bootstrap on this best tree and I would like to run 10,000 replicates. Probably this is very basic, but I have tried using this best tree as the initial tree (-t option) but I get a worse likelihood, even though it is apparently starting from the highest likelihood spot. Maybe I have to specify the same partition model that I've got on that run, however, I don't know how to do this and I couldn't find information on the command reference. The command that I'm running now is $path_iqtree_2 -p $path_align -bb 10000 -alrt 10000 -T AUTO -m MFP+MERGE -rcluster 10 -pre $path_out/195spp_14g_best_tree_10kboot_t -o T_Semanga_superba_MWT93D002 \\ -keep_empty_seq -g $cons_tree -minsupnew 80 --no-terrace -t $ml_best_tree -wbtl Thank you so much in advance! Wendy El mi\u00e9rcoles, 11 de marzo de 2020, 3:14:54 (UTC-4), Minh Bui escribi\u00f3: Hi Ollie, This is a great question, the details really help. The ultimate answer is: there is unfortunately no way to guarantee a global optimum, because IQ-TREE (and other software) rely on heuristic algorithms. You can repeat as many runs as possible to narrow the gap to the global optimum. Therefore I suggest that you perform 100 runs for each setting: -pers 0.1 -nstop 1000 -pers 0.2 -nstop 1000 -pers 0.3 -nstop 1000 -pers 0.4 -nstop 1000 -pers 0.5 -nstop 1000 And then take the tree with highest likelihood from these 500 runs. Another way is to look back at the data and try to clean it up. Often there are \u201crogue\u201d taxa, whose positions in the tree are unstable and move around the tree from different runs. I would suggest that you use some tools like RogueNaRok to identify and remove them from the analysis. This tool need the bootstrap trees, so you just add option -wbt to print the bootstrap trees and feed them into RogueNaRok. Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Wendy, From this run IQ-TREE printed a file .splits.nex, which contains the bootstrap spports for all possible splits from all bootstrap trees. You can use this file to assign supports to your best ML tree using -sup option ( http://www.iqtree.org/doc/Command-Reference#constructing-consensus-tree iqtree -t XXX.splits.nex -sup BEST_ML_TREE_FILE For your question why using -t may result in lower ML tree: it\u2019s due to stochasticity in model selection and tree search: it may find a slightly different model and trees in this run, even though the start tree is better. Cheers Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e1d2406e-e559-4e27-b1b1-7a86c3c24638%40googlegroups.com ", "Hi Wendy, I see, this command can\u2019t know the bootstrap trees of course. But you can still use -wbt option to quickly write the bootstrap trees (without branch lengths) from the previous best run by repeating the very same command line and adding option --undo (if using v2.0): iqtree <same_command_line_as_before> --undo -wbt If you used v1.6.X or earlier, change --undo to --force-unfinish By default without this option, IQ-TREE complaint that this run completed. But with this option, IQ-TREE will load everything from the checkpoint file and continue the analysis. This is handy if you change/add a few options (-wbt in this case) and it should finish quickly because all the bootstrap trees were already recorded in the checkpoint file. Please note that this option is different from --redo. I should have written this in the tutorial/manual. However, this can\u2019t work with -wbtl because the bootstrap trees in the checkpoint file don\u2019t have branch lengths. Still, you don\u2019t have to repeat all 500 runs but only the best run using the same random seed number to reproduce it (which was written in the log file). So the command line is: iqtree <same_command_line_as_before> -seed SEED_NUMBER_FROM_BEST_RUN -wbtl -pre ANOTHER_PREFIX Hope that helps, Minh On 2 Apr 2020, at 2:28 pm, Wendy Valencia < valen...@gmail.com > wrote: Hi Minh, Thank you for your reply. The problem is that I need to write the bootstrap trees because I need the distribution of trees to perform other uncertainty downstream analysis. However, when I run this iqtree -t XXX.splits.nex -sup BEST_ML_TREE_FILE and add the option -wbtl, it doesn't write the trees, although it assigns the supports. I was not wise enough to write the bootstrap trees before the 500 runs, and now it would be very time and computationally consuming to repeat the 500 runs. Therefore, I would be very grateful if there's any other way to get the bootstrap trees using this previously found best ML tree. Thank you so much in advance and best wishes, Wendy ", "Sorry to bother you Ollie, but I'm very interested in the method you use to draw the diagram you are sharing, the comparison of all the trees generated from all your runs. What software did you use to draw it? ", "Hi there, you better send this email to o.willi...@gmail.com Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/67a0e1fd-33b3-4821-971a-3c14efb5feb7n%40googlegroups.com "]}, "0nemvQOaJNY": {"topic": "Too large site ID", "initializeDate": "Mar 10, 2015, 9:21:50 AM", "timeStamp": "Aug 21, 2017, 6:36:20 AM", "content": ["Hi, I am trying to construct a tree using partitioned codon-based alignment. However, halfway through the site extraction, i got the error \"Too large site ID\". I attached the .nex and .fas files for troubleshooting purpose. Regards Ming ", "Dear Ming, For codon alignments, IQ-Tree counts the alignment sites by codon, not per nucleotide. So you simply need to divide all the site ID by 3 to get the correct range. For example, \u201c1-672\u201d should become \u201c1-224\u201d and \"673-816\u201d should be \u201c225-272\u201d, and so on. BTW this is a good question, I will add this into the manual. Thanks, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout > <all.fas><all.nex><all.nex.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Hi, I'm posting this rather as a note - I came across the same error and I believe the explanation that sites in codon alignment are counted per codon and not per nucleotide might be still missing in the IQTREE manual and other documentation I read through (please ignore this in case I just overlooked it). Best, Ales ", "Dear Ales, I'm posting this rather as a note - I came across the same error and I believe the explanation that sites in codon alignment are counted per codon and not per nucleotide might be still missing in the IQTREE manual and other documentation I read through (please ignore this in case I just overlooked it). Of course, if the data type is set to codons, the positions are also counted in codons, because a \u2018character\u2019 at the codon-level is a triplet. Best wishes, Heiko You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree "]}, "D5eYOQH2qOk": {"topic": "Full alignment or polymorphic sites only?", "initializeDate": "May 12, 2020, 7:29:36 PM", "timeStamp": "May 12, 2020, 7:39:25 PM", "content": ["Dear iqtree users, I have a multiple alignment of 3000 bacterial genomes. Full alignment is about 5 Mb long, but only 50k sites are polymorphic (about 20k are AGCT only). Should I use full alignment or polymorphic sites only to determine the best model? Generally speaking, does it make any difference if I keep monomorphic sites or not? Thank you in advance. ", "Hi Alexander, Please keep all the sites in the alignment, incl. invariant sites. They are critical to properly estimate the branch lengths, hence the tree. Without them might cause bias in phylogenetic inference, see e.g. https://doi.org/10.1080/106351501753462876 for why. Btw including the invariant sites does not slow down IQ-TREE, because it compresses all identical sites into site patterns, and likelihood computation speed depends on the number of site patterns, not the number of all sites. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f4cf7262-dd60-4891-b119-5a4eef9e1679%40googlegroups.com "]}, "w-pmdODpnQE": {"topic": "what happens to sites not specified in a partition file?", "initializeDate": "Nov 8, 2019, 10:13:58 AM", "timeStamp": "Nov 10, 2019, 6:29:53 PM", "content": ["hello all, Let's say I have a partition file that is specifying 1st and 2nd codon positions in the alignment, but not the third position, e.g.: DNA, og1 = 1-500\\3 DNA, og1_2 = 2-500\\3 DNA, og2 = 501-900\\3 etc... the full alignment still contains the entire alignment in frame, so it still has 3rd positions. Does IQtree ignore any columns not specified in the partition file for ML inference? ", "Hi John, The simple answer is Yes, IQ-TREE will ignore all positions not included in the partition file. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b71a42e7-8816-4909-a8c7-9f255a964b43%40googlegroups.com "]}, "9yvYHdL0zp8": {"topic": "IQ-Tree release 1.3.3", "initializeDate": "Jun 27, 2015, 6:27:12 PM", "timeStamp": "Nov 9, 2016, 5:20:50 AM", "content": ["Dear IQ-Tree users, June 27, 2015: We are pleased to announce version 1.3.3 with substantial improvements: Implement the relaxed clustering algorithm of PartitionFinder with -rcluster option to speed up analysis for data sets with many partitions (>100) Partition finding supports multicore now with linear speedup. Increased multicore performance of partition model analysis. Support direct translation of coding sequences into amino-acid (-st NT2AA option). Adjust state frequencies considering missing data for partition model to be fully compatible with RAxML. Print sequence identity scores along the tree (-wsi option). Fix slow convergence of partition model parameter estimation with many partitions. Fix memory allocation for large mixture models. Happy computing! Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "On Saturday, June 27, 2015 at 7:27:12 PM UTC-3, Bui Quang Minh wrote: > Dear IQ-Tree users, > June 27, 2015: We are pleased to announce version 1.3.3 with substantial improvements:Implement the relaxed clustering algorithm of PartitionFinder with -rcluster option to speed up analysis for data sets with many partitions (>100)Partition finding supports multicore now with linear speedup.Increased multicore performance of partition model analysis.Support direct translation of coding sequences into amino-acid (-st NT2AA option).Adjust state frequencies considering missing data for partition model to be fully compatible with RAxML.Print sequence identity scores along the tree (-wsi option).Fix slow convergence of partition model parameter estimation with many partitions.Fix memory allocation for large mixture models. > Happy computing! > Minh > -- > Bui Quang Minh > Center for Integrative Bioinformatics Vienna (CIBIV) > Max F. Perutz Laboratories > Campus Vienna Biocenter 5, VBC5, Ebene 1 > A-1030 Vienna, Austria > Phone: ++43 1 4277 24026 > Fax: ++43 1 4277 24098 > Email: minh.bui (AT) univie.ac.at Hi Minh, Great news! There were discussions on the mixture models. For C60 one can use -m LG+G4+FMIX{\u2026(c60 alias)}. My question is if we can use my own AA frequencies instead of C60 in the frequency mixture. Is that possible? Huaichun ", "Dear Huaichun, thanks for your interest! And yes it is possible to input a customized mixture model. First, you need to prepare a model definition file in NEXUS format. For example: #nexus begin models; frequency myF1 = 0.02549352 0.01296012 0.005545202 0.006005566 0.01002193 0.01112289 0.008811948 0.001796161 0.004312188 0.2108274 0.2730413 0.01335451 0.07862202 0.03859909 0.005058205 0.008209453 0.03210019 0.002668138 0.01379098 0.2376598; frequency myF2 = 0.09596966 0.008786096 0.02805857 0.01880183 0.005026264 0.006454635 0.01582725 0.7215719 0.003379354 0.002257725 0.003013483 0.01343441 0.001511657 0.002107865 0.006751404 0.04798539 0.01141559 0.000523736 0.002188483 0.004934972; frequency myFmodel = FMIX{myF1,myF2}; end; Save it to a file, say, mymodel.nex. myF1, myF2, and Fcustom are just names (you can give whatever name you like). For each \u2018frequency\u2019 command of the nexus file, you just list the 20 AA frequencies after \u2018=\u2018 sign, in the following AA order: A R N D C Q E G H I L K M F P S T W Y V Ala Arg Asn Asp Cys Gln Glu Gly His Ile Leu Lys Met Phe Pro Ser Thr Trp Tyr Val Then run iqtree with: iqtree -mdef mymodel.nex -m LG+myFmodel+G \u2026 If you do iqtree -mdef mymodel.nex -m LG+myFmodel+F+G then IQ-tree will add the third mixture class corresponding to empirical frequency from the data. The mixture weights will be automatically estimated by ML. You can also define your own AA replacement matrix instead of LG using this nexus file. Hope that helps Minh ", "On Saturday, June 27, 2015 at 7:27:12 PM UTC-3, Bui Quang Minh wrote: > Dear IQ-Tree users, > June 27, 2015: We are pleased to announce version 1.3.3 with substantial improvements:Implement the relaxed clustering algorithm of PartitionFinder with -rcluster option to speed up analysis for data sets with many partitions (>100)Partition finding supports multicore now with linear speedup.Increased multicore performance of partition model analysis.Support direct translation of coding sequences into amino-acid (-st NT2AA option).Adjust state frequencies considering missing data for partition model to be fully compatible with RAxML.Print sequence identity scores along the tree (-wsi option).Fix slow convergence of partition model parameter estimation with many partitions.Fix memory allocation for large mixture models. > Happy computing! > Minh > -- > Bui Quang Minh > Center for Integrative Bioinformatics Vienna (CIBIV) > Max F. Perutz Laboratories > Campus Vienna Biocenter 5, VBC5, Ebene 1 > A-1030 Vienna, Austria > Phone: ++43 1 4277 24026 > Fax: ++43 1 4277 24098 > Email: minh.bui (AT) univie.ac.at Hi Bui, Just wondered for evaluating the likelihood of a fixed user-given tree, we should use -te mytree or use -z mytree? Huaichun ", "Dear Huaichun, -te option will fix the input tree and no tree search is performed. Model parameters are estimated on this tree. -z option will first perform a full tree search, and finally evaluate the bunch of trees via -z and possibly also do tree topology testing (e.g. when coupled with -zb option) Does that helps? Cheers, Minh ", "Hi Minh, I see that above you mentioned \" Fix memory allocation for large mixture models.\" Does this mean we can specify how much memory IQtree will get to use? I can't seem to find this option in the manual though. Thanks in advance for your help! Laura ", "Dear Laura There is no such option in Iqtree. The annoucement was just to notify that a memory issue was fixed. Note that we will soon release the next version that implements a time and memory saving technique for mixture models Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thank you for the clarification! To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com ", "Dear Laura, there is now an option, like \"-mem 100G\u201d in version 1.5.1. In principle, IQ-TREE now allows to use up to log2(N)/N fraction of RAM compared to the normal mode, where N = number of sequences. That means, for N=100, it only needs as low as 7% of the RAM in the most aggressive memory mode. But this comes with some compensation in runtime. So you should not restrict RAM too much. Hope that this option will be helpful for your data set. Cheers, Minh Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "5r54NEHcuuQ": {"topic": "IQ-TREE multicore version 1.3.4 for Windows 64-bit CRASHES WITH SIGNAL SEGMENTATION FAULT", "initializeDate": "Sep 17, 2015, 3:17:48 AM", "timeStamp": "Sep 17, 2015, 5:20:10 AM", "content": ["Dear IQ-TREE Team, IQ-TREE multicore version 1.3.4 for Windows 64-bit chashed with signal segmentation fault after bootstrap replicate number 29. This error has occured twice in 2 independent runs. NB. In the intitial run using the same alignment and partition files with only 2 bootstrap replicates (-b 2) the run was completed without any error. Could you help me to fix this problem? Attached is the log file. Thanks you so much. kind regards, J\u00f3zsef ", "Dear Jozsef, that looks strange. To further examine can you pls send me your alignment and partition file via personal email? Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <ITS_LSU_reduced8_jmodeltest_partitionfile.txt.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at "]}, "wvRui_tcuv4": {"topic": "New citations for IQ-TREE", "initializeDate": "Apr 28, 2016, 2:37:15 PM", "timeStamp": "Apr 28, 2016, 2:37:15 PM", "content": ["Dear users, As you know the IQ-TREE software is completely free and open source. The IQ-TREE team provides free user-supports, maintenance as well as implements new features, many of which are requested by users. This is all possible via public funding: without it we cannot maintain IQ-TREE. To obtain future funding for the IQ-TREE project it is important that you cite the following papers whenever appropriate. * If you performed tree reconstruction please cite: [1] L.-T. Nguyen, H.A. Schmidt, A. von Haeseler, and B.Q. Minh (2015) IQ-TREE: A fast and effective stochastic algorithm for estimating maximum likelihood phylogenies. Mol. Biol. Evol., 32, 268-274. ( http://dx.doi.org/10.1093/molbev/msu300 * If you performed the ultrafast bootstrap approximation please cite: [2] B.Q. Minh, M.A.T. Nguyen, and A. von Haeseler (2013) Ultrafast approximation for phylogenetic bootstrap. Mol. Biol. Evol., 30:1188-1195. ( http://dx.doi.org/10.1093/molbev/mst024 * If you used partition models for phylogenomic analysis please cite: [3] O. Chernomor, A. von Haeseler, and B.Q. Minh (2016) Terrace aware data structure for phylogenomic inference from supermatrices. Syst. Biol., in press. ( http://dx.doi.org/10.1093/sysbio/syw037 * If you used the IQ-TREE web server ( http://iqtree.cibiv.univie.ac.at ) please cite: [4] J. Trifinopoulos, L.-T. Nguyen, A. von Haeseler, and B.Q. Minh (2016) W-IQ-TREE: a fast online phylogenetic tool for maximum likelihood analysis. Nucleic Acids Res., in press. ( http://dx.doi.org/10.1093/nar/gkw256 * For other features, please cite [1]. To further illustrate this, if you performed tree reconstruction and ultrafast bootstrap, then please cite [1] and [2]. If you performed tree reconstruction under partition models, please cite [1] and [3]. In a nutshell we ask you to cite the papers that describes the corresponding features you applied for your analysis. We thank you for your cooperation! IQ-TREE development team "]}, "7H7tvdsHVDU": {"topic": "Which number of replicates  for UltraFast bootstrap support I have to use to publish my tree in journal?", "initializeDate": "Jul 23, 2019, 5:25:57 AM", "timeStamp": "Jul 24, 2019, 6:55:12 AM", "content": ["Hi! I don't know which number of replicates for UltraFast bootstrap support I have to use to publish my tree in journal. I reed the paper about Ultarfast but authors reccomend minimal number 1000. I know for standart bootstrap number is 1000 for publication in journal althrou 100 is the minimal number. Can I use 10000 for ultrafast? ", "Hi, The ultrafast bootstrap replicates should be at least 1000 (actually IQ-TREE does not allow you to specify lower number). For long (multi-gene) alignments, I\u2019d actually recommend to use more replicates, which does not affect the runtimes subtantially (i.e. going from 1000 to 10000 does not increase the runtime 10-fold, but only 2x or so). For partition models I\u2019d also suggest to use GENE resampling or better GENESITE resampling. See our UFBoot2 paper for the reason behind it ( https://doi.org/10.1093/molbev/msx281 Cheers, Minh On 23 Jul 2019, at 7:25 pm, \u0410\u043b\u0441\u0443 \u041d\u0430\u0437\u0438\u043f\u043e\u0432\u0430 < sushe...@gmail.com > wrote: Hi! I don't know which number of replicates for UltraFast bootstrap support I have to use to publish my tree in journal. I reed the paper about Ultarfast but authors reccomend minimal number 1000. I know for standart bootstrap number is 1000 for publication in journal althrou 100 is the minimal number. Can I use 10000 for ultrafast? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8d9a3852-7a57-4909-87a5-f6028d73f05d%40googlegroups.com ", "Thank you very much! \u0441\u0440\u0435\u0434\u0430, 24 \u0438\u044e\u043b\u044f 2019 \u0433., 2:42:27 UTC+3 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c Minh Bui \u043d\u0430\u043f\u0438\u0441\u0430\u043b: Hi, The ultrafast bootstrap replicates should be at least 1000 (actually IQ-TREE does not allow you to specify lower number). For long (multi-gene) alignments, I\u2019d actually recommend to use more replicates, which does not affect the runtimes subtantially (i.e. going from 1000 to 10000 does not increase the runtime 10-fold, but only 2x or so). For partition models I\u2019d also suggest to use GENE resampling or better GENESITE resampling. See our UFBoot2 paper for the reason behind it ( https://doi.org/10.1093/molbev/msx281 Cheers, Minh On 23 Jul 2019, at 7:25 pm, \u0410\u043b\u0441\u0443 \u041d\u0430\u0437\u0438\u043f\u043e\u0432\u0430 < sushe...@gmail.com > wrote: Hi! I don't know which number of replicates for UltraFast bootstrap support I have to use to publish my tree in journal. I reed the paper about Ultarfast but authors reccomend minimal number 1000. I know for standart bootstrap number is 1000 for publication in journal althrou 100 is the minimal number. Can I use 10000 for ultrafast? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "OQr9mqSUr84": {"topic": "IQ-Tree supported models", "initializeDate": "Apr 23, 2019, 7:21:03 AM", "timeStamp": "Apr 25, 2019, 11:12:59 PM", "content": ["Hi everyone, What happens when one of my input models in the partition file is not supported in IQ-TREE? Thanks, Amor ", "Hi Amor, Can you give more details, e.g. what model is that? I believe IQ-TREE supports most DNA, protein and other models. You can also specify your own models. Please have a look at: http://www.iqtree.org/doc/Substitution-Models Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "CH8CtTJiWHM": {"topic": "Version 1.5.5: Variant sites file not produced", "initializeDate": "Aug 23, 2017, 12:48:08 AM", "timeStamp": "Aug 27, 2017, 7:14:27 PM", "content": ["Hi, I'm trying to run iq-tree (version 1.5.5) on a SNP dataset using the following code: iqtree-omp -s input.fasta -m MFP+ASC -bb 10000 -nt AUTO -st DNA The program initially warns that it detects a different sequence type than that specified (it thinks I'm using proteins due to ambiguity codes), but I think it is safe to ignore this as I am using -st DNA? However, the model selection does not take place, with the output \"Skipped since +ASC is not applicable\". I understand that this is due to the fact that I have constant sites in the alignment, and I was expecting a .varsites file to be produced as per p121 of the manual. However, no such file is produced and I cannot proceed. I attach an example input file and the output log files to this post. Thanks in advance, Angela ", "Hi Angela, On Aug 23, 2017, at 6:48 AM, Angela McGaughran < ang.mcg...@gmail.com > wrote: Hi, I'm trying to run iq-tree (version 1.5.5) on a SNP dataset using the following code: iqtree-omp -s input.fasta -m MFP+ASC -bb 10000 -nt AUTO -st DNA The program initially warns that it detects a different sequence type than that specified (it thinks I'm using proteins due to ambiguity codes), but I think it is safe to ignore this as I am using -st DNA? You are right - you can ignore this warning because IQ-TREE mis-detected the data type due to many ambiguity code. However, the model selection does not take place, with the output \"Skipped since +ASC is not applicable\". I understand that this is due to the fact that I have constant sites in the alignment, and I was expecting a .varsites file to be produced as per p121 of the manual. However, no such file is produced and I cannot proceed. I attach an example input file and the output log files to this post. Please do -m GTR+ASC instead of -m MFP+ASC. It should then produce a .varsites.phy file and an error message like: For your convenience alignment with variable sites printed to example.phy.varsites.phy ERROR: Invalid use of +ASC because of 686 invariant sites in the alignment The bottom line is that ModelFinder does not write this file, but giving a specific model name like GTR will do. We will change the behavior in later version. Thanks, Minh Thanks in advance, Angela You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <2015-10-01_quail_lib.new.gvcf.filtered.snps.xmdp10.mmc7.mac3.Z.thin200000.recode.vcf.fasta> <Zonly_thinned.log> <Zonly_thinned.ckp.gz> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thanks so much, that worked fine! All the best, Angela "]}, "VuKSjGMgUhs": {"topic": "Map Likelihood Cluster Nexus", "initializeDate": "Feb 19, 2019, 5:18:37 PM", "timeStamp": "Feb 19, 2019, 9:23:29 PM", "content": ["Hi I prepare a Cluster file to use -lmclust in Linux v 1.6.7.2. and it gave the error message No cluster found... attach is the Nexus file I prepared for the analysis ", "Dear Christian, I guess the the problem originates from a typos in your file. The proper keyword to be used in the Nexus file is \u201ctaxset\u201d not \u201ctaxaset\u201d. I hope that fixes it. Best wishes, Heiko > On 19 Feb 2019, at 23:18, Cristian Beza < xfis...@gmail.com > wrote: > Hi I prepare a Cluster file to use -lmclust in Linux v 1.6.7.2. > and it gave the error message No cluster found... attach is the Nexus file I prepared for the analysis > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout > <Cluster.nex> ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- "]}, "iiVOCqNSOjQ": {"topic": "pmsf - Numerical underflow (lh-branch)", "initializeDate": "Mar 11, 2020, 9:57:15 PM", "timeStamp": "Mar 12, 2020, 7:18:30 PM", "content": ["Hello It's been a couple of days I fail to run IqTree with PMSF. I've been using IqTree until now to generate \"regular\" trees in C20 and C60. We use the last IqTree Stable release 1.6.12. IqTree read my tree, I see in the log file : ===> COMPUTING SITE FREQUENCY MODEL BASED ON TREE FILE arbre-consensus-rep1.tre My data are at the same format that I always use IqTree. Here is an exemple of my command line : iqtree-mpi -s replicate-01-concat-modified.fasta -m LG+C60+F+G -b 1000 -ft arbre-consensus-rep1.tre -nt 5 -mem 60G After some minutes (around 10-15), IqTree displays this : Numerical underflow (lh-branch) I tryed with the \"safe\" option, as I read this on previous forum, but nothing has changed. We tried other type of optimisation (we saw in the bugfixes of the releases \"Numerical issue with likelihood scaling for gcc under -O3 optimisation\" in a previous, so we thought that could change something but no...). You will find attach a printscreen of what happen. If you want I can send you my data so you can test. We are running out of ideas... My reference tree is a tree obtained with IqTree C60. Best regards Richard GOUY ", "Hi Richard, The screenshot show an assertion that is relevant: Assertion `current_len >= 0.0\u2019 failed. That means the tree file (arbre-consensus-rep1.tre) has some branch lengths of zero. So please check that tree file. Also I noted this line in the log: Converting rooted to unrooted tree... That means you have likely edited the tree somehow, which caused problem... Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c8577026-275d-40ea-ab88-cc361389be0a%40googlegroups.com <Capture du 2020-03-04 11:50:04.png> ", "OK, thank you, it works now. Best regards, Richard GOUY To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "0yOjVhO-iXg": {"topic": "Re: [iqtree] crash on computer cluster", "initializeDate": "Nov 20, 2019, 7:32:07 AM", "timeStamp": "Nov 20, 2019, 9:52:51 AM", "content": ["Hi Pascal, Can you pls rerun without -mem option. Someone else recently reported a crash with this option. Thanks, Minh On 15 Nov 2019, at 5:37 am, Pascal Title < pasca...@gmail.com > wrote: Hi, I'm trying to get IQ-TREE to work on our university cluster, but it has been crashing. As a test, I am using a relatively small dataset that shouldn't be needing much memory, and for now I am testing with a single core (-nt 1). But here is the end of the log where the crash occurs: TREE SEARCH START WITH THE FOLLOWING PARAMETERS Model of evolution Partition model 412 free parameters Fixed branch lengths Tree search algorithm Stochastic nearest neighbor interchange Termination condition after 100 unsuccessful iterations NNI assessed on branches Phylogenetic likelihood library Branch length optimization method Newton Number Newton Raphson steps NNI evaluation and branch length optimization SSE instructions Yes NOTE 458 MB RAM required Estimate model parameters epsilon 0.1000000000 ERROR STACK TRACE FOR DEBUGGING ERROR ERROR *** TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR *** For bug report please send to developers ERROR *** Log file anguidaeConstrained log ERROR *** Alignment files possible var spool torque mom_priv jobs 1447907.s1.SC line 23466 Segmentation fault /bin/ iqtree s anguids phy spp concatenated partitions_iqtree m GTR pre anguidaeConstrained g anguids tre seed 12345 mem 30G redo END And here is the top of the log: TREE multicore version 1.6 for Linux bit built Aug 2019 Developed Bui Quang Minh Nguyen Lam Tung Olga Chernomor Heiko Schmidt Dominik Schrempf Michael Woodhams Host c13 AVX2 FMA3 251 GB RAM Command /N/ ptitle Carbonate bin iqtree s anguids phy spp concatenated partitions_iqtree m GTR pre anguidaeConstrained g ang uids tre seed 12345 mem 30G redo Seed 12345 Using SPRNG Scalable Parallel Random Number Generator bit Linear Congruential Generator with Prime Addend seed 12345 stream_number parameter Time Thu Nov 2019 Kernel AVX FMA threads CPU cores detected HINT Use nt option to specify number of threads because your CPU has cores HINT nt AUTO will automatically determine the best number of threads to use I'm wondering if there might be an issue with the number of cores detected, requested and used. I only requested 1 core for this job (via my PBS script), and specified \"-nt 1\", but the hint that it prints about using the -nt flag makes me wonder if it's not being handled properly? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8566de68-306b-4589-8fb7-a34599f8a6b0%40googlegroups.com ", "Yes, that appears to be the problem. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "vkB4y0WpEDs": {"topic": "Optimize branch lengths on fixed topology and calculate site-wise likelihoods", "initializeDate": "Jul 10, 2020, 11:09:08 AM", "timeStamp": "Jul 13, 2020, 5:01:11 AM", "content": ["Hi all, I want to use a fixed topology (no branch lengths) as a constrain to calculate model parameters and optimize branch lengths (on the fixed tree) but also to export site-wise likelihoods based on the model and the optimized tree. Would this command do the job or is this only for estimating the model parameters on a fixed tree?: iqtree -s supermatrix.fas -m LG+R10 -te treefile -safe -wsl I am using v. 1.6.12 If not how is it possible to do this? Many thanks Alex ", "Hi Alex, Yes, that command does the job, it will optimise both model parameters and branch lengths. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/abb4591f-8255-46bc-8525-6cf7a45cf3aan%40googlegroups.com ", "Thanks a lot Minh! "]}, "QrkLL7R6Gfk": {"topic": "BUG: Modeltest -m MFP+LM or -m TEST+LM+MERGE", "initializeDate": "Mar 19, 2019, 10:19:19 AM", "timeStamp": "Mar 20, 2019, 7:31:26 AM", "content": ["Hi developers, I was trying to use the Lie Markov models implemented in iqtree. I used the command -m MFP+LM and -m TEST+LM+MERGE more than once using both version 1.6.10 and 1.6.9. But I am getting an error which is pasted below. ================== Converting unrooted to rooted tree... NOTE: 11 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.100) Optimizing TIM2+F+I+G4 parameters for partition rrna+cox_1+cox_2+cytb_1+cytb_2+rag_1+rag_2 (95 free parameters) Optimizing TIM3+F+I+G4 parameters for partition cox_3+cytb_3 (95 free parameters) Optimizing WS6.6+G4 parameters for partition rag_3 (92 free parameters) Optimal log-likelihood: -53245.784 Computing ML distances based on estimated model parameters... 0.238 sec Computing BIONJ tree... ERROR: phylotree.cpp:372: virtual void PhyloTree::setAlignment(Alignment *): Assertion `root->name == ROOT_NAME' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: concat.nex.log ERROR: *** Alignment files (if possible) Aborted (core dumped) ===== iqtree169 -s xxxxx_concat.nex -sp concat.nex -m TEST+LM+MERGE is the command that I used at the command line. === Is this because I did not use a start tree with a ROOT. or is it some other error.. could you please look at this issue and sort it out so that I could use the Lie Markov Models for my dataset. Siby. ", "Hi Siby, Can you please try this with v1.7 latest beta? From the log file, the partition model has mixed reversible and non-reversible models. And I believe this is not supported in v1.6. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "c2UCd-MiL1g": {"topic": "Re: [iqtree] How can I get a file called PARTITION_FILE in tutorial?", "initializeDate": "Jan 17, 2021, 11:38:32 PM", "timeStamp": "Jan 18, 2021, 10:11:51 PM", "content": ["Hi Hiroto, Sorry for the long delay, I\u2019m back from a long break. Here you can use the same partition file for -S option (it accepts either a partition file, or a directory). See http://www.iqtree.org/doc/Concordance-Factor#putting-it-all-together . So something like: iqtree -s myfilename.phy -S myfilename.nex -nt AUTO --prefix loci Minh On 27 Dec 2020, at 2:56 pm, Hiroto < s8163...@gmail.com > wrote: Hi, thanks for reading. I am trying to get concordance factors on my phylogenetic tree. First, I tried to get species tree described in tutorial (inferring species tree part) and ran iqtree -s myfilename.phy -p myfilename.nex --alrt 1000 -B 1000 -bnni -nt AUTO This command looked like to work well, so I tried to go to the next step (inferring gene/locus tree part). Though, I got stuck here what to do with -S option. Tutorial says it direct iqtree to a DIRECTORY which contains PARTITION FILE, but what I have now is NEXUS file with partition information. So, I don't know what kind of file I should input in this step. Is a PARTITION_FILE in this step (inferring gene/locus tree part) completely same as the one used in \"inferring species tree\" part ? or one of the outfiles output from the part ? Always thanks for your great support Best wishes, Hiroto tai You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/79452538-22cb-45ae-b6e9-1e48422a61dcn%40googlegroups.com ", "Thanks for the response, Dr.Minh ! Though the \"inferring species tree\" part successfully ran with -p option and my NEXUS file, the \"inferring gene/locus trees\" part somehow stops with -S option and the same NEXUS file. It generates some error messages described in the log file attached to this message. I wish you could tell me what kind of problems the WARNING message may indicate, please. Best wishes, Hiroto Tai 2021\u5e741\u670818\u65e5\u6708\u66dc\u65e5 13:38:32 UTC+9 Minh Bui: "]}, "_2w6VA6aohI": {"topic": "Hypothesis/topology testing (AU, ELW, etc)", "initializeDate": "May 30, 2017, 8:58:14 AM", "timeStamp": "May 30, 2017, 3:37:20 PM", "content": ["Dear All, Hypothesis testing via AU, ELW and similar tests is fortunately (hopefully) becoming routine. Aside from CONSEL, both IQ-TREE and RAxML implement a number of those tests. Suppose you find 3 best-ML trees (suppose different topologies), under 3 different evolutionary models. Now you want to do some topology testing. The command line, in both IQ-TREE and RAxML, requires to specify an evolutionary model; the choice of which model to use is not straightforward to me. Could you please clarify this very basic issue? Best, Giorgio ", "Hi Giorgio again, Tree likelihoods are only comparable under the same model, which is essentially what these topology tests do. Thus, you can perform 3 independent tests, each under one of the three models, and see how the results look like. I guess they will more or less agree with each other\u2026 Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "6CPiFpahPeM": {"topic": "Model checkpoint file", "initializeDate": "Feb 18, 2019, 9:27:44 PM", "timeStamp": "Feb 19, 2019, 6:36:27 AM", "content": ["Hi Minh, I am exploring the checkpoint file produced by iqtree when doing model testing (-m TESTONLY). I was wondering if you could explain what the format of the checkpoint file is? For example, in the following line: A_gene.fasta: Blosum62: -xx yy zz Blosum62+F: -xx yy zz What do columns with values represented here as xx, yy, and zz represent? Are any of these BIC/AIC/AICc values? best, Jacob ", "Hi Jacob again, -xx is the log-likelihood of the model. yy is the degree of freedom (number of free parameters of the model). zz is the tree length, i.e., sum of branch lengths. From xx and yy you can compute the AIC score. For BIC and AICc, just take the alignment length as sample size to the equation. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "4cffimmnvGw": {"topic": "Start tree search from multiple trees specified in file", "initializeDate": "Nov 15, 2020, 5:54:03 PM", "timeStamp": "Dec 7, 2020, 12:39:38 PM", "content": ["Hi, I want to perform a tree search starting from 50 random + 50 parsimony trees. The reasoning behind it is that starting from parsimony trees only, could bias the search towards a specific part of the tree space, and potentially local optima (I would appreciate any comment about it). From what I understand, the -t <file> option allows to load only one user defined tree to start the search. What I want to know is: if my <file> has the 50 random + 50 parsimony trees that I want to use, will all of them be considered, or just the first one (first line)? Thanks ! ", "My apology for the delay in replying. Just too much commitment at the moment: On 16 Nov 2020, at 9:54 am, Kevin I. S\u00e1nchez < kevin.iman...@gmail.com > wrote: Hi, I want to perform a tree search starting from 50 random + 50 parsimony trees. The reasoning behind it is that starting from parsimony trees only, could bias the search towards a specific part of the tree space, and potentially local optima (I would appreciate any comment about it). By default IQ-TREE will already generate 99 parsimony starting trees (plus a BIONJ tree). I would advise against random starting trees \u2014 this is something specific for RAxML algorithm, not IQ-TREE. Therefore, what you can do is to simply start 10 independent IQ-TREE runs (from different seed number). This will generate in total 990 parsimony in all 10 runs. That\u2019s enough. See the recent Zhou et al paper: https://academic.oup.com/mbe/article/35/2/486/4644721 From what I understand, the -t <file> option allows to load only one user defined tree to start the search. What I want to know is: if my <file> has the 50 random + 50 parsimony trees that I want to use, will all of them be considered, or just the first one (first line)? Only the first line (or the first tree) will be loaded. But see my answer above. Minh Thanks ! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/adf25ca9-7981-46b1-a918-8619ce56d036n%40googlegroups.com ", "Dear Minh, all I have now looked and so many datasets (ok mainly from insects) that I disagree a bit what you wrote about random start trees. I would always do independent runs and then BOTH, parsimony start trees and random, because I really saw many times that the range of best likelihoods received afterwards is still much wider and not comparing this then, quite often, the overall best logLG (comparing ML trees with 25 random + 25 parsimony) was one with a random start tree (similar to RAxML actually). Also I recognized that having dataset with a lot closely related taxa (so one genus/family or population - in contrast to \"deep\" phylogenies here ML searches with a pars. starting tree (default) having better logLH scores. Interesting to hear more opinions. Additionally I also switched when doing slow BS to start with random trees here as well. Best, Karen ", "HI Minh, thanks for the answer, I just have read the paper, really helpful So a question arises. Starting the tree search from random + parsimony trees as can be specified in RAxML, is recommended to avoid stuck in local optimum because it implements SPR-based moves? I see that IQ-TREE is based on NNI moves... ", "Hi Karen, I see, that\u2019s good to know. When you observed that starting from random trees obtained better log-likelihoods, how much better it is? But yeah I agree, it depends on the dataset\u2026 Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7efad7ad-679b-4903-beb6-7998cabfb3cdn%40googlegroups.com ", "This is because RAxML doesn\u2019t have the stochastic pertubation step like in IQ-TREE. RAxML has the only one \u201crandom\u201d step in the starting tree, the remaining is hill-climbing SPR. Whereas IQ-TREE does a lot of iterations, each will propose a random tree (by randomly perturbing branches of some local optimal tree) and then do hill-climbing NNI. We observed that this is better than RAxML algorithm, as independently confirmed by Zhou et al. But as Karen just wrote, for some datasets it may even be more helpful to do random starting trees\u2026 so you can do this when in doubt about local optima. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b309c022-3df9-4f65-b85f-d6bfcc7287b8n%40googlegroups.com ", "Dear Minh, with a dataset I handle currently (Antl. :)) at least several likelihood units (up to 3 before the comma), but in others deep phylogeny datasets the difference is biger. I see no general trend - therefore agreed that it is highly dataset dependent There are also not really \"tests\" out there, how much ML tree searches are reasonable and at the same time not too exhaustive (time-wise) - I found nly phylogenetic terraces & tree space papers which are great but i think not really implemented in packages. I am always afraid of \"local\" optima. I also did not find unambiguous literature stating, what difference in terms of logLH scores is actually meaningful. Might also depend on the dataset. Recently (see last post) handling a different dataset (many termites of only one family & onebarcode marker), the differences were by far smaller (about 0.00X difference) - here always the runs with the parsimony trees end up with a better score. Anyway, in most \"deeper\" phyl. atasets Iam dealing with its the opposite:) Cheers Karen ", "Dear Minh and Karen Thanks for the replies and discussions, Extracted from the Zhou et al. paper: \"a program was considered to perform better than another if it yielded a log-likelihood score that was more than 0.01 higher than the other.\" Can we extrapolate this conclusion to the difference in log-likelihoods in ML trees that started from random and parsimony trees?, e.g. a ML tree inferred from a set of X random starting trees whose logL is 0.01 greater that a ML tree inferred from a set of X parsimony trees Given that, I find it interesting to compare results from different starting trees... For instance, in raxml-ng the command --tree pars{50},rand{50} allows the program to start the search from 100 starting trees (50 parsimony + 50 random); does iq-tree have an analogous command? Kevin ", "in IQ-TREE if you did not add an additional command, its doing parsiony trees (and one BioNJ), see Minhs commen, for a random start tree you add -t RANDOM, for a BioNJ, -t BIONJ, see command reference :) http://www.iqtree.org/doc/Command-Reference -> -t Cheers Karen ", "Thanks Karen, Actually -t RANDOM starts the search with only one random tree, what I wanted to know is you can specify multiple trees to start the search (loading a file with e.g. 50 random trees, in fact -t <file> allows one to specify a user defined tree, but if the file has multiple trees, iq-tree will read only the first tree) kevin ", "-t RANDOM will do 100 random starting trees. Observe these lines the log: Generate random initial Yule-Harding tree... Log-likelihood of random tree: -26305.628 -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Generating 99 random trees... Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c2ee64a8-6ce1-4a85-99ec-3176bf4177ben%40googlegroups.com ", "Dear Minh Many thanks! that was really helpful, I was not aware that 100 random trees were generated, given that the documentation states '\" -t RANDOM starts tree search from completely random tree.\" I thought that only one random tree was generated. kevin "]}, "dkPg6fiM0s0": {"topic": "ERROR: Only one state is observed in alignment", "initializeDate": "May 4, 2018, 6:39:15 AM", "timeStamp": "May 4, 2018, 9:00:56 AM", "content": ["Hi Minh, I hope you are well in Downunder! I have just stumbled about a problem that IQ-Tree refuses to attempt to compute a tree for the following (simulated) alignment. (In that reconstruction the model of evolution used is JC.) 4 10 A TCCTTCTCTC B TTTCTTTCTC C TCCTTCTCTC D CCCTTTTCTC It finishes with the message: \u201cERROR: Only one state is observed in alignment\u201d I see of course that it has only 2 (not one) states, but still it should be possible to make IQ-Tree do the tree reconstruction. Do you have any suggestion how? Best wishes from Vienna, Heiko ", "Hi Heiko, I\u2019m good thanks! Just tested this alignment with latest version 1.6.4 and it went through. Which version did you use? Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "1.6.0 - the last version installed by a Minh at CIBIV ;) OK, I will update that one. Thanks and good might, Heiko "]}, "sSUWdi2OJAE": {"topic": "Re: IQtree v1.6beta", "initializeDate": "Jun 21, 2017, 6:54:46 AM", "timeStamp": "Jun 22, 2017, 12:23:27 PM", "content": ["Dear JPF, On Jun 20, 2017, at 8:41 PM, FLANDROIS JEAN-PIERRE < Jean-Pierr...@univ-lyon1.fr > wrote: Dear Minh, I am currently using FastTree for the phylogeny reconstruction in the leBIBI-QBPP webware. This tool is available here: https://umr5558-bibiserv.univ-lyon1.fr/lebibi/lebibi.cgi and has been described earlier ( http://www.biomedcentral.com/1471-2105/16/251 This website is used by microbiologists all around the world for phylogenetic positioning of SSU-rDNA (16S) of unknown bacteria. Looks like a useful tool! I have tested the -fast version of IQtree and set-up a new version of leBIBI that uses it. IQtree v1.6 with -fast looks promising with an impressive speed and good topological results (this is the only thing that I have tested so far, as compared to FastTree). Question: How did you obtain such a speed and a pretty good reconstruction ? Shall we say that it is an approximate ML approach like FastTree or is it a more conventional ML ? Thanks for your interests and testing -fast option of IQ-TREE. Yes, you can say that it is an approximate ML approach. With this fast mode IQ-TREE should be more or less as fast as FastTree. Our own benchmark here also showed that -fast option often returned better trees than FastTree. Here is how -fast option works: 1. Construct a maximum parsimony (MP) tree. 2. Optimize model parameters on the MP tree. 3. Compute ML distances based on optimized parameters and a BIONJ tree from the distances. 4. Improve the MP tree with nearest neighbor interchange search (NNI) under ML; denote the resulting tree as MP-NNI. 5. Improve the BIONJ tree with NNI; denote the resulting tree as BIONJ-NNI. 6. Report the final tree as the better of MP-NNI and BIONJ-NNI trees. In essence, this corresponds to the first 2 iterations of the IQ-TREE algorithm. That\u2019s why it is so fast, but of course cannot be compared with the full tree search of IQ-TREE. Moreover, since FastTree uses neighbor-joining and less thorough NNI, I expect that the -fast option will obtain tree that is at least as good as FastTree and the old PhyML-NNI. I will continue to check the results while waiting for your answer but I am really enthusiastic. Please keep us updated with your test results \u2014 It is always good to have an independent comparison study. Cheers, Minh Your sincerely JPF If you want to test leBIBI please run it without any sequence and the job will begin with a random test sequence (QBPP). ------------------------------------ Pr. emer. JP Flandrois MD, PhD Univ Lyon. LBBE Laboratoire de Biometrie et Biologie Evolutive - http://lbbe.univ-lyon1.fr/ Team/ Equipe Bioinformatique, Phylog\u00e9nie et G\u00e9nomique Evolutive ------------------------------------- jean-pierre.flandrois@ univ-lyon1.fr UMR 5558-LBBE. 43, Bd du 11 novembre 1918, B\u00e2timent Mendel 69622 Villeurbanne Cedex FRANCE (Univ Lyon, Universit\u00e9 Lyon 1, CNRS, UMR 5558 , \"Laboratoire de Biometrie et Biologie Evolutive\" LBBE) ----------------------------------- - Mobile/Cellular (only) : 33 6 63 22 55 00 https://umr5558-bibiserv.univlyon1.fr/flandrois/index.html -------------------------------------- Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Here is a rather good example. See the 3 figures. All the Rhodococcus SSU-rDNA(16S) sequences are extracted from leBIBI 'superstringent' database (+ 3 closely relatives sequences as external group=72 sequences) by using the PPF website https://umr5558-bibiserv.univ-lyon1.fr/lebibi/PPF-in.cgi The sequences are representatives of the species. The aligment is done by mafft and a soft trimming by BMGE. IQtree 'classic' is running with GTR+I+G4+FO, IQtree 'fast' with GTR+G4+FO (I is slowing down the process and when used, the results cannot be compared to FastTree's). FastTree options are gtr gamma cat 6. The results are the outputs PPF with width as support (>0.9), support being always SH-alrt. It is obvious that IQtree 'classic' and 'fast' are telling the same evolution story. FastTree is somewhat similar only. I have also done PhyML with IQtree 'classic' model and it is representing the same evolution as IQtree (not a surprise) with some topological divergences that are not well supported. It take 31,7; 2,6 and 3,6 seconds for IQtree 'classic'; 'fast' and FastTree (3 threads). JPF ", "Hi JPF, thanks for sharing this - great to see that fast IQ-TREE is that fast ;-) It would be good if you recompute the log-likelihood of different trees under one model (e.g. GTR+G+FO), and perform a topology test (e.g. Approximately unbiased test) to see if any tree is significantly worse or not. Cheers, Minh <RhodococcusIQtreeCLASSIC.png> <RhodococcusIQtreeFAST.png> <RhodococcusFASTTREE.png> ", "Hi Minh, That is not the same job... I got the results and many other out the PPF flavor of leBIBI (an experimental version of the currently working PPF -see the top menu of the leBIBI site). I have automatized the phylogeny process but for the AU test I have to download the trees and alignments in the same directory outside the server. So it is difficult to do this quickly as I have not noted the position of the files when I was working with. I will need also to change the IQtree \"classic\" model in the scripts... But I will do it. Cheers JPF ", "Here are the statistics for this case-study 1='classic' 2='fast' here we have the same model for both classic and fast: GTR+G4+FO USER TREES ---------- See /server/UsersSpace/ppfYaaWpP/AUTEST/classic.fst.trees for trees with branch lengths. Tree logL deltaL bp-RELL p-KH p-SH c-ELW p-AU ------------------------------------------------------------------------- 1 -6258.572 0.000 0.7004 + 0.6928 + 1.0000 + 0.6998 + 0.6928 + 2 -6270.234 11.662 0.2996 + 0.3072 + 0.3072 + 0.3002 + 0.3072 + deltaL : logL difference from the maximal logl in the set. bp-RELL : bootstrap proportion using RELL method (Kishino et al. 1990). p-KH : p-value of one sided Kishino-Hasegawa test (1989). p-SH : p-value of Shimodaira-Hasegawa test (2000). c-ELW : Expected Likelihood Weight (Strimmer & Rambaut 2002). p-AU : p-value of approximately unbiased (AU) test (Shimodaira, 2002). Plus signs denote the 95% confidence sets. Minus signs denote significant exclusion. All tests performed 10000 resamplings using the RELL method. TIME STAMP ---------- Date and time: Thu Jun 22 18:09:59 2017 Total CPU time used: 0.9201 seconds (0h:0m:0s) Total wall-clock time used: 2.286 seconds (0h:0m:2s) "]}, "TE9X6QLP3vQ": {"topic": "identifying which trees support node in gCF calculations", "initializeDate": "May 19, 2020, 4:11:21 AM", "timeStamp": "May 19, 2020, 5:05:35 AM", "content": ["Dear iQTree community, I just ran the Concordance factor statistics and I'm in love with them. I have 800 trees for a 23 taxon phylogeny, and gCF really demonstrate the actual support for specific nodes. I'm interested in assessing, for a given node, which of the trees do and do not support this. For example, here is my output ID gCF gCF_N gDF1 gDF1_N gDF2 gDF2_N gDFP gDFP_N gN Label Length 23 NA NA NA NA NA NA NA NA NA 0 24 49.8 379 2.23 17 0.92 7 47.04 358 761 1 0.742896 25 13.27 101 9.99 76 6.7 51 70.04 533 761 1 0.0962328 for node 25, I'm interested in identifying which are these 101 trees supporting this node, as well as the 533 trees that don't support it due to polyphyly. is there any way to get this level of breakdown per tree, among my set of trees? thanks, ", "Hi Chris, I think the option you are looking for is --cf-verbose. More details are here: https://groups.google.com/forum/#!topic/iqtree/tO4QA-8qjT4 Let us know here if it does (or doesn't) do what you need. Rob "]}, "FR5YZ9rsRzY": {"topic": "BUG: GHOST ultrafast bootstrap crash (using -bnni)", "initializeDate": "Dec 16, 2019, 11:05:31 AM", "timeStamp": "Dec 20, 2019, 7:20:34 AM", "content": ["Good day -- I am attempting to do ultrafast bootstrapping using GHOST. This may be a dumb thing to try, but I know you want to keep the program from crashing even if a user tries something dumb! Everything seemed to be going fine until the refining the ufboot trees. I am now realizing that \"-bnni\" might be the problem (it seems to have been an issue with other complex analyses, according to the release notes), so I am rerunning the analysis without that. Here is the relevant info: Version: IQ-TREE MPI multicore version 1.6.8 for Linux 64-bit built Nov 6 2019 Platform: Linux Command: iqtree-mpi -nt 20 -s loph-NON-75-JTT-TSEB-TC.phy -m JTT+FO*H11 -wspm -pre H11-loph-NON-JTT-75-TSEB-TC-boot -bb 1000 -bnni Random seed number: Seed: 108585 (Using SPRNG - Scalable Parallel Random Number Generator) I'm happy to answer any questions, send files, whatever you need. Thank you for this excellent resource and I hope this bug report isn't redundant and helps you (and me!). Cheers, Frank Anderson Last lines of log file: Refining ufboot trees with NNI 1 branch... ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 5 () ERROR: 6 () ERROR: 7 RateGamma::setNCategory(int) ERROR: 8 RateFree::setNCategory(int) ERROR: 9 RateFree::RateFree(int, double, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, PhyloTree*) ERROR: 10 PhyloTreeMixlen::initializeMixlen(double, bool) ERROR: 11 PhyloTreeMixlen::optimizeAllBranches(int, double, int) ERROR: 12 IQTree::optimizeBranches[abi:cxx11](int) ERROR: 13 IQTree::refineBootTrees() ERROR: 14 IQTree::doTreeSearch() ERROR: 15 runTreeReconstruction(Params&, IQTree*&) ERROR: 16 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 17 main() ERROR: 18 __libc_start_main() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: H11-loph-NON-JTT-75-TSEB-TC-boot.log ERROR: *** Alignment files (if possible) ", "Hi Frank, Can you please try the latest stable version 1.6.12? Someone reported a problem with -bnni option, which was fixed. I\u2019m not sure if this one is related, but please test this version and let me know how it goes. Thanks! Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e4cb1414-cf31-4b96-b04e-b6ad106c38dc%40googlegroups.com "]}, "G-Snw7zvK9A": {"topic": "Tree topology test results", "initializeDate": "Nov 8, 2016, 7:00:32 PM", "timeStamp": "Nov 10, 2016, 5:03:56 PM", "content": ["Hello, I have a question about the results of an analysis using the web server. Attached below are the alignment file and the tree file against which I would like to test. I can't seem to find the results of the tree topology tests in the .iqtree file. I've attached the .log and .iqtree file as well. If anyone can point me in the right direction it would be much appreciated! Thanks, Noah ", "Dear Noah, the problem is that your newick tree file has several syntax errors, like a comma missing before Colobus1 and Pongo1, and one too much bracket for clade (Gorilla\u2026). You can find the fixed tree file attached. Note that for the AU test, you need at least 2 trees in this -z file to perform the test. Minh ", "Dear Minh, Thank you much for your help. I am new to the newick format, and still learning the syntax, so your help is valuable. When running the program with your updated newick file the follwing error occurs: WARNING: 66 undefined/negative branch lengths are initialized with parsimony ERROR: Tree search does not work with initial multifurcating tree. Please specify `-n 0` to avoid this. So I dowloaded the newest version and ran as indicated: bin/iqtree -s AllMHCSeqs.fas -m TEST -alrt 1000 -te -zb 1000 -n 0 Species_tree_newick_NBL3_updated and received the following error: Reading input tree file -zb ... ERROR: File not found or incorrect input, pls check it again.-zb I also attempted to run it without the -zb option ( bin/iqtree -s AllMHCSeqs.fas -m TEST -alrt 1000 -te -n 0 Species_tree_newick_NBL3_updated) and got the following error: Reading input tree file -n ... ERROR: File not found or incorrect input, pls check it again.-n The updated newick file is in the bin/ directory so I'm not sure the problem? Thanks, Noah ", "Hi Noah, the tree file name has to be immediately after -te, so you need to reorder options like this: bin/iqtree -s AllMHCSeqs.fas -m TEST -alrt 1000 -te Species_tree_newick_NBL3_updated -zb 1000 -n 0 Anything comes right after -te is interpreted as tree file name. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Thanks for the reply. I'm still getting a similar error when running: bin/iqtree -s AllMHCSeqs.fas -m TEST -alrt 1000 -te Species_tree_newick_NBL3_updated -zb 1000 -n 0 I get the original error: Reading input tree file Species_tree_newick_NBL3_updated ... WARNING: 66 undefined/negative branch lengths are initialized with parsimony ERROR: Tree search does not work with initial multifurcating tree. Please specify `-n 0` to avoid this. despite the -n option being used. Thanks, Noah On Tuesday, November 8, 2016 at 4:00:32 PM UTC-8, Noah Simons wrote: ", "Hi Noah, It seems like, you want to put SH-aLRT supports onto the branches of a multi-furcating tree? But this test is not designed for multifurcating trees and will not work\u2026 You have to input a strictly bifurcating tree. I admit that his error message is a bit misleading though. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Minh, Thanks again, is there a way to run without the SH-aLRT supports? I'm really only interested in the SH and KH test results. I tried: bin/iqtree -s AllMHCSeqs.fas -m TEST -te Species_tree_newick_NBL3_updated -zb 1000 -n 0 but encountered the following error again: Reading input tree file Species_tree_newick_NBL3_updated ... WARNING: 66 undefined/negative branch lengths are initialized with parsimony ERROR: Tree search does not work with initial multifurcating tree. Please specify `-n 0` to avoid this. Thanks, Noah On Tuesday, November 8, 2016 at 4:00:32 PM UTC-8, Noah Simons wrote: "]}, "QgE5KHmqOpo": {"topic": "Calibrating tree with fossil date records", "initializeDate": "May 24, 2020, 11:37:48 AM", "timeStamp": "Aug 2, 2020, 10:50:19 PM", "content": ["Hello, It's great that iqtree can now perform datation analyses with lsd! I'm however not 100% sure about this approach for a classical datation of a species phylogeny with fossil data records, and would be glad for some precisions. According to the doc, we can definitely assign dates to the most recent common ancestors, but usually nobody has a real exact date for these nodes, but only a fossil calibration that can be used as the minimum age of the group (i.e. not an absolute exact date). How is it implemented in iqtree? With the date file of the doc, is it an exact or minimal age? Is it possible to set a minimal age of a mrca node instead of an exact age? LSD is mainly branded as a phylogenetic datation tool from tip-calibrated phylogenies, so I guess that if it can be really used as a replacement of BEAST or other Bayesian-based method for species phylogeny datation from the fossil record, it would be great to precise these points in the iqtree doc! Best regards, ", "Hi JJ, On 25 May 2020, at 1:37 am, JJ < monsie...@gmail.com > wrote: Hello, It's great that iqtree can now perform datation analyses with lsd! thanks ;-) I'm however not 100% sure about this approach for a classical datation of a species phylogeny with fossil data records, and would be glad for some precisions. According to the doc, we can definitely assign dates to the most recent common ancestors, but usually nobody has a real exact date for these nodes, but only a fossil calibration that can be used as the minimum age of the group (i.e. not an absolute exact date). How is it implemented in iqtree? You can use the format \"x:y\u201d to specify the date range from x to y. You can also use \u201cx:NA\u201d or \u201cNA:y\u201d to say that the upper bound or lower bound is not available, respectively. We will put that in the doc. With the date file of the doc, is it an exact or minimal age? Is it possible to set a minimal age of a mrca node instead of an exact age? see above LSD is mainly branded as a phylogenetic datation tool from tip-calibrated phylogenies, so I guess that if it can be really used as a replacement of BEAST or other Bayesian-based method for species phylogeny datation from the fossil record, it would be great to precise these points in the iqtree doc! Hien (CC) will be able to answer this question. My one comment here is that we never say it is a replacement for BEAST. When it takes ages for BEAST to run, then you can use LSD2. That\u2019s why we integrated LSD2, which is geared towards very big datasets. Cheers Minh Best regards, You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d41948d4-8138-44d2-9cd9-f14fc8e01dd9%40googlegroups.com ", "That's great, many thanks for the precise answer and many thanks for this wonderful software! Le lundi 25 mai 2020 03:01:39 UTC+2, Minh Bui a \u00e9crit : Hi JJ, On 25 May 2020, at 1:37 am, JJ < monsi...@gmail.com > wrote: Hello, It's great that iqtree can now perform datation analyses with lsd! thanks ;-) I'm however not 100% sure about this approach for a classical datation of a species phylogeny with fossil data records, and would be glad for some precisions. According to the doc, we can definitely assign dates to the most recent common ancestors, but usually nobody has a real exact date for these nodes, but only a fossil calibration that can be used as the minimum age of the group (i.e. not an absolute exact date). How is it implemented in iqtree? You can use the format \"x:y\u201d to specify the date range from x to y. You can also use \u201cx:NA\u201d or \u201cNA:y\u201d to say that the upper bound or lower bound is not available, respectively. We will put that in the doc. With the date file of the doc, is it an exact or minimal age? Is it possible to set a minimal age of a mrca node instead of an exact age? see above LSD is mainly branded as a phylogenetic datation tool from tip-calibrated phylogenies, so I guess that if it can be really used as a replacement of BEAST or other Bayesian-based method for species phylogeny datation from the fossil record, it would be great to precise these points in the iqtree doc! Hien (CC) will be able to answer this question. My one comment here is that we never say it is a replacement for BEAST. When it takes ages for BEAST to run, then you can use LSD2. That\u2019s why we integrated LSD2, which is geared towards very big datasets. Cheers Minh Best regards, You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "A simple question. In the x:y notation, is x the older and y the younger age or vice versa? Ted On Sunday, May 24, 2020 at 9:01:39 PM UTC-4, Minh Bui wrote: Hi JJ, On 25 May 2020, at 1:37 am, JJ < monsi...@gmail.com > wrote: Hello, It's great that iqtree can now perform datation analyses with lsd! thanks ;-) I'm however not 100% sure about this approach for a classical datation of a species phylogeny with fossil data records, and would be glad for some precisions. According to the doc, we can definitely assign dates to the most recent common ancestors, but usually nobody has a real exact date for these nodes, but only a fossil calibration that can be used as the minimum age of the group (i.e. not an absolute exact date). How is it implemented in iqtree? You can use the format \"x:y\u201d to specify the date range from x to y. You can also use \u201cx:NA\u201d or \u201cNA:y\u201d to say that the upper bound or lower bound is not available, respectively. We will put that in the doc. With the date file of the doc, is it an exact or minimal age? Is it possible to set a minimal age of a mrca node instead of an exact age? see above LSD is mainly branded as a phylogenetic datation tool from tip-calibrated phylogenies, so I guess that if it can be really used as a replacement of BEAST or other Bayesian-based method for species phylogeny datation from the fossil record, it would be great to precise these points in the iqtree doc! Hien (CC) will be able to answer this question. My one comment here is that we never say it is a replacement for BEAST. When it takes ages for BEAST to run, then you can use LSD2. That\u2019s why we integrated LSD2, which is geared towards very big datasets. Cheers Minh Best regards, You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Ted, x and y must be dates, not ages, and x < y. For example, f you specify -10:-5, it means that the ages are between 10 and 5 (in whatever unit) before present. So x is the older and y is the younger age. Cheers Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5c16b2c0-5e1e-440b-aed2-b8f61532ae9eo%40googlegroups.com ", "Minh: Thank you for making the notation clear! Besides the notation, it had not occurred to me that the time units are arbitrary. Ted ", "Minh, It seems like the x:NA notation is not working in 2.0.6, but NA:y does work. IQTREE throws this error before handing over the analysis to lsd: Reading date file test-dates.txt ... ERROR: Line 1: Expecting floating-point number, but found \"NA:-48.7\" instead The same date file with the NA:x notation is read in 2.0.4. Is it possible something got introduced after 2.0.4 that is not allowing this type of NA:x range? Thank you for taking a look! Matt On Wednesday, July 22, 2020 at 7:06:44 PM UTC-4, Ted Schultz wrote: Minh: Thank you for making the notation clear! Besides the notation, it had not occurred to me that the time units are arbitrary. Ted Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5c16b2c0-5e1e-440b-aed2-b8f61532ae9eo%40googlegroups.com ", "Hi Matt, Yes I confirm that this bug was recently introduced. thanks! It has been fixed and will be released in the next version. Cheers Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8442eb05-5e03-45ad-9047-f2c33982dadeo%40googlegroups.com "]}, "xOkiQL-oyKE": {"topic": "What happens when all sequences are missing in a partition interval?", "initializeDate": "Jan 8, 2020, 1:23:35 AM", "timeStamp": "Jan 10, 2020, 8:49:11 AM", "content": ["Hi there, I am a first time user of iqtree (v2.0). In my alignment file I want to estimate the local tree in 10kb windows along the genome. But in some part of the genome, due to mapping qualities, all the nucleotides are masked as \"N\" for all samples. When I use the -S option, the program always crash when dealing with such regions. I have also tried including or excluding the \"-keep_empty_seq\" tag, but that didn't change the failure. The error message is: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT Here is the log-file: IQ-TREE multicore version 2.0-rc1 for Linux 64-bit built Nov 21 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: holy7c24602.rc.fas.harvard.edu (AVX512, FMA3, 188 GB RAM) Command: iqtree -s /n/mallet_lab/txiong/Research/2019_Achillides_Sequencing/03_call.bcftools/vcfs.Pmaackii/Joint.chr.filtered.hard.SNP.1.phased.WH.SP.biA.noMiss.noMap.noCDS.withNO_VAR.masked.fasta -S /n/mallet_lab/txiong/Research/2019_Achillides_Sequencing/04_trees.iqtree/LocalTrees.w10000.s10000/iqtree.partition_files/Partitions/test.partition --prefix test -m MFP -o Pbianor_Ref_HiC_scaffold_1 -keep_empty_seq Seed: 177812 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Jan 8 01:13:29 2020 Kernel: AVX+FMA - 1 threads (1 CPU cores detected) Reading partition model file /n/mallet_lab/txiong/Research/2019_Achillides_Sequencing/04_trees.iqtree/LocalTrees.w10000.s10000/iqtree.partition_files/Partitions/test.partition ... Reading alignment file /n/mallet_lab/txiong/Research/2019_Achillides_Sequencing/03_call.bcftools/vcfs.Pmaackii/Joint.chr.filtered.hard.SNP.1.phased.WH.SP.biA.noMiss.noMap.noCDS.withNO_VAR.masked.fasta ... Fasta format detected Alignment most likely contains DNA/RNA sequences WARNING: 6309893 sites contain only gaps or ambiguous characters. Alignment has 23 sequences with 9469303 columns, 58156 distinct patterns 81359 parsimony-informative, 83448 singleton sites, 9304496 constant sites WARNING: Some sequence names are changed as follows: TXSC20180711006-0-HiC_scaffold_1:0-9469303 -> TXSC20180711006-0-HiC_scaffold_1_0-9469303 TXSC20180711011-0-HiC_scaffold_1:0-9469303 -> TXSC20180711011-0-HiC_scaffold_1_0-9469303 TXSC20180713001-0-HiC_scaffold_1:0-9469303 -> TXSC20180713001-0-HiC_scaffold_1_0-9469303 TXSC20180713007-0-HiC_scaffold_1:0-9469303 -> TXSC20180713007-0-HiC_scaffold_1_0-9469303 TXSC20180713008-0-HiC_scaffold_1:0-9469303 -> TXSC20180713008-0-HiC_scaffold_1_0-9469303 TXSC20180714006-0-HiC_scaffold_1:0-9469303 -> TXSC20180714006-0-HiC_scaffold_1_0-9469303 TXSC20180714008-0-HiC_scaffold_1:0-9469303 -> TXSC20180714008-0-HiC_scaffold_1_0-9469303 TXSC20180718001-0-HiC_scaffold_1:0-9469303 -> TXSC20180718001-0-HiC_scaffold_1_0-9469303 TXSC20180718009-0-HiC_scaffold_1:0-9469303 -> TXSC20180718009-0-HiC_scaffold_1_0-9469303 TXSC20180718016-0-HiC_scaffold_1:0-9469303 -> TXSC20180718016-0-HiC_scaffold_1_0-9469303 TXSC20180727005-0-HiC_scaffold_1:0-9469303 -> TXSC20180727005-0-HiC_scaffold_1_0-9469303 TXSC20180711006-1-HiC_scaffold_1:0-9469303 -> TXSC20180711006-1-HiC_scaffold_1_0-9469303 TXSC20180711011-1-HiC_scaffold_1:0-9469303 -> TXSC20180711011-1-HiC_scaffold_1_0-9469303 TXSC20180713001-1-HiC_scaffold_1:0-9469303 -> TXSC20180713001-1-HiC_scaffold_1_0-9469303 TXSC20180713007-1-HiC_scaffold_1:0-9469303 -> TXSC20180713007-1-HiC_scaffold_1_0-9469303 TXSC20180713008-1-HiC_scaffold_1:0-9469303 -> TXSC20180713008-1-HiC_scaffold_1_0-9469303 TXSC20180714006-1-HiC_scaffold_1:0-9469303 -> TXSC20180714006-1-HiC_scaffold_1_0-9469303 TXSC20180714008-1-HiC_scaffold_1:0-9469303 -> TXSC20180714008-1-HiC_scaffold_1_0-9469303 TXSC20180718001-1-HiC_scaffold_1:0-9469303 -> TXSC20180718001-1-HiC_scaffold_1_0-9469303 TXSC20180718009-1-HiC_scaffold_1:0-9469303 -> TXSC20180718009-1-HiC_scaffold_1_0-9469303 TXSC20180718016-1-HiC_scaffold_1:0-9469303 -> TXSC20180718016-1-HiC_scaffold_1_0-9469303 TXSC20180727005-1-HiC_scaffold_1:0-9469303 -> TXSC20180727005-1-HiC_scaffold_1_0-9469303 Gap/Ambiguity Composition p-value 1 Pbianor_Ref_HiC_scaffold_1 66.64% failed 0.00% 2 TXSC20180711006-0-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 3 TXSC20180711011-0-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 4 TXSC20180713001-0-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 5 TXSC20180713007-0-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 6 TXSC20180713008-0-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 7 TXSC20180714006-0-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 8 TXSC20180714008-0-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 9 TXSC20180718001-0-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 10 TXSC20180718009-0-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 11 TXSC20180718016-0-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 12 TXSC20180727005-0-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 13 TXSC20180711006-1-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 14 TXSC20180711011-1-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 15 TXSC20180713001-1-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 16 TXSC20180713007-1-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 17 TXSC20180713008-1-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 18 TXSC20180714006-1-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 19 TXSC20180714008-1-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 20 TXSC20180718001-1-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 21 TXSC20180718009-1-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 22 TXSC20180718016-1-HiC_scaffold_1_0-9469303 66.64% failed 0.00% 23 TXSC20180727005-1-HiC_scaffold_1_0-9469303 66.64% failed 0.00% WARNING: 23 sequences contain more than 50% gaps/ambiguity **** TOTAL 66.64% 23 sequences failed composition chi2 test (p-value<5%; df=3) Partition file is not in NEXUS format, assuming RAxML-style partition file... Subset Type Seqs Sites Infor Invar Model Name DNA 10000 10000 GTR interval1 WARNING: No variant sites in partition interval1 Unlinked 23 total sequences Creating fast initial parsimony tree by random order stepwise addition... 0.001 seconds, parsimony score: 0 (based on 0 sites) Perform fast likelihood tree search using GTR model... Estimate model parameters (epsilon = 5.000) Perform nearest neighbor interchange... Estimate model parameters (epsilon = 1.000) Log-likelihood: 0.000 Time for fast ML tree search: 0.002 seconds NOTE: ModelFinder requires 0 MB RAM! Selecting individual models for 1 charsets using BIC... No. Model Score TreeLen Charset 1 JC 396.045 0.000 interval1 Full partition model BIC score: 396.045 (LnL: 0.000 df:43) Partition information was printed to test.best_scheme.nex Partition information in Raxml format was printed to test.best_scheme All model information printed to test.model.gz CPU time for ModelFinder: 0.020 seconds (0h:0m:0s) Wall-clock time for ModelFinder: 0.032 seconds (0h:0m:0s) NOTE: 0 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.100) Partition interval1 / Model: JC / df: 43 / LogL: 0.000 Optimal log-likelihood: 0.000 -------------------------------------------------------------------- | SEPARATE TREE SEARCH FOR PARTITIONS | -------------------------------------------------------------------- Partition interval1 / Iterations: 102 / LogL: 0 / Time: 0h:0m:0s -------------------------------------------------------------------- | FINALIZING TREE SEARCH | -------------------------------------------------------------------- Performs final model parameters optimization Estimate model parameters (epsilon = 0.010) Partition interval1 / Model: JC / df: 43 / LogL: 0.000 Optimal log-likelihood: 0.000 Partition information was printed to test.best_model.nex BEST SCORE FOUND : 0.000 Total tree length: 0.000 Total number of iterations: 0 CPU time used for tree search: 0.138 sec (0h:0m:0s) Wall-clock time used for tree search: 0.144 sec (0h:0m:0s) Total CPU time used: 0.145 sec (0h:0m:0s) Total wall-clock time used: 0.158 sec (0h:0m:0s) ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: test.log ERROR: *** Alignment files (if possible) ", "Hello! the \"-keep_empty_seq\" option is used to keep sequence with no information (only contain gaps or N). Such sequences do not provide any information, while excluding them speeds up computation. Empty/ambiguous sites are excluded by default. Therefore, in case, when the whole partition is empty/ambiguous, essentially, there is no information to infer a tree. Just exclude those partitions with only N's from the partition file. I hope this helps. Cheers, Olga ", "----------------- Tianzhu Xiong Ph.D. Candidate, Mallet Lab Department of Organismic and Evolutionary Biology Harvard University 16 Divinity Ave. Biological Labs Cambridge, MA 02138 ---------- Forwarded message --------- From: Xiong, Tianzhu txi...@g.harvard.edu Date: Wed, Jan 8, 2020 at 5:44 PM Subject: Re: [iqtree] What happens when all sequences are missing in a partition interval? To: Olga Chernomor < o.che...@gmail.com Hi Olga, Thank you for the clarification, but I tried a dummy example with 9 missing sites and 1 variable site, e.g. , >sp1 NNNNNNNNNA >sp2 NNNNNNNNNT >sp3 NNNNNNNNNT >sp4 NNNNNNNNNA >sp5 NNNNNNNNNA >sp6 NNNNNNNNNA combined with a one-interval partition file with the following line: DNA, part1 = 1-10 It seems that if I use the ''-p\" option for the partition file (i.e. estimate the whole tree based on partitions), the program could go through and produce a sensible tree file. But if I use the \"-S\" option, which asks the program to infer a tree for each interval in the partition, there would be ERROR pointing to a segmentation fault. Theoretically, since I only have one single partition for the 10 sites, both options should ask the program to do the same thing. =========== Two log files are as follows: =========== For the -S option: IQ-TREE multicore version 2.0-rc1 for Linux 64-bit built Nov 21 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: holy7c26502.rc.fas.harvard.edu (AVX512, FMA3, 188 GB RAM) Command: iqtree -s trial.fasta -m MFP --prefix trial01 -mredo -T 1 -S trial.partition Seed: 902463 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Jan 8 22:41:03 2020 Kernel: AVX+FMA - 1 threads (2 CPU cores detected) HINT: Use -nt option to specify number of threads because your CPU has 2 cores! HINT: -nt AUTO will automatically determine the best number of threads to use. Reading partition model file trial.partition ... Reading alignment file trial.fasta ... Fasta format detected Alignment most likely contains DNA/RNA sequences WARNING: 9 sites contain only gaps or ambiguous characters. Alignment has 6 sequences with 10 columns, 2 distinct patterns 1 parsimony-informative, 0 singleton sites, 9 constant sites Gap/Ambiguity Composition p-value 1 sp1 90.00% passed 78.86% 2 sp2 90.00% passed 50.08% 3 sp3 90.00% passed 50.08% 4 sp4 90.00% passed 78.86% 5 sp5 90.00% passed 78.86% 6 sp6 90.00% passed 78.86% WARNING: 6 sequences contain more than 50% gaps/ambiguity **** TOTAL 90.00% 0 sequences failed composition chi2 test (p-value<5%; df=3) Partition file is not in NEXUS format, assuming RAxML-style partition file... Subset Type Seqs Sites Infor Invar Model Name 1 DNA 6 10 1 9 GTR part1 Unlinked 6 total sequences Creating fast initial parsimony tree by random order stepwise addition... 0.001 seconds, parsimony score: 1 (based on 1 sites) Perform fast likelihood tree search using GTR+I+G model... Estimate model parameters (epsilon = 5.000) Perform nearest neighbor interchange... Estimate model parameters (epsilon = 1.000) Log-likelihood: -2.360 Time for fast ML tree search: 0.003 seconds NOTE: ModelFinder requires 0 MB RAM! Selecting individual models for 1 charsets using BIC... No. Model Score TreeLen Charset 1 JC 26.268 10.000 part1 Full partition model BIC score: 26.268 (LnL: -2.773 df:9) Partition information was printed to trial01.best_scheme.nex Partition information in Raxml format was printed to trial01.best_scheme All model information printed to trial01.model.gz CPU time for ModelFinder: 0.144 seconds (0h:0m:0s) Wall-clock time for ModelFinder: 0.153 seconds (0h:0m:0s) NOTE: 0 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.100) Partition part1 / Model: JC / df: 9 / LogL: -2.773 Optimal log-likelihood: -2.773 -------------------------------------------------------------------- | SEPARATE TREE SEARCH FOR PARTITIONS | -------------------------------------------------------------------- Partition part1 / Iterations: 102 / LogL: -2.7726 / Time: 0h:0m:0s -------------------------------------------------------------------- | FINALIZING TREE SEARCH | -------------------------------------------------------------------- Performs final model parameters optimization Estimate model parameters (epsilon = 0.010) Partition part1 / Model: JC / df: 9 / LogL: -2.773 Optimal log-likelihood: -2.773 Partition information was printed to trial01.best_model.nex BEST SCORE FOUND : -2.773 Total tree length: 10.000 Total number of iterations: 0 CPU time used for tree search: 0.036 sec (0h:0m:0s) Wall-clock time used for tree search: 0.037 sec (0h:0m:0s) Total CPU time used: 0.042 sec (0h:0m:0s) Total wall-clock time used: 0.045 sec (0h:0m:0s) ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: trial01.log ERROR: *** Alignment files (if possible) For the -p option: IQ-TREE multicore version 2.0-rc1 for Linux 64-bit built Nov 21 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: holy7c26502.rc.fas.harvard.edu (AVX512, FMA3, 188 GB RAM) Command: iqtree -s trial.fasta -m MFP --prefix trial01 -mredo -T 1 -p trial.partition Seed: 58477 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Jan 8 22:42:01 2020 Kernel: AVX+FMA - 1 threads (2 CPU cores detected) HINT: Use -nt option to specify number of threads because your CPU has 2 cores! HINT: -nt AUTO will automatically determine the best number of threads to use. Reading partition model file trial.partition ... Reading alignment file trial.fasta ... Fasta format detected Alignment most likely contains DNA/RNA sequences WARNING: 9 sites contain only gaps or ambiguous characters. Alignment has 6 sequences with 10 columns, 2 distinct patterns 1 parsimony-informative, 0 singleton sites, 9 constant sites Gap/Ambiguity Composition p-value 1 sp1 90.00% passed 78.86% 2 sp2 90.00% passed 50.08% 3 sp3 90.00% passed 50.08% 4 sp4 90.00% passed 78.86% 5 sp5 90.00% passed 78.86% 6 sp6 90.00% passed 78.86% WARNING: 6 sequences contain more than 50% gaps/ambiguity **** TOTAL 90.00% 0 sequences failed composition chi2 test (p-value<5%; df=3) Partition file is not in NEXUS format, assuming RAxML-style partition file... Subset Type Seqs Sites Infor Invar Model Name 1 DNA 6 10 1 9 GTR part1 Degree of missing data: 0.000 Info: multi-threading strategy over partitions NOTE: sp4 is identical to sp1 but kept for subsequent analysis NOTE: sp3 is identical to sp2 but kept for subsequent analysis NOTE: 2 identical sequences (see below) will be ignored for subsequent analysis NOTE: sp5 (identical to sp1) is ignored but added at the end NOTE: sp6 (identical to sp1) is ignored but added at the end Alignment was printed to trial01.uniqueseq.phy For your convenience alignment with unique sequences printed to trial01.uniqueseq.phy Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.000 seconds Perform fast likelihood tree search using GTR+I+G model... Estimate model parameters (epsilon = 5.000) Initial log-likelihood: -3.878 Current log-likelihood at step 1: -2.153 Parameters optimization took 0 rounds (0.002 sec) WARNING: Estimated model parameters are at boundary that can cause numerical instability! Perform nearest neighbor interchange... Estimate model parameters (epsilon = 1.000) Initial log-likelihood: -2.153 Current log-likelihood at step 1: -2.088 Partition-specific rates: 1.000 Parameters optimization took 0 rounds (0.001 sec) WARNING: Estimated model parameters are at boundary that can cause numerical instability! Time for fast ML tree search: 0.003 seconds NOTE: ModelFinder requires 0 MB RAM! Selecting individual models for 1 charsets using BIC... No. Model Score TreeLen Charset 1 JC 7.848 9.887 part1 Full partition model BIC score: 17.058 (LnL: -2.773 df:5) Partition information was printed to trial01.best_scheme.nex Partition information in Raxml format was printed to trial01.best_scheme All model information printed to trial01.model.gz CPU time for ModelFinder: 0.087 seconds (0h:0m:0s) Wall-clock time for ModelFinder: 0.099 seconds (0h:0m:0s) NOTE: 0 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.100) Initial log-likelihood: -2.773 Current log-likelihood at step 1: -2.773 Partition-specific rates: 1.000 Parameters optimization took 0 rounds (0.000 sec) Computing ML distances based on estimated model parameters... 0.000 sec WARNING: Some pairwise ML distances are too long (saturated) Computing BIONJ tree... 0.003 seconds Log-likelihood of BIONJ tree: -2.773 -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Generating 99 parsimony trees... 0.009 second Computing log-likelihood of 2 initial trees ... 0.000 seconds Current best score: -2.773 Do NNI search on 3 best initial trees Finish initializing candidate tree set (3) Current best tree score: -2.773 / CPU time: 0.011 Number of iterations: 3 -------------------------------------------------------------------- | OPTIMIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Iteration 10 / LogL: -4.159 / Time: 0h:0m:0s Iteration 20 / LogL: -4.159 / Time: 0h:0m:0s Iteration 30 / LogL: -4.159 / Time: 0h:0m:0s (0h:0m:0s left) Iteration 40 / LogL: -2.773 / Time: 0h:0m:0s (0h:0m:0s left) Iteration 50 / LogL: -4.159 / Time: 0h:0m:0s (0h:0m:0s left) Iteration 60 / LogL: -4.159 / Time: 0h:0m:0s (0h:0m:0s left) Iteration 70 / LogL: -4.159 / Time: 0h:0m:0s (0h:0m:0s left) Iteration 80 / LogL: -4.159 / Time: 0h:0m:0s (0h:0m:0s left) Iteration 90 / LogL: -4.159 / Time: 0h:0m:0s (0h:0m:0s left) Iteration 100 / LogL: -4.159 / Time: 0h:0m:0s (0h:0m:0s left) TREE SEARCH COMPLETED AFTER 101 ITERATIONS / Time: 0h:0m:0s -------------------------------------------------------------------- | FINALIZING TREE SEARCH | -------------------------------------------------------------------- Performs final model parameters optimization Estimate model parameters (epsilon = 0.010) Initial log-likelihood: -2.773 Current log-likelihood at step 1: -2.773 Partition-specific rates: 1.000 Parameters optimization took 0 rounds (0.000 sec) Partition information was printed to trial01.best_model.nex BEST SCORE FOUND : -2.773 Total tree length: 10.000 Total number of iterations: 101 CPU time used for tree search: 0.022 sec (0h:0m:0s) Wall-clock time used for tree search: 0.024 sec (0h:0m:0s) Total CPU time used: 0.028 sec (0h:0m:0s) Total wall-clock time used: 0.038 sec (0h:0m:0s) Analysis results written to: IQ-TREE report: trial01.iqtree Maximum-likelihood tree: trial01.treefile Likelihood distances: trial01.mldist Best partitioning scheme: trial01.best_scheme.nex in RAxML format: trial01.best_scheme Screen log file: trial01.log Date and Time: Wed Jan 8 22:42:01 2020 ----------------- Tianzhu Xiong Ph.D. Candidate, Mallet Lab Department of Organismic and Evolutionary Biology Harvard University 16 Divinity Ave. Biological Labs Cambridge, MA 02138 You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/15c080fd-ea6b-4ea9-b2f5-783d7c27d488%40googlegroups.com ", "Hi Tianzhu, Indeed this looks like a bug with the new -S option. Thanks for the report and I\u2019ll have a look. However, you have here only a single partition. So I don\u2019t know why you have to specify a partition model\u2026 just doing a non-partitioned analysis is enough here. Cheers, Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CADBWwQkY00Y1OOrrzL1sBLTt8VGkr1XA8v9v4p8w3tdhD6tX3A%40mail.gmail.com "]}, "v9IwccRtBCI": {"topic": "Re: [iqtree] Does the phylogenetic tree making tool IQTREE use evolutionary placement algorithm?", "initializeDate": "Feb 24, 2021, 6:25:24 PM", "timeStamp": "Feb 24, 2021, 6:25:24 PM", "content": ["For record, already replied On 24 Feb 2021, at 4:18 pm, Samragi Chatim < samragi...@gmail.com > wrote: For my master thesis I am conducting a phylogenetic research and for this I'm using tools like MEGA, IQTREE, FigTree, etc to make a phylogenetic tree. I wanted to know if IQTREE integrates the evolutionary placement algorithm (EPA) when it calculates a phylogenetic tree You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/a8eff9ae-c5cd-42e1-8401-1277e94f46bbn%40googlegroups.com "]}, "wzKWMW7dQrc": {"topic": "Can't estimate best number of threads in a server computer", "initializeDate": "Apr 20, 2021, 12:28:43 PM\u00a0(8 days ago)\u00a0", "timeStamp": "Apr 21, 2021, 8:31:05 AM\u00a0(7 days ago)\u00a0", "content": ["Hi, I'm trying to estimate the best number of threads for my analysis using the -nt AUTO command in a server computer with 320 CPU cores. The issue is that it get stuck in the step \"Creating fast initial parsimony tree by random order stepwise addition...\" and during this process it is using all 320 threads of the server. Since the server is shared between all researchers I was not able to let it finish the estimation of best number of threads. Alternatively I could run on 50 threads, for exemple, however it is known that splitting the run among too many threads can slow down it. Can someone help me here? Thanks, Tiago ", "Hi Tiago, Before running IQ-TREE please set the environment variable OMP_NUM_THREADS. Under Linux it\u2019s something like: export OMP_NUM_THREADS=2 And then the parsimony step will use exactly that many number of threads. Once this step finishes, IQ-TREE will detect the optimal thread number and overwrite this variable. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/dbaee4c6-d40e-467a-9803-db1295f394a5n%40googlegroups.com ", "Thanks so much, Minh! "]}, "sA_CP8QfJsw": {"topic": ".xmfa aligment as input?", "initializeDate": "Jan 5, 2017, 10:47:52 AM", "timeStamp": "Mar 5, 2020, 8:38:48 PM", "content": ["Hi everyone, Does anyone knows how to use .xmfa files in Iqtree? After inputting my alignment, it shows me a message: \"error found in line 1, column 16 (file position 15). Expecting Nexus to be the first token in the file, but found #Formatversion instead\" Thanks in anticipation, ", "Hi, I don\u2019t think that IQ-TREE supports this file format. The valid alignment formats are Phylip, Fasta, ClustalW or Nexus. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "did you find a way to get this to work? can you convert xmfa alignment files to a usable format? thanks. ", "I just saw this website, might or might not help? https://www.biostars.org/p/119721/ You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/fe323bec-cbe9-486d-8d3c-2a570e9ddf18%40googlegroups.com ", "my input alignment file is in FASTA formate iqtree tree show error of file not find please tell me how to resolve it On Friday, January 6, 2017 at 3:36:04 AM UTC+5, Bui Quang Minh wrote: Hi, I don\u2019t think that IQ-TREE supports this file format. The valid alignment formats are Phylip, Fasta, ClustalW or Nexus. Cheers, Minh On Jan 5, 2017, at 4:47 PM, xant < jibr...@gmail.com > wrote: Hi everyone, Does anyone knows how to use .xmfa files in Iqtree? After inputting my alignment, it shows me a message: \"error found in line 1, column 16 (file position 15). Expecting Nexus to be the first token in the file, but found #Formatversion instead\" Thanks in anticipation, You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi there, It looks like you don\u2019t specify the right path to the file in the -s option\u2026 Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/221a88a1-06d2-4db1-93b6-3cc355c65937%40googlegroups.com "]}, "fHhqR4Ys5rk": {"topic": "ERROR- GHOST model report errow with 5 classes", "initializeDate": "Jul 3, 2018, 10:57:50 PM", "timeStamp": "Jul 5, 2018, 4:32:02 AM", "content": ["Dear Developers, I tried different classes using GHOST model implemented in v1.6.6. With small number of classes <=4, the program worked. But when I tried 5 classes, it reported the following errors: numerical underflow (lh-derivative-mixlen). Run again with the safe likelihood kernel via '-safe' option My data is: 395 sequences, ~1500 nucleotides each Would you please help? Thank you! Giap Nguyen ", "Hi Giap, When using complex mixture models with high number of parameters, such as GHOST, it is important to make sure you have enough data to estimate so many parameters. We recommend having at least n > 10K, where n is the number of sites in your alignment and K is the number of free parameters in your model. If that is not possible you should certainly have n >> K, by as much as possible. Since you have 395 sequences in your dataset, you have approximately 800 free parameters per class. As you only have 1500 sites you want to be estimating around 150 parameters at most. You really shouldn\u2019t put too much faith in the results you obtain, even for small number of classes when GHOST runs successfully. I would recommend significantly reducing the number of taxa in your dataset, increasing the number of sites in your alignment, or both. Hope this helps, Stephen Stephen Crotty, PhD Centre for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC 5, Ebene 1 A-1030 Vienna, Austria Email: stephen...@univie.ac.at You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Stephen, Thank you for your answer. Do you know any heterotachy model which is suitable for the data like mine? Best regards, Giap Nguyen ", "Hi Giap, No unfortunately I don\u2019t. To be honest, even fitting a homogenous model is a little dubious with your dataset in my opinion. With only one tree you are estimating around 800 parameters with only 1500 sites. I am not sure how reliable your parameter estimates would be. I presume that you don\u2019t have access to more sites for your taxa, so I would strongly recommend you sample taxa from your alignment. If you give it careful thought, depending on the questions you want to answer, I\u2019m sure you can find many of the 395 sequences that are either redundant or just not very interesting. In this case, the fewer taxa you have in your alignment the more reliable your phylogenetic estimates will be. Cheers, Stephen Stephen Crotty, PhD Centre for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC 5, Ebene 1 A-1030 Vienna, Austria Email: stephen...@univie.ac.at "]}, "ukBaJGm0_N0": {"topic": "GHOST model of IQTREE in CIPRES server?", "initializeDate": "Aug 15, 2020, 1:43:27 AM", "timeStamp": "Aug 20, 2020, 12:05:35 AM", "content": ["Dear Experts, I want to know that is it possible to do tree searches using the GHOST model of IQTREE in CIPRES? If possible please guide me on how to do that? Thanks, Debajyoti ", "Hi Debajyoti, This is the question for the CIPRES maintainer https://groups.google.com/g/cipres-science-gateway-users Chers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/92c138b4-c43e-4335-bcb8-460b7fff0f49o%40googlegroups.com "]}, "qaq2oE27fXI": {"topic": "HKY+G4", "initializeDate": "Jan 22, 2018, 8:40:54 AM", "timeStamp": "Jan 22, 2018, 7:48:36 PM", "content": ["Dear all, I have a short question on the definition of the HKY+G4 abbreviation in the outcome of the model test (-m MFS option), since it is not clearly stated i the manual/tutorial what it exactly means. May I interpret it as a mixed substitution model with HKY and four gamma rate model? I am looking forward for your answer. regards, Thierry ", "Hi Thierry, To be precise, I would formulate something like this: ModelFinder determined HKY [ Hasegawa, Kishino and Yano, 1985 ] with a Gamma rate heterogeneity across sites [Yang, 1994] as the best fit model to the data. The citations are listed here http://www.iqtree.org/doc/Substitution-Models Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "t9YapnNnzZw": {"topic": "Bug: error when adding date file", "initializeDate": "May 7, 2020, 10:58:54 PM", "timeStamp": "May 10, 2020, 8:11:43 PM", "content": ["Hiya, I have run IQtree with my 45 sample, ~15K SNP dataset and it worked well. I then tried to add in the DATE_FILE and do the 'Inferring time tree with tip dates' analysis. The manuals says \" Note that it is not required to have dates for all tips\" but when the program got to my DATE_FILE it didn't like the sample names without dates and threw an error. So, I then removed the 3 samples without dates from the phylip and DATE_FILE and tried again, and got an error (pasted below, and logfile attached). Any suggestions/help would be appreciated, cheers Emma Reading date file DATE_FILE2.txt ... 42 dates extracted ERROR: timetree.cpp:204: void writeDate(std::__1::string, std::__1::ostream &, StrVector &): Assertion `0 && \"Error writing date stream\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 2 _sigtramp() ERROR: 5 writeDate(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::basic_ostream<char, std::__1::char_traits<char> >&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > >&) ERROR: 6 runLSD2(PhyloTree*) ERROR: 7 runPhyloAnalysis(Params&, Checkpoint*) ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: bwtimetree_out.log ERROR: *** Alignment files (if possible) Abort trap: 6 ", "Hi Emma, It seems like something wrong with your dates. Can you please check the format again, e.g. that the dates are in YYYY-MM-DD format (ISO)? The error message is helpful though. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4fe4b2c9-8160-4e81-b361-1068bf122ce6%40googlegroups.com <bwtimetree_out.log> "]}, "K7nbOd6cVhc": {"topic": "GPU Support", "initializeDate": "Apr 23, 2021, 6:27:58 PM\u00a0(4 days ago)\u00a0", "timeStamp": "Apr 24, 2021, 2:33:27 AM\u00a0(4 days ago)\u00a0", "content": ["Does IQ-Tree support GPU runs yet? ", "No. There are some people looking at that, but it is a lot of work, and it might be a long time coming. The more kinds of model are supported, the harder it is to port the likelihood calculations to a GPU. And IQTree supports a lot of different sorts of model. On 24 Apr 2021, at 8:27 am, Simone Gable < smg...@nau.edu > wrote: Does IQ-Tree support GPU runs yet? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2d81638f-da38-426a-b8f1-df1ae6abe976n%40googlegroups.com "]}, "O8Jw3Vqt81Q": {"topic": "bootstrap value missing", "initializeDate": "Aug 18, 2020, 8:19:46 AM", "timeStamp": "Aug 20, 2020, 7:01:16 AM", "content": ["Hello everyone, I think I have a problem with bootstrap values in some trees made using fish nsbi sequences. In all my trees, after I rooted using the outgroup, the first node after the root (which is normal that it has not the bs value) always misses its bootstrap value. Is it an issue or is it normal? I've attached the iqtree file of the simplest tree and also the tree visualized using FigTree (the outgroup is HM392103.1). I hope I made myself clear, sorry if this question seems dumb to you all. Alex ", "Dear Alex, the reason is that the mentioned bootstrap value is 100 by default, because it separates only one species from the rest and is present in all trees. If you root the tree with an outgroup containing more than one species, the bootstrap value will be present. Best wishes, Olga You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2500af6f-f5c7-4772-890a-2ee49c383aaco%40googlegroups.com <seq_SL_coi_23_05_20_aligned.fasta.iqtree> <Schermata 2020-08-18 alle 14.12.31.png> ", "Thank you Olga for the reply. But maybe I did not make myself clear. My issue does not regard the branch which leads to Rutilus rutilus since it is the point in which I rooted the tree, but the node which leads to KJ552335 which is the most basal group and it does not have any bootstrap value ", "Hi Alex, sorry, I misread the original message. Then this is an issue of visualisation actually. Just try rooting with other species to see the support for two taxa (KJ552335, HM392103), or you can also look it up in the file itself. Here is a different rooting of your tree, you can see that the bootstrap for (KJ552335, HM392103) is 92. ", "Hey again:) even more simple, the bootstrap I mentioned (support of clustering KJ552335 with HM392103) is actually the one stated for the next clade. So it is the visualisation, that tricks the mind:) To reply your original message, it is normal that you do not observe the value right after the root. Sorry for the messy replies. Cheers, Olga On 20.08.2020, at 12:53, Olga Chernomor < o.che...@gmail.com > wrote: Hi Alex, sorry, I misread the original message. Then this is an issue of visualisation actually. Just try rooting with other species to see the support for two taxa (KJ552335, HM392103), or you can also look it up in the file itself. Here is a different rooting of your tree, you can see that the bootstrap for (KJ552335, HM392103) is 92. <sFtov-Sa4EqVphvN-tX0Tw.pdf> Cheers, Olga On 19.08.2020, at 18:51, Alex Cussigh < dottor...@gmail.com > wrote: Thank you Olga for the reply. But maybe I did not make myself clear. My issue does not regard the branch which leads to Rutilus rutilus since it is the point in which I rooted the tree, but the node which leads to KJ552335 which is the most basal group and it does not have any bootstrap value You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/36db63e5-d34c-4bd2-bf35-fafba28b39a7o%40googlegroups.com "]}, "pAqCqoBRIQ8": {"topic": "AU test clarification", "initializeDate": "Jan 8, 2021, 9:02:26 AM", "timeStamp": "Feb 3, 2021, 6:01:01 PM", "content": ["Hi, Newbie here. I'd be grateful if could you clarify some points about the AU test in IQTree (I am using v2.1.2): 1. If I want to test multiple constraints, like in 5.7 of the manual, must I 'process' my constraint files first to produce .treefile, which are then concatenated into a .treels? In other words, can I circumvent a step by doing iqtree -s <fasta> -z <treels> -m GTR+G - te <unconstrained ML treefile> -zb 1000 -au Where <treels> consists of the raw Newick constraints, \"1.constr\", \"2.constr\", \"3.constr\" (and not \"1.constr.treefile\", \"2.constr.treefile\", \"3.constr.treefile\")? 2. When I run the AU test with a file containing many constraints, are the p values derived from comparing each tree to the best tree of the lot (regardless of whether constrained or unconstrained)? Or is it from comparing each tree to the unconstrained? I am trying to test every constrained topology to one single maximum likelihood unconstrained tree, i.e. many 1v1 comparisons. Thank you very much! ", "Hi there, Heiko may give some more insights, but here are my quick answers: On 9 Jan 2021, at 1:02 am, grape < joyoon...@gmail.com > wrote: Hi, Newbie here. I'd be grateful if could you clarify some points about the AU test in IQTree (I am using v2.1.2): 1. If I want to test multiple constraints, like in 5.7 of the manual, must I 'process' my constraint files first to produce .treefile, which are then concatenated into a .treels? In other words, can I circumvent a step by doing iqtree -s <fasta> -z <treels> -m GTR+G - te <unconstrained ML treefile> -zb 1000 -au Where <treels> consists of the raw Newick constraints, \"1.constr\", \"2.constr\", \"3.constr\" (and not \"1.constr.treefile\", \"2.constr.treefile\", \"3.constr.treefile\")? No, you cannot do this. You would need to run separate tree search for each of the constraint trees, as shown in the tutorial, to generatee 1.constr.treefile etc. And then concatenate the treefile(s) into one file for the AU test. 2. When I run the AU test with a file containing many constraints, are the p values derived from comparing each tree to the best tree of the lot (regardless of whether constrained or unconstrained)? Or is it from comparing each tree to the unconstrained? It will only compare the trees in your treels file. So make sure to have the unconstrained tree in this set. If not, it may happen that a tree is not be rejected even if it is much worse than the unconstrained ML tree, because it is seen as not much worse than the best tree in the set. I am trying to test every constrained topology to one single maximum likelihood unconstrained tree, i.e. many 1v1 comparisons. The AU and SH tests are designed for multiple testing. So you shouldn\u2019t actually do many 1-by-1 comparisons, but just put them all into one comparision. Cheers Minh Thank you very much! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/98dc5f61-71df-4e37-84f7-42b537de5ac1n%40googlegroups.com ", "Hi, Many thanks for your reply. I did consider concatenating the unconstrained, along with all my other .treefiles, into a single .treels to test all my constraints at once, as you say here. But I was hesitant because I couldn't be sure that the unconstrained ML tree was the best tree in the set, i.e. one of my constraints may have a higher log likelihood value than the unconstrained ML. Ideally I would like to put all constraints in a single test/comparison, but I need to make sure that each constraint is being compared to the unconstrained specifically, and not any other constraint in the group that, by chance, happens to have a higher LL. What would you suggest is the best way to go? Again, thanks so much - really appreciate it! ", "HI there, On 19 Jan 2021, at 1:48 am, grape < joyoon...@gmail.com > wrote: Hi, Many thanks for your reply. I did consider concatenating the unconstrained, along with all my other .treefiles, into a single .treels to test all my constraints at once, as you say here. But I was hesitant because I couldn't be sure that the unconstrained ML tree was the best tree in the set, i.e. one of my constraints may have a higher log likelihood value than the unconstrained ML. I\u2019d expect a 99% probability that the unconstrained ML tree shows a higher (or at least equal) likelihood than the constrained tree. The 1% could happen if the tree search heuristics got stuck in local optima. But if you see this, just repeat 10 or more runs of IQ-TREE and pick the best one. Ideally I would like to put all constraints in a single test/comparison, but I need to make sure that each constraint is being compared to the unconstrained specifically, and not any other constraint in the group that, by chance, happens to have a higher LL. Yes, all trees will be compared against each other. That\u2019s the purpose of the SH or AU test. What would you suggest is the best way to go? Just to reiterate, I\u2019d do a multiple testing of all trees together. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/596a1397-4172-465b-b216-adae070c77a5n%40googlegroups.com "]}, "JOLLwjXvSKo": {"topic": "-m TESTMERGEONLY", "initializeDate": "Nov 21, 2019, 7:08:25 AM", "timeStamp": "Nov 21, 2019, 6:08:39 PM", "content": ["Dear IQTREE users, I want to estimate the best partition scheme of my dataset using the command -m TESTMERGEONLY. I start the analysis of 567 cox1 sequences (648 bp long) by splitting then into 3 codon partitions; i.e. codon 1, codon 2 and codon 3 sites. The best partition scheme output varied depending if edge partitions are unlinked (-q), allowing partition-specific rates (-spp) or unlinked (-sp). The best partition scheme for the two first options (-q and -spp) was as three independent partitions and for the latter (-sp) as a single partition. My question is, why it is so critical linking or unlinking edges in estimating the best partition scheme? Best, Joan The full command lines were as follows: iqtree -s sp567.phy -q Hyalella567.nex -pre sp567_testmergeONLYq -nt AUTO -m TESTMERGEONLY iqtree -s sp567.phy -ssp Hyalella567.nex -pre sp567_testmergeONLYssp -nt AUTO -m TESTMERGEONLY iqtree -s sp567.phy -sp Hyalella567.nex -pre sp567_testmergeONLYsp -nt AUTO -m TESTMERGEONLY ", "Hi Joan (also - I think we worked together very briefly when I volunteered at the NHM a long time ago, so thanks for getting me into phylogenetics!), The reason for the difference in the best partitioning scheme is all about the number of parameters that each approach uses. -q, linked rates, estimates a single set of branch lengths for the whole alignment. That\u2019s 2N-3 parameters where N is the number of taxa. -spp, partition rates, estimates a single set of branch lengths for the whole alignment, plus a partition-specific rate multiplier for each partition (minus one, since the original set of branch lengths is used for one partition). That\u2019s 2N-3 + K-1 parameters, where K is the number of partitions. -sp, unlinked rates, estimates one set of branch lengths for each partition. That\u2019s K*(2N-3) parameters. So, while -sp is probably the most realistic model, it requires you to estimate a lot of parameters. -q has the fewest parameters, but is a kind of silly model. -spp is usually the best balance - not too many parameters but able to fit the biggest cause of variance in rates (differences between codon positions and/or loci). More parameters has a big effect because the AIC/AICc/BIC all penalise more parameter-rich models more harshly. For a longer explanation on all of this, you could read the intro to this preprint: https://www.biorxiv.org/content/10.1101/467449v1.full Cheers, Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c26c5ae9-ad23-43ba-989c-f497f41c092a%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Thanks Rob, for the comprehensive answer! On a side note: Joan, as you already ran the 3 analyses, you can simply look at the AIC/BIC scores printed in 3 .iqtree files to decide which one is best. I guess the -spp is likely the best here, as it exactly models the rate variation between 3 codon positions. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmr2eDy60YXd9Qj68ruCEzz-GUQcXTfoRxfrqdVkHcuZGg%40mail.gmail.com "]}, "9G89yGdhHUQ": {"topic": "Partitioning scheme keeps all genes separated.", "initializeDate": "Oct 12, 2017, 10:30:12 AM", "timeStamp": "Oct 15, 2017, 1:37:06 PM", "content": ["Dear Minh, I just successfully ran IQ-TREE on my large dataset of about 1000 genes. I used the option MFP+MERGE so I was expecting the software to group a few genes in the same partitions. I guess this need not necessarily happen, but I thought it would be unlikely not to join at least a few genes. Still, that is what happen and all the 1000 genes each have their now partition. In your experience, is that common? Could there be a problem with the partitioning part of it? Thank you! ", "Dear Tauana, I would say it\u2019s not uncommon that IQ-TREE does not merge any partitions. That happened for example for a data set that I analyzed here: DOI: 10.1098/rspb.2015.2802 . Moreover, I would like to note that IQ-TREE only implements the edge-unlinked option for this partition scheme finding phase. Thus, in case of doubt you can try PartitionFinder with the edge-linked option, to see if this would merge any partitions. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Sounds good, Minh, thanks. Also thanks for the reference of your paper! Tauana "]}, "RYwj1G8fsxs": {"topic": "New citation for model selection", "initializeDate": "May 19, 2017, 10:44:28 AM", "timeStamp": "May 19, 2017, 10:44:28 AM", "content": ["Dear users, We have now a new citation for model selection in IQ-TREE: Subha Kalyaanamoorthy, Bui Quang Minh, Thomas KF Wong, Arndt von Haeseler, and Lars S Jermiin (2017). ModelFinder: Fast Model Selection for Accurate Phylogenetic Estimates. Nature Methods, in press. http://dx.doi.org/10.1038/nmeth.4285 Thus we ask you to cite this paper, whenever you performed the old or new model selection or PartitionFinder implementation. This is quite critical for us to obtain funding, further improve e.g. with new features, or support users (e.g. via this forum). We appreciate your help! Kind regards, Co-authors "]}, "dZVsnKGfFsI": {"topic": "To prevent spams", "initializeDate": "May 19, 2017, 5:08:34 AM", "timeStamp": "May 19, 2017, 5:08:34 AM", "content": ["Dear users, Recently there have been spams sent to the IQTree group. To prevent this, we implemented the policy that only registered users are allowed to send emails here. However, this does not totally prevent all spammers, which we then had to ban from the group manually. We hope you understand and sorry for any inconvenience. Best, Minh "]}, "3mekzaLS4Ew": {"topic": "BUG", "initializeDate": "Mar 12, 2019, 1:46:13 PM", "timeStamp": "Mar 14, 2019, 8:08:37 AM", "content": ["I'm trying to run 1.6.10 (the mpi version) and I continue to get \"crashes with signal illegal instruction\" message. I would love your help, if possible! Thanks. (from output file) ************************************************ * START TREE SEARCH USING MPI WITH 1 PROCESSES * ************************************************ Random seed of master = 198329 IQ-TREE MPI multicore version 1.6.10 for Linux 64-bit built Mar 12 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: c8a-s1.ufhpc (AVX, FMA3, 251 GB RAM) Command: /apps/intel/2018.1.163/openmpi/3.1.2/iq-tree/1.6.10/bin/iqtree-mpi -nt 32 -s FcC_brett_supermatrix.fas -spp FcC_supermatrix_partition.txt -m MFP+MERGE -bb 1000 -nm 5000 -bnni -alrt 1000 -bsam GENESITE -pre brett.concat.long.iqtree Seed: 198329 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Tue Mar 12 13:28:24 2019 Kernel: AVX+FMA - 32 threads (64 CPU cores detected) (error) Create initial parsimony tree by phylogenetic likelihood library (PLL)... 1.576 seconds NOTE: ModelFinder requires 1777 MB RAM! Testing GTR+F+G on supermatrix... ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 double PhyloTree::computeLikelihoodBranchSIMD<Vec4d, false, 4, true, false>(PhyloNeighbor*, PhyloNode*) ERROR: 4 PhyloTree::computeLikelihood(double*) ERROR: 5 ModelFactory::optimizeParameters(int, bool, double, double) ERROR: 6 testOneModel(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, Params&, Alignment*, ModelCheckpoint&, ModelInfo&, ModelsBlock*, int&, int) ERROR: 7 testConcatModel[abi:cxx11](Params&, SuperAlignment*, ModelCheckpoint&, ModelsBlock*, int, ModelInfo&) ERROR: 8 testPartitionModel(Params&, PhyloSuperTree*, ModelCheckpoint&, ModelsBlock*, int) ERROR: 9 testModel(Params&, PhyloTree*, ModelCheckpoint&, ModelsBlock*, int, int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) ERROR: 10 runModelFinder(Params&, IQTree&, ModelCheckpoint&) ERROR: 11 startTreeReconstruction(Params&, IQTree*&, ModelCheckpoint&) ERROR: 12 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 13 main() ERROR: 14 __libc_start_main() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ILLEGAL INSTRUCTION ERROR: *** For bug report please send to developers: ERROR: *** Log file: brett.concat.long.iqtree.log ERROR: *** Alignment files (if possible) srun: error: c8a-s1: task 0: Illegal instruction (core dumped) ", "This is duplicated entry, same issue posted in GitHub, so please follow-up from there Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "7rh5vePDQdE": {"topic": "Constrain trees with branch lengths", "initializeDate": "Nov 2, 2017, 10:27:38 AM", "timeStamp": "Nov 4, 2017, 2:30:32 PM", "content": ["Dear Minh, I've been using constrained trees for some tree searches, but I was not mindful about the branch lengths I left for the constraints. I recently run a edge-unlinked partitioned analysis and it appears that the branch lengths for all partitions are the same. I now wonder if using a constraint with branch lengths forces IQTREE to also constrain branch lengths on top of the topology itself. I would appreciate it lots if you can clarify this to me. Thanks, ", "Hi Sergio, On Nov 2, 2017, at 3:27 PM, Sergio Andr\u00e9s Mu\u00f1oz Gomez < sergi...@gmail.com > wrote: Dear Minh, I've been using constrained trees for some tree searches, but I was not mindful about the branch lengths I left for the constraints. I recently run a edge-unlinked partitioned analysis and it appears that the branch lengths for all partitions are the same. I now wonder if using a constraint with branch lengths forces IQTREE to also constrain branch lengths on top of the topology itself. No, the constraint only forces the tree topology to obey it. Branch lengths are free to vary. So if what you described is true, then it\u2019s weird. To be sure, please send me the command line and the log file. I will have further look. Thanks, Minh I would appreciate it lots if you can clarify this to me. Thanks, You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "lOm8eSCbgj0": {"topic": "IQTREE 1.6.6 incorrectly handles RAxML-style partition files with multiple blocks", "initializeDate": "Jul 18, 2018, 11:35:31 AM", "timeStamp": "Jul 21, 2018, 3:31:18 PM", "content": ["Sorry guys, but I have one more regression in IQTREE 1.6.6 to report: If RAxML-style partition file contains partitions with multiple site blocks, e.g. DNA, p1 = 1-10, 20-30, 40-60 then apparently IQTREE 1.6.6 would only use the first block (e.g. 1-10) and simply ignore the remaining parts. Once again, this used work properly in IQTREE 1.5.5, so must be a regression bug. The nasty aspect of this is that no error will be produced, so I discovered this problem almost by accident when trying to find out why IQTREE 1.6.6 became 3x faster than 1.5.5 on one of my test datasets :) Hope it will be trivial to fix, thanks in advance! Best, Alexey ", "Hi Alexey, Many thanks for this report and the previous email as well \u2026 Not sure why this, but I\u2019ll have a look as soon as I\u2019m back in August. Just a quick question for now: Does this problem happen with nexus partition file? Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, thanks! The problem seems to be present with Nexus partition file as well. I tried the following file: begin sets; charset part1 = 1-1000 2001-3000; charset part2 = 1001-2000 3001-200000; charset part3 = 200001-394684; charpartition mine = HKY:part1, GTR+G:part2, GTR+G: part3; end; iqtree -pre test -s ali.phy -q example.nex -nt 16 -te sample.treefile -blfix -redo and got the following output: Loading 3 partitions... Subset Type Seqs Sites Infor Invar Model Name 1 DNA 200 1000 371 570 HKY part1 2 DNA 200 1000 416 475 GTR+G part2 3 DNA 200 194684 93507 86630 GTR+G part3 Best, Alexey On 18.07.2018 20:30, Minh Bui wrote: > Hi Alexey, > Many thanks for this report and the previous email as well \u2026 Not sure why this, but I\u2019ll have a look as soon as I\u2019m back > in August. Just a quick question for now: Does this problem happen with nexus partition file? > Cheers > Minh >> On 18 Jul 2018, at 12:35 pm, Alexey Kozlov < alexei...@gmail.com <mailto: alexei...@gmail.com >> wrote: >> Sorry guys, >> but I have one more regression in IQTREE 1.6.6 to report: >> If RAxML-style partition file contains partitions with multiple site blocks, e.g. >> DNA, p1 = 1-10, 20-30, 40-60 >> then apparently IQTREE 1.6.6 would only use the first block (e.g. 1-10) and simply ignore the remaining parts. >> Once again, this used work properly in IQTREE 1.5.5, so must be a regression bug. >> The nasty aspect of this is that no error will be produced, so I discovered this problem almost by accident >> when trying to find out why IQTREE 1.6.6 became 3x faster than 1.5.5 on one of my test datasets :) >> Hope it will be trivial to fix, thanks in advance! >> Best, >> Alexey >> -- >> You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. >> To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com >> <mailto: iqtree+un...@googlegroups.com >> To post to this group, send email to iqt...@googlegroups.com <mailto: iqt...@googlegroups.com ", "Hi Alexey, I tried with an example data set here and IQ-TREE v1.6.6 loaded correctly (i.e. fragmented positions ranges are fully loaded). So I couldn\u2019t reproduce the behaviour you described. Not sure what happened. Can you send me your input data via my personal email and I will have a look. Cheers Minh "]}, "hZbQVDl-rt8": {"topic": "Phylogenetic dating - continuing after initial bootstrap/partition run", "initializeDate": "Oct 19, 2020, 7:57:51 PM", "timeStamp": "Oct 22, 2020, 11:43:38 PM", "content": ["Hi All, I am trying to run the phylogenetic dating option on the results of an initial ML partitioned bootstrap run. The initial run used the following command: iqtree2 -p internal \\ --prefix concat50internal -B 1000 \\ -nt AUTO -ntmax 20 \\ -m MFP+MERGE --merge-model GTR --merge-rate G --rclusterf 10 --cptime 4000 Now I want to date the resulting tree file using the results (partition, models, tree) I have tried the following: iqtree2 \\ -p internal \\ -T AUTO \\ -pre concat50internal \\ --undo --date date_file.txt \\ --date-ci 100 \\ --date-root -324 \\ --date-tip 0 \\ --date-root -324 \\ -te concord50internal.cf.r.tree My understanding is the \"-undo\" will allow me to alter the command options from a previous run and continue the run. Since i am giving it the same prefix as before my hope is that it will use the model and partition results from that run. I am also giving it the tree from that run as a constraint tree via \"-te\". After some trial and error i got it to load the constrain tree - had to reroot it and NOT specify the outgroup (gave me an error when i did) For the moment it seems to be running, but it still seems to be doing model selection even though it has read in the check point file/model file (see log below) Am I missing something with the dating settings, or is this running the way it should be? Also is this the best way to use the dating option for a run that has previoulsy completed? Thanks Pete ################### NOTE: Restoring information from model checkpoint file concat50internal.model.gz Reading input tree file concord50internal.cf.r.tree ... rooted tree Perform fast likelihood tree search using GTR+I+G model... CHECKPOINT: Tree restored, LogL: -14957149.716 NOTE: ModelFinder requires 246 MB RAM! Selecting individual models for 1933 charsets using BIC... No. Model Score TreeLen Charset 1 HKY+F+R2 21862.680 1.398 uce-111423.nexus NOTE: 21.996 seconds to dump checkpoint file, increase to 440.000 2 K3P+R3 16099.923 0.997 uce-112159.nexus 3 HKY+F+G4 19684.550 1.238 uce-990291749.nexus 4 K2P+R3 19638.733 1.379 uce-115319.nexus 5 HKY+F+R3 19770.359 1.792 uce-112165.nexus 6 TPM2+F+R3 18033.689 1.440 uce-794.nexus 7 TN+F+R4 28057.796 4.221 uce-990272081.nexus 8 TPM2+F+R4 40033.229 7.197 uce-2599.nexus 9 TN+F+R3 18147.396 1.366 uce-990293089.nexus 10 GTR+F+G4 20720.325 1.722 uce-113337.nexus 0h:5m:13s (16h:43m:35s left) 11 HKY+F+R3 20542.215 1.579 uce-558.nexus 0h:5m:45s (16h:46m:53s left) ############ (will report any progress) ", "Hi Pete, --undo will also load the model checkpoint file. It\u2019s just printing the information again, but no calculation is done. You will notice that this is running much faster than the previous run. You can make it faster by feeding -p option with the best_scheme.nex file printed in the previous run, so you don\u2019t need to use --undo option. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/3b00c602-b850-4a7a-9f84-20b88603133dn%40googlegroups.com "]}, "Jev_UQcDqaU": {"topic": "What does this ERROR mean?", "initializeDate": "Nov 10, 2016, 5:25:10 AM", "timeStamp": "Nov 10, 2016, 5:47:40 AM", "content": ["I don't know what is happening. Could anyone help me? What does this ERROR mean? This job STOPPED because there was a problem! ERROR: Sequence Zm_3672_CSL_F contains not enough characters (1312) Thanks ", "Hi there, This error message is printed when IQ-TREE is reading the input alignment to make sure that all sequences have the same length. It means that sequence Zm_3672_CSL_F has 1312 characters, which is shorter than the alignment length. If you use PHYLIP format, then check the first line again (which contains #sequences and #sites). If you use FASTA format, then it can be the case that your sequences have different lengths. So check your alignment carefully again. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "Q1w4SZ2xob0": {"topic": "Re: AU test question (IQ-TREE)", "initializeDate": "Mar 20, 2018, 11:41:31 PM", "timeStamp": "Mar 20, 2018, 11:41:31 PM", "content": ["Hi Juanes, From the log file I only saw one partition being loaded and not sure why it contradicts with \u201cLoading 6 partitions\u2026\u201d message. Can you please send me the full log file for examination? Cheers Minh On 21 Mar 2018, at 8:59 am, Juan Esteban Uribe Arboleda < juanurib...@gmail.com > wrote: Thanks for your response, I am trying to do the AU test with constrained tree using a partition schemes model, but I am not sure that this is being detected completely. Because in the .log file only appears the follows: Loading 6 partitions... Subset Type Seqs Sites Infor Invar Model Name 5708 407 4771 mtZOA+F+I+G4 Bin1 Degree of missing data: 0.000 Info: multi-threading strategy over partitions Do the bold types mean that the other five partition are detected but they are not shown? Many thanks in advance Juanes 2018-03-20 17:09 GMT-04:00 Minh Bui minh...@univie.ac.at Dear Juan, Can you pls post this question to the IQ-TREE forum ( https://groups.google.com/forum/#!forum/iqtree ), this is to keep track of the issues. Also regarding this: I am trying but this only test the model of first partition. Can you pls more explicit details? Firstly what was the command line and a few lines of the log file that is relevant. Thanks, Minh On 20 Mar 2018, at 5:19 am, Juan Esteban Uribe Arboleda < juanurib...@gmail.com > wrote: Dear Dr. Quang and Dr. Nguyen I am a user of IQ-TREE software and I have a question: Is possible do the AU test (Testing constrained tree) using a model partitions? I am trying but this only test the model of first partition. I would appreciate it alot your answer All the best Juan Esteban Uribe Arboleda , PhD National Museum of Natural History (NMNH) Department of Invertebrate Zoology Smithsonian Institution 10th St. & Constitution Ave. NW, Washington, DC 20560 USA Uri...@si.edu Juan Esteban Uribe Arboleda , PhD National Museum of Natural History (NMNH) Department of Invertebrate Zoology Smithsonian Institution 10th St. & Constitution Ave. NW, Washington, DC 20560 USA Uri...@si.edu "]}, "SawZyzZeF-k": {"topic": "Model selection skips all models as + ASC is not applicable", "initializeDate": "Oct 5, 2016, 11:20:16 AM", "timeStamp": "Oct 5, 2016, 4:35:15 PM", "content": ["Dear IQ-Tree users, I am trying to carry out a phylogenetic analysis on a large SNP dataset (~ 160 sequences, 120,000 sites; every site has no more than 30% missing characters). I am using IQ-Tree v.1.4.2. I start with model selection: iqtree-omp -s ../mydata.fasta -m TESTONLY+ASC -nt 1 But when reading the log file I get \"Skipped since +ASC is not applicable\" for all models. Do you have any idea what this is due to? Thank you for the kind attention, Max ", "Edit: I also tried without the \"ONLY\" option, and obtained the same result, while \"-m TESTNEWONLY\" (without ASC) is currently running and analyzing models. Sincerely, Max Tagliamonte ", "Dear Max, since this seems to be a common mistake, I have now written a FAQ, which explains why this happens: http://www.iqtree.org/doc/Frequently-Asked-Questions/#why-does-iq-tree-complain-about-the-use-of-asc-model Hope that helps... Let me know if something is not clear. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Dear Mihn, Thank you for responding so fast. I went to the linked page, but I could not find the topic. The page results last updated on August. Maybe the update is not online yet? Or did I miss the relevant part? Regards, Max ", "OK, I see the update now. Thank you again for the help, and for this great program. I am loving it, and the manual pages are very exhaustive. I look forward to get my results! Kind Regards, Max "]}, "-dBWXLP4I8Y": {"topic": "Failed to run a combined analysis to DNA and morphological characters", "initializeDate": "Aug 4, 2018, 3:48:16 PM", "timeStamp": "Aug 5, 2018, 10:51:41 PM", "content": ["Hello, I have tried to do a combined analysis with morphological data and dna, in the command line version, I followed all the steps and only read or the morphological part or that of dna, does anyone know what I am doing wrong? ", "Dear Emmanuel, Have you stored the data in two separate alignment files, one for DNA and one for morphological data? The manual described how to mix data: http://www.iqtree.org/doc/Complex-Models#partition-models Does that help? Minh On 5 Aug 2018, at 5:48 am, Emmanuel Mart\u00ednez < emalor...@gmail.com > wrote: Hello, I have tried to do a combined analysis with morphological data and dna, in the command line version, I followed all the steps and only read or the morphological part or that of dna, does anyone know what I am doing wrong? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Minh Bui, Thank you very much, the link was very helpful, I finally realized where the error was, regards. Emmanuel "]}, "UEBzM61a1k8": {"topic": "protein mixture models \"state frequencies do not sum up to 1\"", "initializeDate": "Apr 14, 2021, 8:13:05 PM\u00a0(13 days ago)\u00a0", "timeStamp": "Apr 16, 2021, 12:07:46 AM\u00a0(12 days ago)\u00a0", "content": ["Hi there, I've been using IQ-TREE for years (thanks!). I work mostly with protein alignments. I've occasionally tested protein mixture models and quite often models like EX2, EX3, UL2, UL3, EX_EHO or EHO (and variants) result in a warning message such as: \"WARNING: BUR_EXT state frequencies do not sum up to 1 : 1.0000010\" The deviation from 1 is always extremely small, around .0000010, but occasionally the \"flat\" mixture model (no F, I, R or G parameter) perform better than any standard model variation (normally some variation of LG based on BIC) even with free rate, and sometimes with similar or even lower number of parameters (df) than some of those LG variations. Basically, I'm curious about how important are these warnings, say, how much they impact the model selection and tree creation, and/or if they can constitute severe model violations of some kind and therefore, if they should be completely avoided or not. Thank you in advance, Xabi ", "Hi Xabi, Quick answer, you can ignore this warning. It occurs in some older versions of IQ-TREE. But we fixed it some time ago. Even in older versions, this is still OK, this tiny deviation from 1 won\u2019t affect anything. It was due to the authors of these matrices, which already had the frequencies not summing up to 1 in their publication. We were not aware of these problems, but then introduced a processing step to rescale these entries to 1. If you want, you can complain with these authors directly ;-) Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b43185d6-82d3-4681-9c39-5b499418186an%40googlegroups.com "]}, "AdBY7gqSnsM": {"topic": "Chi-Square test differs with same input", "initializeDate": "Jan 11, 2018, 1:19:07 PM", "timeStamp": "Jan 12, 2018, 3:32:06 PM", "content": ["Hello, I think I have found an error in IQ-tree but I'm not sure. I started two runs with 100% identical input alignment containing an MSA of protein coding nucleotides here: http://iqtree.cibiv.univie.ac.at/ --> Model selection Run 1 with a partition file like that: DNA, BET1 = 1-384\\3 DNA, BET2 = 2-384\\3 DNA, BET3 = 3-384\\3 Run 2 with no partiion file, since this test was for best Codon model. Run 1 calculated the following chi-square scores (examples): Taxa 1: 0% Taxa 2: 100% Taxa 3: 100% Taxa 4: 87% Taxa 5: 5% Taxa 6: 14% Taxa 7: 98% Taxa 8: 44% Taxa 9: 0% Taxa 10: 57% Run 2 calculated the following chi-square scores at the same examples: Taxa 1: 33% Taxa 2: 87% Taxa 3: 88% Taxa 4: 86% Taxa 5: 0,5% Taxa 6: 1% Taxa 7: 22% Taxa 8: 36% Taxa 9: 47% Taxa 10: 84% Mustn't the chi-square scores be the same in both cases? All the best Dieter ", "Dear Dieter, I do not think that this I an error. See below. No, not necessarily. Although the alignment is identical, the actual input characters differ. If I understood you correctly, in run 1 you use a DNA model (with 3 partitions) while in run 2 you use a codon model. DNA models work on the DNA alphabet A, C, G, T and the Chi2 test tests for significant differences between the frequency vector of 4 values of one sequence against that of the overall alignment. The alphabet of codon models however consists of all the 64 triplets. That means each triplet (AAA, AAC, AAG, ..., TTT) is one character. Thus, the Chi2 test now tests vectors of 64 values each which naturally will produce different Chi2 values. Of course translating the codons into amino acids would then gain an alphabet of 20 different characters and again different vectors to test. Here I think you intuitively would not expect the same result either. However, this is again just reducing the 64 codon characters to the according amino acids and the underlying alignment would still be that same. So in essence, using DNA, codons or amino acids all matters because the frequency vectors may differ a lot. And just to make a little more intuitive, one can easily come up with two very long DNA sequences where all 4 nucleotides have same frequencies, but depending on how you group the characters into contiguous triplets the codons frequencies of these may be very different. For instance: ATG ATG ATG ATG \u2026 TAG TAG TAG TAG \u2026 I hope that explanation help to sort this out. Best wishes and thanks for you interest in IQ-TREE, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Hi, Thank you Heiko, great explanation. Yes I understand that. I already thought that way. Well, a bit confusing, since exactly the same data cause different chi-square scores depending from the partitioning scheme, and the model. There is a third option we have here: We can split in 3 partitions and can calculate 3 chi-square scores for each codon position. That makes 5 different chi-square scores for one identical data set. One may ask: Which one is the right chi-square scores to tell that one sequence might be wrong? From that special data set I know from previous phylogenies, that nothing critical is wrong. All sequences are well aligned, introns perfectly removed, exons match great, no stop codons, no stutters, match test also with the protein model is OK. I would say that the third option 3 partitions and 3 chi-square scores make most sense, since the very different information content in the positions. I can tell that option 1 and 2 surely produces super low chi-square scores for perfect sequences... Never cared about the chi-square scores so far, so that's all a bit new to me. All the best Dieter You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/AdBY7gqSnsM/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Dieter, > Thank you Heiko, great explanation. Welcome! > Yes I understand that. I already thought that way. > Well, a bit confusing, since exactly the same data cause different chi-square scores depending from the partitioning scheme, and the model. The partition scheme has no hand in this. Using 1 partition instead of 3 should actually produce identical Chi2 values. > There is a third option we have here: > We can split in 3 partitions and can calculate 3 chi-square scores for each codon position. > That makes 5 different chi-square scores for one identical data set. > One may ask: Which one is the right chi-square scores to tell that one sequence might be wrong? Hmmm, that question asked by the test is actually different. It is not asking whether a sequence is wrong. It tests whether the composition of the sequence is significantly different to the overall (stationary) composition (=character frequencies) which would be used to model evolution along the tree. That means the 5 tests test whether there is a significant difference of the character composition of any sequence in (a) the whole DNA sequence [4 characters], (b) the codon sequence [64 characters], (c) the first, (d) second, or (e) third codon positions [again 4 characters for the latter three cases]. No single one of these tests are right or wrong, they just answer different questions, each for a distinct type of sequences. Even (f) using the protein sequences [20 characters] does not contradict to that. A significant difference in the composition might not harm your analysis, but such sequences however can very well do. So one should be aware of such outlier sequences and think about discarding them. For instance, if you see strange clustering in the vicinity of such sequences, the composition may very well be a cause of that. If in your case test (e) shows a significant difference in the 3rd codon position, but not in the others, then one might decide not to use the 3rd codon positions in the analysis to avoid, e.g. GC-bias caused by hot environments. Still, while the CG bias might well be detectable in the codon sequence, it might not be present when using the protein sequences due to the degenerate nature of the genetic code. So these tests might point to the direction that it may be better to either only use 1st and 2nd codon positions or protein sequences for the analysis of certain datasets (or different decision depending on the results of these tests). > From that special data set I know from previous phylogenies, that nothing critical is wrong. All sequences are well aligned, introns perfectly removed, exons match great, no stop codons, no stutters, match test also with the protein model is OK. > I would say that the third option 3 partitions and 3 chi-square scores make most sense, since the very different information content in the positions. > I can tell that option 1 and 2 surely produces super low chi-square scores for perfect sequences\u2026 What do you mean by perfect sequences? Having a GC bias does not mean that the sequences are not well alignable, however, it can do harm to the evolutionary modelling of the substitution process used in the tree search. > Never cared about the chi-square scores so far, so that's all a bit new to me. Even if there is no obvious effect, one should keep this in mind as a possible cause of trouble. Best wishes, Heiko > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Hello Heiko, That really cleard my confusion. Thank you very much... will work with it. All the best Dieter "]}, "GnZu28jJOh4": {"topic": "Concordance factor", "initializeDate": "Dec 5, 2018, 5:26:48 PM", "timeStamp": "Apr 25, 2019, 11:42:05 PM", "content": ["Dear Users, We\u2019d like to draw your attention to a new feature in IQ-TREE v1.7 (currently in beta release): The concordance factor allows you to assess the (dis)agreement between species tree and gene trees. We implemented two measures of gene concordance factor (gCF) and the new site concordance factor (sCF), that quantify the concordance at gene- and site-level, respectively. We also provide a new option to infer gene trees separately. The preprint is available at https://www.biorxiv.org/content/early/2018/12/05/487801 And a Tutorial for how to use these features: http://www.iqtree.org/doc/Concordance-Factor Cheers Minh, Matt Hahn and Rob Lanfear ", "Hi, I very much like the gcf and scf option but I'm struggling to understand exactly which gene trees would be considered both decisive and concordant. Suppose I have a branch in the species tree with four clades around it, each containing four taxa, {A1,A2,A3,A4 \u222a B1.B2,B3B4}|{C1,C2,C3,C4 \u222a D1,D2,D3,D4}. Now,as I understand from the explanation, a gene tree is \"decisive\" for this branch if all these four clades A,B,C and D are non-empty. And a concardant gene tree has the same bipartition of these clades as the species tree. However, what if a genetree has a topology that mixes taxa from the clades, so that, for example, the new topology is {A1,A2,C1,C2 \u222a B1.B2,B3,B4}|{C3,C4,A3,A4 \u222a D1,D2,D3,D4}? Is this topology concordant or not with the species tree? In general, my question is how are the clades defined and mapped between the species tree and gene tree when the taxa vary in presence and topological position? Many thanks. ", "Hi there, It is not concordant with the species tree. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thank you for your answer. Am I right in thinking that because a single misplaced branch may be sufficient to make a genetree discordant, therefore the probability of concordant branches diminishes with more tips in the relevant clades or trees and gcf values will be lower? (Similarly to the way bootstrap values tend to be lower when more tips are involved). (This was sent from my phone). ", "Yes that's right. When some tips moved away from its \u201cusual\u201d clade to the other side (e.g. some C go to A in your case), then it makes the gene tree discordant with the species tree (same with standard bootstrap). Cheers Minh "]}, "OcfgC0RF110": {"topic": "Interpret likelihood mapping", "initializeDate": "Jun 1, 2017, 11:02:16 AM", "timeStamp": "Feb 2, 2019, 5:26:12 AM", "content": ["Dear All, Sorry for the long email (hope will be of general interest) I\u2019m working on a very problematic data set (short sequences and poor phylogenetic signal), and was advised to analyse the data using likelihood mapping. Indeed, Likelihood Mapping allows to Estimate, a priori, the amount of phylogenetic information in the alignment (unrestricted likelihood-mapping) Evaluate, a posteriori , the support of an internal branch of interest (four-cluster likelihood-mapping) It may be that, to the \u201cgeneral user\u201d, it is not obvious how to interpret the output in a \u201capproximate quantitative way\u201d, in other words in terms of \u201cdecision making\u201d. Three references are given in the .iqtree outfile. This is what I found in them concerning \u201cquantitative\u201d assessments of phylogenetic information in the data. Strimmer_Haeseler1997 (PNAS) most of the points ... the overall tree \u2026 multifurcating fair amount of star-likeness with 17.5% \u2026 reasonable amount of tree-likeness as 72.4% the tree likeness is extremely high \u2026 98.3% 8.3% of all quartets in the star-like region \u2026 is too high for a completely resolved phylogeny Schmidt_Haeseler 2003 (Curr Protocols\u2026) A large percentage of unresolved quartets would indicate that the data is not appropriate \u2026 A percentage of 89.9% of all admissible quartets support this monophyly strongly Schmidt_Haeseler 2009 (PhyloHandbook) From a biological standpoint, a likelihood mapping analysis showing more than 20%\u201330% of points in the star-like or network-lik area suggests that the data are not reliable for phylogenetic inference. All a bit puzzling to me. Where does the 20-30% rule of thumb come from? Aside from the known seq-length effect, is it still valid? One last point. Suppose we can make a decision from the graphs (triangles); how do we make use of the detailed info in the .iqtree outfile? Namely: Quartet support of regions a1, a2, a3 (mainly for clustered analysis) Quartet support of areas 1-7 (mainly for clustered analysis) Quartet resolution per sequence (phylogenetic information) Attached the output of my analyses. How would you interpret the results? All the best, Giorgio ", "Dear Giorgio, I am not the right person to answer, but I will give a few comments regarding your questions (Heiko may give further explanations): Where does the 20-30% rule of thumb come from? I guess this threshold was empirically determined through analyzing a large bunch of simulated and real data sets. Your data has 21.6% quartets falling into the star-like region, which is this range, indicating that it likely does not have enough information. Aside from the known seq-length effect, is it still valid? What do you mean exactly? Suppose we can make a decision from the graphs (triangles); how do we This would be my interpretation: (Cluster1,Cluster3)-(Cluster2,Cluster4) is the most likely split as it is the supported by 51.2% of the quartets and 26.9% fully resolved quartets. (Cluster1,Cluster2)-(Cluster3,Cluster4) is the most unlikely split. make use of the detailed info in the .iqtree outfile? Namely: Quartet support of regions a1, a2, a3 (mainly for clustered analysis) I also don\u2019t get how to use this information, Heiko will certainly know ;-) Quartet support of areas 1-7 (mainly for clustered analysis) Quartet resolution per sequence (phylogenetic information) To my understanding, for each sequence, among the quartets that include this sequence, how many quartets are resolved (sum of regions 1,2,3), partly resolved (sum of regions 4,5,6) and unresolved (region 7). If a sequence has many unresolved quartets, then it may not fit the data. There, one should go back to check the alignment again, for example. Or can also think about discarding such sequences. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <giorgio2forum_likmap.pptx> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Giorgio, I will add my answers to your original mail, not to overload the text with several layers of answers. In general I agree with Minh, but see below for more detailed answers. Sorry for the long email (hope will be of general interest) No problem - there is a long answer ;) I\u2019m working on a very problematic data set (short sequences and poor phylogenetic signal), and was advised to analyse the data using likelihood mapping. Indeed, Likelihood Mapping allows to Estimate, a priori, the amount of phylogenetic information in the alignment (unrestricted likelihood-mapping) Evaluate, a posteriori , the support of an internal branch of interest (four-cluster likelihood-mapping) Yes, if one has four well defined groups and one wants to figure out how they cluster together. In addition there is Evaluate, a posteriori , the support of an internal branch of interest by a 2-cluster likelihood-mapping, if one has two groups one is interested in and one wants to figure out how well they are separated. (In the sequence-specific reports one might even be able to find out about taxa which do not stick the \u2018their\u2019 side of the internal branch. 4. There are not many applications for the 3-cluster likelihood-mapping. I know of one, where one wants to check how well the outgroup is separated from an ingroup of interest and a sister group of the ingroup. If the tree with ingroup+sister group vs. outgroup is not well supported, the outgroup is possibly too closely related to the other two for serving as a proper outgroup. It may be that, to the \u201cgeneral user\u201d, it is not obvious how to interpret the output in a \u201capproximate quantitative way\u201d, in other words in terms of \u201cdecision making\u201d. Three references are given in the .iqtree outfile. This is what I found in them concerning \u201cquantitative\u201d assessments of phylogenetic information in the data. Strimmer_Haeseler1997 (PNAS) most of the points ... the overall tree \u2026 multifurcating fair amount of star-likeness with 17.5% \u2026 reasonable amount of tree-likeness as 72.4% the tree likeness is extremely high \u2026 98.3% 8.3% of all quartets in the star-like region \u2026 is too high for a completely resolved phylogeny Schmidt_Haeseler 2003 (Curr Protocols\u2026) A large percentage of unresolved quartets would indicate that the data is not appropriate \u2026 A percentage of 89.9% of all admissible quartets support this monophyly strongly Schmidt_Haeseler 2009 (PhyloHandbook) From a biological standpoint, a likelihood mapping analysis showing more than 20%\u201330% of points in the star-like or network-lik area suggests that the data are not reliable for phylogenetic inference. All a bit puzzling to me. Where does the 20-30% rule of thumb come from? As you can already see from the publications, there is no easy to be defined clear-cut threshold. The reason is that there are different factors influencing the ability to resolve a quartet, i.e. to determine one of the three quartet tree topologies as the one with the clearly better likelihood value. Such factors which can reduce the ability to resolve are: (a) If the sequences are too divers. That means if the information to resolve quartets (and thus also a full tree) is covered by noise. (b) If the mutation patterns are shaped by a linear development developing along a tree, but a mixture of processes - e.g. (i) if there is strong directed selection as developing drug resistance in anti-viral/pathogen therapy, this may contradict the \u2018normal\u2019 mutation patters or (ii) recombination joining regions of different history etc. (c) If the sequences are too similar - there is no way to infer a tree of a group of sequences which are either identical or differ mainly by mutations which are specific to single sequences and not shared with others. These are the typical cases producing unresolved quartets, however: (d) already a group of identical (or nearly identical) sequences (see above) can already cause high percentages of unresolved quartets, because every time 3 (nearly) identical are chosen to evaluate a quartet, they do not the information to resolve the quartet tree. Although the number of unresolved quartets may be high, it strongly depends on your data and question you want to answer whether the data and resulting tree is useful. If you have a number of groups of sequences which might have diverged recently, meaning the distances within each group are small (=nearly identical) this leads to a high fraction of unresolved quartets, but if you are interested in the branching pattern among the group, the unresolved quartets can easily be explained and do not hurt the analysis. The sequence-specific fractions of resolved/partly resolved/unresolved quartets, may help the user to figure out strangely behaving sequences. Those with higher fractions of unresolved quartets, may be (a) wrongly aligned, (b) not homologous to the others meaning they should not be added to the alignment because they might have been chosen due to some sequence similarity in a BLAST search, (c) belong to a cluster of (nearly) identical sequences, (d) very distantly related out group which has acquired too much noise to be reliably placed (e.g. using E coli as an outgroup for primates ;) etc. So likelihood mapping is an indicator that there might be something \u2018wrong\u2019 or not enough information, but it depends on your question whether it still contains enough information to answer that question. Indicators like the sequence-specific quartet statistics, pairwise distances, (very importantly) a look into the alignment, number of (parsimony) informative/uninformative/identical sites, etc are useful to figure out what are the causes of a high fraction of unresolved. Furthermore, please note: if you compare the values from IQ-TREE to those of TREE-PUZZLE (the publications all relate to TREE-PUZZLE results), the fraction of partly/unresolved quartets in IQ-TREE is typically higher that from TREE-PUZZLE. The reason is to following - while TREE-PUZZLE used branch lengths estimated by least squares from the pairwise distances for the likelihood mapping (the default 'approximate likelihood option'), IQ-TREE does fully optimise the branch lengths which may produce three more similar likelihood values and those dot \u2018moving\u2019 towards the center of the diagram. In TREE-PUZZLE one get the same effect, if one chooses the 'exact likelihood option\u2019, which was rarely done because it costs more time - IQ-TREE on the other hand is fast enough to do so. Aside from the known seq-length effect, is it still valid? What do you mean by that?!? - Short sequences might not contain enough information to resolve the quartets, and subsequently an overall tree. - Long (multi-locus) sequences provide more information which might be useful to resolve quartets and the overall tree, however that does not mean the you do not have conflicting signals in there caused e.g. by recombination or strong discrepancies between gene-trees and the species-tree. So, both scenarios are \u2018still valid\u2019 and remain to be. Moreover, not all datasets are there to resolve species-trees. If one is interested in the history of a certain gene-superfamily, there is no way to extend the dataset beyond the boundaries on the genes (if one is lucky maybe up to some syntenic region). Even worse if people try to resolve a tree from hundreds of short binding motifs\u2026 So this will also remain valid. One last point. Suppose we can make a decision from the graphs (triangles); how do we make use of the detailed info in the .iqtree outfile? As mentioned above, there are no generally applicable cutoffs\u2026 for the reasons mentioned above. Namely: Quartet support of regions a1, a2, a3 (mainly for clustered analysis) If one of the the 3 regions contain a clear majority of dots, the topology at the associated corner is the most supported one. Still one should have a look at the 7-area-triangle, because if most if these dots actually fall into the center, one may tend to speculate, but this is only a trend. Quartet support of areas 1-7 (mainly for clustered analysis) If a strong majority falls into one of the corners the topology at the associated corner may be claimed to be strongly supported by the analysis. Even if there are two similar well supported corners (plus a rectangle between them with many dots), this may help to rule out one of the 3 hypotheses/topologies. Please note, that in a 2- or 3-cluster analysis, not all corners have their own meaning. For instance, in a 2-cluster analysis (A1,A2|B1,B2) supports the tested branch, while (A1,B1 | A2,B2) and (A1,B2 | A2,B1) contradict it. In an unclustered analysis, the corners have to be summed up, as have to be the rectangles, because the collect the fully resolved and the partly resolved quartets, respectively. Quartet resolution per sequence (phylogenetic information) See above\u2026 the per-sequence-statistics helps you to determine whether there are certain sequences causing problems or are more reliably placed that others. Attached the output of my analyses. How would you interpret the results? The critical value, I would say, is the 21.6-21.7% of unresolved quartets in the middle. Furthermore, as I said above \u201cIn an unclustered analysis, the corners have to be summed up, as have to be the rectangles, because the collect the fully resolved and the partly resolved quartets, respectively\u201d - so the 3 values you find summed up in the iqtree-file are more meaningful than the plots. The values 64.7% resolved, 13.6% partly resolved and 21.7% unresolved are reasonably close to 66.7%, 11.7%, 21.6% from a 2nd run. The fluctuations result from the fact that the 3000 quartets you have specified on the command line are chosen randomly. The higher this number the closer the values should be in the end. Whether this number 3000 is enough also depends on the number of sequences you have in your dataset. As the IQ-TREE manual specifies, the number of quartet sampled for the analysis (-lmap) should be at least 25 times the number of sequences in the dataset. This means every sequence would be selected about 100 times on average (because each quartet has 4 sequences to be chosen), to gain a resolution of about 1% (higher numbers are certainly better but often not necessary to get an overview). The per-sequence quartet statistics tells you how often each sequence has been chosen exactly. I hope that answers some of your questions and explains why (unfortunately) it is not possible to define an one-serves-all threshold. Best wishes, Heiko ", "Dear Minh and Heiko, Very clear and exhaustive answers, as usual, thanks to both of you. I\u2019m glad this discussion touched on the basics of phylogenetic analysis. Indeed, this was the intended aim for posting my question to the forum (as Minh suggested). It needs to be repeated over and over again that the alignment not always provides enough phylogenetic signal. A paradigmatic case in point is the phylogeny I\u2019m working on: Hox genes. I hope that as many newcomers to phylogeny as possible will read Heiko\u2019s detailed comments. Particularly the last sentence, to which I subscribe entirely, is very telling \u201c\u2026 (unfortunately) it is not possible to define a one-serves-all threshold.\u201d I think Hieko\u2019s comments could well make an appendix to the manual (or of a tutorial). This may stimulate people to use the powerful lik-mapping methods developed in IQ-TREE, and pre-analysis of the alignment in general. >>Aside from the known seq-length effect, is it still valid? >What do you mean exactly? Simply, short seqs = small phylogenetic signal (this at least I gave for granted) >This would be my interpretation: (Cluster1,Cluster3)-(Cluster2,Cluster4) is the most likely split as >it is the supported by 51.2% of the quartets and 26.9% fully resolved quartets. >(Cluster1,Cluster2)->(Cluster3,Cluster4) is the >most unlikely split. makes sense! >Whether this number 3000 is enough also depends on the number of sequences you have in your >dataset. Indeed, my dataset is 120 seqs. Once again, thanks for you great work. All the best, Giorgio ", "Dear all, I think these new preprints will be interesting considering the quartet(s) topic: http://www.biorxiv.org/content/early/2017/07/27/168526 http://www.biorxiv.org/content/early/2017/06/10/148536.1 Best, maxmaronna ", "Dear all, comming back to the interpretation of the LM mapping results (four clusters), I have again 2 quick questions: concerning the output *.quartetlh: 1), lh1, 2, 3 show the logLH for4 the different unambiguous topologies (area 1, 2, 3), correct? what exactly is meant by the \"weight\" values? the area refers to the area 1-7, correct (and in which area the quartet is assigned to), but \"corner\" here is not 1, 2, 3 but a1, a2, a3 - correct? (I am little confused sorry) 2) is there a way to get the branch lengths for each calculated quartet? Many thanks, best Karen ", "Hi Karen again, On 31 Jan 2019, at 12:28 am, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Dear all, comming back to the interpretation of the LM mapping results (four clusters), I have again 2 quick questions: concerning the output *.quartetlh: 1), lh1, 2, 3 show the logLH for4 the different unambiguous topologies (area 1, 2, 3), correct? Heiko, pls correct me if I\u2019m wrong, but let\u2019s look at an example: SeqIDs lh1 lh2 lh3 weight1 weight2 weight3 area corner (8,3,17,16) -7456.47 -7532 -7522.94 1 0 0 1 1 lh1 is the log-likelihood of the quartet tree {8,3} | {17,16} lh2 is the log-likelihood of the quartet tree {8,17} | {3,16} lh3 is the log-likelihood of the quartet tree {8,16} | {3,17} weight1 = exp(lh1) / (exp(lh1)+exp(lh2)+exp(lh3)) weight2 = exp(lh2) / (exp(lh1)+exp(lh2)+exp(lh3)) weight3 = exp(lh3) / (exp(lh1)+exp(lh2)+exp(lh3)) (That means, they are the likelihood weights of the 3 quartets). what exactly is meant by the \"weight\" values? the area refers to the area 1-7, correct (and in which area the quartet is assigned to), but \"corner\" here is not 1, 2, 3 but a1, a2, a3 - correct? (I am little confused sorry) The area and corner should follow this notation (excerpt from .iqtree file): (a,b)-(c,d) (a,b)-(c,d) /\\ /\\ / \\ / \\ / \\ / 1 \\ / a1 \\ / \\ / \\ /\\ /\\ / \\/ \\ / \\ / \\ / /\\ \\ / \\ / \\ / 6 / \\ 4 \\ / \\/ \\ /\\ / 7 \\ /\\ / | \\ / \\ /______\\ / \\ / a3 | a2 \\ / 3 | 5 | 2 \\ /__________|_________\\ /_____|________|_____\\ (a,d)-(b,c) (a,c)-(b,d) (a,d)-(b,c) (a,c)-(b,d) so area is 1 to 7 and corner is 1 to 3 (a1 to a3 in this figure). 2) is there a way to get the branch lengths for each calculated quartet? There is no such option\u2026 Minh Many thanks, best Karen ", "Hi Karen, To avoid misunderstandings and ambiguities, the details of likelihood mapping are described in every *.iqtree file if likelihood mapping is performed: -------------------------------------------------------------- Taken from an *.iqtree file: -------------------------------------------------------------- LIKELIHOOD MAPPING STATISTICS ----------------------------- (a,b)-(c,d) (a,b)-(c,d) /\\ /\\ / \\ / \\ / \\ / 1 \\ / a1 \\ / \\ / \\ /\\ /\\ / \\/ \\ / \\ / \\ / /\\ \\ / \\ / \\ / 6 / \\ 4 \\ / \\/ \\ /\\ / 7 \\ /\\ / | \\ / \\ /______\\ / \\ / a3 | a2 \\ / 3 | 5 | 2 \\ /__________|_________\\ /_____|________|_____\\ (a,d)-(b,c) (a,c)-(b,d) (a,d)-(b,c) (a,c)-(b,d) Division of the likelihood mapping plots into 3 or 7 areas. On the left the areas show support for one of the different groupings like (a,b|c,d). On the right the right quartets falling into the areas 1, 2 and 3 are informative. Those in the rectangles 4, 5 and 6 are partly informative and those in the center (7) are not informative. Sequences a,b,c,d are drawn from all included sequences. Note, that the corners only make a difference if the sequences are clustered in groups. Furthermore, while sequences should occur about equally often in unclustered mappings, in clustered mappings their occurrence rates depend on the group sizes the quartets are drawn from. For more information about likelihood-mapping refer to - Schmidt and von Haeseler (2009) The Phylogenetic Handbook, 2nd Ed. (by Lemey et al., Eds.), 181-209, Cambridge Univ. Press, UK. http://www.thephylogenetichandbook.org - Schmidt and von Haeseler (2003) Current Protocols in Bioinformatics (by Baxevanis et al., Eds.), Unit 6, Wiley&Sons, New York. http://dx.doi.org/10.1002/0471250953.bi0606s17 and/or - Strimmer and von Haeseler (1997) PNAS 94:6815-6819 http://www.ncbi.nlm.nih.gov/pubmed/9192648 -------------------------------------------------------------- So, in case of confusions it is always a good idea to have a look (and possibly at the references given for further advice). Other than that - from what I saw, Minh\u2019s answers are correct! >> 1), lh1, 2, 3 show the logLH for4 the different unambiguous topologies (area 1, 2, 3), correct? As Minh points out, the three likelihood refer to the three quartet topologies (ab|cd), (ac|bd) and (ad|bc), respectively. Whether the dot really falls into area a1, a2 or a3 depends on the relative weights. The weights are computed as defined in the original likelihood mapping paper by Strimmer and von Haeseler (and also described in various other places), and computed as noted down by Minh below. So they are each likelihood (not log-likelihood!) divided the sum of all likelihoods. Which area a dot falls into is determined examining the least square distance to the respective 'ideal' weights of the 7 (or 3) areas (please rf to the original paper if you need the details). Area a1 and area 1 refer to the same corner, but a1 refers to a third on the whole triangle while 1 is smaller because it takes party and unresolved quartets into account. I hope that answers your questions. Best wishes, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Dear Heiko, Minh thanks - and yes I understand/ understood the *.iqtree files. I just was confused with the \"naming\" in the quartetlh file what exactly you mean with \"corner\" areas 1, 2, 3 (quartet resolved, right simplex) - or a1, a2, a3 (right simplex). When I do get Mih correct \"corner\" refers to a1, a2, a3. Thanks for the other answers (weights and lh meaning) and for below explanations. @Minh: the branch lengths for each calculated quartet - would it be dicfficult to implement such an otion? (I am aware that it might be not useful since the of quartets might be very high, still it could be interesting for further research ... Many thanks Karen ", "> On 31 Jan 2019, at 18:36, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: > Dear Heiko, Minh > thanks - and yes I understand/ understood the *.iqtree files. I just was confused with the \"naming\" in the quartetlh file > what exactly you mean with \"corner\" areas 1, 2, 3 (quartet resolved, right simplex) - or a1, a2, a3 (right simplex). When I do get Mih correct \"corner\" refers to a1, a2, a3. When I talk about the corners of a simplex, I mean top, bottom right and bottom left. Each is referring to a certain quartet topology. The top corner refers to (ab|cd) etc, and that is the same whether you split the triangle or simplex into 3 areas (a1, a2, a3) or into 7 (1-7). So it is more clear to refer to the areas, that means either a1-a3 or 1-7 - depending on what one needs (general trend or taking ambiguity into account). The term corner is too universal here and applies to both partitions of the simplex. Best wishes, Heiko > Thanks for the other answers (weights and lh meaning) and for below explanations. > @Minh: the branch lengths for each calculated quartet - would it be dicfficult to implement such an otion? (I am aware that it might be not useful since the of quartets might be very high, still it could be interesting for further research \u2026 > Many thanks Karen > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Hi Heiko, I totally fully agree. Exactly this was the reason for my earlier question: in the output file *.lmap.quartetlh the header is: \"SeqIDs lh1 lh2 lh3 weight1 weight2 weight3 area corner\" so if here is area refers to area 1-7 and corner refers to area a1, a2, a3, maybe it would be more clear if you change this header in one of the next releases? Best, Karen ", "Dear Karen, I realised that in the last email we were talking about two different things - I was talking about the reference from corners to trees and you were talking about the column header in the file (as you actually pointed out - sorry). In that file, I cannot think about a better column head for that one, because we cannot name them both \u201carea\u201d, and adding an \u201ca\u201d to every line in the last column is adding redundant information making the file unnecessarily larger. So, yes as Minh pointed out the corners refer to the areas a1, a2 and a3 which are the areas if a dot falls into it, the dot will be closer to that corner than to any of the other two. Furthermore, when looking at the content of the column area, it contains numbers 1-7, while corners contains exactly only 1-3. So I object in renaming it in a future release, because that might break parsers and e.g. R scripts relying on the column naming, but I suggest we add some explanation of the columns to the documentation. We didn\u2019t think of that because so far it is (a) rarely used by users who usually are mainly interested in the total percentages and (b) nobody had asked ;) Best regards, Heiko Campus Vienna Biocenter 5 (VBC5) A-1030 Vienna, Austria ----------------------------------------------------------------------------- Email: heiko.schmidt(AT) univie.ac.at Tel. : ++43 +1 / 4277 - 74321 http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Dear Heiko, thanks - yeah i might have been not clear enough also maybe. Anyway, I definitely would add it in an explanation at leat - or changing the header to \"area_1_7 and corner_a1_a2_a3 (this might not be difficult i hope - anyway, its up to you, but without explanation its not really clear. I am not sure to what you refer with a) and b) - anyway, I am mainly interested in the areas 1, 2, 3 (out of 7) because only these have \"resolved\" quartets - of course, a1, a2, a3 is also interesting, but I usually do not consider these in my analyses when i try to find out whether counfounding signal might have driven a tree topology (see e.g. Sann et al. 2018), or Simon et al. 2018) Best, Karen "]}, "aJhwvQowfPY": {"topic": "IQ-TREE release 1.6.8", "initializeDate": "Oct 28, 2018, 8:01:22 AM", "timeStamp": "Oct 28, 2018, 8:01:22 AM", "content": ["Dear users, We\u2019re glad to release the maintenance version 1.6.8 with following important change: \u2022 AU test is now available again using maximum likelihood estimates of p-values. The previous version implemented the least square approach, which may show discrepancy for extremely small p-values. See https://github.com/Cibiv/IQ-TREE/issues/86 for full details. Bugfixes: \u2022 Crash with model selection for mixed data type (reported by Paul Frandsen). \u2022 Crash with model selection when partitions <= 2 (reported by Michele Leocadio). \u2022 Reading non-reversible models from file. \u2022 Error message \u201cA taxon has no name\u201d to \u201cRedundant double-bracket\u201d. Best, Minh "]}, "IVlb_DvahHY": {"topic": "Rate value reported in IQtree/LSD", "initializeDate": "Apr 22, 2021, 2:32:31 PM\u00a0(5 days ago)\u00a0", "timeStamp": "Apr 26, 2021, 11:29:22 AM\u00a0(2 days ago)\u00a0", "content": ["LSD dating analyses logs include output like this: - Results with confidence intervals: rate 0.00264125 [0.00255789; 0.00287068] , tMRCA -203 [-203; -203], objective function 1.96836 My question is: Is the rate (in this case 0.00264125) the equivalent of the substitution rate reported in the output of the PAML BASEML program? In that program I believe the reported rate is substitutions per site per unit time. Thank you! Ted Schultz ", "Hi Ted Schultz, Yes the rate reported by LSD is also the number of substitutions per site per unit of time. Best regards, Hien You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CACRs7N%2BHC%3DCcb-8NhV04FGomHOvWf4_%3DHfmdv27%3D%3Dhhpr-6hJA%40mail.gmail.com ", "Hien: Thank you for this reply!!! Ted To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAKjtwTxkbooJZKDhvwSig6OGXpX2_ic-ojbOm7QYChXKVTE%2BFw%40mail.gmail.com ", "Hien: I have another question. What is the unit of time? The substitution rate is substitutions per site per unit time. Is the unit 1 million years? I wish to know if LSD uses the same time units as BASEML/mcmcTree. I do not know what units BASEML/mcmcTree uses, either. Thank you! Ted Schultz On Sat, Apr 24, 2021 at 3:20 PM Hien To < toth...@gmail.com > wrote: To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAKjtwTxkbooJZKDhvwSig6OGXpX2_ic-ojbOm7QYChXKVTE%2BFw%40mail.gmail.com "]}, "_a2XhqsmZa8": {"topic": "optimal number of threads with large number of taxa", "initializeDate": "Apr 13, 2020, 6:10:07 PM", "timeStamp": "Apr 13, 2020, 10:00:33 PM", "content": ["Hi Minh, Some colleagues and I are running a data set in IQtree 2.0rc2 with a rather large number of taxa (2,300) and a moderate number of sites (~150,000 nt/~50,000 aa). I have a couple of questions: 1. When I used -nt AUTO, it chooses 2 threads as the optimal number. This seemed low to me given there are 150,000 sites and, as far as I understand it, the primary advantage of parallelization is in splitting up the calculation of each site likelihood. Would be this be behavior that you would expect? Is there any unwanted behavior if we choose many more cores than this? 2. We're running multiple searches, but are running into limits on our respective clusters in terms of use. Since each search is taking >1 month, do you have any advice on how to perform the quickest ML tree search (without cutting corners)? E.g. is there anything in the default search that we can cut out/share among analyses if we are running multiple searches on the same data set? Many thanks, Paul ", "Hi Paul, On 14 Apr 2020, at 8:10 am, Paul Frandsen < paulbf...@gmail.com > wrote: Hi Minh, Some colleagues and I are running a data set in IQtree 2.0rc2 with a rather large number of taxa (2,300) and a moderate number of sites (~150,000 nt/~50,000 aa). I have a couple of questions: 1. When I used -nt AUTO, it chooses 2 threads as the optimal number. This seemed low to me given there are 150,000 sites and, as far as I understand it, the primary advantage of parallelization is in splitting up the calculation of each site likelihood. Would be this be behavior that you would expect? Is there any unwanted behavior if we choose many more cores than this? Indeed, 2 threads seem too low for this dataset. But to be more precise, the parallel efficiency depends on the number of distinct site patterns in your alignment. How many do you have (from the log file)? Can you pls send me the log file. 2. We're running multiple searches, but are running into limits on our respective clusters in terms of use. Since each search is taking >1 month, do you have any advice on how to perform the quickest ML tree search (without cutting corners)? E.g. is there anything in the default search that we can cut out/share among analyses if we are running multiple searches on the same data set? I\u2019d say you only have to run ModelFinder once. And then use the same model for all subsequently tree searches, where you can use the MPI version to further reduce the waiting time. If you can share me the log file, then I can give more specific advice. Cheers Minh Many thanks, Paul You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0e9d6720-81f5-44e2-a93b-0dde22fb56df%40googlegroups.com "]}, "ArYsRocCk5E": {"topic": "ERROR too large ID using DNA and CODON5", "initializeDate": "Jan 9, 2019, 3:49:30 AM", "timeStamp": "Jan 12, 2019, 3:24:19 AM", "content": ["Hi all, I have a problem with my partition file: The error in iqtree v1.6.7 says: ERROR: Too large site ID Cannot figure out why. Here is my partition.nex #nexus begin sets; charset part1 = codon.aln:CODON5, 1-11367; charset part2 = mitomarker2.aln: 11368-12502; charset part3 = mitomarker3: 12503-13319; charset part4 = mitomarker4: 13320-14655; charset part5 = nuclearmarker5: 14656-15063; charset part6 = nuclearmarker6.aln: 15064-17243; charset part7 = nuclearmarker7.aln: 17244-20848; charpartition mine = GY+F+R6:part1, GTR+F+I+G4:part2, TIM3+F+I+G4:part3, GTR+F+I+G4:part4, K2P+G4:part5, TN+F+I+G4:part6, TIM3+F+I+G4:part7; end; Also, since I am using mito genes (codon), mitorRNA, and nuclear genes .. I believe I should call my work as -sp partition.nex, right? Any suggestion? ", "Hi there, On 9 Jan 2019, at 3:49 pm, gusta10 < gus.san...@gmail.com > wrote: Hi all, I have a problem with my partition file: The error in iqtree v1.6.7 says: ERROR: Too large site ID Cannot figure out why. Here is my partition.nex #nexus begin sets; charset part1 = codon.aln:CODON5, 1-11367; charset part2 = mitomarker2.aln: 11368-12502; charset part3 = mitomarker3: 12503-13319; charset part4 = mitomarker4: 13320-14655; charset part5 = nuclearmarker5: 14656-15063; charset part6 = nuclearmarker6.aln: 15064-17243; charset part7 = nuclearmarker7.aln: 17244-20848; charpartition mine = GY+F+R6:part1, GTR+F+I+G4:part2, TIM3+F+I+G4:part3, GTR+F+I+G4:part4, K2P+G4:part5, TN+F+I+G4:part6, TIM3+F+I+G4:part7; end; This error means that the position range exceeds the number of sites in the alignment. Quick look at your partition file: part2 should start from 1 instead of 11368, because this is a different alignment file (mitomarker2.aln) compared with part1 (codon.aln). The same for all other partitions. Also, since I am using mito genes (codon), mitorRNA, and nuclear genes .. I believe I should call my work as -sp partition.nex, right? I would perform both edge-unlinked (-sp) and edge-linked (-spp) analysis, and then look at the BIC/AICc score of the resulting trees printed in .iqtree file. The one with lower BIC/AICc scores will be preferred. Cheers Minh Any suggestion? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "16O0ugns29s": {"topic": "Bug -  pllPartitionsValidate", "initializeDate": "Jun 24, 2018, 2:59:29 PM", "timeStamp": "Jun 30, 2018, 9:39:34 PM", "content": ["Hi all, refering to my question yesterday: when I start either ML trees or BS trees with a random starttree, /e.g. with the comand: iqtree -s FcC_supermatrix.fas -st CODON -spp codon.best_scheme.nex -gmedian -pre codon_nt_bacoca_0.8_boot_1_20 -t RANDOM -safe -bo 20 -nt 20 It immendiatel crashes: e.g. with following message: 493 CODON 151 131 MGK+F1X4+R2 EOG090R0GOD 494 CODON 737 592 MGK+F3X4+R2 EOG090R03P4 495 CODON 441 293 SCHN05+F1X4+G4 EOG090R04CJ 496 CODON 963 668 MGK+F3X4+R4 EOG090R024X 497 CODON 211 185 MGK+F3X4+R2 EOG090R0AZR 498 CODON 255 223 MGK+F3X4+R2 EOG090R0DPK Degree of missing data: 0.000 Info: multi-threading strategy over partitions ERROR: pllPartitionsValidate (I also tried 1.6.2 and 1.5.5 - but same error). Does this not work with random start trees? (would be better at least for BS replicates due to recent discussions...) Best, Karen ", "Hi Karen, This is actually a different bug which I just fixed in a beta version: https://github.com/Cibiv/IQ-TREE/releases/tag/v.1.6.6.b Wrong error with codon models and -t RANDOM (reported by Karen Meusemann) Can you please test this? Thanks for the report. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, ok I will test it and let you know as soon as possible! Many thanks in advance. (I guess the LG4x/M bug will also be fixed in a version 1.6.6 later on, right?) Karen ", "Hi Minh, I used now the version 1.6.6beta and did - normal ML tree searches with parsimony start tree: they finished successfully - ML tree searches with random start trees: they finished successfully - BS (in batches of 20 BS replicates: 2 jobs crashed after ca. 12 hours, the others are still running (now with no error after 23 h last lines of the ones that failed: WARNING: Estimated model parameters are at boundary that can cause numerical instability! BETTER TREE FOUND at iteration 1: -4181831.433 Iteration 10 / LogL: -4181833.655 / Time: 1h:16m:47s Iteration 20 / LogL: -4181832.545 / Time: 1h:30m:46s Finish initializing candidate tree set (1) Current best tree score: -4181831.433 / CPU time: 3419.270 Number of iterations: 20 -------------------------------------------------------------------- | OPTIMIZING CANDIDATE TREE SET | -------------------------------------------------------------------- ERROR: iqtree.cpp:3193: virtual std::pair<int, int> IQTree::optimizeNNI(bool): Assertion `appliedNNIs.size() != 1' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 6 IQTree::optimizeNNI(bool) ERROR: 7 IQTree::doNNISearch() ERROR: 8 IQTree::doTreeSearch() ERROR: 9 runTreeReconstruction(Params&, IQTree*&) ERROR: 10 runStandardBootstrap(Params&, Alignment*, IQTree*) ERROR: 11 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 12 main() ERROR: 13 __libc_start_main() ERROR: 14 _start() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: codon_nt_bacoca_0.8_boot_r_v166b_81_100.log ERROR: *** Alignment files (if possible) command that i used: Command: iqtree -s FcC_supermatrix.fas -st CODON -spp codon_nt_bacoca_0.8_1.best_scheme.nex -gmedian -pre codon_nt_bacoca_0.8_boot_r_v166b_81_100 -t RANDOM -safe -bo 20 -nt 20 Maybe i will see if the remaining 3 jobs finish successfully or/and crash as well and then we see how to go on? All the best, but at least the \"pllPartitionsValidate\" Error is not there anymore... :) or do you want to send me Alignment, model file and one of the failed BS logfiles? Best, karen ", "Hi Minh, all jobs succesfully finished (with the last beta version (1.6.6.c) :) many many thanks for fixing it so quickly !! have all a nice sunday Karen "]}, "tyfZ0o_V-jA": {"topic": "MERGE PARTITIONS WEIGHTS-CRITERIA", "initializeDate": "Oct 2, 2017, 12:55:35 PM", "timeStamp": "Oct 5, 2017, 5:32:28 AM", "content": ["Dear iqtree developers, I want to ask what is the criterion for calculating the similarity of subset when using the TESTMERGEONLY and MF+MERGE options. I know that in partitionfinder there is an option called weights 'x,x,x,x' which basically correspond to weight values for model, rate, frequency, and alpha parameter of the gamma distribution. Is there sth similar in iqtree and if not how is the similarity calculated? Many thanks Alex ", "Dear Alex, IQ-TREE only takes the rate into account, i.e. model, frequency or alpha are disregarded. In other words, the similarity between partitions is based on the rates alone. I believe that is also the default option in PartitionFinder. At some point I also thought about supporting such a weighting. But then Rob Lanfear told me that users rarely change the default option. Moreover, there is no good sense of how to weight the parameters. Therefore I decided not to implement such option in IQ-TREE. If you however have some compelling reason then I\u2019m happy to reconsider it. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Thanks a lot for the answer. Could please elaborate a bit more about this rate calculation? Is this a substitution rate or an evolutionary rate? And if the second how is it calculated? Best wishes and thanks again Alex ", "Hi Alex, With rates I mean the sum of branch lengths of the partition tree (or tree length). Fast/slow evolving partitions will have high/low tree length. ModelFinder will consider to merge partitions having similar evolutionary rate. You can think of this partition rate as an average rate across all sites in the partition. This is of course not substitution rates (A-C,A-G etc.). Note that this discussion is only valid when you use -rcluster option. Cheers, Minh "]}, "ytdRj-Zi7Gc": {"topic": "IQ-TREE web site down due to power outage", "initializeDate": "Mar 24, 2020, 1:39:12 AM", "timeStamp": "Mar 24, 2020, 6:10:56 PM", "content": ["Dear Users, Some of you have experienced that the two websites: http://www.iqtree.org http://iqtree.cibiv.univie.ac.at are not accessibile at the moment \u2014 There was a power outage at the servers hosting these sites and the admin is currently trying to bring them back to life. For the moment please try other alternatives: 1. If you want to download the latest version of IQ-TREE, go to: https://github.com/Cibiv/IQ-TREE/releases https://github.com/Cibiv/IQ-TREE/releases/tag/v1.6.12 (for the stable version 1.6.12). 2. If you want to read the documentation, go to: https://github.com/Cibiv/IQ-TREE/wiki 3. If you want to use web servers, there are other alternatives: http://www.phylo.org https://www.hiv.lanl.gov/content/sequence/IQTREE/iqtree.html I\u2019ll send a notice here once the service is back to normal. Thanks for your understanding, Minh ", "Dear Users, Both websites are now back to normal. Thanks for your patience. Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/F22C399C-3971-45C5-8E39-400408127975%40univie.ac.at "]}, "Qot7CYtyoso": {"topic": "A new IQ-TREE web server", "initializeDate": "Sep 20, 2017, 8:24:49 PM", "timeStamp": "Sep 20, 2017, 8:24:49 PM", "content": ["Dear users, The HIV database resource at the Los Alamos National Laboratory ( https://www.hiv.lanl.gov/ ) kindly created a new web server for IQ-TREE freely available at: https://www.hiv.lanl.gov/content/sequence/IQTREE/iqtree.html Thus you can freely submit your IQ-TREE analysis online there. Compared with our current web server ( http://iqtree.cibiv.univie.ac.at ), this new web server provides a default option to compute site-specific evolutionary rates and a few neat options to root the tree (e.g. midpoint rooting). Special thanks for Brian Foley and Hyejin Yoon for this wonderful work! Best, On behalf of the IQ-TREE team. Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "3IWuMiytWYI": {"topic": "Nonparametric bootstrap (-bo)", "initializeDate": "Feb 8, 2017, 12:24:22 PM", "timeStamp": "Feb 8, 2017, 4:28:28 PM", "content": ["Hi, I used the option -bo 1000 to generate 1000 nonparametric bootstrap trees. According to the documentation: Like but only perform bootstrap analysis (no analysis on original alignment and no consensus tree). I was wondering, since no ML search is performed, what is the tree in the *.treefile file that is written ? Thanks, Julien ", "Hi Julien, the tree in .treefile is the ML tree of the last bootstrap replicate. It would be the same as the last tree in *.boottrees file. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Ok, thanks a lot ! Bests, Julien "]}, "B24ygExj3BI": {"topic": "Sample size in ModelFinder", "initializeDate": "May 10, 2018, 7:16:22 AM", "timeStamp": "May 10, 2018, 7:44:02 AM", "content": ["Hi all, I was wondering how the sample size is defined in ModelFinder with respect to AICc and BIC. Is it the number of columns in the alignment? Can you also tell me what are the reasons for the used definition of sample size, and if what is the knolwedge in the field regarding how to choose the value of the sample size? Many thanks! Nicola ", "Hi Nicola, Great to hear from you. Yes, the default sample size is the number of columns in the alignment. The reason is because this is also the default in jModelTest and ProtTest programs. But frankly there is no theoretical justification for this, to my knowledge. David Posada had some paper about this (sorry I don\u2019t recall right now) and he experimented other definitions such as the size of data matrix (#columns * #sequences) but there was no conclusive answer. So the literature about this in phylogenetics is quite under-represented, I think. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "Je4OJQaiN3Y": {"topic": "How to test \"GHOST\"-Model with ModelFinder", "initializeDate": "Jan 17, 2018, 11:55:55 AM", "timeStamp": "Jan 26, 2018, 7:36:09 AM", "content": ["Hello all, How can I test the \"GHOST\"-Model with ModelFinder? All the best Dieter ", "Hi Dieter, There was a discussion a few weeks ago about this. Please search the group. In short, use -mrate option, e.g. -mrate G,R,H to find out which rate heterogeneity model among Gamma, free-rate and heterotachy is best for your data set. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thank you Minh, will search the forum for that discussion, but, I can not select the \"H\"-option at http://iqtree.cibiv.univie.ac.at/ Does that mean I only can test it with the local version? All the best Dieter ", "Yes that\u2019s right. The web version has much limited functionality compared with a local version! Minh "]}, "Dw4rl-SYxqY": {"topic": "A bootstrap tree with a higher likelihood for the original alignment than the ML tree for that alignment", "initializeDate": "Nov 7, 2017, 6:30:55 AM", "timeStamp": "Aug 8, 2018, 2:52:05 PM", "content": ["Hi, I'm currently running some topology tests, and in the treelist, I'm including all bootstrap trees (with branch lengths). The treelist also includes the ML tree. Strangely, at least 1 bootstrap tree seems to have a higher likelihood for the original alignment than the ML tree. Have you ever observed something like that before? ML search (unconstrained): iqtree-omp -s alignment.aln -m LG+C60+F+G -ft guidetree.treefile -nt 20 -pre noConstraint.PMSF -b 100 -wbtl -redo I also take the bootstrap trees from this search to include in the AU test (see below) ML search (constraints for the topologies I wish to test) iqtree-omp -s alignment.aln -m LG+C60+F+G -ft guidetree.treefile -g topology1.constraint -nt 20 -pre topology1.PMSF -quiet -redo iqtree-omp -s alignment.aln -m LG+C60+F+G -ft guidetree.treefile -g topology2.constraint -nt 20 -pre topology2.PMSF -quiet -redo etc.... Topology test: iqtree-omp -s alignment.aln -m LG+C60+F+G -ft guidetree.treefile -nt 20 -pre TopologyTest -z forTopologyTest.treelist -n 1 -zb 10000 -zw -au -fixbr -wsl -quiet -redo So here the forTopologyTest.treelist includes the ML tree, the constraint ML trees and the unconstrained ML bootstraps. I have done this test for many alignments (PMSF + non-parametric bootstraps and LG+C60+F+G + ultrafastbootstraps), but this phenomenon only occurs in one particular alignment. Could it be that the unconstrained ML search was not able to find the \"true\" ML tree that the particular bootstrap tree represents? I'm currently running another 10 independent ML searches with -pers 0.2 and -numstops 500 to see if it finds another unconstrained ML tree compared to my original search. Cheers, Joran ", "Dear Joran (CC Huaichun, Ed, Andrew), On Nov 7, 2017, at 12:30 PM, Joran Martijn < joran...@gmail.com > wrote: Hi, I'm currently running some topology tests, and in the treelist, I'm including all bootstrap trees (with branch lengths). The treelist also includes the ML tree. Strangely, at least 1 bootstrap tree seems to have a higher likelihood for the original alignment than the ML tree. Have you ever observed something like that before? Indeed I never observed this. But I think it\u2019s not totally unexpected. In case the original tree search stuck in (bad) local optimum. But that really depends on the alignments, typically those with many sequences and few sites (ie. low phylogenetic signals). ML search (unconstrained): iqtree-omp -s alignment.aln -m LG+C60+F+G -ft guidetree.treefile -nt 20 -pre noConstraint.PMSF -b 100 -wbtl -redo I also take the bootstrap trees from this search to include in the AU test (see below) ML search (constraints for the topologies I wish to test) iqtree-omp -s alignment.aln -m LG+C60+F+G -ft guidetree.treefile -g topology1.constraint -nt 20 -pre topology1.PMSF -quiet -redo iqtree-omp -s alignment.aln -m LG+C60+F+G -ft guidetree.treefile -g topology2.constraint -nt 20 -pre topology2.PMSF -quiet -redo etc\u2026. All commands look good Topology test: iqtree-omp -s alignment.aln -m LG+C60+F+G -ft guidetree.treefile -nt 20 -pre TopologyTest -z forTopologyTest.treelist -n 1 -zb 10000 -zw -au -fixbr -wsl -quiet -redo So here the forTopologyTest.treelist includes the ML tree, the constraint ML trees and the unconstrained ML bootstraps. Now I see more clearly. There are three things I want to discuss here: - I never used tree testing with the posterior mean site frequency model (-ft coupled with -z options). The main reason is because I\u2019m not 100% sure if the site-log-likelihoods computed under the PMSF model can be used for further tree testing. I guess it\u2019s OK as long as you used the same guide tree throughout the analysis. But my co-authors can confirm this. - There is discrepancy between the AU test implementation in IQ-TREE and CONSEL (technically: IQ-TREE used the least-square p-value estimates whereas CONSEL uses the ML p-value estimates). Thus, for now please run CONSEL, as you already printed the site-log-likelihoods via -wsl. Note that the results with other test (SH etc) are comparable. - I would also do the tree test using the mixture model LG+C60+F+G, just to see how the results look like compared with PMSF. I have done this test for many alignments (PMSF + non-parametric bootstraps and LG+C60+F+G + ultrafastbootstraps), but this phenomenon only occurs in one particular alignment. Could it be that the unconstrained ML search was not able to find the \"true\" ML tree that the particular bootstrap tree represents? Yes, quite likely. I would repeat a few more runs (as you wrote below) and look whether it improves. Thanks for bringing this problem into attention. Cheers, Minh I'm currently running another 10 independent ML searches with -pers 0.2 and -numstops 500 to see if it finds another unconstrained ML tree compared to my original search. Cheers, Joran You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Joran, It has been a while since I last used IQ-Tree, so I am not so sure whether the following behaviour is still valid (Minh can correct me if I am wrong). When IQ-Tree is fed with a list of trees for topology test, it will use the very first tree in the file to estimate the model parameters and uses these estimates to compute the likelihood of the remaining trees. Thus, these estimates are only optimized for the first topology and they are not necessarily optimized for the remaining topologies. For simple models this usually does not pose a problem. However, for parameter rich models I can imagine that the reported likelihoods of the other trees might not be the maximum. Thus, you can try to compute the maximum likelihood of the 2 trees in 2 independent runs to see if the result is still what you observed. In this setting, each tree will get its own set of optimized parameters and we would get the true maximum likelihood. Cheers Tung ", "Indeed I never observed this. But I think it\u2019s not totally unexpected. In case the original tree search stuck in (bad) local optimum. But that really depends on the alignments, typically those with many sequences and few sites (ie. low phylogenetic signals). In this case the alignment is 8402 sites long, over 83 sequences. So I wouldn't say it has low phylogenetic signal. - I never used tree testing with the posterior mean site frequency model (-ft coupled with -z options). The main reason is because I\u2019m not 100% sure if the site-log-likelihoods computed under the PMSF model can be used for further tree testing. I guess it\u2019s OK as long as you used the same guide tree throughout the analysis. But my co-authors can confirm this. Yes, the same guidetree was used everywhere, but hmm you raise an interesting point here, I did not think about this before. - There is discrepancy between the AU test implementation in IQ-TREE and CONSEL (technically: IQ-TREE used the least-square p-value estimates whereas CONSEL uses the ML p-value estimates). Thus, for now please run CONSEL, as you already printed the site-log-likelihoods via -wsl. Note that the results with other test (SH etc) are comparable. I was not aware of the technical difference between IQ-TREE and CONSEL! Could you update the online documentation? - I would also do the tree test using the mixture model LG+C60+F+G, just to see how the results look like compared with PMSF. I have done this also, and here the ML tree has by far the highest AU-test p-value, so it seems to work as expected. Yes, quite likely. I would repeat a few more runs (as you wrote below) and look whether it improves. Thanks for bringing this problem into attention. I can give a quick update on this. I ran 10 independent runs with the -pers 0.2 and -numstops 500. All ML trees are identical to my original ML tree (obtained with the default search parameters). So this seems to suggest the original ML tree was not stuck in a local optimum.. It's a peculiar problem!! ", "This is an interesting perspective! I will try this if Minh confirms IQ-TREE still behaves like this. ", "Hi Joran, Yes Tung had a good point. It is mostly true: the model parameters are indeed fixed for all trees in the list, but they are not estimated from the 1st tree, rather from the \u201crough\" tree of the iqtree search (as you specified option -n 1 to perform one iqtree iteration). However, one thing I now notice is that you used -fixbr option to fix the branch lengths of all the trees tested. I think this is a more important issue which makes likelihood worse than expected. So please remove this option, so that iqtree estimates branch lengths properly (default behavior). Let us know how the results look like. Cheers, Minh ", "Aha I see. I used the -fixbr mostly to speed up the analysis, I did not realize that it would affect the topology test. My plan now is to rerun the topology tests without the -fixbr flag, and to compute p-values with CONSEL. I then want to compare the p-values of CONSEL with those of IQTREE (fixbr and without fixbr). It will take some time, but I'll keep you in the loop. Let's see if that also \"solves\" the high-likelihood bootstrap tree issue. Cheers, Joran ", "Hi Joran, I updated this technical difference with CONSEL in the command reference and the advanced tutorial accordingly. So it\u2019s clear now. Cheers, Minh ", "Great! I have now run a new topology test without the -fixbr flag, and also ran the CONSEL AU test with the generated .sitelh file. with -fixbr vs without -fixbr: the obtained p-values are generally higher. I suppose this makes sense because their likelihoods rose due to branch length optimization. Also, the bootstrap trees that I included in the test are now generally accepted (without -fixbr), whereas they were generally rejected when using -fixbr. without -fixbr, IQTREE AU-test vs CONSEL AU-test The generated p-values under the CONSEL test are generally lower than under the IQTREE AU test. For some topologies, the difference was extreme (0.0315 vs 10e-50), but are usually smaller differences. Also here the bootstrap trees that I included are generally accepted. So it seems to behave just as expected :) I did this on a different dataset than the one that had the high likelihood bootstrap tree though. Hope to report more on that dataset soon. Joran ", "Hi Joran, So please ignore this option -fixbr next time!\u2026 that\u2019s a huge difference. I think the explanation is straight forward: Branch lengths of the bootstrap tree were estimated on the bootstrap alignment. Thus they are not optimal branch lengths for the original alignment, fixing them will reduce the log-likelihood substantially, leading to many (if not most) bootstrap trees being rejected. Regarding IQ-TREE AU p-value, I will change to consel approach in version 1.6.X Cheers, Minh ", "Hi Minh, I just came across this thread and wanted to confirm - did you have a chance to update the approach for the IQ-TREE AU p-value calculation to that used by CONSEL? Thank you in advance for letting me know! Best, Robyn ", "Hi Robyn, Unfortunately not. I contacted AU test's author (Shimodaira) but did not get a reply from him. If you or others want to know more details, here is the reason (part of my email to him): \u201c\u2026 When looking at your AU paper, it becomes clear to us that this [discrepancy] happens because the quantile function Phi^{-1} is not defined for zero values. In some extreme cases, many BP values are zero and the AU test is not applicable. So the question is: How does CONSEL deal with such cases?\" So I don\u2019t know yet what to do. I tried to look at the source code of CONSEL and it\u2019s almost impossible to \u201cdecode\u201d. Cheers Minh ", "Hi Minh, Ok, thank you very much for letting me know and sharing for the details. Have a nice day. Best, Robyn "]}, "EHMVNsb3SEs": {"topic": "Random addition sequence", "initializeDate": "Mar 19, 2016, 12:49:53 PM", "timeStamp": "Mar 20, 2016, 6:10:51 AM", "content": ["Dear, I run ML in PAUP program, and i use command \"Addseq = random Nreps=simple\". I'm not sure i have to use this command in iqtree. Thank iqtree team, Thanh. ", "Dear Thanh, IQ-Tree has a different command line interface than PAUP and also a different algorithm. Please have a look at the quick start guide: http://www.cibiv.at/software/iqtree/doc/Quickstart/ Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout "]}, "5DeE2GMAtnE": {"topic": "IQTREE terminated when running large dataset", "initializeDate": "Oct 26, 2018, 5:10:01 AM", "timeStamp": "Oct 27, 2018, 9:29:42 PM", "content": ["Hello, I was conducted a standalone windows version of IQTREE with >20,000 DNA sequence in fasta format. The command line was 'bin\\iqtree -s M1.fasta -spp M1.partitions -m TESTNEW -nt AUTO -bb 1000' IQTREE was terminated by this step 'For your convenience alignment with unique sequences printed to NS1.partitions.uniqueseq.phy'. Here are the files: alignment https://drive.google.com/file/d/1L8gK-ApCJ1qWac8d9UMu9YTfpVDssa9b/view?usp=sharing partition https://drive.google.com/file/d/1eM2vFyzVeQh6u9yfyltK6B7hlhMIbr7R/view?usp=sharing log https://drive.google.com/file/d/1ToB6f01_Fct2fPq0NwnyKpPqM7W8M2J7/view?usp=sharing How to fix this problem? Thanks! Best regards, Chih-Wei ", "Hi Chih-Wei, There is a problem in the PLL library that IQ-Tree uses to construct the initial parsimony tree for such large data set. So can you please add option \"-t PARS\" to switch to IQ-Tree kernel. However, this run may take a long time\u2026 Therefore I suggest that you do some kind of clustering to reduce the number of sequences before running IQ-Tree. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "7db5o4yL0Hk": {"topic": "How to bootstrap branch lengths on fixed topology?", "initializeDate": "Apr 17, 2019, 6:05:19 PM", "timeStamp": "Nov 11, 2019, 3:43:43 PM", "content": ["I'm attempting to bootstrap branch lengths on a fixed topology, I think this can be done in RAxML, but I was wondering how it might be done in IQTree. Ideally, each tree would have the full set of taxa and the same branching order, but would have branch lengths estimated independently. Here is a link to a similar question answered for RAxML: https://groups.google.com/forum/#!topic/raxml/9B8GmCG8KNE Is there any similar function to RAxML's \"-f j\" in IQTree? I'm fairly certain this is the function I'm looking for, though it is unclear if bootstrapping the alignment keeps all taxa or is subsampling. for reference: \"-f j\": generate a bunch of bootstrapped alignment files from an original alignment file. You need to specify a seed with \"-b\" and the number of replicates with \"-#\" Thanks! ", "Mostly solved thanks to finding this older post: https://groups.google.com/forum/#!topic/iqtree/D6ULh6g78tU ", "Hi Andrew, The URL you sent is to compute branch lengths of the tree for the original alignment. If you want to obtained bootstrapped branch lengths, you can combine with -b option: iqtree -s ALN -te TREE -b 100 \u2026 And look at .boottrees file. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Mihn, I am trying more or less the same thing as here https://groups.google.com/forum/#!topic/iqtree/D6ULh6g78tU I have a fixed unrooted tree that I want just to compute the branch lengths, however, the output tree has different topology. As I am trying to compute only branch lengths for 2700 different alignments, I need the same topology so I can parse the results in an automated way. Is there any way to do that? Original tree topology: (C08,((C48,(C10,(C61,C24))),((C02,C13),C54)),Ptgra); My commands (different options and different alignments): iqtree -s cluster10.fas -te tree.tree -st CODON -m GY+F1X4+R2 -b 25 -nt 4 -pre test1 iqtree -s cluster267.fas -te tree.tree -st CODON -m GY+F1X4+R2 -b 25 -nt 4 -pre test2 iqtree -s cluster10.fas -te tree.tree -st CODON -m MF -b 100 -nt 4 -pre test3 Output trees (ommiting branch lenghts just to show result topology): test1 : (C02,(((C08,Ptgra),(((C24,C61),C10),C48)),C54),C13); test2 : (C10,(C24,C61),(((C54,(C02,C13)),(C08,Ptgra)),C48)); test3 : (C02,(((C08,Ptgra),(((C24,C61),C10),C48)),C54),C13); Kind regards, Caio ________________________________________ Mr. Caio A. Leal-Dutra PhD Candidate (Microbiology F28 Post room, Cledwyn Building, Penglais Institute of Biological, Environmental & Rural Sciences Aberystwyth University Aberystwyth SY23 3DD UK ", "Hi Caio, These trees indeed have the same topology, just rooted differently. You will see this if you reroot the output trees. By default, IQ-TREE prints the unrooted trees from the first sequence in the alignment. You can use -o option change that behaviour. For your 2nd question, I don\u2019t know the best way to parse the newick file. Perhaps some R script with the APE package? Cheers, Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAEeBS4xEgQwuLmHN%3DLrveDgTHuhz7YhYQASSQ5dahu81-pBQsg%40mail.gmail.com ", "Dear Minh, thank you very much for your reply. I tried your suggestion and it worked, I was expecting if I specified an outgroup, the final tree would be unrooted. The parsing I mentioned will be done with a python script, thus the result tree for all the alignments should be identical. (I'm parsing it to label some branches for codeml analyses). But I'll figure out another way to do that. Kind regards, Caio ________________________________________ Mr. Caio A. Leal-Dutra PhD Candidate (Microbiology F28 Post room, Cledwyn Building, Penglais Institute of Biological, Environmental & Rural Sciences Aberystwyth University Aberystwyth SY23 3DD UK ", "I see it now. Then you can put the label directly on to your original tree file, making sure that the first taxon in this tree is also the same taxon for -o option. IQ-TREE will preserve the labels in the output trees. Cheers, Minh "]}, "HzXkdijmJxg": {"topic": "\"ERROR: Cannot concatenate sub-alignments of different #states\"", "initializeDate": "Nov 6, 2018, 12:43:24 AM", "timeStamp": "Nov 6, 2018, 6:50:10 PM", "content": ["Hi, I'm trying to run a partitioned analysis of DNA and CODON data. My partition file is as such: #nexus begin sets; charset rDNA1 = dna.phy: 1-1022; charset rDNA2 = dna.phy: 1023-5239; charset cDNA3 = codon1.phy: CODON, 1-822; charset mitoDNA4 = codon2.phy: CODON5, 1-1533; charset cDNA5 = codon3.phy: CODON, 1-3753; end; IQTree seems to recognize the partitions and data correctly, but then I get the following error message and it quits: Subset Type Seqs Sites Infor Invar Model Name 1 42 1022 228 593 TESTNEWMERGE rDNA1 2 42 4217 776 2865 TESTNEWMERGE rDNA2 3 CODON 42 274 175 33 TESTNEWMERGE cDNA3 4 CODON5 42 511 475 16 TESTNEWMERGE mitoDNA4 5 CODON 42 1251 1146 60 TESTNEWMERGE cDNA5 Degree of missing data: 0.000 Info: multi-threading strategy over partitions NOTE: Mixed codon and other data, branch lengths of codon partitions are rescaled by 3! Computing Juke-Cantor distances... Computing BIONJ tree... 0.013 seconds NOTE: ModelFinder requires 476 MB RAM! NUMBER OF THREADS FOR PARTITION FINDING: 11 ERROR: Cannot concatenate sub-alignments of different #states The same error occurs using both the CIPRES build (v1.6.6) and the cibiv build, and if I input a single .phy datafile partitioned as above but without the alignment file modifiers. Thanks in advance. Morgan ", "Hi Morgan, Many thanks for the report. I confirm this is a problem in IQ-Tree. I overlooked that a species can have two different genetic codes. But of course the mitochondria may have a different code than the nuclear genome. This ERROR happened when IQ-Tree tries to concatenate the CODON with CODON5 partitions, which have different number of non-stop codons. But it shouldn\u2019t do so. I created a github issue to fix for the next release 1.6.9. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "GaXanuqFaqc": {"topic": "generating majority consensus trees", "initializeDate": "Jun 21, 2016, 7:55:22 AM", "timeStamp": "Jun 22, 2016, 4:53:25 AM", "content": ["Hi, First thanks for developing this great tool! I noticed a discrepancy between the command line options in the tutorial and the documentation: In the tutorial for a majority consensus tree the option listed is To build a majority-rule consensus tree, simply set the minimum support threshold to 0.5: iqtree -con mytrees -t 0.5 I think it should be -minsup (according to the command reference thanks, Diamantis ", "Dear Diamantis, you are right, -minsup is the correct option. Thanks for pointing this out, I updated tutorial accordingly. Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "1vaJ6HfgQ6I": {"topic": "Number of digits after decimal point for site-wise likelihoods", "initializeDate": "Jul 13, 2020, 5:20:43 AM", "timeStamp": "Jul 13, 2020, 9:44:34 AM", "content": ["Dear all, I am trying to calculate the site wise likelihoods of different tree hypotheses based on one alignment and a specified model. I have 3 different hypotheses and i want to compare the likelihoods for each hypothesis at each site. I am only interested in the hypothesis with the highest likelihood among the three for each site. However for a few sites I have the following issue: e.g. -10.1933 -10.0196 -10.0196 Basically values 2 and 3 are probably very similar but I doubt that they are exactly same. I think away to get around this would be to add more digits after the decimal. Is there an option to do this? I am using v. 1.6.12. Many thanks Alex ", "Dear Alex, an interesting question would be whether the true accuracy of the ML computation really supports more than 4 digits after the decimal point anyway. Adding more digits might not add any true additional information. If adding more digits would boil down to the same effect as rolling a dice there would be no gain for you. It would be better to assume a draw between the two hypotheses in question rather than forcing iqtree to make a decision it cannot make. You could run the same analysis again with maybe a different input order of the sequences to add some . If the site likelihoods are different, it would indicate that the numerical error is larger than the smallest number you can distinguish in the output which in this case seems to be 0.0001 In other words, only if the numerical result is truly more precise than 0.0001 it would be a benefit to have more digits. Best Christoph You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1b635a90-5957-42cc-b45f-f2e3e85d0c48n%40googlegroups.com **************************************** Dr. Christoph Mayer Email: c.maye...@uni-bonn.de Tel.: +49 (0)228 9122 403 Zoologisches Forschungsmuseum Alexander Koenig - Leibniz Institut f\u00fcr Biodiversit\u00e4t der Tiere - Adenauerallee 160 53113 Bonn, Germany www.zfmk.de Stiftung des \u00f6ffentlichen Rechts; Interimsdirektor: Prof. B. Misof Sitz: Bonn **************************************** "]}, "iR81BqzZomc": {"topic": "IQ-Tree job submission parameters", "initializeDate": "Feb 8, 2020, 3:08:35 PM", "timeStamp": "Feb 13, 2020, 4:02:45 PM", "content": ["I am very naive regarding phylogenetic and using commands in computers. it would be great if somebody can directly help me. I am trying to use IQTree for making a tree (multiple sequence alignment of proteins). I would like to understand the how should I proceed, what parameters I should proceed with? It would be great help. Thanks in advance. I am happy to connect directly as well, if somebody is willing to help. ", "Hi there, Have a look at the tutorials, best place is the quick starting guide: http://www.iqtree.org/doc/Quickstart . This will require you to use the command lines. Alternatively, if you are not comfortable with the command lines, you can use the web servers (click on the \u201cWeb server\u201d menu on the top menu bar of the web site). Cheers, Minh On 9 Feb 2020, at 7:08 am, Miss Teena Bajaj PhD < baja...@berkeley.edu > wrote: I am very naive regarding phylogenetic and using commands in computers. it would be great if somebody can directly help me. I am trying to use IQTree for making a tree (multiple sequence alignment of proteins). I would like to understand the how should I proceed, what parameters I should proceed with? It would be great help. Thanks in advance. I am happy to connect directly as well, if somebody is willing to help. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/00f3a07a-5ed6-4a92-9ec0-9f4bcedeebaa%40googlegroups.com "]}, "cot7WsUkZkM": {"topic": "What is a segmentation fault and what are the main causes (and solutions) to it?", "initializeDate": "Sep 12, 2019, 4:36:01 PM", "timeStamp": "Sep 12, 2019, 9:33:17 PM", "content": ["Hello, I was running IQ tree 1.6.12 on a server that ran out of RAM. So I ran the very same analysis in another larger server and I can't get anything done. I am running the following code: /bin/iqtree -s ann.arg_chr10inv.fasta -st DNA -m MFP -nt AUTO -ntmax 8 -bb 10000 -pre invChr10_annarg2 The fasta file is ~28 Mbytes in size. It is not binary data. All I am getting is: \"segmentation fault\", which I didn't get in the first server. It doesn't even says \"ERROR\", just those two words. I have changed all the parameters that I am using, I have googled and looked into various answers of this forum, and looked at your advanced tutorial (-spp does not seem to be what I need). Nothing seems to make sense. I am not getting any log files (the one I have is from when I ran it on the first server the first time). So, what does that mean? what are the main causes of it? what are the most likely solutions? What do I need to read? Thanks, Mariana ", "Hi Mariana, Thanks for the report. Segmentation fault is rather a critical issue in C/C++ code. I don\u2019t know exactly what the cause is before looking at the log file. But from the information you give (~28 MB fasta file), It could be a problem in the first step of parsimony tree construction (internally IQ-TREE use the phylogenetic likelihood libary for that purpose). Therefore, can you please rerun with \u201c-t PARS\u201d option? It switches to own kernel of iqtree. Let me know if that option helps or not. If not, please send me the log file via my personal email. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1fa36c94-99fc-45d7-a002-4c93ef5f4c40%40googlegroups.com "]}, "faxc10XjLZk": {"topic": "RAxML-style partition file for protein data", "initializeDate": "Jul 25, 2017, 4:42:40 AM", "timeStamp": "Jul 25, 2017, 5:24:47 AM", "content": ["Hey, I have a rather simple, and maybe even idiotic question. I have a large protein alignment and a partition file. I would like to get the best fit model for each partition. How does the format of RAxML-style partition file for protein data looks like? Similar to DNA? DNA, part1 = 1-100 DNA, part2 = 101-384 AA, part1 = 1-100 AA, part2 = 101-384 Bests, ", "Hi Felix, yes, the RAxML-style AA, part1 = 1-100 AA, part2 = 101-384 should work fine. To get the best fit model per partition you can use option -m MF. If you\u2019d like to perform also tree reconstruction use -m TEST. Cheers, Olga You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Just an addition, -m MF performs an extended model selection that additionally includes FreeRate model, so maybe you'd like to use TESTONLY instead ", "Argh! I just forgot the default is MFP and not TEST. Works now! Thanks Olga! F "]}, "qO-bDUeZryM": {"topic": "State frequencies for binary and multistate morphological characters in IQ-TREE", "initializeDate": "Dec 20, 2019, 3:40:29 PM", "timeStamp": "Sep 25, 2020, 10:57:51 AM", "content": ["Dear All, When I analyze datasets with mophological data, and have both binary and multistate (three-states, in my case) chars., the output file indicates a single 3x3 Q matrix for MK model. I see how this is fine for MK model, as transition rates are all equal but how about stationary state frequencies? How IQ-TREE deals with the fact that they are 0.5/0.5 for binary and ~0.33/0.33/033 for my multistate data? Best Daniel Casali ", "Hi Daniel, The MK model has equal state frequencies. So yes, they are as you understood (=1/2 for binary and 1/3 for 3-state data). This is the default behaviour with ModelFinder. If you want to change it, you need to set option \u201c-mfreq FQ,F\u201d to test both +FQ (equal) and +F (empirical) frequency model. Alternatively you can also set the model manually, e.g. with -m MK+F+G. Does that answer your question? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/cc7284fc-5940-4152-be09-1c10f66723fd%40googlegroups.com ", "Hi Minh, Thanks for the answer. My question is more about how, given those different number of states i have, IQ-TREE calculates the transition rates. Considering that, although frequencies are equal for all chars., their values vary according to the number of states. In the case of nucleotide data, for which we always have 4 possible states and they are not arbitrary, it is clear to me, but when I have data with variable number of states, i'm trying to understand how calculations during the search are performed. For example, in Beast, if I understood it properly,it automatically partitions the dataset per number of states of the characters, and estimate the rates for each class defined by the characters with a given number pf states separately. There is any necessity to use different partitions for morphological data in IQ-TREE in order to account for this heterogeneity in the number of states or this is already accounted for without partitioning? If so, how this is done? In a character by characters basis? Since I've just seen a 3*3 rate matrix in the output, I was affraid a 0.33 value of frequency (relative to my multistate data) could have being applied to binary characters as well, during the optimizations. Hope this is not a silly question...but I haven't found any good explanation elsewhere, so I Hope you can help me elucidating this doubt. Best regards Daniel Casali ", "Hi Daniel, I\u2019m not sure if I understand you correctly. Do you mean that, in your alignment, you have some sites with only 2 states, and other sites with 3 states? If that\u2019s the case, then indeed IQ-TREE applies a single 3x3 rate matrix for all sites in the alignment. Perhaps what you need to do, is to manually partition the alignment into 2 partitions, one with 2-state sites (which should be encoded with 0 and 1) and the other with 3-state sites (again encoded as 0, 1, 2). Then IQ-TREE should account for the lack of state. Is that your doubt? Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/11275e5b-dc8b-4bc2-8ae8-98be1574e964%40googlegroups.com ", "Hi Minh, Exactly that! Thank you so much for clarifying it. Unfortunately, this icould be a potential limitation when dealing with emprical morphological datasets, which usually have too few characters with more states (e.g. 4, 5, 6...). In cases like this, we may not have enough data for estimating the paramenters for those partitions, but avoiding partitioning would lead to a undesirable effect as well, of ignoring variation is state frequencies. I don't know if there is a good solution for that right now... Best Daniel Casali > To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi all, I've run into this issue as well. I have a morphological dataset with characters that have 2, 3, 4, or 5 states. I tried partitioning by total number of states at each site, I even specified the model MK+FQ+ASC+G4 for each charset under charpartition in the partition file. In the output five empirical state frequencies are output for each partition, leading me to believe that the Q matrix is still assigning 5 states to each partition. I am using IQ-TREE multicore version 2.0-rc1 for Linux 64-bit built Nov 21 2019. Do you have suggestions for restricting each partition's Q matrix to the appropriate number of states? For now I will probably run a FO model where state frequencies are empirically estimated, since then the non-existant states will have frequencies closer to 0. ", "Hi there, You can recode your alignment. Say, changing 2,3,4,5 to 0,1,2,3, respectively (assuming that states 0 and 1 are missing). More generally, if some state(s) is missing, you need to recode the characters such as all states from 0 to (n-1) are present in the alignment. Otherwise, it may cause numerical issues. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/47735e50-cfc2-490e-b506-69e7d5f40f76n%40googlegroups.com ", "Hi Minh, My apologies I don't think I worded my question properly. I have some characters sites that have 0 & 1 values, other sites that have 0,1,2 values, and others that have 0,1,2,3 values. So some sites should have a q-matrix of 2 states, while others should have a q-matrix of 3 states, and others a q-matrix of 4 states. I've tried partitioning the data by the total number of states each site should have, but the iqtree output seems to still assign a q-matrix of 4 states to all sites, even if a site only ever has the values of 0,1. Let me know if that is more clear. I am not a morphologist so I am not always accurate with the terminology. ", "Ah ok, I misunderstood you. I believe in such partitioned morphological analaysis, each partition should have a Q matrix size corresponding to the number of states in that partition. Please send me the alignment, partition file, and the log file. I\u2019ll have a look if that\u2019s the case. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b5a7f9fc-7944-4e60-82a2-93c1efee7331n%40googlegroups.com ", "Hi there, Sorry for the delay. Now I see the problem. It\u2019s because the concanated alignment is in a single file: IQ-TREE will read this file and detect the number of states, then partitioning them. As a result, these partitions will have same number of states as the original alignment, even if the actual partitions contain few states. There is a way to overcome this: You need to prepare each partition in a different file, and then use this syntax to specify the partition file http://www.iqtree.org/doc/Complex-Models#partition-models , that you can basically put the alignment file names into the partition file, for example: #nexus begin sets; charset binary_part = part1.phy; charset morph_part = part2.phy; end; This way, each file (corresponding to one partition) will be read individually and IQ-TREE will detect the number of states separately for each partition. In IQ-TREE 2, there is a convenient way to avoid preparing such partition file: You need to put all alignments into the directory and run \u201ciqtree -p DIR \u2026 \u201c. Hope that helps, Minh On 15 Sep 2020, at 12:06 pm, Genevieve Mount < ggmo...@gmail.com > wrote: Hi Minh here is the data and alignments. I've also attached a test run I did using the FO model instead of the FQ model because I was trying to determine the number of states for the q-matrix for each partition. This FO log is what lead me to believe that each partition still has a q matrix with 5 states even for the partitions with only 2 states. Thank you for the help! ------------------ Genevieve G. Mount PhD Student, Jeremy Brown Lab and Chris Austin Lab Department of Biological Science and Museum of Natural Sciences Louisiana State University Website: Phyleaux website Twitter: Lizardeve Pronouns: She/her/they/them/he/him (no preference) Although I may choose to send emails at odd hours including mornings evenings and weekends, I have no expectations for you to reply outside of your working hours. <Simoes2018OGCutPart.nex> <Simoes2018OGCut.nex> <Simoes.cut.part.log> <logFOmodel.log> ", "Great. That makes sense. I will try this. Thank you for the reply! "]}, "eYHYPBOyNZI": {"topic": "No end tree generated / segmentation fault", "initializeDate": "Apr 26, 2017, 10:46:19 AM", "timeStamp": "Apr 26, 2017, 11:58:06 AM", "content": ["hi, I tried running this joined .cf file with iqtree-omp-1.4.3-pomo-Windows\\bin\\iqtree-omp.exe. a .parsetree is produced, but no .tree file is generated (see attached logfile). Also, windows displays a error message. Thanks in advance, cheers, ", "Hello Pierre-Yves, thank you for your interest in PoMo. I have looked at your data and the level of polymorphism is tremendous. Do you only look at variable sites? PoMo only works with data that also includes fixed sites, where the populations or species are monomorphic so that the level of polymorphism can be estimated correctly. That is also why your input data leads to a segmentation fault (the eigendecomposition of the rate matrix fails because the level of polymorphism is too high). Your example counts file: Populations: ['IA1', 'IA6', 'IA8', 'IA9', 'IL1', 'IL2', 'IL3', 'IL4', 'IL5', 'IL7', 'IN1', 'KS1', 'KS2', 'MD1', 'MI1', 'MN1', 'MN2', 'MN3', 'MN4', 'MN5', 'MN6', 'MO1', 'MO4', 'MO5', 'ND1', 'ND3', 'ND4', 'ND5', 'ND6', 'NE1', 'OH1', 'OH2', 'ON10', 'ON11', 'ON12', 'ON13', 'ON14', 'ON15', 'ON16', 'ON17', 'ON19', 'ON1', 'ON20', 'ON21', 'ON24', 'ON25', 'ON26', 'ON27', 'ON29', 'ON2', 'ON30', 'ON31', 'ON32', 'ON34', 'ON35', 'ON36', 'ON37', 'ON38', 'ON3', 'ON40', 'ON41', 'ON42', 'ON43', 'ON44', 'ON45', 'ON46', 'ON47', 'ON48', 'ON4', 'ON50', 'ON51', 'ON5', 'ON6', 'ON7', 'ON8', 'Qc', 'SD1', 'SD2', 'SD3'] Rounded population sizes: [ 102. 114. 129. 189. 133. 128. 69. 90. 274. 128. 177. 142. 107. 85. 151. 112. 112. 160. 116. 112. 86. 71. 140. 75. 171. 128. 155. 140. 128. 151. 143. 149. 554. 410. 47. 226. 530. 304. 146. 59. 64. 839. 162. 126. 952. 500. 1176. 240. 28. 17. 50. 48. 291. 457. 7. 95. 55. 101. 600. 101. 64. 33. 25. 48. 44. 109. 6. 8. 562. 701. 89. 915. 169. 52. 177. 6. 224. 159. 141.] Vector of levels of polymorphism: [ 0.11733869 0.11983448 0.11450898 0.12781452 0.13091436 0.10430787 0.12913803 0.11089316 0.09939605 0.10333606 0.13447202 0.09948208 0.11626301 0.15317475 0.12604586 0.10462622 0.12488717 0.13003862 0.13197956 0.11093701 0.13533149 0.11709584 0.10579328 0.12152657 0.11161068 0.06835081 0.09229401 0.1293737 0.08973068 0.09524164 0.10538671 0.10523763 0.0846423 0.11463809 0.13210802 0.09614651 0.08031478 0.11255449 0.10435914 0.12747195 0.10816303 0.10027113 0.10336735 0.10298831 0.11582116 0.09290942 0.10434498 0.11985839 0.18922981 0.2271741 0.14164262 0.14771099 0.11812424 0.09179707 0.36799254 0.09120234 0.10102097 0.10841512 0.1010632 0.11552986 0.0709936 0.16628532 0.19734513 0.15048305 0.15231405 0.11151181 0.40408964 0.34432841 0.09973149 0.11093562 0.11600174 0.10503571 0.09458776 0.13806758 0.11949673 0.41255628 0.12153624 0.07817242 0.11011183] The levels of polymorphism exceeds 0.1 by far. We do not recommend using PoMo if the level is above 0.1. Please let us know if you have further questions, or if we can help you with similar data. I am very interested to use PoMo on data such as yours, where the number of samples is very high! Dominik Dominik Schrempf PhD Student Vienna Graduate School of Population Genetics Vetmeduni Vienna, AT > -- > You received this message because you are subscribed to the Google > Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, > send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Hello Pierre-Yves, I just took a closer look at your data and it seems that you have bi-allelic data. PoMo expects nucleic data (A, C, G and T), so that's another reason why it crashes. You might be interested in SNAPP though. https://wiki.gacrc.uga.edu/wiki/SNAPP Dominik Dominik Schrempf PhD Student Vienna Graduate School of Population Genetics Vetmeduni Vienna, AT ", "Thank you for the quick answer. You're right, I didn't make difference between A,C,G,T (because I already had a script that produce that type of file), so they are all A and C which is not true. I'll take a look at SNAPP. Cheers! "]}, "lbtvttimTVk": {"topic": "Checkpoint to recover partition analysis", "initializeDate": "Apr 26, 2021, 3:26:01 AM\u00a0(2 days ago)\u00a0", "timeStamp": "Apr 27, 2021, 6:08:18 PM\u00a0(6 hours ago)\u00a0", "content": ["Dear community, I was performing a partition analysis with IQTREE on a set of 758 genes for 1,750 species, but it crashed after 3 weeks running. Is there a way of not rerunning everythin again and to resume the run from the last point? I see that IQTREE was writing a model.gz file but I do not know if it is possible to use it not to run everything again. Thanks, Inigo ", "Hi Inigo, Yes, IQ-TREE can recover from the checkpoint. If you re-run IQ-TREE with the very same command line, it will load the checkpoint file and resume the analysis. Make sure that you don\u2019t add -redo option. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/84ed2a04-b605-424c-a3de-1c67a271209an%40googlegroups.com "]}, "rJfHSa8ZTXs": {"topic": "CODON/Protein partition", "initializeDate": "Mar 22, 2019, 1:28:51 PM", "timeStamp": "Mar 25, 2019, 9:30:35 AM", "content": ["Hello, I'm trying to build a Phylogenetic tree merging a protein and codon tree (after I'll try to constraint the tree with the species tree but I already have problems to merge trees). I'm able to obtain both separate trees but I'm not able to do a partition analysis. Command: iqtree -spp partition2003.nex -m MFP+MERGE -bb 1000 -alrt 1000 -safe NEXUS partition file: #nexus begin sets; charset part1 = codon225.fas:CODON, *; charset part2 = prot225.fas: *; end; these are the errors that I get: ERROR: \\Users\\minh\\Dropbox\\iqtree-git\\model\\partitionmodelplen.cpp:142: virtual double PartitionModelPlen::optimizeParameters(int, bool, double, double): Assertion `cur_lh > tree_lh - 1.0 && \"partition rate opt reduces LnL\"' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: partition2003.nex.log ERROR: *** Alignment files (if possible) May you help me? Attached are the alignments and the partition file. ", "Hi, From the ERROR hints that you used an old version of IQ-TREE (v1.5 or even older). Can you pls try the latest stable version (1.6.10) and let me know how it works? Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <prot225.fas> <codon225.fas> <partition2003.nex> ", "Hi Minh, Yes, I was using v1.6.8. But then I use the latest and I've the same problem with v1.6.10 and 1.7-beta9. Command: iqtree -spp partition2003.nex -m MFP+MERGE -bb 1000 -alrt 1000 -safe NEXUS partition file: #nexus begin sets; charset part1 = codon225.fas:CODON, *; charset part2 = prot225.fas: *; end; the analysis get stuck here: Creating fast initial parsimony tree by random order stepwise addition... 0.390 seconds, parsimony score: 9633 (based on 257 sites) NOTE: ModelFinder requires 269 MB RAM! NUMBER OF THREADS FOR PARTITION FINDING: 3 Testing GY,LG+F+G on supermatrix... Initial log-likelihood: -51732.886 WARNING: Numerical underflow for lh-branch WARNING: Numerical underflow for lh-branch ... ... these are the errors that I get with v1.6.10 ERROR: \\Users\\minh\\Dropbox\\iqtree-git\\model\\partitionmodelplen.cpp:142: virtual double PartitionModelPlen::optimizeParameters(int, bool, double, double): Assertion `cur_lh > tree_lh - 1.0 && \"partition rate opt reduces LnL\"' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: partition2003.nex.log ERROR: *** Alignment files (if possible) Thanks, Romina ", "I could reproduce the crash, thanks. However, having a look at your data, I believe one shouldn\u2019t do an edge-linked partition model here. Simply because the branch lengths between two different data types (codon vs AA) are not expected to correlate. Forcing them to be linked might cause much worse log-likelihood, which is hinted in this WARNING about numerical underflow. So please try the edge-unlinked option, i.e. -sp instead of -spp. Cheers, Minh "]}, "VeO4qDAXsZg": {"topic": "v1.5.1 versus v1.4.4 -seed", "initializeDate": "Nov 28, 2016, 6:15:25 AM", "timeStamp": "Nov 28, 2016, 7:20:01 AM", "content": ["As a test, I tried to reproduce a result I obtained under v1.4.4 by running the same command under v1.5.1, using the same '-seed'. But the result was (slightly) different. Is this expected? iqtree-omp -s VisOpsin_v24_Max12_Clustal.fasta -m LG -pre VisOpsin_v24_Max12_Clustal_151_LG_seed570965 -seed 570965 -bb 10000 -nt 3 Thanks, Trevor ", "Dear Trevor, short answer: yes, slight difference is expected between 1.5.1 and previous versions (including 1.5.0) long answer: there is a change in the likelihood kernel to speed up the multi-threading version, which results in different order that the site log-likelihoods are summed up to obtain the total log-likelihood. Mathematically they are the same, but due to machine precision slight numerical difference is expected. As an unrelated side note, slight difference is also expected when different numbers of threads are specified (e.g. -nt 3 versus -nt 5). But this is also true for previous versions (also probably most multi-threading applications) Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "VVPLXC7bu04": {"topic": "How to run the mixed DNA and morphological data in IQ-TREE web server", "initializeDate": "Aug 29, 2016, 3:45:28 PM", "timeStamp": "Aug 30, 2016, 9:43:30 AM", "content": ["Hi, IQ-TREE allows combining sub-alignments from different alignment files. I have tow separate alignment files 8.8dna.nex and 8.8 morp.nex, and partition file as follow: #nexus begin sets; charset part1 = 8.8dna.nex: 1-772; charset part2 = 8.8dna.nex: 773-1447; charset part3 = 8.8dna.nex: 1448-1809; charset part4 = 8.8dna.nex: 1810-2149; charset part5 = 8.8dna.nex: 2150-2807; charset part6 = 8.8morp.nex: *; end; But I can not upload both 8.8dna.nex and 8.8 morp.nex as input file when I use the IQ-TREE web server. Only allowed to upload one file. So how to run the mixed data in IQ-TREE web server? Regards, Yang ", "Dear Yang, Mixed data types are not supported by the web server at the moment. Please use the IQ-TREE command-line version to utilize this feature! Best, Jana You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "OnW4kDcJxTM": {"topic": "Morphological characters with ordered and un-ordered traits", "initializeDate": "Nov 15, 2017, 4:32:11 PM", "timeStamp": "Nov 24, 2017, 10:23:34 AM", "content": ["I am just looking into IQ-TREE for the first time, and I'm hoping that someone could save me a ton of time by answering what is hopefully an easy question and maybe even supplying an example input file... Question: is it possible to analyze an input file of morphological characters in which some of the characters are ordered (1 goes to 2 goes to 3, etc.) and some of the characters are not ordered (1 can change to 2 or 3, etc.)? If that is possible, then it would be wonderful if someone had an example datafile with this kind of data. Or even just a datafile with morphological characters (regardless of ordered or un-ordered status). thank you! Matt ", "Dear Matt, 1) The morphological alignment can be in Phylip, Fasta, Nexus and other formats supported by iqtree. For example: Phylip: 4 10 S1 0123401234 S2 0324120432 3202304130 S4 4230120340 2) Mixing ordered and unordered characters are currently not possible. Actually IQ-TREE should allow users to input an arbitrary rate matrix specified from a file (just like for DNA and protein model). I don\u2019t know why this is not supported. Will let the developer know about this ;-) You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thanks for your quick reply! And that's too bad about mixing ordered and unordered traits. I wonder if anyone knows of another software that could handle those data types for morphological analysis? ", "Hi Matt, Can you give more details, like how the rate matrix Q looks like for such data? As said, we can of course support arbitrary rate matrix. Minh ", "Hi Minh, I'm afraid I do not have an outline of a rate matrix. For now, I only have the need to have ordered and un-ordered characters. But thank you for your responses, Matt ", "Hi Minn and Matt, MrBayes can do this, though I haven't tried it and I don't know about the details of the implementation. Would it make sense to have two matrices sharing a parameter? For instance: Ordered: * a 0 0 0 a * a 0 0 0 a * a 0 0 0 a * a 0 0 0 a * Unordered: * a a a a a * a a a a a * a a a a a * a a a a a * Maybe in that case an asymmetric ordered model could be implemented without the need of an extra rate parameter by fixing one rate to 1: Ordered, asymmetric: * a 0 0 0 1 * a 0 0 0 1 * a 0 0 0 1 * a 0 0 0 1 * Cheers, Eduardo ", "Hi Eduardo, The first two matrices you listed (ordered and unordered) are exactly those implemented in IQ-TREE (ORDERED and MK model). With a note that entry a is rescaled such that branch lengths are interpreted as the number of substitution per site. So in fact these 2 matrices have 0 free parameter. I don\u2019t know about the last one (asymmetric) but it looks like a non-reversible model. I think a mixed rate matrix may look like this: * a 0 0 0 a * a 0 0 0 a * a a 0 0 a * a 0 0 a a * (i.e, states 1,2,3 are ordered, whereas 3,4,5 are unordered). Minh ", "Hi Minh, Thanks for your reply. I think a mixed rate matrix may look like this: * a 0 0 0 a * a 0 0 0 a * a a 0 0 a * a 0 0 a a * That makes sense! I was thinking of trying to use the two matrices simultaneously, linked by the parameter a... if that would make any sense. In any case, it would be more complicated than necessary, given your mixed rate matrix example. It would be great to have the ability to use user-supplied matrices like that. I don\u2019t know about the last one (asymmetric) but it looks like a non-reversible model. Yes, sorry about that. I was thinking about a problem with rooted trees before I wrote that and forgot that the models must be reversible. Cheers, Eduardo "]}, "SZe989ZwgGo": {"topic": "Why is IQTRee crashing when I do a tree topology test?", "initializeDate": "Oct 21, 2017, 5:29:11 PM", "timeStamp": "Oct 24, 2017, 5:16:17 PM", "content": ["Hello, I'm trying to compare a constrained and unconstrained trees, but IQTree crashes. I'm using the commands from the IQTree manual (iqtree -s example.phy -m TIM2+I+G -z example.treels -n 0 -zb 1000 -au), but adjusting with appropriate file names and predetermined substitution model, and adding \"-nt 8\". The commands that I used were: iqtree-omp -s TRI22_subset.fas -m TIM2+I+G4 \u2013z TRI22_subset_Concat_Unconstr_Constr.treefile \u2013n 0 \u2013zb 1000 \u2013au 1000 -nt 8 First type of crash seemed to be caused by the presence of two taxa with identical sequences. I removed one of the identical sequences, but IQTree crashed for some other reason. The alignment and resulting log files are attached. Note: IQTree also crashed when I tried to concatenate the unconstrained and constrained tree files using the commands from the manual (type example.unconstr.treefile example.constr1.treefile example.constr2.treefile example.constr3.treefile > example.treels). Because concatenating with IQTree did not work, I manually concatenated the tree files (see file TRI22_subset_Concat.treefile). In this file, the first tree is unconstrained, and the second is constrained. I assume that I'm doing something(s) wrong. Can you tell me what it is? Regards, Bob ", "Dear Bob, The log file says: \"Reading input tree file \u00f1z ...\" What is this n-tilde z? The log file also prints the command line: Command: iqtree-omp -s TRI22_subset.fas -m TIM2+I+G4 \u00f1z TRI22_subset_Concat.treefile \u00f1n 0 \u00f1zb 1000 \u00f1au 1000 -nt 8 Thus, there seems to be a problem in your Windows command, where \"-\" is replaced with \"\u00f1\". Please check. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Minh, Thank you for your response. I\u2019m not sure where the \u00f1 symbols came from. I retried the analysis making sure that the \u00f1 symbols did not appear in the command line. Iqtree still crashed. I was able to successfully to run through the constraint tree analysis using the example.phy data set provided with the iqtree download and the commands outlined in the iqtree tutorial (section\u20185.7 Testing constrained tree\u2019 on page 49 of the iqtree manual). But, I had two problems. First, I was not able concatenate the four trees using the commands in the tutorial (plus \u2013nt 8 at the end): iqtree-omp type example.unconstr.treefile example.constr1.treefile example.constr2.treefile example.constr3.treefile > example.treels -nt 8 Iqtree terminated when I entered the above commands. The output included the following text: Terminate called after throwing an instance of \u2018std::ios_base::failure\u2019 what<>: basic_ios::clear Please see slide one of the attached PowerPoint document for the rest of the output. Can you tell me what I did wrong? Because I was unable to concatenate the treefiles with IQTree, I manually concatenated them, and saved this file with the same name as used in the tutorial (i.e., example.treels; the file should be attached). When I opened this file in FigTree, I was able to scroll through all four trees, and each tree seemed to have the expected unconstrained or constrained topology. This file with the manually concatenated trees seems to have worked in at least one subsequent analysis (see below). I then used the manually concatenated tree file (example.treels) to test the unconstrained versus constrained trees, using the commands in the tutorial (+nt 8 at the end): iqtree-omp -s example.phy -m TIM2+I+G -z example.treels -n 0 -zb 1000 -au -nt 8 These commands seemed to have worked; they generated multiple files including the files example.phy.log and example.phy.iqtree. However, some of the values in the table with the p-KH, p-SH and p-AU results were not the same as in the tutorial on page 50 of the iqtree manual. Also, the .log file also included the following statement: WARNING: Too few replicates for AU test. At least -zb 10000 for reliable results! Therefore, I repeated the analysis with the \u2018-zb 10000\u2019 command: iqtree-omp -s example.phy -m TIM2+I+G -z example.treels -n 0 -zb 10000 -au -nt 8 Changing of the \u2013zb value from 1000 to 10000 caused iqtree to terminate (see attached .log file example.phy_1.log, and the second slide of the attached PowerPoint file). Do you expect the iqtree to terminate when using \u2013zb 100000? I just repeated the analysis with my own data, and it seems to have worked. I think I was doing several things wrong. If possible, could you still answer the questions highlighted in yellow above? Regards, Bob From: iqt...@googlegroups.com [mailto: iqt...@googlegroups.com On Behalf Of Bui Quang Minh Sent: Sunday, October 22, 2017 2:46 AM To: iqt...@googlegroups.com Subject: Re: [iqtree] Why is IQTRee crashing when I do a tree topology test? Dear Bob, The log file says: \"Reading input tree file \u00f1z ...\" What is this n-tilde z? The log file also prints the command line: Command: iqtree-omp -s TRI22_subset.fas -m TIM2+I+G4 \u00f1z TRI22_subset_Concat.treefile \u00f1n 0 \u00f1zb 1000 \u00f1au 1000 -nt 8 Thus, there seems to be a problem in your Windows command, where \"-\" is replaced with \"\u00f1\". Please check. Cheers, Minh On Sat, Oct 21, 2017 at 11:29 PM, < robert....@ars.usda.gov > wrote: Hello, I'm trying to compare a constrained and unconstrained trees, but IQTree crashes. I'm using the commands from the IQTree manual (iqtree -s example.phy -m TIM2+I+G -z example.treels -n 0 -zb 1000 -au), but adjusting with appropriate file names and predetermined substitution model, and adding \"-nt 8\". The commands that I used were: iqtree-omp -s TRI22_subset.fas -m TIM2+I+G4 \u2013z TRI22_subset_Concat_Unconstr_Constr.treefile \u2013n 0 \u2013zb 1000 \u2013au 1000 -nt 8 First type of crash seemed to be caused by the presence of two taxa with identical sequences. I removed one of the identical sequences, but IQTree crashed for some other reason. The alignment and resulting log files are attached. Note: IQTree also crashed when I tried to concatenate the unconstrained and constrained tree files using the commands from the manual (type example.unconstr.treefile example.constr1.treefile example.constr2.treefile example.constr3.treefile > example.treels). Because concatenating with IQTree did not work, I manually concatenated the tree files (see file TRI22_subset_Concat.treefile). In this file, the first tree is unconstrained, and the second is constrained. I assume that I'm doing something(s) wrong. Can you tell me what it is? Regards, Bob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/SZe989ZwgGo/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout This electronic message contains information generated by the USDA solely for the intended recipients. Any unauthorized interception of this message or the use or disclosure of the information it contains may violate the law and subject the violator to civil or criminal penalties. If you believe you have received this message in error, please notify the sender and delete the email immediately. ", "Dear Bob, On Oct 22, 2017, at 10:12 PM, Proctor, Robert - ARS < Robert....@ARS.USDA.GOV > wrote: Dear Minh, Thank you for your response. I\u2019m not sure where the \u00f1 symbols came from. I retried the analysis making sure that the \u00f1 symbols did not appear in the command line. Iqtree still crashed. I was able to successfully to run through the constraint tree analysis using the example.phy data set provided with the iqtree download and the commands outlined in the iqtree tutorial (section\u20185.7 Testing constrained tree\u2019 on page 49 of the iqtree manual). But, I had two problems. First, I was not able concatenate the four trees using the commands in the tutorial (plus \u2013nt 8 at the end): iqtree-omp type example.unconstr.treefile example.constr1.treefile example.constr2.treefile example.constr3.treefile > example.treels -nt 8 Because this is the \u2018type\u2019 command (which works like \u2018cat\u2019 in Linux), thus pls remove iqtree-omp in front: type example.unconstr.treefile example.constr1.treefile example.constr2.treefile example.constr3.treefile > example.treels Iqtree terminated when I entered the above commands. The output included the following text: Terminate called after throwing an instance of \u2018std::ios_base::failure\u2019 what<>: basic_ios::clear Please see slide one of the attached PowerPoint document for the rest of the output. Can you tell me what I did wrong? See above Because I was unable to concatenate the treefiles with IQTree, I manually concatenated them, and saved this file with the same name as used in the tutorial (i.e., example.treels; the file should be attached). When I opened this file in FigTree, I was able to scroll through all four trees, and each tree seemed to have the expected unconstrained or constrained topology. This file with the manually concatenated trees seems to have worked in at least one subsequent analysis (see below). I then used the manually concatenated tree file (example.treels) to test the unconstrained versus constrained trees, using the commands in the tutorial (+nt 8 at the end): iqtree-omp -s example.phy -m TIM2+I+G -z example.treels -n 0 -zb 1000 -au -nt 8 This command looks fine These commands seemed to have worked; they generated multiple files including the files example.phy.log and example.phy.iqtree. However, some of the values in the table with the p-KH, p-SH and p-AU results were not the same as in the tutorial on page 50 of the iqtree manual. Because some of the trees generated in your run can be different those generated in the tutorial, quite likely because of different random seed number. E.g., the second tree in the tutorial has logL= -21156.802, whereas your 2nd tree has logL= -21275.270. This explains the differences: IQ-TREE is a stochastic algorithm, thus different runs might result in different tree, where the level of difference depends very much on the data set at hand. Also, the .log file also included the following statement: WARNING: Too few replicates for AU test. At least -zb 10000 for reliable results! Right, because Shimodaira (the author of the AU test) recommended such many replicates. Therefore, I repeated the analysis with the \u2018-zb 10000\u2019 command: iqtree-omp -s example.phy -m TIM2+I+G -z example.treels -n 0 -zb 10000 -au -nt 8 Changing of the \u2013zb value from 1000 to 10000 caused iqtree to terminate (see attached .log file example.phy_1.log, and the second slide of the attached PowerPoint file). Do you expect the iqtree to terminate when using \u2013zb 100000? I just repeated the analysis with my own data, and it seems to have worked. I think I was doing several things wrong. If possible, could you still answer the questions highlighted in yellow above? Having a look at your screen shot (2nd page of the powerpoint), it looks like the alignment file example.phy is not present in the same folder that you invoked this command, thus IQ-TREE stopped unexpectedly... Cheers, Minh <example.treels> <example.phy_1.log> <example.phy.iqtree> <IQTree Output Constraint Tree Analysis.pptx> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Thank you for your response, and for your patience with my stupid questions. As of last night, I had figured out everything except for the concatenation command \u201ctype\u2026>\u2026.\u201d. I just tried it as you described without \u2018iqtree-omp\u201d, and it worked. So, everything is working now. IQTree is wonderful! Thanks for developing it!! Bob Robert H. Proctor Microbiologist Mycotoxin Prevention and Applied Microbiology Research Unit USDA-Agricultural Research Service National Center for Agricultural Utilization Research 1815 N University St., Peoria, IL 61604 Tel. 309-681-6380 Fax. 309-681-6686 Email: robert....@ars.usda.gov ", "No problem, It\u2019s actually the purpose of this group to help users like this. Moreover, IQ-TREE should have actually printed some informative error message, instead of this ios\u2026failure\u2026 stuff. We will change the behavior in the next release. Minh "]}, "_HMso6wpIIE": {"topic": "iqtree2 crashes on  phylotree.cpp assertion", "initializeDate": "Aug 27, 2020, 6:22:04 AM", "timeStamp": "Aug 27, 2020, 6:22:04 AM", "content": ["Hi! I`ve got error when running iqtree2 on core genome for 13 E. coli genomes (for test purposes). iqtree-2.1.1-Linux/bin/./iqtree2 -s coreogaligned.fasta --seqtype CODON -T AUTO --threads-max 20 ERROR : phylotree.cpp:2806: virtual double PhyloTree::optimizeAllBranches(int, double, int): Assertion `fabs(new_tree_lh-tree_lh) < max_delta_lh' failed. Is there any way to run iqtree in more safe way (with no crashing on errors)? Alignment file and log are here: https://github.com/paraslonic/operon_travel/tree/master/test Best regards, Aleksander Manolov "]}, "6CaYqVZRhNI": {"topic": "Constrained tree search as a means for placing taxa in the \"correct\" tree", "initializeDate": "Feb 19, 2021, 4:18:39 PM", "timeStamp": "Feb 20, 2021, 5:55:22 PM", "content": ["Hi all, I'm currently at my wits end trying to solve an error that IQ-TREE version 1.6.12 for Linux is throwing at me. I am using -g to perform a a constrained analysis on an alignment that contains all of the taxa in the constraint phylogeny and additional \"unknown\" taxa. I want to use the -g option to infer the relationship of these unknown taxa relative to the known relationships of taxa in my reference. The tree that I am using is an unrooted and pruned version of the most current one available for the group I work with. I have not polytomized any of the relationships in this \"best\" constraint tree beyond what already existed. My understanding per the advanced tutorial is : \"The constraint tree can be multifurcating and need not to contain all species .\" [emphasis mine] But when I run my analysis with the following command: iqtree -s [Alignment file] -m TESTNEW -bb 1000 -wbtl -g [Constraint tree] I get the following error at the \"Creating fast initial parsimony tree by random order stepwise addition...\" step : \"ERROR: Alignment sequence neodelphineis_sp does not appear in the tree\" for up to 24 of the sequences in my alignment that are not represented in the tree. And the final error: \"ERROR: Tree taxa and alignment sequence do not match (see above)\" If anyone has any idea as to how I can fix this, I (and my dissertation) would greatly appreciate it! All the best, Cory Gargas ", "Hi Cory, This looks indeed strange. Please send me the whole log file for inspection. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/cf13f6bf-8b92-4ac4-be8f-e6ab23310ac7n%40googlegroups.com "]}, "U03kR7t2tnc": {"topic": "IQ-TREE release 1.6.4", "initializeDate": "Apr 29, 2018, 8:26:00 PM", "timeStamp": "Apr 29, 2018, 8:26:00 PM", "content": ["Dear users, IQ-TREE version 1.6.4 was released, which improves software stability and has a new option to perform multiple tree searches: News: \u2022 New option --runs to perform multiple tree searches (issue #64 requested by David Maddison). This is motivated by a recent evaluation (Zhou et al. 2018; https://doi.org/10.1093/molbev/msx302 ) showing that 10 independent runs outperformed single run in terms of likelihood maximisation. \u2022 Print branch lengths scaled in number of substitutions for PoMo models. \u2022 Support specifying 6 GTR rates and G-T rate to be zero from command line (requested by Ben Redelings). \u2022 New option --show-lh to compute tree log-likelihood without parameter optimisation (issue #67). Bugfixes: \u2022 Fix compilation with gcc 4.8. \u2022 Incorrect parsing +P for PoMo model string (thanks Carolin Kosiol). \u2022 Issue #66: Incorrect frequency mixture model when coupled with GTR20 (reported by Dominik Schrempf). \u2022 .ufboot trees file contains partial branch supports by combination of -bb and -alrt (reported by Guifre Torruella Cortes). \u2022 Crash in likelihood computation for +ASC model when some states are rare (reported by Paul Madeira). \u2022 Numerical instability for codon models by reducing upper bound of omega/kappa from 100 to 50 (reported by Aleksas Lab). \u2022 Crash reading DNA model from file (reported by Benjamin Redelings). \u2022 Crash with -z option with rooted trees in the presence of identical sequences (reported by cjp1043). Happy computing, IQ-TREE development team "]}, "uWqb6GR86ts": {"topic": "Error-not enough signal in the input temporal constraints in IQTREE v2.1.2", "initializeDate": "Nov 24, 2020, 8:35:04 AM", "timeStamp": "Dec 4, 2020, 4:44:34 AM", "content": ["Hey All I am using the newest version of IQTREE2 (version 2.1.2), and I am getting the same error as < https://groups.google.com/g/iqtree/c/zuTzkkawsOg/m/ZhzY1FfDAwAJ I have tried applying the same advice given in the previous post- by using single calibration with root date and tip dates as zero. Any suggestions why its not working? The calibrations are based on the fossil calibrations of the mrca. Log file, fossil calibration file, alignment file are under \"IQTREE v2.1.2\" error in https://github.com/Jigyasa3/errors Regards Jigyasa ", "This is a question for Hien. @Hien: I use this commit of lsd2: lsd2 @ ae2b90f Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7d5822a4-823e-4e78-b418-a259bbe695c5n%40googlegroups.com ", "Hi Jigyasa, The root date should be smaller than the tips date, so your option should be --date-root -130 and not 130. Please let me know if you know other issues after fixing this. Cheers, Hien "]}, "xUsZ4lXEvXs": {"topic": "Partitions and fixed parameters", "initializeDate": "May 1, 2015, 2:44:05 AM", "timeStamp": "May 27, 2015, 7:31:31 AM", "content": ["Dear All, Is it possible to fix parameters (e.g. for GTR+I+G, plus the overall rate) for partitioned alignments, and if so, how is this specified in the nexus? Best Simon ", "Hi Simon, it is possible to fix the model parameters for each partition. Here is an example of the nexus file for this: #nexus begin sets; charset part1 = 1-100; charset part2 = 101-200; charpartition mine= GTR{1.638368,4.767365,0.433396,1.411073,3.958022,1.000000}+G8{0.325266}+I{0.15} :part1, GTR{0.840473,2.770842,0.554343,1.085628,3.914455,1.000000}+G8{0.170601}+I{0.1}:part2; end; Cheers, Olga You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Olga, Thanks! Now to see if I can get iqtree to give better trees than RAxML/ExaML, as it's currently falling way behind in my test data - I'm using partitioned data with proportional branch lengths (-spp), and the rates are totally wrong... Best Simon ", "Hi Simon, I remember there was a bug fix for the proportional partition model, but I'm not sure whether this version was already released. I will check it and let you know. But anyway, I don't think this fix would effect the rates. Could you possibly provide the alignment? I would check it then in more details. Best, Olga ", "Hi Simon, It would certainly be helpful if you explain us explicitly why think it is wrong? What is your expectation of the rates? Then we can start to figure out what went wrong. As Olga already said, having all the input data will also help to isolate the problem. @Olga: that bug fix is already in the main branch but not yet released. Cheers, Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Dear Minh and Olga, I've put the data and the partition file here: https://gist.github.com/sdwfrost/aa485e05d03161819ce6 The ratio of the rates should be 1:1:2 for gag:pol:env, and this is basically what I get with other approaches e.g. just fitting a GTR+I+G model to each partition separately and calculating the ratios of tree lengths. These data are simulated, so there is a 'true' tree; RAxML (especially) and PhyML are coming much closer, using the same model. Is there a way to tweak the settings of IQTREE to be more stringent? Best Simon ", "Dear Simon, I am currently running your alignment with iqtree to see whether the last bug fix effects the gene rates. I have a little question concerning the options and models you used for RAxML and PHyML in your analysis. Could you please send the output files from those runs? Best, Olga ", "Dear Simon, this bug is fixed in the recent release 1.3.0. To be 100% sure can you please try it and let us know? Thanks a lot, Minh ", "Dear Minh, The variation in rates is wider than it was before, but it's still not right. Based on the data in my gists iqtree-omp -s vill.phy -spp vill_partition -omp 4 -pre vill_partition gives me PART RATE 0 = 0.522 PART RATE 1 = 1.227 PART RATE 2 = 1.010 which should be in the ratio 1:1:2 It doesn't matter whether I use GTR+R[4] or GTR+I+G as the nucleotide model. Best Simon ", "Dear Minh, For comparison, I ran the three partitions separately (as independent files): iqtree-omp -s vill_gag.phy -m GTR+I+G -omp 4 -pre vill_gag and got tree lengths that were in the right range. Here is some R code analysing the trees: > library(ape) > gagtree <- read.tree(\"vill_gag.treefile\") > poltree <- read.tree(\"vill_pol.treefile\") > envtree <- read.tree(\"vill_env.treefile\") > treelength <- function(tr){ + sum(tr$edge.length) + } > treelength(gagtree) [1] 21.46967 > treelength(poltree) [1] 21.13163 > treelength(envtree) [1] 45.52919 For some reason, my middle partition in the full partitioned case (rather than independent, as above) has the wrong rate. Best Simon ", "Dear Simon, version 1.3.1 is now officially released with this bug fixed. thanks for reporting it. Cheers, Minh On 23 May 2015, at 14:08, Simon Frost < sdwf...@gmail.com > wrote: Dear Minh, That seems to have fixed it; I now have the following rates: 0.719 0.707 1.516 This looks much closer to the truth, and is giving me much better lnL. Thanks again, it looks as though you're working hard on IQTREE; I like the built in model selection/partitioning stuff too. Best Simon Best Simon On Sat, May 23, 2015 at 7:37 AM, Bui Quang Minh minh...@univie.ac.at wrote: Dear Simon, can you please check out version 1.3.1: http://www.cibiv.at/software/iqtree/download/ There is another issue in the rate optimization, making it stop prematurely. Note that I have not released this version in the main page yet. Thanks for your patience! Minh ", "Dear Minh, You're welcome! Thanks for the speedy fix. Best Simon "]}, "tlp_L4VdH-o": {"topic": "initial partitions influence on topology and branchlengths", "initializeDate": "Jun 14, 2019, 6:17:49 AM", "timeStamp": "Jun 25, 2019, 4:03:29 PM", "content": ["Dear IQ-tree community, I am a MSc student working on an insect phylogeny of 200 spp circa using 8 genes, including mitochondrial and nuclear PGS and rRNA. The concatenation has been gblocked and thus reduced to 4kbp circa. I am observing some degree of saturation using DAMBE and a lot of heterogenity in base composition using Aligroove. While testing different intial partitioning schemes I observed that they were influencing topology and branchlength of the tree in a quite strong way. The initial partitioning scheme i have been using were the ones I have seen beeing commonly used: (a) all genes separately, resulting in 8 initial partitions. (b) all codon positionin separately + rRNA, resulting in 4 initial partitions. (c) each codon position of ecah PCG + each rRNA separately, resulting in 28 partitions. (d) Moreover, I also tested the GHOST model with 4 classes. My question is: how can I decide which is the \"correct\" - if such a thing exist! - initial partitioning scheme? Until now I observed the average nodal support of each phylogeny (ufboot) and I did likelihood mapping, to asses the performance of each analysis to resolve any quartet in a clear way. Does it make sense? Can i compare Likelihood values of the trees and can I use any different test to focus on a single topology? Thanks you all in advance for the support, Jacopo PS: does it make sense to use concordance factors for 8 gene only? ", "Hi Jacopo, Sorry for the delay, answers below: On 14 Jun 2019, at 6:17 am, Jacopo Martelossi < jacopo.m...@gmail.com > wrote: Dear IQ-tree community, I am a MSc student working on an insect phylogeny of 200 spp circa using 8 genes, including mitochondrial and nuclear PGS and rRNA. The concatenation has been gblocked and thus reduced to 4kbp circa. I am observing some degree of saturation using DAMBE and a lot of heterogenity in base composition using Aligroove. While testing different intial partitioning schemes I observed that they were influencing topology and branchlength of the tree in a quite strong way. My first suggestion is to look at the alignment carefully. Make sure to minise alignment errors. Are sequences orthologous? (e.g. paralogs are quite problematic). This is perhaps the most important step. Wrong alignments may heavily influence the results. Let\u2019s assume for now that the alignments are OK. Given this observation and the saturation issue, I\u2019m wondering what happen if you don\u2019t use GBlock? How many sites did GBlock remove? You can check whether the problem may be reduced if you have more sites in the alignment. You can also try to reduce the number of sequences. For example, you can look at the composition test performed at the beginning of the IQ-TREE run, and perhaps remove those sequences with very low p-values, which do not fit the alignment in terms of sequence composition. You can also analysis the translated amino acid sequences. This may also help to reduce saturation. The initial partitioning scheme i have been using were the ones I have seen beeing commonly used: (a) all genes separately, resulting in 8 initial partitions. (b) all codon positionin separately + rRNA, resulting in 4 initial partitions. (c) each codon position of ecah PCG + each rRNA separately, resulting in 28 partitions. (d) Moreover, I also tested the GHOST model with 4 classes. Yes all these partitioning makes sense. I would also recommend to use the MERGE option, which tries to reduce the number of initial partitions to minimize the BIC score. My question is: how can I decide which is the \"correct\" - if such a thing exist! - initial partitioning scheme? \u201cAll models are wrong, but some are useful\u201d ;-) To be precise, what you can do is to find the \u201cbest\u201d model among the currently available ones. And as hinted above, you can use the BIC. So you can perform different runs, look at the .iqtree file, and pick up the one with the smallest BIC score. Until now I observed the average nodal support of each phylogeny (ufboot) what do you mean by \u201caverage\u201d? and I did likelihood mapping, to asses the performance of each analysis to resolve any quartet in a clear way. Does it make sense? Can i compare Likelihood values of the trees and can I use any different test to focus on a single topology? As said, you should compare the BIC, not likelihood. BIC will balance the trade-off between having more parameter-rich models and the likelihoods. Does that answer your questions? Minh Thanks you all in advance for the support, Jacopo PS: does it make sense to use concordance factors for 8 gene only? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d7cb91b1-8b5d-4113-88f7-2617399beb23%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Hi Minh, first of all thank's for your answer. I had already put some of your sugegstions in practice by scanning the AICc, the BIC and making some LRT between the likelihood of trees obtained with te various partition schemes. Thank's for the suggestion to use the translated sequencies, this could do for mine situation! Best regards, Jacopo. "]}, "6Pfqgpnk4ew": {"topic": "gene tree estimation and MPI", "initializeDate": "Aug 27, 2020, 11:45:42 AM", "timeStamp": "Aug 31, 2020, 7:34:29 AM", "content": ["Hi, I was curious about processor usage for gene tree estimation. We have a project with about 10K loci and want to estimate gene trees. I recommended that the student working on this just use the \"estimate trees for all files in a directory\" option: iqtree -s <DIR> etc. etc. Each locus is somewhere from 1000 bp to 4000 bp but we don't have that many taxa (about 20), so I wasn't convinced that running multiple processors would speed things up. However, I wasn't sure what would if you gave the run say 8 processors - would running iqtree this way launch 8 jobs, one for each processor? Apologies if this answer is in the docs and I missed it ", "Hi Ed, Just a quick typo: the option you want is capital-S, not the lower case s. \u201c-s <DIR>\u201d is to do a concatenation tree (by concatenating all alignments in the directory), whereas \u201c-S DIR\u201d is to do separate trees for each alignment in the directory. For this option, the MPI does not work yet \u2014 only the multi-threading works. We are currently implementing the option to distribute gene tree estimation across processors. But it\u2019s not available yet. That\u2019s why we didn\u2019t describe that in the manual. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/fd747f32-18db-45e0-ad84-1d70209975a5n%40googlegroups.com "]}, "GhuJUnwEqKE": {"topic": "Is this error due to memory insufficient?", "initializeDate": "Sep 21, 2018, 12:13:57 AM", "timeStamp": "Sep 21, 2018, 2:58:30 AM", "content": ["Parameters optimization took rounds 37136.951 sec Computing ML distances based on estimated model parameters ... 11459.564 sec terminate called after throwing an instance of 'std::bad_alloc' what (): std bad_alloc ERROR STACK TRACE FOR DEBUGGING ERROR ERROR *** TREE CRASHES WITH SIGNAL ABORTED ", "Yes, that\u2019s right. Try another computer with more RAM. You can copy all the files over there and rerun with the same command line, IQ-TREE will recover from the checkpoint to save time. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "ss61sLmxLzo": {"topic": "How to add user-defined best fit model parameters to IQ-TREE partition nexus file", "initializeDate": "Jul 13, 2015, 5:08:16 PM", "timeStamp": "Jul 16, 2015, 3:04:46 PM", "content": ["Dear IQ-TREE Team and all, I\u2019d like to ask for your advice/help. I'd like to add Jmodeltest 2.0 best fit model parameters to the IQ-TREE partition nexus file, then run IQ-TREE with this partition file. I just need to compare ML trees made using the best fit models found by IQ-TREE and Jmodeltest 2.0 (the 2 models are a bit different). I have read IQ-TREE manual and the comments on Simon\u2019s question about \u201e Partitions and fixed parameters \u201d. I admit, I still need for help. Jmodeltest output contains several parameters (e.g. kappa, ti/tv etc.), and I do not know where to place them exactly in the nexus file. Could you please look at and may I ask you to correct the draft nexus partition file ? This is the draft nexus file: #nexus begin sets; charset actin = 1-762; charset Btub = 763-1270; charset GPD = 1271-1866; charset ITS = 1867-2375; charpartition partition_by_gene = HKY+F{0.2044,0.3283,0.2358,0.2315} :actin; 001101{8.0933,8.0933,1.0000,1.0000,8.0933,1.0000 }+F{0.2500,0.2500,0.2500,0.2500} :Btub; 010011{0.1653,1.0000,0.1653,0.1653,1.0000,1.0000 }+F{0.2519,0.3230,0.2326,0.1926} :GPD; 000010{1.0000,1.0000,1.0000,1.0000,6.0670,1.0000 }+F{0.2500,0.2500,0.2500,0.2500} :ITS; end; And the Jmodeltest results: Partition Actin: Model selected: Model = HKY partition = 010010 -lnL = 1140.5015 K = 86 freqA = 0.2044 freqC = 0.3283 freqG = 0.2358 freqT = 0.2315 kappa = 8.7193 (ti/tv = 4.3946) PAUP* Commands Block: BEGIN PAUP; Lset base=(0.2044 0.3283 0.2358 ) nst=2 tratio=4.3946 rates=equal pinvar=0; END; Partition Btub: Model selected: Model = 001101 partition = 001101 -lnL = 849.0249 K = 83 R(a) [AC] = 8.0933 R(b) [AG] = 8.0933 R(c) [AT] = 1.0000 R(d) [CG] = 1.0000 R(e) [CT] = 8.0933 R(f) [GT] = 1.0000 PAUP* Commands Block: BEGIN PAUP; Lset base=equal nst=6 rmat=(8.0933 8.0933 1.0000 1.0000 8.0933) rates=equal pinvar=0; END; Partition GPD: Model selected: Model = 010011+F partition = 010011 -lnL = 1038.0239 K = 86 freqA = 0.2519 freqC = 0.3230 freqG = 0.2326 freqT = 0.1926 R(a) [AC] = 0.1653 R(b) [AG] = 1.0000 R(c) [AT] = 0.1653 R(d) [CG] = 0.1653 R(e) [CT] = 1.0000 R(f) [GT] = 1.0000 PAUP* Commands Block: BEGIN PAUP; Lset base=(0.2519 0.3230 0.2326 ) nst=6 rmat=(0.1653 1.0000 0.1653 0.1653 1.0000) rates=equal pinvar=0; END; Partition ITS: Model selected: Model = 000010 partition = 000010 -lnL = 853.6159 K = 83 R(a) [AC] = 1.0000 R(b) [AG] = 1.0000 R(c) [AT] = 1.0000 R(d) [CG] = 1.0000 R(e) [CT] = 6.0670 R(f) [GT] = 1.0000 PAUP* Commands Block: BEGIN PAUP; Lset base=equal nst=6 rmat=(1.0000 1.0000 1.0000 1.0000 6.0670) rates=equal pinvar=0; END; Thanks a lot indeed! Cheers, J\u00f3zsef ", "Dear Jozsef, there is one syntax error: the models specified via charpartition should be comma-separated instead of by semi-colon. Here is the right partition file (modified a bit from yours): #nexus begin sets; charset actin = 1-762; charset Btub = 763-1270; charset GPD = 1271-1866; charset ITS = 1867-2375; charpartition partition_by_gene = HKY{ 8.7193 }+F{0.2044,0.3283,0.2358,0.2315} :actin, GTR{8.0933,8.0933,1.0000,1.0000,8.0933,1.0000 }+FQ :Btub, GTR{0.1653,1.0000,0.1653,0.1653,1.0000,1.0000 }+F{0.2519,0.3230,0.2326,0.1926} :GPD, GTR{1.0000,1.0000,1.0000,1.0000,6.0670,1.0000 }+FQ :ITS; end; +FQ is a shortcut for +F{0.25,0.25,0.25,0.25} Hope that helps! Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Thanks for correcting the partition file and explaining that. Sure, you helped me a lot! Cheers, J\u00f3zsef "]}, "tp_EFJqdrNk": {"topic": "FastaToCounts error", "initializeDate": "Dec 3, 2019, 2:10:43 PM", "timeStamp": "Dec 11, 2019, 9:01:53 AM", "content": ["Hi, sorry the possibly dumb question: wondering if there is a limit to the nsites FastaToCounts can read. I've used it before, and I am trying now with a 1086203 bp fasta and I am getting the following error: (the sequences do are all the same size, I've now checked this twice :S) Thanks! Traceback (most recent call last): File \"/usr/local/bin/FastaToCounts.py\", line 70, in <module> cf.fasta_to_cf(FaRefFN, output, double_fixed_sites=iupac_flag) File \"/usr/local/lib/python3.6/site-packages/cflib/cf.py\", line 308, in fasta_to_cf raise sb.SequenceDataError(\"Sequences do not have equal length.\") cflib.seqbase.SequenceDataError: Sequences do not have equal length. ", "Thank you for your report. I don't have time to look at this now, but will do so on Friday. If possible, could you please send me your data file in the meantime so that I can debug it directly? Best, Dominik Sent from my Android device with K-9 Mail. Please excuse my brevity. ", "Hi, was an error of mine in taxnames that made ir read the two lines consecutively. sorry the dumbness... You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/466425AE-D7A3-4598-A830-6D5C27222F50%40gmail.com Sara Rocha Post-Doc Researcher Phylogenomics Group University of Vigo (Spain) http://darwin.uvigo.es/wordpress/?page_id=575 IUCN SSC Skink Specialist Group (Twitter: @skinks_IUCN) https://www.skinks.org/ ", "Hi Sara, It might still make a useful test case, at least one where we could provide an additional check on the input data and then (potentially) a more useful error message to help diagnose the issue. If you can send your file through (plus, ideally, a description of what was wrong with it and how you fixed it), it would be very helpful. Yours, Rob To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAG%3Ds9gwMgKf6i2baKdf7CA4qNjF_4FzfdBVe5_RurvqwhSSG5Q%40mail.gmail.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "yes, u are right, sorry for my delay in replying. my file is huge but no need of sending it. problem was very simple, but cause file was huge I did not realize it fast: in one of the sequences the \">\" was missing before the taxname - because of the error spelled out (bellow) I just counted the chars of the sequence lines and all seemed OK. a more precise error warning (to a specific line, for example) would be helpful. it was a bit dumb anyway! :S Traceback (most recent call last): File \"/usr/local/bin/FastaToCounts.py\", line 70, in <module> cf.fasta_to_cf(FaRefFN, output, double_fixed_sites=iupac_flag) File \"/usr/local/lib/python3.6/site-packages/cflib/cf.py\", line 308, in fasta_to_cf raise sb.SequenceDataError(\"Sequences do not have equal length.\") cflib.seqbase.SequenceDataError: Sequences do not have equal length To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmpqeMoDvN6EbB3y-E%3DaZtDohgws9n0OQf7DAO3cw4Tvfw%40mail.gmail.com ", "Dear Sara, I have pushed a commit to GitHub so that the names of the sequences of mismatching length are printed in the error message. Do you think this is enough? Since the error is printed only after the Fasta sequence is read, the actual line in the file is hard to retrieve at the location of the error in the code. Best wishes, Dominik >>>> < https://groups.google.com/d/msgid/iqtree/466425AE-D7A3-4598-A830-6D5C27222F50%40gmail.com?utm_medium=email&utm_source=footer >>>> . >>>> >>> >>> >>> -- >>> Sara Rocha >>> Post-Doc Researcher >>> Phylogenomics Group University of Vigo (Spain) >>> http://darwin.uvigo.es/wordpress/?page_id=575 >>> >>> IUCN SSC Skink Specialist Group (Twitter: @skinks_IUCN) >>> https://www.skinks.org/ >>> >>> -- >>> You received this message because you are subscribed to the Google Groups >>> \"IQ-TREE\" group. >>> To unsubscribe from this group and stop receiving emails from it, send an >>> email to iqtree+un...@googlegroups.com >>> To view this discussion on the web visit >>> https://groups.google.com/d/msgid/iqtree/CAG%3Ds9gwMgKf6i2baKdf7CA4qNjF_4FzfdBVe5_RurvqwhSSG5Q%40mail.gmail.com >>> < https://groups.google.com/d/msgid/iqtree/CAG%3Ds9gwMgKf6i2baKdf7CA4qNjF_4FzfdBVe5_RurvqwhSSG5Q%40mail.gmail.com?utm_medium=email&utm_source=footer >>> . >>> >> -- >> Rob Lanfear >> Division of Ecology and Evolution, >> Research School of Biology, >> The Australian National University, >> Canberra www.robertlanfear.com >> -- >> You received this message because you are subscribed to the Google Groups >> \"IQ-TREE\" group. >> To unsubscribe from this group and stop receiving emails from it, send an >> email to iqtree+un...@googlegroups.com >> To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmpqeMoDvN6EbB3y-E%3DaZtDohgws9n0OQf7DAO3cw4Tvfw%40mail.gmail.com >> < https://groups.google.com/d/msgid/iqtree/CAGr%2BNmpqeMoDvN6EbB3y-E%3DaZtDohgws9n0OQf7DAO3cw4Tvfw%40mail.gmail.com?utm_medium=email&utm_source=footer >> . ", "That's of great help, of course! Thanks a lot! To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/87o8wfm097.fsf%40gmail.com "]}, "kSCIxE7AhSs": {"topic": "Constrained tree search crashes with identical taxa", "initializeDate": "Jul 31, 2017, 5:36:21 AM", "timeStamp": "Aug 29, 2017, 7:18:39 AM", "content": ["Hi, I found an edge-case which makes IQTree crash. If a constraint tree is provided, but taxa in the tree are identical in the alignment, IQTree crashes unless you specify not to remove identical taxa. This could be caught and handled better. I assume the same would happen if you provided a user starting tree or fix topology tree. Thanks, Simon ", "Dear Simon, Thanks for pointing out this edge case. I will fix it for the next release. Note that unlike your assumption, the user starting tree option handles identical sequences already, thus should work fine. Cheers, Minh ", "Dear Luana, There is nothing wrong - It is known to us that this parsimony tree step takes a lot of time with the constraint tree option when you have large trees (hundreds of sequences or more) \u2026. we are working towards a solution... Minh On Aug 29, 2017, at 11:17 AM, LuaBgd < lua...@gmail.com > wrote: Hi ! I am also using IQ tree with a constraint tree and it seems that my job is stuck for 24 hours on the same step : Creating fast initial parsimony tree by random order stepwise addition... Does that mean that something is wrong or is it a long step ? I used IQ tree as follow : iqtree -s FcC_supermatrix.phy -spp partition_file.best_scheme -nt 4 -g constr_mcv4.newick -keep-ident Thank you for you time, Luana phD student You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "zivmR7bQu2w": {"topic": "UFBoot2", "initializeDate": "Nov 22, 2017, 8:22:42 AM", "timeStamp": "Nov 22, 2017, 6:02:08 PM", "content": ["Hi Minh, j just a short question: UFBoot2 (paper: https://academic.oup.com/mbe/advance-article/doi/10.1093/molbev/msx281/4565479 ) is not implemented in 1.5.5 - and 1.6 is not released yet, isn't it? In addition: still one should not compare normal (slow) with any fast BS values, correct? Many thanks Karen ", "Hi Karen, On Nov 22, 2017, at 2:22 PM, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Hi Minh, j just a short question: UFBoot2 (paper: https://academic.oup.com/mbe/advance-article/doi/10.1093/molbev/msx281/4565479 ) is not implemented in 1.5.5 - and 1.6 is not released yet, isn't it? Right, 1.6 is still beta version. We have to do more testing before official release. In addition: still one should not compare normal (slow) with any fast BS values, correct? That\u2019s right, UFBoot2 will just speed up, the interpretation of support values is the same as UFBoot. Unless you use -bnni option. We explained all in this paper. Cheers, Minh Many thanks Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "QMi7mcNjcLk": {"topic": "Tree topology test error: ree file does not start with an opening-bracket '(' (line 2 column 0)", "initializeDate": "Apr 16, 2020, 10:36:51 AM", "timeStamp": "May 27, 2020, 5:50:50 AM", "content": ["Hi all, I recently did the tree topology test, but get this error: Tree file does not start with an opening-bracket '(' (line 2 column 0), I first cat three tree results from iqtree with the same data but different parameters, such as mfp, mfp+merge, then I want to know which show more robust topology so I did the test This is the command I use: ~/Downloads/iqtree-2.0-rc1-MacOSX/bin/iqtree -s FcC_supermatrix.phy -z all.trees -zb 1000 -n 0 -wpl -pre all &>all-log Thanks ", "Hi Jiachen, That\u2019s strange, your input tree file is correct and was loaded in sucessfully. So this is an internal error of IQ-TREE, nothing to do with users. Can you send me the tree file, and a smaller alignment? i.e., just take first 1000 sites in your original alignment. I\u2019ll have a look. In the mean time, can you repeat the analysis ignoring model selection by just inputting the best model (-m GTR+F+R8) into the command line. It looks that some interaction with previous model selection (from the checkpoint) caused this error. Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b3f049d4-7803-4abb-9179-25aeb33c8cc2%40googlegroups.com <all.trees> <all-log.> ", "Hi Minh, Thanks for the reply, I will try them, but I have a question that i use different partition file resulted from different model selections (e.g. mfp, mfp+merge) to do the original three tree search and then do the topology test, but i do not provide partition file for the topology test instead just phy file, because I have different best_scheme file, is this the right way to do it? Thanks Jiachen \u5728 2020\u5e744\u670817\u65e5\u661f\u671f\u4e94 UTC+8\u4e0a\u53484:30:46\uff0cMinh Bui\u5199\u9053\uff1a Hi Jiachen, That\u2019s strange, your input tree file is correct and was loaded in sucessfully. So this is an internal error of IQ-TREE, nothing to do with users. Can you send me the tree file, and a smaller alignment? i.e., just take first 1000 sites in your original alignment. I\u2019ll have a look. In the mean time, can you repeat the analysis ignoring model selection by just inputting the best model (-m GTR+F+R8) into the command line. It looks that some interaction with previous model selection (from the checkpoint) caused this error. Thanks, Minh On 17 Apr 2020, at 12:36 am, jiachen zhu < zjche...@gmail.com > wrote: Hi all, I recently did the tree topology test, but get this error: Tree file does not start with an opening-bracket '(' (line 2 column 0), I first cat three tree results from iqtree with the same data but different parameters, such as mfp, mfp+merge, then I want to know which show more robust topology so I did the test This is the command I use: ~/Downloads/iqtree-2.0-rc1-MacOSX/bin/iqtree -s FcC_supermatrix.phy -z all.trees -zb 1000 -n 0 -wpl -pre all &>all-log Thanks You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Jiachen, This depends on what you are trying to test, and what assumptions you are willing to make. The best paper to read as an introduction to what you should be doing, and to make sure you understand properly what is happening in IQ-TREE topology tests, is this one: Likelihood-Based Tests of Topologies in Phylogenetics Nick Goldman, Jon P. Anderson, Allen G. Rodrigo https://academic.oup.com/sysbio/article/49/4/652/1678908 A common use case is to ask whether the best tree (call it Tree A) estimated under the best model is significantly better than some other tree (tree B) estimated in some other way. In this case, you would provide the partition file from the best partitioning scheme (used to estimate tree A) when doing the topology test. This allows you to ask whether tree B can be rejected in favour of tree A, given the particular model of molecular evolution assumed by the partition file. Another way to put this in a more general sense is that all comparisons of tree topologies in an ML framework are conditional on the models of molecular evolution, so you need to think carefully about precisely what your question is. That article above is the best starting point. Rob To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/06f344e8-222e-4a30-bb41-f9589a641143%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Hi Jiachen, hi Rob, Let\u2019s assume that Jiachen wants to perform the AU test (or other tree topology test). Then you should use the partition model (best_scheme file) from MFP+MERGE option. This will be almost always better than MFP alone. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmq2yB6t1vTY9grWQDQ7VtEkcr-QioGHBBBzc%2BsbREMASQ%40mail.gmail.com ", "Dear Minh: Thanks for the reply, and i also have a question that does tree topology test can test different trees from different software? like i use concatenate (iqtree and mrbayes) and coalescent method (ATRSAL) to construct a tree, how can i do the test? Regards Jiachen \u5728 2020\u5e744\u670828\u65e5\u661f\u671f\u4e8c UTC+8\u4e0a\u534811:05:19\uff0cMinh Bui\u5199\u9053\uff1a Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/06f344e8-222e-4a30-bb41-f9589a641143%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmq2yB6t1vTY9grWQDQ7VtEkcr-QioGHBBBzc%2BsbREMASQ%40mail.gmail.com ", "Yes, you can put all trees from different software into one file and pass it to IQ-TREE via -z option. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c70924db-0f59-4e88-999a-6745856d7ecc%40googlegroups.com ", "Dear Minh: Thanks for the reply, does i need to provide the partition file and models for them? but they usually had different partition files and different models, or i can just provide a phy file and a set of tree Regards Jiachen \u5728 2020\u5e745\u670822\u65e5\u661f\u671f\u4e94 UTC+8\u4e0b\u53485:57:43\uff0cMinh Bui\u5199\u9053\uff1a Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c70924db-0f59-4e88-999a-6745856d7ecc%40googlegroups.com ", "Hi Jiachen, Please have a look at the recent answers on this forum on tree topology tests. There are lots of similar questions. The key thing to understand is that tree topology tests are conditioned on a particular model. The best thing to do if you are confused is to read this paper, which sets out a clear framework for understanding what each of the tests is doing: https://academic.oup.com/sysbio/article/49/4/652/1678908 Rob To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/a776de9a-dc62-40f0-b3e9-8ced19f7086a%40googlegroups.com "]}, "Zz-rWZTCf10": {"topic": "Different best models results under IQ-TREE 1.6.12. and IQ-TREE 2", "initializeDate": "Mar 2, 2020, 4:17:38 AM", "timeStamp": "Apr 6, 2020, 4:10:51 AM", "content": ["Hi! I am struggling a bit with getting used to the new version and hope you can help me. I try to run a small nucleotide dataset (131 taxa, 1603 nucleotides) with four partitions for which I want to find the best substitution models (under MrBayes) and schemes using the PartitionFinder2 algorithm. However, I get different results depending on the IQ-TREE version. I use the commands -m TESTMERGE -mset mrbayes. For IQ-TREE 1.6.12 I get the following models: GTR+F+I+G4: mtSSU, GTR+F+I+G4: ITS1 ITS2, K2P+G4: 58S. For IQ-TREE 2 I get this: GTR+F+I+G4: mtSSU, GTR+F+I+G4: ITS1 ITS2, GTR+F+I+G4: 58S. It seems as if IQ-TREE 2 does not check all 2, 4, and 6 rate models any more when specifying the the mrbayes models option. Am I doing something wrong in the new version? I would very much appreciate any hints! Best regards, Sonja ", "Hi Sonja, Can you pls send me all theinput and output files? this is small enough so, I can quickly reproduce the run, before answering. Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e0a1d5e5-6d0c-48ab-b5d6-fcf7743bac99%40googlegroups.com ", "Hi Minh, here are the input files. I did not finish the runs since the models differed. Hope you can help me to find out if I did anything wrong. Best regards, Sonja "]}, "V9PpjoaYgwY": {"topic": "Required information for analysing Splits.nex Output", "initializeDate": "May 13, 2017, 2:22:04 PM", "timeStamp": "Oct 27, 2020, 10:16:52 PM", "content": ["I used IQTree with the command: ./iqtree-omp -s SNP.phy -m GTR+ASC -bb 1000 -alrt 1000 -nt 32 One of the outputs was SNP.phy.splits.nex. May I ask you please to provide me with the references IQTree used to generate this splits file as I didn't find anything in the manual? Moreover, I opened this file with SplitsTree and it seems that SplitsTree automatically generated the network using this splits file. I don't know why most of SplitsTree options was deactivated and I wan't able to figure out which algorithm SplitsTree used to generate this graph. I highly appreciate if someone can clarify these issues to me and provide related references. Thank you in advance :) ", "Dear RJ, thanks for the question - it reminds me that we should document this feature. IQ-TREE generates .splits.nex file, which contains all splits present in the bootstrap trees with their bootstrap supports in percentage (e.g. the frequency each split occurs in the set of bootstrap trees). One can view this file in SplitsTree program to explore the conflicting signals in the data. So it is more informative than consensus tree, e.g. you can see how highly supported the second best conflicting split is, which had no chance to enter the consensus tree. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Many thanks dear for your prompt respond, I highly appreciate this. ", "In addition, since the splits file contains splits already, when analyzing this with SplitsTree all the options which exist to produce sets of splits might be deactivated. The reason is that, differently to if you feed SplitsTree the alignment, here this set of splits was generated by IQ-Tree, not some algorithm in SplitsTree. You should still be able to set parameters like thresholds for splits used in the graph. Best wishes, Heiko Schmidt ", "Dear Minh, Is it possible to plot the bootstrap values for the splits in the splits.nex on SplitsTree? I'm able to load the splits.nex into SliptsTree, but no bootstrap values are shown. Cheers! Carol. ", "Hi Carol, the boostrap values are assigned as split weights in SplitsTree. You can ask SplitsTree to display them. Cheers, Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6d59988b-8d8e-4c59-be18-f7b9b9730e3dn%40googlegroups.com "]}, "xVxurAjvoIY": {"topic": "PoMo errors: ascertainment bias, polymorphism, and scaffold numbering", "initializeDate": "Mar 4, 2018, 6:29:22 AM", "timeStamp": "Apr 7, 2018, 5:32:32 AM", "content": ["Hi all, I\u2019ve come up against a series of errors when doing a polymorphism aware analysis using SNP data. These come from low-coverage GBS SNPs (i.e. lots of missing data) called relative to a highly fragmented reference genome (1000s of scaffolds). 1. When using ascertainment bias correction (+ASC) it says this isn\u2019t yet implemented in PoMo. Do you know if there are plans to do this (or if there\u2019s a beta version with this implemented)? 2. If I then try it without ASC, I get this error \u201cProvided alignment is exclusively used by PoMo but model string does not contain, e.g., \"+P\".\u201d What is \u201c+P\u201d? I can\u2019t find information on it anywhere. 3. When I then run it with \u201c+P\u201d it runs, but with an error \u201cWARNING: Numerical underflow for lh-derivative\u201d, it then runs for a long time producing the standard output, but then fails, with the following error: WARNING: Numerical underflow for lh-derivative ERROR: iqtree.cpp:3149: virtual pair<int, int> IQTree::optimizeNNI(bool): Assertion `curScore > appliedNNIs.at(0).newloglh - params->loglh_epsilon' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: /localdisk/home/atwyford/Programs/cflib/scripts/Euphrasia_UK_maxmiss020318.cf.log ERROR: *** Alignment files (if possible) Aborted I\u2019ve attached the logfile (relevant part line 1255 onward) and the first 10 lines of the alignment. I note that the scaffold is missing in this file (reported as NA)\u2014is this part of the problem? I formatted the data with cflib, but I might need to go back and check the format for scaffold numbering in the genome file. In the meantime, I'll generate a sequence file with invariant sites, in the hope this gets round some of these issues. Many thanks in advance for your help. Alex ", "Dear Alex, I apologize for not coming back to you earlier. Thank you very much for using PoMo with your data set, which seems to be a perfect use case! As you already observed, ascertainment bias correction is not implemented for PoMo. At the moment, we do not plan to add this feature. One reason is that the level of polymorphism (or heterozygosity) cannot be estimated when constant sites are not present in the alignment. A possibility would be to let the user define a heterozygosity (which is in fact already possible), if it is known and constant sites are not available at all. You mentioned that you could prepare data including constant sites, so I would opt for this path at the moment. Second, the +P is the +polymorphism (PoMo) flag. We decided to force an explicit statement of +P so that the used model is completely defined when looking at the model string only (and not only by the type of data). The complete model string will be printed in the .iqtree file when the run has completed. You can check the possible models with `iqtree -h`. There is a section about POLYMORPHISM AWARE MODELS. For instance, you might want to decrease N to 7 or 5, this also greatly increases numerical stability. Third, I observed that you started your runs from a previous checkpoint. This is not recommended when the command line has changed (from GTR+ASC to GTR+P in your case). Please use the `-redo` flag to force a complete rerun. Finally, I believe that because of not including constant sites, the estimated level of polymorphism (0.35 as far as I can see) is extremely large. That is why the Eigendecomposition fails and the error is reported. I expect that this will be not the case when you run IQ-TREE with PoMo on your full data, but I am very happy to help in case you encounter problems. Thanks again for your interest, Dominik > -- > You received this message because you are subscribed to the Google Groups > \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an > email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Dear Dominik, Many thanks for you very useful answer. I've now rerun the analysis on the full data set (including invariant sites), and it has worked really well. One final question: how do I convert PoMo branch lengths to 'standard' branch lengths based on nucleotide substitutions? I've copied the relevant part below, but it wasn't entirely obvious to me what I should do with this. Do I have to manually correct the NEWICK branch lengths, and if so, how do I adjust them? Thanks! Alex NOTE: The branch lengths of PoMo measure mutations and frequency shifts. To compare PoMo branch lengths to DNA substitution models use the tree length measured in substitutions per site. Total tree length (sum of branch lengths) - measured in number of mutations and frequency shifts per site: 17.1950 - measured in number of substitutions per site (divided by N^2): 0.6878 Sum of internal branch lengths - measured in mutations and frequency shifts per site: 2.6534 (15.4315% of tree length) - measured in substitutions per site: 2.6534 (15.4315% of tree length) ", "Hi Alex, I am glad that it worked! You are right. You can compare the \"PoMo branch lengths\" to branch lengths of standard substitution models. The conversion factor is 1/(N**2), in words, one over N squared (if you did not specify N, it will be 9). I.e., PoMo branch lengths are longer because they also include frequency shifts (i.e., genetic drift, and not only substitutions). However, it is expected that the converted branch lengths will differ (because PoMo accounts for polymorphisms and thereby, e.g., terminal branch lengths are expected to be much shorter). I added some code to the `pomo_latest` branch, so that trees with both types of branch lengths are printed. At the moment, you need to compile IQ-TREE yourself, if you want to use this code. I am also not sure, if you want to rerun your analysis :), so a manual conversion might be better for you. You can find the derivation of the conversion factor in our publication, in section 2.8. Schrempf, D., Minh, B. Q. B. Q., De Maio, N., von Haeseler, A., & Kosiol, C. (2016). Reversible polymorphism-aware phylogenetic models and their application to tree inference. Journal of Theoretical Biology, 407, 362\u2013370. http://doi.org/10.1016/j.jtbi.2016.07.042 I hope that I could help! Kind regards, Dominik "]}, "RIIFYYcrUyc": {"topic": "IQ-TREE with the -fast option is s", "initializeDate": "Jan 13, 2020, 6:40:29 AM", "timeStamp": "Feb 1, 2020, 12:19:12 AM", "content": ["Hi, I'm trying to obtain a tree from amplicon sequencing dataset with ~12,000 sequences and 600 variants. According to the documentaion the -fast should approach FastTree in computation speed, yet while FastTree runs under 1-2 hrs on my machine, IQ-TREE has been claculating this tree for 5 days now and is still not done. I ran the following command: mpirun -np 96 iqtree -s Seqs_filteredalign -fast -nt AUTO On a 96 thread server with 512 GB RAM. Am I missing something? Thanks in advance, Roey ", "Hi Roey, Before looking futther, Just to be sure: with MPI version the executable is named iqtree-mpi (by default, except if you change the name). Can you please make sure that it is the MPI version of IQ-TREE? You can look at the first line of the log file, that prints the Copyright and also the type of executable. Just simply paste this line here. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9e976c66-378b-4055-bd43-a97233261f6e%40googlegroups.com ", "hmm good point. I did run iqtree and not iqtree-mpi however I do see all 96 cores active. Do you think it's worthwhile killing the process at this stage? Not sure where I got that from On Monday, 13 January 2020 13:50:42 UTC+1, Minh Bui wrote: Hi Roey, Before looking futther, Just to be sure: with MPI version the executable is named iqtree-mpi (by default, except if you change the name). Can you please make sure that it is the MPI version of IQ-TREE? You can look at the first line of the log file, that prints the Copyright and also the type of executable. Just simply paste this line here. Minh On 13 Jan 2020, at 10:40 pm, Roey Angel < work.r...@gmail.com > wrote: Hi, I'm trying to obtain a tree from amplicon sequencing dataset with ~12,000 sequences and 600 variants. According to the documentaion the -fast should approach FastTree in computation speed, yet while FastTree runs under 1-2 hrs on my machine, IQ-TREE has been claculating this tree for 5 days now and is still not done. I ran the following command: mpirun -np 96 iqtree -s Seqs_filteredalign -fast -nt AUTO On a 96 thread server with 512 GB RAM. Am I missing something? Thanks in advance, Roey You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "The word \u201cMPI\u201d should appear on the first line, something like this: IQ-TREE MPI multicore version 2.0-rc1 for Linux 64-bit built Jan 6 2020 If not, then please definitely kill your jobs. Right now they are acting as 96 separate IQ-TREE runs, which are overwriting output files of each other. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0f6e29e5-5250-4917-8388-2f11e65197ba%40googlegroups.com ", "It took us some time because we had to upgrade our server. Now MPI works but immediately after the sequence composition test I get the following error from MPI: =================================================================================== = BAD TERMINATION OF ONE OF YOUR APPLICATION PROCESSES = PID 12395 RUNNING AT anaerobe = EXIT CODE: 11 = CLEANING UP REMAINING PROCESSES = YOU CAN IGNORE THE BELOW CLEANUP MESSAGES =================================================================================== YOUR APPLICATION TERMINATED WITH THE EXIT STRING: Segmentation fault (signal 11) This typically refers to a problem with your application. Please see the FAQ page for debugging suggestions According to MPI help this is a problem with IQTREE not with MPI. Any idea where this could come from? Thank again Roey On Tuesday, 14 January 2020 02:19:12 UTC+1, Minh Bui wrote: The word \u201cMPI\u201d should appear on the first line, something like this: IQ-TREE MPI multicore version 2.0-rc1 for Linux 64-bit built Jan 6 2020 If not, then please definitely kill your jobs. Right now they are acting as 96 separate IQ-TREE runs, which are overwriting output files of each other. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0f6e29e5-5250-4917-8388-2f11e65197ba%40googlegroups.com ", "Hi Roey, Sorry for the delay - I\u2019m on annual leave. Can you pls send to my personal email the log file and the data per further inspection? Thanks, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/3cb6cd63-9207-4443-91e8-5cb7a1a50aa8%40googlegroups.com "]}, "D9L1c6tkV5Y": {"topic": "Re: [iqtree] How can I do 100 bootstrap for each gene?", "initializeDate": "Aug 11, 2019, 3:41:56 AM", "timeStamp": "Aug 15, 2019, 9:20:43 PM", "content": ["Hi Jessica, Sorry for the slow response, I was travelling. -S is a new option in the beta version, and therefore not all options are supported in combination with -S, in particular this bootstrap option. Right now, -S can only work with basic ModelFinder and tree search. Cheers, Minh On 25 Jul 2019, at 7:31 pm, Jessica < xumei...@gmail.com > wrote: Hi everyone, I have more than 2000 genes, and they are put in the same folder, I have got the gene tree for each loci by the command iqtree1.7 -S folder_name --prefix loci -nt AUTO Now I want to do 100 bootstrap for each loci, and if possible, each loci with one different folder, but how can I do that? I tried to use the command as iqtree1.7 -S folder_name --prefix loci_bo -bo 100 -nt AUTO I found it isn't for each loci. Regards, Jessica You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/befbea42-e699-435b-b8c7-afea9d58d7ce%40googlegroups.com ", "Dear Jessica, I have designed a software (PhyloSuite: https://dongzhang0725.github.io ), it integrates IQ-TREE and enables IQ-TREE to reconstruct trees in batches.This is especially suitable for the case that reconstructs trees for mutiple genes (separately), and all the IQ-TREE parameters can be used normally. I hope it will be suitable for your dataset. If you have any problems, please don't hesitate to contact me ( dongzh...@gmail.com Regards, Dong Zhang \u5728 2019\u5e748\u670811\u65e5\u661f\u671f\u65e5 UTC+8\u4e0b\u53483:41:56\uff0cMinh Bui\u5199\u9053\uff1a Hi Jessica, Sorry for the slow response, I was travelling. -S is a new option in the beta version, and therefore not all options are supported in combination with -S, in particular this bootstrap option. Right now, -S can only work with basic ModelFinder and tree search. Cheers, Minh On 25 Jul 2019, at 7:31 pm, Jessica < xumei...@gmail.com > wrote: Hi everyone, I have more than 2000 genes, and they are put in the same folder, I have got the gene tree for each loci by the command iqtree1.7 -S folder_name --prefix loci -nt AUTO Now I want to do 100 bootstrap for each loci, and if possible, each loci with one different folder, but how can I do that? I tried to use the command as iqtree1.7 -S folder_name --prefix loci_bo -bo 100 -nt AUTO I found it isn't for each loci. Regards, Jessica You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "The software PhyloSuite sounds great and I will try it. Thank you. Cheers, Jessica \u5f20\u4e1c < dongzh...@gmail.com > \u4e8e2019\u5e748\u670813\u65e5\u5468\u4e8c \u4e0a\u534811:12\u5199\u9053\uff1a To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/792943e5-89e2-4f2d-a438-08fe8ad44d65%40googlegroups.com "]}, "c5U2FPjdPo0": {"topic": "Running partitioned analysis with mixed data", "initializeDate": "Jun 12, 2018, 12:19:16 PM", "timeStamp": "Jun 14, 2018, 9:28:33 PM", "content": ["Hello, I am attempting to run a partitioned analysis with mixed data on version 1.6 of IQTree but for some reason IQTree keeps entering an unending loop when loading the molecular sub-alignment. I am using two sub-alignments in .phy format, one for morphological and one for molecular data, and a single .nex file (example.nex) that has all the partitions with sub-alignment file designations as well as models designated for each partition. When executing IQTree, using: iqtree -spp example.nex the software loads the morphological alignment but then continuously loops over loading the molecular alignment, repeatedly calculating gap/ambiguity, p-value, and composition values for the molecular alignment but never moving past this to load the partitions. I have tried different flags (-spp, -sp, -q) when calling the file but have the same issue. Trying to figure out if there was something wrong with my alignment or partition file, I started IQTree with just molecular alignment. In that case the software performed without this loop and began the analyses. Has this been mentioned previously with 1.6? I have tried with multiple operating systems and remade all my files but still have the same outcome. Thank you for any assistance you can offer, Matt ", "Hi Matt, Though I suspect there is something wrong with your input file, it\u2019s not possible to answer your question without looking at the input file and the log file. Thus, can you send me these files via my personal email? Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, After sending you an email yesterday with the files you asked for, the loop finally ended and progressed to the next phase of the analysis. It looped the same number of times as partitions I have specified in the input. While progress has been made, I now am receiving a new error: Log-likelihood of BIONJ tree: -3903526.137 -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Generating 98 parsimony trees... ERROR: Tree file does not start with an opening-bracket '(' (line 1 column 1) I have checked the tree files that IQTree has generated and there do not seem to be any issues with opening brackets or mismatched brackets. I saw this error was mentioned in a previous post from September, but it was not clear to me if a solution had be found. Thank you as always for any assistance you can provide, Matt ", "Hi Matt, I see, indeed I suspected the same after looking at your partition file. To avoid heavy loading, you can change your partition file from: #nexus begin sets; charset Subset1 = dna.phy:\u2026; charset Subset760 = dna.phy:415534-416203\\3; charset Subset761 = morph.phy:1-275; #nexus begin sets; charset Subset1 = \u2026; charset Subset760 = 415534-416203\\3; charset Subset761 = morph.phy:1-275; Meaning that just delete dna.phy, and then provide it via -s dna.phy in the command line. That way, this file will be loaded only once. Regarding Generating 98 parsimony trees... ERROR: Tree file does not start with an opening-bracket '(' (line 1 column 1) Please re-run with option -redo, which will completely redo the analysis. Let me know if that works. Cheers Minh "]}, "LUJHAn_Sldc": {"topic": "error message on snp dataset", "initializeDate": "Aug 13, 2019, 8:28:17 PM", "timeStamp": "Aug 16, 2019, 3:22:51 AM", "content": ["I just installed iq-tree 1.6.11 on a windows 10 machine. Getting a bit of an odd error which is coming up with a path on Minh's computer! c:\\genetics\\iqtree>iqtree -s gudgeon_svd.good.phy.varsites .phy -m TEST+ASC -bb 10000 -alrt 10000 -st DNA -nt 4 The data consists of 231 individuals and 8159 snps. ERROR: C:\\Users\\minh\\Dropbox\\iqtree-git\\tree\\phylotree.cpp:2652: virtual double PhyloTree::optimizeAllBranches(int, double, int): Assertion `fabs(new_tree_lh-tree_lh) < max_delta_lh' failed. Obviously, C:\\Users\\minh\\Dropbox\\iqtree-git\\tree\\phylotree.cpp is not a path on my machine. Any clues on what to do? Thanks Peter ", "Forgot to attached the full logfile... ", "Hi Peter, That\u2019s the path on my computer :-) Since a few people reported the same crash on Windows machine, I think I have fixed it now, can you check out this release candidate version: https://github.com/Cibiv/IQ-TREE/releases/tag/v1.6.11.1 And let me know whether it indeed works or not? Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6c298bd9-ddb5-42e2-9bdb-0742b6c30ad4%40googlegroups.com "]}, "nxLUAMmKu24": {"topic": "Custom protein model matrix", "initializeDate": "Jun 5, 2020, 8:59:19 AM", "timeStamp": "Aug 26, 2020, 9:17:45 PM", "content": ["Dear All, I am using the tree reconstruction via custom protein model. I was wondering whether the custom matrix gets renormalised/rescaled at any point in the algorithm? Thank you very much in advance! ", "Hi there, Yes, the Q matrix is renormalised such that the total number of substitutions is 1. I can\u2019t remember the exact detail, but it\u2019s something like: \\sum (Q_ii * pi_i) = -1 where Q_ii is the diagonal of the rate matrix, and pi_i is the frequency of state i. With Q_ij = r_ij * pi_j, where r_ij is the entry of your custom. and Q_ii is chosen s.t. the row sum of Q_i is 0. So Q_ii is always negative. But you can cross check the equation in any text book about molecular evolution / Markov process. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1820af0c-e9f7-42ed-9076-8bae23289984o%40googlegroups.com ", "Dear Minh, Thank you very much for the previous answer. I was also wondering whether there is a way of of scaling the overall evolutionary rate of the tree, i.e. to factor what is called 'evolutionary speed' in the output file tree_branches.iqtree? From what I can see this is impossible to do by multiplying the custom protein matrix by a factor.... Thank you very much in advance, Alina On Tuesday, 9 June 2020 02:48:58 UTC+2, Minh Bui wrote: Hi there, Yes, the Q matrix is renormalised such that the total number of substitutions is 1. I can\u2019t remember the exact detail, but it\u2019s something like: \\sum (Q_ii * pi_i) = -1 where Q_ii is the diagonal of the rate matrix, and pi_i is the frequency of state i. With Q_ij = r_ij * pi_j, where r_ij is the entry of your custom. and Q_ii is chosen s.t. the row sum of Q_i is 0. So Q_ii is always negative. But you can cross check the equation in any text book about molecular evolution / Markov process. Minh On 5 Jun 2020, at 10:59 pm, Alina Bazarova < albaz...@gmail.com > wrote: Dear All, I am using the tree reconstruction via custom protein model. I was wondering whether the custom matrix gets renormalised/rescaled at any point in the algorithm? Thank you very much in advance! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Alina, For a given tree witth branch lengths, you can simply multiply all branch lengths with a scaling factor. That would do the job. Is that what you wanted to do? If not, then pls describe what you wanna do exactly. Cheers Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e3fa32ef-d4cf-4dcf-945b-bd949e407e32o%40googlegroups.com ", "Hi Minh, Thank you very much for your answer. Yes, that does answer my question. However, is there a simple way of doing this in the context of complex models? I.e. if I have a model with two partitions and want to factor the evolutionary rate of one of the trees with respect to another before the final tree is reconstructed... Thank you very much in advance, Best regards, Alina To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e3fa32ef-d4cf-4dcf-945b-bd949e407e32o%40googlegroups.com ", "Unfortunately, I still don\u2019t understand what you wanted to do. Sorry Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f2e27c7f-7546-4033-b465-b268bdc74a4fo%40googlegroups.com ", "Hi Minh, Many thanks for your reply and sorry for not expressing myself clearly enough. Basically I am running a tree reconstruction using a complex model which consists of two partitions, one of which corresponds to a protein model. Then in the corresponding .iqtree file the speed of each partition is reported (it is exactly called \u2018Speed\u2019). What I was wondering is whether there is a simple way of increasing or decreasing the speed corresponding to the protein model partition with respect to the other model without changing the proportions between the elements of the input protein model matrix? Thank you very much in advance, Best regards, Alina Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f2e27c7f-7546-4033-b465-b268bdc74a4fo%40googlegroups.com ", "Hi Alina, I see what you meant now, you want to set the speed of the partitions to some specific value, instead of IQ-TREE optimising it. There is no such option. Sorry. One will need to modify the source code file model/partitionmodelplen.cpp. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e2723537-7e53-4aaf-877c-24a45ba7afa7o%40googlegroups.com "]}, "v8gz90eeWUs": {"topic": "Problem with building ML tree using k2p model", "initializeDate": "Nov 22, 2020, 12:57:05 AM", "timeStamp": "Nov 30, 2020, 7:05:01 PM", "content": ["Hello everyone, I am using iqtree-1.6.12 to build a tree using -m k2p My fasta file have more than 80000 sequences , and length is about 29000 bp Here is the error message in output.fas.lo For your convenience alignment with unique sequences printed to output.fas.uniqueseq.phy Create initial parsimony tree by phylogenetic likelihood library (PLL)... 19545.451 seconds NOTE: 51060 MB RAM (49 GB) is required! Estimate model parameters (epsilon = 0.100) 1. Initial log-likelihood: -923093.095 2. Current log-likelihood: -852739.539 3. Current log-likelihood: -851092.873 4. Current log-likelihood: -848821.802 5. Current log-likelihood: -845436.452 6. Current log-likelihood: -838871.175 Optimal log-likelihood: -838871.172 Rate parameters: A-C: 1.00000 A-G: 4.52807 A-T: 1.00000 C-G: 1.00000 C-T: 4.52807 G-T: 1.00000 Base frequencies: A: 0.250 C: 0.250 G: 0.250 T: 0.250 Parameters optimization took 6 rounds (2862.464 sec) Computing ML distances based on estimated model parameters...ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: output.fas.log ERROR: *** Alignment files (if possible) Has anyone else know what is the problem? Thanks, Kent ", "Hello, Kent. Older versions of IQTree will crash during calculations of ML distances, when processing alignments containing more than n=46,340 sequences. The \"Computing ML Distances\" step constructs a distance matrix, which is stored as a flattened-out n*n array. In older versions of IQTree, the calculation of the index into the array was done with a 32-bit signed integer. When n*n>(power(2,31)), which happens when n>46340, at least some of the index calculations will yield negative indices (due to integer overflow), which results in attempts to write to memory addresses (way!) outside the distance matrix (16 Gb \"below\" it!), resulting in segmentation violations and a crash. More recent versions of IQTree (I think, 2.0.8 and up) use 64-bit unsigned integer math to access the entries in the distance matrix. They will also calculate the ML distances more quickly (mileage will vary, depending on your hardware, but for 29000 bp alignments with that many sequences, probably about 40x faster). I suggest using version 2.1.0, or later, on your alignment. Regards, James You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9879e9c8-1b08-425c-81d3-d96800b45964n%40googlegroups.com ", "Hello James , Thank you very much ! The program run for few days with no problem so far, I think it may work !! Really appreciate your help. Sincerely, Kent james_b...@yahoo.com \u5728 2020\u5e7411\u670824\u65e5 \u661f\u671f\u4e8c\u4e0a\u53486:55:42 [UTC+8] \u7684\u4fe1\u4e2d\u5beb\u9053\uff1a ", "Hi Kent, Just to weigh in with something that might be useless. It looks a lot like you're trying to estimate trees of SARS-CoV-2. If this is the case, I have a regularly-updated global phylogeny of SARS-CoV-2 genomes from GISAID here: https://github.com/roblanf/sarscov2phylo/ And shortly GISAID will start releasing updates of this tree every single day. Currently we just use the ~150K 'high quality' genomes, but I am working on adding in all of the genomes as well. There are some technical difficulties with the latter, but it's close. Feel free to contact me if you have any questions, and apologies if your work has nothing to do with SARS-CoV-2!!! Rob To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/15570d8c-0bd6-4570-8d78-6e87f793d386n%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com "]}, "o0l-yhdwmOg": {"topic": "Error when run \"iqtree -s example.phy -m 12.12 -B 1000 -bnni\"", "initializeDate": "Apr 26, 2021, 11:21:36 AM\u00a0(2 days ago)\u00a0", "timeStamp": "Apr 26, 2021, 11:21:36 AM\u00a0(2 days ago)\u00a0", "content": ["Hi Minh, These days, I tried to run \"rootstrap.py\". So I tried to get the .ufboot file from Iqtree. But When I run the command with -m Lie markov Model (e.g 12.12 or 5.6b) in my data\"RokasS_2003 \" or example.phy, I get the error\uff1b Refining ufboot trees with NNI 1 branch... ERROR: \\Users\\minh\\Dropbox\\iqtree2\\tree\\phylotree.cpp:5664: void PhyloTree::convertToRooted(): Assertion `leafNum == aln->getNSeq()' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: example\\12.log ERROR: *** Alignment files (if possible) But when I run the same command with -m GTR in same data. I succeed to get the .ufboot file. Using version 1.6.12_windows10 and version 2.1.3_windows. Thanks, Nancy "]}, "y8uuVUZIJYY": {"topic": "Phylogenetic dating now in v2.0.3", "initializeDate": "Apr 23, 2020, 11:01:28 PM", "timeStamp": "Apr 23, 2020, 11:01:28 PM", "content": ["Dear Users, In light of the new coronavirus pandemic we have now implemented the phylogenetic dating to build time tree in the latest version 2.0.3, which can be downloaded from www.iqtree.org . A documentation how to use this feature is available here: http://www.iqtree.org/doc/Dating We integrated the least square dating (LSD) code for this feature, so please cite this paper: Thu-Hien To, Matthieu Jung, Samantha Lycett, Olivier Gascuel (2016) Fast dating using least-squares criteria and algorithms. Syst. Biol. 65:82-97. https://doi.org/10.1093/sysbio/syv068 Special thanks to Thu Hien To who has been very responsive to make this integration possible. Cheers, Minh "]}, "97fR7IimR8M": {"topic": "Interleaved nexus file", "initializeDate": "Apr 18, 2018, 3:29:26 PM", "timeStamp": "Apr 19, 2018, 5:55:26 PM", "content": ["Hello all, I was just wondering whether IQTree supports interleaved NEXUS files. I couldn't find any mention in the documentation. When I attempt to load a NEXUS file with the following heading: #NEXUS Begin data; Dimensions ntax=47 nchar=1641; Format datatype=dna missing=? gap=- interleave=yes; Matrix lots of sequence data IQTree returns the following error message: ERROR: ERROR: Error found at line 4, column 48 (file position 97): ERROR: Expecting ';' but found = at the end of FORMAT command Thanks in advance for your help! ", "Hi Dan, Please change the format command to: Format datatype=dna missing=? gap=- interleave; That means, delete \u201c=yes\u201d. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "VEq_fpPVc9Q": {"topic": "IQ-TREE release 1.3.11", "initializeDate": "Dec 11, 2015, 4:25:10 AM", "timeStamp": "Dec 11, 2015, 4:25:10 AM", "content": ["Dear all, IQ-TREE version 1.3.11 is just released with following changes ( http://www.cibiv.at/software/iqtree/release/ New features: * For long alignments (>100,000 sites) the minimal branch length is now reduced to 0.1/alignment_length to accommodate analysis of very closely related sequences (thanks to David Wyllie for testing). * New `-blmin` and `-blmax` option for min and max branch length (requested by Hang Phan). * New `-wslm` and `-wslmr` options to print site log-likelihood per mixture class and per mixture+rate category, respectively (requested by Huaichun Wang). * New `--link-alpha` option to link Gamma shape parameter (alpha) across partitions (requested by Huaichun Wang). Bug fixes: * Numerical problems with `+ASC` model for protein data: disabled now by default (reported by several web server users and Lars Jermiin). * Fix a rare crash for option combination `-z` and `-sp` when changing to old kernel. * Fix a crash with multicore version with own parsimony kernel (reported by Joan). * Fix a minor issue when outputting mixture model name in model testing (reported by Sophie Abby). * Fix a numerical problem with model testing (reported by Jana). * For `-t RANDOM` initial model parameters will now be estimated on a parsimony tree (thanks to Jesse Breinholt for the report and suggestion). Other changes: * Windows AVX version (reported by Aaron Dickey) crashed due to a stack unalignment issue of TDM-GCC compiler (thanks to Agner Fog for suggestion). As a solution, all Windows binaries are now built with Clang. * Updated the latest vectorclass library of Agner Fog. * Print error instead of abort when applying branch tests for multifurcating trees. * Implement EM algorithm for mixture+FreeRate model. * Accept `~` as an unknown character in the alignment. * Code optimization resulting in 5%-10% reduction in running time. Best, IQ-TREE development team "]}, "sMHTLhZ4hdA": {"topic": "Bootstrap: output bootstrap support before iteration is complete", "initializeDate": "May 4, 2020, 8:10:21 AM", "timeStamp": "May 5, 2020, 9:31:12 PM", "content": ["To whom it may concern, I have 2 incredibly large trees that have been running for a long time now. The server in which they are running will be soon re-booted and these 2 processes will be then killed. I am running these trees with ultrafast bootstrapping with 1000 replicates. Is there a way to force IQTree to output the bootstrap support values it has, before it completes all iterations? Probably not. But thought I would ask anyway! Thanks in advance, Best wishes, Maria Mantas ", "Hi Maria, IQ-TREE has checkpointing: the checkpoint files .ckp.gz or .model.gz store all information needed to restore an interrupted run. So if the server is restarted, simply run IQ-TREE again with the same command line \u2014 nothing will be lost. Or more precisely, you only lose 1 min of computation, as IQ-TREE only writes this file periodically (1 min by default). Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAFa6f8O7H%2B7Ws1KW6%2B3EqBfdbAzt1%3Dtiyhw%2B-4fHa5SnRJzJFQ%40mail.gmail.com "]}, "xc_X3pFsG5A": {"topic": "\"wrong sequence length\" error", "initializeDate": "Apr 21, 2021, 8:30:29 AM\u00a0(7 days ago)\u00a0", "timeStamp": "Apr 21, 2021, 8:49:20 PM\u00a0(6 days ago)\u00a0", "content": ["Hi there, I am trying to run a combined analysis of data from multiple files (morphology, Sanger and UCE data). My nexus file specifying partitions is; #nexus begin sets; charset part1 = morph.phy: 1-110; charset part2 = mol.phy: 1-6784; charset part3 = uce.phy: 1-325325; charpartition mine = MK:part1, GTR+G:part2, GTR+G:part3; end; Seems pretty straightforward, but when I try to run it, IQTree crashes with the error message: ERROR: Line 3: Sequence BS_UCE_Ich710_Dagathia_philippina has wrong sequence length 110 This is strange because 110 is the correct length for 110, as specified both in the nexus file and in the corresponding Phylip files. I have checked spelling of taxon names, the number of characters in the phylip files, everything I could imagine, but the error persists. Do you have any idea of what may be causing this? Thanks in advance! ", "Hi Bernardo, This error occurs when that sequence doesn\u2019t have the same length as the very first sequence in the alignment. So it might happen that your first sequence has a length different from 110. Can you check that? The error message should have been something like \u201cSequence XXX and the first sequence do not have the same length\u201d. Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f34f8a39-d595-4da4-9ad9-e3bade93f38cn%40googlegroups.com ", "PS: If you are using the entire alignments, you can ignore the position ranges. That means, it works with: charset part1 = morph.phy; charset part2 = mol.phy; charset part3 = uce.phy; To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/453449F5-FFA7-4EE7-88A6-56C20E9C983E%40univie.ac.at "]}, "OxkUX7D_oP0": {"topic": "Crashes with signal erroneous numeric", "initializeDate": "Jan 6, 2019, 9:49:33 PM", "timeStamp": "Jan 8, 2019, 6:28:24 AM", "content": ["Dear IQ-TREE developers team, I'm trying to run a partitioned dataset analysis with topological backbone constraints, but I'm receiving an error. Someone before me have encountered the same problem but I could not figure out how you solved it. So I am as well pasting here are the first 10 and last 20 lines of the .log file: ########FIRST 10 LINES IQ-TREE multicore version 1.5.2 for Linux 64-bit built Dec 3 2016 Copyright (c) 2011-2016 Nguyen Lam Tung, Olga Chernomor, Arndt von Haeseler and Bui Quang Minh. Host: cl4n008 (AVX512, FMA3, 377 GB RAM) Command: iqtree-omp -sp infileTE.nex -g das_kanga_vombat -nt 4 -bb 1000 Seed: 276396 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Thu Jan 3 15:09:44 2019 Kernel: AVX+FMA - 4 threads(72 CPU cores detected) Reading partition model file infileTE.nex ... Reading partition nt (model=GTR+I+G, aln=5nuclear_DIPROS.phy, seq=DNA, pos= 1-6060) ... Reading alignment file 5nuclear_DIPROS.phy ... Phylip format detected #######LAST 20 LINES ===> START BOOTSTRAP REPLICATE NUMBER 1 Creating bootstrap alignment (seed: 276396)... CHECKPOINT: Initial tree restored Ascertainment bias correction: 8 unobservable constant patterns NOTE: 974 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.100) Optimizing GTR+F+I+G4 parameters for partition Duch (89 free parameters) Optimizing GTR+F+I+G4 parameters for partition nt (223 free parameters) Optimizing GTR+F+I+G4 parameters for partition loops (213 free parameters) Optimizing GTR+F+I+G4 parameters for partition stems (213 free parameters) Optimizing GTR+F+I+G4 parameters for partition m1 (221 free parameters) Optimizing GTR+F+I+G4 parameters for partition m2 (221 free parameters) Optimizing GTR2+FO+I+G4 parameters for partition m3 (214 free parameters) Optimizing MK+FQ+ASC+G4 parameters for partition morpho (54 free parameters) -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Generating 99 parsimony trees... *** IQ-TREE CRASHES WITH SIGNAL ERRONEOUS NUMERIC *** For bug report please send to developers: *** Log file: infileTE.nex.log *** Alignment files (if possible) Would you be able to tell me how to fix my input files in order to make the software running properly? I shall specify that the constraints I am using are only forcing a few nodes of the trees and not all of them. Thank you in advance for your consideration. Cheers, Manu ", "Dear Manu, Can you please use the latest version 1.6.9 and let me know if it works or not? If not, please send me the input files via personal email. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "EokGXmxYB1M": {"topic": "difference between -bb and -bb -bspec", "initializeDate": "Nov 16, 2015, 11:53:23 AM", "timeStamp": "Nov 18, 2015, 5:57:54 PM", "content": ["Hi, It is not clear to me the difference between the bootstrap commands -bb vs -bb -bspec. For my understanding, if one implements -bb then the positions are resampled randomly without taking into account partitioning. On the other hand, the use of both command, -bb -bspec, makes the resampling randomly in each partition and using a frequency that is proportional to partition length. Is this OK? If I am right, the second option is the most appropriated for a partitioned analysis. Thanks in advance, Joan ", "Dear Joan, This is a very good question. I will try to address it generally, and then connect with IQ-TREE implementation. To my knowledge there are 4 different ways to bootstrap resample a partitioned alignment: (i) Resample sites ignoring partition information (i.e. treating alignment like a single gene). This is the traditional way (Felsenstein 1985), but IQ-TREE does NOT implement this strategy if doing a partition analysis (i.e. a partition file is provided). (ii) Resample sites within partitions. Technically that means, for each partition one resamples its sites, resulting in a \"resampled partition\u201d. Then the resampled partitions are concatenated together in a resampled super-alignment (which has the same length as original alignment) for a bootstrap analysis. This is the DEFAULT strategy in IQ-TREE. (iii) Resample partitions instead of sites. That means, if a partition is resampled 3 times, then all its sites appear 3 times in the resampled super-alignment. As a result, the bootstrap alignment length may change. This strategy can be invoked by option \u201c-bspec GENE\u201d. (iv) Combing (iii) and (ii): one first resamples partitions like (iii), and then resamples sites within each resampled partition. This strategy can be invoked by option -bspec \u201cGENESITE\u201d. The last two strategies were at least discussed in Gadagkar et al. (2005) ( http://www.ncbi.nlm.nih.gov/pubmed/15593277 ). That\u2019s why I implemented them. I don\u2019t know how much it would impact, but I suspect it makes the bootstrap more conservative (reducing false positive rate). I am not entirely sure, did you mean that strategy (ii) is appropriate? Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, very interesting options, especially option iii and the combi of ii and iii (iv) - if tthey really would reduce the false positive rate. How are then the models estimated for the resampled partitions (or is just taken what is in the partition file? Cheers Karen ", "Hi Minh, Thanks a lot for you fast and thorough reply. For me makes more sense the default option ii than the others. The options iii and iv, if I understood correcly Gadagkar et al. 2005, are more related to test phylogenetic signal (congruence) of each gene / partition rather than confidence support, though both issues are related. Since all my partitions are from mitochondrial origin, I think approach ii is more accurate than the remaining ones. Cheers, Joan ", "Dear Joan, yes Gadagkar et al. (2005) discussed congruence, but also bias in bootstrap support (100% BS for a wrong clade). Thus, they suggested that one reports both BS% and the percentage of gene trees that support a certain branch, to be more confident in the results. @Karen: to what extent resampling strategies iii and iv influence the results: frankly I don\u2019t know. You can simply try it out. I implemented this, but did not systematically investigate. Cheers, Minh "]}, "0iakNaXZ830": {"topic": "cflib FastaVCFToCounts.py issue", "initializeDate": "Feb 27, 2018, 3:34:19 PM", "timeStamp": "Mar 7, 2018, 6:02:49 AM", "content": ["Hi all, I'm new to IQ-TREE, and I'm trying to use the cflib FastaVCFToCounts.py script to convert my VCF file to the counts input file. I keep on getting an error, as listed below. Can anyone help? [My genome is in fasta format and gzipped, my VCF file is bgzipped and tabix indexed, and my output file is specified]. Thanks in advance, Alex -bash-4.1$ /usr/bin/FastaVCFToCounts.py -v STC5TWY2.k57-8.fasta.gz Euphrasia_UK_STC_maxmiss25_duffremoved_renamed260218.vcf.gz EuphrasiaSTC260218.counts.gz Traceback (most recent call last): File \"/usr/bin/FastaVCFToCounts.py\", line 5, in <module> pkg_resources.run_script('cflib==1.0', 'FastaVCFToCounts.py') File \"/usr/lib/python3.4/site-packages/pkg_resources/__init__.py\", line 750, in run_script self.require(requires)[0].run_script(script_name, ns) File \"/usr/lib/python3.4/site-packages/pkg_resources/__init__.py\", line 1534, in run_script exec(script_code, namespace, namespace) File \"/usr/lib/python3.4/site-packages/cflib-1.0-py3.4.egg/EGG-INFO/scripts/FastaVCFToCounts.py\", line 84, in <module> TypeError: __init__() got an unexpected keyword argument 'verb' ", "Hi Alex, thanks for your interest in PoMo and for your report. This was a bug in the script when executed with verbosity. Sorry for the inconvenience. I have pushed a fix to the `cflib` GitHub repository. Please let me know, if you have any further issues. Dominik ", "Hi Dominik, Thanks for your swift response--that's great. Just to check, I get the same error when I run it without the -v flag, as reported below. Is this a separate issue, or should I try the new version you've posted? Is that correct to specify the whole bgzipped file name, or should you only specify the stem (as presumably it needs to used the tabix file, too?). Many thanks, Alex -bash-4.1$ /usr/bin/FastaVCFToCounts.py STC5TWY2.k57-8.fasta.gz Euphrasia_UK.vcf.gz Euphrasia_UK_STC_260218.cnt.gz ", "Hi Alex, yes, it should work! The sequence names in the fasta file should be the chromosome names in the VCF file(s). I was wondering how you assign individuals to species. If you just provide one VCF file, the conversion script assumes that each individual in the VCF file is from a different species. So your counts will always be one (because each species just consists of one individual). PoMo is not very stable when run on this type of data (because it has no idea about the level of polymorphism). I usually use one VCF per species and merge all individuals within each of the VCF files into species (--merge option of the conversion script). You can achieve this by separating your VCF file into various files using vcftools. For this, please see the section INDIVIDUAL FILTERING OPTIONS in the vcftools manual https://vcftools.github.io/man_latest.html If you want, you can send me the first 100 lines or so of your VCF, so that I can have a look. Cheers, Dominik ", "Hi Dominik, Thanks for your suggestions and help. I was erroneously thinking the FastaVCFToCounts.py script was doing the same thing as FastToCounts.py but with different input files, hence my confusion. I didn't realise the two scripts were so different in the way they sort individuals into populations. I wonder whether it would be worth updating the readme file for the FastaVCFToCounts.py to say how it merges populations, in case someone else comes up against the issue I had? In the end I converted my VCF that contained all taxa to a Fasta file with PGDSpider, then used this in FastaToCounts.py. It seems to be working OK in IQ-TREE! I went this route rather than using FastaVCFToCounts.py as I have RAD sequence data, and was concerned the script might fill in bases between restriction enzyme cut sites present in the reference genome but not sampled in the RAD data. (Would that have been the case?) Thanks, Alex ", "Hi Alex, thanks. I have updated the help of the script and mention your path using PGDSpider! Best, Dominik "]}, "9Bsqyhi59RQ": {"topic": "Error while choosing right partitioning scheme", "initializeDate": "Jun 5, 2020, 6:00:00 AM", "timeStamp": "Jun 5, 2020, 6:00:00 AM", "content": ["ERROR: partitionmodelplen.cpp:146: virtual double PartitionModelPlen::optimizeParameters(int, bool, double, double): Assertion `cur_lh > tree_lh - 1.0 && \"individual model opt reduces LnL\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 5 () ERROR: 6 PartitionModelPlen::optimizeParameters(int, bool, double, double) ERROR: 7 IQTree::optimizeModelParameters[abi:cxx11](bool, double) ERROR: 8 computeFastMLTree(Params&, Alignment*, ModelCheckpoint&, ModelsBlock*, int&, int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) ERROR: 9 runModelFinder(Params&, IQTree&, ModelCheckpoint&) ERROR: 10 startTreeReconstruction(Params&, IQTree*&, ModelCheckpoint&) ERROR: 11 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 12 main() ERROR: 13 __libc_start_main() ERROR: 14 () ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: FcC_supermatrix_partition.txt.log ERROR: *** Alignment files (if possible) /var/spool/slurmd/job2640313/slurm_script: line 12: 38684 Aborted (core dumped) iqtree -s concatenated_4.phy -p FcC_supermatrix_partition.txt -m TESTMERGEONLY -nt 1 -safe "]}, "xQ7pI5UAESY": {"topic": "About deletion of additional identical sequences", "initializeDate": "Aug 7, 2017, 1:34:12 AM", "timeStamp": "Aug 8, 2017, 1:29:39 PM", "content": ["Hi, while I do a phylogenetic analysis, I see that the identical sequences are dealt with by IQTREE in two different ways: NOTE: 2757599_XYZVBN is identical to 2757603_XYZZZZ but kept for subsequent analysis NOTE: 2757600_ABCDEFG (identical to 2757603_ABCDEF) is ignored but added at the end does this consideration of identical sequences differ - can we consider that both (kept ones and ignored ones) a from a same haplotype (with its pair) 'if' we are dealing with mitochondrial sequences? or is there some fine details going on. Any information regarding this would be much appreciated. thanks, philipS ", "Dear Siby Philip, Thank you for your interest in IQ-Tree. while I do a phylogenetic analysis, I see that the identical sequences are dealt with by IQTREE in two different ways: NOTE: 2757599_XYZVBN is identical to 2757603_XYZZZZ but kept for subsequent analysis NOTE: 2757600_ABCDEFG (identical to 2757603_ABCDEF) is ignored but added at the end does this consideration of identical sequences differ - can we consider that both (kept ones and ignored ones) a from a same haplotype (with its pair) 'if' we are dealing with mitochondrial sequences? or is there some fine details going on. I am not entirely sure what you mean by your question. And I do not know exactly what command you ran when you got these messages. In general, if sequences in the alignment are identical (which means entirely the same), they will end up together in the same subtree, separated by zero-branch lengths. On the other hand theses additional sequences cost time, because the search space grows exponentially. Thus, it saves time without changing the result, that |IQ-TREE discards sets of identical sequences (keeping one representative) for the tree search. However, there are some analyses where a certain number of sequences are required and, thus, certain sequences might be kept despite the fact that there might be another identical sequence still in there dataset. For instance, if you perform a likelihood mapping with two clusters - it is required that both clusters contain at least two sequences. Thus, it is not possible to discard all identical sequences if this reduces one cluster to only a single sequence. Similar cases may exist for partitioned analysis if discarding identical sequences leaves a partition, e.g., with only a single sequence in that partition. I assume that this lead to the two different comments in your output, of course without having any further information about your analysis. I hope my answer is still useful to you. Best wishes, Heiko Schmidt ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) Campus Vienna Biocenter 5 (VBC5) A-1030 Vienna, Austria ----------------------------------------------------------------------------- ", "Thank you very much Dear Heiko, This was excatly the information that I was looking for. 1) I had a dataset with many identical sequences (mitochondrial COIs) 2) I was doing a partitioned analysis -m TESTNEWMERGE and -alrt 1000 3) I got a different topology with MrBayes (after modeltest in iqtree) which is why I thought these identical sequences were causing problem and wanted to delete them, that is how I got to the iqtree log which neatly showed them. It is then that I saw the difference which I cited in the mail. thanks for the answer, I will delete all the identical sequences and see what happens next, also I think the use of partitioned model may not be possible any more - nevertheless I will try both ways thanks, philipS You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Siby Philip, Ph.D., Assistant Professor - Zoology, Nirmalagiri College, Kannur, Kerala, India, 670701 http://scholar.google.co.in/citations?user=YKQvOc4AAAAJ&hl=en "]}, "992TzTYSwD8": {"topic": "Can I do soft-dating using IQTree 2.0.6 version", "initializeDate": "Jun 27, 2020, 12:06:28 PM", "timeStamp": "Jul 27, 2020, 4:55:30 PM", "content": ["Hello Experts, I have gone through the IQTree recent tutorial and the fossil dating approach suggested there is kind of hard-dating if I'm not wrong. taxon1 ,taxon2 -50 taxon3 ,taxon4 ,taxon5 -100 taxon6 -10 There are more options we acces using lsd2, however, I could not understand is there any way to use soft-dating in IQTree. Kindly suggest. Regards, Debajyoti ", "Hi Debajyoti, Hi think you can specify a range of date for example: -50:-40 for the range between -50 and -40. Is it the way to define a range in iq-tree, Minh? Hien ", "Hello Hien, I have the same problem as Debajyoti and tried using your suggestion. However, definging the range as you proposed - max:min - resulted in max being used as a hard-dating point. So I would like to second the original question. All the Best Anne ", "Hi Anne, Can you give more details? Specifically, can you post your command line, the output files, and what it is that led you to the conclusion that your range was being used as a point estimate rather than a range? It's hard to help out without these details. Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0eb361a1-bbf1-420c-b684-71b1b1d12f9fo%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Hey Rob, thank you for your quick reply. Here is my command line: ~/bin/iqtree-2.0.6*/bin/iqtree2 -s d6isc95bsc90min32.phy -nt 8 -pre min32_iq \\ --date-tip 0 --date taxonList.txt \\ -m GTR+G+I --date-ci 100 \\ -te ExaML_result.d6isc95bsc90min32_examl -v --safe I have also run the same line again with the --date-options \"-d lsd2date.txt\" activated. I will send you the files in a private message, as they contain unpublished data. Cheers Claudia To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0eb361a1-bbf1-420c-b684-71b1b1d12f9fo%40googlegroups.com ", "Dear Experts, I have tried sending the relevant files to Rob privately, as they do contain unpublished data. However, he has asked me, to post here in this group. To avoid publishing sample-information here, I have redacted the files. I have changed the sample ids, and only those, everything else remained the same. If anyone requires the unredacted files, please let me know and I will send them privately. As to why I think that only the upper constraint was used as a hard constraint for my calibration point, here is my reason. If I look at the ci-values in the tree, for all nodes I can see a true range, i.e. two different values, except for the calibrated node, whose interval is [max:max], and identical to the maximum age range value in the taxonList.txt file containing the calibration - given as max:min. Thank you all for your help and any advice Cheers ", "Hi Anne, Hien may have a closer look\u2026 perhaps LSD2 requires more than 1 calibration node to work? As I saw that you have only one calibration point (except for the tips). Another comment here is when you supply a data file for IQ-TREE (--date), why do you additionally specify another date file for LSD2 (via --date-options), which will override the former one. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/25cbcdf2-863e-4643-9d24-59f91f178499o%40googlegroups.com <min32_iq.timetree.nex> <taxonList.txt.txt> <lsd2date.txt.txt> <min32_ig.log.log> ", "Hi Anne, I will look if there's any bug related to this and report back. However, this dating method just uses the tree (inferred by iq-tree) and dates as input (not use the initial alignments) to optimise, so sometimes if the date signals are not enough there can be multiple solutions like in this case. In principle if you have only 1 calibration point (together with tips date) then this one must have a fix value in order to have a unique solution. It is because given any date for that node, there's always a corresponding rate that gives you an equal value for the objective function. If a range is given, the tool just gives you one of its boundary as a solution. Actually I forgot to throw a warning message in this case. I will add this, thanks for raising the issue. Hien On Saturday, July 4, 2020 at 1:17:19 AM UTC+2, Minh Bui wrote: Hi Anne, Hien may have a closer look\u2026 perhaps LSD2 requires more than 1 calibration node to work? As I saw that you have only one calibration point (except for the tips). Another comment here is when you supply a data file for IQ-TREE (--date), why do you additionally specify another date file for LSD2 (via --date-options), which will override the former one. Cheers Minh On 4 Jul 2020, at 12:13 am, 'Anne Elliot' via IQ-TREE < iqt...@googlegroups.com > wrote: Dear Experts, I have tried sending the relevant files to Rob privately, as they do contain unpublished data. However, he has asked me, to post here in this group. To avoid publishing sample-information here, I have redacted the files. I have changed the sample ids, and only those, everything else remained the same. If anyone requires the unredacted files, please let me know and I will send them privately. As to why I think that only the upper constraint was used as a hard constraint for my calibration point, here is my reason. If I look at the ci-values in the tree, for all nodes I can see a true range, i.e. two different values, except for the calibrated node, whose interval is [max:max], and identical to the maximum age range value in the taxonList.txt file containing the calibration - given as max:min. Thank you all for your help and any advice Cheers You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Hien, This sounds like an identifiability issue. How about the following: in that case, you perform 2 separate dating analyses, one with the lower bound and the other with the upper bound as fixed date value. And then you \u201cmerge\u201d the results from these 2 analyses by taking the union of the two esimated date ranges for every node. Say for a node, the estimated date ranges are lower_1:upper_1 and lower_2:upper_2. Then you report min(lower1,lower2):max(upper_1:upper_2) as the result. What do you think? Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1cfb9bfb-f61a-4f4e-aaf1-f723da3f54b3o%40googlegroups.com ", "Hi Hien and Minh, thank you for your analysis of the process. I have implemented your suggestion to run the analysis twice and merging the results and am pretty pleased with the results. However, I aggree that a warning that soft dating requires more than one calibration points, would be much appreciated. Cheers from Germany ", "Cool, glad to hear that it works. @Hien: is there a chance to implement this in LSD2? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/793991a1-0403-42c7-a6c1-96efb3d3cf46o%40googlegroups.com ", "Hi, yes will do that in the next version (sorry for the late respond, just came back from vacation) Hien On Monday, July 13, 2020 at 2:17:43 AM UTC+2, Minh Bui wrote: Cool, glad to hear that it works. @Hien: is there a chance to implement this in LSD2? Minh On 10 Jul 2020, at 8:04 pm, 'Anne Elliot' via IQ-TREE < iqt...@googlegroups.com > wrote: Hi Hien and Minh, thank you for your analysis of the process. I have implemented your suggestion to run the analysis twice and merging the results and am pretty pleased with the results. However, I aggree that a warning that soft dating requires more than one calibration points, would be much appreciated. Cheers from Germany You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "aTq2wlHFOjI": {"topic": "Problem with building a consensus tree from VertLife .nex file", "initializeDate": "Nov 20, 2020, 10:26:46 AM", "timeStamp": "Dec 2, 2020, 7:45:31 AM", "content": ["Hello! I have a 10000 BS trees in a .nex file that I downloaded from VertLife ( http://vertlife.org/phylosubsets/ ) when I run ' iqtree -t hom.nex -con homCon' it reads all 10000 trees but does not like my .nex file. I get the same error if I use '-net' instead of '-con'. Has anyone else have this issue? -David IQ-TREE multicore version 1.6.12 for Linux 64-bit built Aug 15 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: c1123.ll.unc.edu (AVX2, FMA3, 251 GB RAM) Command: iqtree -t hom.nex -con homCon Seed: 380389 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Fri Nov 20 10:24:42 2020 Kernel: AVX+FMA - 1 threads (48 CPU cores detected) HINT: Use -nt option to specify number of threads because your CPU has 48 cores! HINT: -nt AUTO will automatically determine the best number of threads to use. Reading input file hom.nex... 10000 tree(s) loaded ERROR: Expecting ')', but found 'T' instead (line 1 column 5) ", "Hi David, My apology for the delay in replying. Just too much commitment at the moment. It seems like some problem with your nexus file. Does it work if you input a newick tree file, instead of nexus file? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/54daf2b8-4751-4c41-b88a-061ce90d4ea4n%40googlegroups.com "]}, "vLvtU3EC-bQ": {"topic": "Error while model testing before generating the tree for a multiple sequence alignment of a gene", "initializeDate": "Jul 16, 2018, 9:17:53 AM", "timeStamp": "Jul 19, 2018, 1:55:00 PM", "content": ["Hi, I am trying to run iqtree (version 1.6.5) on a file with a multiple sequence alignment (528 sequences with 190 columns) of a gene in a phylip format (msa was carried out using MUSCLE and trimming was done using BMGE). The command is as follows: iqtree-1.6.5-Linux/bin/iqtree -s seqs.trimmed.phy -m MFP -mtree -alrt 1000 -bb 1000 -bnni -nt AUTO I am getting the following error (last line in bold below is the error), during one of the model testing steps: -------------------------------------------------------------------- | FINALIZING TREE SEARCH | -------------------------------------------------------------------- Performs final model parameters optimization Estimate model parameters (epsilon = 0.010) 1. Initial log-likelihood: -25740.398 Optimal log-likelihood: -25740.387 Rate parameters: A-C: 1.00000 A-G: 3.86848 A-T: 2.44474 C-G: 2.44474 C-T: 3.65150 G-T: 1.00000 Base frequencies: A: 0.197 C: 0.254 G: 0.302 T: 0.247 Site proportion and rates: (0.579,0.325) (0.421,1.929) Parameters optimization took 1 rounds (0.090 sec) BEST SCORE FOUND : -25740.387 Testing tree branches by SH-like aLRT with 1000 replicates... 0.697 sec. Total tree length: 50.369 Total number of iterations: 102 CPU time used for tree search: 48.844 sec (0h:0m:48s) Wall-clock time used for tree search: 48.851 sec (0h:0m:48s) Total CPU time used: 50.836 sec (0h:0m:50s) Total wall-clock time used: 50.844 sec (0h:0m:50s) 3 finished checkpoint entries erased 291 TIM+F+R2 25740.387 745 52970.774 1164510.774 55393.718 ERROR: Too long name ( > 1000) (line 1 column 161823) There were 207/484 models that were tested for the same file. It was only after TIM+F+R2 (208th model) that the error showed up. Therefore, the files - .contree, .iqtree and .ufboot are not produced. I am trying to figure out the possible reason for the error. ", "Hi Mohak, Thanks for reporting this. Can you send me the log file and the alignment via personal email? I\u2019ll have a look. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "MBymHWwX5Qc": {"topic": "question about phylogenetic dating, dates format", "initializeDate": "Jul 29, 2020, 5:17:35 AM", "timeStamp": "Aug 14, 2020, 9:29:10 AM", "content": ["Hi, I would like to perform phylogenetic dating on my data set. Before I'll start, I am wondering if the dates in the \"dates_datafile\" (list of \"sequence_id\" + \"collection_date\") as to be in a specific format. I have a data file with the dates written in this way : \"month\"/\"day\"/\"year\". Is it ok to use this data file for phylogenetic dating with iqtree ? Best regards Gabriel ", "Hi Gabriel, The date must be in YYYY-MM-DD, as written in the doc: http://www.iqtree.org/doc/Dating Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e108c0fc-ed66-40c9-af9c-4f2349c8fe88o%40googlegroups.com ", "Great, thanks! ", "Hi, I have another question. In my \"data file\" (sequence id with dates), I have one strain that does not contain any date information. When I tried to run my analysis using both \"NA\" or nothing for the missing-date, the program stops with an error message at each case. How I have to deal with this missing data? Best regards, Gabriel ", "Hi Gabriel, For missing date sequence, just do not put that sequence in the date file. The date of that strain will be estimated at the end. Cheers, Hien To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ef99da91-faa4-4964-bded-ba5b4cef0bf8n%40googlegroups.com ", "Hi Hien, Thank you very much for your help. Cheers, Gabriel "]}, "6r3eDjAeu_I": {"topic": "IQ-TREE CRASHES WITH SIGNAL ILLEGAL INSTRUCTION", "initializeDate": "Nov 15, 2016, 4:45:10 PM", "timeStamp": "Mar 14, 2017, 3:25:06 PM", "content": ["I downloaded IQ-Tree omp on my laptop and had no issues running it with real data. This morning I downloaded it to my desktop and have had no luck convincing it to run. I have tried it with both the sequential and multicore versions with the real data and the example file with the same results. I include an example of the output below: IQ-TREE version 1.5.1 for Mac OS X 64-bit built Nov 8 2016 Copyright (c) 2011-2016 Nguyen Lam Tung, Olga Chernomor, Arndt von Haeseler and Bui Quang Minh. Host: d47h1.public.uconn.edu (SSE4.1, 16 GB RAM) Command: bin/iqtree -s example.phy -redo Seed: 388892 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Tue Nov 15 16:28:42 2016 Kernel: SSE3 NOTE: Consider using the multicore version because your CPU has 2 cores! Reading alignment file example.phy ... Phylip format detected Alignment most likely contains DNA/RNA sequences Alignment has 17 sequences with 1998 columns and 1152 patterns (1009 informative sites) Gap/Ambiguity Composition p-value 1 LngfishAu 0.15% passed 6.20% 2 LngfishSA 0.00% failed 0.62% 3 LngfishAf 0.05% failed 1.60% 4 Frog 0.05% passed 58.01% 5 Turtle 0.15% passed 44.25% 6 Sphenodon 0.10% passed 59.78% 7 Lizard 0.90% passed 38.67% 8 Crocodile 0.35% failed 2.51% 9 Bird 0.00% failed 0.00% 10 Human 0.00% failed 0.85% 11 Seal 0.00% passed 68.93% 12 Cow 0.00% passed 59.11% 13 Whale 0.00% passed 97.83% 14 Mouse 0.05% failed 1.43% 15 Rat 0.00% passed 39.69% 16 Platypus 0.00% failed 3.46% 17 Opossum 0.00% failed 0.01% **** TOTAL 0.11% 8 sequences failed composition chi2 test (p-value<5%; df=3) Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.003 seconds WARNING: Default model HKY may be under-fitting. Use option '-m TEST' to determine the best-fit model. NOTE: 0 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.100) STACK TRACE FOR DEBUGGING: 1 splitnumtaxacmp(Split const*, Split const*) 2 _sigtramp() 3 __dtoa() 4 double PhyloTree::computeLikelihoodFromBufferGenericSIMD<Vec2d, false, false, false>() 5 double PhyloTree::computeLikelihoodBranchSIMD<Vec2d, false, 4, false, false>(PhyloNeighbor*, PhyloNode*) 6 splitnumtaxacmp(Split const*, Split const*) 7 comparePLLNNIMove(pllNNIMove const&, pllNNIMove const&) 9 splitnumtaxacmp(Split const*, Split const*) 10 splitnumtaxacmp(Split const*, Split const*) 11 splitnumtaxacmp(Split const*, Split const*) *** IQ-TREE CRASHES WITH SIGNAL ILLEGAL INSTRUCTION *** For bug report please send to developers: *** Log file: example.phy.log *** Alignment files (if possible) Illegal instruction: 4 ", "Hi there, thanks for sending the details\u2026 it looks like there is some incompatibility problem with the old Mac OS X\u2026 What OS X version do you have in the desktop? Can you test if older version of IQTREE ( https://github.com/Cibiv/IQ-TREE/releases/tag/v1.5.0a ) works on your desktop? Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thank you for the quick response. Both the laptop and desktop are running El Capitan 10.11.6. Interestingly, 1.5.0a seems to run the example.phy file fine on the desktop and is currently running some real data without apparent problem. ", "Thanks for letting me know\u2026 there have been some changes in version 1.5.1 to speed up the computation on very large data sets, which might not be compatible with the older machines (which I could see from your log file). Unfortunately I don\u2019t have older Mac here to check what exactly is the cause. So I suggest that you continue to use version 1.5.0a on your desktop. Thanks, Minh ", "Thank you for your help. I have been running 1.5.0a quite a bit the past week and it seems to be giving entirely reasonable results. It is a bit of a bummer that I cannot make use of the speed upgrades and -nt ALL, but nothing too troublesome. I can still churn through several hundred comparisons in usually under an hour. Unrelated question (perhaps that should be in its own topic), do I understand correctly that IQ-Tree does not do the quartet puzzling tree that the old TreePuzzle program could do? ", "Dear Matthew Fullmer(?), you are right that IQ-Tree is not able to do the quartet puzzling as it is done in TREE-PUZZLE. The reason of course is that quartet puzzling needs to examine all O(n^4) quartets (for n taxa/sequences) to build the tree, which is the reason why TREE-PUZZLE naturally takes very long for large datasets. IQ-Tree can be much faster because it explicitly does not apply the quartet puzzling strategy. However, there might be a way in case you need the more advanced substitution models, partition models etc. and want on the other hand to run quartet puzzling with TREE-PUZZLE. TREE-PUZZLE allows to read in either the quartet likelihoods of the 3 alternative topologies or the bits which determine which of the 3 alternative topologies are preferred and then run the quartet puzzling on the provided quartet data without having to compute that itself. Currently, IQ-Tree cannot output the required format, but Minh is thinking to add an option to output that data when doing a likelihood-mapping analysis with all possible quartets. In that analysis all quartets are evaluated in IQ-Tree anyway - it is just a matter of outputting them to file. Best wishes, Heiko ", "Hi there, Heiko gave very good answer, I will put this quartet puzzling stuff into the TODO list. Regarding the Mac OS X problem, you can also download the source code and follow the compilation guide for Mac ( http://www.iqtree.org/doc/Compilation-Guide/ ) using cmake and make. I believe that would resolve the problem. Minh ", "very cool - I would use it as well. If you plan in addition also to implement e.g. quintet puzzling you are the best!!! (i woul nee it to be honest) :) Best Karen ", "Hi All, What's the latest on this compatibility issue on older macs? 1.5.2 appears to have a fix for it, but I'm still getting the crash in 1.5.2 and 1.5.3 on macOS 10.10. From the 1.5.2 release notes: Incompatibility problem with older Mac by switching back to libstdc++ instead of libc++ (reported by Matthew Fullmer) Thanks, Richard ", "Dear Richard, thanks for the report. Apparently the compatibility fix was not related to this illegal instruction. Since I don\u2019t have an old Mac 2010 here to test, can you help me do this: Download the older version 1.5.0 and let me know whether it passes or not? Minh <example.phy.log> <about-mac.png> ", "Ah yes, sorry I forgot to mention that 1.5.0 works on the same computer. "]}, "5HrFBTxZxeM": {"topic": "Re: partition merging with 1.6.1 on aa level", "initializeDate": "Jan 29, 2018, 2:26:43 PM", "timeStamp": "Feb 13, 2018, 11:28:09 PM", "content": ["I changed a minimal something, now it runs again since 1 h - will keep you updated though... Best, Karen Am Montag, 29. Januar 2018 20:06:39 UTC+1 schrieb Karen Meusemann: Hi Minh, recently we analysed a quite large dataset (ca. 130 taxa, ca. 4000 input partitiones). it worked fine with the 1.5.5. unlinked edge version but nothing was merged. with now 1.6.1 it worked fine ca. 3 days. then it crahsed: Full partition model BIC score: 119997142.350 (LnL: -59774903.622 df:31720) Merging models to increase model fit (about 15362481 total partition schemes)... ERROR: superalignment.cpp:666: Alignment* SuperAlignment::concatenateAlignments(std::set<int>&): Assertion `part_seq == partitions[id]->getNSeq()' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: BestModel_merge_aa_1.6.1_edge_linked_parsstart.log ERROR: *** Alignment files (if possible) also the job error looks like that the RAM was not sufficient. I increased from 500 GB to 3 TB (trying to use the option -mem here ended with an error that this is not implemented for partitions yet) so the command was: iqtree-omp -s Alignment.fas -st AA -spp domains_partitions.nex -pre BestModel_merge_aa_1.6.1_edge_linked_parsstart -nt 48 -m MF+MERGE -msub nuclear -mrate E,I,G,I+G,R -cmin 2 -cmax 10 -madd LG4X -gmedian -safe but it crashed again (core dumped). Its large but not soooo large (1.3 Mio sites), similar datasets work with Partitionfinder. So can this be fixed somehow? (we should definitely do here merging partitions since domain datablocks are quite small. Alternatively we will switch back too Partitionfinder (and RAxML), but I would prefer to do Modelfinder... Any hints? Do you need dataset & logfile(s)? best, Karen ", "update: it crashed again, last lines: Full partition model BIC score: 119997142.350 (LnL: -59774903.622 df:31720) Merging models to increase model fit (about 15362481 total partition schemes)... *** Error in `iqtree-omp': free(): invalid next size (fast): 0x0000000043b91810 *** ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: BestModel_merge_dipt_aa_1.6.1_edge_linked_parsstart.log ERROR: *** Alignment files (if possible) /cm/local/apps/slurm/var/spool/job13157831/slurm_script: line 18: 120817 Segmentation fault (core dumped) iqtree-omp -s ... [...] Help is appreciated! ", "Hi Karen, Thanks for the report. Yes can you pls send me the data set and all output files? It seems that this problem is recurring for several users\u2026 Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "YES SURE. Thanks Minh for putting this onto hight priority :) ", "Dear Minh, after running the job again with the test Version 1.6.1a, it crashed again unfortunately (to me it seems that its the same error message than before). I have sent you the logfile and end of the error message in a separate email. Hope yhat the issue can be solved soon Best Karen "]}, "l8Pi_Xe-Q5A": {"topic": "Given that K>=n, the parameter estimates might be inaccurate.", "initializeDate": "Apr 7, 2021, 10:04:07 AM", "timeStamp": "Apr 11, 2021, 9:16:56 PM", "content": ["Hi, I am not particularly an expert at reconstructing phylogenetic trees but IQ-tree is great for smaller trees however whenever I try to build a larger tree of over 300 proteins from the same family (albeit from divergent species) I am faced with the following message: **************************** WARNING **************************** Number of parameters (K, model parameters and branch lengths): 556 Sample size (n, alignment length): 414 Given that K>=n, the parameter estimates might be inaccurate. Thus, phylogenetic estimates should be interpreted with caution. Ideally, it is desirable that n >> K. When selecting optimal models, 1. use AIC or BIC if n > 40K; 2. use AICc or BIC if 40K >= n > K; 3. be extremely cautious if n <= K To improve the situation (3), consider the following options: 1. Increase the sample size (n) 2. Decrease the number of parameters (K) to be estimated. If possible: a. Remove the least important sequences from the alignment b. Specify some of the parameter values for the substitution model (e.g., the nucleotide or amino acid frequencies) c. Specify some of the parameter values for the rates-across- sites model (e.g., the shape parameter for the discrete Gamma distribution, the proportion of invariable sites, or the rates of change for different rate categories under the FreeRate model) This only seems to happen with larger trees but I am not entirely sure what to do since I need all of the sequences in there. I could increase the sample size but I already encounter issues so I assume increasing sample size would be problematic. I do not know how to specify parameter values or the rates-across-sites. Is there any advice on what I can do? I cannot seem to find any way of rectifying this error. Thank you for your help, Matt ", "Hi Matt, This is a good question. What IQ-TREE printed here is a WARNING, not an error. The warning is about limited phylogenetic information, which might not be enough for phylogenetic reconstruction. If you cannot reduce the number of sequences or increase alignment length (e.g. by sequencing more genes), then I would say, leave it as is. However, for such datasets I\u2019d recommend to run IQ-TREE at least 50 times. Which such limited information, different runs will likely produce different trees with different log-likelihoods. I\u2019d then take the tree with highest log-likelihood (see also my email replied a few minutes ago in this forum). I believe the bootstrap support values will be rather low \u2014 and you will treat the tree with caution anyway. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/efd50d15-b3eb-4f00-b666-4ba35ac81004n%40googlegroups.com "]}, "5l0yesko13g": {"topic": "is it possible to compailing iqtree woth both KNL and MPI options (-DIQTREE_FLAGS=KNL -DIQTREE_FLAGS=mpi)", "initializeDate": "Sep 5, 2018, 7:17:41 AM", "timeStamp": "Sep 5, 2018, 9:41:18 PM", "content": ["I would like to build iqtree with both mpi and KNL option. is it possible to build for KNL cpu cluster with mpi? ", "Hi there, Yes you can! Run cmake with this command: cmake -DIQTREE_FLAGS=KNL+mpi <SOURCE_DIR> Make sure that an MPI library (e.g. OpenMPI) was installed. Let me know how it goes, as I never tested such combination before. Thanks, Minh On 5 Sep 2018, at 9:17 pm, Vigneshwaran Renganathan < vigneshwa...@gmail.com > wrote: I would like to build iqtree with both mpi and KNL option. is it possible to build for KNL cpu cluster with mpi? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "SVTLc079Hvo": {"topic": "ERROR: Nexus file format", "initializeDate": "Jul 24, 2020, 11:01:15 AM", "timeStamp": "Jul 28, 2020, 9:24:24 AM", "content": ["I am writing this email with regard to the error message that I am getting on the IQTREE web server while running the analysis. ERROR: Partition file is not in NEXUS format, assuming RAxML-style partition file... ERROR: Please specify alignment positions for partitionGTR+G:Subset2, GTR+G:Subset3, GTR+I:Subset4, GTR+G:Subset5, GTR+G:Subset6, GTR+G:Subset7;\\ ERROR: end;\\ ERROR: \\ ERROR: } Below is the alignment partitioning detail that I am using to run the analysis. #nexus begin sets; charset Subset1 = 1-519; charset Subset2 = 520-1190; charset Subset3 = 1191-1906\\3; charset Subset4 = 1192-1906\\3; charset Subset5 = 1193-1906\\3; charset Subset6 = 1907-2276\\3; charset Subset7 = 1908-2276\\3 1909-2276\\3; charpartition PartitionFinder = GTR+G:Subset1, K80+G:Subset2, F81:Subset3, GTR+I:Subset4, HKY+G:Subset5, HKY:Subset6, JC:Subset7; end; Kindly help me. ", "Hi there, Your partition file looks fine. However, IQ-TREE complained that your file is not in nexus format, which makes me wonder something wrong with it. So please attach the file here, instead of pasting. Then I can try to reproduce it. Also, paste the command line printed on the server. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6016fe08-7735-480a-a0ec-4f36bddb43f0o%40googlegroups.com ", "Hello Dr. Minh, Attached is the screenshot IQ-TREE error message and partition file in nexus format. Looking forward for your help Thanks in advance ", "I just looked at your partition file, it\u2019s not in plain text format, and this is the content of your file that I see: {\\rtf1\\ansi\\ansicpg1252\\cocoartf1671 {\\fonttbl\\f0\\fswiss\\fcharset0 Helvetica;} {\\colortbl;\\red255\\green255\\blue255;} {\\*\\expandedcolortbl;;} \\paperw11900\\paperh16840\\margl1440\\margr1440\\vieww10800\\viewh8400\\viewkind0 \\pard\\tx566\\tx1133\\tx1700\\tx2267\\tx2834\\tx3401\\tx3968\\tx4535\\tx5102\\tx5669\\tx6236\\tx6803\\pardirnatural\\partightenfactor0 \\f0\\fs24 \\cf0 #nexus\\ begin sets;\\ charset Subset1 = 1-519;\\ charset Subset2 = 520-1190;\\ charset Subset3 = 1191-1906\\\\3;\\ charset Subset4 = 1192-1906\\\\3;\\ charset Subset5 = 1193-1906\\\\3;\\ charset Subset6 = 1907-2276\\\\3;\\ charset Subset7 = 1908-2276\\\\3 1909-2276\\\\3;\\ charpartition PartitionFinder = GTR+G:Subset1, K80+G:Subset2, F81:Subset3, GTR+I:Subset4, HKY+G:Subset5, HKY:Subset6, JC:Subset7;\\ end;\\ Perhaps you edited and saved it in some text editor in some special format, that I don\u2019t know. That\u2019s the reason. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/45eb5282-f6fd-40fe-b84c-2b3ae8f22d83n%40googlegroups.com <IQ-TREE Error Screen.png> <iqtree_nexus_partition.nex> ", "Ohk. How do I deal with this. I copy-pasted the partition scheme received from PartitionFinder on to TextEditor on Mac. Kindly suggest. ", "For your reference, I am attaching the output file received from PartitionFinder, I copied the partition scheme mentioned in nexus format from here. ", "It sounds like you used the \u201cTextEdit\u201d program of Mac, which saves files in rich text format, by default. On the menu of TextEdit, click on \u201cFormat\u201d, then click \u201cMake Plain Text\u201d. That will do the job. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7c6b4551-7332-4e8e-a8c9-4e3bc6cfa5f7n%40googlegroups.com <best_scheme.txt> ", "It worked. Thanks a lot! Best regards "]}, "5pbzIOenf8E": {"topic": "re-running", "initializeDate": "May 30, 2019, 10:36:38 AM", "timeStamp": "May 31, 2019, 1:57:20 AM", "content": ["Hi, I've run iqtree with the following settings: iqtree -s input.fasta -nt AUTO -ntmax 32 -m MFP+MERGE -rclusterf 10 -spp partitions.txt I forgot to do ultrafastbootstraps. I'd like to either do ultrafastbootstraps separately without wasting time recalculating the ML tree, or, if I can't do that, re-run the tree finding with bootstraps but without repeating the modelfinder and partitionfinder process - i.e. using the model and partition scheme. I'm not sure how to do this. Thanks ", "Hi Bruce, This was answered: https://groups.google.com/forum/#!topic/iqtree/mA7-OIaHm9Y Fortunately, you can still omit ModelFinder process to save time. From your previous run, IQ-TREE printed the *.best_scheme.nex file, which stores the best partition model. You can supply this file to the -spp option, and IQ-TREE will load all models from this file. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAM8fHVD-pSQVm9_JOHtiW-oqc1WHvGf_8FFFBNObWCQorYZ5ag%40mail.gmail.com For more options, visit https://groups.google.com/d/optout "]}, "ivdKr93DnK8": {"topic": "Expected file not generated", "initializeDate": "Nov 29, 2018, 12:00:47 PM", "timeStamp": "Dec 3, 2018, 9:14:59 PM", "content": ["Hi, IQ-TREE multicore version 1.6.8 for Linux 64-bit Command used: iqtree -s file.fasta -m LG+G -b 100 Issue: Expected file [example.phy.splits.nex] is not generated when running the standard nonparametric bootstrap [-b] option. The expected file is generated when the [-bb] option is used. Question: Is there a way to generate the [file.splits.nex] and/or [file.splits] directly from the bootstrap trees file (i.e. .boottrees and .ufboot files)? Thanks, Caesar Al Jewari Uppsala University ", "Hi Caesar, On 30 Nov 2018, at 4:00 am, Caesar A Jewari < cje...@gmail.com > wrote: Hi, IQ-TREE multicore version 1.6.8 for Linux 64-bit Command used: iqtree -s file.fasta -m LG+G -b 100 Issue: Expected file [example.phy.splits.nex] is not generated when running the standard nonparametric bootstrap [-b] option. The expected file is generated when the [-bb] option is used. Right, but this is a feature. Question: Is there a way to generate the [file.splits.nex] and/or [file.splits] directly from the bootstrap trees file (i.e. .boottrees and .ufboot files)? You can use this option: -net Computing consensus network to .nex file For example iqtree -net TREES_FILE will generate TREES_FILE.nex file, which can be viewed in SplitsTree. Alternatively I believe you can use SplitsTree program for this purpose. Hope that helps, Minh Thanks, Caesar Al Jewari Uppsala University You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "One more information, this command: iqtree -net TREES_FILE will compute split weights as the sum over all trees. However, I think you want to count how often each split occurs among the trees (essentially what .splits.nex printed), then please add -swc option: iqtree -swc -net TREES_FILE Minh ", "Thank you Minh for the help, Just I am not sure if I understood the -swc option. It seems this is the branch lengths averages for the splits, if so, this would be a nice extra information! Caesar ", "Hi Caesar, As said -swc will prints a count for each split: how often it occurs among the trees. If you want to have the branch length averages, then use the following two options: -swa : average over all trees (no matter if the split is present in a tree or not). -swp: average over the trees where this split is present. -swp is perhaps more meaningful. Minh PS: These options are not documented as I implemented them for personal use some many years ago. "]}, "UXOh_VOIUPw": {"topic": "Problem: iqtree-mpi takes all cores at the beginning and randomly stop", "initializeDate": "Feb 6, 2019, 7:22:56 AM", "timeStamp": "Apr 11, 2019, 8:21:47 PM", "content": ["Dear IQTREE team, First of all, thank you for your great software. And thank for all the people for their feedbacks. Here I would like to report about some problems (bugs?) while using the mpi version of iqtree (problems were also present in 1.6.8 version). When I run mpi version with different commands, for example: mpirun -np 6 iqtree-mpi -nt AUTO -ntmax 4 -spp 01_partition.nex -pre 01 -o UA.1997.UR97010.EU345839 -alrt 1000 -quiet -redo & First, iqtree-mpi takes all available resources (cores): top - 09:23:39 up 21 days, 18:17, 1 user, load average: 65.37, 26.13, 23.33 Tasks: 358 total, 3 running, 355 sleeping, 0 stopped, 0 zombie %Cpu(s): 99.7 us, 0.2 sy, 0.0 ni, 0.1 id, 0.0 wa, 0.0 hi, 0.0 si, 0.0 st KiB Mem: 32964848 total, 30727044 used, 2237804 free, 314156 buffers KiB Swap: 4789244 total, 916 used, 4788328 free. 29001372 cached Mem PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND 19151 sviat 20 0 351860 30136 9456 R 730.7 0.1 8:23.09 iqtree-mpi 19150 sviat 20 0 351860 30124 9444 R 511.3 0.1 8:09.51 iqtree-mpi 19149 sviat 20 0 351868 30144 9452 S 500.7 0.1 8:14.66 iqtree-mpi 19154 sviat 20 0 351860 30220 9536 S 494.3 0.1 8:25.53 iqtree-mpi 19152 sviat 20 0 351860 30156 9468 S 487.4 0.1 8:14.35 iqtree-mpi 19153 sviat 20 0 351860 30252 9564 S 473.7 0.1 8:19.19 iqtree-mpi 1 root 20 0 29348 5376 3152 S 0.0 0.0 0:22.33 systemd It takes about 5 minutes, and then iqtree-mpi comes back to the regular estimations with reasonable computation sources: top - 09:27:52 up 21 days, 18:22, 1 user, load average: 18.54, 33.75, 28.45 Tasks: 358 total, running, 351 sleeping, stopped, zombie %Cpu(s): 35.5 us, 0.9 sy, 0.0 ni, 63.6 id, 0.0 wa, 0.0 hi, 0.0 si, 0.0 KiB Mem: 32964848 total, 31402656 used, 1562192 free, 314160 buffers KiB Swap: 4789244 total, 916 used, 4788328 free. 29013900 cached Mem PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND 19151 sviat 20 0 312124 137816 10412 R 200.0 0.4 22:57.33 iqtree-mpi 19152 sviat 20 0 312088 137760 10360 R 198.0 0.4 22:57.97 iqtree-mpi 19153 sviat 20 0 312088 138188 10640 R 198.0 0.4 22:53.16 iqtree-mpi 19154 sviat 20 0 312068 138240 10548 R 198.0 0.4 22:54.96 iqtree-mpi 19150 sviat 20 0 311828 137904 10196 R 196.0 0.4 22:59.36 iqtree-mpi 19149 sviat 20 0 334160 161820 11292 R 174.7 0.5 23:21.81 iqtree-mpi 948 message+ 20 0 43448 4332 3024 S 0.3 0.0 16:09.38 dbus-daemon It appears with a different number of -np, I tested from 2 to 10. With -nt 2, for example, I got %CPU usage 2x600% When I looked into the .log file in realtime, iqtree takes all cores after printing the following line: Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.672 seconds. As I mentioned above, after about 4-5 minutes, iqtree-mpi comes back to the regular estimations and continue printing log file. Another problem comes up randomly each 1 of 4-5 runs, when --runs option is present in the command. During estimation, sometimes iqtree-mpi just stop estimations by: 1. sending STOP message to workers: ---> START RUN NUMBER 3 (seed: 251874) Iteration 1800 / LogL: -69006.394 / Time: 1h:26m:57s (0h:1m:21s left) / Process: 0 Iteration 1810 / LogL: -69043.636 / Time: 1h:27m:28s (0h:0m:52s left) / Process: 2 Iteration 1820 / LogL: -69064.553 / Time: 1h:28m:1s (0h:0m:23s left) / Process: 3 Iteration 1830 / LogL: -69027.058 / Time: 1h:28m:32s (0h:0m:-6s left) / Process: 2 Sending STOP message to workers 2. or just simply without any indications in the .log file: ---> START RUN NUMBER 2 (seed: 896409) ... Log-likelihood of BIONJ tree: -70259.961 -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- 10 candidate trees gathered from workers After that, iqtree-mpi stop writing anything in the log file, but present in the processor activity. I have no idea why it\u2019s happened because it\u2019s happened randomly, even with the same dataset and command. Alignments contained viral DNA sequences. Alignments had from 90 to 1039 sequences with 1011 columns. Any ideas how to fix this? Thank you and best regards Sviataslau Sasinovich, PhD \u2014\u2014\u2014\u2014\u2014 IQTREE IQ-TREE MPI multicore version 1.6.9 for Linux 64-bit built Jan 7 2019 LINUX Debian GNU/Linux 8 (jessie) ARCH: Architecture: x86_64 CPU op-mode(s): 32-bit, 64-bit Byte Order: Little Endian CPU(s): On-line CPU(s) list: 0-31 Thread(s) per core: Core(s) per socket: Socket(s): NUMA node(s): Vendor ID: GenuineIntel CPU family: Model: Model name: Intel(R) Xeon(R) CPU E5-2680 0 @ 2.70GHz Stepping: CPU MHz: 1200.339 CPU max MHz: 3500.0000 CPU min MHz: 1200.0000 BogoMIPS: 5422.63 Virtualization: VT-x L1d cache: 32K L1i cache: 32K L2 cache: 256K L3 cache: 20480K NUMA node0 CPU(s): 0-7,16-23 NUMA node1 CPU(s): 8-15,24-31 ", "Here I would like to add some more observations to my previous post. 1. Even non-mpi multicore iqtree v. 1.6.9 (non compiled) use all cores on the beginning. 2. After that, option -redo doesn't work. Iqtree-mpi start estimations from the beginning and overwrite existing .log, .treefile, .ckp.gz and other files. 3. Same if option -redo is not present in the command. Iqtree-mpi start estimations from the beginning and overwrite existing .log, .treefile, .ckp.gz and other files. ", "Dear Sviataslau, Thanks for the detailed report! However, the MPI code with partition models was not properly tested. And we don\u2019t have human resource to maintain this feature. So it might take a while until we can get back to you. For now I recommend that you just use the multi-threading version. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Sviataslau, I have now time to look at this issue: The MPI version does not support -nt AUTO option when processes are running in the same computer. We will change this, but for now please avoid AUTO and specify the number of threads (per process) explicitly. Secondly, --runs option is definitely not supported in MPI version. So please avoid this option. Cheers Minh ", "Hi Minh thank you very much for your time spending on this case and your suggestions. And now I would like to add few comments again. 1. -nt AUTO. your suggestion to avoid using -nt AUTO helped to solve the problem when iqtree-mpi takes all the cores. It works when exact number of threads is specified. 2. --runs option actually works with MPI version iqtree. Previously I reported that iqtree stop phylogeny estimations randomly. But it seems like the problem was with our linux server: we used one for a long time without rebooting and system processes takes almost all memory. And now, after rebooting, iqtree-mpi works perfect with the --runs option! \ud83c\udf7e Best regards, Sviat On Friday, 22 February 2019 05:30:06 UTC+1, Minh Bui wrote: Hi Sviataslau, I have now time to look at this issue: The MPI version does not support -nt AUTO option when processes are running in the same computer. We will change this, but for now please avoid AUTO and specify the number of threads (per process) explicitly. Secondly, --runs option is definitely not supported in MPI version. So please avoid this option. Cheers Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Cool, good to know, that the problem was solved. Actually after replying your email, I checked iqtree-mpi with --runs options with my data set. And it indeed worked well. Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com "]}, "zWML9-2xxgE": {"topic": "not recovering same likelihood score when recalculating", "initializeDate": "Oct 17, 2020, 7:05:46 PM", "timeStamp": "Oct 24, 2020, 2:58:01 AM", "content": ["Hi, I am finding that for certain trees, I am not able to recover the same likelihood score as reported during the tree inference, and it's enough of a difference to make me wonder what is going on. For instance, I inferred a tree and the likelihood score reported at the end of the inference was -1'016'312.877. If I provide the same alignment and model specification, and supply the inferred tree with the -te argument, the score I get is -1'016'883.498. (I attached the log files for these: the original inference, and the likelihood evaluation on the fixed tree.) These scores are different enough that they change the ranking of candidate trees when I compare these scores to the scores of other phylogenetic inferences of this same dataset. Is one of these more accurate? thanks! -Pascal ", "Hi Pascal, Indeed I don\u2019t expect this to happen. My only guess right now is that, this is due to local optimum in the parameter space: the 2nd run suddenly landed a sub-optimal model parameters. What you can do to check this: notice that your first run produce a best_model.nex file. This file contains the model and the parameters. In the 2nd run, you can replace the -spp option with this file from the 1st run. And let me know, if that returns the better log-likelihood of the first run. In any case I\u2019d just stick with the likelihood from the first run. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/3f8d0cc4-3dd1-4eac-b0d7-f5c7600156c3n%40googlegroups.com <gekkoTree26_eval_iqtree.log> <Gekkonidae_default_26.log> ", "Ok, yes I can confirm that if I supply the model parameters, I get the initial better log likelihood. So this must be due to a local optimum. thanks! ", "Hi Pascal, thanks for the confirmation. It\u2019s an interesting observation, I think this can happen because the numerical optimization algorithm actually does not guarantee global optimum. But I expect this to occur very rarely: this is still (much) easier than optimizing tree topology. So this is not a bug, rather an unwanted feature ;-) Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/af7f63e1-066d-4578-b0e1-16f7c6bb6fcbn%40googlegroups.com "]}, "IaEFy4J4vbU": {"topic": "No .pdf or .svg in download", "initializeDate": "Apr 9, 2020, 2:29:00 PM", "timeStamp": "Apr 13, 2020, 8:14:27 PM", "content": ["I've tried building a couple of trees using my .fasta alignment. When I did this last week, the download folder had 6 files, including a pdf and an svg of the tree. The 2 trees I've tried to make today, I can only see the tree in the full results tab - no svg or pdf is in the downloaded folder. The download folder only has 4 files. I even tried re-doing the tree that worked last week, and now that one won't give me the pdf or svg files either. I'm using the IQtree webserver on MAC. ", "On 10 Apr 2020, at 4:28 am, Lindsey Lamboo < lindse...@gmail.com > wrote: I've tried building a couple of trees using my .fasta alignment. When I did this last week, the download folder had 6 files, including a pdf and an svg of the tree. The 2 trees I've tried to make today, I can only see the tree in the full results tab - no svg or pdf is in the downloaded folder. The download folder only has 4 files. I even tried re-doing the tree that worked last week, and now that one won't give me the pdf or svg files either. I'm using the IQtree webserver on MAC. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9e2f08fe-c189-400f-97c3-295d969a2968%40googlegroups.com ", "Hi there, Thanks for the report. This problem is associated with the server, not IQ-TREE. @Heiko: Can you please ask Robert to look at this? It uses ETE software to render the tree. Perhaps some configuration or the recent power cut that broke this? Thanks Minh On 10 Apr 2020, at 4:28 am, Lindsey Lamboo < lindse...@gmail.com > wrote: I've tried building a couple of trees using my .fasta alignment. When I did this last week, the download folder had 6 files, including a pdf and an svg of the tree. The 2 trees I've tried to make today, I can only see the tree in the full results tab - no svg or pdf is in the downloaded folder. The download folder only has 4 files. I even tried re-doing the tree that worked last week, and now that one won't give me the pdf or svg files either. I'm using the IQtree webserver on MAC. "]}, "R1qoLfGfNro": {"topic": "Missing date information for some internal nodes", "initializeDate": "Apr 7, 2021, 5:19:28 AM", "timeStamp": "Apr 11, 2021, 11:43:33 PM", "content": ["Dear developer, I am currently using IQ-TREE (v 2.1.2) for a dated phylogenetic tree ( link ), and I find that some of the internal nodes are lacking date labels. For example as shown in the below screenshot, the node 1 had date label as expected, but node 2 lack the related information (neither date nor date CI). I found that there were some confusing nodes (e.g. Node 2 below) which had node-to-node distance of 0 to their parent nodes, and most of these confusing nodes are lacking the date info. I was wondering why these confusing nodes are not date labelled? Are the nodes indispensable for defining a particular clade? Or can I just ignore them and treat these nodes as their parent nodes? I am also attaching the script I was using: iqtree2 -T AUTO -m GTR+G+F -B 1000 -alrt 1000 --redo -s ../results/cases.fasta --date ../results/date_fasta_all_semi.tsv --date-ci 100 -o \"MN908947_3\" Thanks so much for your kind help. ", "Hi, Thanks for reporting this issue. Initially we didn\u2019t label those nodes just to avoid the labels eventually overlapping when visualize the tree, because those nodes have the same date and same confidence intervals. But then we decided to put labels on all internal nodes for the consistency of format. From your report, I realized that there\u2019s still 1 case that I forgot to change. It will be fixed in the new version then. So briefly, all internal nodes should be labeled the same way. Best regards, Hien You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9013b0fd-b9fd-451d-a082-2aed9b75f4b1n%40googlegroups.com ", "Hi Hien, Great to know that these nodes have the same date and same confidence intervals. My question is resolved. Thanks so much. Best, Haogao "]}, "p34a6Hq3S3E": {"topic": "ERROR: Too large site ID", "initializeDate": "Jul 13, 2018, 11:37:49 AM", "timeStamp": "Jul 13, 2018, 1:19:31 PM", "content": ["Hi Guys In trying to run IQtree with partitioned data (a morphological matrix and a aa dataset). I have been getting this error. My .phy files are good as they run by themselves in IQtree. and here is my nexus file called test.example.nex #nexus begin sets; charset part1 = Sc.128.txt: 1-2176; charset part2 = Whe.txt : 2177-48718; charpartition mine = MK:part1, LG+F+I+G4:part2; end; SC.128.txt is the morphological set and Whe.txt is the AA set. and here is the command I use when trying to run the nexus file. bin/iqtree -sp test.example.nex I am probably doing something incredibly stupid, but what? thanks for any time you can give to this query. ", "Dear Rob, Thanks for your interest in IQ-Tree. Just from the error message, I would say that 48718 is larger than your actual alignment length. However, this is guessing, because I cannot check your alignment ;) Best regards, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "thank you heiko actually all i needed to do was change the nex file to #nexus begin sets; charset part1 = Schier.128.txt: 1-2176; charset part2 = Whe.txt : 1-46542; charpartition mine = MK:part1, LG+F+I+G4:part2; end; my whe file starts at 1 not 2177 but you pointed to the obvious error and indeed mine ws pretty silly great program. glad you guys did it rob From: iqt...@googlegroups.com iqt...@googlegroups.com > on behalf of Heiko Schmidt < heiko....@univie.ac.at Sent: Friday, July 13, 2018 12:15:01 PM To: IQ-TREE Forum Subject: Re: [iqtree] ERROR: Too large site ID > Visit this group at https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgroups.google.com%2Fgroup%2Fiqtree&amp;data=01%7C01%7Cdesalle%40amnh.org%7C64dbe6ebcac34bd1fa7108d5e8dbcb2e%7Cbe0003e8c6b9496883aeb34586974b76%7C0&amp;sdata=8%2FOdD%2FysO8tUt4u6HT6L46RKJFpQO4kcmGM8uzi1ZD0%3D&amp;reserved=0 > For more options, visit https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgroups.google.com%2Fd%2Foptout&amp;data=01%7C01%7Cdesalle%40amnh.org%7C64dbe6ebcac34bd1fa7108d5e8dbcb2e%7Cbe0003e8c6b9496883aeb34586974b76%7C0&amp;sdata=ldxJJr3E9z7iamF1GhKoK8kImbK6KxW9A8qtNWI4WpE%3D&amp;reserved=0 ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) https://na01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.cibiv.at%2F&amp;data=01%7C01%7Cdesalle%40amnh.org%7C64dbe6ebcac34bd1fa7108d5e8dbcb2e%7Cbe0003e8c6b9496883aeb34586974b76%7C0&amp;sdata=PebunV6w1SU1brc3nQ6gijFiYVTTEDTVq43b8jJ%2BI9k%3D&amp;reserved=0 ----------------------------------------------------------------------------- You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgroups.google.com%2Fgroup%2Fiqtree&amp;data=01%7C01%7Cdesalle%40amnh.org%7C64dbe6ebcac34bd1fa7108d5e8dbcb2e%7Cbe0003e8c6b9496883aeb34586974b76%7C0&amp;sdata=8%2FOdD%2FysO8tUt4u6HT6L46RKJFpQO4kcmGM8uzi1ZD0%3D&amp;reserved=0 For more options, visit https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgroups.google.com%2Fd%2Foptout&amp;data=01%7C01%7Cdesalle%40amnh.org%7C64dbe6ebcac34bd1fa7108d5e8dbcb2e%7Cbe0003e8c6b9496883aeb34586974b76%7C0&amp;sdata=ldxJJr3E9z7iamF1GhKoK8kImbK6KxW9A8qtNWI4WpE%3D&amp;reserved=0 "]}, "FK9Sn7dYaSU": {"topic": "short question on the *.contree output when running UFboot", "initializeDate": "Oct 2, 2020, 4:05:35 PM", "timeStamp": "Oct 5, 2020, 4:52:39 AM", "content": ["Dear all/Minh, the *.contree file when e.g. runingUFboot, is this a consensus tree (what exactly, majority rule / extended majority rule) from e.g. the number of bootstraps I run?) Searched here but only could find threads in thein combination with SH-aLRT - and in the manual pdf I did not find an expplanation. Many many thanks, Karen ", "Hi Karen, It\u2019s the extended majority consensus from the UFBoot bootstrap trees. If you want majority-rule consensus, add \u201c-minsup 0.5\u201d option to the command line. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ef046c3d-03b7-4598-8ac1-8793dd489ac9n%40googlegroups.com ", "ok great, many thanks!!!! Cheers Karen "]}, "iGktu3JqJeI": {"topic": "Some questions about models and ancestral state reconstruction", "initializeDate": "Oct 6, 2019, 11:19:13 AM", "timeStamp": "Oct 8, 2019, 8:13:49 AM", "content": ["Hi All, I'm using IQ-Tree to do ASR on a binary encoded morphological dataset and have some questions. 1) ModelFinder indicates the best model is GTR2, but I cannot find an explanation of what this model is, is it described anywhere?. 2) My dataset includes missing data coded as \"?\", rather than skipping columns with ? IQ-Tree does the ASR on these sites. Is that normal? 3) The IQ-Tree ASR does get] it \"right\" most of the time when a column includes ? sites. Can it also predict whether a ? in an extant species is likely to be either 0 or 1? If so how can one access this data? Thanks! Vinny ", "Hi Vinny, On 7 Oct 2019, at 2:19 am, Vincent Lynch < vincent...@gmail.com > wrote: Hi All, I'm using IQ-Tree to do ASR on a binary encoded morphological dataset and have some questions. 1) ModelFinder indicates the best model is GTR2, but I cannot find an explanation of what this model is, is it described anywhere?. This is the general time reversible model for binary data (that\u2019s why the suffix \u201c2\u201d). It\u2019s the same merit as GTR for DNA, just adapted for 2 character states. 2) My dataset includes missing data coded as \"?\", rather than skipping columns with ? IQ-Tree does the ASR on these sites. Is that normal? Yes that\u2019s normal. While some taxa has \u201c?\u201d, other taxa having \u201cproper\u201d states will help to predict the ancestral states. For example, if a site is \u201c???0????\u201d, then IQ-TREE can still infer the ancestral states (likely 0 in this example). 3) The IQ-Tree ASR does get] it \"right\" most of the time when a column includes ? sites. Can it also predict whether a ? in an extant species is likely to be either 0 or 1? If so how can one access this data? Good question. Right now there is no such option, as ASR is meant for (extinct) internal nodes. But why do you need such a feature? If there is a good reason why it\u2019d be useful, then we will consider to implement that. Cheers Minh Thanks! Vinny You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b7ffdb50-902f-43d2-8c21-065e645009de%40googlegroups.com ", "Hi Minh, Thanks for the quick reply! This is the general time reversible model for binary data (that\u2019s why the suffix \u201c2\u201d). It\u2019s the same merit as GTR for DNA, just adapted for 2 character states. Good question. Right now there is no such option, as ASR is meant for (extinct) internal nodes. But why do you need such a feature? If there is a good reason why it\u2019d be useful, then we will consider to implement that. Our dataset is a matrix of gene expression coded as 0 for \"not expressed\", 1 for \"expressed\", and ? for \"missing data\". In this case the data is missing because those genes likely have not been annotated in particular genomes; we'd like to be able to impute gene expression info using the ancestral reconstructions because while those data are missing they can still provide useful information (for example, if the BPP of the inference is >0.8 or something we include the imputed value in downstream analyses, otherwise we consider it a poorly imputed inference and exclude it). I think such a phylogenetic imputation feature would also just be generally useful. If it is implemented we're happy to include you and others as co-authors on manuscripts in which we use the data. Best, Vinny Cheers Minh Thanks! Vinny You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "3I8YX2ZaI9M": {"topic": "% of gaps+ambiguities vs. % of missing data", "initializeDate": "Nov 16, 2018, 2:46:46 AM", "timeStamp": "Nov 19, 2018, 5:21:13 AM", "content": ["Hi! I'd like to ask how iqtree calculates % of missing data (reported in *.iqtree output)? I was, possibly naively, expecting that it is proportion of gaps+undetermined characters (Ns and Xs) in the alignment, but it is substantially lower number than the % of gaps/ambiguity reported in *.log output of iqtree for my datasets. Thanks for any suggestions! Best, Ales ", "Hi Ales, The percentage of missing data is based on presence-absence of the taxon-gene matrix, taking into account the gene alignment lengths. For example, say we have 5 taxa A, B, C, D, E and 2 genes. Gene 1 has taxa A,B,C,D and 100bp Gene 2 has taxa C,D,E and 200bp Missing data is 1*100 + 2*200 bp (lengths of all absent sequences) The supermatrix has 5*300 bp. So missing data% = the former / the latter. Whereas the % of gaps/ambiguity include this missing data% plus all Ns, Xs in the sequences. So it is >= missing data%. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "4almSK-eNIw": {"topic": "IQ-TREE CRASHES WITH SIGNAL ABORTED", "initializeDate": "May 11, 2017, 10:37:07 AM", "timeStamp": "May 12, 2017, 4:24:18 AM", "content": ["Dear Minh, On a Mac Pro (end 2013) with a 3Ghz 8 core intel Xeon E5 64 - Go DDR And macOS Sierra 10.12.4 This is the new 'intermediate' version of the macPro that has just been released, event if it is said to be a 2013 version :) IQ-tree 1.5.4-MacOSX I got Assertion failed: (fabs(new_tree_lh-tree_lh) < 1.0), function optimizeAllBranches, file /Users/minh/Dropbox/iqtree-git/phylotree.cpp, line 2515. STACK TRACE FOR DEBUGGING: 2 _sigtramp() 6 PhyloTree::optimizeAllBranches(int, double, int) 7 ModelFactory::optimizeParameters(int, bool, double, double) 8 testModel(Params&, PhyloTree*, std::__1::vector<ModelInfo, std::__1::allocator<ModelInfo> >&, std::__1::basic_ostream<char, std::__1::char_traits<char> >&, ModelsBlock*, int, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, bool, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >) 9 initializeParams(Params&, IQTree&, std::__1::vector<ModelInfo, std::__1::allocator<ModelInfo> >&, ModelsBlock*) 10 runTreeReconstruction(Params&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >&, IQTree&, std::__1::vector<ModelInfo, std::__1::allocator<ModelInfo> >&) 11 runPhyloAnalysis(Params&, Checkpoint*) *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: etc. Tried both nuclei and protein alignments You will find the proteins data in the uploaded files. the instruction was iqtree-omp-1.5.4-MacOSX/bin/iqtree-omp -s METAPROT/TREES/concatenat.fst -m TESTNEW -mset ../bin/RPRM-FIRMICUTES.paml -cmin 8 -cmax 12 -safe -mredo -alrt 1000 -bb 1000 -abayes -nt 16 I was previously using IQ-tree 1.5.1 under LINUX without trouble for the same datas. What shall I do ? Thank for your help JP Flandrois ------------------------------------ Pr. emer. JP Flandrois MD, PhD Univ Lyon. LBBE Laboratoire de Biometrie et Biologie Evolutive - http://lbbe.univ-lyon1.fr/ Team/ Equipe Bioinformatique, Phylog\u00e9nie et G\u00e9nomique Evolutive ------------------------------------- jean-pierre.flandrois@ univ-lyon1.fr UMR 5558-LBBE. 43, Bd du 11 novembre 1918, B\u00e2timent Mendel 69622 Villeurbanne Cedex FRANCE (Univ Lyon, Universit\u00e9 Lyon 1, CNRS, UMR 5558 , \"Laboratoire de Biometrie et Biologie Evolutive\" LBBE) ----------------------------------- - Mobile/Cellular (only) : 33 6 63 22 55 00 https://umr5558-bibiserv.univlyon1.fr/flandrois/index.html -------------------------------------- ", "NEXT TEST I tried with a much smaller set and identical instructions, it _works_ seems something wrong in the memory management ? I also tried IQ-tree 1.5.0 and upper _with the original \"big\" alignment_ and it crashes every time. ", "Hi Flandrois, Thanks for the detailed report. I will have a look. From the assertion message, it does not seem to have something to do with the size of the alignment. And please note that, your attached data files will be publicly seen. Thus if you want to keep them confidential then only send to my personal email. PS: It is new to me that -mset option also works with user-defined protein model from a file ;-) Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "ghaJHOCMK5A": {"topic": "IQ-TREE release 1.4.2", "initializeDate": "Apr 15, 2016, 11:11:03 AM", "timeStamp": "Apr 15, 2016, 11:11:03 AM", "content": ["April 15, 2016 Dear users, IQ-TREE version 1.4.2 is released, that improves software stability: New features: * Ability to draw all unique quartets for likelihood mapping with `-lmap ALL` option (requested by Karen Meusemann). Bug fixes: * A rare bug in `-m TESTMERGE` when all partitions are merged into one (reported by Tan Mun Hua). * A segfault in `-m TESTNEW` for Windows version only (reported by Giorgio Matassi). * A rare crash with partition model parameter estimation. * A bug in parsing semi-empirical codon model name (reported by Xiaofan Zhou). * A rare crash when sequence names are IDs. Best, IQ-TREE development team "]}, "qeoLXzea3N0": {"topic": "question about random seed and bootstrap", "initializeDate": "Aug 13, 2015, 4:12:10 PM", "timeStamp": "Jan 8, 2016, 9:29:46 AM", "content": ["Hi, I am wondering if there is a way to make bootstrap analysis repeatable. Without bootstrapping, I can always get the same topology (although slightly different branch length) using the same random seed. However, once I turn on the UFBS, the topology changes every time even with the same seed. Thanks! Best, Xiaofan ", "Dear Xiaofan, that\u2019s strange. I just reran the example dataset 10 times with the same seed number (via -seed option) for the ultrafast bootstrap and always got the same result back\u2026I don\u2019t really know what happened in your case. Are using the same IQ-Tree version? Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Thanks for you reply! I was using the same binary (iqtree-omp pre-complied Linux version v1.3.5) for everything. I tried compiling from source but got the same problem. Please find attached the dataset if you want to replicate the analysis. I just analyzed the example.phy dataset 10 times, and indeed I got the same results using the same seed. However, when I provide starting trees (100 random trees with \"-t\"; the same set of 100 trees for all 10 replicates), I got different results again with bootstrapping (without bootstrapping the results are always the same). Can you please take a look? Thanks! Best, Xiaofan ", "Dear Xiaofan, Could you please provide us the complete command(s) that you used for your analysis. It was not so clear to me what do you mean by \"providing starting trees (100 random trees with '-t' ....\". IQ-TREE does not have the option to input more than 1 starting trees. We also do not recommend inputting a random tree into IQ-TREE because the tree search algorithm in IQ-TREE already does a lot of randomization to escape local optima. Thus, inputing a random tree is not necessary and can even make the result worse. When I ran IQ-TREE on your dataset with the UFBoot option using the same seed number I always got the same results. The command I used was: iqtree -s test.phy -m GTR+G -bb 1000 -pre test.phy.bb.1 -seed 123 Cheers Tung ", "Dear Tung, Here is the command that I was using: iqtree-omp -nt 4 -s test.phy -m GTR+G -bb 1000 -seed 12345 The only major difference between our commands is that I used the OMP version. I just repeated the analysis using the single-thread version, and I got the same results every time. Regarding the starting tree, I basically generated a file containing 100 random trees and provide the file using the \"-t\" option. The program did not complain about multiple trees so I thought it accepts multiple starting trees. Then in such case, does the program always take the first tree in the file? Also, in my analysis I run the program 20 times, 10 times with default starting trees, 10 times with random starting trees. For most of the data sets I analyzed, it turns out that some of the random starting trees lead to the best likelihood score, which seems opposite to your recommendation. I am wondering if I did anything wrong, or do you have any thoughts? Thanks! Best, Xiaofan ", "Dear Xiaofan, Here is the command that I was using: iqtree-omp -nt 4 -s test.phy -m GTR+G -bb 1000 -seed 12345 The only major difference between our commands is that I used the OMP version. I just repeated the analysis using the single-thread version, and I got the same results every time. Yes, I confirm that iqtree-omp produce 2 slightly different trees on 2 runs using the same seed number. The problem is caused by numerical instabillity happened with your alignment and because the trees contain polytomies. If your look at the reconstructed tree(s) for your alignment, you can see that there several near-zero internal branches. You can check for this information if you look at the .iqtree file: \"WARNING: 4 near-zero internal branches (<0.0020) should be treated with caution\". You will then see polytomies in the tree. For example: the grouping of T19,T80,T31,T41,T78 forms a polytomy and this is also one of the places where the trees differ. IQ-TREE only computes the log-likelihood up to the precision of 0.01. Thus, if you run IQ-TREE several times on your alignment (with different seeds) you might get different trees that only differ in how those polytomies are resolved. Those trees should be considered as identical. The multi cores version of IQ-TREE might have trouble with numerical instability, especially for your data. The seed number does not govern the order in which the CPU cores are executed. For example: logl(Core1) + logl(Core2) + logl(Core3) might not equal logl(Core2) + logl(Core3) + logl(Core1). This is the nature of computer and for that reason, even with the same seed IQ-TREE-OMP might resolve the polytomies in your tree diffrently. Numerical instability would not be a problem on tree without polytomies. It's interesting that for your dataset this ambiguity only happen with the UFBoot option. However, I would expect that for other datasets which also contains polytomies, running IQ-TREE without the UFBoot option could have the same problem too. The UFBoot option does a lot of extra computations, that's why it is possibly more prone to this problem. Then in such case, does the program always take the first tree in the file? Yes. Also, in my analysis I run the program 20 times, 10 times with default starting trees, 10 times with random starting trees. For most of the data sets I analyzed, it turns out that some of the random starting trees lead to the best likelihood score, which seems opposite to your recommendation. I am wondering if I did anything wrong, or do you have any thoughts? The minimal log-likelihood differences you observed between the trees are caused by the polytomies and because IQ-TREE only compute log-likelihood up to the precision of 0.01. Even on 2 different IQ-TREE runs which produce the same tree, you will see slightly diffrent log-likelihoods. All the trees produced from your dataset are in fact equally likely. They only differ in the (random) resolution of the polytomies. You might observe that if you run IQ-TREE from random starting trees on your dataset, the output log-likelihoods are often slightly better than runs started from parsimony trees. This is because with random starting trees, more optimization need to be done which makes the likelihood computation slightly more accurate, although the tree topologies (with polytomies) are the same. However, it does not mean that runs started from random trees produce better results. Cheers Tung ", "Dear Tung, Thanks very much for your detailed explanation! It's very helpful. I have one last question: if I want to do a more thorough search than the default, do you have any recommendations (e.g. run IQTREE multiple times, a single run with more iterations, or to change some other parameters?)? Best, Xiaofan ", "Dear Xiaofan, I just wrote a general guideline regarding your question. Take a look: https://groups.google.com/forum/#!topic/iqtree/0mwGhDokNns Cheers Tung ", "Dear Xiaofan, I just want to clarify a bit more: Tung mentioned numerical stability, which is not a problem or trouble of IQ-Tree, but associated with numerical rounding errors in the computers. This might cause, for example, the addition operation to return slightly different result if the terms are added in different order. Tung gave a nice example for the multicore version. Thus, having different result is a general \u201cfeature\u201d of multi-threaded application, not just IQ-Tree. Cheers, Minh ", "Dear Minh and Tung, Thanks a lot for posting the best practice and the additional explanation! I understand that the rounding errors are due to the computer, but I also notice that the mulit-threaded version of RAxML generates the same tree (and branch lengths) using the same random seed. Is it because the parallelization is implemented differently in RAxML and IQTREE? Also, I found for data sets containing identical sequences, \"-wt\" option will output smaller trees (I saw a earlier post with similar question on bootstrap trees). I am wondering if you can output the full trees instead? Best, Xiaofan On Wednesday, August 19, 2015 at 2:22:10 AM UTC-5, Bui Quang Minh wrote: > Dear Xiaofan, ", "Hi Xiaofan, > On 19 Aug 2015, at 22:54, zhouxia...@gmail.com wrote: > Dear Minh and Tung, > Thanks a lot for posting the best practice and the additional explanation! > I understand that the rounding errors are due to the computer, but I also notice that the mulit-threaded version of RAxML generates the same tree (and branch lengths) using the same random seed. Is it because the parallelization is implemented differently in RAxML and IQTREE? yes two programs have different implementation > Also, I found for data sets containing identical sequences, \"-wt\" option will output smaller trees (I saw a earlier post with similar question on bootstrap trees). I am wondering if you can output the full trees instead? you can use undocumented option \u201c-keep_ident\u201d (keep identical sequences) Cheers, Minh > Best, > Xiaofan > On Wednesday, August 19, 2015 at 2:22:10 AM UTC-5, Bui Quang Minh wrote: >> Dear Xiaofan, >> I just want to clarify a bit more: Tung mentioned numerical stability, which is not a problem or trouble of IQ-Tree, but associated with numerical rounding errors in the computers. This might cause, for example, the addition operation to return slightly different result if the terms are added in different order. Tung gave a nice example for the multicore version. Thus, having different result is a general \u201cfeature\u201d of multi-threaded application, not just IQ-Tree. >> Cheers, Minh ", "Dear Xiaofan, with version 1.3.11 the multicore run should now be reproducible with the same seed number, even in the presence of short branches. Cheers, Minh ", "Dear all, I am also having trouble reproducing results using the same seed number. I am running the multicore version of IQ-TREE 1.3.4. The only difference is the first run (which produced the best topology) was run on a mac and subsequent runs were on a linux (same version of iqtree). The input file is a SNP dataset of 95 sequences with 17,046 sites The first run which produced the best topology was run on a mac using these settings: -m TEST+ASC -bb 1000 -omp 8 Seed: 686192 (Using SPRNG - Scalable Parallel Random Number Generator) Subsequently i re-ran the same dataset on a linux machine and got a different topology on a part of the tree that had clades of shallow divergence but not polytomous. Other highly diverged clades had consistent topology. I then re-ran this using the same seed as the first run (686192) and still could not replicate the results. It also worries me that i got very good node support for both sets of topologies. I have since then run this a few more times with the same seed and some runs produced very different log likelihoods. Some converged after 100 iterations. Some couldn't converge even after 1000 iterations. Is this a cross-platform issue? I'm happy to share my files if needed. Thanks in advance. ", "Dear Chan, if one is running an analysis in parallel, using the same random number seed does not guaranty to get the same result. The reason are fluctuation in the usage of the machine (due to load by other processes or the system, network traffic etc) which can easily lead to cases where one thread finishes its task slightly earlier or later than another. This in turn can cause that site likelihoods are added in a different order (leading to rounding effects), trees may be compared or used in different orders, or random numbers are drawn and used by different threads. (This is exactly the same in other parallelized phylogenetic programs.) Thus, if you want to reproduce a result exactly one by one you cannot use parallel computing (like here with the -omp flag). So, this need not be a cross-platform effect. However, the results should not differ more than between different runs with different random number seeds. Of course I do not know how different the likelihoods are or how high the very good node support was. Best wishes, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ----------------------------------------------------------------------- Dr. Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) Dr. Bohr Gasse 9 Tel. : ++43 +1 / 4277 - 74321 A-1030 Vienna, Austria Email: heiko.schmidt(AT) univie.ac.at http://www.cibiv.at/ ----------------------------------------------------------------------- ", "Thank you for the clarification! ", "@Heiko: thanks for the very good explanation. Moreover, I confirm that IQ-TREE 1.3.11 removed the second reason: >> random numbers are drawn and used by different threads. whereas iqtree 1.3.10 or earlier indeed generated random numbers by different threads. Therefore 1.3.11 should be much more reproducible than earlier versions. Note that the first reason: >> site likelihoods are added in a different order (leading to rounding effects), is still present, but much less influenced than the random number generators. Cheers, Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "TlXeR7s64eY": {"topic": "Installing MPI+MP version on enviroment", "initializeDate": "Oct 2, 2019, 5:56:47 PM", "timeStamp": "Oct 2, 2019, 9:26:28 PM", "content": ["Hi, My iqtree1.6.8 is installed in a conda environment in a cluster. Is there a way to compile the MPI-MP version in it? ", "Hi there, I don\u2019t maintain the conda package (perhaps they should provide an MPI version). But the compilation guide for MPI version (and other versions) is here: http://www.iqtree.org/doc/Compilation-Guide Minh On 3 Oct 2019, at 7:56 am, N.B. < nnbua...@gmail.com > wrote: Hi, My iqtree1.6.8 is installed in a conda environment in a cluster. Is there a way to compile the MPI-MP version in it? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f4630300-7655-46c1-b798-4680591539b7%40googlegroups.com "]}, "LO2XqTaUJxY": {"topic": "Workshop on Phylogenomics 2019, Czech Republic", "initializeDate": "Aug 9, 2018, 1:19:22 AM", "timeStamp": "Aug 9, 2018, 1:19:22 AM", "content": ["Dear All, IQ-TREE will be taught at the Workshop on Phylogenomics, \u010cesk\u00fd Krumlov, Czech Republic, from 20 January \u2013 2 February, 2019. Registration deadline is 15 Sept, 2018. For more information please go to: http://evomics.org/workshops/2019-workshop-on-phylogenomics-cesky-krumlov/ Cheers Minh "]}, "11C2GA7tppw": {"topic": "Re: [iqtree] IQ-TREE web server - does not work :(", "initializeDate": "Aug 11, 2019, 3:43:38 AM", "timeStamp": "Aug 11, 2019, 3:43:38 AM", "content": ["Hi there, I believe this was due to a power outage, but only for a short duration. Cheers, Minh On 30 Jul 2019, at 6:28 pm, Dmitry Karabanov < dkara...@gmail.com > wrote: I'm trying to analyze, but I get the answer: Sorry, there is an issue with the cluster system. We are trying to resolve it asap! Please redair my favorite server! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/da325d1d-4f94-49a6-9ed2-a3b73f2c2665%40googlegroups.com "]}, "lG10qxdsYkk": {"topic": "TESTONLY Runs with Heterotachy for Amino Acids", "initializeDate": "Jul 17, 2017, 1:39:22 PM", "timeStamp": "Dec 3, 2017, 11:33:02 AM", "content": ["I wish to test various options with the heterotachy model to get strictly comparable BIC scores before I choose model settings to do full scale tree runs. I have a TestAlign.phy and a TestAlign.treefile (my current best tree with the LG+G20 model [current best for our data]). I wish to try the series: LG+F+H4; LG+F+H6; LG+F+H8 LG+FO+H4; LG+FO+H6; LG+FO+H8 I have not been able to get TESTONLY runs to do this correctly. Would you please give me a command syntax which will do what I want? I assume I will have to do a separate run for each desired parameter set (i.e. 6 in all)? That is fine. ", "Hi David, this was discussed before: https://groups.google.com/forum/#!topic/iqtree/qoRYiIH-2sM The quick answer is yes, you have to do separate runs for each model. But incorporating heterotachy models into ModelFinder is on our agenda. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh: I have looked at the discussion you reference below, however I don't see any command syntax, just a statement by Stephen that he did some model testing. I know you are busy, but I can't really proceed with these tests until I know a syntax that will work correctly. I have tried a few things but they clearly have not worked properly. Thanks, Dave ", "I see, You can use option -m. A few example commands are in the documentation: http://www.iqtree.org/doc/Complex-Models#heterotachy-models Minh ", "Hi David, Since the heterotachy model is not yet compatible with the model test features in IQ-TREE you have to individually run all the models you are interested in testing, and then compare results manually. So for example to test LG+F+H4 you can use the following command: iqtree -s TestAlign.phy -m LG+F+H4 -te TestAlign.treefile -pre TestAlign.LGFH4 -nt AUTO Repeat this command for all the different models you want to test, changing the \u2018-m' argument each time. Hope this helps, Stephen On 25 Jul 2017, at 12:38 am, 'David Kerk' via IQ-TREE < iqt...@googlegroups.com > wrote: Hi Minh: I have tried going back to instructions you kindly sent me last year on model testing when I already have a \"standard\" reference tree. In this case, I used our best current model (LG+G20) with TestAlign.phy to get the tree TestAlign.treefile. Now I am trying to test a heterotachy Model (LG+F+H4) using as input this standard tree. I have tried using the following commands, and got the following results. Please advise on how I need to change this to get the heterotachy model to be tested correctly. Best, Dave Command Result iqtree -s TestAlign.phy -m TESTONLY -mset LG+F+H4 -te TestAlign.treefile -pre TestAlign.LGFH4 -nt AUTO Like LG alone being tested (Best [BIC]: LG+F+I+G4) iqtree -s TestAlign.phy -mset LG -mrate +F+H4 -te TestAlign.treefile -pre TestAlign.LGFH4 -nt AUTO LG+F alone tested iqtree -s TestAlign.phy -mset LG -mrate F+H4 -te TestAlign.treefile -pre TestAlign.LGFH4 -nt AUTO LG+F alone tested iqtree -s TestAlign.phy -m TESTONLY -mset LG -mrate F+H4 -te TestAlign.treefile -pre TestAlign.LGFH4 -nt AUTO LG+F alone tested ", "Hi Stephen: Thanks for your reply. I did model tests with IQTree-omp 1.5.5 with \u201cTestAlign.phy\u201d and got the treefile from the best model: TestAlign.phy.treefile. I then set up a heterotachy run with IQTree 1.6beta4, where I thought the output was going to be a table with AIC/AICc/BIC results (as in the previous run with ver 1.5.5 where I used the \u201c-m MF\u201d command syntax). I used the following in IQTree 1.6beta4: iqtree \u2013s TestAlign.phy \u2013m LG+F+H2 \u2013te TestAlign.phy.treefile \u2013pre TestAlign.LGFH2 \u2013nt 3 Rather than testing the model, the run just loaded the old treefile, used the heterotachy model, and ran a new tree. The log file is attached. How do you get it to test the model? Thanks, Dave You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/lG10qxdsYkk/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com ", "Hi David, I am not sure exactly what you mean by \u2018test the model\u2019? You will not be able to get any output that resembles the ModelFinder output when you use the heterotachy model. This is because ModelFinder is not yet compatible with heterotachy models. Testing a group of models essentially just means comparing them based on AIC, AICc or BIC. These scores are all reported in the .iqtree file for each run. So in order to find out which heterotachy model gives you the best AIC (for example) you must run all the heterotachy models you are interested in and then manually inspect the AIC scores for each model in the .iqtree files. Then you pick the model with the lowest AIC score. SO to summarise, at this stage there is no capability within IQ-TREE to test a wide range of different heterotachy models simultaneously. The only way to do it is to run all the models yourself with separate command lines (as you have done below for the LG+F+H2 model) and compare the results manually. Cheers, Stephen <TestAlign.LGFH2.log> ", "Hi Stephen: Got it. Thanks! Dave ", "Hi David, Sorry, I don\u2019t know if this question was already answered. But ModelFinder does not support testing +H model yet. We will release version 1.6 soon which allows this. I believe there is another thread here showing how to overcome this currently. Cheers, Minh On Jul 25, 2017, at 12:38 AM, David Kerk < davi...@yahoo.com > wrote: Hi Minh: I have tried going back to instructions you kindly sent me last year on model testing when I already have a \"standard\" reference tree. In this case, I used our best current model (LG+G20) with TestAlign.phy to get the tree TestAlign.treefile. Now I am trying to test a heterotachy Model (LG+F+H4) using as input this standard tree. I have tried using the following commands, and got the following results. Please advise on how I need to change this to get the heterotachy model to be tested correctly. Best, Dave Command Result iqtree -s TestAlign.phy -m TESTONLY -mset LG+F+H4 -te TestAlign.treefile -pre TestAlign.LGFH4 -nt AUTO Like LG alone being tested (Best [BIC]: LG+F+I+G4) iqtree -s TestAlign.phy -mset LG -mrate +F+H4 -te TestAlign.treefile -pre TestAlign.LGFH4 -nt AUTO LG+F alone tested iqtree -s TestAlign.phy -mset LG -mrate F+H4 -te TestAlign.treefile -pre TestAlign.LGFH4 -nt AUTO LG+F alone tested iqtree -s TestAlign.phy -m TESTONLY -mset LG -mrate F+H4 -te TestAlign.treefile -pre TestAlign.LGFH4 -nt AUTO LG+F alone tested ", "Hi Minh: Thanks for your kind reply. Yes, someone from your lab (forgot name) answered a while back and told me how to do this. I tried it but unfortunately because our alignments are too short it will not work properly with our data. Best, Dave You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/lG10qxdsYkk/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com "]}, "B6SLTKafTZU": {"topic": "IQ-Tree release 1.2.3", "initializeDate": "Apr 8, 2015, 9:28:51 AM", "timeStamp": "Apr 8, 2015, 9:28:51 AM", "content": ["Dear all, We have released IQ-Tree version 1.2.3 with several bug fixes. More details are available at http://www.cibiv.at/software/iqtree/ . If you are analyzing data which are not DNA and protein, I strongly recommend you to use this version. Best regards, Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at "]}, "uJmwW6SsjoY": {"topic": "Estimation log likelihood per site on random trees", "initializeDate": "Apr 20, 2020, 4:47:51 AM", "timeStamp": "Apr 20, 2020, 10:07:19 AM", "content": ["Hi! I would like to estimate log likelihoods per site on random trees, without performing any tree search. Is the following command apprpriate? (using the \".sitelh\" file as output) -t RANDOM -m WAG -n 0 -wsl Thanks!!! Noa ", "Hi Noa, Yes that the right command. Note however that the model parameters are still estimated on a maximum parsimony tree, which are then used to estimate branch lengths (and site likelihood) of the random tree. This does not apply in this run as WAG model is fixed, but may apply for other models (e.g. for WAG+G, then the Gamma shape parameter will be estimated on the MP tree). Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0c0c3b25-cf52-4303-9808-b331331ecf29%40googlegroups.com ", "Great. Thanks!!! "]}, "Z40CKpGuxNg": {"topic": "Fwd: [iqtree] Abridged summary of iqtree@googlegroups.com - 1 update in 1 topic", "initializeDate": "Mar 26, 2017, 3:41:45 PM", "timeStamp": "Mar 26, 2017, 3:41:45 PM", "content": ["Hello Longzhi, did you try Treegraph? treegraph.bioinfweb.info Best maxmaronna ---------- Forwarded message ---------- From: iqt...@googlegroups.com Date: 2017-03-26 4:12 GMT-03:00 Subject: [iqtree] Abridged summary of iqt...@googlegroups.com - 1 update in 1 topic To: Abridged recipients < iqt...@googlegroups.com iqt...@googlegroups.com Google Groups Today's topic summary View all topics Question about collapsing based on SH-aLRT and UFBoot support 1 Update Question about collapsing based on SH-aLRT and UFBoot support Longzhi Tan < tanlo...@gmail.com >: Mar 25 05:16AM -0700 Dear IQ-TREE, Greetings! I successfully ran IQ-TREE on my data with \"iqtree-omp -nt 4 -s or.mafft.fa -st AA -m JTT+G4+F -bb 1000 -alrt 1000\"; and according to your FAQ, I'm planning to ...more Back to top You received this digest because you're subscribed to updates for this group. You can change your settings on the group membership page To unsubscribe from this group and stop receiving emails from it send an email to iqtree+unsubscribe@googlegroups.com "]}, "FDfRWxILV18": {"topic": "mldist values", "initializeDate": "Jan 3, 2021, 10:44:29 AM", "timeStamp": "Jan 18, 2021, 5:07:20 AM", "content": ["I want to calculate maximum likelihood pairwise distances using iqtree2.exe -s conothoa_concat.nex -p part.nex -B 1000 -T AUTO --alrt 1000 --redo Analysis goes well, all final files had been generated. However ML distances values in mldist file are too small. Patristic distances taken from nex.treefile are realistic. What is wrong? ", "", "Hi Andrey, Indeed the distances in mldist file look too small. Did you get the same if using version 1.6.12 or not? They should be similar. If not, please get back to me. Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/47741177-2b56-4baf-befd-cde810c36621n%40googlegroups.com "]}, "Nkh6SIBL7_c": {"topic": "BUG: ERROR: #leaves and taxa_set do not match!", "initializeDate": "Jan 27, 2018, 5:37:59 AM", "timeStamp": "Jan 29, 2018, 2:37:25 PM", "content": ["Hello, I have found a bug in the Modelfinder: When I use a user guide tree Modelfinder for DNA model reports: \"ERROR: #leaves and taxa_set do not match!\", although the leaves and taxa set do match. I am sure that they match, since when I start Modelfinder with exactly the same set , but for Codon-Model, it runs through without any problem. I also compared the leaves and taxa in the fasta-file to be sure - and I can tell: it is 100% sure, that they match. All the best Dieter ", "Update: I have found out: Without partition file it would work, with partition file it does not work. All the best Dieter ", "Hi Dieter, My guess is that: your super-alignment has (a lot of) missing data. By specifying some partition file which contains only a subset of all sites, some sequence(s) might have all gaps. Such sequences will be removed from the analysis. So check the log file if IQ-TREE prints some WARNING. Also check if IQ-TREE prints any WARNING messages about identical sequences. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hello Minh, I'm sorry, no - in this case it was only a very small data set. I send you the files directy for diagnostics. All the best Dieter You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/Nkh6SIBL7_c/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com "]}, "y38mdXPgR6w": {"topic": "identical sequences not added at the end with the --no-outfiles option", "initializeDate": "Dec 1, 2018, 1:32:45 PM", "timeStamp": "Dec 3, 2018, 9:21:03 PM", "content": ["I got trees that were missing some tips when using the --no-outfiles option, but the problem is not systematic. The log says that the identical sequences that are ignored will be added back in the tree at the end, but there are not. To reproduce the issue, I am attaching 2 alignment files: \"a1\" has 24 tips (many identical to each other) and 400 base pairs. The problem occurs on this data set. The other data set \"a2\" is a toy data set with just 5 tips (the last 2 are identical) and 10 base pairs. The problem does not occur on that second data set. Below are shell commands to run IQ-TREE without and with the --no-outfiles option, and then commands to count the number of commas in the output trees, which relates to the number of tips in these output trees. Tips are kicked out on the first data set with the --no-outfiles option. iqtree s a1 phy djc m HKY pre trial11 iqtree s a1 phy djc m HKY pre trial12 outfiles grep \",\" trial11 treefile # 23 grep \",\" trial12 treefile # 5 iqtree s a2 phy djc m HKY pre trial21 iqtree s a2 phy djc m HKY pre trial22 outfiles grep \",\" trial21 treefile # 4 grep \",\" trial22 treefile # 4 Thanks! C\u00e9cile. ", "Hi Cecile, Please do not use --no-outfiles. This option will turn off writing .log, .treefile and .iqtree file. So IQ-Tree is supposed not to print .treefile here. I don\u2019t know why that still happened, quite likely just some intermediate (partial) tree. That\u2019s the reason. A couple of other options to turn off specific files: --no-log disables .log file --no-iqtree disables .iqtree file --no-uniqueseq disables .uniqueseq.phy file Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <a1.phy> <a2.phy> ", "Thank you Minh! "]}, "mi7qaVaEOAk": {"topic": "IQ tree 1.6.1 seems to hang with complex models ( +C10 - up to +C60)", "initializeDate": "Mar 7, 2018, 12:12:17 PM", "timeStamp": "Mar 7, 2018, 5:07:20 PM", "content": ["Hi, We are seeing IQ-Tree 1.6.1 hang (apparently, anyhow, it stops writing, but thinks it is running) when we run protein and dna models that include +C10 up to +C60. Here is an examplar command line Command rendered successfully: iqtree_1.6.1_comet -s infile.txt -st AA -m LG+C60+F -pre output -ft guidetree.tre -nt AUTO The same run, with the +C60 removed, runs quickly (like 5 minutes). As I understand it, the -ft <file> option invokes the PMSF model (?). It hangs whether or not we include the -ft <filename> flag, and with both DNA and AA. I wonder if you have any suggestions for us. An example stdout.txt file is below. It writes this initially and then stops until the job times out. We have given it up to 72 hours to write. OMP_NUM_THREADS=12 Running: -s infile.txt -bb 1000 -alrt 1000 -wbt -wspm -st AA -wsr -m LG+F+R8+C60 -pre output -nt AUTO iqtree -s infile.txt -bb 1000 -alrt 1000 -wbt -wspm -st AA -wsr -m LG+F+R8+C60 -pre output -nt AUTO IQ-TREE multicore version 1.6.1 for Linux 64-bit built Jan 12 2018 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: comet-03-56.sdsc.edu (AVX2, FMA3, 125 GB RAM) Command: iqtree -s infile.txt -bb 1000 -alrt 1000 -wbt -wspm -st AA -wsr -m LG+F+R8+C60 -pre output -nt AUTO Seed: 651802 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Fri Mar 2 10:01:34 2018 Kernel: AVX+FMA - auto-detect threads (24 CPU cores detected) Reading alignment file infile.txt ... Phylip format detected Alignment most likely contains protein sequences Alignment has 49 sequences with 84810 columns, 78214 distinct patterns 67886 parsimony-informative, 7178 singleton sites, 9746 constant sites Gap/Ambiguity Composition p-value 1 Rhizophagus_irregularis 9.96% failed 0.00% 2 Salpingoeca_kvevrii 6.07% failed 0.00% 3 Pygsuia_biforma 33.56% failed 0.00% 4 Ustilago_maydis 6.71% failed 0.00% 5 Thecamonas_trahens 8.25% failed 0.00% 6 Fonticula_alba 14.21% failed 0.00% 7 Monosiga_brevicollis 11.90% failed 0.00% 8 Anncaliia_algerae 45.18% failed 0.00% 9 Vavraia_culicis 18.52% failed 0.00% 10 Creolimax_fragrantissima 3.92% failed 0.00% 11 Blastocladiella_britannica 27.21% failed 0.00% 12 Edhazardia_aedis 20.25% failed 0.00% 13 Allomyces_macrogynus 1.98% failed 0.00% 14 Lichtheimia_hyalospora 24.06% failed 0.00% 15 Amoebidium_parasiticum 5.65% failed 0.00% 16 Enterocytozoon_bieneusi 23.90% failed 0.00% 17 Parvularia_atlantis 30.96% failed 0.00% 18 Saitoella_complicata 2.33% failed 0.00% 19 Nematostella_vectensis 3.85% failed 0.00% 20 Pseudoloma_neurophilia 38.59% failed 0.00% 21 Mucor_circineloides 6.09% failed 0.00% 22 Mitosporidium_daphniae 19.40% failed 0.00% 23 Xenopus_tropicalis 4.69% failed 0.00% 24 Amphiamblys_sp_WSBS2006 13.93% failed 0.00% 25 Nematocida_parisii 12.35% failed 0.00% 26 Sphaerothecum_destruens 13.00% failed 0.00% 27 Gonapodya_prolifera 4.04% failed 0.00% 28 Phanerochaete_chrysosporium 26.54% failed 0.00% 29 Nosema_ceranae 18.59% failed 0.00% 30 Spizellomyces_punctatus 3.09% failed 0.00% 31 Rozella_allomycis 4.69% failed 0.00% 32 Didyomeca_costata 4.41% failed 0.00% 33 Schizosaccharomyces_pombe 1.55% failed 0.00% 34 Antonospora_locustae 40.17% failed 0.00% 35 Capsaspora_owczarzaki 6.23% failed 0.00% 36 Paramicrosporidium_saccamoebae 12.11% failed 0.00% 37 Ordospora_colligata 17.59% failed 0.00% 38 Catenaria_anguillulae 5.15% failed 0.00% 39 Mortierella_verticillata 1.65% failed 0.00% 40 Vittaforma_corneae 17.67% failed 0.00% 41 Trachipleistophora_hominis 34.30% failed 0.00% 42 Amphimedon_queenslandica 13.18% failed 0.00% 43 Coemansia_reversa 2.22% failed 0.00% 44 Conidiobolus_coronatus 7.48% failed 0.00% 45 Batrachochytrium_dendrobatidis 4.97% failed 0.00% 46 Encephalitozoon_intestinalis 15.16% failed 0.00% 47 Paraphelidium_tribonemae 5.18% failed 0.00% 48 Ministeria_vibrans 13.52% failed 0.00% 49 Corallochytrium_limacisporum 80.98% failed 0.00% WARNING: 1 sequences contain more than 50% gaps/ambiguity **** TOTAL 15.24% 49 sequences failed composition chi2 test (p-value<5%; df=19) Create initial parsimony tree by phylogenetic likelihood library (PLL)... 4.801 seconds Generating 1000 samples for ultrafast bootstrap (seed: 651802)... Model LG+F+R8+C60 is alias for LG+F+R8+POISSON+G+FMIX{C60pi1:1:0.0169698865,C60pi2:1:0.0211683374,C60pi3:1:0.0276589079,C60pi4:1:0.0065675964,C60pi5:1:0.0141221416,C60pi6:1:0.0068774834,C60pi7:1:0.0146909701,C60pi8:1:0.0067225777,C60pi9:1:0.0018396660,C60pi10:1:0.0102547197,C60pi11:1:0.0230896163,C60pi12:1:0.0057941033,C60pi13:1:0.0125394534,C60pi14:1:0.0204526478,C60pi15:1:0.0070629602,C60pi16:1:0.0117982741,C60pi17:1:0.0068334668,C60pi18:1:0.0433775839,C60pi19:1:0.0318278731,C60pi20:1:0.0222546108,C60pi21:1:0.0102264969,C60pi22:1:0.0150545891,C60pi23:1:0.0134159878,C60pi24:1:0.0148552065,C60pi25:1:0.0239111516,C60pi26:1:0.0128776278,C60pi27:1:0.0222318842,C60pi28:1:0.0247444742,C60pi29:1:0.0214274810,C60pi30:1:0.0115001882,C60pi31:1:0.0076017389,C60pi32:1:0.0130258568,C60pi33:1:0.0093701965,C60pi34:1:0.0467194264,C60pi35:1:0.0441940314,C60pi36:1:0.0322263154,C60pi37:1:0.0402999891,C60pi38:1:0.0150234227,C60pi39:1:0.0104589903,C60pi40:1:0.0214742395,C60pi41:1:0.0154957836,C60pi42:1:0.0101789953,C60pi43:1:0.0227980379,C60pi44:1:0.0123204539,C60pi45:1:0.0066777583,C60pi46:1:0.0004150083,C60pi47:1:0.0344385130,C60pi48:1:0.0113663379,C60pi49:1:0.0127143049,C60pi50:1:0.0124323741,C60pi51:1:0.0262124415,C60pi52:1:0.0064994957,C60pi53:1:0.0103203293,C60pi54:1:0.0142463512,C60pi55:1:0.0215600067,C60pi56:1:0.0199150700,C60pi57:1:0.0038964200,C60pi58:1:0.0113448855,C60pi59:1:0.0128595846,C60pi60:1:0.0117656776} ", "Sorry, it seems this bug is the same reported previously, but I overlooked it. When C60 is run alone, it progresses fine. I noticed it is resolved, so perhaps we just need to get v 1.6.2? Mark ", "Hi Mark, Yes please update v1.6.2, which fixes this bug. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "ynvzVhakiok": {"topic": "*** IQ-TREE CRASHES WITH SIGNAL ABORTED", "initializeDate": "Jan 9, 2020, 4:43:51 AM", "timeStamp": "Jan 21, 2020, 7:49:20 PM", "content": ["Hi, I am getting an error when I try to run ancestral state reconstruction. I've attached fasta and output files. Thanks, Jody ", "Hi Jody, Thanks for reporting the bug. It seems to be due to the combination of -asr option and the +ASC model. As seen from the log file, the best model is TIM+F+ASC+R3 . Can you please rerun and avoid this model by adding option: -m TIM+F+R3. Let me know if that works. Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/157f58a4-3403-4d29-83ad-d10b809c00e5%40googlegroups.com <test.zip> "]}, "Bpwxfz1qfHo": {"topic": "stop job", "initializeDate": "Aug 20, 2019, 4:23:35 AM", "timeStamp": "Aug 21, 2019, 2:10:31 AM", "content": ["Hi, I would like to know if there is a way to stop a submitted job in the web server, either if it is running or waiting. Thank you for your help, Carolina ", "Hi Carolina, There is no such option, only the admin has the permission to manually delete the user-submitted jobs. If you really want to have your job deleted, please let me know, and I\u2019ll ask the admin. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/be7d58d6-ce3d-4dc8-9cc3-7c59a0b7fdde%40googlegroups.com "]}, "rArD7aYF45E": {"topic": "output quartet mapping from prefined groups", "initializeDate": "Mar 14, 2017, 8:21:21 AM", "timeStamp": "Mar 24, 2017, 9:53:58 AM", "content": ["Hi all, I am doing quite a lot foul cluster likelehood analyses (quatzed mapping) to test signals / hypotheses. What is very nice that e.g. the output for each species is recorded: e.g. Quartet support of areas 1-7 (mainly for clustered analysis): resolved partly unresolved name #quartets 1 (% 1) 2 (% 2) 3 (% 3) 4 (% 4) 5 (% 5) 6 (% 6) 7 (% 7) ------------------------------------------------------------------------------------------------------------------------------------------------ 1 320 228 (71.25 ) 64 (20.00 ) 24 (7.50 ) 1 (0.31 ) 1 (0.31 ) 2 (0.62 ) 0 (0.00 ) SpeciesA I am in particular interested in rsions 1, 2 and 3. I looked at the log file, the quartetlikelihoods etc. If I have not only one topology, but several suportet (like here) is there any way to find out what quartets (so which species) support region 1, resectively 2 and 3? e.g. list numbers (that can be traced back to) species names? This would be very very helpfull to properly interpret results. So how can I extract quartets in region 1, 2, 3 to check what species they represent? many thanks, best Karen karen ", "Hi Karen, I briefly talked with Heiko about this, but seems that some coding is needed as there is no direct option to help with this. What you can do right now is use option -wql to print the log-likelihoods of all 3 quartets for any 4 species. From this, you can extract all quartets that contain your species of interest, and then whether it belongs to the 3 corners. But this may need some scripting (e.g. in R) to process this file\u2026 Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, thanks - would be highly appreciate :) !! Anyway, I fortunately i alreay \"-wql\" an looked at the file \"fclm_hypo1_permIII.lmap.quartetlh\" receiving e.g. this SeqIDs lh1 lh2 lh3 weight1 weight2 weight3 (89,98,9,82) -7.08158e+06 -7.08158e+06 -7.08155e+06 1.76829e-12 8.94193e-11 1 (89,98,9,71) -7.08151e+06 -7.08151e+06 -7.0815e+06 0.00539908 2.85129e-06 0.994598 I struggled since I don't get what weight 1, 2, 3 mean: does the \"weight\" indicate the corners, so for the 2 quartets belong to region 3 (because weight 3 have the value 1 (or close do 1?)) If so, are weights referring to the regions 1, 2, 3 (out of 7) or to either a1, a2, a3? If you help me to understand the results how I conclude from numbers e.g. in which region each quartet was mapped, would be very helfull though :) - for further scripting. Thanks a lot Karen ", "Hi Karen, Heiko can correct me if I am wrong. But as far as I understood, each line contains the IDs of four sequences, say (A,B,C,D). SeqID 1 corresponds to the first sequence in the aligmment, etc. Then the next 3 numbers are the log-likelihoods of 3 quartets: AB|CD, AC|BD, AD|BC. The last 3 numbers are the weights of these quartets. You can base on these weights to decide which corner of the triangle the quartet falls into. The two lines you posted: SeqIDs lh1 lh2 lh3 weight1 weight2 weight3 (89,98,9,82) -7.08158e+06 -7.08158e+06 -7.08155e+06 1.76829e-12 8.94193e-11 1 (89,98,9,71) -7.08151e+06 -7.08151e+06 -7.0815e+06 0.00539908 2.85129e-06 0.994598 have weight3 of 1 or nearly 1. So they belong to the corner correspoding to quartet AD|BC. However, I don\u2019t know the exact criterion for the 3 weights to decide on this. But Heiko can help you, or you can also read the original paper http://www.pnas.org/content/94/13/6815.full.pdf ;-) Minh ", "Hi Karen, > thanks - would be highly appreciate :) !! > Anyway, I fortunately i alreay \"-wql\" an looked at the file \"fclm_hypo1_permIII.lmap.quartetlh\" > receiving e.g. this > SeqIDs lh1 lh2 lh3 weight1 weight2 weight3 > (89,98,9,82) -7.08158e+06 -7.08158e+06 -7.08155e+06 1.76829e-12 8.94193e-11 1 > (89,98,9,71) -7.08151e+06 -7.08151e+06 -7.0815e+06 0.00539908 2.85129e-06 0.994598 > I struggled since I don't get what weight 1, 2, 3 mean: > does the \"weight\" indicate the corners, so for the 2 quartets belong to region 3 (because weight 3 have the value 1 (or close do 1?)) > If so, are weights referring to the regions 1, 2, 3 (out of 7) or to either a1, a2, a3? The weight refers to the likelihood weights (or posterior weights or posterior probability assuming a uniform prior), that means is the likelihood (not the log-likelihood!) of that corresponding quartet divided by the sum of the 3 likelihoods. Hence, these 3 weights should add up to 1.0 (ignoring rounding errors). The weights are closest to (1,0,0), (0,1,0) or (0,0,1) they reflects the three corner regions (as in your example), if the three weights are closest to (0, .5, .5), (.5, 0, .5), (.5, .5, 0) it is one of the partly resolved quartets, and in the seventh case, i.e. closest to (1/3, 1/3, 1/3) it is an unresolved quartet. They determine as coordinates exactly where the dot falls in 3D, and thus in the triangular simplex plot. More information can be found in any of the documents describing likelihood mapping in the context of TREE-PUZZLE like Strimmer+von Haeseler (1997, PNAS, the original likelihood mapping article), Schmidt+von Haeseler (2003/2007, in Current Protocols in Bioinformatics), Schmidt+von Haeseler (2009, in The Phylogenetic Handbook) or the TREE-PUZZLE manual. > If you help me to understand the results how I conclude from numbers e.g. in which region each quartet was mapped, would be very helfull though :) - for further scripting. The indices describing the quartet refer to the sequences in the order they are in the alignment. Full names in files with n^4 quartets would take by far too much extra space. I hope I could help. Best wishes, Heiko ", "Hi Heike and Minh, first many thanks - I have still few questions (sorry) The weight refers to the likelihood weights (or posterior weights or posterior probability assuming a uniform prior), that means is the likelihood (not the log-likelihood!) of that corresponding quartet divided by the sum of the 3 likelihoods. okay Hence, these 3 weights should add up to 1.0 (ignoring rounding errors). The weights are closest to (1,0,0), (0,1,0) or (0,0,1) they reflects the three corner regions (as in your example), if the three weights are closest to (0, .5, .5), (.5, 0, .5), (.5, .5, 0) it is one of the partly resolved quartets, and in the seventh case, i.e. closest to (1/3, 1/3, 1/3) it is an unresolved quartet. They determine as coordinates exactly where the dot falls in 3D, and thus in the triangular simplex plot. Yes thanks - I am aware and also do unterstand the 3D simplex plot graph and how this works. More information can be found in any of the documents describing likelihood mapping in the context of TREE-PUZZLE like Strimmer+von Haeseler (1997, PNAS, the original likelihood mapping article), Schmidt+von Haeseler (2003/2007, in Current Protocols in Bioinformatics), Schmidt+von Haeseler (2009, in The Phylogenetic Handbook) or the TREE-PUZZLE manual. Still it would be great if I know the values (borders) (weights) for e.g. the Voronoi cell T1 (T2, T3...), ideally for all, but for now I am only interested in the resolved parts of the graphs. (Graphically borders are the lines deviding the simplex graph into the 7 Voronoi cells..., but in numbers?. Knowing that I could extract only those laying in the 3 resolved parts. Background: I am interested if there are special \"taxa combinations\" from always e.g. in T3: lets say, I have 16 taxa (4 groups), and all quartets alre in T1 except for those having taxa 14, 15, 16. (I can here track back the numbers, since the IDs are in the log file as well). The indices describing the quartet refer to the sequences in the order they are in the alignment. Full names in files with n^4 quartets would take by far too much extra space. Yeah understand. Anyway, if you have a good idea how to summarize this or so in a next version would be appreciated... Many thanks in advance Karen ", "Hi Heiko, can you please answer my last questions please if possible ? You can also email me privately of course. Many thanks Karen ", "> Still it would be great if I know the values (borders) (weights) for e.g. the Voronoi cell T1 (T2, T3...), ideally for all, but for now > I am only interested in the resolved parts of the graphs. (Graphically borders are the lines deviding the simplex graph into the 7 Voronoi cells..., but in numbers?. Actually we never computed the exact course of the borders (neither in TREE-PUZZLE nor in IQ-Tree) , because they are not needed for the decision into which area a dot falls. This is determined by computing the Euclidean distance to the 7 centres of gravity (1,0,0), (0,1,0), (0,0,1), (0,.5,.5) ... (1/3,1/3,1/3) and choosing the one with the smallest distance. Since you mention Voronoi - the borders are of course geometrically well defined since we use the Euclidean distance. The are crossing the direct line between the two neighbouring centres of gravity (also know as points or seeds) exactly rectangular and equidistant (i.e. in the middle) to both points. From that crossing point the borderline is extended until it meets another border. I hope that helps a little. > Knowing that I could extract only those laying in the 3 resolved parts. Background: I am interested > if there are special \"taxa combinations\" from always e.g. in T3: lets say, I have 16 taxa (4 groups), and all quartets alre in T1 except for those having taxa 14, 15, 16. (I can here track back the numbers, since the IDs are in the log file as well). Easier than trying to figure out whether a dot is right or left of a border would be to currently compute the Euclidean Distance again and keep those for which the weights are closest to (1,0,0), (0,1,0) or (0,0,1). However, it might interest you that we think about adding the resulting regions (1-7) and areas (a1-a3) to the -wql output file ;) Best wishes, Heiko ", "Hi Minh and Heiko, >Easier than trying to figure out whether a dot is right or left of a border would be to currently compute the Euclidean Distance again and keep those for which the weights are >closest to (1,0,0), (0,1,0) or (0,0,1). yes, true!!! >However, it might interest you that we think about adding the resulting regions (1-7) and areas (a1-a3) to the -wql output file ;) oh - :) :) I highly appreciate that as this would be exactly what I need (I think) - so I have a info about this for every quartet! Looking fw and I am also available for testing if you like! Best, Karen "]}, "kn24r02PKwU": {"topic": "SNPs with IUPAC coding", "initializeDate": "Aug 21, 2016, 8:10:45 PM", "timeStamp": "Sep 7, 2020, 7:29:18 PM", "content": ["Hi, I'm trying to make a simple phylogeny with SNPs. For heterozygous sites I've coded them using IUPAC coding. When I try to run IQtree with ascertainment bias and model testing, it thinks that there are protein sequences (even if I specify that it is DNA) and does not run. I can run it, if I don't use the ascertainment bias option. This happens both on my own computer and on the webserver. I've attached fasta file for reference. Is there a way to make it work with ascertainment bias or is this a bug? Thanks, Greg Owens ", "Also, when I run it without ascertainment bias, I don't think it is actually using the ambiguous base coding because in the log it says that 45% of sites are constant, while none of them really are. I suspect its treating ambiguous bases as missing data. ", "Dear Greg, For your data, there are many ambiguous bases and that\u2019s why IQ-TREE could not detect the right data type. Thus pls use -st DNA option to force DNA data type. Moreover, you had a good point about ascertainment bias correction (ASC). Right now IQ-TREE defines 3 types of constant sites: 1. AAAAAA (only As) 2. AANNAA or C--C-CC 3. CSCCCC (because S is G or C) However, now on a more careful thought, I think the 3rd type should not be the constant site. Only the 1st and 2nd are valid constant sites. Is that right? Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Specifying that it is DNA does stop the program from thinking that it is a protein sequence, but still doesn't fix the issue of letting me use the ascertainment bias option. I agree with you, the third category shouldn't be considered constant. I think that is the issue that I am having, because for many sites, the alternate allele is only represented as a heterozygote. Thus IQ-TREE thinks it is constant and rejects ascertainment bias correction. Thanks for your help, Greg ", "Dear Greg, On the 3rd thought: On the one hand, it is true that CSCCCC is not a constant site. On the other hand, in the presence of such sites, no ascertainment bias correction should be performed because they distort the numerics. In fact when I changed the code to allow ASC, I obtained positive log-likelihood for your data, which should not happen. Then I found this paper http://sysbio.oxfordjournals.org/content/64/6/1032.long , where this observation is exactly stated in the supplement ( http://datadryad.org/bitstream/handle/10255/dryad.94959/SupplementMaterials.pdf?sequence=1 \"Note that, for mathematical reasons, all sites i = 1...n need to be variable. That is, if the alignment on which we compute ln(L) also contains some invariant sites, the above equation may return positive log likelihood values.\u201d They denoted such sites as invariant, which is superset of constant sites. I hope that helps to clarify things now. In summary, no ASC correction should be applied to your data set. Minh ", "Hi Minh, Sorry for reply to such an old topic. I'm wondering the differences between \"ambiguous characters\" and \"heterozygous sites\" in IQ-TREE2. By definition, \"ambiguous\" refers to a site that is uncertain while \"heterozygous\" is a certain state. So that they are not the same when calculate likelihood, am I right? Thanks for your time. Sen ", "Hi Sen, Both IQ-TREE 1 and 2 will treat them as ambiguous characters, explained here: http://www.iqtree.org/doc/Frequently-Asked-Questions#how-does-iq-tree-treat-gapmissingambiguous-characters , as output from sequencer that we\u2019re not sure if that position is an A or C, thus encoded as M. So this is different from heterozygous sites. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b3729200-9b05-4051-b39b-f8eb672193c2n%40googlegroups.com "]}, "DoaoCRoNH_o": {"topic": "Parallel IQ-TREE with MPI", "initializeDate": "Aug 23, 2016, 4:06:05 AM", "timeStamp": "Aug 23, 2016, 4:06:05 AM", "content": ["Dear IQ-TREE users, We would like to announce a new MPI parallel version of IQ-TREE for use in computer cluster. In addition to the existing OpenMP parallelization that distributes the tree likelihood computation among CPU cores, IQ-TREE now can employ MPI to distribute the tree search among different computing nodes. The MPI version of IQ-TREE provides better parallel efficiency than OpenMP and can also be used within a multi-core PC (only Linux and Mac OS X are supported). Note that the memory requirement of the MPI version is proportional to the number of processes. Thus, to avoid excessive memory consumption one can also combine OpenMP and MPI in IQ-TREE (this is called hybrid parallelization). Information about how to compile and run the program can be found in our documentation page Best regards, IQ-TREE development team "]}, "3kZMcYpEF5I": {"topic": "Difference between web server and command line based IQ Tree", "initializeDate": "Aug 12, 2020, 7:11:01 AM", "timeStamp": "Aug 17, 2020, 3:01:46 AM", "content": ["Hello, I am curious to know how is ML analysis on IQ Tree web server different from command line based version. Does command line based analyses provide any extra information? I often see research publications are using command line approach to run the ML analyses. Best ", "HI RJ, I believe the web server offers version 1.6.12. The command line version and a web version should provide the same outcome: in the background, the web server will call the command line version of IQ-TREE. But there are several restrictions such as the web server only runs IQ-TREE with single thread, provides a limited set of options, and restricts to small datasets where runtime does not exceed 1 day and RAM usage < 1GB. Many publications use the command line because they have large datasets, also due to confidential reason. We of course do not share the data, and actually delete files older than 6 months. And frankly: I personally prefer the command line, it\u2019s actually faster, once you get used to that. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/fdf37f1a-d77d-4fa1-8101-b6277ebd6a3eo%40googlegroups.com ", "Hello Minh, Thank you very much for the information. On Friday, August 14, 2020 at 6:08:48 AM UTC+5:30, Minh Bui wrote: HI RJ, I believe the web server offers version 1.6.12. The command line version and a web version should provide the same outcome: in the background, the web server will call the command line version of IQ-TREE. But there are several restrictions such as the web server only runs IQ-TREE with single thread, provides a limited set of options, and restricts to small datasets where runtime does not exceed 1 day and RAM usage < 1GB. Many publications use the command line because they have large datasets, also due to confidential reason. We of course do not share the data, and actually delete files older than 6 months. And frankly: I personally prefer the command line, it\u2019s actually faster, once you get used to that. Cheers Minh On 12 Aug 2020, at 9:11 pm, RJ < ranjana...@gmail.com > wrote: Hello, I am curious to know how is ML analysis on IQ Tree web server different from command line based version. Does command line based analyses provide any extra information? I often see research publications are using command line approach to run the ML analyses. Best You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "i1ujp3iWDJY": {"topic": "Problem with AU test in 1.6.12", "initializeDate": "Mar 5, 2020, 9:33:45 AM", "timeStamp": "Mar 6, 2020, 9:11:11 AM", "content": ["Hello -- I seem to have run into a bug when running the AU test. I have a very large number of credible trees that I am trying to compare, but that doesn't seem to be the problem, because the KH, SH, wKH and wSH tests seem to have worked fine here (and worked fine and gave reasonable results in some previous runs I did). When I try to run the AU test, though, IQ-TREE crashes. I can rerun the analysis and simply use the SH or wSH results, but it would be great to get AU test results, too. Any suggestions would be appreciated! Thanks! Andy --- First several lines of log file: CHECKPOINT: Resuming analysis from C50-B1-out.ckp.gz IQ-TREE MPI multicore version 1.6.12 for Linux 64-bit built Dec 20 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: compute3 (AVX512, FMA3, 93 GB RAM) Command: iqtree-mpi -nt 24 -z C50-B1.noGali.credibleset.tre -s C50-B1.noGali.phy -spp C50-B1.partitions.txt -zw -au -zb 10000 -st AA -t BIONJ -pre C50-B1-out Seed: 321527 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Feb 19 10:04:42 2020 Kernel: AVX+FMA - 24 threads (24 CPU cores detected) MPI: 4 processes Last several lines of log file: Performing RELL-BP test... Performing KH and SH test... Computing pairwise logl difference variance ... Performing WKH and WSH test... Performing ELW test... Performing approximately unbiased (AU) test... 18024 MB required for AU test ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 5 __gnu_cxx::__verbose_terminate_handler() ERROR: 6 () ERROR: 7 () ERROR: 8 __cxa_rethrow() ERROR: 9 operator new(unsigned long) ERROR: 10 performAUTest(Params&, PhyloTree*, double*, std::vector<TreeInfo, std::allocator<TreeInfo> >&) ERROR: 11 evaluateTrees(Params&, IQTree*, std::vector<TreeInfo, std::allocator<TreeInfo> >&, std::vector<int, std::allocator<int> >&) ERROR: 12 reportPhyloAnalysis(Params&, IQTree&, ModelCheckpoint&) ERROR: 13 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 14 main() ERROR: 15 __libc_start_main() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: C50-B1-out.log ERROR: *** Alignment files (if possible) I also found this in the output file generated by SLURM: Performing RELL-BP test... Performing KH and SH test... Computing pairwise logl difference variance ... Performing WKH and WSH test... Performing ELW test... Performing approximately unbiased (AU) test... 18024 MB required for AU test terminate called after throwing an instance of 'std::bad_alloc' what(): std::bad_alloc ", "Hi Andy, This looks like you don\u2019t have enough RAM for the AU test, these lines are relevant: 18024 MB required for AU test terminate called after throwing an instance of 'std::bad_alloc' what(): std::bad_alloc The bad_alloc message means that IQ-TREE couldn\u2019t allocate the RAM, although I notice that you have 93GB RAM. But other running processes may occupy the RAM\u2026 I suggest that you quickly re-run with \u201c-zb 1000\u201d, which will reduce the RAM requirement by 10-fold, compared with -zb 10000. If that works, then not enough RAM is indeed an issue. Let me know how it goes. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/821a7032-987c-4dbe-9206-3034fdd1ab77%40googlegroups.com ", "Yes, I thought that was odd, too -- I certainly seem to have more RAM than I need, but... -zb 1000 is a fairly quick test to run, so I will give it a go today. Thanks! FEA "]}, "bB9bGFSEvfw": {"topic": "Branch length interpretation", "initializeDate": "Apr 20, 2020, 3:30:17 PM", "timeStamp": "Oct 10, 2020, 8:28:09 AM", "content": ["Hi All, I have a morphological dataset (states 1,2,?) described by the MK+FQ+I+G4, my question is how does one interpret branch lengths. Substitutions (character state transitions) per site? Thanks Vinny ", "Hi Vinny, Fairly simple answer: yes, branch lengths are number of substitutions per site, just like for DNA, protein or other models. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7b266dcc-26ac-4fd6-a781-16d881bd8f30%40googlegroups.com ", "Hi Minh, I am wondering how to explain the morphological tree with branch length values over 1. I was using the command with iqtree2 -s Morph.phy -st MORPH -m MK -te species_tree.tre. And I obtain a result showing one species with an extremely long branch length (10). Thank you in advance! Best, Wenbin Zhou ", "Hi, Wenbin Zhou. (This answer in terms of DNA nucleotides, but the principles are the same for proteins and morophological data) Branch lengths indicate how many times, on average, each nucleotide is estimated to have changed, in the time since the species diverged. For a short branch length (a branch length close to zero, much less than one), that is almost the same as (is only a little more than): the number of differences that have accumulated since the species diverged, divided by the number of nucleotides in the alignment. But, as the number of substitutions increases, some of the substitutions change nucleotides back to what they were at the time of divergence (so they are no longer different!). Each time that happens, the number of substitutions increases by one, but the number of differences falls by one. So, as the number of substitutions increases (and the branch length goes up) the fraction of nucleotides that are different doesn't approach 1, but approaches a lower number (which depends on the substitution model). There's a graph showing what happens for another model (not the model you are using), on the Wikipedia page: https://en.wikipedia.org/wiki/Models_of_DNA_evolution . In that case (with the Jukes-Cantor model, the one shown in the graph), the fraction of nucleotides that differ is expected to eventually get very close to 0.75 (not 1). But, by the time they do, for the average site in the alignment, there have been multiple substitutions (many more than 0.75!). IQTree tends to limit branch lengths (to no more than 10). When branch lengths are as long as that (or longer), it is difficult to guess just how many nucleotide substitutions have occurred. Branch length estimates are derived by guessing how many of the nucleotides that are the same are the same because they haven't ever changed, by looking at how many more are the same than you'd expect to be the same, \"just by chance\" (from a randomly-generated genetic sequence). By the time you get to a branch length of 10, it is unlikely that there are many of those left! The \"similarity\" signal (for sites where no substitution has occurred) has become so degraded that it can no longer be distinguished from noise (sites, at which multiple substitutions have occurred, that are the same, merely due to chance). Regards, James To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8b042cc5-2a75-46e5-9a0c-93a7bd7e319dn%40googlegroups.com ", "Hi James, Thank you so much for the explain! Best regards, Wenbin To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1791742441.36775.1602308295372%40mail.yahoo.com "]}, "jf9_NRUj4Ms": {"topic": "Ascertainment bias correction", "initializeDate": "Feb 29, 2016, 11:15:33 PM", "timeStamp": "Mar 2, 2016, 7:31:46 AM", "content": ["I am trying to run an ML search with a ~45000 characters alignment for 60 taxa iqtree -s 14w_nox_IUPAC.nex -st DNA -m TESTNEW -bb 1000 -alrt 1000 but get the following error: \"ERROR: Invalid use of +ASC because constant patterns are observed in the alignment\". I have attached by datafile and by log file. Thanks! ", "Hi there, thanks for the report. This is a problem in how IQ-TREE decides the candidate models to consider. Your alignment has morphological data (please remove -st DNA in your command), then IQ-TREE automatically turns on +ASC model. However, it did not check that your alignment in fact contains constant patterns, causing this error message. I will correct this behavior. As a work around for now, please add the following option into your command line \u201c-mrate E,I,G,I+G,R\u201d. This should solve the problem. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout > <14w_nox_morph_new.nex><14w_nox_morph_new.nex.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "IsFDrKfoyRw": {"topic": "Tree topology test", "initializeDate": "Aug 18, 2020, 7:16:29 PM", "timeStamp": "Aug 31, 2020, 5:50:18 PM", "content": ["Hola! I am really excited to use this tool! I am trying to do a tree topology test (AU, SH, KH), however, the results show that there is no deltaL. Attached to this email are the files that I am using. It seems that I am doing something wrong in the construction of my constraint tree. Can you help me, please? Thank you so much! ", "Dear Marialejandra, Thank you for your interest in IQ-TREE and tree topology tests. However, I could not find any files attached to your message. Best wishes, Heiko > On 19 Aug 2020, at 01:16, Marialejandra Castro Farias < marialejandra...@gmail.com > wrote: > Hola! I am really excited to use this tool! I am trying to do a tree topology test (AU, SH, KH), however, the results show that there is no deltaL. Attached to this email are the files that I am using. It seems that I am doing something wrong in the construction of my constraint tree. Can you help me, please? Thank you so much! > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/bd7ee493-65b9-4db7-aec8-27ea965632d5n%40googlegroups.com ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Hola Heiko! Thank you for your quick response! I can not attach the files to my email (my matrix and my constraint tree). What type of files can I charge with you so that you can check my problem? ", "Hmm, right ;) First of all, please try to explain what exactly you want to do? Tree topology testing with KH, SH, AU etc tests whether likelihoods of trees might be significantly worse than those of other trees in the tested set of trees. This is independent of where your trees come from. This is not inherent to tree reconstructions with constraint trees. However, when using a constraint tree to reconstruct the phylogenetic tree of sequences, it is strongly recommended to also reconstruct trees without constraint and then test the trees. The reason is to prevent building self-fulfilling prophecies. That mean if your constraint tree has flaws, the best tree you obtain can be much worse that the best tree without constraints. In such case you cannot trust the result of the constraint tree search, because the data supports the unconstraint tree much more. What exaclty did you mean by \u201cthere is no deltaL\u201d? This should be the difference for every tree to the likelihood of the best tree in the set\u2026 and this should have always been computed (independent of the tests). Best wishes, Heiko > On 19 Aug 2020, at 05:57, Marialejandra Castro Farias < marialejandra...@gmail.com > wrote: > Hola Heiko! Thank you for your quick response! I can not attach the files to my email (my matrix and my constraint tree). What type of files can I charge with you so that you can check my problem? > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5924cfbd-ec12-4190-bf17-786db24cfa75n%40googlegroups.com ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs Campus Vienna Biocenter 5 (VBC5) A-1030 Vienna, Austria ----------------------------------------------------------------------------- Email: heiko.schmidt(AT) univie.ac.at Tel. : ++43 +1 / 4277 - 74321 http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Thank you, Heiko! I found what I was doing wrong! The way I was constructing the constraints was wrong! Thank you so much for your help! To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0E497369-466D-489C-A76F-BF7E1B10DD57%40univie.ac.at "]}, "MOQro1S0oxI": {"topic": "IQ-TREE release 1.5.6", "initializeDate": "Dec 4, 2017, 12:44:48 PM", "timeStamp": "Dec 4, 2017, 12:44:48 PM", "content": ["Dec 4, 2017 Dear users, IQ-TREE version 1.5.6 was just released. This version contains bugfixes and improves software stability for the 1.5.X series. \u2022 Improved numerical stability when some state is absent from the alignment, especially with codon or morphological data. \u2022 Allow reading morphological and codon model from file in PAML format. \u2022 Crash when number of partitions > 2^15 (reported by Adela RoaVaron). \u2022 In Windows: Exit gracefully instead of abort when input file does not exist. \u2022 Exit gracefully instead of segfault when log file cannot be written. \u2022 Crash when constraint tree contains identical sequence which was removed (reported by Russell Minton). \u2022 Exit gracefully instead of abort about too many threads for too short alignment. \u2022 Exit gracefully instead of abort when outgroup taxon (-o option) does not appear in alignment. \u2022 -mset option works with binary and morphological models. Kind regards, IQ-TREE development team "]}, "aBVRdM1ayvM": {"topic": "Re: [iqtree] How to optimize threads for large data set?", "initializeDate": "Jul 13, 2020, 8:41:42 PM", "timeStamp": "Jul 16, 2020, 11:20:12 PM", "content": ["Hi Daniel, The optimal number of threads depends on the number of site patterns, rather than the number of sites. Inside IQ-TREE (and all molecular phylogenetic software) we first compress the alignment into a list of unique site patterns and the number of times they are observed. So, the optimal number of threads will depend on how diverse your alignments are. Here\u2019s an example from some SARS-CoV-2 analyses I\u2019ve been running, which are very similar to yours (this is an old one, 33K sequences of 30kb each). IQ-TREE helpfully reports the number of unique site patterns after it loads the alignment: Alignment has 33317 sequences with 29718 columns, 21683 distinct patterns The optimal number of threads for this alignment is fairly small, somewhere around 4 (it was around 4 when I had 12K sequences, it could be a little higher now, I haven\u2019t checked for a while). When I had just 12K sequences, If I run this kind of alignment on 20 threads it got much slower (the reason for this is that the threads have to communicate with each other, and at some point the cross talk itself becomes the rate determining step). There are a couple of ways to figure out the optimal number of threads: use -nt AUTO and IQ-TREE will do it for you do it yourself, I usually do a pseudo-exponential distribution and hone in from there, something like running 5 analyses with 1, 2, 5, 10, and 20 threads, see which is quickest, and then act accordingly. How much effort you put into this obviously depends on how much you care to optimise things. Rob On Tue, 14 Jul 2020 at 10:15, Daniel Lesman < lesman...@gmail.com > wrote: I have ~50k samples that are ~25kb each, how would I determine the optimal number of CPUs to use when running this data set in order to ensure maximum speed? Is it just the more the better, or are these sequences short enough where there would be a point of diminishing returns? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d2b837f8-f47f-44ea-b9c6-9cdaa66ef4f9o%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Rob, Thank you so much for the advice, this is incredibly helpful! I am actually analyzing the SARS-CoV-2 data as well. Daniel On Monday, July 13, 2020 at 8:41:42 PM UTC-4, Rob Lanfear wrote: Hi Daniel, The optimal number of threads depends on the number of site patterns, rather than the number of sites. Inside IQ-TREE (and all molecular phylogenetic software) we first compress the alignment into a list of unique site patterns and the number of times they are observed. So, the optimal number of threads will depend on how diverse your alignments are. Here\u2019s an example from some SARS-CoV-2 analyses I\u2019ve been running, which are very similar to yours (this is an old one, 33K sequences of 30kb each). IQ-TREE helpfully reports the number of unique site patterns after it loads the alignment: Alignment has 33317 sequences with 29718 columns, 21683 distinct patterns The optimal number of threads for this alignment is fairly small, somewhere around 4 (it was around 4 when I had 12K sequences, it could be a little higher now, I haven\u2019t checked for a while). When I had just 12K sequences, If I run this kind of alignment on 20 threads it got much slower (the reason for this is that the threads have to communicate with each other, and at some point the cross talk itself becomes the rate determining step). There are a couple of ways to figure out the optimal number of threads: use -nt AUTO and IQ-TREE will do it for you do it yourself, I usually do a pseudo-exponential distribution and hone in from there, something like running 5 analyses with 1, 2, 5, 10, and 20 threads, see which is quickest, and then act accordingly. How much effort you put into this obviously depends on how much you care to optimise things. Rob On Tue, 14 Jul 2020 at 10:15, Daniel Lesman < lesman...@gmail.com > wrote: I have ~50k samples that are ~25kb each, how would I determine the optimal number of CPUs to use when running this data set in order to ensure maximum speed? Is it just the more the better, or are these sequences short enough where there would be a point of diminishing returns? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d2b837f8-f47f-44ea-b9c6-9cdaa66ef4f9o%40googlegroups.com ", "Hi Daniel, If you're working on SARS-CoV-2, you might be interested in this repository: https://github.com/roblanf/sarscov2phylo It has a lot of information on what I've found to work best for these data. Of note is that we (well, mostly James Barbetti and Minh, I cheer from the sidelines and do a lot of benchmarking) are working hard on improving various aspects of IQ-TREE for these sequences. I'll be keeping track of what works in the various tree_estimation.md files you'll see there. If you have ideas to share, please let me know via the issue tracker on that repo. The idea is to build up a comprehensive picture of best practice. Rob To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6c773943-fd49-410d-88fb-46e24fcdb7a5o%40googlegroups.com ", "Hi Rob, Thank you again for the help, your global phylogenetic tree is very interesting. I have actually been trying to run the nextstrain pipeline on the global data set and running into serious computational bottlenecks in the tree assembly. Are any of your tree outputs perhaps compatible with the Augur pipeline? Best, Daniel To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmpRO3tqVWZ2xCwhKC-uKyKn8PYnw58wkPj%3Dg6wVVibAUQ%40mail.gmail.com ", "Hi Daniel, Since Augur is in principle method agnostic (it just needs a tree) I think everything should be compatible. Rob To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAEJL0BTSW54DZb%3DN_BgJL%3DdBa0NtaA1HR3bzRawxN5QqTsd46w%40mail.gmail.com "]}, "v-v_y2KKd48": {"topic": "Compare tree phylogenies calculated using different models", "initializeDate": "Jun 17, 2019, 8:40:08 AM", "timeStamp": "Jun 26, 2019, 11:40:37 PM", "content": ["Hello, I have two trees calculated using different models (LG+I+R15 , and LG+C20+G). The C20 tree has higher Log-likelohood of consensus tree ( \u2011702686.401 comparing to \u2011705517.838 ), even though ModelFinder was showing much better fit for R15 model. > I would like to specify if this difference is meaningfull. How could I do it? > I guess, that I could calculate AIC by hand, and it would be a good indicator, but for this i need the number of parameters used in these models. How could I find out the number of parameters? Thank you in advance, Sincerely Michal Malszycki ", "Hi Michal, On 17 Jun 2019, at 8:40 am, Michal Malszycki < michal.m...@gmail.com > wrote: Hello, I have two trees calculated using different models (LG+I+R15 , and LG+C20+G). The C20 tree has higher Log-likelohood of consensus tree ( \u2011702686.401 comparing to \u2011705517.838 ), even though ModelFinder was showing much better fit for R15 model. Did you include LG+C20+G model in the model selection, or are they the log-likelihoods from two different runs? But given this huge gain in log-likelihood, I\u2019d use the LG+C20+G model. > I would like to specify if this difference is meaningfull. How could I do it? You can look at the AIC/BIC score of the two models. The model with lower BIC score should be preferred. In the literature, BIC difference of >10 units can be considered \u201csignificant\u201d. > I guess, that I could calculate AIC by hand, and it would be a good indicator, but for this i need the number of parameters used in these models. How could I find out the number of parameters? Ah OK, you already know the answer. You can look at .iqtree file. It reports log-likelihood, number of parameters and even AIC, AICc and BIC. Something like this: Log-likelihood of the tree: -22669.6911 (s.e. 344.6960) Unconstrained log-likelihood (without tree): -11402.5956 Number of free parameters (#branches + #model parameters): 43 Akaike information criterion (AIC) score: 45425.3822 Corrected Akaike information criterion (AICc) score: 45427.3187 Bayesian information criterion (BIC) score: 45666.1779 Cheers, Minh Thank you in advance, Sincerely Michal Malszycki You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0757bf09-68a1-44cf-b363-63359a6cbad5%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Thank you for the answer. I know now everything i need. For your question: in my case model finder found -lnL for R10: 711875.431 and C20: 731206.120 (with Information criteria strongly better for R10). Dataset I was calculating consisted of 4100 sequences one gene (260 aminoacids after pruning). C20 in the end calculated much more complicated phylogeny with lower node support (propably because the alignment was too short). Sincerely, Micha\u0142 Ma\u0142szycki ", "Ah ok, I didn\u2019t know that you have only one short gene. In that case, please do not use C20 or other CAT models, which are only designed for phylogenomic alignments. For short alignments, such models are over-parameterised. Cheers, Minh "]}, "7OWP3b-rgcI": {"topic": "ERROR- version 1.6.6- topology test", "initializeDate": "Jul 5, 2018, 11:20:55 PM", "timeStamp": "Jul 9, 2018, 8:52:35 AM", "content": ["Dear Developers, I observed the following warning while using v1.6.6 to perform topology test Generating 10 x 10000 multiscale bootstrap replicates... terminate called recursively terminate called after throwing an instance of 'std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >ERROR: ' Using lower version, the test was done without error. Thank you! Best regards, Giap Nguyen ", "Dear Giap, Thanks for the quick report, I also noticed that problem. However, right now I suggest that you use CONSEL. You can export site log-likelihoods to .sitelh file using -wsl option, and then input this file into CONSEL (choosing tree-puzzle format). Some users reported problem with the AU implementation in IQ-TREE, that the p-values look problematic for trees that have very similar log-likelihoods with the ML tree. But that remains to be investigated as I don\u2019t really have the time right now. Sorry for the inconvenience. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "OZEytUbi-8A": {"topic": "Workshop on Molecular Evolution, Woods Hole, 2020", "initializeDate": "Dec 20, 2019, 7:26:54 AM", "timeStamp": "Dec 20, 2019, 7:26:54 AM", "content": ["Dear Users, IQ-TREE will be taught as part of the renown workshop on molecular evolution next year. So it\u2019s a good opportunity to have hands-on experience with it and many other cool software. The details below: The 2020 Workshop on Molecular Evolution at the Marine Biological Laboratory in Woods Hole, Massachusetts, USA, will be held *** MAY 31 to JUNE 10 *** (note that this is earlier than past years). Founded in 1988, the Workshop on Molecular Evolution is the longest-running workshop of its kind. The Workshop is the premier program for integrating the methods, theory, and applications of molecular phylogenetics, statistical genetics, molecular evolution, and related disciplines. Students work closely with internationally-recognized scientists, receiving (i) high-level instruction in the principles of molecular evolution, phylogenetic inference, and evolutionary genomics, (ii) advanced training in statistical methods best suited to modern datasets, and (iii) hands-on experience with the latest software tools (often from the authors of the programs they are using). The material is delivered via lectures, discussions, and bioinformatic exercises motivated by contemporary topics in molecular evolution. A hallmark of this workshop is the direct interaction between students and field-leading scientists. The workshop serves graduate students, postdocs, and established faculty from around the world seeking to apply the principles of molecular evolution to questions of both basic and applied biological sciences. A priority of this workshop is to foster an environment where students can learn from each other as well from the course faculty. As the course progresses, participants learn how to use the following software to address questions concerning the origins, maintenance, and function of molecular variation: ASTRAL, BEST, FASTA, FigTree, IQTree, MIGRATE, MAFFT, MP-EST, RaxML, RevBayes, PAML, PAUP*, SVD Quartets, and SNaQ. Students will have the opportunity to work with software on their own laptops as well as receive training on how to use the same programs on a computer cluster. In 2020 the course instructors include Peter Beerli, Joe Bielawski, Jeremy Brown, Minh Bui, Belinda Chang, Scott Edwards, Deise Gon\u00e7alves, Kelley Harris, Tracy Heath, John Huelsenbeck, Lacey Knowles, Laura Kubatko, \u00c1ki L\u00e1ruson, Paul Lewis, Emily Jane McTavish, Claudia Sol\u00eds-Lemus, Ed Susko, David Swofford, Katie Taylor, George Tiley, and Anne Yoder. Deadline for applications is *** FEBRUARY 12, 2020 *** : see https://ws2.mbl.edu/studentapp/studentapp.asp?courseid=mole More information on the Workshop is available on the dedicated course website: https://molevolworkshop.github.io For further information, please contact the Workshop Co-Directors: Paul Lewis ( paul....@uconn.edu ) and/or Peter Beerli ( pbe...@fsu.edu ====================================================== ~~~~~~~~~~~~~~~~~~~~~~~ Paul O. Lewis, Professor Dept. Ecol. & Evol. Biol. University of Connecticut 75 N. Eagleville Rd., Unit 3043 Storrs, CT 06269-3043 "]}, "n5kqeevq7sk": {"topic": "Problem running ancestral state reconstruction", "initializeDate": "Sep 19, 2017, 5:57:41 AM", "timeStamp": "Nov 7, 2017, 2:18:15 AM", "content": ["Hello, I'm running ancestral state reconstruction for a large alignment (>300000 columns, > 800 taxa) and I'm encountering an error. This is the command I'm using ~/programs/iqtree-1.6.beta4-Linux/bin/iqtree -asr -s 2017.06.09.all_ours_and_desj.snp_sites.mod.fa -te 2017.06.09.all_ours_and_desj.snp_sites.fast.mod.tree -m GTR+ASC+G4 -nt 16 And the error I'm receiving is this ERROR: phylokernelnonrev.h:1091: double PhyloTree::computeNonrevLikelihoodBranchSIMD(PhyloNeighbor *, PhyloNode *) [VectorClass = Vec4d, nstates = 4, FMA = false]: Assertion `prob_const < 1.0 && prob_const >= 0.0' failed. The full log file is downloadable here , and the alignment (80 MB when gzipped) is here It predicts the state of the first node before crashing. I ran a small test dataset which completed successfully. Any ideas? Phil Ashton ", "Hi Phil, Thanks for the report. While I will examine the problem, can you please rerun without +ASC in the model and let me know if it works? Because I suspect there is a problem with ancestral reconstruction under +ASC. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "That worked! Thanks for the fix and the quick response! ", "Hi Minh, I have a different problem with running ASR. Now I'm running it with large alignments (19 million nucleotides), much of which is invariant. The analysis crashes after reading the sequence in. I don't think it is a RAM issue, as the machine I'm working on has 128 GB. The log file is attached. Best, Phil ", "Dear Phil, That\u2019s weird, can you send to my personal email the alignment for debugging purpose? Thanks, Minh <2017.08.10.all_l4_vs_h99.fa.log> ", "Dear Philip, I could reproduce the crash using the data you sent me, and moreover got a backtrace: ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 pllAlignmentRemoveDups() ERROR: 4 IQTree::initializePLL(Params&) ERROR: 5 runTreeReconstruction(Params&, std::string&, IQTree&, ModelCheckpoint&) ERROR: 6 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 7 main() So it means that the bug is in the (old) phylogenetic likelihood library (PLL) that IQ-TREE uses for parsimony computation. Some users already reported this crash when the alignment is very long. To avoid this, please add option -t PARS into the command line (to switch to IQ-TREE parsimony kernel). Let me know how it works. Thank you, Minh <2017.08.10.all_l4_vs_h99.fa.log> ", "Sorry it took me so long to respond. Yes, this fix works well. Thank you! "]}, "ChJV9WZz_Hg": {"topic": "Command to add generations to a finished run that did not converge.", "initializeDate": "May 4, 2020, 12:47:08 AM", "timeStamp": "May 5, 2020, 9:46:51 PM", "content": ["Good Morning IQ-Tree community A question, my pc has few requirements and my run has already finished in IQ-Tree 1.6.10 but the tree did not converge (approximately 327 sequences with 1000 Bootstrap). What is the command to add more generations to the run so that it converges, without having to restart the run from scratch? I appreciate your collaboration. Greetings from Colombia. ", "Hi Cristian, It's not very clear quite what you mean here. There's no real notion of a tree converging in an ML analysis, although that is something one should look out for in a Bayesian analysis. Can you be more specific about what you mean by not converging? E.g. can you show us the relevant parts of the logfile, or whatever other information you're basing the lack of convergence on? As a general rule though, any IQ-TREE run can simply be re-started from roughly where it left off by simply re-running the same commandline. IQ-TREE reads the previous results from the checkpoint file and does its best to pick up where it left off. Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/afa487e7-acae-4123-9a87-1998b472f71b%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Hi Cristian and Rob, I guess Cristian meant the UFBoot warnings that the bootstrap correlation is lower than 0.99 and try to use -nm option to increase the number of iterations, something like in the log: WARNING: bootstrap analysis did not converge. You should rerun with higher number of iterations (-nm option) If that\u2019s the case, then yes you can resume without having to rerun the whole thing again. For v1.6 please add an (undocumented) option --force-unfinish together with -nm 2000. This will load everything and resume the analysis. In v2.0, this option is called --undo. I.e. to undo the run one step back, pretending that it didn\u2019t complete but still load the checkpoints. This option is quite useful, for example, when you want to change some options. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmoHQbW1wFV9Eb7tn1j%3DiiDO2wukSJYMhVgojXAtT0s-wA%40mail.gmail.com "]}, "2vM-lKqNPDk": {"topic": "dating a microbial tree gives a segmentation fault", "initializeDate": "Sep 30, 2020, 10:57:06 PM", "timeStamp": "Oct 22, 2020, 2:53:19 AM", "content": ["Hey All I am trying to fossil calibrate an alignment using a single fossil calibration on a RY tree of the alignment (also generated from IQTREE using GTR+F+I+G model). But I get the following error- TREE 1 *PROCESSING: Reading the tree ... Collapse 1 (over 437) internal branches having branch length <= 6.67e-05 (settable via option -l) Parameter to adjust variances was set to 0.0505 (settable via option -b) Can not estimate minimum branch lengths for time scaled tree: the temporal constraints provided are not enough, or conflict. Minimum branch length is then set to 0 (settable via option -u and -U). Estimating the root position on all branches using fast method ... Computing confidence intervals using sequence length 7497 and a lognormal relaxed clock with mean 1, standard deviation 0.2 (settable via option -q) ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: protein_nucleotide_cockroach-extracted-Treponema-COG0525.fasta.log ERROR: *** Alignment files (if possible) IQTREE Google group search shows this error is due to short branch lengths, so I am using \"-u 0\". Code used- /flash/BourguignonU/Tool/iqtree-2.0.6-Linux/bin/iqtree2 -s protein_nucleotide_cockroach-extracted-Treponema-COG0525.fasta --date DATA_FILE -te ry_cockroach_Treponema_COG0525.treefile --date-ci 100 -u 0 -m GTR+F+I+G I also tried the version where I don't give the tree file, but I get the same error. Any suggestions on what might be going wrong here? ", "The files were too big to send via email, so I have uploaded them here- https://github.com/Jigyasa3/errors Thanks again! ", "Hi Arora, First, dating can not be processed with only 1 calibration node, you need the dates of tips as well; so maybe add --date-tip 0 to let all tip dates to be 0 if they're all present sequences. Just another suggestion, for unrooted trees, if you have good outgroups, it's generally better to use those outgroups to define the root then let the program suggest the root for you. Then, in some recent versions of lsd2, if you calculate confidence intervals, there's a bug of printing out CI values for null branches in the output tree. This bug is reported here and has been fixed in the new version of lsd2. You can either continue to use -u 0, which allows null branches in the output tree, but so you need to wait when the new version of lsd2 integrated to iq-tree (or just run the updated version of lsd2 separately); or use -u with a positive value which should be fine for your tree I think. Best regards, Hien You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b77adce7-e4ee-42ac-9871-bc61b3ba6fb7n%40googlegroups.com ", "Thank you so much for replying! I followed your advice and used the rooted version of the RY tree, and used the following script for 1 fossil calibration- code- $/flash/BourguignonU/Tool/iqtree-2.0.6-Linux/bin/iqtree2 -s protein_nucleotide_cockroach-extracted-Treponema-COG0525.fasta --date DATA_FILE -te ry_cockroach_Treponema_COG0525_rooted.nwk --date-ci 100 -u 1 -m GTR+F+I+G --date-tip 0 -pre rooted-tree Question- a) The time.tree.nwk files' scale axis is from 5mya onwards, but the fossil calibration I added is 145 mya. How is that possible? b) how do I visualize the CI intervals on the nodes in Figtree (or is there any other software that can be used?) Looking forward to your reply! Regards Jigyasa Arora ", "The rooted starting tree \" ry_cockroach_Treponema_COG0525_rooted.nwk\" and the time tree \"rooted-tree.timetree.nwk\" and the log file \"rooted-tree.log\" are available here- https://github.com/Jigyasa3/errors ", "Hi Arora, You should look at the nexus file (rooted-tree.timetree.nex) for date scaling, and for visualizing the CI intervals. In Figtree, you select Node Bars, and then display by CI_height. Moreover, it seems that just your starting tree is rooted, but the treefile served as input for dating is unrooted; so lsd2 still rerooted your tree. Regards, Hien You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ae2cbe1a-b260-425f-a27f-21ba6bd7edc1n%40googlegroups.com ", "Dear Hien Thank you for replying back! I redid the analysis with \"-o\" option to root the alignment file also. Now the root is 5000 years old! I also checked the nexus file in Figtree, but there are no CI_height option in Node Bars. The nexus file \"rooted-tree.timetree.nex\" is available https://github.com/Jigyasa3/errors .All the other files are the same as before. I also tried the version where I use only 1 sequence for rooting, but then I get an error that my outgroups are not monophyletic (which is true from the ry_cockroach_Treponema_COG0525_rooted.nwk starting tree). How do I work around it? My code- /flash/BourguignonU/Tool/iqtree-2.0.6-Linux/bin/iqtree2 -s protein_nucleotide_cockroach-extracted-Treponema-COG0525.fasta --date DATA_FILE -o \"mgm4583651.3-4.csv-COG0525_number122__Bacteria_Spirochaetes_Spirochaetia_Spirochaetales_Spirochaetaceae_Treponema_1,mgm4583651.3-4.csv-COG0525_number125__Bacteria_Spirochaetes_Spirochaetia_Spirochaetales_Spirochaetaceae_Treponema_1,mgm4583652.3-3.csv-COG0525_number97__Bacteria_Spirochaetes_Spirochaetia_Spirochaetales_Spirochaetaceae_Treponema_1,mgm4583652.3-3.csv-COG0525_number99__Bacteria_Spirochaetes_Spirochaetia_Spirochaetales_Spirochaetaceae_Treponema_1\" -te ry_cockroach_Treponema_COG0525_rooted.nwk --date-ci 100 -u 1 -m GTR+F+I+G --date-tip 0 -pre rooted-tree ", "Hi Arora, It seems that for some figtree version, Node Bars doesn't read values in the quotes. So you need to remove all the quote marks in the nexus tree and try again. I'm not sure about the problem you got when you used 1 outgroup sequence; it should be monophyletic itself and the program shouldn't complain about that. Could you give the log file for that error? Cheers, Hien You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/55b2205e-f4bc-4af1-8f90-390cccc20e9fn%40googlegroups.com ", "", "PFA, the log file with the error. I pressed send too quickly :( ", "Hi, I saw in the log file you have 2 outgroup sequences which are not monophyletic in the tree; so we can not determine where the root is. To have a monophyletic, you need to include all sequences in the outgroup subtree that defines the root. Hien To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/75addff9-7558-4183-a7f2-53a72fac82ben%40googlegroups.com ", "Hey Hien I am able to get a better version using 1 outgroup in new version, rooted-tree3 version (log file= rooted-tree3.log) . Now the date on the root node is correct (~145 mya). But when I compare IQTREE timetree (file= rooted-tree3.timetree.nex) with BEAST timetree (file= COG0525_exponentialprior_consensus.trees) using the same fossil calibrations, I get very different branching times for internal nodes. The BEAST tree ages correspond more to what we expect for this group, while IQTREE ages are twice as old. PFA all the files mentioned here - https://github.com/Jigyasa3/errors I understand that the model I have used in IQTREE is a simple one, but the age difference is double! Any suggestions? Model used in BEAST for comparison- Clock model-strict clock, site model- GTR+gamma, tree model- Yule model. Regards Jigyasa Arora ", "Hi Arora, Not sure if I understand it correctly, but I didn't see fossil calibration in your beast tree. Your DATA_FILE indicates that the most common ancestor of the 5 sequences (\"mgm....\") is 145, while I saw that it's about 3.3 in the beast tree. Was it something confusing between the root and the most common ancestor of outgroups? How did you define the time-constraints/outgroups in beast? Hien To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/53bdc35d-6e66-4063-8dc1-1d413f94db25n%40googlegroups.com ", "Hey Hien Sorry, my DATA_FILE was completely wrong. The fossil calibration is supposed to be at the node between 5 mgm... sequences and those starting with numbers (301-.., 229-..,272-..,230-..). I have the corrected version now. I still have a few questions- a) I have added upper and lower bounds in the calibration file (DATA_FILE), and this time not using a starting tree (final files- 2-nostarttree.timetree.nex, nostarttree.log ). But the comparison with BEAST tree ( COG0525_exponentialprior_consensus.trees ) shows that the age of the nodes is vastly different. Code used- /flash/BourguignonU/Tool/iqtree-2.0.6-Linux/bin/iqtree2 -s protein_nucleotide_cockroach-extracted-Treponema-COG0525.fasta --date DATA_FILE -o \"mgm4583651.3-4.csv-COG0525_number122__Bacteria_Spirochaetes_Spirochaetia_Spirochaetales_Spirochaetaceae_Treponema_1,mgm4583651.3-4.csv-COG0525_number125__Bacteria_Spirochaetes_Spirochaetia_Spirochaetales_Spirochaetaceae_Treponema_1,mgm4583652.3-3.csv-COG0525_number97__Bacteria_Spirochaetes_Spirochaetia_Spirochaetales_Spirochaetaceae_Treponema_1,mgm4583652.3-3.csv-COG0525_number99__Bacteria_Spirochaetes_Spirochaetia_Spirochaetales_Spirochaetaceae_Treponema_1\" --date-ci 100 -u 1 -m GTR+F+I+G --date-tip 0 -pre nostarttree b) If I add more than 1 fossil calibration in the file (DATA_FILE2), I get an error that the DATA_FILE2 is not correct. I am following the http://www.iqtree.org/doc/Dating format. files DATA_FILE2 rooted-tree-micro.log are attached for reference. I want to use multiple fossil calibrations but wanted to test them one at a time. All files are here- https://github.com/Jigyasa3/errors Thanks again for all the help! Jigyasa ", "Hi Arora, Sorry for the late response, here's what I can see so far. a) You're using version 2.0.6 of iq-tree, which uses an old version of lsd2. I have updated lsd2 that fixed some bugs, some of them are integrated in the new version of iq-tree (2.1.1), some are not. I think your data is a bit special that needs to adapt some options instead of using the default ones of lsd2. So I suggest you to run lsd2 separately here ( https://github.com/tothuhien/lsd2 ) to make the test faster. For this, you can run iq-tree with option --date-debug, that would, at the end, generate some extra files for you to run lsd2 alone. You have the command in the log file (Building time tree by least-square dating (LSD) with command: ...) that you can adjust and add more custom options. First, your outgroup is very far from the ingroup sequences: the branch associated to outgroups of your tree is significantly long compared to the rest. This generally causes bias in estimating root date. To penalize the effect of long branches, you can use the option -b to adjust the variance of branch length. By default, it's the median of branch lengths (it's value is reported in the standard output). The bigger it is, the smoother the variances (all branches tend to have the same variance). The smaller it is, the more variances depend linearly to branch lengths. In your case, I think you should set -b smaller to show that variance of the long outgroup branch is very high. Second, you can try to run lsd2 twice, where the second time we use the branch lengths of the first run to calculate the variances. Option -v 2 is used for this. Upon simulation data, in some cases that helps to improve the results. Finally, when all your tips dates are equal, you need at least one fixed (not a range) fossil calibration in order to have a unique solution from lsd2. Otherwise, the old lsd2 version just selects one of the limite for the fossil and gives you the solution corresponding to that; the new version now throws an error. Just a remark, option -u 1 that you used in iqtree command didn't pass to lsd2, because it's a command of lsd2, not iqtree. To use this option through iqtree, you should put it in --date-options \"-u 1\". But if you're running lsd2 separately, just set -u 1 (or any positive value for minimum branch length of output tree). b) As you see in the log file, (ERROR: Line 2: ... ) there's an error related to the sequence 272-52--MAD15-s...... Actually there's an extra space in the sequence just before it. Hope that helps a bit. Cheers, Hien To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/26ed5832-622d-4f52-ba80-abf287ff4744n%40googlegroups.com ", "Thank you so much for replying @Hien! I did as you recommended. I am using iqtree 2.1.1 version now and I have installed lsd2 also. I am using the outputs from iqtree2 --date-debug into lsd2, but I get the following error- Code used for IQTREE2 to get files to run LSD2- $/flash/BourguignonU/Tool/iqtree-2.1.1-Linux/bin/iqtree2 -s new-protein-nucleotide-cockroach-extracted-Treponema-COG0525.fasta -m GTR+F+I+G --date-debug -pre COG0525-datedebug -o \"mgm4583651.3-4.csv-COG0525_number122__Bacteria_Spirochaetes_Spirochaetia_Spirochaetales_Spirochaeta ceae_Treponema_1--NA-NA-NA-NA-NA,mgm4583651.3-4.csv-COG0525_number125__Bacteria_Spirochaetes_Spirochaetia_Spirochaetales_Spirochaetaceae_Tr eponema_1--NA-NA-NA-NA-NA,mgm4583652.3-3.csv-COG0525_number97__Bacteria_Spirochaetes_Spirochaetia_Spirochaetales_Spirochaetaceae_Treponema_ 1--NA-NA-NA-NA-NA,mgm4583652.3-3.csv-COG0525_number99__Bacteria_Spirochaetes_Spirochaetia_Spirochaetales_Spirochaetaceae_Treponema_1--NA-NA -NA-NA-NA,mgm4583652.3-3.csv-COG0525_number105__Bacteria_Spirochaetes_Spirochaetia_Spirochaetales_Spirochaetaceae_Treponema_1--NA-NA-NA-NA-NA\" -d DATE_FILE2 Code used for LSD2- $/flash/BourguignonU/Tool/lsd2/src/lsd2 -i COG0525-datedebug.timetree.subst -d DATE_FILE2 -o lsd-COG0525 -b 0.1 -g COG0525-datedebug.timetree.outgroup -v 2 -s 7497 -u 1 -f 100 -z 0 Error- Reroot the tree(s) using given outgroups ... TREE 1 *PROCESSING: Reading the tree ... Collapse 0 (over 437) internal branches having branch length <= 6.66933e-05 (settable via option -l) Minimum branch length of time scaled tree (settable via option -u and -U): 1 Error: There's conflict or not enough signal in the input temporal constraints. All the files and also the log file from IQTREE https://github.com/Jigyasa3/errors ", "Hi Jigyasa, The command that you used confused a bit about the date file format and the options. For input date file, iq-tree uses option --date, and lsd2 uses option -d. Their date file formats are also different. I've attached here an example of 2 date files for 2 programs. Actually when you run iq-tree with --date-debug option, it will generate the date file of lsd2 for you. I also found some issues in your date file: - As I said you should have at least one fixed calibration fossil (can not have all as intervals). - The fossil dates should be more ancient than the tips date, so they should be negative. - And, I haven't checked carefully, but it seems that your 2 calibration points refer to the same internal nodes, that may also cause the conflict. Cheers, Hien You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ee6649a4-9d8d-4368-b5ae-31b634549984n%40googlegroups.com ", "Hi Hien and others, I have just released IQ-TREE v2.1.2, which integrates the latest LSD2 version 1.9.7. Hope that this will fix issues recently posted here. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAKjtwTxpwbGnMLOqSJfYNCJvyM90MzRQC5w%2B%2BTHXhe%3D18R4pfQ%40mail.gmail.com <DATE_iqtree.txt> <DATE_lsd.txt> "]}, "hfbSYgWRrMA": {"topic": "bootstrap analysis did not converge. You should rerun with higher number of iterations (-nm option)", "initializeDate": "May 16, 2019, 2:38:48 PM", "timeStamp": "Jun 3, 2019, 2:01:17 AM", "content": ["Hi, I have just run the following script: iqtree -st DNA -s ../myalignment.varsites.phy \\ -m GTR+F+ASC+R5 -nt AUTO -ntmax 10 -pre ww.13k.reduced.iteration2 -alrt 1000 -nm 5000 -lbp 1000 -bb 1000 -bnni In the log file I found the warning: bootstrap analysis did not converge. You should rerun with higher number of iterations (-nm option) I increased the -nm to 5000, but the warning remains. i just wanted to make sure if the script is correct, or if the -nm 5000 should replace the number of replicates (1000). Thank you for your kind attention, Max ", "Hi Max, Your command line looks fine. -nm 5000 will set the max number of iterations to 5000. This warning means that it\u2019s a difficult dataset, e.g. with low phylogenetic information. How many sites does this alignment have? If not long, look at previous discussions about short alignments. Unfortunately I don\u2019t have access to Google group etc. now to find out the forum topic, as I\u2019m currently in China and thus behind the Great Firewall. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d383c584-1abd-44c7-ae16-fc34b6ce670a%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Hi, Minh, Thank you for your kind answer. The alignment is 13K sites long; I had previously checked the signal with DAMBE and it was fine; I later removed a few sequences though, I will check the signal again. Thank you for your kind help, Max ", "Hi Max, I just found the issue, that with -bnni option, this warning is not correct. So please ignore it! Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/dd38df95-bc80-4dd5-904c-1709806ced36%40googlegroups.com "]}, "KW4xC689I_Q": {"topic": "ERROR: CharSet not found", "initializeDate": "Apr 13, 2021, 12:16:17 PM", "timeStamp": "Apr 13, 2021, 12:31:33 PM", "content": ["I am using a nexus formatted partition file generated by IQ-TREE. When attempting to use it to perform a phylogenetic analysis, I get this error: ERROR: ERROR: Error found at line 87, column 19 (file position 8420): ERROR: CharSet uce not found I looked at line 87 and the charset is found on line 3, which looks formatted correctly. I am not sure what else is causing the problem as the partition file looks correct to me. I tried attaching the partition file and error file, but I was unable to post this message with them attached.. Using version 2.0.3. Thanks, Michael ", "I determined the problem. My partition file had the charsets originally formatted like so: charset uce-1_uce-3_uce-6 = ... Apparently, hyphens are not desired in the charset name, so I had to eliminate them to get IQ-TREE to run: charset uce1_uce3_uce6 = ... "]}, "dVKnq-WyiZY": {"topic": "AU test discrepancy", "initializeDate": "Jan 2, 2018, 3:34:25 PM", "timeStamp": "Jan 4, 2018, 7:31:30 AM", "content": ["HI Minh, I am trying (IQ-TREE v1.5.6) to use the AU test with mixture models, but I have obtained significant different p-AU values (e.g., trees #1 and #8 highlighted in yellow) for some trees just after scrambling the order of my trees in the input file: same trees, same alignment, same model and same logL values as you can see in the output table. The best tree is consistently the same (tree# 13; green highlight) Do you have an idea what the problem is? These are the results after two runs (I edited the name of the trees just to show them with the same IDs): Run 1 Tree logL deltaL bp-RELL p-KH p-SH p-WKH p-WSH c-ELW p-AU ------------------------------------------------------------------------------------------- 1 -518214.988 1108.235 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.2023 2 -518454.608 1347.855 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 3 -518249.770 1143.017 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0021 - 4 -518640.277 1533.524 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0030 - 5 -517816.275 709.522 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 6 -517681.152 574.399 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0071 - 7 -517684.603 577.850 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0001 - 8 -517335.076 228.323 0.0000 - 0.0000 - 0.0080 - 0.0000 - 0.0000 - 0.0000 - 0.0053 9 -517297.225 190.472 0.0000 - 0.0000 - 0.0230 - 0.0000 - 0.0000 - 0.0000 - 0.0198 - 10 -517277.698 170.945 0.0000 - 0.0000 - 0.0360 - 0.0000 - 0.0000 - 0.0000 - 0.0005 - 11 -517142.644 35.891 0.0010 - 0.0050 - 0.7640 + 0.0050 - 0.0410 - 0.0012 - 0.0040 - 12 -517132.212 25.459 0.0520 + 0.0460 - 0.8470 + 0.0460 - 0.3030 + 0.0521 + 0.0452 - 13 -517106.753 0.000 0.9470 + 0.9540 + 1.0000 + 0.9540 + 1.0000 + 0.9467 + 0.9631 Run 2 Tree logL deltaL bp-RELL p-KH p-SH p-WKH p-WSH c-ELW p-AU ------------------------------------------------------------------------------------------- 11 -517142.644 35.891 0.0010 - 0.0030 - 0.7770 + 0.0030 - 0.0280 - 0.0007 - 0.0213 - 12 -517132.212 25.459 0.0420 - 0.0450 - 0.8520 + 0.0450 - 0.2980 + 0.0451 - 0.0331 - 13 -517106.753 0.000 0.9570 + 0.9550 + 1.0000 + 0.9550 + 1.0000 + 0.9542 + 0.9706 + 1 -518214.988 1108.235 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0008 2 -518454.608 1347.855 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 3 -518249.770 1143.017 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0034 - 4 -518640.277 1533.524 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0043 - 5 -517816.275 709.522 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 6 -517681.152 574.399 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0214 - 7 -517684.603 577.850 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 0.0000 - 8 -517335.076 228.323 0.0000 - 0.0000 - 0.0030 - 0.0000 - 0.0000 - 0.0000 - 0.2275 9 -517297.225 190.472 0.0000 - 0.0000 - 0.0170 - 0.0000 - 0.0000 - 0.0000 - 0.0280 - 10 -517277.698 170.945 0.0000 - 0.0000 - 0.0320 - 0.0000 - 0.0000 - 0.0000 - 0.0027 - Thank you for you help, Adrian ", "Hi again Minh, I forgot to say that the same problem occurs with Tree# 11. Thank you for your help, Adrian ", "Hi Adrian, can you pls send me the data set and command line via personal email? I will have a closer look. Thanks, Minh Sent from my iPhone You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "WXWCDq3Vl4E": {"topic": "ERROR: Alignment sequence xxx  does not appear in the tree", "initializeDate": "Mar 16, 2017, 5:49:26 AM", "timeStamp": "May 10, 2017, 8:30:31 AM", "content": ["Hello, I am trying to run a tree but it crashed after few times : iqtree-omp-1.5.3-Linux/bin/iqtree-omp -st AA -nt 6 -s my_file.fasta -m TESTNEW -madd LG4M,LG4X -bb 1000 And I got these error messages : Alignment most likely contains protein sequences WARNING: 28 sites contain only gaps or ambiguous characters. Alignment has 2163 sequences with 1556 columns and 1290 patterns (607 informative sites, 572 constant sites) Gap/Ambiguity Composition p-value 1 ACAHI1 82.90% passed 55.39% 2 ACAHI2 79.11% passed 55.01% 3 ACAHI3 82.39% passed 73.44% 4 ACAHI4 82.13% passed 92.94% 5 ACAHI5 82.07% passed 76.46% 6 ACAHI6 82.07% passed 99.18% 7 ACAHI7 82.90% passed 78.43% 8 ACAHI8 82.20% passed 98.32% 9 ACAHI9 83.23% passed 98.00% 10 ACREC1 94.28% passed 83.97% 11 ACREC2 84.64% passed 37.70% 12 ACREC3 84.51% passed 76.90% 13 ACREC4 82.84% passed 88.73% 14 ACREC5 84.77% passed 57.33% 15 ACREC6 84.77% passed 46.07% 16 ACREC7 84.64% passed 13.70% 17 ACREC8 84.64% passed 94.76% 18 ACREC9 84.64% passed 77.81% 19 ACREC10 85.35% passed 45.21% 20 ACREC11 84.77% passed 44.08% 21 ACREC12 86.44% passed 35.71% 22 ACREC13 84.90% failed 1.74% 23 ACREC14 90.04% failed 0.08% .... #Why some are failing? WARNING: 2163 sequences contain more than 50% gaps/ambiguity **** TOTAL 81.66% 81 sequences failed composition chi2 test (p-value<5%; df=19) #What does it mean? Create initial parsimony tree by phylogenetic likelihood library (PLL)... 8.403 seconds Reusing information from model file my_file.fasta.model NOTE: MODEL SELECTION REQUIRES 4312 MB MEMORY! Testing 470 protein models (sample size: 1556) ... No. Model -LnL df AIC AICc BIC 1 Dayhoff 428212.930 4247 864919.860 36947431.860 887640.773 2 Dayhoff+I 428075.351 4248 864646.702 36964150.702 887372.965 3 Dayhoff+G4 404177.040 4248 816850.079 36916354.079 839576.342 4 Dayhoff+I+G4 801.823 4249 10101.645 36126601.645 32833.258 ERROR: Alignment sequence ACAHI2 does not appear in the tree ERROR: Alignment sequence ACAHI3 does not appear in the tree ERROR: Alignment sequence ACAHI4 does not appear in the tree ERROR: Alignment sequence ACAHI5 does not appear in the tree ERROR: Alignment sequence ACAHI6 does not appear in the tree ERROR: Alignment sequence ACAHI7 does not appear in the tree ERROR: Alignment sequence ACAHI8 does not appear in the tree ERROR: Alignment sequence ACAHI9 does not appear in the tree ERROR: Alignment sequence ACREC1 does not appear in the tree ERROR: Alignment sequence ACREC2 does not appear in the tree ERROR: Alignment sequence ACREC3 does not appear in the tree ERROR: Alignment sequence ACREC4 does not appear in the tree ERROR: Alignment sequence ACREC5 does not appear in the tree ERROR: Alignment sequence ACREC6 does not appear in the tree #Do you know why I have this \"bug\"? Let me know if you have any idea. Thank you in advance for your help. Kind regards, Victoria ", "Dear Victoria, #Why some are failing? WARNING: 2163 sequences contain more than 50% gaps/ambiguity **** TOTAL 81.66% 81 sequences failed composition chi2 test (p-value<5%; df=19) #What does it mean? Have a look at the detailed explanation about the composition test here: http://www.iqtree.org/doc/Frequently-Asked-Questions/#what-is-the-purpose-of-composition-test 4 Dayhoff+I+G4 801.823 4249 10101.645 36126601.645 32833.258 ERROR: Alignment sequence ACAHI2 does not appear in the tree ERROR: Alignment sequence ACAHI3 does not appear in the tree ERROR: Alignment sequence ACAHI4 does not appear in the tree ERROR: Alignment sequence ACAHI5 does not appear in the tree I think you started an earlier run and stopped at model 4 and now you restart again, as I saw a log message: Reusing information from model file my_file.fasta.model As a quick fix, can you please re-run again with an option \u201c-mredo\u201d to ignore this file. Let me know if that works. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Thank you for your quick answer. So far it seems to work. I let you know when the run is over because last time it crashed after few times. Thank you again for your help. Best wishes, Victoria ", "Just wanted to mention I also saw the \" not appear in the tree\" error message when I accidentally ran the omp code as if it were mpi code. ", "Hi Mark, but this should be avoided\u2026 And I just want to clarify again for other users: one can only do mpirun with the MPI version (iqtree-mpi), e.g.: mpirun -np 4 iqtree-mpi -s alignment \u2026 doing this with the multicore or sequential version (iqtree) will cause undefined behavior, e.g. the different runs will overwrite output files of each other. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "bM22pW8jIis": {"topic": "Tree topology tests", "initializeDate": "Jan 16, 2017, 11:15:45 PM", "timeStamp": "Jan 17, 2017, 5:16:01 AM", "content": ["Dear Minh, I have two questions about the results of tree topology tests (pasted below). 1) Is it correct that the bp-RELL and c-ELW tests can return values <0.05 yet not be excluded at the 95% level? e.g. \u201c0.0476 +\u201d \u201c0.0433 +\u201d \u201c0.0457 +\u201d 2) Do you have any advice about \u201cborderline\u201d cases (not shown here), where a couple of tests just fail but all other tests have reasonable p-values, e.g. >0.2? Thanks very much, Trevor Command: iqtree-omp -s test.fasta -m WAG -z test.trees -zb 10000 -zw -au -nt 3 Extract of resulting test.iqtree: Tree logL deltaL bp-RELL p-KH p-SH p-WKH p-WSH c-ELW p-AU ------------------------------------------------------------------------------------------- 1 -29496.556 0.000 0.6900 + 0.8779 + 1.0000 + 0.8578 + 0.9965 + 0.6752 + 0.9278 + 2 -29503.393 6.836 0.0476 + 0.1221 + 0.6489 + 0.1221 + 0.4433 + 0.0554 + 0.2328 + 3 -29512.028 15.472 0.0608 + 0.1012 + 0.2774 + 0.1012 + 0.2904 + 0.0606 + 0.1788 + 4 -29509.963 13.407 0.0433 + 0.0943 + 0.3274 + 0.0943 + 0.3405 + 0.0457 + 0.1695 + 5 -29506.073 9.517 0.0848 + 0.1422 + 0.5077 + 0.1422 + 0.4629 + 0.0870 + 0.2827 + 6 -29511.164 14.607 0.0625 + 0.0856 + 0.3036 + 0.0856 + 0.2391 + 0.0647 + 0.1269 + 7 -29523.913 27.356 0.0056 - 0.0316 - 0.0552 + 0.0316 - 0.1256 + 0.0058 - 0.0614 + 8 -29524.286 27.729 0.0054 - 0.0309 - 0.0573 + 0.0309 - 0.1168 + 0.0056 - 0.0475 - deltaL : logL difference from the maximal logl in the set. bp-RELL : bootstrap proportion using RELL method (Kishino et al. 1990). p-KH : p-value of one sided Kishino-Hasegawa test (1989). p-SH : p-value of Shimodaira-Hasegawa test (2000). p-WKH : p-value of weighted KH test. p-WSH : p-value of weighted SH test. c-ELW : Expected Likelihood Weight (Strimmer & Rambaut 2002). p-AU : p-value of approximately unbiased (AU) test (Shimodaira, 2002). Plus signs denote the 95% confidence sets. Minus signs denote significant exclusion. All tests performed 10000 resamplings using the RELL method. ", "Dear Trevor, On Jan 17, 2017, at 5:15 AM, trevo...@anu.edu.au wrote: Dear Minh, I have two questions about the results of tree topology tests (pasted below). 1) Is it correct that the bp-RELL and c-ELW tests can return values <0.05 yet not be excluded at the 95% level? e.g. \u201c0.0476 +\u201d \u201c0.0433 +\u201d \u201c0.0457 +\u201d Yes, that can happen because bp-RELL and c-ELW are NOT p-values! They sum up to 1 across 8 trees in your example, thus can be interpreted as probability. The + sign is assigned to those largest bp-RELL values which together accumulate just above 0.95; thus forming the confidence set of the trees. The other tests return p-values, thus is assigned \u2018+\u2019 sign if p-value > 0.05 and \u2018-' otherwise. 2) Do you have any advice about \u201cborderline\u201d cases (not shown here), where a couple of tests just fail but all other tests have reasonable p-values, e.g. >0.2? I typically rely on the last column (p-AU) because it was shown to be \u201capproximately unbiased\u201d, and sometimes also look at c-ELW to be more confident if they agree to reject a tree. The SH and WSH tests are conservative, tending to accept more trees if given many input trees. The KH and WKH tests are meant to test 2 trees only, thus not suitable here. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Many thanks, once again, for a very clear explanation. Trevor "]}, "zp2uOGa9ehw": {"topic": "BUG Error when combining GTR and a mixture model on a 9-state recoded amino acid data set", "initializeDate": "Oct 9, 2019, 12:17:49 PM", "timeStamp": "Oct 10, 2019, 8:03:16 AM", "content": ["Dear Minh, I am trying to run IQ-TREE on a recoded amino acid dataset into 9 character-states using the GTR model combined with a mixture model obtained by adding up the frequencies of the amino acids that belong to the same bin. Please see below for WARNING and ERROR lines from the log file. Thank you very much for your help, IQ-TREE multicore version 1.6.12 for Linux 64-bit built Aug 15 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: perun17 (AVX2, FMA3, 755 GB RAM) Command: iqtree -s 122x111.-fd.-50z.S9.fasta2 -nt 8 -pre iqtree2.0 -mdef 122x111_MAM60_S9.csv -m GTR+MAM60S9+G4 -bb 1000 -bnni -alrt 1000 -wsr -safe -mem 500G Seed: 545006 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Oct 9 12:27:12 2019 Kernel: Safe AVX+FMA - 8 threads (64 CPU cores detected) Reading alignment file 122x111.-fd.-50z.S9.fasta2 ... Fasta format detected Alignment most likely contains 9-state morphological data Alignment has 122 sequences with 16202 columns, 14601 distinct patterns 10390 parsimony-informative, 1887 singleton sites, 3925 constant sites WARNING: 12 sequences contain more than 50% gaps/ambiguity WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! WARNING: GTR multistate model will estimate 35 substitution rates that might be overfitting! WARNING: Please only use GTR with very large data and always test for model fit! ERROR: phylotree.cpp:5216: bool PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&): Assertion `0 && \"No free/unlocked mem slot found!\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 5 () ERROR: 6 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 7 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 8 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 9 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 10 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 11 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 12 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 13 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 14 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 15 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 16 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 17 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 18 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 19 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 20 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 21 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 22 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 23 PhyloTree::computeTraversalInfo(PhyloNeighbor*, PhyloNode*, double*&) ERROR: 24 void PhyloTree::computeTraversalInfo<Vec4d>(PhyloNode*, PhyloNode*, bool) ERROR: 25 double PhyloTree::computeLikelihoodBranchGenericSIMD<Vec4d, true, true, false>(PhyloNeighbor*, PhyloNode*) ERROR: 26 PhyloTree::computeLikelihood(double*) ERROR: 27 ModelMarkov::targetFunk(double*) ERROR: 28 Optimization::derivativeFunk(double*, double*) ERROR: 29 Optimization::dfpmin(double*, int, double*, double*, double, int*, double*, double*) ERROR: 30 Optimization::minimizeMultiDimen(double*, int, double*, double*, bool*, double, double*) ERROR: 31 ModelMarkov::optimizeParameters(double) ERROR: 32 ModelMixture::optimizeWithEM(double) ERROR: 33 ModelMixture::optimizeParameters(double) ERROR: 34 ModelFactory::optimizeParametersOnly(int, double, double) ERROR: 35 ModelFactory::optimizeParameters(int, bool, double, double) ERROR: 36 ModelFactory::optimizeParametersGammaInvar(int, bool, double, double) ERROR: 37 IQTree::optimizeModelParameters[abi:cxx11](bool, double) ERROR: 38 runTreeReconstruction(Params&, IQTree*&) ERROR: 39 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 40 main() ERROR: 41 __libc_start_main() ERROR: 42 () ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: iqtree2.0.log ERROR: *** Alignment files (if possible) Sergio A. Mu\u00f1oz-G\u00f3mez, Ph.D. Andrew Roger Lab ", "Hi Sergio, Good to hear from you, and thanks for the bug report. The stack trace and assertion are quite useful. It looks like a problem with -mem option. Are you able to run IQ-TREE without -mem option, let it allocate as much RAM as it likes? How much RAM iqtree requires in such case? You can ignore the WARNINGs, as you have enough data here (it\u2019s meant for small morphological data). Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e129bdca-98a1-47e5-93ea-752d4b1807c6%40googlegroups.com ", "Hi Minh, removing the -mem option appears to work. Another question I have is whether this option will be available in the upcoming version of IQ-TREE: https://github.com/Cibiv/IQ-TREE/issues/22 Thanks a lot, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "DBYhKcqqY5M": {"topic": "exclude sites from an alignment", "initializeDate": "Feb 24, 2016, 8:25:17 PM", "timeStamp": "Feb 28, 2016, 12:05:17 AM", "content": ["Dear developters, is there an option to exclude sites (by e.g. defining a charset, for example in the partition file) ? In case yes, is this also considered then when doing bootstrapping? Best, Karen ", "Dear Karen, there is currently no such option. However, you can alternatively define a partition file containing sites to include and input it to iq-tree. I can add an option to exclude sites, if there are several requests for it. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, would be awsome: for e.g. testing large datasets to be able to define a region (from parts of partitions or complete) to exclude. This could be then changed much more quickly in large datasets without constantly changing fasta and partition file, However it must ensured that partitioning still works correctly (so consider boundaries or internally adjust them). (for treesearches and bootstrapping) (e.g. like in Mr Bayes: exclude charset: xxx that you also could in/outcomment) No idea how complex this is but for sure worth to implement (I think) Anyway & thanks in case it will be implemented best Karen "]}, "G37zb80R4Eo": {"topic": "When rooting an unrooted tree with -m 12.12 and -g <some fully resolved tree> how often does IQ-TREE perform BR-len optimizations?", "initializeDate": "Jan 31, 2020, 10:58:00 AM", "timeStamp": "May 6, 2020, 4:05:04 AM", "content": ["I am comparing the run time of IQ-TREE with a tool that I am writing, and we needed to know how often IQ-TREE performs BR-len optimization in this situation (in order to make a fair comparison). According to the first IQ-TREE paper, this seems like it is every new root. Is this correct? Thanks, Ben ", "Hi Ben, For non-reversible models like this, IQ-TREE will perform a final \u201croot optimization\u201d stage at the end, where it will try to move the root around the current rooting position of the final tree and take the branch leading to the highest likelihood. By default IQ-TREE will only scan those branches that are at most 2 branches away from the current root branch. You can increase this paramter with --root-dist option. A large number will effectively test all branches of the current tree. Note that for each candidate rooted tree, IQ-TREE will re-optimise all branches thoroughly. Does that answer your question? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7b0044b4-ce01-4a86-97aa-ff162bc42b1f%40googlegroups.com ", "Hello Mihn, I tried using the --root-dist option, and I got a crash. I can provide all the files needed (logs, checkpoint, alignment and tree), but here is the error that was printed to console: Do NNI search on 2 best initial trees Estimate model parameters (epsilon = 0.100) Better root: -186661.018 BETTER TREE FOUND at iteration 1: -186661.018 ERROR: phylotree.cpp:3575: virtual NNIMove PhyloTree::getBestNNIForBran(PhyloNode*, PhyloNode*, NNIMove*): Assertion `node1->degree() == 3 && node2->degree() == 3' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 5 () ERROR: 6 PhyloTree::getBestNNIForBran(PhyloNode*, PhyloNode*, NNIMove*) ERROR: 7 IQTree::evaluateNNIs(std::map<int, std::pair<Node*, Node*>, std::less<int>, std::allocator<std::pair<int const, std::pair<Node*, Node*> > > >&, std::vector<NNIMove, std::allocator<NNIMove> >&) ERROR: 8 IQTree::optimizeNNI(bool) ERROR: 9 IQTree::doNNISearch(bool) ERROR: 10 IQTree::initCandidateTreeSet(int, int) ERROR: 11 IQTree::doTreeSearch() ERROR: 12 runTreeReconstruction(Params&, IQTree*&) ERROR: 13 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 14 main() ERROR: 15 __libc_start_main() ERROR: 16 _start() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: iqtree.log ERROR: *** Alignment files (if possible) [1] 163710 abort (core dumped) iqtree -s ../plastid245.fasta -g ../plastid245_brlen_opt.nwk -m 12.12 40 -pr and the first 10 lines of the log file: IQ-TREE multicore version 2.0-rc1 for Linux 64-bit built Feb 4 2020 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: <REDACTED> (AVX2, FMA3, 15 GB RAM) Command: iqtree -s ../plastid245.fasta -g ../plastid245_brlen_opt.nwk -m 12.12 --root-dist 40 -pre iqtree Seed: 790284 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Tue Feb 4 11:11:48 2020 Kernel: AVX+FMA - 1 threads (4 CPU cores detected) Do you need anymore information? Thanks, Ben On Sunday, February 2, 2020 at 3:44:43 PM UTC+1, Minh Bui wrote: Hi Ben, For non-reversible models like this, IQ-TREE will perform a final \u201croot optimization\u201d stage at the end, where it will try to move the root around the current rooting position of the final tree and take the branch leading to the highest likelihood. By default IQ-TREE will only scan those branches that are at most 2 branches away from the current root branch. You can increase this paramter with --root-dist option. A large number will effectively test all branches of the current tree. Note that for each candidate rooted tree, IQ-TREE will re-optimise all branches thoroughly. Does that answer your question? Minh On 31 Jan 2020, at 10:58 pm, Ben Bettisworth < ben.bet...@h-its.org > wrote: I am comparing the run time of IQ-TREE with a tool that I am writing, and we needed to know how often IQ-TREE performs BR-len optimization in this situation (in order to make a fair comparison). According to the first IQ-TREE paper, this seems like it is every new root. Is this correct? Thanks, Ben You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Ben, Can you send me the input file and the full log file? (or did you send them already?) Just a quick note: you used -g option for constraint tree, and perhaps that option may not work with non-reversible model\u2026 but I\u2019ll check again. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/3b1208c8-dbd2-4d23-9d78-11ee494a735d%40googlegroups.com ", "Hello Mihn, Has this bug been resolved. I checked the most recent release that I could find (git tag v2.0.3), and the same thing occured. I just want to make sure that I didn't miss a fix. Thanks, Ben Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/3b1208c8-dbd2-4d23-9d78-11ee494a735d%40googlegroups.com ", "Hi Ben, No this bug was not fixed \u2014 I just have a pile of things to do. But I suggest that you want to find the root of a fixed (full) tree topology, right? So you don\u2019t need to use -g option, just -te option to supply a user-defined tree should do the job. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d8a25a56-8231-4188-a463-0c8e75bf5699%40googlegroups.com ", "Hello Mihn, Thank you for your reply. I must have missed the -te option. This works great! Thanks, Ben Ben Bettisworth PhD Student HITS gGmbH Schlo\u00df-Wolfsbrunnenweg 35 69118 Heidelberg Germany phone: +49-6221-533 fax: +49 6221 533298 email: ben.bet...@h-its.org http://www.h-its.org _________________________________________________ Amtsgericht Mannheim / HRB 337446 Managing Director: Dr. Gesa Sch\u00f6nberger Scientific Director: PD Wolfgang M\u00fcller > d/msgid/iqtree/3b1208c8-dbd2-4d23-9d78-11ee494a735d% 40googlegroups.com > -- > You received this message because you are subscribed to the Google Groups > \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an > email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/ > iqtree/d8a25a56-8231-4188-a463-0c8e75bf5699% 40googlegroups.com > -- > You received this message because you are subscribed to a topic in the Google > Groups \"IQ-TREE\" group. > To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/ > G37zb80R4Eo/unsubscribe. > To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/ > iqtree/DB3667F9-20D8-4D9D-B5B3-2C4ED00BF55B% 40univie.ac.at "]}, "T-2HqGD361Q": {"topic": "IQTree2 bootstrap and polytomies", "initializeDate": "Aug 3, 2020, 1:03:38 AM", "timeStamp": "Aug 5, 2020, 7:09:16 PM", "content": ["I used iqtree2 -s masked_alignment.fasta -m GTR -T 30 -fast -redo -czb -b 100 to construct a tree with bootstrap values. It is strange that the consensus tree has both bootstrap values and polytomies. Is it possible to show only the bootstrap values and resolve all polytomies? ", "I also tried the command without '-czb', and there are still polytomies. ", "Hi there, The consensus tree might indeed have polytomy. So that\u2019s not unexpected. If you want strictly bifurcating tree, then look at the ML tree. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9aacd5d5-2f55-42cf-bdff-f615aef05039o%40googlegroups.com "]}, "CNmAhNnKUno": {"topic": "BUG: \"Too many submissions, please wait a second and submit again\"", "initializeDate": "Oct 3, 2020, 3:31:22 PM", "timeStamp": "Oct 7, 2020, 8:08:59 AM", "content": ["I am a windows user and I've been trying to submit a job (gb file dataset with nearly 470 sequences) since one week. IqTree messages me \"Too many submissions, please wait a second and submit again\" every submission. Server load, however, has been always 3 to 4%. Please, what's happening? ", "Hi, You can also run Iqtree on cipres servers at phylo.org Cheers On Sat, 3 Oct 2020 21:31 Allan Brennecke, < allbr...@gmail.com > wrote: I am a windows user and I've been trying to submit a job (gb file dataset with nearly 470 sequences) since one week. IqTree messages me \"Too many submissions, please wait a second and submit again\" every submission. Server load, however, has been always 3 to 4%. Please, what's happening? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/308b90f6-0953-437d-b4d0-9467bb8a40fan%40googlegroups.com ", "That\u2019s right, Please switch to CIRPES server, it\u2019s much better maintained there with a dedicated team. The problem is that right now there is actually nobody maintaining iqtree.cibiv.univie.ac.at server as most co-authors left the group. Thanks for your understanding. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAC86RzFx2VNbTuXM1mxC2cGxtj9fOxghiM5pPHv-z-6Fwq%3DtnQ%40mail.gmail.com ", "Hi All, On a follow-up note: The web server works just fine if you enter an email address. Whereas this error message only occured if you don\u2019t provide it. So please submit the job with some email provided. Thanks Minh ", "Thank you Mihn, I also realized there is limitation concerning file size. My dataset had about 12MB and I had to limit some less sequence regions to be analyzed. I got File size around 8MB and it ran normally Thanks "]}, "nZLZ29kccU8": {"topic": "About how to treat Gaps", "initializeDate": "Jul 2, 2018, 11:54:55 PM", "timeStamp": "Jul 3, 2018, 2:37:31 AM", "content": ["Thanks for your working , IQ-TREE is really fast. I have a problem when I'm doing Ancestral sequence reconstruction , I aligned my CDS sequence by Muscle Codons , and all the sequences can be correctly translated into an amino acid sequence . But when I get the Ancestral sequence , I found that the Ancestral sequence contains gaps in wrong position caused the sequences can not to be correctly translated into an amino acid sequence . After I replaced the gaps into A/T/C/G , then the Ancestral sequence can be correctly translated . I know that IQ-TREE treat GAPS as unknown characters in a similar way to other ML software .In my opinion if the sequence is aligned by Codons , the gaps in Ancestral sequence should also like a Triple codon . And I know some software like MEGA , can treat gaps in \"Use all sites\" way,whether IQ-TREE has a similar setting ,sometimes the gaps also have biological significance. I am wondering if you would like add \"Use all sites\" into IQ-TREE , thanks for your work again. ", "Hi there, I need more information before answering your question. Can you pls paste the command line you used? Did you use DNA or codon models? (e.g. using codon models might be more appropriate here). What is the \u201cUse all sites\u201d option of MEGA doing? What do you mean by \u201cin wrong position\u201d? (Does it mean, that the gaps are not multiple of 3 or are not in the right frameshift?) Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "720K-Rubvwo": {"topic": "IQtree webserver not drawing svg/pdf", "initializeDate": "Jul 13, 2019, 12:57:47 AM", "timeStamp": "Jul 14, 2019, 8:26:15 PM", "content": ["Hi, The web-based version of IQtree seems to only create the pdf/svg of the output randomly, sometimes it does it and sometimes it doesn't - I believe even with the same file, is this a known bug? Many thanks in advance! :) ", "Hi Anita, Thanks for letting us know, I haven\u2019t seen this behaviour. But one thing I noticed, is that I had to wait a bit, until the SVG figure is displayed. If that does not work, then can you pls forward me the URL via my personal email. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f0e5cac0-5f94-4b49-b321-ed10fc399098%40googlegroups.com For more options, visit https://groups.google.com/d/optout "]}, "9MaMp4tR468": {"topic": "File does not start with opening bracket", "initializeDate": "Mar 11, 2020, 6:21:15 PM", "timeStamp": "Mar 12, 2020, 2:22:43 AM", "content": ["Hi, I'm trying to run a ML tree but I keep recieving the following message: ERROR: Tree file does not start with an opening-bracket '(' (line 1 column 1) The code I run is: iqtree -s passeriformes_9l.phy -m GTR+G -a 4.51 -nt 3 -bb 1000 What should I do? I saw that the example file does not have '(' but I tried to use that and ';' and I still end up recieving that messge. Thanks in advance, Raquel ", "Hi Raquel, I just ran the same commandline with your alignment in my computer \u2014 Everything works fine to the end (iqtree 1.6.12). So which version did you use? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ce734ca7-84e0-47fd-b72a-1f2639178814%40googlegroups.com <passeriformes_9l.phy> "]}, "05frwXoZIpA": {"topic": "IQ-TREE release 1.5.0", "initializeDate": "Oct 24, 2016, 3:18:23 AM", "timeStamp": "Oct 24, 2016, 3:18:23 AM", "content": ["Dear users, We are pleased to announce the major update IQ-TREE 1.5.0, available at http://www.iqtree.org Major new features: \u2022 A new posterior mean site frequency (PMSF) model as an efficient approximation to the time and memory consuming CAT profile mixture models C10 to C60 (Le et al., 2008a) ( http://dx.doi.org/10.1093/bioinformatics/btn445 ). The PMSF model is much faster and requires much less RAM than the mixture models, regardless of the number of mixture classes. Our extensive simulations and empirical deep-phylogeny data analyses demonstrate that the PMSF models can effectively ameliorate long branch attraction artefacts. For details see http://www.iqtree.org/doc/Complex-Models/#site-specific-frequency-models . To cite this model please use: Wang, H.C., Susko, S, Minh B.Q and Roger A.J. (2016) Modeling site heterogeneity with posterior mean site frequencies accelerates accurate phylogenomic estimation, Submitted. \u2022 New option -g to supply a user-defined constraint tree, which will guide subsequent tree search. The constraint tree can be multifurcating and need not to include all taxa. Bug fixes: \u2022 Crash with zero weights of mixture models for short alignments (thanks to Laura Eme for the report). \u2022 Incorrect site rate file (-wsr option) in the presence of identical sequences (thanks to Brian Foley for the report). \u2022 Memory overflow for tree topology testing for extremely long alignments (>500,000 sites) (thanks to Karen Meusemann for the report). \u2022 Rare issue with multifurcating trees and partition model (thanks to Xingxing for the report). Other changes: \u2022 A new biologist-familiar example data file example.phy, which contains mitochondrial DNAs of human, gorilla, dog, mouse, etc. The data set was taken from the phylogenetic handbook (thanks to Brian Foley for suggestion). \u2022 Printing an alignment with suffix .varsite with only variable sites if ascertainment bias correction (ASC) is not applicable. \u2022 New option -wpl to write partition-specific log-likelihoods to .partlh file (requested by Karen Meusemann). Best, IQ-TREE development team "]}, "O6tcEU64PAc": {"topic": "Re: [iqtree] Problem with creating a partition file on my non-coding sequence data", "initializeDate": "Dec 2, 2020, 7:59:34 AM", "timeStamp": "Dec 2, 2020, 7:59:34 AM", "content": ["Hi Hiroto, On 28 Nov 2020, at 8:13 am, Hiroto < s8163...@gmail.com > wrote: Hi, thanks for reading! I ran ultrafast boot strap method on my RAD-seq paired-end sequence data and obtained a consensus tree and its ultrafast boot strap value on each branch. I want to exploit how concordant the values are to my data for further discussions.Though, I am facing a problem trying to calculate a concordance factor and have some questions. First, I tried to create a partition file for my data, but I got lost which model I should choose. My data probably contains mostly non-coding regions because it was obtained from random sites on a genome. So I guess maybe GTR+I+G is the appropriate one, but I'm not sure. Which model is supposed to be the most appropriate for non-coding regions? You don\u2019t need to specify any models \u2014 let IQ-TREE decide that for you. It\u2019s enough to prepare the partitions without any model. See the guide http://www.iqtree.org/doc/Complex-Models#partition-models . If you go with a nexus file, you can ignore charpartition command. Just charset is enough. Second, can I choose Edge-proportional partition model after creating the partition file? I think all of the three models documented in the tutorial are mainly supposed to work for coding regions, so I want know whether I can apply one to my non-coding sequence data. Yes you can - why not. -p option works without needing to know the type of data you have. Cheers Minh Best wishes, Hiroto You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7ec7b89a-23d4-40ae-b617-5772f17f0955n%40googlegroups.com "]}, "O6h2pJ0y5bE": {"topic": "trees with different amount of leaves", "initializeDate": "Mar 8, 2021, 3:09:31 PM", "timeStamp": "Mar 8, 2021, 5:09:32 PM", "content": ["This is the first time I use iqtree, and I downloaded the windows version. As input I used a directory with 1500 fasta files, each with 17 taxa. As a result, I got 1500 tree files, but all with different number of taxa. Is this correct? is there an option to show all taxa in the tree (like polytomy but all). I realized this, because I was going to use these trees to estimate a phylogeny of species with ASTRAL, but ASTRAL apparently needs all the trees to have all the taxa. Someone can help me, please? Thank you very much ", "Hi Ivanna, I think in iqtree2 the option -keep_ident should be set by default, but I\u2019m not sure. Just try adding it to your command line. Cheers, Olga You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5f72560c-6763-451e-a333-d8390bc41fd7n%40googlegroups.com ", "Thank you Olga! I think it worked!! best, Ivanna You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/O6h2pJ0y5bE/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/AD32BB14-08BB-4BB8-BF28-F8DEEBB05FE0%40gmail.com Ivanna H. Tomasco Asistente del Laboratorio de Evoluci\u00f3n Departamento de Ecolog\u00eda y Evoluci\u00f3n Facultad de Ciencias Universidad de la Rep\u00fablica Igu\u00e1 4225, Montevideo 11400 Tels: (598) 2525 8618 ext. 7143 Fax: (598) 2525 8617 http://evolucion.fcien.edu.uy http://evolucion.fcien.edu.uy/ivanna/ivanna.htm "]}, "X-b3TmlEdw8": {"topic": "suitable partition model for non-coding regions", "initializeDate": "Nov 27, 2020, 11:55:07 PM", "timeStamp": "Dec 4, 2020, 8:59:31 AM", "content": ["Hi, thanks for reading! I ran ultrafast boot strap method on my RAD-seq paired-end sequence data and obtained a consensus tree and its ultrafast boot strap value on each branch. I want to exploit how concordant the values are to my data for further discussions.Though, I am facing a problem trying to calculate a concordance factor and have some questions. First, I tried to create a partition file for my data, but I got lost which model I should choose. My data probably contains mostly non-coding regions because it was obtained from random sites on a genome. So I guess maybe GTR+I+G is the appropriate one, but I'm not sure. Which model is supposed to be the most appropriate for non-coding regions? Second, can I choose Edge-proportional partition model after creating the partition file? I think all of the three models documented in the tutorial are mainly supposed to work for coding regions, so I want know whether I can apply one to my non-coding sequence data. Best wishes, Hiroto ", "Hi Hiroto, To calculate concordance factors, you will need to estimate a separate gene tree for each of your loci. The tutorial is here -- http://www.iqtree.org/doc/Concordance-Factor If I were you, I would 1) generate separate alignments for each of your ddRAD loci, 2) put all of those separate alignments into a directory, and 3) then use the -S option in iqtree 2.x to direct iqtree to that directory, which will perform separate tree inference on each of those alignments. If you combine that option with -m MFP and -B 1000 (for bootstraps) that will automatically determine the appropriate substitution model and build a gene tree for each ddrad locus. This will not consider amino acid or codon models. You may run into issues related to the fact that your ddRAD loci will be pretty short, but I think you could try this approach... Best, Jake ", "Thanks for answering, Jake. I thought a PARTITION_FILE is always required to estimate separate gene trees, but with -S option, I don't have to create PARTITION_FILE in prior to that, right? I think I was stuck at a very beginning part. I'm gonna read the pages again and start by creating separate alignments for each locus. Best, Hiroto 2020\u5e7411\u670829\u65e5(\u65e5) 3:16 jacob...@gmail.com jacob...@gmail.com You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/X-b3TmlEdw8/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7ffecdab-c384-4335-be82-c6dc834f5252n%40googlegroups.com ", "Hi Hiroto, -S is a good way to go here, so you can run the analyses to get the gene trees separately from each other. W.r.t. the models, it's not really about coding vs. non-coding. Rather, the models simply have different numbers of parameters and/or force different combinations of parameters to be equal. Which model you should choose depends on the molecular evolution of the loci you are analysing. In some cases a simple JC model is the right one, in other something more flexible like an HKY model, and often with more data you'll want a GTR model. The +I and +G are all about modelling rate variation across sites. A simple solution here is just to let modelfinder in IQ-TREE choose the best model for you. The instructions in the concordance factor tutorial will do this automatically, so you don't have to worry. (But do please cite modelfinder and IQ-TREE when you write up your work). Cheers, Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAFxNn%3DiKH9CERK%3DUNRidJrB%2B2QsqsmN1p0zxvayUMjg6Uka9qQ%40mail.gmail.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Thanks for giving me the details, Rob. Unfortunately, I'm still struggling with splitting my NEXUS file to separate ones for the size of it. So I will be able to try the -S option a bit later... Thank you for giving us this very useful option. Though I need to understand the differences between the models better, anyway I can get phylogenetic trees estimated with appropriate models. I'll gladly cite this software if I could write one. Best, Hiroto 2020\u5e7412\u67081\u65e5(\u706b) 9:09 Rob Lanfear < rob.l...@gmail.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmo%2BJihmiOhTGc%2Br-1pipEh2jFLib2iY1oV5XZdYKdv8OA%40mail.gmail.com ", "Thanks for giving me advice, Rob. I successfully obtained a NEXUS file with Sets block and got ready to run -S option today. Though, I also got an error message below. I couldn't get any solutions on the Internet. In this case, what does this \"negative site ID\" mean? This is my command iqtree -s all_markers_mintaxa20.phy -spp all_markers_mintaxa20.nex -m MFP+MERGE This is the error message below NOTE: No CharPartition defined, use all CharSets Loading 7579 partitions... ERROR: Negative site ID I want to know what kind of values were calculated and how the results became a negative one, if possible. Best, Hiroto ", "It means, something wrong with your partition file. Attach it here, we\u2019ll have a look. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAFxNn%3DgiamsC3x0iVsUE%2BiW%2BNxqO%3DRKXT6nMRVUs%3DG2d5oUhCQ%40mail.gmail.com ", "Ok I see the problem. Your file is rich text format, the first few lines below. You need to convert it into plain text format. If you used the TextEdiit program in Mac, click on \u201cFormat\u201d menu and choose \u201cMake Plain Text\u201d. {\\rtf1\\ansi\\ansicpg932\\cocoartf2513 \\cocoatextscaling0\\cocoaplatform0{\\fonttbl\\f0\\fswiss\\fcharset0 Helvetica;} {\\colortbl;\\red255\\green255\\blue255;\\red0\\green0\\blue0;} {\\*\\expandedcolortbl;;\\cssrgb\\c0\\c0\\c0\\cname textColor;} {\\info {\\title } {\\subject } {\\doccomm } {\\author } {\\*\\company } {\\*\\copyright } {\\keywords }}\\paperw11900\\paperh16840\\margl1440\\margr1440\\margb1800\\margt1800\\vieww10000\\viewh6000\\viewkind0 \\pard\\tx640\\tx1280\\tx1920\\tx2560\\tx3200\\tx3840\\tx4480\\tx5120\\tx5760\\tx6400\\tx7040\\tx7680\\slleading80\\pardirnatural\\partightenfactor0 \\f0\\fs24 \\cf2 BEGIN SETS;\\ charset 0 = 0-188;\\ charset 1 = 188-374;\\ Minh On 3 Dec 2020, at 5:59 pm, \u7530\u4e95\u535a\u767b < s8163...@gmail.com > wrote: Hi, Minh. I've attached the \"SETS BLOCK\" part to this message. Hope you will check this out. I always appreciate your great help. Hiroto 2020\u5e7412\u67082\u65e5(\u6c34) 22:19 Minh Bui < minh...@univie.ac.at <sample_set_block.txt> ", "Ok as you converted it to plain text properly, I now see other problems: - Site ID starts from 1, not 0. You started from 0, which is not correct. - A charset from site x to y are inclusive of the boundary x and y. So something like: charset 0 = 0-188; charset 1 = 188-374; will cause site 188 to occur in both partition 0 and 1. This might not be what you want. - Please better name the charset with a letter at the beginning, to avoid potential misbehaviour. So name them something like p0, p1, \u2026, instead of 0, 1,\u2026 That\u2019s it, I think. Minh On 4 Dec 2020, at 4:37 pm, \u7530\u4e95\u535a\u767b < s8163...@gmail.com > wrote: Thank you, Minh. I copied the whole content in the NEXUS file to a new file using Text Edit and ran the command with that again, but the same error message occured. As far as I can see, there seems to be no problem with it. I wish you would take a look at it again. Best, Hiroto <set_block.txt> "]}, "S8H7XLRkOIw": {"topic": "dealing with partially phased data", "initializeDate": "Apr 10, 2019, 10:33:45 AM", "timeStamp": "Apr 11, 2019, 6:36:24 AM", "content": ["Hi, I have a question now on how best to deal with partially phased data (conversion to counts). in the cfib manual u say: If heterozygotes are encoded with IUPAC codes (e.g., 'r' for A or G), homozygotes need to be counted twice so that the level of polymorphism stays correct. This can be done with the `--iupac` flag. but often (in real life) we have datasets (fasta) of partially phased data, where there are two sequences per individual, most positions are phased but some (whose phasing posterior probability - if one was using statistical phasing - was bellow some confidence threshold) kept coded with the ambiguity code (thus being coded as \"R\" for example in both sequences of the same individual - in this case the intention was that it represents uncertainty in a ML inference for example)... so, what would be the best option here: 1) use unphased alignments as input to \"FastatoCounts.py\" - as here the phasing does not matter [with the IUPAC flag] 2) use the IUPAC flag in the \"phased\" alignments: this will make every count double, if I understand well, but should keep the proportions the same... would this bias the analyses somehow? any other effect than increasing runtimes is predicted? Because this could be the easiest way fw when from the original unphased alignments suffered considerable modifications after phasing (removal of positions, sequences, etc... sometimes hard to traceback) 3) exclude these sites [an option if they are not many I guess] A related question is: what does it do with positions with indels (\"-\"): are these automatically discarded or one needs to remove them in advance? thanks in advance, sara ", "Hi Sara, please find comments to your questions below! Sara Rocha < spr...@gmail.com > writes: > Hi, > I have a question now on how best to deal with partially phased data > (conversion to counts). > in the cfib manual u say: > If heterozygotes are encoded with IUPAC codes (e.g., 'r' for A or G), > homozygotes need to be counted twice so that the level of polymorphism > stays correct. This can be done with the `--iupac` flag. > but often (in real life) we have datasets (fasta) of partially phased data, > where there are two sequences per individual, most positions are phased but > some (whose phasing posterior probability - if one was using statistical > phasing - was bellow some confidence threshold) kept coded with the > ambiguity code (thus being coded as \"R\" for example in both sequences of > the same individual - in this case the intention was that it represents > uncertainty in a ML inference for example)... > so, what would be the best option here: > 1) use unphased alignments as input to \"FastatoCounts.py\" - as here the > phasing does not matter [with the IUPAC flag] This is definitely an option, since PoMo does not use the information provided by phased data. > 2) use the IUPAC flag in the \"phased\" alignments: this will make every > count double, if I understand well, but should keep the proportions the > same... would this bias the analyses somehow? any other effect than > increasing runtimes is predicted? Because this could be the easiest way fw > when from the original unphased alignments suffered considerable > modifications after phasing (removal of positions, sequences, etc... > sometimes hard to traceback) In theory, duplicating your counts should not change the results, because the level of heterozygosity is unchanged. However, it also increases your the \"certainty\" about the heterozygosity (i.e., an observation 3A/3C has 50 percent A and 50 percent C, and so does an observation 50A/50C; with the former, you can roughly guess that the actual frequency in the population will be also 50 percent, but with the latter you can be much more sure sure that the actual frequency in the population will be close to 50 percent). In summary, you can use this method (because you only multiply by two), but I would use it with care. What is the difference to suggestion (1) btw? Do you have some data that is phased only? > 3) exclude these sites [an option if they are not many I guess] I don't think this is necessary (but if there are very few sites). Why not use suggestion (1) instead? > A related question is: what does it do with positions with indels (\"-\"): > are these automatically discarded or one needs to remove them in advance? Those get zero counts, so no need to do anything here. I hope I could help! Dominik > thanks in advance, > sara ", "answers bellow also: Sara Rocha Post-Doc Researcher Phylogenomics Group University of Vigo (Spain) http://darwin.uvigo.es/sara-rocha/ On 11 Apr 2019, 10:35 +0200, Dominik Schrempf < dominik....@gmail.com >, wrote: Hi Sara, please find comments to your questions below! Sara Rocha < spr...@gmail.com > writes: Hi, I have a question now on how best to deal with partially phased data (conversion to counts). in the cfib manual u say: If heterozygotes are encoded with IUPAC codes (e.g., 'r' for A or G), homozygotes need to be counted twice so that the level of polymorphism stays correct. This can be done with the `--iupac` flag. but often (in real life) we have datasets (fasta) of partially phased data, where there are two sequences per individual, most positions are phased but some (whose phasing posterior probability - if one was using statistical phasing - was bellow some confidence threshold) kept coded with the ambiguity code (thus being coded as \"R\" for example in both sequences of the same individual - in this case the intention was that it represents uncertainty in a ML inference for example)... so, what would be the best option here: 1) use unphased alignments as input to \"FastatoCounts.py\" - as here the phasing does not matter [with the IUPAC flag] This is definitely an option, since PoMo does not use the information provided by phased data. yep! 2) use the IUPAC flag in the \"phased\" alignments: this will make every count double, if I understand well, but should keep the proportions the same... would this bias the analyses somehow? any other effect than increasing runtimes is predicted? Because this could be the easiest way fw when from the original unphased alignments suffered considerable modifications after phasing (removal of positions, sequences, etc... sometimes hard to traceback) In theory, duplicating your counts should not change the results, because the level of heterozygosity is unchanged. However, it also increases your the \"certainty\" about the heterozygosity (i.e., an observation 3A/3C has 50 percent A and 50 percent C, and so does an observation 50A/50C; with the former, you can roughly guess that the actual frequency in the population will be also 50 percent, but with the latter you can be much more sure sure that the actual frequency in the population will be close to 50 percent). In summary, you can use this method (because you only multiply by two), but I would use it with care. What is the difference to suggestion (1) btw? Do you have some data that is phased only? yeah, in practice sometimes you postprocess the alignments after the original phasing (a variety of reasons such as eliminating gaps or even individuals/allelles you decided to exclude\u2026). real data :S I see what you mean by the proportions, thanks! an easy turnaround I guess is to use the flag (allow duplication of counts) and then divide the whole matrix/2. that\u2019s probably what I will script, thanks! 3) exclude these sites [an option if they are not many I guess] I don't think this is necessary (but if there are very few sites). Why not use suggestion (1) instead? A related question is: what does it do with positions with indels (\"-\"): are these automatically discarded or one needs to remove them in advance? Those get zero counts, so no need to do anything here. right\u2026 so, heterozygous individuals for indels\u2026 such as: ind1a AA - - - CTCT ind1b AAG T G CTCT will cause \"biased\" counts these positions, no? again, I don\u2019t have a good feeling for the influence of this, which is not contemplated in the PoMo model I think\u2026 I know that in other phylogenetic inferences (ML) they are also considered as missing data, so perhaps its equivalent\u2026 I think I will leave them s they are (no huge messy regions) but, out of curiosity, would you think that by the way that PoMo works one does better by eliminating these zones previously, if for example one has locus with large (and of high frequency) gappy regions? I hope I could help! you did of course! many many thanks, really! Dominik thanks in advance, sara You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Sara, I don't think that individuals heterozygous for indels would lead to biases. Basically, PoMo ignores the gap but uses the information of the second haplotype. If heterozygosity for indels is very prevalent, you may want to be more careful, of course! I am glad that I could help :). Best, Dominik "]}, "yWWLGI7ljM0": {"topic": "different version, different tree topology", "initializeDate": "Aug 6, 2015, 4:32:11 AM", "timeStamp": "Aug 6, 2015, 6:45:04 AM", "content": ["Dear Iqtree developers, I used the same command to invoke Iqtree 1.3.4 and Iqtree 1.3.5 estimating phylogeny from the same data. However, I got quite different tree topology. I do not know why? Would you please help? I use a pre- compiled version, on Linux Ubuntu I specify \"-m TEST -bb 1000 -alrt 1000 -lbp 1000\" Thank you in advanced! Best regards, Giap Nguyen ", "Dear Giap, Algorithmically there are no difference from version 1.0 up to now (1.3.5). What you observed is because of the stochastic component of the algorithm; in fact we showed that 10 different runs of IQ-Tree (and also other software) might result in different trees. I will look at the resulting log-likelihoods to decide. If the log-likelihoods are not much different, then I will simply take the tree with the highest log-likelihood. I can give further advice if you provide me these log-likelihood values. Moreover, how many sequences do you have? what is your sequence length? Best, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Dear Giap, now looking at the .iqtree report file, you have an alignment with 1529 sequences but the sequence length of only 708. This is a difficult data set with many-but-short sequences. That\u2019s why IQ-Tree printed the big warning due to small sample size. Analyzing such data is not trivial. What I would do first is to run multiple times and also change the default search parameter, most importantly this parameter: -pers <perturbation> Perturbation strength for randomized NNI (default: 0.5) the default of 0.5 is too high here, I would change to 0.1 and run IQ-Tree 10 times again to see if I gain higher log-likelihood. After that I will also perform tree topology test for the 10 resulting trees (see option -z and -zb) to test if there are significant difference. Those trees that are not rejected will need to be considered further (not just the single highest likelihood tree). Secondly, you may also try to reduce the number of sequences if possible\u2026 for example, are there any chimeric sequences? Are there long branch leading to single sequences? They are known to disturb the tree topology and should be discarded. Then I will also try to cluster sequences with high similarity and just pick one representative sequence from each cluster for tree reconstruction. Hope that helps Minh On 06 Aug 2015, at 11:11, Giap Nguyen < nguyen...@gmail.com > wrote: Dear Minh, Thank you for your prompt reply. I include two log files in the attachment. Once of the thing that is the warning message about number of parameters >> number of sites. Thank you so much! Best regards, Giap Nguyen <pcv1-pcv2-orf2-elimdupes-nu-al.txt.iqtree1.3.4> <pcv1-pcv2-orf2-elimdupes-nu-al.txt.iqtree1.3.5> ", "Hi Giap, yes this option will do the job: -wsl Writing site log-likelihoods to .sitelh file Best, Minh On 06 Aug 2015, at 12:01, Giap Nguyen < nguyen...@gmail.com > wrote: Dear Minh, Yes, it is really helpful. About the topology test implemented in Iqtree, does the program printout per-site likelihoods like Tree-puzzle? (because I would like to use AU test). Thank you so much! Giap Nguyen "]}, "n6p_7IN7ASo": {"topic": "IQ-TREE release 1.6.0", "initializeDate": "Dec 24, 2017, 7:24:08 AM", "timeStamp": "Dec 24, 2017, 7:24:08 AM", "content": ["Dear users, We are pleased to announce the major release 1.6.0 of the IQ-TREE software for phylogenomic reconstruction ( http://www.iqtree.org ). Among others, notable new features include: * Many new realistic models of sequence evolution: Heterotachy, Lie Markov and Polymorphism-aware Models. * Three new empirical protein models mtMet, mtVer, mtInv for mitochondrial evolution. * Improved ModelFinder allowing to test all above models. For partitioned analysis ModelFinder now supports edge-linked partition model selection and fast relaxed clustering algorithm (-rclusterf option) like PartitionFinder2. * A fast tree search option to match the speed of FastTree while still obtaining better trees (-fast option). * Ancestral sequence reconstruction (-asr option). * An option to reduce the impact of model violation for the ultrafast bootstrap (-bnni option). * Xeon Phi Knights Landing (AVX-512 instruction set) support. Kind regards, IQ-TREE development team Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "avn6Vs3KoEE": {"topic": "-nt AUTO stops at 5 threads?", "initializeDate": "Apr 12, 2017, 7:35:10 PM", "timeStamp": "Apr 13, 2017, 4:56:21 AM", "content": ["Hello, When testing -nt AUTO, for me on a couple of test runs it always seems to stop at 5 threads, and selects 4 as the best number of threads (despite 5 showing up as being faster, and there being 16 CPU available)... Seems to be like this whether I'm running it with a PBS qsub command, or interactively. Am I doing something wrong? Is it stopping at 5 because it doesn't see much speedup between 4 and 5? Many thanks for any help, and you efforts in creating this great piece of software, Al. eg: NOTE: 55 MB RAM (0 GB) is required! Measuring multi-threading efficiency up to 16 CPU cores Increase to 10 rounds for branch lengths 17 trees examined Threads: 1 / Time: 16.980 sec / Speedup: 1.000 / Efficiency: 100% / LogL: -128783 Threads: 2 / Time: 10.365 sec / Speedup: 1.638 / Efficiency: 82% / LogL: -128783 Threads: 3 / Time: 8.229 sec / Speedup: 2.063 / Efficiency: 69% / LogL: -128783 Threads: 4 / Time: 7.217 sec / Speedup: 2.353 / Efficiency: 59% / LogL: -128783 Threads: 5 / Time: 6.799 sec / Speedup: 2.498 / Efficiency: 50% / LogL: -128783 BEST NUMBER OF THREADS: 4 ", "Dear Al, Thanks for using IQ-TREE. The best number of threads must fulfill 2 criteria: 1. Parallel efficiency > 50% (i.e., for k threads, speedup must be > k/2), AND 2. Runtime must be at least 5% smaller than the second best. For your example, using 5 threads is ~6% faster than 4 threads, so the 2nd criterion is fulfilled. But the 1st criterion is not satisfied (efficiency <= 50%). So there is not much gain, because I suspect that your alignment is not so long. See also http://www.iqtree.org/doc/Tutorial#utilizing-multi-core-cpus Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "C144ByJtyZ4": {"topic": "IQ-TREE release 1.5.3", "initializeDate": "Jan 16, 2017, 4:26:15 AM", "timeStamp": "Jan 16, 2017, 4:26:15 AM", "content": ["Dear users, We are pleased to announce IQ-TREE version 1.5.3, which improves software stability. We thank all users mentioned below for the reports. Bug fixes: \u2022 Crash for +R+ASC model (reported by olaf.thalmann). \u2022 Improper multiple restart for I+G model optimization (reported by 98w8h1). \u2022 For large data sets with many sequences: \u2022 Incorrect handling of numerical underflow when all state likelihoods are zero (reported by Gerhard Jaeger). \u2022 Numerical underflow for invariant sites (reported by ledum_laconicum, kelly.schiro). Other changes: \u2022 Invariable (+I) site model now considers ambiguous constant sites. \u2022 -wba (write bootstrap alignments) works now with standard bootstrap (-b). Best, IQ-TREE development team "]}, "FC6uut7fmGk": {"topic": "different statistics in a *rate file and in a *.iqtree report file", "initializeDate": "Sep 13, 2017, 9:01:36 AM", "timeStamp": "Sep 14, 2017, 7:22:22 AM", "content": ["Dear IQTree Team, I have noticed that the proportions of rates belonging to each R class when +R(#) model is specified are reported differently in *rate file and in the *.iqtree files. I use IQ-TREE multicore version 1.6.beta4 for Linux 64-bit built Jun 21 2017. For example, the program, if called: iqtree -s mydata.phy -m \"GTR{2.739,3.446,0.867,2.577,6.792}+F{0.307,0.149,0.170,0.374}+R3\" -te GTR.treefile -wsr -nt 8 outputs the following model parameters on a screen: Site proportion and rates: (0.417,0.063) (0.335,0.753) (0.248,2.907) which is reflected in the *.iqtree report file: Category Relative_rate Proportion 1 0.06283 0.4165 2 0.7532 0.3354 3 2.907 0.2481 At the same time in the *rate file the sites are assigned to each rate differently. The numbers of sites belonging to categories in the *.rate file (I calculated them manually) always correspond to the empirical proportions the program outputs on a screen, e.g: \"Empirical proportions for each category: 0.442 0.315 0.243\". Could you tell me how many sites should I assign to each category if I wish to simulate parametric replicates under a GTR+R# model? Should I take the numbers of sites assigned to the categories from the *.rate file (which proportions in the input alignment correspond to 0.442, 0.315 and 0.243? Or should I infer such numbers from proportions from the *.iqtree report file (0.4165, 0.3354, 0.2481)? I would also appreciate if you tell me the reason for above disparity in program reports. Thank you for your help, Vadim P.S. I used +R3 option in model specification only to provide an example. I have observed above disparity in the *.iqtree report files and in the *.rate files in a number of different program runs. ", "Dear Vadim, The short answer is: use rates and proportions printed in .iqtree report file, i.e., this one: Site proportion and rates: (0.417,0.063) (0.335,0.753) (0.248,2.907) which is reflected in the *.iqtree report file: Category Relative_rate Proportion 1 0.06283 0.4165 2 0.7532 0.3354 3 2.907 0.2481 Further information: you are correct that this line \"Empirical proportions for each category: 0.442 0.315 0.243\". correspond to the number of sites classified into each category (as also computed from .rate file). However, this is done by taking the posterior maximum and is not necessarily a good classification. For example, if a site shows posterior probabilities of 0.2,0.39,0.41 of belonging to category 1,2,3, respectively. Then this site is put into category 3, but it may well fall into category 2 as well because the signal is not strong. Therefore, the \u201cempirical\u201d counting is only an approximation. On the other hand, the estimates in .iqtree file are inferred by maximum likelihood, and thus should be used. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "vRLnhkF9_cM": {"topic": "Could you share with the R code for the concord.cf.stat?", "initializeDate": "Jun 28, 2019, 3:18:56 AM", "timeStamp": "Jun 30, 2019, 8:10:39 PM", "content": ["Hi everyone, I want to look at the links between bootstrap, gCF, and sCF across all nodes of the tree. But I cann't open the link in https://gist.github.com , where you placed the code.Could you paste the R code for showing the concord.cf.stat, which you used in http://www.robertlanfear.com/blog/files/concordance_factors.html at section \"How concordance factors relate to each other and to bootstraps\". Thanks. Cheers, Jessica ", "Hi Jessica, Rob (CC here) will better answer this question. I think you can click on \u201cview raw\u201d at the bottom right of the code snippet. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/93546d9e-a94d-4627-86c3-15471bc6ab32%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Hi Jessica, Minh is right. But if that's not working, here's the link: https://gist.github.com/roblanf/992ed3b37eca757ce91b9ed5da15554e You need up to line 21 to make the plot int the section you were interested in. Rob "]}, "73pWbIEHDXU": {"topic": "RF distances", "initializeDate": "Dec 13, 2016, 4:20:14 PM", "timeStamp": "Dec 16, 2016, 1:06:12 PM", "content": ["Hello, I'm trying to calculate Robinson-Foulds distances between a species tree and a set of gene trees. IQ Tree seems to be working fine when the number of species (14) between the species and gene trees are equal, yielding RF distances between 2 and 12. However, when my gene trees only contain 13 species (i.e. missing one species), the RF distance approaches 50 despite very similar topologies between the trees. I'm wondering if there is a way to account for the difference in the number of taxa. I've dividing the RF distance by (2x(number of shared taxa-3)) as suggested by Rosenburg and Kumar (2001), but this still results in about a 10 fold difference between RF rates for gene trees with 14 vs 13 species. Many thanks, Mike ", "Dear Mike, I don\u2019t think that the RF distance computation in IQ-TREE works in this case ;-). It should have printed a warning or error that the two trees do not have the same taxon set (will add this check in the future release). In fact I did not have a definition for RF distances for trees with different taxon sets. Thus can you briefly describe it? Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Mike, as Minh said this is not really an application for Robinson-Foulds distance. Please remember that the RF distance is defined as the distance between two trees, computed as (the number of splits, i.e. edges, in the one tree, but not in the other) + (the number of splits in the other tree, but not in the one). Since a split is a bipartition listing all taxa/leafs/sequences on the one side versus the taxa/leafs/sequences on the other side of an edge/branch in the tree, e.g. AB|CD denotes the split over the inner edge in a tree of 4 sequences named A,B,C and D which has A,B on the one side and C,D on the other. Thus, if the trees have different leaf-sets, all splits are different by definition and thus there must be a maximal RF distance. If you want to use RF in such a context, you have to (at least) reduce the trees to the set of taxa/leafs they have in common. That means, you have to first remove the leafs which are in only one of the trees compared and then apply the RF distance to the so-called \u201cinduced subtree\u201d or \u201cpruned tree\u201d as referred to by Rosenberg and Kumar (2001). So they did the same I suggested above. Dividing the RF by \u201c(2x(number of shared taxa-3))\u201d (= the total number of internal edges in the two \u201cinduced subtrees\u201d or \u201cpruned trees\u201d), converts the RF from number of splits to fraction (percentage if multiplied by 100) of differing edges, which has nothing to do with the fact that the original trees had different leaf-sets. This is typically done to make the now \u2018relative\u2019 RF values comparable between different pairs of compared trees. Please keep in mind that this normalisation to relative RFs is only valid if both trees are fully resolved, otherwise 2N-3 does not reflect the total number of edges. I hope I could help. Best wishes, Heiko ", "Hi Heiko, thanks for the clarification. This way, it is easy to compute the RF distance between the induced subtrees by the common taxa between two trees. However, it does not fulfill all the criteria of a metric: 1. d(T1,T2) >= 0 for any two trees T1 and T2. This criterion is fulfilled. 2. d(T1,T2) = 0 <-> T1=T2. This is NOT fulfilled. E.g. if T1 and T2 do not share any taxa, then their distance = 0. 3. d(T1,T2)=d(T2,T1). This is fulfilled. 4. d(T1,T2) <= d(T1,T3) + d(T2,T3). This is NOT fulfilled. So I prefer to have some other definition which satisfies all these conditions of a metric. Much like the original RF distance is a metric when trees have the same taxon set. Will be great if somebody points to the literature about this. Minh ", "Minh and Heiko, Thank you both very much for your help here. Minh, I'm pretty unfamiliar to this so I'm not sure I can answer your questions. Heiko, you mentioned that the normalized RF is only valid if both trees are fully bifurcating. Unfortunately, I do have polytomies in some of my gene trees, so it seems that the normalization will not work for me. Is the non-normalized RF distance still valid when comparing a gene tree with polytomies to a fully bifurcating species tree? My gene trees were made with GARLI which collapses branches below a length of 1e-8. Essentially, what I am try to do is get an idea of the level of ILS within my set of gene trees, but I'm not sure that this will work since I have polytomies. Thanks, Mike "]}, "hn9E0VW8faQ": {"topic": "BUG: concordance factors", "initializeDate": "Dec 6, 2018, 12:47:59 AM", "timeStamp": "Dec 17, 2018, 11:21:08 AM", "content": ["Wonderful to see the addition of concordance factors! I gave it a spin with 52 taxa and 14,265 gene trees. The gene trees were previously computed with raxml-ng, and species tree with Astral3. I was very happy to obtain the gCF & sCF results as node labels, but the program failed when preparing the stats table. Also, why does the program report 53 taxa, not 52? Here is the log: IQ-TREE multicore version 1.7-beta6 for Linux 64-bit built Nov 19 2018 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: groot.cgrb.oregonstate.local (AVX, FMA3, 503 GB RAM) Command: iqtree -t Junmin2018.CDS-14265.raxml.boot_10.Astral3.tre --gcf Junmin2018.CDS-14265.raxml-ng.best.tre -p alignments-only --scf 100 --prefix Junmin2018.iqtree.concord -nt 30 Seed: 410851 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Dec 5 20:23:31 2018 Kernel: AVX+FMA - 30 threads (64 CPU cores detected) ... Reading tree Junmin2018.CDS-14265.raxml.boot_10.Astral3.tre ... 53 taxa and 103 branches Reading tree(s) file Junmin2018.CDS-14265.raxml-ng.best.tre ... 14265 un-rooted tree(s) loaded Trees have different number of taxa Computing gene concordance factor... 5.069 sec Computing site concordance factor... 1137.705 sec Tree with concordance factors written to Junmin2018.iqtree.concord.cf.tree Tree with branch IDs written to Junmin2018.iqtree.concord.cf.branch ERROR : Could not find neighbors of node 43 ERROR: node.cpp:176: Neighbor *Node::findNeighbor(Node *): Assertion `0' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: Junmin2018.iqtree.concord.log ERROR: *** Alignment files (if possible) Any ideas? Thank you, Aaron ", "Hi Aaron, Thanks for giving it a try and finding the problem this quick. I haven\u2019t tested the combination of ASTRAL tree + raxml gene trees. Thus, can you please send me via personal email the two input trees files for debugging purpose? Regarding but the program failed when preparing the stats table. Also, why does the program report 53 taxa, not 52? Here is the log: I think ASTRAL printed a rooted tree, and the root is treated as one extra taxon in IQ-TREE. I think that could have caused the crash. Nevertheless, I\u2019ll find out once seeing your data. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hello, I have tried too the new gCF analyses. Same as Aaron i used an Astral 3 species tree and gene trees generated by iqtree (1466). Same my species tree as 122 leaves but the analyses report 123. But the analysis was performed 9only gCF). But I was confused about some results as I have node labels with a local posterior probability (Astral lpp) of 1 and a gCF of 0; which is also in contradiction with PhyParts results (e.g. a node can have a lPP of 1; phypart 1448 gene concordant and 17 not concordante; gCF of 0). This could be due to error with the leaves number? Here is the output report: IQ-TREE multicore version 1.7-beta6 for Linux 64-bit built Nov 19 2018 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: frontend8 (AVX2, FMA3, 125 GB RAM) Command: ./iqtree -t Ptero_nuc1466_Astral.tre --gcf ./Genes_tree/loci.treefile --prefix concord -nt 4 Seed: 68569 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Dec 12 16:41:12 2018 Kernel: AVX+FMA - 4 threads (48 CPU cores detected) Reading tree Ptero_nuc1466_Astral.tre ... 123 taxa and 243 branches Reading tree(s) file ./Genes_tree/loci.treefile ... 1466 un-rooted tree(s) loaded Trees have different number of taxa Computing gene concordance factor... 1.041 sec Tree with concordance factors written to concord.cf.tree Tree with branch IDs written to concord.cf.branch Concordance factors per branch printed to concord.cf.stat Date and Time: Wed Dec 12 16:41:14 2018 is there a way to fix the problem? Thanks Nicolas ", "Hi Nicolas, There was no crash, so right now I can\u2019t think that\u2019s a problem. Anyway I have posted version 1.7-beta7 that fixed issue with rooted trees: https://github.com/Cibiv/IQ-TREE/releases Let me know how that works. FYI: I have seen dataset, where bootstrap support for a branch is 100% but that branch only occurred once among the gene trees. So case like this is not totally unexpected. See also a very nice blog post by Rob Lanfear: http://www.robertlanfear.com/blog/files/concordance_factors.html Cheers Minh ", "Hi Minh, Thank you very much for your message. I have downloaded the last version. The new version work correctly and report the correct number of leaves. I have tested using as input a Astral species tree or the concatenated ML tree. Yes for the backbone nodes of my tree (which looks like as an hard polytomy) I have local Posterior Probability (statistic calculated by Astral 3) very high but gCF null. When I will have bootstrap values of my concatenated ML tree I will look if i got very high BS/very low gCF. Thanks for the link to the blog very useful. Best, Nicolas "]}, "hd9H7puQ9Rg": {"topic": "Ablity to test only the MrBayes models", "initializeDate": "Dec 7, 2014, 11:32:09 PM", "timeStamp": "Dec 8, 2014, 4:28:31 AM", "content": ["Hi All, I saw in the webpage of IQTREE that there is an ability to test only for the MrBayes models in the Modelselection function (-m TEST). what commands would do that operation: -m TESTONLY = tests for all the models available in jMODELTEST -m TESTONLY -mset mrbayes = tests for all models that can be used in MrBayes -m TESTONLY -mset partitionfinder = tests for all models that can be used in PhyML am I correct with the above command line parameters. Siby. ", "Dear Siby, correct except that: -m TESTONLY = test all models available in IQ-TREE Note that \u201c-m TESTONLY -mset partitionfinder\u201d also corresponds to all models available in jModelTest/ProtTest because these programs use PhyML as the likelihood kernel. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at "]}, "nbukiznWLyI": {"topic": "New to IQ tree and cannot run on windows", "initializeDate": "Apr 4, 2019, 3:07:30 PM", "timeStamp": "Apr 9, 2019, 8:57:30 PM", "content": ["I'm an undergrad learning how to do a phylogeny, I have iq tree 1.6.10 downloaded, but I cannot get command prompt to open the file even at the destination cd downloads\\iqtree-1.6.10-Windows. I get an error \" 'iqtree-1.6.10-Windows' is not a recognized as an internal or external command, operable program or batch file\" Anyone know what to do? ", "Hi Alex, Have you followed this starting guide: http://www.iqtree.org/doc/Quickstart#for-windows-users Minh On 5 Apr 2019, at 6:07 am, Alex Maile < alexj...@gmail.com > wrote: I'm an undergrad learning how to do a phylogeny, I have iq tree 1.6.10 downloaded, but I cannot get command prompt to open the file even at the destination cd downloads\\iqtree-1.6.10-Windows. I get an error \" 'iqtree-1.6.10-Windows' is not a recognized as an internal or external command, operable program or batch file\" Anyone know what to do? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "k7SRmOdVz1Y": {"topic": "Algorithm for -m TESTONLY", "initializeDate": "Nov 13, 2018, 8:55:29 AM", "timeStamp": "Nov 13, 2018, 7:29:57 PM", "content": ["Hy all, I am confused with the algorithm for -m TESTONLY these days. The document says \"Perform standard model selection like jModelTest (for DNA) and ProtTest (for protein).\", in this way I am not sure whether the command -m TESTONLY invoke the algorithm of jModelTest and ProtTest (they are used as plugin programs) or the algorithm of ModelFinder itself. Thanks in advance Best Dong ", "Hi Dong, ModelFinder has its own implementation, which resembles the behaviour of jModelTest, ProtTest but 10 times or more faster. So no plugin at all. In fact, jModelTest is just a wrapper around PhyML. That\u2019s one reason why it\u2019s slower. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "I get it, thank you very much. \u5728 2018\u5e7411\u670814\u65e5\u661f\u671f\u4e09 UTC+8\u4e0a\u53486:15:31\uff0cMinh Bui\u5199\u9053\uff1a "]}, "G2hyvHv0pTk": {"topic": "Crash with Assertion `mem_id == 2' failed", "initializeDate": "Feb 15, 2017, 5:59:26 AM", "timeStamp": "Feb 16, 2017, 5:07:33 AM", "content": ["Dear IQtree dev team & co., I'm making a tree for several versions of a relatively long matrix. The first version has 574 genes, 43 species, 1,107,096 nucleotide sites, and 3.8% missing data, and the analysis works perfect. I'm partitioning the data matrix by gene. For the second and third versions I remove some genes and some sequences from genes, according to different criteria, and re-make the supermatrix by plotting the species that were removed in some genes as missing data. For example, the second version has 538 genes, also 43 species, 1,024,023 nucleotide sites and 20% missing data, but it fails (see head and tail of the .log file below). Thanks a lot for any help, and please let me know if you need the data files and where to send them to. Best, HEAD: IQ-TREE multicore version 1.5.3 for Linux 64-bit built Jan 15 2017 Copyright (c) 2011-2016 Nguyen Lam Tung, Olga Chernomor, Arndt von Haeseler and Bui Quang Minh. Host: gruezi (AVX, 252 GB RAM) Command: iqtree-omp -s OrthoMam_LS3d_NT.phy -spp partits_LS3.nex -alrt 1000 -bb 1000 -nni1 -nt 2 Seed: 916753 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Feb 15 10:12:24 2017 Kernel: AVX - 2 threads(8 CPU cores detected) Reading partition model file partits_LS3.nex ... Reading alignment file OrthoMam_LS3d_NT.phy ... Phylip format detected Alignment most likely contains DNA/RNA sequences Alignment has 43 sequences with 1024023 columns and 518115 patterns (350053 informative sites, 507407 constant sites) Gap/Ambiguity Composition p-value 1 Macreuge 22.92% failed 0.00% 2 Monodome 2.42% failed 0.00% 3 Ornianat 10.12% failed 0.00% 4 Sarcharr 5.71% failed 0.00% 5 Echitelf 56.21% failed 0.00% 6 Proccape 32.89% failed 0.00% 7 Loxoafri 6.71% passed 74.63% 8 Dasynove 7.73% failed 0.00% 9 Cholhoff 22.25% failed 0.00% 10 Ailumela 12.42% failed 0.00% 11 Bostaur 19.25% failed 0.00% 12 Calljacc 8.49% failed 0.00% 13 Canifami 11.70% passed 79.24% 14 Caviporc 49.31% failed 0.00% 15 Chlosaba 7.90% failed 0.00% 16 Dipoordi 48.84% failed 0.00% 17 Equucaba 8.79% failed 0.04% 18 Erineuro 56.53% failed 0.00% 19 Felicatu 12.12% failed 0.00% 20 Gorigori 8.74% failed 0.00% 21 Homosapi 2.43% failed 0.00% 22 Ictitrid 22.72% failed 0.00% 23 Macamula 11.38% failed 0.00% 24 Micrmuri 24.44% failed 0.00% 25 Musmusc 63.40% failed 0.00% 26 Mustfuro 17.14% passed 51.85% 27 Myotluci 21.52% failed 0.00% 28 Nomaleuc 5.75% failed 0.00% 29 Ochoprin 57.67% failed 0.00% 30 Oryccuni 30.37% failed 0.00% 31 Otolgarn 19.46% passed 91.52% 32 Ovisarie 20.40% failed 0.00% 33 Pantrog 4.25% failed 0.00% 34 Papihama 9.14% failed 0.00% 35 Pongabel 5.50% failed 0.00% 36 Ptervamp 12.87% failed 0.02% 37 Rattnorv 67.51% failed 0.00% 38 Sorearan 61.53% failed 4.18% 39 Susscro 20.34% failed 0.00% 40 Tarssyri 26.79% failed 0.00% 41 Tupabela 36.26% failed 0.44% 42 Turstrun 11.33% failed 0.00% 43 Vicupaco 25.87% failed 0.17% WARNING: 6 sequences contain more than 50% gaps/ambiguity **** TOTAL 23.00% 39 sequences failed composition chi2 test (p-value<5%; df=3) TAIL: Parameters optimization took 67 rounds (1376.740 sec) Computing ML distances based on estimated model parameters... 13.797 sec Computing BIONJ tree... 0.069 seconds Log-likelihood of BIONJ tree: -8573992.868 -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Generating 98 parsimony trees... 513.861 second Computing log-likelihood of 98 initial trees ... 1391.733 seconds Current best score: -8570471.139 Do NNI search on 20 best initial trees STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: partits_LS3.nex.log *** Alignment files (if possible) ", "Dear C, thanks for reporting this bug. When you removed the gene sequences, is there any gene that has only 1 or 2 sequences left? If so, can you please remove such gene entirely? I suspect the problem is there. If this is not the case or the problem still persists, please send me your input data personally. Minh PS: Is there any reason why you used option -nni1? The default is -nni5, which actually makes the search more thorough. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "aFY83ZhItZM": {"topic": "Questions on position rate calculations.", "initializeDate": "Jan 18, 2021, 6:33:44 AM", "timeStamp": "Feb 19, 2021, 5:47:11 PM", "content": ["Hi Minh and everyone, Recently I've been experimenting with using IQ-Tree to calculate protein sequence position rates, as an alternative to Rate4site and LEISR but there are some points that aren't entirely clear and you might be able to assist with. 1) Rate4site normalizes the rates into z-scores but afaik LEISR doesn't. How does iqtree behave for either bayesian or ML rates? A per-gene normalization by the gene median (or the median across the entire complex studied) might be in order for raw rates. 2) There are a couple of references indicating that accuracy is better when using a JC-like model such that is available on LEISR (e.g. doi:10.1093/molbev/msy127). Unless I'm mistaken, as an equal rates matrix, that would be the equivalent of Poisson for iqtree, right? 3) Another thing I've messed with is the rate categories. For ML rates, including among site rate heterogeneity is not supposed to make much of a difference (previous ref), but I've found that adding +R or +G tends to make the rates of positions in the highest categories shoot up even by an order of a magnitude. Any ideas about why this happens? I've been able to replicate such behavior in LEISR too. 4) Based on the above I think I've come up with a strategy to get the best of all possible worlds when using iqtree for rate calculation. First estimate the ML tree (with Modelfinder or whichever other method) and retain it in the next round with -t and -blfix. Then, do one run for bayesian rates with Poisson+R16 (essentially a fusion of the ref above and rate4site but free rates instead of the default G16). Finally, to avoid weird outliers, ML rates with just Poisson (essentially mimicking LEISR). The normalization is still an issue but it depends on the downstream use. What do you think? Thanks for all the help. Cheers, Panos ", "H Panos, Sorry I missed your email but just found it. On 18 Jan 2021, at 10:33 pm, Panagiotis Adam < panagiotis...@gmail.com > wrote: Hi Minh and everyone, Recently I've been experimenting with using IQ-Tree to calculate protein sequence position rates, as an alternative to Rate4site and LEISR but there are some points that aren't entirely clear and you might be able to assist with. 1) Rate4site normalizes the rates into z-scores but afaik LEISR doesn't. How does iqtree behave for either bayesian or ML rates? A per-gene normalization by the gene median (or the median across the entire complex studied) might be in order for raw rates. I\u2019ve never heard of the z-score normalisation in Rate4Site. As far as I could remember, the estimation procedure in IQ-TREE is very similar to Rate4site. In fact I looked at Tal\u2019s 2004 paper when implemented this feature in IQ-TREE. The -wsr option will print the site rates solely based on the Empirical Bayesian method. The advantage of IQ-TREE is that it implements the free-rate model (+R) in addition to the Gamma model (+G). So I believe the rate estimates will be more accurate compared with the Gamma model. But I never did a proper benchmark to confirm this. Perhaps you and others can repeat similar exercise in Tal\u2019s paper to study this. If you use --mlrate option in IQ-TREE 2, it will instead perform the ML estimation of the site rates, which I believe is also similiar to that option of Rate4site. In summary, you can replace rate4site with IQ-TREE, it\u2019s faster, multi-threading and offer many more models. 2) There are a couple of references indicating that accuracy is better when using a JC-like model such that is available on LEISR (e.g. doi:10.1093/molbev/msy127). Unless I'm mistaken, as an equal rates matrix, that would be the equivalent of Poisson for iqtree, right? Yes, Poisson is the JC-equivalent for amino-acid data. 3) Another thing I've messed with is the rate categories. For ML rates, including among site rate heterogeneity is not supposed to make much of a difference (previous ref), but I've found that adding +R or +G tends to make the rates of positions in the highest categories shoot up even by an order of a magnitude. Any ideas about why this happens? I've been able to replicate such behavior in LEISR too. The ML rates are not stable, some rates might be saturated and become extremely high reaching the upper bound. Especially for highly variable rates. I believe this is also documented in Tal\u2019s paper. 4) Based on the above I think I've come up with a strategy to get the best of all possible worlds when using iqtree for rate calculation. First estimate the ML tree (with Modelfinder or whichever other method) and retain it in the next round with -t and -blfix. Then, do one run for bayesian rates with Poisson+R16 (essentially a fusion of the ref above and rate4site but free rates instead of the default G16). Finally, to avoid weird outliers, ML rates with just Poisson (essentially mimicking LEISR). The normalization is still an issue but it depends on the downstream use. What do you think? Yes, that sounds very sensible for me. Minh Thanks for all the help. Cheers, Panos You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c05f8811-9fe6-4bd6-9f5d-ead17af20357n%40googlegroups.com ", "Hey Minh, Thanks for your response. The whole rates estimation was sent to the back burner temporarily anyway, since we've been swamped with other analyses. The thing about z-scores in rate4site originates from this paper (first paragraph in Results): https://peerj.com/articles/3391/ However, I haven't confirmed it myself. I reckon though that if you didn't use the rate4site code verbatim, probably iqtree doesn't perform any sort of normalization. Tbh, it was exactly this option for +R that made me switch. Thanks for confirming about Poisson/JC. There seems to be some data that it's the better option (mathematically and in benchmarks) for estimating ML rates. Not sure if it would hold up for empirical bayesian though. https://www.biorxiv.org/content/10.1101/411025v1.abstract https://academic.oup.com/mbe/article/35/9/2307/5040133 All in all, it seems that it was a good option to drop rate heterogeneity for ML estimations. My (mathematically-impaired) assumption was sth of the sort that for the very saturated/variable sites, the max likelihood involves a couple of sites getting pigeonholed in extremely high rates at a long right tail of the distribution. Haven't checked if this has any formal statistical basis. Also I'm picturing a Gamma distribution in my head, which probably doesn't jive with a free rate model. I'm following up with another thread on recoding. Thanks for all the help. Best, Panos ", "And a little addendum to the previous post, I ended up rereading the original rate4site publication ( https://doi.org/10.1093/bioinformatics/18.suppl_1.S71 ) that only contained the ML rate part of the algorithm. Quoting from the Algorithm section: \" We repeat this calculation for all positions in the multiple sequence alignment. We then normalize these rates so that the average is zero and the standard deviation is one.\" ", "Addendum 2: After some experimenting with the strategy above, I found that iqtree passes an error when combining -blfix with a +R model. \"ERROR: Fixing branch lengths not supported under specified site rate model\" Simple Poisson (or other matrices) work normally for ML rates but only produce the file headers for empirical bayesian. I get from rate4site that the +G (or +R here) is assumed as part of the prior, hence the empty file for bayesian but I cannot figure out what's happening with the -blfix thingy. ", "Addendum 3: I'm under the impression +G16 with blfix does not produce the same outlier values in mlrates as +G/+R without it. Given what I had observed when using +G in LEISR that modifies the branch lengths of the provided tree, I suspect the extreme values are linked to the branch length optimization. ", "Ok, I just had a look at this paper, and I can confirm that IQ-TREE DIDN'T do this one sentence: \u201c We then normalize these rates so that the average is zero and the standard deviation is one. Without this normalization, the 2 implementations are identical. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/93a8717d-8a9c-4fe2-8b9a-2f1d35afb8dcn%40googlegroups.com ", "Yep, +R model does not support -blfix, due to a requirement in the EM algorithm: it just does not work with -blfix option, Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7ec1181a-b69d-4171-ac39-29f32fd90405n%40googlegroups.com ", "Hi Minh I've got a couple more insights after trying to calculate rates across a few different alignments. For a few supermatrices in the >6k aa size range, there is almost no difference among Poisson, Poisson+G16, LG, LG+G16 (bayesian or ML); Poisson just seems to be slightly more consistent internally. However, the absurd outlier ML rates (even >>20) persist with smaller input alignments. In a run (rate and mlrate) that includes -m Poisson+G16, -t, -blfix, -n 0, how do those interact? (especially in the output tree of the run) From what I've figured out: 1) -n 0: doesn't calculate tree, calculates model parameters from the initial parsimony tree ( is the output treefile just the parsimony tree? 2) -n 0 -t sth.tree: doesn't calculate tree, calculates model parameters from the input tree, the output treefile has modified branch lengths for some reason ( Are they optimized based on the new model somehow? Does this happen before or after rate calculation? i.e. is the order tree, model parameters, new tree, rates OR tree, model parameters, rates, new tree? 3) -t sth.tree: calculates new tree according to -m, calculates model parameters from the input tree, the new tree might be entirely different to the input tree 4) -blfix, 5) -n 0 -blfix: Those two give different model parameters, rates, and output treefiles and even different to (1). What's happening? Does the parsimony tree get affected? What's in the output treefile? 6) -n 0 -t sth.tree -blfix: doesn't calculate tree, calculates model parameters from the input tree and doesn't alter the branch lengths 7) -t sth.tree -blfix: identical to (6), -n 0 in that case is redundant These behaviors seem to persist even without rate heterogeneity; I'm a bit stumped. Thanks a bunch. Best, Panos ", "Hi Panos, On 19 Feb 2021, at 1:36 am, Panagiotis Adam < panagiotis...@gmail.com > wrote: Hi Minh I've got a couple more insights after trying to calculate rates across a few different alignments. For a few supermatrices in the >6k aa size range, there is almost no difference among Poisson, Poisson+G16, LG, LG+G16 (bayesian or ML); Poisson just seems to be slightly more consistent internally. However, the absurd outlier ML rates (even >>20) persist with smaller input alignments. That\u2019s what we also observed, due to the limited phylogenetic information with small alignments. In a run (rate and mlrate) that includes -m Poisson+G16, -t, -blfix, -n 0, how do those interact? (especially in the output tree of the run) From what I've figured out: 1) -n 0: doesn't calculate tree, calculates model parameters from the initial parsimony tree ( is the output treefile just the parsimony tree? Yes, it\u2019s just a parsimony tree, if you don\u2019t specify -t option. However, combining -blfix and -n 0 concerns me. In that case, the branch lengths are based on parsimony, which are well known to be an underestimation. And these parsimonious branch lengths are fixed here. Therefore, I recommend to avoid -blfix in this context. Only use it if you provide a existing tree via -t option, where you are sure that the branch lengths of your tree are meaningful. 2) -n 0 -t sth.tree: doesn't calculate tree, calculates model parameters from the input tree, the output treefile has modified branch lengths for some reason ( Are they optimized based on the new model somehow? Does this happen before or after rate calculation? i.e. is the order tree, model parameters, new tree, rates OR tree, model parameters, rates, new tree? Yes, branch lengths are optimized on the model, before rate calculation of course. IQ-TREE will optimize branch lengths are model parameters until convergence. And at the end, compute the site rates. 3) -t sth.tree: calculates new tree according to -m, calculates model parameters from the input tree, the new tree might be entirely different to the input tree Yes, because -t will only specify a starting tree. 4) -blfix, 5) -n 0 -blfix: Those two give different model parameters, rates, and output treefiles and even different to (1). What's happening? Does the parsimony tree get affected? What's in the output treefile? See above, that\u2019s why my concern. 6) -n 0 -t sth.tree -blfix: doesn't calculate tree, calculates model parameters from the input tree and doesn't alter the branch lengths yep 7) -t sth.tree -blfix: identical to (6), -n 0 in that case is redundant yep, -blfix implicity sets number of iterations to 0. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6e29b792-4cac-4fc8-a9c7-91da0cf22f63n%40googlegroups.com "]}, "W4OsgHmgjEs": {"topic": "Error while compiling from source iqtree-1.3.10-Source", "initializeDate": "Jan 4, 2016, 9:28:11 AM", "timeStamp": "Jan 4, 2016, 2:46:26 PM", "content": ["I was trying to compile 1.3.10 from source code and facing below error while trying to compile on redhat 6.4 [root@XXXXXX build]# uname -a Linux XXXXXX 2.6.32-504.el6.x86_64 #1 SMP Wed Oct 15 04:27:16 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux [root@XXXXXX build]# rpm -qa | grep -i 'cmake\\|gcc\\|eigen' gcc-4.4.7-16.el6.x86_64 eigen3-devel-3.2.5-2.el6.noarch libgcc-4.4.7-16.el6.x86_64 gcc-c++-4.4.7-16.el6.x86_64 cmake-2.8.12.2-4.el6.x86_64 Please could you help me with the complie or please advice if you need additional information. [root@XXXXXX build]# make [ 0%] Built target avxkernel [ 10%] Built target zlibstatic [ 10%] Building C object pllrepo/src/CMakeFiles/pllavx.dir/avxLikelihood.c.o /home/iqtree-1.3.10-Source/pllrepo/src/avxLikelihood.c: In function \u2018newviewGTRGAMMAPROT_AVX_LG4\u2019: /home/iqtree-1.3.10-Source/pllrepo/src/avxLikelihood.c:2266: error: incompatible type for argument 2 of \u2018_mm256_maskstore_pd\u2019 /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/avxintrin.h:913: note: expected \u2018__m256i\u2019 but argument is of type \u2018__m256d\u2019 /home/iqtree-1.3.10-Source/pllrepo/src/avxLikelihood.c:2267: error: incompatible type for argument 2 of \u2018_mm256_maskstore_pd\u2019 /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/avxintrin.h:913: note: expected \u2018__m256i\u2019 but argument is of type \u2018__m256d\u2019 /home/iqtree-1.3.10-Source/pllrepo/src/avxLikelihood.c:2365: error: incompatible type for argument 2 of \u2018_mm256_maskstore_pd\u2019 /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/avxintrin.h:913: note: expected \u2018__m256i\u2019 but argument is of type \u2018__m256d\u2019 /home/iqtree-1.3.10-Source/pllrepo/src/avxLikelihood.c:2422: error: incompatible type for argument 2 of \u2018_mm256_maskstore_pd\u2019 /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/avxintrin.h:913: note: expected \u2018__m256i\u2019 but argument is of type \u2018__m256d\u2019 /home/iqtree-1.3.10-Source/pllrepo/src/avxLikelihood.c: In function \u2018newviewGTRGAMMAPROT_AVX\u2019: /home/iqtree-1.3.10-Source/pllrepo/src/avxLikelihood.c:2762: error: incompatible type for argument 2 of \u2018_mm256_maskstore_pd\u2019 /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/avxintrin.h:913: note: expected \u2018__m256i\u2019 but argument is of type \u2018__m256d\u2019 /home/iqtree-1.3.10-Source/pllrepo/src/avxLikelihood.c:2763: error: incompatible type for argument 2 of \u2018_mm256_maskstore_pd\u2019 /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/avxintrin.h:913: note: expected \u2018__m256i\u2019 but argument is of type \u2018__m256d\u2019 /home/iqtree-1.3.10-Source/pllrepo/src/avxLikelihood.c:2860: error: incompatible type for argument 2 of \u2018_mm256_maskstore_pd\u2019 /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/avxintrin.h:913: note: expected \u2018__m256i\u2019 but argument is of type \u2018__m256d\u2019 /home/iqtree-1.3.10-Source/pllrepo/src/avxLikelihood.c:2917: error: incompatible type for argument 2 of \u2018_mm256_maskstore_pd\u2019 /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/avxintrin.h:913: note: expected \u2018__m256i\u2019 but argument is of type \u2018__m256d\u2019 /home/iqtree-1.3.10-Source/pllrepo/src/avxLikelihood.c: In function \u2018newviewGTRGAMMAPROT_AVX_GAPPED_SAVE\u2019: /home/iqtree-1.3.10-Source/pllrepo/src/avxLikelihood.c:3267: error: incompatible type for argument 2 of \u2018_mm256_maskstore_pd\u2019 /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/avxintrin.h:913: note: expected \u2018__m256i\u2019 but argument is of type \u2018__m256d\u2019 /home/iqtree-1.3.10-Source/pllrepo/src/avxLikelihood.c:3268: error: incompatible type for argument 2 of \u2018_mm256_maskstore_pd\u2019 /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/avxintrin.h:913: note: expected \u2018__m256i\u2019 but argument is of type \u2018__m256d\u2019 /home/iqtree-1.3.10-Source/pllrepo/src/avxLikelihood.c:3437: error: incompatible type for argument 2 of \u2018_mm256_maskstore_pd\u2019 /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/avxintrin.h:913: note: expected \u2018__m256i\u2019 but argument is of type \u2018__m256d\u2019 /home/iqtree-1.3.10-Source/pllrepo/src/avxLikelihood.c:3493: error: incompatible type for argument 2 of \u2018_mm256_maskstore_pd\u2019 /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/avxintrin.h:913: note: expected \u2018__m256i\u2019 but argument is of type \u2018__m256d\u2019 /home/iqtree-1.3.10-Source/pllrepo/src/avxLikelihood.c:3653: error: incompatible type for argument 2 of \u2018_mm256_maskstore_pd\u2019 /usr/lib/gcc/x86_64-redhat-linux/4.4.7/include/avxintrin.h:913: note: expected \u2018__m256i\u2019 but argument is of type \u2018__m256d\u2019 make[2]: *** [pllrepo/src/CMakeFiles/pllavx.dir/avxLikelihood.c.o] Error 1 make[1]: *** [pllrepo/src/CMakeFiles/pllavx.dir/all] Error 2 make: *** [all] Error 2 [root@slcolvdevtest01 build]# Also Attached make -d output Kind Regards Hemanth ", "Dear Hemanth The problem is that your gcc version 4.4 is too old. Please install version 4.6 at least. Please also use the latest iqtree 1.3.11. It fixes several issue compared with 1.3.10 Cheers, Minh ", "Thank you Minh yes. it's the version of gcc that caused the issue "]}, "knli6bx7Mio": {"topic": "AU test and constrained topology", "initializeDate": "May 6, 2020, 7:38:20 AM", "timeStamp": "May 9, 2020, 10:21:52 AM", "content": ["Dear IQtree users, I have questions about how to run correctly an AU test to compare several constrained topologies for many genes. I am performing a Gene Genealogy Interrogation (GGI Arcila et al; 2017) analyses to test different alternatives relationships between basal nodes of my tree. First I have estimated ML tree for each of my gene (~1500), and then performed constrained search for 16 different topologies + unconstrained tree. Now I am doing the AU test to see if one of the topology tested (e.g. concatenated tree / species tree) is better supported by most of the loci ( test ILS vs gene tree estimation error). I would like to ask what is the best use of the -m and -te options for this analysis? I have run the following array job: iqtree -s gene_dataset.phy -z 17_constrained_topo.trees -te gene_unrooted.tre -n 0 -zb 10000 -zw -au -pre TopologyTest #with -te is my IQtree gene ML tree. Is it better to specify a general model like -m GTR+G rather than to use -te option? or to do both? I am a bit confused of how to do it correctly. I thank you in advance for the advice. Best regards Nicolas ", "Hi Nicolas, The `-m` option here will set the structure of the model under which the topologies will be compared. The `-te` option will set the tree that will be used to estimate the parameters of that model. Best practice is to set `-te` to the tree that maximises the likelihood for the alignment you are using, and `-m` to the model structure that minimises the AICc (or BIC, if you choose) for that alignment. Then when you compare the set of trees for a single alignment, you are asking a question something like: conditioned on this alignment, the best model structure I can find for it, with model parameters estimated on the best tree I can find for it, are any of the trees in my input set significantly worse than the highest likelihood tree in my input set? To put it another way, every tree comparison you make between any set of trees has to be conditioned on three things: (i) a single alignment (ii) a single model structure (iii) a single set of parameter estimates for that model structure Let me know if that helps or if you have more questions. I wasn't quite able to figure out what you were doing from what you wrote, so apologies if I've missed the point! Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/378387eb-ee7f-4c66-9474-4ad68fe24d25%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Dear Robert, Thank you very much for your anwser. It is very helpful. Thanks again Nicolas Le jeudi 7 mai 2020 01:21:26 UTC+2, Rob Lanfear a \u00e9crit : Hi Nicolas, The `-m` option here will set the structure of the model under which the topologies will be compared. The `-te` option will set the tree that will be used to estimate the parameters of that model. Best practice is to set `-te` to the tree that maximises the likelihood for the alignment you are using, and `-m` to the model structure that minimises the AICc (or BIC, if you choose) for that alignment. Then when you compare the set of trees for a single alignment, you are asking a question something like: conditioned on this alignment, the best model structure I can find for it, with model parameters estimated on the best tree I can find for it, are any of the trees in my input set significantly worse than the highest likelihood tree in my input set? To put it another way, every tree comparison you make between any set of trees has to be conditioned on three things: (i) a single alignment (ii) a single model structure (iii) a single set of parameter estimates for that model structure Let me know if that helps or if you have more questions. I wasn't quite able to figure out what you were doing from what you wrote, so apologies if I've missed the point! Rob On Wed, 6 May 2020 at 21:38, Nicolas Nesi < nicola...@gmail.com > wrote: Dear IQtree users, I have questions about how to run correctly an AU test to compare several constrained topologies for many genes. I am performing a Gene Genealogy Interrogation (GGI Arcila et al; 2017) analyses to test different alternatives relationships between basal nodes of my tree. First I have estimated ML tree for each of my gene (~1500), and then performed constrained search for 16 different topologies + unconstrained tree. Now I am doing the AU test to see if one of the topology tested (e.g. concatenated tree / species tree) is better supported by most of the loci ( test ILS vs gene tree estimation error). I would like to ask what is the best use of the -m and -te options for this analysis? I have run the following array job: iqtree -s gene_dataset.phy -z 17_constrained_topo.trees -te gene_unrooted.tre -n 0 -zb 10000 -zw -au -pre TopologyTest #with -te is my IQtree gene ML tree. Is it better to specify a general model like -m GTR+G rather than to use -te option? or to do both? I am a bit confused of how to do it correctly. I thank you in advance for the advice. Best regards Nicolas You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/378387eb-ee7f-4c66-9474-4ad68fe24d25%40googlegroups.com "]}, "UEC6DBwfYr4": {"topic": "DNA vs. DNAF", "initializeDate": "Mar 9, 2021, 6:51:39 AM", "timeStamp": "Mar 10, 2021, 5:55:13 PM", "content": ["Hello, I am not able to find what does \"DNAF\" mean in the RAxML-style partition file. I would like to read the best.scheme file automatically into RAxML, but this notation seems not to be accepted there. Thank you for any advice, Ondrej Mikula ", "Hi Ondrej, My bad - I thought RAxML would accept DNAF. Please change all its occurences to DNA. Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0d48c033-e75e-45ea-8a0b-aa7e5a491a8cn%40googlegroups.com ", "Hi Minh, thank you for the feedback, I will change it in the iqtree's output file. Anyway, I would like to understand it properly - what is the meaning of DNAF (compared to DNA)? Ondrej Ond\u0159ej Mikula Institute of Vertebrate Biology Czech Academy of Sciences Studenec 122, 67502 Konesin, Czech Republic ", "Hi Ondrej, I thought it\u2019s like WAGF syntax for protein models, where \u201cF\" stands for \u201c+F\u201d or empirical state frequencies estimated from the alignment. But DNA for RAxML already means empirical nt frequencies, no need for \u201cF\u201d suffix. Minh "]}, "rtfFa0N6cXs": {"topic": "Segmentation fault after restart from checkpoint", "initializeDate": "Jun 8, 2016, 10:50:59 AM", "timeStamp": "Jul 10, 2016, 10:33:34 AM", "content": ["Hi, I'm running into a segmentation fault after restart from a checkpoint. The call to IQTREE: iqtree-omp -nt 7 -s 11gene.v9.fasta -spp partition.model.nex -bb 1000 -wbtl -bspec GENESITE -o ochromonas_sp_ccmp1393 -pre opt-0 -pers 0.30 The message at the end of log files CHECKPOINT: Initial tree restored Generating 1000 samples for ultrafast bootstrap (seed: 703135)... CHECKPOINT: 1000 UFBoot trees and 1 UFBootSplits restored NOTE: 2093 MB RAM is required! CHECKPOINT: Model parameters restored, LogL: -617159.640 -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- CHECKPOINT: Candidate tree set restored, best LogL: -617159.640 -------------------------------------------------------------------- | OPTIMIZING CANDIDATE TREE SET | -------------------------------------------------------------------- CHECKPOINT: 83 search iterations restored *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT *** For bug report please send to developers: *** Log file: opt-0.log *** Alignment files (if possible) The alignment, partition file and log file are available here: https://www.dropbox.com/sh/3hbgfy8gtatwvr8/AACnkZ-7N69iTB4NB7N-kEROa?dl=0 Thanks, Teo ", "Dear teo, thanks for the report. I will examine once back to work and let you know. For the moment i suggest that you start a fresh rerun to rule out the possibility of a checkpoint error. Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, I started fresh a couple of times. The first time I removed just the -bspec GENESITE flag, but the segfault occurred after restart. When I removed all bootstrap flags, the analysis was able to restart without a problem. So it appears that the error has something to do with the UF bootstraps. Regards, Teo ", "Dear Teo, I found the problem - it is the \"-wbtl\" option that is not yet supported with checkpointing, causing the crash. I will see how to fix this. For the moment pls perform the analysis without that option. Thanks for your patience Minh "]}, "l3wQ2i-JKNg": {"topic": "iqtree and large dataset", "initializeDate": "Aug 14, 2017, 6:36:13 AM", "timeStamp": "Aug 17, 2017, 9:58:32 AM", "content": ["I'm wondering if someone has advice on how to run iqtree on a large dataset. Specifically, we have aligned resequencing data for 18 populations to our reference and exported fasta files for each. It seems the genome is too large to run with iqtree. It is ~1Gb and composed of 96 sequences. When we combine them together (with 100 Ns between) we get a seg fault from iqtree. We don't get this seg fault when we run iqtree by scaffold or combine smaller number of scaffolds. I'm looking for a suggestion on how to deal with this. Is there a flag in iqtree to deal with this number of sites? Is there a way to combine distance matrices or trees generated from each scaffold into a consensus while still generating bootstraps and the splits file? I've attached the log file here and this is the seg fault we get: STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT *** For bug report please send to developers: *** Log file: cated.fasta.log *** Alignment files (if possible) /var/spool/slurmd/job1037397/slurm_script: line 11: 4697 Segmentation fault (core dumped) ~/tools/iqtree-omp-1.5.5-Linux/bin/iqtree-omp -s cated.fasta -nt AUTO I'd really appreciate any feedback. Best, Kira ", "Dear Kira, Thanks for your message. The segfault appeared right at the beginning. It seems like there is a bug with numerical overflow when processing such a large data set (I\u2019ve never seen > 1Gb long alignment before). To locate the problem in the code I would need your alignment. Thus can you pls send it to my personal email? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <cated.fasta.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Kira, From a communication with another user, you can use option -t PARS to overcome this bug. The segfault seems to occur in the phylogenetic likelihood library when having very long alignments (ten of millions of sites). And this option will switch to our own \u201clibrary\u201d, which works just fine. Cheers, Minh "]}, "baYBe_Bzojw": {"topic": "Phylogenetic Dating - Lower bound and root date", "initializeDate": "May 6, 2020, 6:06:34 PM", "timeStamp": "May 10, 2020, 9:20:28 PM", "content": ["Hello, We are attempting to use the phylogenetic dating feature in IQtree2 (Version: Linux 2.0.4). Our clock rate is very slow and we are getting this message: \"- The estimated rate reaches the given lower bound. To change the lower bound, use option -t. *RESULTS: - Dating results: rate 1e-10,\" However using the -t option in the command line tries to read in a tree file, rather than taking in a float. Additionally we have tried to adjust this by setting the root date with \"--date-root -0.035582\" (mya) in the command, however there does not to appear be any difference in the output trees with or without this (or when we change the date-root to -0.00035582). Ideally we want to compare fixed rates on a set topology for a model likelihood test. We have tried Bayesian methods, but with the size of our data it is taking a long time. Thank you! ", "Hi Jennifer, CC Hien (LSD author), On 7 May 2020, at 8:06 am, Jennifer Havens < jha...@eng.ucsd.edu > wrote: Hello, We are attempting to use the phylogenetic dating feature in IQtree2 (Version: Linux 2.0.4). Great to hear that you (and others) and are trying out this new feature. Our clock rate is very slow and we are getting this message: \"- The estimated rate reaches the given lower bound. To change the lower bound, use option -t. *RESULTS: - Dating results: rate 1e-10,\" However using the -t option in the command line tries to read in a tree file, rather than taking in a float. Right, this is the message from LSD2, appended to the log. -t option is meant for LSD2. So in order to pass on all LSD2-specific options please use: --date-options \u201c\u2026\u201d Additionally we have tried to adjust this by setting the root date with \"--date-root -0.035582\" (mya) in the command, however there does not to appear be any difference in the output trees with or without this (or when we change the date-root to -0.00035582). I don\u2019t know how LSD2 works exactly here. @Hien, can you please help? But how about you scale up all the dates by some constant factor, e.g. in the unit of kya or year? Ideally we want to compare fixed rates on a set topology for a model likelihood test. We have tried Bayesian methods, but with the size of our data it is taking a long time. That\u2019s exactly our purpose here \u2014 to speed up dating on phylogenomic data. Cheers Minh Thank you! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/76a2cc54-dba0-4ea7-9c92-7bd1e4254f6c%40googlegroups.com ", "I did not know that you could use --date-options to modify the inputs to https://github.com/tothuhien/lsd2 that does everything I wanted. Thank you for your fast response! To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "I added the `--date-options` to the manual, along with a full rundown of all the LSD2 commands. It should appear on the website soon, but for convenience you can find it here: https://github.com/Cibiv/IQ-TREE/wiki/Dating Rob To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4a13e069-420c-4941-a381-b84033374b05%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Thanks a lot Rob! I have now incorporated this into the doc. Along with a new section to infer confidence intervals of the date estimates. Quick question: for outliers removal you meant \u201c-e 2\u201d, not \u201c-z 2\u201d, right? I changed that. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmrRoKtfp8j1QKb5k6nPZ3QZxzDNmwGnNLWhZkcmeP0oYQ%40mail.gmail.com "]}, "sG44aPqc_lw": {"topic": "Characters state reconstruction", "initializeDate": "Nov 23, 2020, 11:44:41 PM", "timeStamp": "Dec 2, 2020, 7:49:55 AM", "content": ["I'm attempting to do discrete character reconstruction using maximum likelihood with iqtree. I have two binary characters I'm trying to reconstruct, using branch lengths representing time (million years). I'm trying to figure out the most likely state of these characters in certain nodes. I have a couple questions. What model should I use? I was thinking just using a Jukes and Cantor model, but I'm not sure if that is the best option. How do I input unknown character states in iqtree? Should I just leave them as a question mark?. Should I use the -asr command? I was thinking of using the -asr command with the -blfix option. Any help on this matter would be greatly appreciated. Vicente Mu\u00f1oz Walther Ph.D.(c) Laboratorio de Ontogenia y Filogenia Las Palmeras 3425 Universidad de Chile ", "Hi Vicente, On 24 Nov 2020, at 3:45 pm, Vicente Mu\u00f1oz Walther < tente...@gmail.com > wrote: I'm attempting to do discrete character reconstruction using maximum likelihood with iqtree. I have two binary characters I'm trying to reconstruct, using branch lengths representing time (million years). I'm trying to figure out the most likely state of these characters in certain nodes. I have a couple questions. What model should I use? I was thinking just using a Jukes and Cantor model, but I'm not sure if that is the best option. For binary data, use these models: http://www.iqtree.org/doc/Substitution-Models#binary-and-morphological-models How do I input unknown character states in iqtree? Should I just leave them as a question mark?. Yes, either question mark or a gap (-). Both are interpreted the same in IQ-TREE and other ML software. Should I use the -asr command? Yes, you should. I was thinking of using the -asr command with the -blfix option. Only use -blfix if the branch lengths are already expressed as the number of substitutions per site. Minh Any help on this matter would be greatly appreciated. Vicente Mu\u00f1oz Walther Ph.D.(c) Laboratorio de Ontogenia y Filogenia Las Palmeras 3425 Universidad de Chile You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CA%2BVmrY6WX5Y7nfhFRBww4Mj-H9MyD0iBgSYE7rXZpx1bcZD80g%40mail.gmail.com "]}, "iSlIDP7TcbY": {"topic": "Can PoMo model be used for SNP data?", "initializeDate": "Sep 13, 2019, 9:03:53 AM", "timeStamp": "Sep 30, 2019, 2:28:52 AM", "content": ["Hello, Currently, I am trying to use the PoMo model in IQ-TREE to deal with the heterozygous SNP from the single cell sequencing result of human tumor cells. However, I found that PoMo model does not yet support ascertainment bias correction. Is that means I cannot use the PoMo model to build trees for SNP sites? Appreciate any reply. Regards, Yiran ", "Dear Yiran, Dominik should better answer your question. But as far I as remember, this question was already asked and answered in the forum\u2026 I don\u2019t have the URL right now, but pls just search for it. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7523d707-9360-4855-9628-ee03e4111705%40googlegroups.com ", "Here is the URL to the thread about this: https://groups.google.com/forum/#!searchin/iqtree/pomo$20ascertainment%7Csort:date/iqtree/xVxurAjvoIY/QayzWsZ_AwAJ Minh On 13 Sep 2019, at 11:03 pm, Yiran Zou < zoey...@gmail.com > wrote: ", "Hello, yes, the situation has not changed since then. PoMo has to infer the level of heterozygosity, and so, needs to know the ratio of monomorphic to polymorphic sites. Is it possible for you to include these sites into your alignment? I think we could implement ascertainment bias correction into IQ-TREE+PoMo, but it is a little more involved. Dominik Minh Bui < minh...@univie.ac.at > writes: > Here is the URL to the thread about this: https://groups.google.com/forum/#!searchin/iqtree/pomo$20ascertainment%7Csort:date/iqtree/xVxurAjvoIY/QayzWsZ_AwAJ https://groups.google.com/forum/#!searchin/iqtree/pomo$20ascertainment|sort:date/iqtree/xVxurAjvoIY/QayzWsZ_AwAJ > Minh >> On 13 Sep 2019, at 11:03 pm, Yiran Zou < zoey...@gmail.com > wrote: >> Hello, >> Currently, I am trying to use the PoMo model in IQ-TREE to deal with the heterozygous SNP from the single cell sequencing result of human tumor cells. However, I found that PoMo model does not yet support ascertainment bias correction. Is that means I cannot use the PoMo model to build trees for SNP sites? >> Appreciate any reply. >> Regards, >> Yiran >> -- >> You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. >> To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com <mailto: iqtree+un...@googlegroups.com >> To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7523d707-9360-4855-9628-ee03e4111705%40googlegroups.com https://groups.google.com/d/msgid/iqtree/7523d707-9360-4855-9628-ee03e4111705%40googlegroups.com?utm_medium=email&utm_source=footer "]}, "1iei-YR6e3o": {"topic": "Wrong reference in the manual?", "initializeDate": "Nov 28, 2018, 4:26:54 AM", "timeStamp": "Nov 29, 2018, 1:22:50 AM", "content": ["Hi, I probably found a wrong reference in the manual. Looking at the reference of Adachi and Hasegawa 1996 as part of the fast local bootstrap probability method, I got a link to the following publication: Model of amino acid substitution in proteins encoded by mitochondrial DNA. Journal of Molecular Evolution 42: 459\u2013468 (doi: https://doi.org/10.1007/BF02498640 However, I think that this should the correct one: Adachi and Hasegawa. 1996. Molphy Version 2.3: programs for molecular phylogenetics based on maximum likelihood. Please check it. Cheers Michael ", "Hi Michael, You are right! This ref is for the mtREV model. Thanks for pointing it out. We will fix the manual. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "s_Jx_2D-n0s": {"topic": "usage of PMSF", "initializeDate": "Jun 28, 2017, 3:41:06 AM", "timeStamp": "Sep 26, 2017, 1:06:53 PM", "content": ["Hi, I'm trying to use the PMSF model but I'm having problems. I already have a base tree that I got from a previous run as iqtree omp st AA 1000 wbtl alrt 1000 s concat archaea 209plus 2017 26.faa m TEST mset LG (best model LG+I+G4) So, the first question is... how do you perform the best model search for the PMSF? Do I still need to run MF as usual to get the best mixture model combination? The best model search for mixture models is really long (few hours just for the 8 base combinations of C60 with -m TESTONLY, alignment has 251 sequences with 4200 columns). But if it's the way to go, I'll do this with I was trying to iqtree omp st AA s concat archaea 209plus 2017 26.faa pre test_models_PMSF ft concat archaea 209plus 2017 26.faa treefile with -m MF or -m TESTONLY but it reports ERROR Invalid model name TESTONLY so I guess that it doesn't expect having to do any model search when -ft is provided... Thank you in advance, Xabi ", "Dear Xabi, On Jun 28, 2017, at 9:41 AM, Xabier V\u00e1zquez-Campos < xvaz...@gmail.com > wrote: Hi, I'm trying to use the PMSF model but I'm having problems. I already have a base tree that I got from a previous run as iqtree omp st AA 1000 wbtl alrt 1000 s concat archaea 209plus 2017 26.faa m TEST mset LG (best model LG+I+G4) So, the first question is... how do you perform the best model search for the PMSF? Do I still need to run MF as usual to get the best mixture model combination? PMSF is an approximation to mixture models C60 and other Cxx models. Thus, you need to first do model selection incl. these mixture models via option: -madd LG+C60. You can also specify other models via comma-separated string, e.g.: -madd LG+C20,LG+C30,LG+C40,LG+C50,LG+C60. Once this finishes, assuming that LG+C60 fits best. Then you can use -m LG+C60 to the command you pasted below. The best model search for mixture models is really long (few hours just for the 8 base combinations of C60 with -m TESTONLY, alignment has 251 sequences with 4200 columns). But if it's the way to go, I'll do this with I was trying to iqtree omp st AA s concat archaea 209plus 2017 26.faa pre test_models_PMSF ft concat archaea 209plus 2017 26.faa treefile with -m MF or -m TESTONLY but it reports ERROR Invalid model name TESTONLY so I guess that it doesn't expect having to do any model search when -ft is provided\u2026 right, see the above explanation. Cheers, Minh Thank you in advance, Xabi You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hello again, Minh! I am trying to run a concatenated analysis on a large protein dataset doing partitioning and model test all in the same run. In addition to standard protein models, I would like to also consider some mixture models in the search, LG4M, LG4X and the CAT-like models. 1) How do I add the CAT-like models in -mrate? Do I need to list all option C10,C20 etc or can I use something like CAT or just C to indicate a search through all possibilities? 2) Also, if I understood correctly, to account for heterotachy, I should use -sp instead of -spp, but then can I still submit the partition file or not? (Another related question is about what the heterotachy option is actually doing: I learned heterotachy as within-site variation through time, but in the manual it seems to be variation across taxa and sites\u2026) Simplified example: iqtree -st AA -m MFP+MERGE -madd LG4M,LG4X -mrate G,R -msub nuclear -s input.nex -spp partition_file Thank you for your help! ", "Dear Tauana, On Sep 22, 2017, at 4:54 PM, taua...@gmail.com wrote: Hello again, Minh! I am trying to run a concatenated analysis on a large protein dataset doing partitioning and model test all in the same run. In addition to standard protein models, I would like to also consider some mixture models in the search, LG4M, LG4X and the CAT-like models. 1) How do I add the CAT-like models in -mrate? Do I need to list all option C10,C20 etc or can I use something like CAT or just C to indicate a search through all possibilities? just use -madd option. For example, -madd LG4M,LG4X,LG+C10,LG+C20. I recommend to do LG+\u2026 because by default, C10/C20,\u2026 assumes equal substitution rate parameter and just varying AA frequencies. That\u2019s not realistic. 2) Also, if I understood correctly, to account for heterotachy, I should use -sp instead of -spp, but then can I still submit the partition file or not? Yes of course, -sp and -spp take a partition file. (Another related question is about what the heterotachy option is actually doing: I learned heterotachy as within-site variation through time, but in the manual it seems to be variation across taxa and sites\u2026) @Stephen: can you enlighten this? Simplified example: iqtree -st AA -m MFP+MERGE -madd LG4M,LG4X -mrate G,R -msub nuclear -s input.nex -spp partition_file Looks file. But please note that if you add LG+C10 like explained above, it will allow each partition to evolve under this CAT model, which can be overkilled (over-parameterization). Thus, right now the CAT-like models are mainly used for non-partition analysis (without -spp). Cheers, Minh ", "Hi Tauana, With regard to your heterotachy question and the difference between the -sp and -spp options for partition models. When you fit a partition model with the -sp option, only one set of branch lengths is inferred. For each partition these branch lengths are then scaled by some factor. This allows some partitions to evolve at faster or slower rates than others, but it does not accommodate heterotachy - variation in rate amongst lineages. If you instead specify the -spp option, then IQ-TREE will infer a separate set of branch lengths for each partition. This means that a particular branch (lineage) could be slow-evolving in one partition (relative to the other branches in that partition) and fast-evolving in another (again, relative to the branches in that partition). Hope this helps, Stephen ", "Hi Tauana, I am sorry but I made a mistake in my below email. All of my description/explanation is correct but I mixed up the two options. The -spp option infers only one set of branch lengths and applies a scaling factor for each partition. The -sp option is the one used to account for heterotachy among partitions, inferring separate branch lengths for each partition. Sorry for the confusion! Stephen ", "Thank you, @Minh, So I will try two things, 1) partitioned analysis with --madd as you recommended (with the risk of overfitting), and 2) without the partition file, but still adding --madd LG4M,LG4X,LG+C10,LG+C20,LG+C\u2026 Does that make sense? Thanks, @Stephen, I understand your explanation. I guess the issue was that I work with a different definition of heterotachy, which is within-site rate variation through time. But the important thing is that I know what the model will be doing in this case. Thanks! ", "Hi again Stephen, I was missing a connection from my definition to how the problem is actually treated for reconstruction purposes. It makes sense now! No disagreement between definitions. Thanks! "]}, "eXXfwqpNe_w": {"topic": "Crash with complex constraint", "initializeDate": "Jun 2, 2017, 9:20:04 PM", "timeStamp": "Jun 6, 2017, 4:19:15 AM", "content": ["I'm attempting to use a complex nested constraint tree in Newick format. It opens and displays correctly in tree editors, but won't run. Are there any limits to the complexity of the constraint tree? ", "Hi Russell, I'm just a user so I don't know if this will be applicable to your issue... but I had a similar problem in the past using RAxML. It had to do with the parenthetical flexibility of newick trees. To overcome it, I think I opened my constraint tree in either MEGA or FIGTREE (maybe you should try both) and then saved/exported the tree as currently displayed. This rewrites the parentheticals of the file to a version that RAxML would accept. If that still fails, I have another suggestion... when typing (or pasting) your IQTREE terminal call, add \"-blmin 1e-4\". This sets up a minimum acceptable branch length that is very small and can overcome numerical underflow when IQTREE is working on trees that are compatible with your constraint. I hope this helps. Cheers, Steven ", "Thanks Steven. I tried the opening/saving to no avail. I will try the blmin option when I'm back in the office and see what happens. I figured it's in the parentheticals, but not sure what's wrong when everything else opens it. ", "@Steven: thanks for additional info ;-) @Russell: there is no limit on the complexity of the constraint tree e.g. in terms of the number of parentheses. It just needs to be in a valid NEWICK format. Moreover, we can only help if you provide the command line and relevant log output (cf. the first 2 sections of the FAQ: http://www.iqtree.org/doc/Frequently-Asked-Questions Also, please use the latest version 1.5.5, which fixes one bug with -g option combined with partition models. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Sorry I forgot to post that. Here it is: C:\\Users\\minton>C:\\iqtree-omp-1.5.5-Windows\\bin\\iqtree-omp.exe -nt AUTO -m TIM+I+G4 -s \"C:\\Users\\minton\\Dropbox\\2017 potosiensis paper\\Nucleotidealignment3.fas\" -g \"C:\\Users\\minton\\Dropbox\\2017 potosiensis paper\\constraint5.txt\" For your convenience alignment with unique sequences printed to C:\\Users\\minton\\Dropbox\\2017 potosiensis paper\\Nucleotidealignment3.fas.uniqueseq.phy Creating fast initial parsimony tree by random order stepwise addition... Assertion failed! Program: C:\\iqtree-omp-1.5.5-Windows\\bin\\iqtree-omp.exe File: \\Users\\minh\\Dropbox\\iqtree-git\\phylotreepars.cpp, Line 378 Expression: taxon_order.size() == constraintTree.leafNum This application has requested the Runtime to terminate it in an unusual way. Please contact the application's support team for more information. I tried saving it out of FigTree and MEGA without any luck. ", "Hi Russell, thanks, now I see. For your data set, there are identical sequences, which are internally discarded in IQ-TREE. However, there can be identical sequences in your constraint tree, which may interfere with this treatment. Simply look at the WARNING in the log file before these last lines, there you may identify such sequences. As a work around, pls use option \u201c-keep-ident\u201d, which will disallow this behavior. Let me know whether or not this works. Minh "]}, "1rN5wTNq-Is": {"topic": "segmentation fault", "initializeDate": "May 16, 2015, 2:48:45 PM", "timeStamp": "May 17, 2015, 10:35:03 AM", "content": ["Hi, I don't seem to be able to run my alignment, I get a segmentation fault error. Any tips on what I could try to make it work? Thanks so much, Fabien ", "Hi Fabien, Could you please rerun the command without the flag -pll? IQ-TREE no longer needs the PLL library to be fast because we have re-implemented most of the time saving techniques from PLL into our own kernel. The reason for this it is because PLL does not support many features in IQ-TREE (e.g. DNA model other than GTR+G). Your problem seems to be related to the UFBoot implementation in PLL. So, please retry with the following command and tell us whether it works: iqtree-omp -s centrohelid1.fasta -m LG+G -bb 1000 -omp 12 -pre centrohelid1 Bests Tung You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "J_XrJAbOKBg": {"topic": "AU test: Is there a limit to number of constraint trees?", "initializeDate": "Mar 9, 2021, 4:14:38 AM", "timeStamp": "Mar 17, 2021, 6:10:30 AM", "content": ["Hello IQ-Tree users, I am using iqtree on linux command line. I am using AU testing of different topologies, and find it very useful. Although the AU test is designed for multiple testing, is there a danger with testing too many constraints at the same time? In other words, could there be over-correction of the p-values? I find that the p-AU for the unconstrained tree decreases dramatically as I add more constraint trees to the analysis, and it is no longer the \"best tree\". I am not sure whether this is to due to other changes I have made, whether this is expected, or whether there is just a problem with poor branch support in my ML tree. Thank you very much. Karen ", "To add to this: I see now that what has changed the p-AU value in my recent tests is whether or not I use the -tre option to specify an ML tree to estimate parameters. It is not related to the number of constraint trees tested. You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/J_XrJAbOKBg/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/75350d02-cae6-43ea-9204-ab98aa20a352n%40googlegroups.com ", "Hi there Karen, On 9 Mar 2021, at 8:14 pm, Karen van Niekerk < vannieke...@gmail.com > wrote: Hello IQ-Tree users, I am using iqtree on linux command line. I am using AU testing of different topologies, and find it very useful. Although the AU test is designed for multiple testing, is there a danger with testing too many constraints at the same time? In other words, could there be over-correction of the p-values? No danger - it\u2019s exactly the purpose of multiple testing. I find that the p-AU for the unconstrained tree decreases dramatically as I add more constraint trees to the analysis, and it is no longer the \"best tree\". I am not sure whether this is to due to other changes I have made, whether this is expected, or whether there is just a problem with poor branch support in my ML tree. I don\u2019t see anything unexpected here. If you add more trees, the additional tree might have better likelihoods, and in that case it will be able to reject other trees, as the test will compare the best tree in the set against all other trees. So for the AU test, it\u2019s important to include the best known tree\u2026 Cheers Minh Thank you very much. Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com ", "Thank you very much for this response. "]}, "8IOR7Ot8euQ": {"topic": "Geneious plugin IQTree error mixed_sequence: mixed_sequence precondition isn't met", "initializeDate": "Jan 30, 2020, 11:03:05 AM", "timeStamp": "Feb 1, 2020, 3:44:04 AM", "content": ["I recently installed the Geneious Prime plugin for IQTree from the CIPRES website. Previously I had been exporting single gene alignments as nexus files to the IQTree web server in order to create trees using the model selection algorithm, but am trying to streamline the process by doing it all in Geneious. However, when I attempt to use the plugin via Geneious with my alignment file selected, I receive this message which I am having a hard time interpreting: Cipres error code=5, message=Form validation error. mixed_sequence: mixed_sequence precondition isn't met Please help! ", "Hi Rachel, It\u2019s my first time to hear about such a plugin. While it\u2019s great to know that, it also means that I can\u2019t answer this question. You have to contact the one who created the plugin, that I don\u2019t know. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e59d2350-79b2-4a59-939a-90459e67d1c3%40googlegroups.com "]}, "1Fx5qE8hRik": {"topic": "How to optimize multithreading for large datasets?", "initializeDate": "Jul 13, 2020, 2:19:44 PM", "timeStamp": "Jul 13, 2020, 2:19:44 PM", "content": ["I am trying to build a tree with ~50k sequences and ~25k base pairs each. I read that multithreading reaches a point of diminishing returns for building the tree, what would the optimal number of threads be for this problem? "]}, "-sEZuxkuELI": {"topic": "Bug report- IQ-TREE CRASHES WITH SIGNAL ABORTED", "initializeDate": "Mar 14, 2019, 3:33:15 PM", "timeStamp": "Mar 17, 2019, 8:27:08 PM", "content": ["I tried to do a mixed analysis of morphological data and DNA with this line of comand iqtree -sp partition_file.nex -pre result_morf_mol -bb 1000 -bnni -alrt 1000 -nt AUTO -o Gmelina_arborea_KR532195_1_isolate_G135 I think it was caused by the -bnni command, here are the first 10 lines and last 10 of the log file: IQ-TREE multicore version 1.6.10 for Windows 64-bit built Feb 19 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: LAPTOP-6P500TSE (AVX2, FMA3, 7 GB RAM) Command: iqtree -sp partition_file.nex -pre result_morf_mol -bb 1000 -bspec GENE -alrt 1000 -nt AUTO -o Gmelina_arborea_KR532195_1_isolate_G135 Seed: 855323 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Thu Mar 14 13:08:33 2019 Kernel: AVX+FMA - auto-detect threads (4 CPU cores detected) Iteration 250 / LogL: -20797.671 / Time: 0h:8m:36s (0h:0m:47s left) Iteration 260 / LogL: -20789.669 / Time: 0h:8m:53s (0h:0m:26s left) Iteration 270 / LogL: -20778.250 / Time: 0h:9m:8s (0h:0m:6s left) Refining ufboot trees with NNI 1 branch... (((1:0.3896749368,(((((((((((((10:0.0325456956,11:0.0168967483):0.0320648571,(23:0.1279991260,129:0.0000029038):0.0000029038):0.0158507170,88:0.0000026713):0.0749075180,((((18:0.0962550812,150:0.0000029038):0.0000024316,90:0.1256861279):0.0000023126,(100:0.0000025881,143:0.0000026611):0.0994549789):0.0000022551,(((102:0.0000021999,104:0.0000021999):0.0000021999,103:0.0000021999):0.0000024828,101:0.0000024828):0.0000028817):0.1068783450):0.0000021286,116:0.1130224046):0.0000020127,(((21:0.2012130542,((37:0.0462840271,(114:0.0000021999,(((52:0.0000024302,54:0.0000021999):0.0000024302,53:0.0000021999):0.1287720466,82:0.4152329879):0.0177654091):0.0481579224):0.2663006184,59:0.0469042496):0.0000020649):0.0000029038,125:0.3131179630):0.0000029038,76:9.9999980523):0.0000029222):0.0289279319,((((30:0.0437326524,121:0.0340951738):0.1360001585,31:0.0000022174):0.0863378402,((78:0.0000027878,(106:0.0935373817,123:0.0000027204):0.0875908949):0.0000021825,((62:0.0652024604,134:0.0317689746):0.0289998625,117:0.0317132625):0.0145218092):0.0000027204):0.0000023849,91:0.0848185285):0.0000028141):0.0000026388,((((4:0.0000029038,154:0.0000029038):0.1086833274,95:0.0709743548):0.0336918278,35:0.2202508388):0.0000027410,((((((((83:0.0000029038,137:0.0000029038):0.0000029038,145:0.0318507223):0.0000028501,24:0.0671496062):0.1163632117,113:0.0000021856):0.0493687020,120:0.0891022994):0.0000029038,((77:0.9521748729,156:0.0000029038):0.1299934598,87:0.0683799915):0.0666688262):0.0000029038,132:0.0719871003):0.0000029038,(43:0.1792595960,(70:0.1792595687,(71:0.0000029038,72:0.0000029038):0.0000029038):0.0591965195):0.0000029038):0.0000029038):0.0000026388):0.1919439432,(((((74:0.2397350603,141:0.0000021606):0.0000021606,144:0.0000021606):0.0000021606,((128:0.2850040162,160:0.1401881000):0.0000020578,158:0.0000021606):0.0000021606):0.0000025737,(((33:0.0000027204,34:0.0000029038):0.3088311797,(((42:0.0000021606,(126:0.4203196949,149:0.0000021999):0.1331358842):0.0000020278,140:0.0000021606):0.0000021528,142:0.1354323402):0.0000027828):0.0000028003,(157:0.0877999635,(((((((17:0.0840941514,99:0.1029654368):0.0000025737,135:0.1353901807):0.0000025737,159:0.1027593844):0.0000025737,(47:0.1548360280,94:0.1774610234):0.0875685409):0.0000025737,(56:0.0000027205,57:0.0000021606):0.0000024787):0.1029459857,22:0.0000021606):0.0000020058,((15:0.3704920552,25:0.0074586990):0.1493214917,51:0.0515624746):0.0000023224):0.0000029653):0.0000027376):0.0000025737):0.0904670587,155:0.0000021606):0.0000028811):0.0000027204,((((((((60:0.1835461666,(29:0.1295698642,(14:0.0904633001,(55:0.1791711431,131:0.1690718168):0.0780338092):0.1212762065):0.0000024256):0.0000029038,153:0.1511700112):0.0000029038,20:0.0000029038):0.2280372263,(46:0.0000024255,67:0.1296469338):0.0071269450):0.0261497243,(96:0.1335154030,((86:0.1542942248,136:0.0398665817):0.0608506947,(98:0.0776401471,(39:0.4480576373,((58:0.1386432880,68:0.1982884708):0.4044860131,81:0.0000026679):0.0744850986):0.0264702527):0.0000028638):0.0602071661):0.0655664717):0.0292291228,50:0.1567111055):0.0000029038,((26:0.1401885999,(36:0.1309895011,115:0.1931695740):0.0000029038):0.0000029038,49:0.3105617502):0.0000022923):0.0000026316,((93:0.0000029038,((44:0.1781618662,124:0.0639473086):0.0639395247,48:0.4450674986):0.0000028838):0.0000029038,(79:0.0000029038,80:0.0000029038):0.3412277486):0.0000029038):0.0290866522):0.0922166898,((((((8:0.0000023621,45:0.0921891125):0.1780212807,((((((((9:0.0000021999,130:0.2186368847):0.0000021999,(112:0.0000027051,151:0.1792594954):0.0000027051):0.0000027051,(108:0.0841047554,(12:0.2633638104,107:0.4663465328):0.0000020260):0.0000028933):0.0000027051,146:0.0000021999):0.0000027051,((19:0.0000021999,97:0.0000021999):0.2703979651,(((38:0.0325606850,((84:0.0000021999,85:0.0000021999):0.1104554018,147:0.0000021999):0.1049083939):0.0697704195,89:0.0734057017):0.0682403653,(111:0.0807081810,(110:0.0393773803,109:0.0000021999):0.0000021999):0.0807091926):0.0000027436):0.0000027436):0.0310322332,139:0.0746768415):0.0000028078,64:0.1631864642):0.0000028078,138:0.0807081891):0.0000021606):0.0000021606,133:0.0775753556):0.0000029361,((28:0.0236726393,66:0.2972577802):0.2558968123,(((27:0.0000021999,69:0.1115417063):0.0726950110,65:0.0746767041):0.0000021999,105:0.0000021999):0.0000021999):0.0902744482):0.0000026905,((((16:0.0816303798,122:0.0000021999):0.1718684432,(((73:0.2162610731,118:0.0000025881):0.0000023940,119:0.0000029038):0.0000026388,152:0.1146833249):0.0000029653):0.0000022926,(40:0.1776610824,61:0.3840130918):0.0000021560):0.0000025982,63:0.1354314619):0.0000021219):0.0298033131,127:0.0000021606):0.0606337244):0.0000026657,((13:0.1700924289,(41:0.1882074045,92:0.1581603250):0.0710764296):0.0000027436,((((5:0.0000021999,7:0.0000021999):0.0000021999,6:0.0000021999):0.1175170815,148:0.0906328035):0.0358464762,(32:0.4422233208,75:0.0918389165):0.0000027436):0.0000029361):0.0000029361):0.2207213131,161:0.3172464783):0.0000026749):0.0000029038,2:0.0351838623):0.2224078273,3:0.5857666480,0:0.0799459838); ERROR: phylokernelnew.h:3179: double PhyloTree::computeLikelihoodFromBufferGenericSIMD() [VectorClass = Vec4d, FMA = true, SITE_MODEL = false]: Assertion `prob_const < 1.0 && prob_const >= 0.0' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: result_morf_mol.log ERROR: *** Alignment files (if possible) One friend suggest me to change the -bnni command for the -bspec GENE command, but i want to make sure that was the problem. Thanks. ", "Hi Emmanuel, CC Diep, It looks like -bnni option does not work with GENE resampling (-bspec GENE)\u2026 We\u2019ll take a note, but for now please avoid doing these two options together. Thanks! Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "tJ4yREUzruc": {"topic": "-nt number of threads or cores?", "initializeDate": "Jul 17, 2018, 10:36:54 AM", "timeStamp": "Jul 19, 2018, 1:51:30 PM", "content": ["Hello, I'm trying to run IQ-Tree on a machine with 64 cores, each with 4 threads. I know my alignment is long enough that I want to use all the available cores, minus 1 for the OS. Does the -nt option set the number of threads to be used, or the number of cores? In the documentation it mostly says \"cores,\" but -nt sounds like it means \"number of threads\" to me? Thanks, Carter ", "Hi Carter, -nt is indeed to specify the number of threads. But for IQ-TREE you shouldn\u2019t use more threads and real-cores, i.e. hyperthreading is not beneficial and can even slow down the analysis. So if you have 64 real cores, then use at most -nt 63. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "8Rk1pGhT5oA": {"topic": "Removing recombinant genes with GET_PHYLOMARKERS", "initializeDate": "Dec 28, 2020, 6:22:43 PM", "timeStamp": "Dec 30, 2020, 5:26:16 PM", "content": ["Hello, I am using the GET_HOMOLOGUES/ GET_PHYLOMARKERS pipeline for pangenomic analysis and for generating core-genome gene clusters alignments ( https://www.frontiersin.org/articles/10.3389/fmicb.2018.00771/full ). This pipeline includes a step to scan gene cluster alignments with the Phi-test ( Bruen et al., 2005 ) to identify and discard those with significant evidence for recombinant sequences. This pipeline also allows removal of genes that yield \u201c outlier gene trees \u201d and poorly resolved gene trees Since this is a relatively new paper (2018) and I am new to Phylogenomics, I would like to know is this practice of removing recombinant genes from the alignment used for tree reconstruction is recommended and well accepted on the field. I've used IQtree to create a concatenation-based species tree using a partition model with Ultrafast bootstrap using all the core genes as well as the output after each filtering step. The issue is that I am not sure how to determine which one is better, so I would really appreciate some guidance. Thanks a lot. Isabel ", "Hi Isabel, While I am not an expert on phylogenomics, I have been digging a bit on the same topic of including/removing recombination tracts and I am not sure this is settled, but a couple of papers suggest that removing may be worst than including: https://academic.oup.com/mbe/article/33/7/1711/2578655?login=true#87271471 https://mbio.asm.org/content/5/6/e02158-14.short ", "Thanks Ricardo, I will take a look at those papers. Happy New Year! You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/8Rk1pGhT5oA/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6d7775e9-66c4-4308-a6d7-6c2d69a3304cn%40googlegroups.com "]}, "BbGQE_97lHE": {"topic": "ERROR: Sequence XXX contains not enough characters (38955)", "initializeDate": "Apr 25, 2019, 10:06:02 AM", "timeStamp": "Dec 10, 2020, 4:07:00 AM", "content": ["Hi all, I know this error has cropped up before on these discussions, but I have checked my aligned fasta file and all the sequences are the same length. In making the alignment, I have had to locally align families of plants because the gene does not align between families. Then I have had to concatenate all of these local alignments into one large file, and then concatenate this large file with alignments of genes that align between families. e.g. local alignment gapped sequence genes aligning between families family_alignment_sequence--------------------------------------all_alignment_sequence ------------------------------------family_alignment_sequence2all_alignment_sequence Does IQTREE support this format? I apologise if I have very poorly explained what my data looks like! Thanks, Max ", "Hi Max, What you described sounds OK. This ERROR message means that some sequence(s) do not have the same length. So it\u2019s perhaps some mistake in the processing pipeline you used to generate the concatenated alignment file\u2026 So please check the sequence(s) that IQ-TREE reported there. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hello everyone, I am currently studying Bioinformatics. I am also new to Iqtree. I have tried to make multiple sequences alignment between covid19's genome and other viruses. I have used a fast file to do this. Here is the error I got: \"ERROR: Sequence XXX contains not enough characters\" \"ERROR: Sequence XXX contains too many characters\" Does it seem like Iqtree doesn't support alignment for the genomes have different lengths? Thanks for your concern! V\u00e0o l\u00fac 10:47:39 UTC+7 ng\u00e0y Th\u1ee9 S\u00e1u, 26 th\u00e1ng 4, 2019, Minh Bui \u0111\u00e3 vi\u1ebft: ", "Dear Dinh, As wrote before, the error massage speaks for itself. Check these XXX sequences that IQ-TREE reported. In a sequence alignment, all sequences including gaps must have the same length. Back up one step, did you use any alignment programs like MAFFT or MUSCLE align your sequences? Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/21fcf1de-185c-4c7a-a32f-78ea1a6d10f1n%40googlegroups.com "]}, "mA5z8B96iB0": {"topic": "problem with ancestral sequnce reconstruction for morpholical data set", "initializeDate": "Apr 17, 2019, 11:13:14 AM", "timeStamp": "Apr 18, 2019, 9:40:57 AM", "content": ["Hello everyone, I am trying to get iq tree to run an ancestral state reconstruction of a morpholgical character matrix. I am using a contrained topology to infer the ancestral state the command line I use is: iqtree -s morph_matrix.nex -te constrained_tree.phy -asr Now, when iq tree reads in the nexus file it gives me warning that it will skip sequences which are ambigious (some characters are coded as 0&1) an treats them as unknown characters. Thats not a problem for the purpose of this analysis, the next warning I get is that state(s) A, B, C, D, F, g, etc. rarely appear in alignment and may cause numerical problems. From here it will carry on estimating log likelihood and then I get the ERROR: IQ- TREE CRASHES WITH SIGNAL SEGMENTATION FAULT. I've attached the log file to this post. I'm struggling very much to find out what may be causing this error, any help would be very much appreciated. Thanks, Conrad. ", "And this is the alignment file, thanks again. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "I have solved the problem. Iq tree couldn't handle characters with 10+ states and were coded with letters so I removed those and I also removed autapomorphies where species were coded with multiple character states (changed to unknown). After doing that I had no problem running Iq tree with the initial command. ", "Cool, great that you have solved it yourself. Minh "]}, "eTxBhqhbx3g": {"topic": "BUG: IQtree crashes during bootstrap running with predefined codon model", "initializeDate": "Mar 7, 2018, 7:03:56 AM", "timeStamp": "Mar 18, 2018, 6:46:16 PM", "content": ["Hi Minh, I was trying to run a non-parametric bootstrap analysis of a nucleotide alignment using codon models in my server (Linux-64 bit, my node is: Host: node002 (AVX2, FMA3, 1009 GB RAM) Kernel: AVX+FMA - 8 threads (16 CPU cores detected) Command used is: iqtree-omp -s gene_untrimmed_280218_QC.fasta -st CODON -m GY+F+R10 -b 100 -nt 8 I had provided the model here because I had tried running it before without specifying the model and it crashed. After several attempts, I got it to the point where it selected the best model, which is that one specified above. So in the last run, after specifying the model, it run fine for 4 bootstraps, but then it crashed in the 5th. I tried re-submitting the job but always crashes at this point. I get the following error message: CHECKPOINT: Initial tree restored NOTE: 1343 MB RAM (1 GB) is required! Estimate model parameters (epsilon = 0.100) 1. Initial log-likelihood: -520358.546 ERROR: phylokernelnew.h:2951: double PhyloTree::computeLikelihoodBranchGenericSIMD(PhyloNeighbor*, PhyloNode*) [with VectorClass = Vec4d; bool SAFE _NUMERIC = true; bool FMA = true; bool SITE_MODEL = false]: Assertion `!std::isnan(tree_lh) && \"Numerical underflow for lh-branch\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 6 double PhyloTree::computeLikelihoodBranchGenericSIMD<Vec4d, true, true, false>(PhyloNeighbor*, PhyloNode*) ERROR: 7 PhyloTree::computeLikelihood(double*) ERROR: 8 PhyloTree::computeFunction(double) ERROR: 9 Optimization::minimizeOneDimen(double, double, double, double, double*, double*) ERROR: 10 PhyloTree::optimizeTreeLengthScaling(double, double&, double, double) ERROR: 11 RateFree::optimizeWithEM() ERROR: 12 ModelFactory::optimizeParameters(int, bool, double, double) ERROR: 13 ModelFactory::optimizeParametersGammaInvar(int, bool, double, double) ERROR: 14 IQTree::optimizeModelParameters[abi:cxx11](bool, double) ERROR: 15 runTreeReconstruction(Params&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, IQTree*&, ModelCheckpo int&) ERROR: 16 runStandardBootstrap(Params&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, Alignment*, IQTree*) ERROR: 17 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 18 main() ERROR: 19 __libc_start_main() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: gene_untrimmed_280218_QC.fasta.log ERROR: *** Alignment files (if possible) /cm/local/apps/sge/current/spool/node002/job_scripts/3100568: line 14: 28590 Aborted (core dumped) ~/bin/iqtree-omp -s gene_untrimm ed_280218_QC.fasta -st CODON -m GY+F+R10 -b 100 -nt 8 Is there anything I'm supposed to do differently? or is it a problem of my software? I'm running a version compiled in the actual cluster because pre-compiled versions always crashed in my server. Any help would be very appreciated! Thanks! Karen. ", "Oh I forgot to add, the seed number for this crashed job was: ===> START BOOTSTRAP REPLICATE NUMBER 5 Creating bootstrap alignment (seed: 268635)... CHECKPOINT: Initial tree restored ... ", "Hi Karen, Thanks for the detailed report. Do you see any WARNINGs in the log-file? My guess now is that +R10 can be over-fitting for your alignment, causing numerical problem. But anyway please send me the alignment and all output files via my personal email for debugging purpose. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Karen, While fixing this bug, I notice some obvious error in your alignments: That means, the start codon (ATG) are not correctly aligned. These 3 middle sequences are shifted forward and wrongly aligned, which might cause long branches leading to them and numerical problems as you observed. So I would first go back to correct the alignment again (even manually if the alignment program does not do a good job), before running IQ-TREE. Cheers Minh "]}, "-GsOG2D6Cxo": {"topic": "Segfault when directory does not exist", "initializeDate": "Sep 29, 2017, 12:14:17 PM", "timeStamp": "Oct 3, 2017, 8:46:02 AM", "content": ["Segfaults when -pre points to a dir that does not exist. Should either complain gracefully or create the directory. ", "Dear Michael, Thanks for the report. Indeed I checked again and saw that with version 1.5.1 or earlier, iqtree exited with an error message: ERROR: Cannot write to file xxx/yyy.ckp.gz Whereas version 1.5.2 or later does not do so. Thus, we will fix this problem in the next release. Cheers, Minh "]}, "Jdp4plO0-D8": {"topic": "output tree does not follow the constraint topology", "initializeDate": "Mar 25, 2021, 6:41:08 AM", "timeStamp": "Apr 16, 2021, 10:10:54 AM\u00a0(12 days ago)\u00a0", "content": ["Hello, I tried a constrained tree search using iqtree v2.0.3, but the resulting tree did not obey a constraint tree topology specified via -g option. I also specified outgroup using -o option (species_1) as suggested in the previous post, but it did not fix the problem. I have attached the constraint tree (const.tree.nwk), which is a multifurcating at the order level as highlighted in colors in the picture, and the resulting tree (concat.cds.trimal.iqtree.renamed.nwk). I am not sure what could be the problem and how to fix it. I would appreciate if you could help me with this issue. Best regards, ", "I don\u2019t really see any problem here\u2026 Can you please say explicitly, which taxa in the resulting tree do not obey the constraint? Cheers, Minh On 25 Mar 2021, at 9:41 pm, foxg...@gmail.com wrote: Hello, I tried a constrained tree search using iqtree v2.0.3, but the resulting tree did not obey a constraint tree topology specified via -g option. I also specified outgroup using -o option (species_1) as suggested in the previous post, but it did not fix the problem. I have attached the constraint tree (const.tree.nwk), which is a multifurcating at the order level as highlighted in colors in the picture, and the resulting tree (concat.cds.trimal.iqtree.renamed.nwk). <Picture1.png> I am not sure what could be the problem and how to fix it. I would appreciate if you could help me with this issue. Best regards, You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8ceecdc9-db71-44b7-9008-f40cc3468082n%40googlegroups.com <Picture1.png> <nwk_file.tar.gz> ", "Thank you very much for your swift response. In the above picture, multiple species from the same order are highlighted in the same colour. Supergroup1 (yellow + specie_39,40), not purple-highlighted species (specie_32-37), should diverge first after specie_12. Specie_13,38 in red are included in the same clade with Supergroup1 in the resulting tree. They should be included in the same clade with supergroup2 (purple + green + blue). Best wishes, 2021\u5e743\u670825\u65e5\u6728\u66dc\u65e5 12:18:44 UTC+1 Minh Bui: ", "I found that constrained tree search did not work when I used MFP '-m MFP' in IQ-TREE(v2.0.3). I could successfully obtain the tree with the same topology as the constraint tree by specifying a certain substitution model (e.g. '-m GTR+F+R6') instead of MFP. I am not sure whether this is a problem in IQ-TREE, but I would like to report here to mention my problem was fixed. I hope this information may help. Thank you very much for having this kind of place to support users. Best wishes, 2021\u5e743\u670825\u65e5\u6728\u66dc\u65e5 15:17:13 UTC+1 foxg...@gmail.com "]}, "ufQ1nZ5wYAs": {"topic": "IQ-TREE release 1.5.5", "initializeDate": "Jun 2, 2017, 8:44:56 AM", "timeStamp": "Jun 2, 2017, 8:44:56 AM", "content": ["June 2, 2017 Dear users, We are pleased to release version 1.5.5 ( http://www.iqtree.org ) which fixes several bugs and improves software stability. New features: \u2022 Support gene-resampling (-bsam GENE) and gene-site-resampling (-bsam GENESITE) for standard bootstrap with partition models. \u2022 Support and treat polymorphic characters in (...) or {...} notation as missing data (requested by Steven Heritage). \u2022 Improved numerical stability for codon models (reported by Giorgio Matassi, Sarah Mathews, Ricardo Alves). Note that numerics may still fail if many codons are absent in the data. \u2022 Do not test ascertainment bias correction (+ASC) for codon models by default (thanks Ricardo Alves). \u2022 Only reduce minimal branch length for long alignment and un-partition models (thanks to Steven Mussmann). Bugfixes: \u2022 Initial tree generation problem with constrained tree search option -g. \u2022 Likelihood underflow for large multifurcating trees (e.g. consensus tree) (reported by Giap Nguyen). \u2022 Crash with -minsupnew option (reported by Longzhi Tan). \u2022 Compilation with gcc under Mac (thanks @ilovezfs). \u2022 Crash with -nni1 for partition model -spp (reported by Diep Thi Hoang). We thank all people mentioned above for the reports and discussions. Best, IQ-TREE development team "]}, "WfhfFS3CMGM": {"topic": "BUG: Unable to process alignment by training of PMSF model", "initializeDate": "Jun 11, 2020, 4:21:24 AM", "timeStamp": "Jul 1, 2020, 5:30:02 AM", "content": ["Hi to all! I tried to trainthe PMSF model for my alignments and obtained the same error messages for all files: iqtree -nt AUTO -s cox2.G10.fas -m LG+C20+F+G -ft MEGAtree_mtREV_F.newick -n 0 ERROR: phylotreepars.cpp:63: void PhyloTree::computePartialParsimonyFast(PhyloNeighbor *, PhyloNode *): Assertion `!aln->ordered_pattern.empty()' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: atp6.G10.fas.log The alignment and the log files are attached. I would be very appreciated for assistance Yours sinserely, Alexey Neverov ", "Sorry I fogot to attach a guide tree file \u0447\u0435\u0442\u0432\u0435\u0440\u0433, 11 \u0438\u044e\u043d\u044f 2020 \u0433., 11:21:24 UTC+3 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c Alexey Neverov \u043d\u0430\u043f\u0438\u0441\u0430\u043b: ", "Hi Alexey, Which IQ-TREE version did you use? It looks like some old bug that was fixed some time ago. So please try the latest version, e.g. the stable 1.6.12 or the latest v2. If it still crashes let me know. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2b7ec7d1-1685-4e66-a8b6-8f2bede8ad4eo%40googlegroups.com <MEGAtree_mtREV_F.newick> ", "I just saw that you used v2.0.3. So that\u2019s OK. However, something concerns me is that your alignment is very short: Alignment has 4350 sequences with 225 columns, 225 distinct patterns 224 parsimony-informative, 1 singleton sites, 0 constant sites In that case, you shouldn\u2019t use any complex models. I\u2019d be very cautious even if you use a simple model \u2014 there is very little phylogenetic information in this alignment. So either add [many] more genes or reduce the number of sequences, before phylogenetic inference. Sorry about that, Minh ", "The problem is somewhare in the '-nt AUTO' option. I sucsessfully processed this dataset when used fixed number of cores by specifying the '-nt 16' option. In the attachment the results of analysis. You mentioned that the number of sites in the alignment might be not sufficient to reliebly estimate model parameters. My alignment contains 4350 sequences. How I can estimate the reliability of obtained results? The log file contains the warning: 'WARNING: The mixture model might be overfitting because some mixture weights are estimated close to zero'. Totally 6 out of 20 weights are zero. Is it really a problem? Can I deal with it by reducing the number of classes in the model? Thank you for your reply. Yours Alexey. \u0441\u0443\u0431\u0431\u043e\u0442\u0430, 13 \u0438\u044e\u043d\u044f 2020 \u0433., 1:18:36 UTC+3 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c Minh Bui \u043d\u0430\u043f\u0438\u0441\u0430\u043b: I just saw that you used v2.0.3. So that\u2019s OK. However, something concerns me is that your alignment is very short: Alignment has 4350 sequences with 225 columns, 225 distinct patterns 224 parsimony-informative, 1 singleton sites, 0 constant sites In that case, you shouldn\u2019t use any complex models. I\u2019d be very cautious even if you use a simple model \u2014 there is very little phylogenetic information in this alignment. So either add [many] more genes or reduce the number of sequences, before phylogenetic inference. Sorry about that, Minh On 13 Jun 2020, at 7:58 am, Minh Bui < min...@univie.ac.at > wrote: Hi Alexey, Which IQ-TREE version did you use? It looks like some old bug that was fixed some time ago. So please try the latest version, e.g. the stable 1.6.12 or the latest v2. If it still crashes let me know. Minh On 11 Jun 2020, at 9:52 pm, Alexey Neverov < nev...@gmail.com > wrote: Sorry I fogot to attach a guide tree file \u0447\u0435\u0442\u0432\u0435\u0440\u0433, 11 \u0438\u044e\u043d\u044f 2020 \u0433., 11:21:24 UTC+3 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c Alexey Neverov \u043d\u0430\u043f\u0438\u0441\u0430\u043b: Hi to all! I tried to trainthe PMSF model for my alignments and obtained the same error messages for all files: iqtree -nt AUTO -s cox2.G10.fas -m LG+C20+F+G -ft MEGAtree_mtREV_F.newick -n 0 ERROR: phylotreepars.cpp:63: void PhyloTree::computePartialParsimonyFast(PhyloNeighbor *, PhyloNode *): Assertion `!aln->ordered_pattern.empty()' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: atp6.G10.fas.log The alignment and the log files are attached. I would be very appreciated for assistance Yours sinserely, Alexey Neverov You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Alexey, You mentioned that the number of sites in the alignment might be not sufficient to reliebly estimate model parameters. My alignment contains 4350 sequences. How I can estimate the reliability of obtained results? You could simulate data that resemble the data you have (i.e. under the PMSF-type models, and alignments of the same length, number of rows, site rates, and information content that you have), and then test how well you can recover trees when using PMSF models (as you have for your empirical data) when compared to other, simpler models. This is a standard procedure called a parametric bootstrap (just to help you find things via google!). The log file contains the warning: 'WARNING: The mixture model might be overfitting because some mixture weights are estimated close to zero'. Totally 6 out of 20 weights are zero. Is it really a problem? Yes. Can I deal with it by reducing the number of classes in the model? Potentially. But as Minh said, 225 informative sites is very very little information. At the very least I would recommend comparing a large range of models (focussing particularly on the most simple models) using standard approaches like the AICc, BIC, etc. This will give you a good feeling for whether you can realistically justify parameter-rich models. Rob To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1dc1c6e6-2abf-4467-85d9-c4ff919ebb76o%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Dear Alexey, Two additional comments in addition to those of Minh and Rob: > On 28 Jun 2020, at 20:43, Alexey Neverov < neva...@gmail.com > wrote: > The problem is somewhare in the '-nt AUTO' option. I sucsessfully processed this dataset when used fixed number of cores by specifying the '-nt 16' option. In the attachment the results of analysis. With only 225 sites in the alignment, parallelisation will not efficiently, meaning time savingly, work either. Typically, batches of sites are distributed to different processors. This causes some extra time to be required, e.g., for distributing the data and collecting the results. Hence, the batches have to be sufficiently large, to actually save more time than is caused by this overhead. We have seen people enforcing high numbers of threads (cores) and then ended up with longer running times than when using only 1 core :( > You mentioned that the number of sites in the alignment might be not sufficient to reliebly estimate model parameters. My alignment contains 4350 sequences. How I can estimate the reliability of obtained results? > The log file contains the warning: Just one comment to think about. Assume all your sites would be informative to resolve parts of the tree. Furthermore, assume that each site can resolve one split (=branch) in the tree (something you typically cannot achieve with real data). Then, your dataset would be able to only able to resolve 225 out of the 4347 branches in your final tree. All other branches would be more or less randomly resolved and might differ from run to run, because there is no information in the data. The only way to resolve a higher percentage of branches reliably is either to add more sequence data to each taxon, e.g. more genes, or to reduce the number of sequences (the first thing here is typically to remove identical sequences - this is also done already by IQ-TREE automatically and then re-added at the end, because here it is clear in what region of the tree they would end up, however, there is no way to determine their branching order in the tree. And as stressed by the others - with so short sequences you should not used complex models. You do not have enough information in the data for this. Best regards, Heiko > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1dc1c6e6-2abf-4467-85d9-c4ff919ebb76o%40googlegroups.com > <atp6.results.zip> ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- "]}, "PK4KrQ8FKGE": {"topic": "AA model defaults to WAG despite specifying JTT?", "initializeDate": "Mar 9, 2016, 3:21:13 PM", "timeStamp": "Mar 18, 2016, 3:28:36 AM", "content": ["Hi, I tried using -mset LG,WAG,JTT,VT to restrict model testing to one of these models, but after iqtree finished running I saw that it had used WAG. I initially thought it had tested all the models and that's what came up as the best fit, but there is no record of model testing in the log. I tried -mset JTT to force it to use JTT, and it still ran WAG. Any thoughts? Thanks, Des ", "Dear Des, -mset option should restrict to only those models specified in the list (with possibility of +G,+I+G, etc.). I am not sure if I understood you right\u2026 did you mean that, in the log file you don\u2019t see these models? Can you pls send me the command line and possibly the log file as well? I ask because if you have an input partition file, then IQ-TREE omitted printing all models for each partition, simply to shorten the log. But in background, all specified models will be considered. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Thanks for your reply. I've attached the log file, my command line file and the iqtree file so you can see what I mean. I tried to use mset to restrict the model selection between 4 models, but there's no evidence that they were tested in the log file, and in the iqtree file, the tree was built using WAG. Let me know what you think! Thanks, Des ", "Hi Des, looking at your command in the log file, the problem is simply because `-m TEST` option is missing. Thus no model selection is invoked and iqtree just used the default WAG model. There is also a warning in the log: WARNING: Default model may be under-fitting. Use option '-m TEST' to select best-fit model. You can also consider using the new model selection procedure with `-m TESTNEW`. Cheers, Minh > <MAR8-16_manually_trimmed_Finalfinalfinalfinal_metazoan_opsin.aln.log><iqtree_trimmed_alignment_final_metaOpsin_MAR8-16.job><MAR8-16_manually_trimmed_Finalfinalfinalfinal_metazoan_opsin.aln.iqtree> ", "Hi Minh, Thanks for the reply. So to be clear, I need to invoke both -m TEST (or -m TESTNEW) and then also -mset JTT,VT,LG to be able to test just those models? Des ", "yes that\u2019s right. Minh "]}, "QRO108Kvtlk": {"topic": "Quantify support for branch nodes in tree reconstruction", "initializeDate": "Jul 9, 2020, 1:20:06 PM", "timeStamp": "Jul 14, 2020, 7:18:50 PM", "content": ["Sorry if this is super obvious but I'd be very grateful for some help understanding how to extract information from the IQ-TREE output on the support for specific branch nodes (e.g. bootstrap values). I am producing a tree from a multi-fasta alignment using ModelFinder + tree reconstruction (IQ-TREE 1.6.12 built Aug 15 2019). The terminal command looks like: ~/PATH/iqtree -s alignment_file -m MFP I'm initially visualising the tree in FigTree but my question is about the IQ-TREE output. When I look at the .iqtree file there is an outline of the basic tree shape and a warning message: \"near-zero internal branches (<0.0000) should be treated with caution/ Such branches are denoted by '**' in the figure below\". So it's a bit laborious but I can search for a sample manually in a text editor in this file to find its branch node, and then see whether there is ** at the branch or not. This gives me a qualitative sense of whether or not the branch is well supported. But what about a more quantitative output for a given branch e.g. its bootstrap value? Also, is there a more efficient way of searching for this information other than what I'm currently doing: looking at the tree (e.g. on FigTree or Microreact), deciding the branch I want to look at, control-F to find the sample ID next to the branch point in the .iqtree file, and checking whether there are ** next to that branch? Is it listed somewhere in a more searchable format? Many thanks for your help. Best wishes, Will ", "Hi Will, On 10 Jul 2020, at 3:20 am, 'Will Hamilton' via IQ-TREE < iqt...@googlegroups.com > wrote: Sorry if this is super obvious but I'd be very grateful for some help understanding how to extract information from the IQ-TREE output on the support for specific branch nodes (e.g. bootstrap values). I am producing a tree from a multi-fasta alignment using ModelFinder + tree reconstruction (IQ-TREE 1.6.12 built Aug 15 2019). The terminal command looks like: ~/PATH/iqtree -s alignment_file -m MFP Just note: you can actually omit -m MFP, as this is the default behaviour. I'm initially visualising the tree in FigTree but my question is about the IQ-TREE output. When I look at the .iqtree file there is an outline of the basic tree shape and a warning message: \"near-zero internal branches (<0.0000) should be treated with caution/ Such branches are denoted by '**' in the figure below\". So it's a bit laborious but I can search for a sample manually in a text editor in this file to find its branch node, and then see whether there is ** at the branch or not. This gives me a qualitative sense of whether or not the branch is well supported. But what about a more quantitative output for a given branch e.g. its bootstrap value? Normally such short branches will likely have low supports. So it\u2019s OK if you just look at the bootstrap supports in FigTree. You can use -czb option (in v1.6) or --polytomy option v2.0. This will collapse all near-zero branches in the final tree, so that it may become multifurcating. Also, is there a more efficient way of searching for this information other than what I'm currently doing: looking at the tree (e.g. on FigTree or Microreact), deciding the branch I want to look at, control-F to find the sample ID next to the branch point in the .iqtree file, and checking whether there are ** next to that branch? Is it listed somewhere in a more searchable format? OK, I think the options mentioned above will help? Minh Many thanks for your help. Best wishes, Will You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7efb4f68-6f8d-4b39-aeed-ce7e999496b4o%40googlegroups.com ", "Hi Minh, Thanks for your reply. So how can I see the bootstrap values in FigTree, if I import the IQ-TREE .treefile? If I click \"node labels\" I can see numbers by each branch - are these the bootstrap values? I'm expecting to see a value between 0 and 1 for proportion of trees tried that had the same branch node there. Thanks for your help, and best wishes, Will To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6B861B24-B603-45DE-AAE4-EE92DB9AAA95%40univie.ac.at William L. Hamilton MRCP PhD CMT Academic Clinical Fellow Cambridge University Hospitals NHS Foundation Trust ", "Hi Will, The bootstrap values are in percentage, between 0 and 100%. In FigTree, In the \"Node Labels\u201d tab, click \u201cDisplay\" and choose \u201clabel\u201d. Otherwise, FigTree displays in the \u201cNode ages\u201d by default, which is not what you want. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAHBmnkkGmneEHfbA91apKzCmTnGgutGZ_D5xTDMp7ANikfKT3A%40mail.gmail.com ", "Hi Minh, Under the \"Node labels\" tab, in the \"Display\" box my options are: Node ages, Node heights (raw), Branch times, and Branch lengths (raw). I don't have a \"label\" option here? And none of the options I've listed seem to give sensible numbers as a percentage between 0-100%. Sorry if I'm missing something obvious! Best Wishes, Will To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/69948E90-69D1-46C7-9E6F-E470FFEAB0DD%40univie.ac.at ", "Oh, This is because you didn\u2019t perform bootstrap, that\u2019s something I missed from your first email. Please continue to read the tutorial in the bootstrap section, http://www.iqtree.org/doc/Tutorial Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAHBmnkkRX8ZjJKPriYVKJn9fmB0duWm%3DzuMkwSxJtbHc58DLYw%40mail.gmail.com "]}, "WNyl8vYDDFQ": {"topic": "Heterotachy models with amino acids", "initializeDate": "Oct 19, 2016, 4:30:45 PM", "timeStamp": "Oct 21, 2016, 10:41:42 AM", "content": ["Hello, I want to try the new version of IQ-TREE allowing heterotachy models. However, it seems that it is not possible to add heterotachy when performing a best-fit analysis. How can I choose the correct model to use with heterotachy? Finally, how can I rigorously choose the number of mixture classes? My dataset is in amino acids. Thank you! ", "Hi Anthony, Since you have an amino acid alignment you have a few options as to how you implement the heterotachy model. The heterotachy model will not infer substitution rates each class for amino acid data because of the high number of parameters involved. So you must stipulate one of the predefined rate matrices available in IQ-TREE. You can find them here http://www.iqtree.org/doc/Substitution-Models/ . You then have two options when it comes to the amino acid frequencies. You can fix these to the observed frequencies in your sequence alignment. To do this you add +F after substitution model you selected. Alternatively you can allow the heterotachy model to infer a different set of amino acid frequencies for each class. In this case you should add +FO after the substitution model you selected. Finally you need to stipulate the number of classes you want in the heterotachy model. To do this add +H6 for example if you wanted 6 classes. So an example command for running the heterotachy model on mydata.phy, using the LG substitution model, using 4 classes and inferring frequencies for each class would be: iqtree -s mydata.phy -m LG+FO+H4 For your second question, there is currently no feature in IQ-TREE to select between different numbers of mixture classes. Currently the method I have employed is to try a few different numbers of classes and compare the results based on AIC or some other model selection criterion you might prefer. Please pay attention to the number of parameters in your model. Depending on the size of your tree the number of parameters grows very quickly as a new set of branch lengths (and perhaps frequencies) is added with each class. I hope this helps! Stephen ", "Thank you! "]}, "xbncLFYmqWk": {"topic": "Include models to test with -madd, not appearing in list of tested models", "initializeDate": "Oct 19, 2020, 5:45:09 AM", "timeStamp": "Oct 22, 2020, 11:18:38 PM", "content": ["Hi, I'm not sure if this is a bug or I am just using the command wrong, I'm trying to include LG+C60+G+F, and LG+C60+R+F as models to test with the model finder, but these aren't added when I use -m and -madd as I understand from the docs: Details: IQ-TREE multicore version 2.0.6 for Linux 64-bit built May 30 2020 Command: iqtree2 -s file.faa -m MFP -madd LG+C60+F+G,LG+C60+F+R -bb 1000 -T 24 Seed: 148707 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Fri Oct 16 17:04:53 2020 Kernel: AVX+FMA - 24 threads (64 CPU cores detected) Results of model finder: NOTE: ModelFinder requires 12602 MB RAM! ModelFinder will test up to 548 protein models (sample size: 11602) ... No. Model -LnL df AIC AICc BIC 1 LG 7168743.715 1397 14340281.430 14340664.223 14350561.859 2 LG+I 7145604.743 1398 14294005.486 14294388.863 14304293.274 3 LG+G4 6767858.360 1398 13538512.720 13538896.097 13548800.508 4 LG+I+G4 6763863.312 1399 13530524.624 13530908.588 13540819.771 5 LG+R2 6877205.514 1399 13757209.027 13757592.991 13767504.174 6 LG+R3 6795297.917 1401 13593397.834 13593782.971 13603707.698 7 LG+R4 6765228.181 1403 13533262.363 13533648.676 13543586.945 8 LG+R5 6750169.945 1405 13503149.890 13503537.381 13513489.191 9 LG+R6 6742321.201 1407 13487456.402 13487845.073 13497810.420 10 LG+R7 6738153.626 1409 13479125.252 13479515.105 13489493.989 11 LG+R8 6735426.170 1411 13473674.340 13474065.377 13484057.795 12 LG+R9 6733559.397 1413 13469944.793 13470337.016 13480342.965 13 LG+R10 6732530.584 1415 13467891.169 13468284.579 13478304.059 26 LG+F+R10 6735247.625 1434 13473363.251 13473768.049 13483915.960 39 WAG+R10 6791294.603 1415 13585419.206 13585812.616 13595832.095 52 WAG+F+R10 6778033.730 1434 13558935.460 13559340.258 13569488.169 65 JTT+R10 6851377.417 1415 13705584.834 13705978.244 13715997.724 78 JTT+F+R10 6850323.249 1434 13703514.498 13703919.296 13714067.208 91 JTTDCMut+R10 6849628.949 1415 13702087.898 13702481.308 13712500.788 104 JTTDCMut+F+R10 6847246.126 1434 13697360.253 13697765.051 13707912.962 117 DCMut+R10 6904138.053 1415 13811106.107 13811499.517 13821518.997 130 DCMut+F+R10 6874975.231 1434 13752818.461 13753223.259 13763371.171 143 VT+R10 6800497.396 1415 13603824.792 13604218.202 13614237.681 156 VT+F+R10 6794584.031 1434 13592036.063 13592440.860 13602588.772 169 PMB+R10 6825104.982 1415 13653039.965 13653433.375 13663452.855 182 PMB+F+R10 6819682.554 1434 13642233.108 13642637.906 13652785.818 195 Blosum62+R10 6810897.210 1415 13624624.419 13625017.830 13635037.309 208 Blosum62+F+R10 6814076.221 1434 13631020.442 13631425.240 13641573.152 221 Dayhoff+R10 6903827.061 1415 13810484.122 13810877.532 13820897.011 234 Dayhoff+F+R10 6874906.143 1434 13752680.286 13753085.084 13763232.996 247 mtREV+R10 7178097.573 1415 14359025.145 14359418.556 14369438.035 260 mtREV+F+R10 6937038.631 1434 13876945.262 13877350.060 13887497.972 273 mtART+R10 7203453.285 1415 14409736.570 14410129.980 14420149.460 286 mtART+F+R10 6973350.716 1434 13949569.432 13949974.230 13960122.142 299 mtZOA+R10 7017835.700 1415 14038501.400 14038894.810 14048914.290 312 mtZOA+F+R10 6884714.727 1434 13772297.454 13772702.251 13782850.163 325 mtMet+R10 7151504.237 1415 14305838.474 14306231.885 14316251.364 338 mtMet+F+R10 6955300.098 1434 13913468.195 13913872.993 13924020.905 351 mtVer+R10 7291901.565 1415 14586633.130 14587026.540 14597046.020 364 mtVer+F+R10 7111867.463 1434 14226602.927 14227007.725 14237155.636 377 mtInv+R10 7126118.212 1415 14255066.425 14255459.835 14265479.315 390 mtInv+F+R10 6865717.938 1434 13734303.875 13734708.673 13744856.585 403 mtMAM+R10 7401744.481 1415 14806318.962 14806712.372 14816731.852 416 mtMAM+F+R10 7181783.818 1434 14366435.636 14366840.434 14376988.345 429 HIVb+R10 7068739.669 1415 14140309.338 14140702.748 14150722.228 442 HIVb+F+R10 7065518.939 1434 14133905.877 14134310.675 14144458.587 455 HIVw+R10 7388115.552 1415 14779061.103 14779454.514 14789473.993 468 HIVw+F+R10 7326162.229 1434 14655192.459 14655597.257 14665745.168 481 FLU+R10 6988280.200 1415 13979390.401 13979783.811 13989803.291 494 FLU+F+R10 6995792.906 1434 13994453.812 13994858.610 14005006.522 507 rtREV+R10 6804616.417 1415 13612062.834 13612456.245 13622475.724 520 rtREV+F+R10 6760875.194 1434 13524618.388 13525023.185 13535171.097 533 cpREV+R10 6821898.155 1415 13646626.310 13647019.720 13657039.200 546 cpREV+F+R10 6822468.676 1434 13647805.352 13648210.150 13658358.062 Akaike Information Criterion: LG+R10 ", "Hi there, I can\u2019t reproduce what you said. -madd option works in my case, with the same version 2.0.6 (and all other verions). So please send me the log file. I suspect that you didn\u2019t look carefully at the log file, because it says \u201ctest up to 548 protein models\u201d, and you only pasted the part up to model 546. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8e65d60a-62fd-4304-a4fc-6596d4fde37an%40googlegroups.com "]}, "UFlZvhGtzik": {"topic": "ERROR: IQ-TREE CRASHES WITH SIGNAL ABORTED", "initializeDate": "Sep 22, 2020, 10:12:46 PM", "timeStamp": "Sep 23, 2020, 4:56:05 AM", "content": ["Hello sir, Very happy to see IQ-Tree implements a powerful molecular dating algorithm. It seems that I encountered a bug when dating using IQ-Tree with my data set. May I ask what's wrong with the data? I attach my data and log files here. IQ-TREE multicore version 2.0-rc2 for Linux 64-bit built Mar 28 2020 Command: iqtree -st DNA -T 8 -nt AUTO -m GTR -o 241119 -s HA1_Iqtree.fasta Thank you. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: HA1_Iqtree.fasta.log ERROR: *** Alignment files (if possible) ", "Can you try v2.1.1? It integrated a more recent version of LSD2, which has fixed a few bugs. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/33367421-2ba4-4acf-94fb-be2314057ed7n%40googlegroups.com <HA1_Iqtree.fasta.tar.gz> ", "Thanks for your help. I will try it. "]}, "Y9dMy8C6Rjs": {"topic": "bootstrap values of Neighbor-Joining, Maximum Likelihood along with Bayesian Posterior probabilities", "initializeDate": "Jan 3, 2020, 3:39:40 AM", "timeStamp": "Jan 6, 2020, 12:57:18 AM", "content": ["Hi, I have successfully generated a ML phylogenic tree for set of orthologues using IQTREE. Tree nicely shows sh-aLTR support and UFboot values for each node. For same set of orthologues I generated bayesian tree using program MrBayes. My question is which tree I should select for downstream analysis ? Can I have one single tree which show Posterior probabilities (from bayesian tree) and; bootstrap values from maximum likelihood and neighbour joining in a one single tree ? Cheers, Chirag. ", "Hi Chirag, On 3 Jan 2020, at 7:39 pm, Chirag Parsania < chirag....@gmail.com > wrote: Hi, I have successfully generated a ML phylogenic tree for set of orthologues using IQTREE. Tree nicely shows sh-aLTR support and UFboot values for each node. For same set of orthologues I generated bayesian tree using program MrBayes. My question is which tree I should select for downstream analysis ? How different are the two tree topologies by IQ-TREE and MrBayes? You can compute the Robinson-Foulds distance or just simply look at the trees. You can also perform some tree topology tests (e.g. AU test), which can be done in IQ-TREE (see the Advanced Tutorials). If the two trees are not much different, I think you can take any tree for further analysis. Can I have one single tree which show Posterior probabilities (from bayesian tree) and; bootstrap values from maximum likelihood and neighbour joining in a one single tree ? You can assign UFBoot values onto MrBayes tree using -sup option ( http://www.iqtree.org/doc/Command-Reference#constructing-consensus-tree ) as follows. From the output of IQ-TREE there is a file with suffix .splits.nex, run IQ-TREE with: iqtree -t <iqtree_output>.splits.nex -sup <mrbayes_tree> Then IQ-TREE will print a .suptree file with both MrBayes and UFBoot supports. Finally, I\u2019d not use neighbor-joining tree, if it\u2019s significant worse than ML or Bayesian trees, which you can test with the AU test. Cheers, Minh Cheers, Chirag. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6cb0f6dd-9267-4541-bed5-0fad397287ad%40googlegroups.com ", "Hi, I got tree from MrBayes. My tree has more than 400 taxa. Therefore, it is hard to tell how different it is from output of IQ-TREE. However, major clades looks same. To map posterior probabilities on UFboot i followed command you mentioned (iqtree -t <iqtree_output>.splits.nex -sup <mrbayes_tree>) . Unfortunately, I encountered below error. ERROR: Tree file does not start with an opening-bracket '(' (line 1 column 1) FYI : I used consensus tree given by MrBayes as an input to above. Thanks, Chirag. ", "I forgot to mention that the -sup option only accepts newick tree file. Whereas MrBayes consensus tree is in nexus format. That\u2019s why the error message. Please just edit mrbayes file and copy the tree in the nexus trees block to a separate file, before running this command. Minh ", "Thanks, It worked. Can i do reverse ? For example, assigning MrBayes posterior probabilities on ML tree given by IQ-TREE. I tried iqtree -sup <iqtree.treefile> <Mrbayes.newick>. It worked. However, it assigned number of times each branch in the iqtree.treefile occurred in the set of trees and not the posterior probabilities Cheers Chirag. Minh Hi Chirag, To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi, I also want to highlight one more thing here is, Strangely, mapping UFboot on MrBayes tree gives all UFboot values 0. ~Chirag. ", "Yes, you can do this in IQ-TREE. And you also need to use the burn-in option to discard starting trees of MrBayes. From mrbayes output there are files (in nexus format) called *.run1.t or *.run2.t etc., which contain trees from run 1, 2,\u2026 You can summarise the posterior probabilities onto iqtree tree (or any other tree) with: iqtree -t <mrbayes.run1.t> -sup <iqtree.treefile> -bi 500 -scale 1 to discard 500 trees as burn-in and normalise to support values from 0 to 1 (otherwise the default is 0 to 100, i.e. percentage). Perhaps I should mention this somewhere in the documenation. Hope that helps, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e8157769-226f-41bd-9bc0-6b7b3ad5f80f%40googlegroups.com ", "Hi, I encountered Error below while using the command you mentioned : iqtree -t <mrbayes.run1.t> -sup <iqtree.treefile> -bi 500 -scale 1 ERROR: Expecting ')', but found '0' instead (line 1 column 6) Thanks Chirag. On 6 Jan 2020, at 12:45 PM, Minh Bui < minh...@univie.ac.at > wrote: iqtree -t <mrbayes.run1.t> -sup ", "Again it was format issue. I changes MrBayes nexus to newick and it worked. Cheers, Chirag. "]}, "OcCeprsF3AY": {"topic": "Can you rebuild a tree from where it stopped? The construction of my tree was stopped because of a problem in my machine.", "initializeDate": "Oct 14, 2017, 11:58:23 PM", "timeStamp": "Oct 15, 2017, 11:52:31 AM", "content": ["Can you rebuild a tree from where it stopped? The construction of my tree was stopped because of a problem in my machine. I can not find in the manuals if there are commands for this regards and hugs from M\u00e9xico ", "I found this I put it here in case someone else serves 6.2 Checkpointing to resume stopped run Starting with version 1.4.0 IQ-TREE supports checkpointing: If an IQ-TREE run was interrupted for some reason, rerunning it with the same command line and input data will automatically resume the analysis from the last stopped point. The previous log file will then be appended. If a run successfully finished, IQ-TREE will deny to rerun and issue an error message. A few options that control checkpointing behavior: Option Usage and meaning -redo Redo the entire analysis no matter if it was stopped or successful. WARNING: This option will overwrite all existing output files. -cptime Specify the minimum checkpoint time interval in seconds (default: 20s) NOTE: IQ-TREE writes a checkpoint file with name suffix .ckp.gz in gzip format. Do not modify this file. If you delete this file, all checkpointing information will be lost! ", "Hi Alfredo, That\u2019s right, good that you found the solution yourself ;-) Moreover, another tip: you can actually copy all the intermediate files (incl. this checkpoint file) to another machine and restart the run there. This is helpful in case your current machine is broken or you want to use a more powerful machine. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "7aOmVn0_coo": {"topic": "BUG: Issue with partitioned analysis", "initializeDate": "Mar 18, 2021, 9:51:22 AM", "timeStamp": "Mar 25, 2021, 7:10:09 AM", "content": ["Hi, I have an issue when trying to run partition analysis and I found no related posts in the group. After the composition test (which works fine), iqtree crashes reporting the next lines: ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 5 () ERROR: 6 () ERROR: 7 () ERROR: 8 () ERROR: 9 __libc_malloc() ERROR: 10 operator new(unsigned long) ERROR: 11 Pattern::Pattern(Pattern const&) ERROR: 12 void std::vector<Pattern, std::allocator<Pattern> >::_M_realloc_insert<Pattern const&>(__gnu_cxx::__normal_iterator<Pattern*, std::vector<Pattern, std::allocator<Pattern> > >, Pattern const&) ERROR: 13 SuperAlignment::orderPatternByNumChars(int) ERROR: 14 IQTree::computeInitialTree(LikelihoodKernel) ERROR: 15 computeFastMLTree(Params&, Alignment*, ModelCheckpoint&, ModelsBlock*, int&, int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) ERROR: 16 runModelFinder(Params&, IQTree&, ModelCheckpoint&) ERROR: 17 startTreeReconstruction(Params&, IQTree*&, ModelCheckpoint&) ERROR: 18 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 19 main() ERROR: 20 __libc_start_main() ERROR: 21 () ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: tree1.log ERROR: *** Alignment files (if possible) I am trying to make a phylogenetic tree out of 758 protein alignment files for 1,750 species in a Ubuntu 20.04, 5.4.0-66-generic machine, with IQ-TREE multicore version 2.0.3 for Linux 64-bit built Dec 20 2020. The random seed number is 778831 (Using SPRNG - Scalable Parallel Random Number Generator). The command line I used is: \"iqtree -p mafft_alignments/ -m MFP -B 1000 -alrt 1000 -pre tree1\", with mafft_alignments/ being the directory with the individual alignment files (fasta format). Huge thanks in advance, I\u00f1igo ", "Hi there, This message about malloc() means that IQ-TREE could not allocate the memory, meaning that your computer does not have enough RAM to run this large dataset. Suggest switching to a server with more RAM. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/23aacbe5-e810-4eaa-87aa-2c9e0e97ffdcn%40googlegroups.com "]}, "Yoe3rZt7Cc4": {"topic": "Computing bootstrap consensus tree- IQ-TREE CRASHES WITH SIGNAL ABORTED", "initializeDate": "Apr 2, 2017, 8:45:40 AM", "timeStamp": "Aug 14, 2017, 3:31:32 AM", "content": ["Dear developer, I used version 1.5.3 and found a crash while computing bootstrap. I used the command: ./iqtree-omp -s unique.Fasta -m TESTNEW -bb 1000 -nt 8 Please help me to solve the problem Best regards, Giap Nguyen ", "Dear Giap, thanks for the report. Can you please send me all the output files written by IQ-TREE via personal email? (not just the alignment). That should allow to reproduce this problem more quickly. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <unique.Fasta.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi there, I seem to be having the same problems as this user and am hoping you can please help me figure out how to resolve it. I am trying to run IQ-TREE on a rather large alignment of ~2800 taxa after filtering for recombination (please note that I'd had no issues doing model selection and generating a ML tree with IQ-TREE on the same dataset before masking out recombination sites). The command I used was: iqtree -s recomb_snps_only.fasta -pre recomb_snps_only -nt 19 -bb 1000 -m TEST It seems the model selection, iterations and bootstrap itself all worked, but when attempting to compute the bootstrap consensus tree, it crashes. Total number of iterations: 700 CPU time used for tree search: 298245.981 sec (82h:50m:45s) Wall-clock time used for tree search: 20632.291 sec (5h:43m:52s) Total CPU time used: 303062.276 sec (84h:11m:2s) Total wall-clock time used: 20898.741 sec (5h:48m:18s) Computing bootstrap consensus tree... Reading input file recomb_snps_only.splits.nex... 1032 taxa and 27252 splits. Consensus tree written to recomb_snps_only.contree Reading input trees file recomb_snps_only.contree new_tree_lh: -44695.903 tree_lh: -30769.025 iqtree: /tmp/iqtree-20170325-39540-ttmy06/IQ-TREE-1.5.3/phylotree.cpp:2516: virtual double PhyloTree::optimizeAllBranches(int, double, int): Assertion `fabs(new_tree_lh-tree_lh) < 1.0' failed. STACK TRACE FOR DEBUGGING: 1 funcAbort() 2 () 3 gsignal() 4 abort() 5 __assert_fail() 6 __assert_perror_fail() 7 PhyloTree::optimizeAllBranches(int, double, int) 8 runPhyloAnalysis(Params&, Checkpoint*) 9 main() 10 __libc_start_main() *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: recomb_snps_only.log *** Alignment files (if possible) I hope you'll be able to assist and t hank you very much in advance. Best, Robyn ", "Dear Minh, I have very same trouble using iqtree1.5.5 - but there was no .log file generated. Is there any way how to overcome the bug or should send you all the detail (alignments, command and all generated files)? Thank you very much for reply Cheers Krist\u00fdna Dne pond\u011bl\u00ed 3. dubna 2017 21:04:45 UTC+2 Bui Quang Minh napsal(a): ", "Dear Krist\u00fdna, I believe this bug was fixed in 1.5.5. What you wrote (no .log file generated) sounds like a different problem. Which platform (Windows, Linux or Mac) are you running? Also can you please paste the command line here. Cheers, Minh ", "Good morning! I still encounter problem of \"CRASHES WITH SIGNAL ABORTED\" with 1.5.5 (Windows). I would like to paste a piece of log file here: Computing bootstrap consensus tree... Reading input file 05-vp1-vp3-nu-al.fasta.splits.nex... 178 taxa and 4242 splits. Consensus tree written to 05-vp1-vp3-nu-al.fasta.contree Reading input trees file 05-vp1-vp3-nu-al.fasta.contree new_tree_lh: -4389.352 tree_lh: -4352.720 Assertion failed! Program: D:\\Immunosuppressive\\CIAV\\Sequencing\\VP1-VP3\\iqtree-omp.exe File: \\Users\\minh\\Dropbox\\iqtree-git\\phylotree.cpp, Line 2515 Expression: fabs(new_tree_lh-tree_lh) < 1.0 Would you please help? Thank you so much! Best regards, Giap Nguyen ", "Dear Giap, can you please try 1.6.beta4? Let me know how it works. Thanks, Minh "]}, "ZK9qPCr55qc": {"topic": "resume partition finding on cluster", "initializeDate": "Jun 23, 2016, 10:29:21 AM", "timeStamp": "Jun 23, 2016, 5:11:30 PM", "content": ["I am running partitionfinding with IQtree on a cluster (-m TESTNEWMERGEONLY -rcluster 10 -msub nuclear -merit BIC). I am using nexus files as input for alignment and partitions. In the alignment my taxa are named as \"Genus_species\". When starting, iqtree claims that taxa are named as \"Genus species\" and renames them to \"Genus_species\". The analyses runs well, but when I want to resume the analyses (e.g., because I exhausted the given time on the cluster) IQtree reports an ERROR \"Tree taxa and alignment sequence do not match\" - as the program seem to not find \"Genus_species\" in the tree. What can I do to resume these analyses? Cheers, Christoph ", "Hi Christoph, > On Jun 23, 2016, at 4:29 PM, christoph...@gmail.com wrote: > I am running partitionfinding with IQtree on a cluster (-m TESTNEWMERGEONLY -rcluster 10 -msub nuclear -merit BIC). I am using nexus files as input for alignment and partitions. In the alignment my taxa are named as \"Genus_species\". When starting, iqtree claims that taxa are named as \"Genus species\" and renames them to \"Genus_species\u201d. right, this is due to the Nexus class library by Lewis, that we use to parse the nexus file. This serves as information only and you can safely ignore it. > The analyses runs well, but when I want to resume the analyses (e.g., because I exhausted the given time on the cluster) IQtree reports an ERROR \"Tree taxa and alignment sequence do not match\" - as the program seem to not find \"Genus_species\" in the tree. What can I do to resume these analyses? it sounds like some checkpointing bug in IQ-TREE. However I could not guess what the problem can be. Can you turn the alignment from nexus to phylip or fasta file, and try to resume the run again? Minh > Cheers, > Christoph > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "jx_OJl4F480": {"topic": "Long branches in case of large proportions of missing data", "initializeDate": "Feb 14, 2016, 6:30:33 PM", "timeStamp": "Feb 18, 2016, 9:18:59 AM", "content": ["I have a data set with multiple partitions. Not all genes are available for all taxa. I am conducting an analysis with with one set of branch lengths. (linked branch lengths.) I am aware of the fact that large amounts of missing data can cause multiple problems in phylogenetic analyses, from biases to numerical issues. I saw a paper of your group that dealt with numerical issues in case of missing data. iqtree provides the mldist file. For this data set, a large proportion of the distances are above 1. A significant number of entries is 9.0000 which seems to be the maximum which is reported. I did compute pairwise patristic (uncorrected) distances for my data set with another tool. Restricted to pair wise sites that do not have gaps or missing data, these distances are not too large. Only two pair-wise distances are above 33%. Most distances are in the visinity of 20-25%, even for pair which get mldist values of 9. I think that the problem is caused by the missing data. My hope was that iqtree could handle larger amounts of missing data, for the following two reasons: - the manual explains in detail how gaps and missing data are treated. - iqtree can combine partitions even if the taxon sets of the partitions are different. So this problem must indeed be handled somehow internally. I am aware of potential biases in the presence of missing data. Apart from this, are there any known minimum amounts of data, maximum amounts of missing data, for a reasonable estimation of the branch lengths? I you are interested in this problem, I could send you the data set. With kind regards Christoph ", "Dear Christoph, > On Feb 15, 2016, at 12:30 AM, c.maye...@uni-bonn.de wrote: > I have a data set with multiple partitions. Not all genes are available for all taxa. I am conducting an analysis with with one set of branch lengths. (linked branch lengths.) > I am aware of the fact that large amounts of missing data can cause multiple problems in phylogenetic analyses, from biases to numerical issues. I saw a paper of your group that dealt with numerical issues in case of missing data. did you mean this paper http://online.liebertpub.com/doi/10.1089/cmb.2015.0146 > iqtree provides the mldist file. For this data set, a large proportion of the distances are above 1. A significant number of entries is 9.0000 which seems to > be the maximum which is reported. yes 9 is the upper-bound for the ML pairwise distances. If it reaches this limit, then it may signal that the distances are saturated. However, since your data set is very sparse: do the two corresponding sequences overlap? (i.e. there is at least one non-gap character at the same site in both sequences). If not, then the distances are unidentifiable. > I did compute pairwise patristic (uncorrected) distances for my data set with > another tool. Restricted to pair wise sites that do not have gaps or missing data, these distances are not too large. Only two pair-wise distances are above 33%. Most distances are in the visinity of 20-25%, even for pair which get mldist values of 9. I see. For the simplest Jukes-Cantor model, the ML distances are undefined (or infinity) if the uncorrected distances are >= 75%. For more complex models I don\u2019t know the threshold, but 25% sounds okey. Can you send me this data set? > I think that the problem is caused by the missing data. > My hope was that iqtree could handle larger amounts of missing data, for the following two reasons: > - the manual explains in detail how gaps and missing data are treated. > - iqtree can combine partitions even if the taxon sets of the partitions are different. So this problem must indeed be handled somehow internally. yes that\u2019s correct. > I am aware of potential biases in the presence of missing data. Apart from this, are there any known minimum amounts of data, maximum amounts of missing data, for a reasonable estimation of the branch lengths? To my best knowledge I am not aware of any such studies. But other people here may comment on this. You may also ask this question in more general forum like http://phylobabble.org > I you are interested in this problem, I could send you the data set. yes I am ;-) Minh > With kind regards > Christoph > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Christoph, after looking at your data set, it turned out (as suspected) that many pairs of sequences do not overlap at all. Thus, some distances are indeed undefined and IQ-TREE simply printed the upper bound (9) for the corresponding entry in .mldist file. Please note that this non-overlapping problem is an issue for distance-based method like neighbor joining, but may not be problematic for likelihood methods. For example, if two sequences A and B do not overlap, but A overlaps with C and C overlaps with B, then actually it helps to reconstruct the tree because ML simultaneously takes all sequences into account. Of course very sparse matrix might still be troublesome, but to a much lesser extent compared with distance methods. Hope that helps Minh "]}, "t3SWk4U_E5o": {"topic": "Question about an error message with a tree topology test, -au command and bp-RELL", "initializeDate": "May 6, 2020, 11:47:22 AM", "timeStamp": "May 27, 2020, 9:59:49 AM", "content": ["Hi everyone, I am using IQ-Tree v1.6.7 on a GNU environment and I've had some trouble doing a topology test. I would like to perform the weighted KH, SH and the approximately unbiased (AU) tests to my data. Here below is the command-line I used, and the following error message: command-line: iqtree -s [alignment.aln] -z [trees.set] -n 0 -zb 1000 -zw -au error message: The AU test is temporarily disabled due to numerical issue when bp-RELL=0 What does this error message mean, and how can I fix this issue? Kind regards Gabriel ", "Hi Gabriel, Quite simple answer: use the latest version, either v1.6.12 or v2.0.4 (if you want more features in v2.0.4, whereas v1.6 is more stable). Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6011a7f7-2750-48b2-9136-23679b8c717e%40googlegroups.com ", "Hi Minh, Thank you very much for your answer. Cheers Gabriel Le jeudi 7 mai 2020 02:36:09 UTC+2, Minh Bui a \u00e9crit : Hi Gabriel, Quite simple answer: use the latest version, either v1.6.12 or v2.0.4 (if you want more features in v2.0.4, whereas v1.6 is more stable). Cheers Minh On 7 May 2020, at 1:47 am, Gabriel DUPRE < gabriel...@gmail.com > wrote: Hi everyone, I am using IQ-Tree v1.6.7 on a GNU environment and I've had some trouble doing a topology test. I would like to perform the weighted KH, SH and the approximately unbiased (AU) tests to my data. Here below is the command-line I used, and the following error message: command-line: iqtree -s [alignment.aln] -z [trees.set] -n 0 -zb 1000 -zw -au error message: The AU test is temporarily disabled due to numerical issue when bp-RELL=0 What does this error message mean, and how can I fix this issue? Kind regards Gabriel You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "iypR83Zo5pw": {"topic": "Crash on model test IQTREE 1.5.4 with the option -nt AUTO", "initializeDate": "Apr 3, 2017, 9:18:01 AM", "timeStamp": "Apr 3, 2017, 11:19:16 AM", "content": ["Dear Minh, When I want to use iqtree-omp (version 1.5.4) for a model test with the option -nt AUTO, iqtree crash after the first test of the theard. cmd : iqtree-omp -s FirmicutesSmall.aa.grp.aln -nt AUTO -m TESTNEWONLY -st AA -safe -pre FirmicutesSmall.aa.grp and the output with the crash : ``` Measuring multi-threading efficiency up to 24 CPU cores 2 trees examined Threads: 1 / Time: 48.702 sec / Speedup: 1.000 / Efficiency: 100% / LogL: -31623632 STACK TRACE FOR DEBUGGING: 2 _sigtramp() 4 void PhyloTree::computeTraversalInfo<Vec4d, 20>(PhyloNode*, PhyloNode*, bool) 5 double PhyloTree::computeLikelihoodBranchSIMD<Vec4d, true, 20, false, false>(PhyloNeighbor*, PhyloNode*) 6 PhyloTree::optimizeAllBranches(int, double, int) 7 PhyloTree::testNumThreads() 8 testModel(Params&, PhyloTree*, std::__1::vector<ModelInfo, std::__1::allocator<ModelInfo> >&, std::__1::basic_ostream<char, std::__1::char_traits<char> >&, ModelsBlock*, int, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, bool, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >) 9 initializeParams(Params&, IQTree&, std::__1::vector<ModelInfo, std::__1::allocator<ModelInfo> >&, ModelsBlock*) 10 runTreeReconstruction(Params&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >&, IQTree&, std::__1::vector<ModelInfo, std::__1::allocator<ModelInfo> >&) 11 runPhyloAnalysis(Params&, Checkpoint*) *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT *** For bug report please send to developers: *** Log file: FirmicutesSmall.aa.grp.log *** Alignment files (if possible) Segmentation fault: 11 ``` But when I lauch the same command with IQtree 1.5.3 it doen't append and the analysis continue. Is it normal on 1.5.4 ? Thank you for your help R\u00e9mi PS : I couldn't send you the alignement because it too big (27.3 Mo). ", "Dear Remi, due to a recent change regarding the handling of identical sequences, the checkpoint files produced by 1.5.3 and 1.5.4 are not compatible, as I saw from the log file: NOTE: ANSP003.B.00001 is identical to ANSP002.B.00001 but kept for subsequent analysis NOTE: BAVE001.B.00003 is identical to BAAM001.B.00006 but kept for subsequent analysis NOTE: BASU001.B.00026 is identical to BASP002.B.00001 but kept for subsequent analysis CHECKPOINT: Initial tree restored Thus, can you please add \u201c-redo\u201d option to ignore the checkpoint file ? I think that would resolve the problem. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <FirmicutesSmall.aa.grp.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Thank you for your explanation. Cheers, Remi "]}, "2J6gQiJ7wlc": {"topic": "IQ Tree web server.  Very nice.", "initializeDate": "Dec 24, 2014, 12:38:49 PM", "timeStamp": "Jan 2, 2015, 7:15:26 AM", "content": ["Hi! Thanks for creating this tool, and thanks also for making a web server version so we can test drive it a bit before installing our own. On the web server, a useful modification would be to allow the user to enter a \"job name\" so we can more easily see the identities of jobs we have run. I really like that the output includes run log information such as the substitution rate matrix. People who are interested enough in phylogenetics to not only find and use IQtree but also join this group and read messages, should also consider joining the PHYLOBABBLE evolution/phylogenetics discussion site: http://phylobabble.org/ it is a small community, but composed of people who really know phylogenetics. If I wanted to create a web server running IQtree within the HIV Databases site where I work, similar to our PHYML web server , who would be best to write to about that? For example to make sure you approve of the way we cite your work, and perhaps get help with the process of setting it up. Anyway, thanks for making this software, my test runs have all produced good results in very reasonable times. Brian Foley, PhD HIV Databases b...@lanl.gov http://www.hiv.lanl.gov ", "Dear Brian Foley, On 24 Dec 2014, at 18:38, Brian Foley < brianf...@gmail.com > wrote: Hi! Thanks for creating this tool, and thanks also for making a web server version so we can test drive it a bit before installing our own. thanks for your interest! On the web server, a useful modification would be to allow the user to enter a \"job name\" so we can more easily see the identities of jobs we have run. I added that into the TODO list... I really like that the output includes run log information such as the substitution rate matrix. People who are interested enough in phylogenetics to not only find and use IQtree but also join this group and read messages, should also consider joining the PHYLOBABBLE evolution/phylogenetics discussion site: http://phylobabble.org/ it is a small community, but composed of people who really know phylogenetics. I was not aware of this forum, looks interesting\u2026 If I wanted to create a web server running IQtree within the HIV Databases site where I work, similar to our PHYML web server , who would be best to write to about that? For example to make sure you approve of the way we cite your work, and perhaps get help with the process of setting it up. You are very welcome to create another web server for running IQ-TREE there. It is actually very good to have IQ-TREE as one service among other tools provided at such a central web site. Thus I volunteer to provide help ... Please send me directly the details via my email so we can discuss further. Anyway, thanks for making this software, my test runs have all produced good results in very reasonable times. good to know ;-) Best, Minh Brian Foley, PhD HIV Databases b...@lanl.gov http://www.hiv.lanl.gov You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at "]}, "cHpQZ--boYI": {"topic": "Is there a way to include a list of sites that fall into each gamma rate category?", "initializeDate": "Jul 12, 2016, 9:25:00 PM", "timeStamp": "Jul 14, 2016, 7:28:25 PM", "content": ["Hi all, As per the title, I am looking to include a list of sites that fall into each gamma category in the IQ-TREE output. Looking at the manual I couldn't figure out if any of the options allow me to do this. Any suggestions? Thanks in advance, Tim ", "Dear Tim, there is indeed an option -wsr (write site rate), that writes a .rate file, which looks like this: Site Rate Category Categorized_rate 1 0.53955 2 0.45293 2 0.46690 2 0.45293 3 0.52875 2 0.45293 4 0.93489 3 0.98634 5 0.70399 2 0.45293 For each site, it prints the posterior-mean rate (2nd column), the category with highest probability that this site belongs to (3rd column) and the rate for that highest category (4th column). Is this what you look after? And you are right, we did not document this option. Will add it into the manual. Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Yep! Thanks heaps for that :) ", "Hi Bui, Just further to your answer, the .iqtree file for my alignment (human mtDNA) I got produced this table: Category Relative_rate Proportion 0 0 0.7925 1 0.638 0.05188 2 2.264 0.05188 3 4.8 0.05188 4 11.57 0.05188 However, the .rates file prints a table that looks like this: Site Rate Category Categorized_rate 0.15333 0.63795 0.15333 0.63795 ... 14626 4.93571 11.57443 14627 4.31347 11.57443 14628 5.73512 11.57443 14629 0.21510 0.63795 14630 0.21446 0.63795 14631 7.70372 0.00000 My guess is that in this case, category 0 in the .iqtree file = category 5 in the .rate file? However, where my confusion is that site 14631 is allocated to category 5 with a categories rate of 0.00, but its actual rate is 7.70. I am a bit confused in how to interpret this. Apologies if this is a silly question and I've just missed something On Wednesday, 13 July 2016 16:27:29 UTC+10, Bui Quang Minh wrote: ", "Hi Tim, did you use I+G model? I confirm that there is inconsistency in this .rate file for this model. I will fix this in the next release, but for the moment: 1. The rates (2nd column) are correct. 2. The 3rd column is incorrect. The correct category is obtained by subtracting the 3rd column by 1. 3. The 4th column is incorrect. Please take the rate for the corrected category. Sorry for this inconvenience. Please note that this is a problem with I+G, but not the pure +G model. Minh ", "Yep I was using an I+G model Thanks for that! :) "]}, "iCYyO0mFZF0": {"topic": "Question for iqtree -cmax", "initializeDate": "Dec 2, 2020, 1:37:16 AM", "timeStamp": "Dec 2, 2020, 8:16:42 AM", "content": ["I have questions about the meaning of -cmax. Is this parameter useful for long sequences? When do I need to change -cmax? How long sequence considered a long sequence ? ", "Hi there, The number of rate categories depends both on the number of sequences and the sequence length. But it has more to do with many sequences, less on long sequences. Because this is about rate heterogeneity across sites \u2014 you may observe more rate variations for alignments with more sequences. In any case, there is a default of -cmax 10 simply due to computational reason. You can of course increase this limit and observe how and whether IQ-TREE finds more categories to fit better or not. The AIC/BIC criterion will tell you. Cheers Minh On 2 Dec 2020, at 5:37 pm, juren xiao < 4798...@qq.com > wrote: I have questions about the meaning of -cmax. Is this parameter useful for long sequences? When do I need to change -cmax? How long sequence considered a long sequence ? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/296c6956-cc5e-4909-b80c-d4a0e4abf8dfn%40googlegroups.com "]}, "v1aFLiGPLZg": {"topic": "ERROR: Tree has different number of taxa!", "initializeDate": "Apr 26, 2019, 3:31:30 PM", "timeStamp": "Jun 3, 2019, 8:01:43 AM", "content": ["Hi, I'm running into the error in the subject line when trying to run non-parametric bootstraps. The command I am running is listed below and the dataset consists of 8 partitions (7 DNA and 1 morphological). I am using IQ-TREE 1.6.10. iqtree -spp platy_all_morphmolecular_partitions.nex -b 100 -alrt 1000 -lbp 1000 -abayes -bspec GENESITE -nt 8 Please let me know where to send relevant log files. Thank you, Zach ", "Hi Zach, Please send the log file to my personal email. Did it happen at the very end of the run? Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Zach, This is because the GENESITE resampling caused three bootstrap trees to have fewer taxa: minh@Minhs-MacBook-Pro ~/projects/bugs/laheyzj/iqtree_failed_run $ for i in {1..100}; do echo -n $i; head -n$i platy_all_morphmolecular_partitions.nex.boottrees |tail -n1 | grep '(' -o |wc -l; done 1 165 2 165 3 165 4 165 5 165 6 165 7 165 8 165 9 165 10 165 11 165 12 165 13 165 14 161 15 165 16 165 17 165 18 165 19 165 20 165 21 165 22 165 23 165 24 165 25 165 26 165 27 165 28 165 29 165 30 165 31 165 32 165 33 165 34 165 35 165 36 165 37 165 38 165 39 165 40 165 41 165 42 165 43 165 44 165 45 165 46 165 47 165 48 165 49 165 50 165 51 165 52 165 53 165 54 165 55 165 56 165 57 165 58 165 59 165 60 165 61 165 62 165 63 165 64 165 65 165 66 165 67 165 68 165 69 165 70 165 71 165 72 165 73 165 74 165 75 150 76 165 77 165 78 165 79 165 80 165 81 165 82 165 83 165 84 165 85 165 86 165 87 165 88 165 89 165 90 165 91 165 92 165 93 165 94 165 95 165 96 165 97 161 98 165 99 165 100 165 As you can see above, trees 14, 75 and 97 has fewer brackets than other trees. Therefore, a consensus tree can\u2019t be constructed and IQ-TREE reported this error message at the end of the run when computing consensus tree. Unfortunately this problem can\u2019t be resolved. You have to manually removed these trees and then build a consensus tree with -con option. See for example http://www.iqtree.org/doc/Frequently-Asked-Questions#how-do-i-save-time-for-standard-bootstrap for how to use that option. Cheers, Minh "]}, "y8Vst_KN7is": {"topic": "AU test query", "initializeDate": "Jun 29, 2019, 9:15:40 PM", "timeStamp": "Jun 30, 2019, 9:59:04 PM", "content": ["Dear all, I have two different topologies generated from 28S (tree-28S) and mitogenome (tree-MT), respectively, and I tried to conduct AU test on them using both datasets. The results (as shown below) showed that the tree-MT was rejected in the AU test using 28S dataset (28S AU test), whereas the tree-28S was rejected in the AU test using MT dataset (MT AU test). Therefore, I wanna to know how AU test compare the topologies? Does it first selects a tree with highest logL, and then compares each of the user trees to this tree? If take the my results (below) as example, I am comparing tree-MT to tree-28S in 28S AU test, and comparing tree-28S to tree-MT in MT AU test. If I am wrong, what is tree-28S comparing to in 28S AU test? and what is tree-MT comparing to in MT AU test? AU test based on 28S dataset (iqtree -s 28S.phy -m GTR+G -z trees.treels -n 0 -zb 10000 -au). Tree logL deltaL bp-RELL p-KH p-SH c-ELW p-AU ------------------------------------------------------------------------- MT -22822.25152 30.811 0.0005 - 0.001 - 0.001 - 0.000702 - 0.000633 - 28S -22791.44054 0 1 + 0.999 + 1 + 0.999 + 0.999 + AU test based on mitochondrial genome dataset (iqtree -s mitogenome.phy -m mtZOA+F+I+G4 -z trees.treels -n 0 -zb 10000 -au). Tree logL deltaL bp-RELL p-KH p-SH c-ELW p-AU ------------------------------------------------------------------------- MT -54731.89675 0 1 + 1 + 1 + 1 + 1 + 28S -59255.35408 4523.5 0 - 0 - 0 - 0 - 4.61e-05 - Thank you for your help! ", "Hi there, Heiko can better answer your question. I suggest that you have a look at his book chapter on Tree Topology Tests in \"The Phylogenetic Handbook: A practical approach to phylogenetic analysis and hypothesis testing\u201d: https://doi.org/10.1017/CBO9780511819049 This provides a much better explanation than the original Shimodaira\u2019s paper. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9bb9fe81-af41-4004-af7f-305e83f6b085%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Thank you for your help. I am going to look into that book chapter. Sincerely, Dong Zhang \u5728 2019\u5e747\u67081\u65e5\u661f\u671f\u4e00 UTC+8\u4e0a\u53483:47:11\uff0cMinh Bui\u5199\u9053\uff1a Hi there, Heiko can better answer your question. I suggest that you have a look at his book chapter on Tree Topology Tests in \"The Phylogenetic Handbook: A practical approach to phylogenetic analysis and hypothesis testing\u201d: https://doi.org/10.1017/CBO9780511819049 This provides a much better explanation than the original Shimodaira\u2019s paper. Cheers, Minh On 30 Jun 2019, at 11:15 am, \u5f20\u4e1c < dongzh...@gmail.com > wrote: Dear all, I have two different topologies generated from 28S (tree-28S) and mitogenome (tree-MT), respectively, and I tried to conduct AU test on them using both datasets. The results (as shown below) showed that the tree-MT was rejected in the AU test using 28S dataset (28S AU test), whereas the tree-28S was rejected in the AU test using MT dataset (MT AU test). Therefore, I wanna to know how AU test compare the topologies? Does it first selects a tree with highest logL, and then compares each of the user trees to this tree? If take the my results (below) as example, I am comparing tree-MT to tree-28S in 28S AU test, and comparing tree-28S to tree-MT in MT AU test. If I am wrong, what is tree-28S comparing to in 28S AU test? and what is tree-MT comparing to in MT AU test? AU test based on 28S dataset (iqtree -s 28S.phy -m GTR+G -z trees.treels -n 0 -zb 10000 -au). Tree logL deltaL bp-RELL p-KH p-SH c-ELW p-AU ------------------------------------------------------------------------- MT -22822.25152 30.811 0.0005 - 0.001 - 0.001 - 0.000702 - 0.000633 - 28S -22791.44054 0 1 + 0.999 + 1 + 0.999 + 0.999 + AU test based on mitochondrial genome dataset (iqtree -s mitogenome.phy -m mtZOA+F+I+G4 -z trees.treels -n 0 -zb 10000 -au). Tree logL deltaL bp-RELL p-KH p-SH c-ELW p-AU ------------------------------------------------------------------------- MT -54731.89675 0 1 + 1 + 1 + 1 + 1 + 28S -59255.35408 4523.5 0 - 0 - 0 - 0 - 4.61e-05 - Thank you for your help! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "y0dQV6jXtVM": {"topic": "Setting parameters for codon models", "initializeDate": "Jul 18, 2018, 8:09:15 AM", "timeStamp": "Aug 5, 2018, 8:32:07 PM", "content": ["Hi, (Note: I will resend this at the end of July, so feel free to ignore this while you are travelling. However, I wanted to send it while it was fresh in my mind.) I'm trying to run codon models in IQ-TREE with specific parameters, but either it doesn't work or I'm not doing it correctly. 1. \"-m MGK+F1X4\" works. 2. \"-m MGK+F1X4{0.1,0.2,0.4,0.3}\" leads to the error message: \"Unknown state frequency type +F1X4{0.1,0.2,0.4,0.3}\" 3. \"-m MGK{2.0,2.0}+F1X4{0.1,0.2,0.4,0.3}\" leads to the error message: \"Unexpected end of string 2.0,2.0\" I would expect that MGK takes two parameters: kappa and omega=dN/dS. However, even if I write 10 parameters (e.g. something like MGK{2,2,2,2,2,2,2,2,2,2,2,2}) I still get a message about \"Unexpected end of string\". Thanks for your help! -BenRI ", "Hi BenRl, Unlike DNA and protein models, specifying codon model parameters are not supported in IQ-TREE. The document ( http://www.iqtree.org/doc/Substitution-Models#codon-models ) does not state anything about this. So unfortunately this simply does not work. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "WWUxt_qgKW0": {"topic": "missing data / ambiguous data - and Four cluster likelihood mapping in IQtree", "initializeDate": "Jan 11, 2016, 6:20:36 PM", "timeStamp": "Jan 11, 2016, 7:52:27 PM", "content": ["Dear developers, 1) missing data As far as I know indels (-) and X (ambiguous) characters (X in amino acid and N in nt alignmentsd) are treated as missing. Anyway, we wonder for aa datasets how this is solved with the models: for example, with the BLOSSUM Matrix X is not similar to missing, because missing is not defined in BLOSUM und X is not treated as it would be missing data. (Moreover: how is this treated in nt datasets?) This is important to know because it will probably impact previous steps we do, in which we treat X and indels differently ++++ 2) PS if you can send a note when the four cluster likelihood mapping is finished & implemented, I will immediately test it :) (with 4 groups for which each quartet drawn 1 sequence from each group) Best, Karen ", "Hi Karen, for your 1. question: does this http://www.cibiv.at/software/iqtree/doc/Frequently-Asked-Questions/#how-does-iq-tree-treat-gapmissingambiguous-characters answer your question? Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Karen, > 1) missing data > As far as I know indels (-) and X (ambiguous) characters (X in amino acid and N in nt alignmentsd) are treated as missing. > Anyway, we wonder for aa datasets how this is solved with the models: for example, with the BLOSSUM Matrix X > is not similar to missing, because missing is not defined in BLOSUM und X is not treated as it would be missing > data. (Moreover: how is this treated in nt datasets?) In all softwares I know it is the other way around. Not \u2018X\u2019/\u2019N' are treated as \u2018-\u2018, but Gaps are treated as Wildcard character (\u2018X\u2019 or \u2019N\u2019, respectively). This happens exactly due to the reason you described. There are no good models to model gaps, and they are just not defined in substitution matrices. On the other hand, \u2018X\u2019 and \u2019N\u2019 do not carry information which could be used by ML programs leading to certain groupings. This information has to come from other sites in the alignment. However, the non-wildcard characters can substantially contribute to the resolution of subtrees for which they provide information. (I have done checks in analyses in the past which showed this.) A word of warning: BLOSUM matrices do not reflect evolutionary changes adequately but are tuned for database searches to find distantly related sequences. I would not use them for tree reconstruction, even if they are implemented in a number of programs for historical reasons. > This is important to know because it will probably impact previous steps we do, in which we treat X and indels differently > ++++ > 2) PS if you can send a note when the four cluster likelihood mapping is finished & implemented, I will immediately test it :) > (with 4 groups for which each quartet drawn 1 sequence from each group) I will ;) Cheers, Heiko ", "Hi Minh, yes is does, thanks! - But than its not really treated as \"missing\" correct? (sometimes how the things are expressed in anulas (likeRAxML are somewhat confusing)... So thanks Minh, reffering to this FAQ :) Moreover: indels treating as 5th state (so differently than the other listed characters) is not implemented, is it? cheers k ", "Hi Heiko, Am Dienstag, 12. Januar 2016 10:35:57 UTC+11 schrieb Heiko: Hi Karen, > 1) missing data > As far as I know indels (-) and X (ambiguous) characters (X in amino acid and N in nt alignmentsd) are treated as missing. > Anyway, we wonder for aa datasets how this is solved with the models: for example, with the BLOSSUM Matrix X > is not similar to missing, because missing is not defined in BLOSUM und X is not treated as it would be missing > data. (Moreover: how is this treated in nt datasets?) In all softwares I know it is the other way around. Not \u2018X\u2019/\u2019N' are treated as \u2018-\u2018, but Gaps are treated as Wildcard character (\u2018X\u2019 or \u2019N\u2019, respectively). Yes makes sense :), thanks!! This happens exactly due to the reason you described. There are no good models to model gaps, and they are just not defined in substitution matrices. On the other hand, \u2018X\u2019 and \u2019N\u2019 do not carry information which could be used by ML programs leading to certain groupings. This information has to come from other sites in the alignment. However, the non-wildcard characters can substantially contribute to the resolution of subtrees for which they provide information. (I have done checks in analyses in the past which showed this.) A word of warning: BLOSUM matrices do not reflect evolutionary changes adequately but are tuned for database searches to find distantly related sequences. I would not use them for tree reconstruction, even if they are implemented in a number of programs for historical reasons. yes, thanks - we used this matrix for another funtion (to calculate information content in a partition) - anyway, in very few partitions in some datasets BLOSUM is still selected as best model thhough - but thanks anyway for this hint (it was also just ann expample of a substitution matrix :) > This is important to know because it will probably impact previous steps we do, in which we treat X and indels differently > ++++ > 2) PS if you can send a note when the four cluster likelihood mapping is finished & implemented, I will immediately test it :) > (with 4 groups for which each quartet drawn 1 sequence from each group) I will ;) Cheers, Heiko :D perfect, thanks :))))) cheers k "]}, "l5W770zmKSg": {"topic": "IQTree on Linux won't read my files but fine on PC", "initializeDate": "Sep 21, 2016, 11:17:38 AM", "timeStamp": "Oct 7, 2016, 8:49:11 AM", "content": ["Good morning, For some reason, when I try to run iqtree on my Linux machine it won't read my alignment files. I was able to run the \"example.phy\" once, after that it's unable to read the file if I try to run an analysis for a second time. Same is true if I try to run it on a MAC. However, everything works fine on my PC. I'm using the same alignment files across all platforms. Has anyone else encountered this problem ? Thanks, Frank ", "My first guess would be that you check your LINFEEDS of your alignment: Linux: LF Mac: CR Windows: CRLF at the end of each line (not visible but visible in editors like Notepad++ on windows or Scite on Linux. So lets say you created your alignment on a Windows PC, and you just copy the same file on a linux machine not having changd the line feeds, this might be the problem... Best karen ", "Thanks for the speedy reply ! Unfortunately, it doesn't look like that's the case. ", "Dear Francois, it would be important that you describe how exactly you try to run the program and what the error messages are or what the *.iqtree and *.log file say. The only other difference I know between Windows and Unix systems (like Linux or the system underlying MacOSX) is if one starts the executable file by a double click with the mouse. Under Windows if you double-click the program\u2019s icon it will start with the working directory in the folder the executable is located. Under Mac (and I think under Linux, but cannot check this right now) the working directory is the home directory of the user. Thus, if the alignment file is in the same directory as executable under Window it can find the alignment, but under Unix not. If the alignment file is located in the user\u2019s home, it is the other way around ;) This is no problem, if iq-tree is started from the command line, which should be the preferred way. Ah, I can remember another problem under windows. If the alignment file is created with a Windows editor and saved, e.g., as data.phy it is often actually saved as data.phy.txt, but Windows does not should the extension unless one sets the according option in the Windows setup. Thus, sometimes it is not obvious the the name actually differs from what one sees. Maybe that helps. Best wishes, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Hi Heiko, Thank you kindly for your feedback, it's greatly appreciated ! It looks like it was a combination of jumping from a Windows to a Linux machine as well as using the wrong working directory. All the best, Frank > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com "]}, "THaA7DMUi4I": {"topic": "Segmentation fault with large sample size", "initializeDate": "Jul 2, 2020, 8:53:42 AM", "timeStamp": "Jul 6, 2020, 7:17:04 AM", "content": ["I was able to run IQ-tree on my smaller set of samples (20 and then 5k) but have not been able to get it to work on a larger dataset. This is contents of log file: IQ-TREE multicore version 1.6.12 for Linux 64-bit built Jun 18 2020 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: ***** (AVX512, FMA3, 755 GB RAM) Command: iqtree -nt 64 -s notmixed_oct31.fasta -bb 1000 -seed 0 -m GTR+F+ASC+R9 -pre nomix Seed: 0 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Fri Jun 26 00:51:53 2020 Kernel: AVX+FMA - 64 threads (64 CPU cores detected) Reading alignment file notmixed_oct31.fasta ... Fasta format detected Alignment most likely contains DNA/RNA sequences Alignment has 42313 sequences with 91156 columns, 78544 distinct patterns 91156 parsimony-informative, 0 singleton sites, 0 constant sites **** TOTAL 0.01% 0 sequences failed composition chi2 test (p-value<5%; df=3) ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: nomix.log ERROR: *** Alignment files (if possible) What should I do to solve the problem? I've given it more memory and lots of cores not sure what else I should do? ", "Hi there, Thanks for the report. That really looks like a numerical overflow. From my rough calculation, the size of your alignment is 42313* 91156 = 3857083828 which is larger than the limit of an integer 32-bit (~2 billion). So can you please reduce the number of sequences, such that the size is below 2B? If it sudden works, then I\u2019m more sure that this is the problem. @James: can you have a look at this? Christine, please anyway send me and James the alignment. A quick hint: IQ-TREE can actually read gzip alignment file. So to save space you can compress your alignment as input for IQ-TREE. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9167c34a-3f96-4389-a134-08aa0cb7c6e6o%40googlegroups.com ", "I tried to run with a zipped version of the alignment but it also failed. i'm at a loss of what to do besides removing sequences. Here is a dropbox link to it, it is too big to put in google. https://www.dropbox.com/s/ue0n1y5q3wbxs5n/notmixed_oct31.fasta.gz?dl=0 You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/THaA7DMUi4I/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/F8E5A902-C20E-466B-ADDE-818715C66CA9%40univie.ac.at "]}, "3j4s7xVmrl8": {"topic": "model selection under assumption of ML frequencies", "initializeDate": "Sep 19, 2017, 7:01:55 AM", "timeStamp": "Sep 21, 2017, 8:55:46 PM", "content": ["Dear Iqtree team, Could you please tell me how I can run Modelfinder specifying character state frequencies estimated with maximum likelihood? Can Modelfinder be run with the models assuming empirical frequencies and, at the same time, with the models assuming ML frequencies? I tried a number of options but was not able to obtain either of two above outcomes. Thank you for your help, Vadim ", "Dear Vadim, You can use -mfreq F,FO This option was mentioned in the command reference: http://www.iqtree.org/doc/Command-Reference#automatic-model-selection Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh Thank you for your explanation. The default setting for the nucleotide models and description of options for nucleotide models is absent in the description of the -mfreq option. This is what caused a confusion. Could you explain what appears to be a contradiction in the *iqtree file produced with the -mfreq F,FO option? The file says \"Best-fit model according to BIC: GTR+R4\" Yet the model which settings are shown in the file is GTR+F+R4. I will paste this part from the *iqtree file below. All the best, Vadim ModelFinder ----------- Best-fit model according to BIC: GTR+R4 List of models sorted by BIC scores: Model LogL AIC w-AIC AICc w-AICc BIC w-BIC GTR+R4 -305998.7608 612159.5216 - 0.0004 612160.1477 - 0.0003 612804.8050 + 0.5060 GTR+R5 -305988.8182 612143.6364 + 0.9996 612144.2936 + 0.8665 612804.8528 + 0.4940 GTR+I+G4 -306063.8292 612281.6585 - 0.0000 612282.2245 - 0.0000 612895.0761 - 0.0000 GTR+G4 -306194.0411 612540.0822 - 0.0000 612540.6337 - 0.0000 613145.5333 - 0.0000 GTR+R3 -306231.2249 612620.4498 - 0.0000 612621.0455 - 0.0000 613249.8003 - 0.0000 GTR+F+R4 -306876.3325 613914.6649 - 0.0000 613915.2910 - 0.0000 614559.9484 - 0.0000 GTR+F+R5 -306870.9677 613907.9354 - 0.0000 613908.5927 - 0.0000 614569.1518 - 0.0000 GTR+F+I+G4 -306954.3469 614062.6938 - 0.0000 614063.2598 - 0.0000 614676.1114 - 0.0000 GTR+F+R3 -306992.0042 614142.0083 - 0.0000 614142.6040 - 0.0000 614771.3588 - 0.0000 GTR+F+G4 -307121.6409 614395.2818 - 0.0000 614395.8333 - 0.0000 615000.7330 - 0.0000 GTR+R2 -308642.7082 617439.4163 - 0.0000 617439.9823 - 0.0000 618052.8339 - 0.0000 GTR+F+R2 -308825.1429 617804.2858 - 0.0000 617804.8518 - 0.0000 618417.7034 - 0.0000 GTR+I -315422.8103 630997.6207 - 0.0000 630998.1722 - 0.0000 631603.0718 - 0.0000 GTR+F+I -315668.0750 631488.1499 - 0.0000 631488.7014 - 0.0000 632093.6010 - 0.0000 GTR -329383.1207 658916.2413 - 0.0000 658916.7784 - 0.0000 659513.7260 - 0.0000 GTR+F -330308.0662 660766.1324 - 0.0000 660766.6695 - 0.0000 661363.6170 - 0.0000 AIC, w-AIC : Akaike information criterion scores and weights. AICc, w-AICc : Corrected AIC scores and weights. BIC, w-BIC : Bayesian information criterion scores and weights. Plus signs denote the 95% confidence sets. Minus signs denote significant exclusion. SUBSTITUTION PROCESS -------------------- Model of substitution: GTR+F+R4 Rate parameter R: A-C: 2.5706 A-G: 3.5043 A-T: 1.6419 C-G: 1.8707 C-T: 6.3456 G-T: 1.0000 State frequencies: (empirical counts from alignment) pi(A) = 0.2631 pi(C) = 0.1861 pi(G) = 0.2134 pi(T) = 0.3373 Rate matrix Q: A -0.8786 0.2361 0.3691 0.2734 C 0.3338 -1.587 0.1971 1.057 G 0.455 0.1718 -0.7934 0.1665 T 0.2132 0.5828 0.1053 -0.9014 Model of rate heterogeneity: FreeRate with 4 categories Site proportion and rates: (0.3607,0.05297) (0.2369,0.486) (0.2519,1.412) (0.1505,3.39) Category Relative_rate Proportion 1 0.05297 0.3607 2 0.486 0.2369 3 1.412 0.2519 4 3.39 0.1505 ", "Dear Vadim, Thanks for pointing this out. It is an inconsistency in IQ-TREE: ModelFinder assumes GTR+R4 = GTR+FO+R4. But then the IQ-TREE search phase assumes GTR+R4 = GTR+F+R4. That\u2019s why you saw this discrepancy. However, I don\u2019t think that using +F and +FO will have any impact on tree topology. Thus, you can safely ignore this. If you still insist on using +FO, then you can rerun with -m GTR+FO+R4. Cheers, Minh "]}, "iiexd87MNLQ": {"topic": "Mean Genetic Distance", "initializeDate": "Sep 14, 2020, 7:38:02 AM", "timeStamp": "Sep 15, 2020, 10:12:05 AM", "content": ["Dear Members, I am curious about calculating the mean genetic distance for my data. I am assuming this might be possible using the .mldist file. Kindly suggest how to go about this. Thank you ", "Dear Kehinde, one can compute the mean distance by taking the mean of all off-diagonal values in the pairwise distance matrix (the content of the mldist file). The values on the diagonal is not to be taken into account, because it contains only zeroes (because here each sequence is compared with itself. And please keep in mind, every (off-diagonal) value occurs twice in the matrix (seqX vs seqY as well as seqY vs seqX). Thus, the mean of all values still works. I hope that helps. Best wishes, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8405d25b-e729-4598-a8ff-586f08b50988n%40googlegroups.com ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs Campus Vienna Biocenter 5 (VBC5) A-1030 Vienna, Austria ----------------------------------------------------------------------------- Email: heiko.schmidt(AT) univie.ac.at Tel. : ++43 +1 / 4277 - 74321 http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Dear Heiko, Many thanks! Cheers To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/C7434C8C-06BF-4A84-835F-78A04C0F5846%40univie.ac.at Kehinde Adewole Oyeniran PhD Scholar | Computational Biology | Institute of Infectious Diseases and Molecular Medicine (IDM) | Faculty of Health Sciences | University of Cape Town | Health Sciences Campus, Anzio Road, Observatory, 7925 | Blog: www.electoralreform-ng.blogspot.com | UCT email: OYNK...@myuct.ac.za +27(0)619507372 +27(0)736207568 +234(0)8038294995 \u201cAs you rise you must lift the others up\u201d -- Justice Skweyiya (RIP) ", "Dear Hieko, I have many taxa about 524 and I intend to estimate the overall genetic distance for these; is there a less laborious approach to achieve this? Many thanks. ", "Dear Kehinde, This is not actually laborious. You just have to read in the numbers into any software like Excel, R, Mathematica, Matlab, \u2026 you name it. Then you sum up all the numbers (including the zeroes) and divide that sum by ((524*524)-524). This works because the zeroes are neutral to the sum, and 524*524 is the complete number of entries in the matrix and -524 subtracts the number of the diagonal entries. Depending on what software you are using, it might be helpful to remove the first line, which only contains the number of sequences - that is 524 in your case. Does that help you? Best wishes, Heiko > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAC86RzHoYXkYPCdstrKCu%3DTr9Fo0qEcbmYEfQWzxZ0JUX6L47Q%40mail.gmail.com "]}, "cKuJt9vR4wU": {"topic": "Too many iterations in tqli and numerical problems", "initializeDate": "Jan 21, 2019, 8:02:33 AM", "timeStamp": "Feb 5, 2019, 10:47:41 PM", "content": ["Hi there, I wonder if I should worry about my results if I got these warnings: WARNING: States(s) GGC, TGA, TGC, TGG rarely appear in partition gene2 and may cause numerical problems ... this appears in many other partitions WARNING: Too many iterations in tqli ... this keep appearing in my log file, yet the job has not finished What does 'tqli' means and what are the implications of these warnings in my output tree? Thanks in advance! ", "Hi, These two WARNINGs are related. The one about tqli means that numerical optimisation does not converge, so you may have sub-optimal estimates of model parameters. I believe the beta version 1.7 solved some of these problems, which more often occur with codon models. Therefore, can you please test the beta version ( https://github.com/Cibiv/IQ-TREE/releases ; scroll down to the current 1.7-beta7) and let me know if this warning disappears or not? Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Thank you so much for your quick reply. I have tried to install the bete7 version, but I am having an error: CMake Error at CMakeLists.txt:176 (message): GCC version must be at least 5.4! However, the cluster I work has gcc v6.2.0. Any solution you recommend? Thanks ", "Please check gcc installation, I believe the error msg is correct. Alternatively, why don\u2019t you just download the binary? Minh ", "Thank you Minh, I was able to run again it iqtree v1.7 - beta7 my alignment but have this error now: Initial log-likelihood: -1570365.783 Current log-likelihood at step 1: -1497252.607 ERROR: modelmarkov.cpp:1250: virtual void ModelMarkov::decomposeRateMatrix(): Assertion ` eigensolver.info () == Eigen::Success' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ", "This error message is actually much more informative: the eigenvalues cannot be obtained for the rate matrix (for certain combination of model parameters). I suspect it is due to sparse codon rate matrix. But can you pls send me the input file via my personal email for further inspection? Thanks, Minh ", "Hi, I believe this assertion is now fixed in 1.7-beta8 version. Can you please check it and let me know if that\u2019s the case: https://github.com/Cibiv/IQ-TREE/releases Thank you! Minh "]}, "uGeqBo2xm0c": {"topic": "large differences in number iterations and tree topology on the same alignment", "initializeDate": "Apr 6, 2021, 3:19:49 PM", "timeStamp": "Apr 16, 2021, 11:17:45 AM\u00a0(12 days ago)\u00a0", "content": ["Dear community, I ran two independent ML analyses on the same alignment using the same parameters (log files for both runs attached). The only exceptions are that I used the option -MFP to select the best-fitting model in the first run (for the second run I just selected the model chosen directly) and I used the option -wbtl for the second run. However, I inspected the topology of both trees and those vary substantially; the topology of tree 2 is clearly wrong (although very well supported by bootstrap). I also checked the log files and it seems that run 2 had fewer iterations than run 1 (521 vs 1001). I should also mention that the server where I was running tree 2 cancelled my job accidentally and I just started it right after that. Is this problem associated with the server issue or it is just how ML/IQ-TREE works? Has someone else experienced this problem? I was not expecting to get contradictory results when using the same alignment as input data. Thank you in advance! Carolina. ", "Hi Carolina, This is a very good observation. Here are important information extracted from your run1: BEST SCORE FOUND : -12126327.669 Log-likelihood of consensus tree: -12126241.177 WARNING: bootstrap analysis did not converge. You should rerun with higher number of iterations (-nm option) Interestingly, the consensus tree has a higher likelihood than the ML tree, indicating that tree search is stuck in local optimum. Moreover, a good practice is to grep all WARNING in the log file. This warning is particularly important: bootstrap non-converegence and local optimum are connected. What I would do is to increase the number of maximum iterations to say -nm 2000, and see how it goes. (Otherwise, IQ-TREE stops at 1000 iterations by default, to save running time). From your run2: BEST SCORE FOUND : -12127189.542 Log-likelihood of consensus tree: -12127016.342 So same observation that consensus tree is better than ML tree. However, run2 has a much lower likelihood than run1. So I\u2019d not take the tree from run2. run2 does not warn about non-converegence, because: NOTE: Bootstrap correlation coefficient of split occurrence frequencies: 0.990 which is just enough to stop the analysis. (the minimum threshold is 0.99 to decide on converegence). I also noticed that run2 used only a single core, which runs slowly. So the conclusion here is: for this dataset you should run IQ-TREE at least 10 times, and then take the tree with the highest likelihood found among 10 runs. This is well documented here: https://doi.org/10.1093/molbev/msx302 Moreover, I would take the consensus tree if it shows higher likelihood. I believe .iqtree file will give a WARNING about this. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7c9b5af0-fcec-4265-b1a9-e3377b699cedn%40googlegroups.com <run1_even_family.trimal01.aln.log> <run2_even_family.trimal01.aln.log> ", "Hi Minh, Thank you very much for your response; it was very helpful and thank you for sharing the paper! One last question: it seems that getting a run stuck into a local optimum is a potential issue. Is there a way to circumvent this issue? maybe by tracking the log file constantly while running the tree? what would be the most obvious sign of that? in case one detects that this is happening, the best practice would be to cancel that run and start again with perhaps a larger number of iterations? Thank you! Best, Carolina. ", "Hi Carolina, As I said, simply run IQ-TREE several times and see if the resulting log-likelihoods and trees are much different. There is even an option --runs 10, which ask IQ-TREE to do 10 independent runs and summarise the result at the end. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/268d318b-aeaa-485a-b13e-73824fcc52edn%40googlegroups.com ", "Hello, Minh, This sounds great! thank you so much for your help! Best regards, Carolina. "]}, "sSxPi649Qqo": {"topic": "Can i let iqtree to determine the best model from the models I want to test?", "initializeDate": "Feb 27, 2018, 5:44:43 AM", "timeStamp": "Feb 27, 2018, 6:14:31 PM", "content": ["Hello everybody, I want to test the best model for my protein alignment. however, considering the time that it needs to take, i only want to test for a few model combinations. For instance, lg+gamma, lg, and so on. Is there a way to do that in iqtree? Cacau ", "Hi Cacau, The quick answer is to use -mset option. E.g., -mset LG for your purpose. See doc here: http://www.iqtree.org/doc/Command-Reference#automatic-model-selection Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "xM-B1dJZEEQ": {"topic": "Modelfinder: how to program partition file for mixed partition with binary partitions", "initializeDate": "Jan 25, 2018, 3:08:48 AM", "timeStamp": "Jan 26, 2018, 1:09:55 PM", "content": ["Hello, 2 questions: a) When I have a mixed partition scheme like that example: DNA, A = 1-795 DNA, B = 796-962 DNA, C = 963-1576 DNA, D = 1577-3025 DNA, A1 = 3026-3409\\3 DNA, A2 = 3027-3409\\3 DNA, A3 = 3028-3409\\3 DNA, B1 = 3410-4396\\3 DNA, B2 = 3411-4396\\3 DNA, B3 = 3412-4396\\3 BIN, INDELSA = 4397-5854 BIN, INDELSB = 5855-6044 When I use modelfinder at http://iqtree.cibiv.univie.ac.at/ - how must I program the partition file? The input form says \u201cRAxML format\u201d \u2013 what is exactly as above. But when I do it like above the program ends in \u201cERROR: Invalid number of states.\u201d The binary partitions contain 0 and 1. b) I only have the following options to set up the sequence type: None of this is right, since I have a mixed partition containing DNAs and binaries (in some cases also Codon partitions and morphologies as well) I also don\u2019t want to \u201cauto-detect\u201d the sequence type. What must I set here? All the best Dieter ", "Hi Dieter again, Unfortunately having mixed data is not supported in the web inference. You have to download stand-alone version, and follow this guide to specify mixed data: http://www.iqtree.org/doc/Complex-Models#partition-models . A NEXUS partition file and two alignment files are necessary. Minh > On 25 Jan 2018, at 7:08 pm, die...@nocrotec.com wrote: > Hello, > 2 questions: > a) When I have a mixed partition scheme like that example: > DNA, A = 1-795 > DNA, B = 796-962 > DNA, C = 963-1576 > DNA, D = 1577-3025 > DNA, A1 = 3026-3409\\3 > DNA, A2 = 3027-3409\\3 > DNA, A3 = 3028-3409\\3 > DNA, B1 = 3410-4396\\3 > DNA, B2 = 3411-4396\\3 > DNA, B3 = 3412-4396\\3 > BIN, INDELSA = 4397-5854 > BIN, INDELSB = 5855-6044 > When I use modelfinder at http://iqtree.cibiv.univie.ac.at/ - how must I program the partition file? > The input form says \u201cRAxML format\u201d \u2013 what is exactly as above. But when I do it like above the program ends in \u201cERROR: Invalid number of states.\u201d > The binary partitions contain 0 and 1. > b) I only have the following options to set up the sequence type: > <Auto Generated Inline Image 1.png> > None of this is right, since I have a mixed partition containing DNAs and binaries (in some cases also Codon partitions and morphologies as well) > I also don\u2019t want to \u201cauto-detect\u201d the sequence type. > What must I set here? > All the best > Dieter > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout > <Auto Generated Inline Image 1.png> ", "Hello Minh, Ah, OK, thank you. I see also on Cipres not possible. What a pity. Will test it later local (my computers are all busy) All the best Dieter > You received this message because you are subscribed to a topic in the > Google Groups \"IQ-TREE\" group. > To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/xM-B1dJZEEQ/unsubscribe > To unsubscribe from this group and all its topics, send an email to "]}, "x8xdDFQfW0Y": {"topic": "Modelmerging with IQtree 1.6.6/1.6.7 with Modelfinder - works checkpointing properly?", "initializeDate": "Sep 19, 2018, 8:49:06 AM", "timeStamp": "Nov 19, 2018, 5:26:38 AM", "content": ["Dear Minh & all, I am running partially large datasets (up to e.g. 200 terminals, > 3000 partitions). My impporession is that since the edge-linked approach was added, there is not really a checkpointing: although I run e.g. -rclusterf 10 (I do not have unlimited walltime, therefore must restart the run every couple of days), a checkpoint file (ckp.gz) is NOT created, only a model file ....model.gz. So it seems model selection seem to work, but merging seem to restart everytime the walltime leads to terminating the job, therefore it seems to be a neverending story. Can you check this please? (I am running a dataset now for one month (quite large though), another colleague for weeks. Shall I send you the dataset? (@Minh, you might have this one still, I sent it earlier to you when you implemented the edge-linked approach -> Diptera dataset). It's getting urgent though (otherwise we might change back to Partitionfinder & raxML but prefer to use the implemented version & Modelfinder in IQtree) Best, Karen ", "Hi Karen, The file .model.gz is exactly the checkpoint file for ModelFinder. Only once this is completed then another checkpoint file (.ckp.gz) will be written. So nothing will be lost (checkpoint is written every minute). To speed up a few options will be useful: -mset to restrict model set, e.g., -mset LG to only test LG model (will speed up by 20 times or so). -cmax 4 to test up to 4 rate categories for +R model. \"-rcluster-max 1000\u201d to evaluate only the top 1000 pairs of partitions. My benchmark actually showed that ModelFinder is much faster than PartitionFinder2. Because it has a mechanism to start model optimisation from previously estimated parameters and does not have to call an external program... Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Karen again, If you want to speedup further, use -m TESTMERGE to disallow the free-rate model and only consider the Gamma and/or invariable sites model of rate heterogeneity across sites. Thus it will evaluate the same set of models as PartitionFinder2 but much faster. Cheers Minh ", "Dear Minh, thanks a lot that clarifies issues - we might consider to restrict models, (I did already only testing nuclear) but m,ost reviewers simply request to test all - and going back to TESTMERGE only I would like to avoid (since at least most datasets I see that freerate models are preferred...). I just had the impression that not the checkpoint is maybe a problem, but that \"merging\" starts again from scratch when interrupted (had a look at the \"!job.log file\". anyway, probably my interpretation is wrong. Is there a way to estimate from the log file how long the process will take since its not linear, correct? (I have 3249 partitions, it says now: ... 3324 JTT+F+R7 91537217.725 EOG77484M+EOG7RG55W 15h:47m:49s (2660h:50m:43s left). I also would not like to restrict it to 4 rate categories (since often seen that 6 or 7 is better...) - what number of pairwise comparisons you would recommend having 3249 partitions ? (max number: of pw comparisons in this example would be then 5276536 - correct? 10% or only 1% (527653,6 or 52765,36) ? I thought this is done with rclusterf 10 - for example. correct? Not sure if only 1000 would be really appropriate... (command I used: iqtree -s *.fas -spp *.partition -m MF+MERGE -msub nuclear -madd LG4X -merit AICc -rclusterf 10 -safe -pre XXX -nt 48 Thanks again and best Karem Or would you recommend then ", "Hi Karen, How about a two state procedure: First merge the partitions with these restrictions to speed it up and once done perform a more thorough model search (without restrictions) on the partitioning scheme found. Because for the merging phase I think some good model is enough to produce a reasonable partitioning scheme. So it would be something like: 1. iqtree -s aln_file -spp partition_file -m TESTONLYMERGE -pre step1 \u2026 (restrictions as discussed) 2. iqtree -s aln_file -spp step1.best_scheme.nex -m MFP -msub nuclear -madd LG4X -merit AICc -pre step2 Minh ", "That's really probably the way to go ! (will discuss with colleagues than then decide for something.Thanks Minh! Still, from your side any recommendations on rclutermax - and also can I from the logfile try to estimate how long this procedure would be? Best and have a nice weekend Karen ", "Hi Karen, On 22 Sep 2018, at 12:12 am, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: That's really probably the way to go ! (will discuss with colleagues than then decide for something.Thanks Minh! Still, from your side any recommendations on rclutermax That really depends how long you have to wait. By default IQ-TREE uses 10 times the number of partitions for -rcluster-max. But you can lower it if that takes too long... - and also can I from the logfile try to estimate how long this procedure would be? The estimated time left is definitely over-estimation, because it is computed as if you are only using one core. So you can simply divide it by the number of cores. We\u2019ll fix this in the next release. Cheers Minh ", "okay many thanks these information help already to decide on something to speed it up :) Best, Karen ", "Dear Minh and Karen, I have been experiencing a similar problem and just wanted to thank both of you for publishing the discussion online. It has helped me improve my PhD research on the evolution of cyanobacteria at the University of Bristol. Best wishes, Joanne ", "Hi Joanne, Great to to hear the discussion is useful for some users ;-) Minh "]}, "XmmfJqfrniQ": {"topic": "Error-Crash-No. Partitions exceed PLL limit", "initializeDate": "Sep 16, 2015, 7:16:06 AM", "timeStamp": "Sep 17, 2015, 5:16:48 PM", "content": ["Hello iqtree developers, I tried to run a tree reconstruction (v.1.3.8 omp for Linux) with a very large dataset (i.e 118 taxa, 2980 partitions). Initially i tried to do this on my computer just to check the memory requirements of the analysis. But i get this error: ERROR: Number of partitions exceeds PLL limit, please increase PLL_NUM_BRANCHES constant in pll.h Is this a possible bug? Many thanks Alex ", "Hi Alex, this is not a bug, it is due to hard-coded constant (1024) for the number of partitions in the phylogenetic likelihood library (PLL). There are two solutions for this: 1. (easy) you run IQ-Tree with BIONJ starting tree instead of the default parsimony trees, by option \u2018-t BIONJ\u2019. You can also use \u2018-t RANDOM\u2019 to start from a random tree. No error message will occur anymore. 2. (not easy) Get the source code of IQ-Tree, change this constant accordingly for your data, recompile the code and run IQ-Tree. However, I will set this constant to 4096 (or even more) for the next release of IQ-Tree. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, I tried now the option 2) (havin 2980 partitions). However I only find here the file pllnni.h which line there do I exactly have to change where is PLL_NUM_BRANCHES and must I change it exactly to the num. of partitions I have? and first compile (with cmake .. -DIQTREE_FLAGS=\"omp\" )and then change the number and then recompile or can I change it directly? cheers and thanks Karen ", "Hi Minh and all found it finally in the folder iqtree-1.3.8-Source/pllrepo/src/pll.h still: it can be hight and must not be exactly the same number of partitions, correct? ", "Hi Karen, it can be higher. If I understood Minh correctly he plans to set the default value to something like 10000 in future releases. Good night, Heiko ", "Yes that\u2019s right, any number higher or equal than the number of partitions will work. This is right now declared as: #define PLL_NUM_BRANCHES 1024 in iqtree-1.3.8-Source/pllrepo/src/pll.h, line 130 I plan to change it to: #define PLL_NUM_BRANCHES 16384 (or 2^14) Cheers, Minh "]}, "ttIL7wfXvLs": {"topic": "Fwd: Iqtree bug report", "initializeDate": "Jun 11, 2019, 6:12:55 PM", "timeStamp": "Jul 3, 2019, 12:38:10 AM", "content": ["Begin forwarded message: From: \"\u4e00\u6b65\u9519\" < 4121...@qq.com Subject: Iqtree bug report Date: 11 June 2019 at 7:30:17 pm AEST To: \"minh.bui\" < minh...@univie.ac.at Hello, I think I found a bug. When run iqtree without '-keep-ident' and there are too many identical sequences in the alignment file, some sequences will appear many times in final tree. I constructed a tree with 14 sequences, but there are 16 leaf nodes in the final tree. I can't connect google. Do you have another way report bug? Example as follow: sequences: MKERRASQKLSSKSIMDPNQNVKCKIVVVGDSQCGKTALLHVFAKDCFPENYVPTVFENYTASFEIDTQRIELSLWDTSGSPYYDNVRPLSYPDSDAVLICFDISRPETLDSVLKKWKGEIQEFCPNTKMLLVGCKSDLRTDVSTLVELSNHRQTPVSYDQGANMAKQIGAATYIECSALQSENSVRDIFHVATLACVNKTNKNVKRNKSQRATKRISHMPSRPELSAVATDLRKDKAKSCTVM MKERRASQKLSSKSIMDPNQNVKCKIVVVGDSQCGKTALLHVFAKDCFPENYVPTVFENYTASFEIDTQRIELSLWDTSGSPYYDNVRPLSYPDSDAVLICFDISRPETLDSVLKKWKGEIQEFCPNTKMLLVGCKSDLRTDVSTLVELSNHRQTPVSYDQGANMAKQIGAATYIECSALQSENSVRDIFHVATLACVNKTNKNVKRNKSQRATKRISHMPSRPELSAVATDLRKDKAKSCTVM MKERRASQKLSSKSIMDSNQNVKCKIVVVGDSQCGKTALLHVFAKDCFPENYVPTVFENYTASFEIDTQRIELSLWDTSGSPYYDNVRPLSYPDSDAVLICFDISRPETLDSVLKKWKGEIQEFCPNTKMLLVGCKSDLRTDVSTLVELSNHRQTPVSYDQGANMAKQIGAATYIECSALQSENSVRDIFHVATLACVNKTNKNVKRNKSQRATKRISHMPSRPELSAVATDLRKDKAKSCTVM MKERRASQKLSSKSIMDPNQNVKCKIVVVGDSQCGKTALLHVFAKDCFPENYVPTVFENYTASFEIDTQRIELSLWDTSGSPYYDNVRPLSYPDSDAVLICFDISRPETLDSVLKKWKGEIQEFCPNTKMLLVGCKSDLRTDVSTLVELSNHRQTPVSYDQGANMAKQIGAATYIECSALQSENSVRDIFHVATLACVNKTNKNVKRNKSQRATKRISHMPSRPELSAVATDLRKDKAKSCTVM MKERRASQKLSSKSIMDPNQNVKCKIVVVGDSQCGKTALLHVFAKDCFPENYVPTVFENYTASFEIDTQRIELSLWDTSGSPYYDNVRPLSYPDSDAVLICFDISRPETLDSVLKKWKGEIQEFCPNTKMLLVGCKSDLRTDVSTLVELSNHRQTPVSYDQGANMAKQIGAATYIECSALQSENSVRDIFHVATLACVNKTNKNVKRNKSQRATKRISHMPSRPELSAVATDLRKDKAKSCTVM MKERRASQKLSSKSIMDPNQNVKCKIVVVGDSQCGKTALLHVFAKDCFPENYVPTVFENYTASFEIDTQRIELSLWDTSGSPYYDNVRPLSYPDSDAVLICFDISRPETLDSVLKKWKGEIQEFCPNTKMLLVGCKSDLRTDVSTLVELSNHRQTPVSYDQGANMAKQIGAATYIECSALQSENSVRDIFHVATLACVNKTNKNVKRNKSQRATKRISHMPSRPELSAVATDLRKDKAKSCTVM MKERRASQKLSSKSIMDPNQNVKCKIVVVGDSQCGKTALLHVFAKDCFPENYVPTVFENYTASFEIDTQRIELSLWDTSGSPYYDNVRPLSYPDSDAVLICFDISRPETLDSVLKKWKGEIQEFCPNTKMLLVGCKSDLRTDVSTLVELSNHRQTPVSYDQGANMAKQIGAATYIECSALQSENSVRDIFHVATLACVNKTNKNVKRNKSQRATKRISHMPSRPELSAVATDLRKDKAKSCTVM MKERRASQKLSSKSIMDPNQNVKCKIVVVGDSQCGKTALLHVFAKDCFPENYVPTVFENYTASFEIDTQRIELSLWDTSGSPYYDNVRPLSYPDSDAVLICFDISRPETLDSVLKK-ASEIQEFCPNTKMLLVGCKSDLRTDVSTLVELSNHRQTPVSYDQGANMAKQIGAATYIECSALQSENSVRDIFHVATLACVNKTNKNVKRNKSQRATKRISHMPSRPELSAVATDLRKDKAKSCTVM MKERRASQKLSSKSIMDPNQNVKCKIVVVGDSQCGKTALLHVFAKDCFPENYVPTVFENYTASFEIDTQRIELSLWDTSGSPYYDNVRPLSYPDSDAVLICFDISRPETLDSVLKKWKGEIQEFCPNTKMLLVGCKSDLRTDVSTLVELSNHRQTPVSYDQGANMAKQIGAATYIECSALQSENSVRDIFHVATLACVNKTNKNVKRNKSQRATKRISHMPSRPELSAVATDLRKDKAKSCTVM >jout MKERRASQKLSSKSIMDPNQNVKCKIVVVGDSQCGKTALLHVFAKDCFPENYVPTVFENYTASFEIDTQRIELSLWDTSGSPYYDNVRPLSYPDSDAVLICFDISRPETLDSVLKKWKGEIQEFCPNTKMLLVGCKSDLRTDVSTLVELSNHRQTPVSYDQGANMAKQIGAATYIECSALQSENSVRDIFHVATLACVNKTNKNVKRNKSQRATKRISHMPSRPELSAVATDLRKDKAKSCTVM MKERRASQKLSSKSIMDPNQNVKCKIVVVGDSQCGKTALLHVFAKDCFPENYVPTVFENYTASFEIDTQRIELSLWDTSGSPYYDNVRPLSYPDSDAVLICFDISRPETLDSVLKKWKGEIQEFCPNTKMLLVGCKSDLRTDVSTLVELSNHRQTPVSYDQGANMAKQIGAATYIECSALQSENSVRDIFHVATLACVNKTNKNVKRNKSQRATKRISHMPSRPELSAVATDLRKDKAKSCTVM MKERRASQKLSSKSIMDPNQNVKCKIVVVGDSQCGKTALLHVFAKDCFPENYVPTVFENYTASFEIDTQRIELSLWDTSGSPYYDNVRPLSYPDSDAVLICFDISRPETLDSVLKKWKGEIQEFCPNTKMLLVGCKSDLRTDVSTLVELSNHRQTPVSYDQGANMAKQIGAATYIECSALQSENSVRDIFHVATLACVNKTNKNVKRNKSQRATKRISHMPSRPELSAVATDLRKDKAKSCTVM MKERRASQKLSSKSIMDPNQNVKCKIVVVGDSQCGKTALLHVFAKDCFPENYVPTVFENYTASFEIDTQRIELSLWDTSGSPYYDNVRPLSYPDSDAVLICFDISRPETLDSVLKKWKGEIQEFCPNTKMLLVGCKSDLRTDVSTLVELSNHRQTPVSYDQGANMAKQIGAATYIECSALQSENSVRDIFHVATLACVNKTNKNVKRNKSQRATKRISHMPSRPELSAVATDLRKDKAKSCTVM MKERRASQKLSSKSIMDPNQNVKCKIVVVGDSQCGKTALLHVFAKDCFPENYVPTVFENYTASFEIDTQRIELSLWDTSGSPYYDNVRPLSYPDSDAVLICFDISRPETLDSVLKKWKGEIQEFCPNTKMLLVGCKSDLRTDVSTLVELSNHRQTPVSYDQGANMAKQIGAATYIECSALQSENSVRDIFHVATLACVNKTNKNVKRNKSQRATKRISHMPSRPELSAVATDLRKDKAKSCTVM Final tree: (((((((((((((a:0.0000000000,k:0.0000000000):0.0000000000,m:0.0000000000):0.0000000000,f:0.0000000000):0.0000000000,i:0.0000000000):0.0000000000,e:0.0000000000):0.0000000000,g:0.0000000000):0.0000000000,n:0.0000000000):0.0000000000,d:0.0000000000):0.0000000000,l:0.0000000000):0.0000020025,(c:0.0039316268,h:0.0079160000)29:0.0000029600)33:0.0000010000,b:0.0000010000):0.0000010000,m:0.0000000000):0.0000000000,jout:0.0000000000,l:0.0000000000); There are two 'l' and two 'm'. But only one in sequence file. Yours, Best regards. Yang Song ", "Dear Yang Song, Thanks for the report. To help us reproduce this behaviour, please send us all the input files, log file and all output files from this run. Because when I just used the sequences you pasted below with a simple command line, everything works fine. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/33973894-F536-44B3-8DA5-A4E2347706E0%40univie.ac.at For more options, visit https://groups.google.com/d/optout "]}, "i1xu1HYInKQ": {"topic": "How to obtain the most likely integer number of variants on a branch", "initializeDate": "Feb 8, 2018, 2:07:52 PM", "timeStamp": "Feb 8, 2018, 7:17:22 PM", "content": ["Dear colleagues Thank you very much for your 1.6 release, which includes ancestral state reconstruction. I work on M. tuberculosis, the sequencing of which is now proceeding routinely for all English isolates. Results of genomic processing are used for identifcation of possible recent person-to-person transmission. For this activity, we are interested in rather small amounts of single nucleotide variation (<12, over a 4.4 e6 genome) as this is associated with possible recent transmission. Because of the way the original studies in the field were reported, single nucleotide variation (SNV) between samples (as opposed to a branch length expressed as subs/base, which is a floating point number) is typically reported/ discussed. Obviously, SNV is approximated by branch substitution rate * genome length, subject to various assumptions about branch specific variation rates, the model used etc. However, it seems to me that since the ancestral states are/ can be generated and written to the state file, iqTree must 'know' the most likely integer number of SNV on each branch. I can clearly see that this can be readily computed from the ancestral state file, and I can do so easily if need be , making a new tree by altering the ML tree output using ete3/biopython etc and resetting branch length. However, before doing so, is there a switch or option by which the most likely integer number of single nucleotide changes can be reported as the branch length, as opposed to the substitution rate? I Thank you David ", "Hi David, answers below: On Fri, Feb 9, 2018 at 6:07 AM, David Wyllie david....@ndcls.ox.ac.uk wrote: Dear colleagues Thank you very much for your 1.6 release, which includes ancestral state reconstruction. I work on M. tuberculosis, the sequencing of which is now proceeding routinely for all English isolates. Results of genomic processing are used for identifcation of possible recent person-to-person transmission. For this activity, we are interested in rather small amounts of single nucleotide variation (<12, over a 4.4 e6 genome) as this is associated with possible recent transmission. Because of the way the original studies in the field were reported, single nucleotide variation (SNV) between samples (as opposed to a branch length expressed as subs/base, which is a floating point number) is typically reported/ discussed. Obviously, SNV is approximated by branch substitution rate * genome length, subject to various assumptions about branch specific variation rates, the model used etc. That's right. And since you have very low SNVs, this approximation should be very close and most of the time equal to the actual number of SNVs on the branches. However, it seems to me that since the ancestral states are/ can be generated and written to the state file, iqTree must 'know' the most likely integer number of SNV on each branch. I can clearly see that this can be readily computed from the ancestral state file, and I can do so easily if need be , making a new tree by altering the ML tree output using ete3/biopython etc and resetting branch length. However, before doing so, is there a switch or option by which the most likely integer number of single nucleotide changes can be reported as the branch length, as opposed to the substitution rate? I No, there is no such option. However, the simple counting may not work well as one may think. For example, an output .state file may look like this: Node Site State p_A p_C p_G p_T Node2 1 C 0.00004 0.99992 0.00002 0.00002 Node2 2 A 0.92378 0.00578 0.00577 0.06468 Node2 3 A 0.95469 0.02634 0.00675 0.01222 ... Node2 17 A 0.55101 0.38957 0.02169 0.03773 Node2 18 A 0.91807 0.03552 0.01054 0.03586 ... Column 3 shows the most likely state for Node2 (of the tree) for every alignment site. You can see that, the state assignment for sites 1,2,3 is reliable with high posterior probability for such states (>0.90). However, for site 17, A is the most likely state but only with a probability of 0.55101. So you should be careful, not just looking at State column but also at the p_X column. If the most likely state shows < 50% probability, then I don't know what to do... Cheers, Minh Thank you David You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "BUMq90MSam0": {"topic": "the / separating the support values are replace by _", "initializeDate": "May 30, 2018, 5:30:54 AM", "timeStamp": "May 30, 2018, 2:54:31 PM", "content": ["in the documentation and locally in the .iqtree file it is said that \"Numbers in parentheses are SH-aLRT support (%) / aBayes support / ultrafast bootstrap support (%)\" but we got this | +--Francisella_sp..GCA_000219045.1 | +--| ( 99.5_1_90 and in the .treefile: Francisella_noatune..GCA_001042525.2:0.0000000000):0.0000022621,Francisella_noatune..GCA_001042565.2:0.0000022621) 0_0.333_93 :0.0000022621) 0_0.333_3 1:0.0000022621,Francisella_noatune..GCA_001648045.1:0.0000022621) 0_0.333_93 :0.0000022621,Francisella_noatune..GCA_000262205.1:0.0000022621) 100_1_100 :0.0010814537,Francisella_philomi..GCA_000833255.1:0.0000841839) 99.7_1_100 :0.0010361213) 99.9_1_100 :0.0021257903) 99.5_1_9 0:0.0025648547,((Francisella_sp..GCA_001895265.1:0.0016935363, I wonder if the change is deliberate or not... the version is IQ-TREE 1.6.5 built May 8 2018 (MasOS) JPF Pr. emer. JP Flandrois MD, PhD Univ Lyon. LBBE Laboratoire de Biometrie et Biologie Evolutive - http://lbbe.univ-lyon1.fr/ ", "Hi JPF, Many thanks for reporting this! This is a bug in v1.6.5 (not present in v1.6.4) due to a quick change that replaces odd characters in taxon names to underscore. But it has an unwanted effect of also replacing internal node names from slash to underscore. That\u2019s why you see these underscores, but all support values are correct. We will fix this soon\u2026 sorry for this inconvenience. For the moment you can revert to v1.6.4. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh I will revert to 1.6.4 because all the wraper is using the / tag to compute a composite unique index of satisfaction :) too complicated to change quickly. Thanks for the rapide answer. JPF "]}, "YAz3iW8cFu4": {"topic": "crash from iqtree running: could not write \"gtdbtk.ar122.msa_fix.fasta.ckp.gz\"", "initializeDate": "Nov 25, 2019, 3:32:10 PM", "timeStamp": "Nov 25, 2019, 7:58:18 PM", "content": ["Hi all, I am running a mixture model tree. It takes a long time to reach 37 times but crashed at with the following errors: \"Iteration 140 / LogL: -3924663.706 / Time: 3h:55m:53s (2h:42m:38s left) ERROR: Cannot write to file gtdbtk.ar122.msa_fix.fasta.ckp.gz\" this is the command I used: iqtree -nt 72 -s gtdbtk.ar122.msa_fix.fasta -m LG+C10+G+F -ft gtdbtk.ar122.msa_fix.fasta.treefile -b 100 #any way to resue my running or comments on the commands #iqtree info IQ-TREE multicore version 1.6.8 for Linux 64-bit built Oct 28 2018 Thanks. Pengfei ", "Hi Pengfei, I believe there is something wrong with your system (disk), that IQ-TREE could not write the checkpoint file at that stage. Please first update the latest stable release (1.6.12; you can also try out the release candidate version 2), as it improves the way of handling the checkpoint file. Then simply rerun the same command line: IQ-TREE will try to recover the run from a previous checkpoint. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/39bfceb6-7772-4d57-9dc8-11c674d50e37%40googlegroups.com "]}, "Jnua51n9AH8": {"topic": "How to make gene trees as input for ASTRAL Using IQ-tree", "initializeDate": "Jul 10, 2020, 5:21:02 PM", "timeStamp": "Jul 12, 2020, 8:21:45 PM", "content": ["Hi, I am a new user for IQ-tree and i used IQ-tree to construct ML trees for my research and wanted to cross check it with Multi-species coalescent model using ASTRAL. But i could't find how should i generate gene trees which are input for ASTRAL. Any one can help? Thanks! ", "Here you go: http://www.iqtree.org/doc/Concordance-Factor It\u2019s -S option (capital S). Minh On 11 Jul 2020, at 7:21 am, Mergi Daba < merg...@gmail.com > wrote: Hi, I am a new user for IQ-tree and i used IQ-tree to construct ML trees for my research and wanted to cross check it with Multi-species coalescent model using ASTRAL. But i could't find how should i generate gene trees which are input for ASTRAL. Any one can help? Thanks! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1f9a1b3a-c897-4f12-b902-01ae8157c383o%40googlegroups.com "]}, "hvGy7eLWqIM": {"topic": "IQ-TREE CRASHES WITH SIGNAL ABORTED", "initializeDate": "Oct 6, 2015, 11:08:13 AM", "timeStamp": "Dec 11, 2017, 7:46:46 AM", "content": ["I am trying to perform a ML search and bootstrap an alignment of ~300kb SNP`s through 80 taxa. I am running IQtree multi-thread suing the following command q iqtree-omp -s beeville_all.fasta -m K3Pu+ASC+R4 -bb 1000 -nt 16 -numpars 500 -toppars 200 -numcand 100 And returning the following error: Does anybody can help me with this? Computing ML distances based on estimated model parameters... 3.602 sec Computing BIONJ tree... 0.004 seconds Log-likelihood of BIONJ tree: -4298924.345 Generating 498 parsimony trees... 4336.551 seconds 484 distinct starting trees Computing log-likelihood of 484 initial trees ... 510.837 seconds Optimizing top 200 initial trees with NNI... Iteration 1 / LogL: -4273071.002 / Time: 1h:21m:59s Estimate model parameters (epsilon = 0.100) BUG: Tree logl gets worse after model optimization! Old logl: -4273071.002 / new logl: -4274579.753 STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: beeville_all.fasta.log *** Alignment files (if possible) ", "Hi there, this looks like a bug. Since your alignment is too big for debugging purpose, I will now test +ASC+R4 model on my much smaller data set to see what happens (honestly this model combination was not carefully tested). I will then get back to you in any case. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, thanks a lot for your support. I got this model using -m TESTNEW in my very first run. I will test using a more simple model in this meantime. Have a good one! Marcus ", "Dear Marcus, just want to let you know that I could reproduce the issue. I also identified that, as suspected, the ascertainment bias correction plus FreeRate model [+ASC+R] was not handled properly (technically in the newly introduced EM algorithm). I will notify you an internally fixed version shortly. Cheers, Minh Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Marcus, this issue is now fixed in version 1.3.10. Thanks for reporting it. Cheers, Minh > On Oct 6, 2015, at 9:13 PM, marcus....@gmail.com wrote: ", "Dear Minh, I have been trying to perform ML analysis using IQ-Tree (iqtree-omp-1.5.5-Windows) multi-core version. My dataset contains 520 sequences with length of longest sequence being 507 nucleotides. I am experiencing the following problems: 1) When using command ---> iqtree-omp.exe -s 'FASTA.fas' -sp 'NEXUS.nex' -m MF+MERGE \u2013nt AUTO I receive an error \"WARNING Number of threads seems too high for short alignments. Use -nt AUTO to determine best number of threads\" repeatedly I had to resort to using \"-nt 2\" for the analysis 2) When constructing the ML-tree using ---> iqtree-omp.exe -s 'FASTA.fas' -m MODEL -bb 1000 -nt 2 I receive an error \"IQ-TREE CRASHES WITH SIGNAL ABORTED\" Could you please help me with these errors. Sincerely, Vivek ", "Dear Vivek, On Dec 7, 2017, at 9:02 AM, Vivek Suranse < viv...@gmail.com > wrote: Dear Minh, I have been trying to perform ML analysis using IQ-Tree (iqtree-omp-1.5.5-Windows) multi-core version. My dataset contains 520 sequences with length of longest sequence being 507 nucleotides. I am experiencing the following problems: 1) When using command ---> iqtree-omp.exe -s 'FASTA.fas' -sp 'NEXUS.nex' -m MF+MERGE \u2013nt AUTO I receive an error \"WARNING Number of threads seems too high for short alignments. Use -nt AUTO to determine best number of threads\" repeatedly I had to resort to using \"-nt 2\" for the analysis This will be fixed in v1.6 2) When constructing the ML-tree using ---> iqtree-omp.exe -s 'FASTA.fas' -m MODEL -bb 1000 -nt 2 I receive an error \"IQ-TREE CRASHES WITH SIGNAL ABORTED\" Could you please help me with these errors. Then insert all the log file lines with WARNING ERROR , and the last few relevant lines of the log. Thanks, Minh Sincerely, Vivek ", "Dear Vivek, This bug with computing the log-likelihood of consensus tree was fixed in version 1.5.6. Can you please check out this version and let me know it goes? Also, is there any way to identify the sequences with ambiguity from the alignment file? Or could you please add an option that shows the header of the ambiguous sequence in the next version. Do you mean, in the log file, to split the column \u201cGap/Ambiguity\u201d into 2 columns? Cheers, Minh On Dec 11, 2017, at 12:37 PM, Vivek Suranse < viv...@gmail.com > wrote: Dear Minh, I am really thankful for your response. I sincerely apologize as I could not get back to you soon. Please take a look at the log file lines that highlight the problem. Performs final model parameters optimization Estimate model parameters (epsilon = 0.010) 1. Initial log-likelihood: -30254.051 Optimal log-likelihood: -30254.051 Rate parameters: A-C: 1.000 A-G: 1.924 A-T: 1.081 C-G: 1.081 C-T: 1.924 G-T: 1.000 Base frequencies: A: 0.257 C: 0.265 G: 0.231 T: 0.247 Site proportion and rates: (0.283,0.126) (0.287,0.556) (0.263,1.377) (0.112,2.239) (0.055,3.515) Parameters optimization took 1 rounds (0.299 sec) BEST SCORE FOUND : -30254.051 Creating bootstrap support values... Split supports printed to NEXUS file new_trial_1.fas.splits.nex Total tree length: 27.495 Total number of iterations: 930 CPU time used for tree search: 8842.641 sec (2h:27m:22s) Wall-clock time used for tree search: 4698.860 sec (1h:18m:18s) Total CPU time used: 8867.562 sec (2h:27m:47s) Total wall-clock time used: 4712.813 sec (1h:18m:32s) Computing bootstrap consensus tree... Reading input file new_trial_1.fas.splits.nex... 496 taxa and 6949 splits. Consensus tree written to new_trial_1.fas.contree Reading input trees file new_trial_1.fas.contree new_tree_lh: -30289.625 tree_lh: -30258.470 *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: new_trial_1.fas.log *** Alignment files (if possible) Also, is there any way to identify the sequences with ambiguity from the alignment file? Or could you please add an option that shows the header of the ambiguous sequence in the next version. Sincerely, Vivek Vivek Suranse Evolutionary Venomics Lab: www.venomicslab.com TA-06. Centre for Ecological Sciences Indian Institute of Sciences. Bangalore 560012. Karnataka, India "]}, "E2-slKrPzPE": {"topic": "IQTree crashing in big concatenate", "initializeDate": "Jan 13, 2016, 11:15:30 AM", "timeStamp": "Jan 13, 2016, 3:30:23 PM", "content": ["Good afternoon, I have been running IQ trees in a big concatenate. This is the command I have used: iqtree -s ArchaeaGB.fas -q ArchaeaGBLOCK.partitions -m TESTNEWMERGE -bb 1000 -wbt The program crashes after a bit, not sure why. I attach the log, the partition file and the alignment. In the standard ouput said: iqtree: /home/CIBIV/minh/Dropbox/iqtree-git/phylotree.cpp:3126: virtual void PhyloTree::optimizeOneBranch(PhyloNode*, PhyloNode*, bool, int): Assertion `current_len >= 0.0' failed. I would appreciate any help! Thanks in advance! ", "Dear Adrian, thanks for the report with the detailed information. I will have a closer look soon Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <ArchaeaGB.fas> <ArchaeaGBLOCK.partitions> <ArchaeaGBLOCK.partitions.log> <ArchaeaGBLOCK.partitions.model> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "oKxG24ToTUA": {"topic": "Why iq-tree build bionj  tree and parsimony tree again when rerun from checkpoint?", "initializeDate": "Sep 27, 2018, 2:03:28 AM", "timeStamp": "Oct 7, 2018, 1:42:12 PM", "content": ["the command that I used. iqtree s input nt AUTO 2000 Although the log file show that it is resume from check point, I notice that the xxx.parstree and xxx.bionj file is generated again, which waste lots of time. ", "Can you please paste the last 20 lines of the log file? (It looks like you are still at the very beginning of the run, where IQ-TREE hasn\u2019t finished starting trees yet). Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "I can't not reproduce it in other dataset. Seem that there is some error in my previous run. It works as expected now. Thank you, Minh! "]}, "c-zVEDfPCkw": {"topic": "How to kill a job or run on the iq-tree server?", "initializeDate": "Apr 10, 2017, 12:51:33 PM", "timeStamp": "Apr 10, 2017, 12:51:33 PM", "content": ["I started a job on the iq-tree server on Friday, and the status still says \"running\" today (Monday) with no progress made since the last time I checked on Saturday. In the past, I have had jobs terminated at 24 hours, if they were too large or complicated, but this one seems \"stuck\". I don't see a kill command. "]}, "YjEROj514-c": {"topic": "-gmedian option", "initializeDate": "Feb 22, 2016, 9:35:27 PM", "timeStamp": "Feb 24, 2016, 8:26:55 PM", "content": ["Hi all, I guess with -gmedian it willbe chosen the approximation with median instead of mean, correct? (see here: http://www.cibiv.at/software/iqtree/doc/Substitution-Models/#rate-heterogeneity-across-sites Anyway, calling IQtree it says: -gmedian Computing mean for Gamma rate category (default: mean) is this a typo and it should be median? (just caused a bit confusion and probably easy to clarify :)) many thanks Karen ", "Dear Karen, -gmedian is to switch to the median approximation of of the Gamma distribution instead of the mean approximation (Yang 1994). What is printed in the help usage (iqtree -h) was a typo. Thanks for pointing this out, I will correct it. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "many thanks for taking care, Minh :) "]}, "6bj0DpcxZCg": {"topic": "Re: Quick question - ModelOmatic in IQ-TREE", "initializeDate": "Apr 2, 2020, 7:30:54 AM", "timeStamp": "Apr 2, 2020, 7:30:54 AM", "content": ["Hi Adela, You also need to add -st CODON option (for standard genetic code). Otherwise, --modelomatic is not effective. You can change the genetic code, e,g. with -st CODON2, see http://www.iqtree.org/doc/Substitution-Models#codon-models Cheers, Minh On 2 Apr 2020, at 10:18 pm, Roa-Varon, Adela < Roa-V...@si.edu > wrote: Dear BQM, I'm using ModelOMatic in iq-tree-2.0 version using a DNA alignment with almost 3 million sites (~14,000 nuclear loci). I run the command below, but it seems that instead of running modelomatic is using ModelFinder. I wonder if you have available instructions for running modelomatic in iqtree? I was looking for them in the website, but I only found \"--modelomatic option\" in the \" Version 2.0 Highlights\" or if I made a mistake in the settings that you could point out. ################### Command: /data/genomics/roa-varona/Programs/iqtree-2.0/bin/iqtree -nt 31 -rcluster 10 -safe -blmin 1e-6 -s OD_58Taxa_FcC_supermatrix.phy --modelomatic ModelFinder will test up to 286 DNA models (sample size: 2874858) ... I hope you and your family are healthy in these unexpected times! Best, Adela Adela Roa-Var\u00f3n, Ph.D. NRC Research Associate National Systematics Laboratory <Outlook-_var_folde.png> SMITHSONIAN INSTITUTION NATIONAL MUSEUM OF NATURAL HISTORY Facebook Twitter Instagram \"The only true failure can come if you quit\" Rosie Revere, Andrea Beaty "]}, "LVRclpUPsEE": {"topic": "IQ-TREE release 1.5.2", "initializeDate": "Dec 3, 2016, 8:59:03 AM", "timeStamp": "Dec 3, 2016, 8:59:03 AM", "content": ["Dec 3, 2016 Dear users, We are pleased to announce version 1.5.2, which improves software stability. We thank all users (mentioned below) for the reports. Bug fixes: * Incorrect likelihood computation under safe mode for rate homogeneity models (thanks to Ricardo Alves). * Bug when finally merging partitions (-m TESTMERGE) (reported by Olivier Navaud). * Crash when computing distance with consensus tree in presence of identical sequences (-bb option) (reported by Julien). * Crash for I+G model when p-invar close to 0 (reported by liqiangj, Frank Wright). * Bug likelihood scaling for ASC model (reported by lgrismer). Other changes: * Fix misleading message about multifurcating trees (reported by Noah Simons). * Incompatibility problem with older Mac by switching back to libstdc++ instead of libc++ (reported by Matthew Fullmer). * Fix compilation issue for BSD and newer GCC 5.4 (thanks to @njoly). * Improved `-nt AUTO` option, e.g. to work with model selection (reported by Remi Denise). Best, IQ-TREE development team http://www.iqtree.org "]}, "pa47m-jMMOk": {"topic": "iqtree with large dataset", "initializeDate": "Oct 23, 2018, 10:01:01 AM", "timeStamp": "Dec 5, 2018, 5:41:09 PM", "content": ["Hy all, we are running iqtree with a dataset of 768 accessions and 12548 variants merged in phylip alignment with PGDspider. The command line is: iqtree -s test.varsites.phy -m MFP+ASC -pre test_bis -alrt 1000 -bb 1000 -nt 8 We repeated the tree calculation twice and obtained apparently different results with the same input. Even some connected tree structures with high bootstrap (>95 for both BS values) values in the first run get scattered in the second. we'd like to ask: -is iqtree tought to work with datasets such as ours? -which file between the .treefile and .contree is the most reliable one? -do the two BS values respectively refers to SH-aLRT test and UFBoot? what about the only bootstrap value in the .contree file? Is that just the UFboot value? -when would you say that a tree is well inferred? (does it rely on BS values?) -what can be done to improve tree stability? (higher number of iterations...?) -what is the difference between the bootstrap iterations and the number of iterations you assign with the \"-nm\" option? Is the tree calculation expected to be more refined with higher number of -nm iterations? -if no improvement can be done, how can we handle clades with a low bootstrap values? (low bootstrap values are those under, let's say, 70?) -in case we have to compare trees from different approaches, how can we evaluate the difference between two tree structures? Thanks in advance Best Vanessa ", "Hi Vanessa, Hy all, we are running iqtree with a dataset of 768 accessions and 12548 variants merged in phylip alignment with PGDspider. The command line is: iqtree -s test.varsites.phy -m MFP+ASC -pre test_bis -alrt 1000 -bb 1000 -nt 8 We repeated the tree calculation twice and obtained apparently different results with the same input. Even some connected tree structures with high bootstrap (>95 for both BS values) values in the first run get scattered in the second. Yes this may happen especially for large dataset like this (in terms of number of sequences, say >500). Several studies suggested to run the same alignment several times (say 10). See our original paper https://doi.org/10.1093/molbev/msu300 or the more recent Zhou et al: https://doi.org/10.1093/molbev/msx302 . There is a builtin option --runs 10 for this, which was introduced in recent versions. So please make sure that you use the latest version 1.6.7.1. Here, IQ-Tree will perform 10 independent runs and at the end report the best run. The ultrafast bootstrap differs from Felsenstein\u2019s bootstrap that it uses trees sampled on the tree space of the original alignment. So if the tree search is stuck in some local optimum, then the UFBoot support values will be influenced. Therefore, I suggest that you use a new option -bnni introduced in UFBoot2 ( https://doi.org/10.1093/molbev/msx281 ), which will overcome this problem as it will invoke a quick tree search at the end on the bootstrap alignments directly. I think this answered many questions below, and cover those not: we'd like to ask: -is iqtree tought to work with datasets such as ours? see above. Moreover, I would say large datasets are generally difficult for all software, not just IQ-Tree. -which file between the .treefile and .contree is the most reliable one? People may prefer one tree over the other, that\u2019s why we provide both of them. I would first look at the robinson-founds distance between two trees (printed in .iqtree file). If the distance is low, then it does not matter which one you take. If the distance is large, then I would be cautious. However, if your clade of interests does not change, then it doesn\u2019t matter. If yes, then I would do some tree topology test. And just a personal opinion: I tend to prefer consensus tree because it summarises the average across many bootstrap trees. Whereas the ML is a point estimate, which is not as stable as the consensus. -do the two BS values respectively refers to SH-aLRT test and UFBoot? yes. The .iqtree should report the exact order of the two numbers assigned to the branches. what about the only bootstrap value in the .contree file? Is that just the UFboot value? Yes -when would you say that a tree is well inferred? (does it rely on BS values?) I would use the log-likelihoods. -what can be done to improve tree stability? (higher number of iterations\u2026?) see above. And yes you can also increase number of iterations, but independent runs are more preferable. -what is the difference between the bootstrap iterations and the number of iterations you assign with the \"-nm\" option? Is the tree calculation expected to be more refined with higher number of -nm iterations? I believed this was discussed\u2026 I don\u2019t know what you meant by \u201cbootstrap iterations\u201d, there are only iterations for the search algorithm. -if no improvement can be done, how can we handle clades with a low bootstrap values? (low bootstrap values are those under, let's say, 70?) -in case we have to compare trees from different approaches, how can we evaluate the difference between two tree structures? do the tree topology tests\u2026 see the tutorial. Hope that helps, Minh Thanks in advance Best Vanessa You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Minh, thanks for your help. We tried to run with our tree with the --run option, but unfortunately we got the following error messages: ---> SUMMARIZE RESULTS FROM 2 RUNS Run 2 gave best log-likelihood: -503224.018 Ascertainment bias correction: 4 unobservable constant patterns ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: ALBERO-LORENZO-REDO.log ERROR: *** Alignment files (if possible) moreover the software doesn't return the .iqtree file. The initial alignment should be fine since we completed successfully a single run (without --run option) Can you help us please? thanks in advance, Vanessa ", "By the way, we are using IQTREE v. 1.6.8 ", "Sorry to bother you again, I've another question: with the --run option we have serial runs, which may last several days when computing trees with a large dataset; since we are working on a HPC cluster facility, in order to save time, could we process single runs in parallel, and then put all the (output) trees in a single file and compute the final consensus with the -t option? thanks again, Vanessa ", "Dear Vanessa, Thanks for the report! Can you pls send me the log file and input files via personal email for debugging purpose? Sorry to bother you again, I've another question: with the --run option we have serial runs, which may last several days when computing trees with a large dataset; since we are working on a HPC cluster facility, in order to save time, could we process single runs in parallel, and then put all the (output) trees in a single file and compute the final consensus with the -t option? It's better running in parallel this way to save time. You can concatenate all .treefile into one file and then build a consensus tree with -con option, e.g. iqtree -con -t TREES_FILE Minh ", "Dear Minh, is there a way to get from \"iqtree -con -t TREES_FILE\" a consensus tree with the brench lenghts? Thank you very much, Vanessa ", "Hi Vanessa, Not with this command. But you can invoke another run with this consensus tree as fixed input via -te option, something like: iqtree -s ALN_FILE -te CONTREE -m \u2026. (the rest of the commands that you initially run IQ-TREE to infer the tree). This will optimise the branch lengths of the consensus tree on the original data. Cheers Minh "]}, "zB8rWXCP7bk": {"topic": "confused about the -o option", "initializeDate": "Jul 5, 2018, 3:31:27 PM", "timeStamp": "Jul 5, 2018, 4:06:12 PM", "content": ["Hi all, I am confused about the outgroup in iq-tree. without -o option, the first sequence will be used as outgroup, but it is stated that the tree is always unrooted. I do not want the first sequence to be used, since it will be a sister sequence of other sequences, thus I use the -o option, which states like this: Specify an outgroup taxon name to root the tree. The output tree in .treefile will be rooted accordingly. DEFAULT: first taxon in alignment which means although I choose one sequence, the tree is still unrooted, since the chosen sequence is just used to replace the default, am I right? Thanks ", "Hi there, That\u2019s right, the tree is unrooted (except the case below) and the outgroup is only used as a convenient way to draw the tree (so that you don\u2019t have to reroot in in a tree reviewer program). Exception: if you use non-reversible models (such as Lie Markov recently added in v1.6), then the tree is rooted. Whereas the standard models are reversible and so can\u2019t determine the root position. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Pengfei Liu, Thank you for your interest in IQ-Tree. > I am confused about the outgroup in iq-tree. > without -o option, the first sequence will be used as outgroup, but it is stated that the tree is always unrooted. The tree reconstructed by ML program as well as most other programs are usually unrooted trees, because usually the software cannot infer or does not have the data to infer the true root. Since the tree is written out to file starting at some branch the tree might look rooted at that branch, but actually it is not. Since that process has to start somewhere, IQ-TREE (like other programs) use the first taxon. Still this does only influence the output, not the inference of the tree. The \u201c-o\u201d option allows the user to \u2018provide' prior knowledge to the program about an outgroup included into the alignment to provide information about the position of the true root (e.g. adding a rodent sequence to root a primate tree, because the true root was somewhere between the rodents and primates). > I do not want the first sequence to be used, since it will be a sister sequence of other sequences, thus I use the -o option, which states like this: > Specify an outgroup taxon name to root the tree. The output tree in .treefile will be rooted accordingly. DEFAULT: first taxon in alignment > which means although I choose one sequence, the tree is still unrooted, since the chosen sequence is just used to replace the default, am I right? As I stated above, for the program the tree is unrooted - you just tell the program where to root it. I more complex cases like rooting in the middle of the tree one would typically use a tree viewer like FigTree and choose the branch where the tree has to be rooted (e.g. between elongation factors 1 and 2 which seemingly have been already present in the universal tree of live). Still all that is based on prior knowledge by the user about the correct placement of the root. Best regards, Heiko Schmidt ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- "]}, "t5PFa4Kpq3A": {"topic": "Release of IQ-TREE with polymorphism-aware models; version 1.5.0", "initializeDate": "Jul 9, 2016, 8:07:08 AM", "timeStamp": "Jul 9, 2016, 8:07:08 AM", "content": ["Dear users, we are proud to release the first polymorphism-aware model (PoMo) implemented in IQ-TREE (version 1.5.0): * To download the version of IQ-TREE PoMo, please visit: http://www.cibiv.at/software/iqtree/#download * If you are unfamiliar with PoMo like models, you may want to skim through our recent publication [1] Features of this release: * Use PoMo to infer phylogenies from population data. For more details see http://www.cibiv.at/software/iqtree/doc/Polymorphism-Aware-Models/ * Large choice of DNA substitution models. For more details see http://www.cibiv.at/software/iqtree/doc/Polymorphism-Aware-Models/#substitution-models * UFBoot and standard bootstrap support. For more details see http://www.cibiv.at/software/iqtree/doc/Polymorphism-Aware-Models/#bootstrap-branch-support Best, the IQ-TREE development team [1] Dominik Schrempf, Bui Quang Minh, Nicola De Maio, Arndt von Haeseler, and Carolin Kosiol (2016) Reversible polymorphism-aware phylogenetic models and their application to tree inference. J. Theor. Biol., in press, http://biorxiv.org/content/early/2016/04/13/048496 "]}, "o-Fmnfo1WBI": {"topic": "Error using constraint tree in v1.6.8", "initializeDate": "Nov 26, 2018, 9:52:31 PM", "timeStamp": "Dec 2, 2018, 7:01:33 PM", "content": ["Using v1.6.8, I receive the error ... Reading constraint tree Constrain_LWS_basal.nwk... ERROR: Rooted constraint tree not accepted when the constraint tree is of the form: ((A,B),(C,D)); However, everything runs fine when I rearrange the same constraint tree as: (C,(A,B),D); Is this behaviour expected? Thanks, Trevor ", "Hi Trevor, Thanks for your interest in IQ-Tree. It actually is ;) By convention, a Newick tree sting is assumed rooted, if the outer brackets contains only 2 components. In your first example \u201c((A,B),(C,D));\u201d those two components (or clades or subtrees) are \u201c(A,B)\u201d and \u201c(C,D)\u201d. One way to achieve that is by removing one of the two inner pairs of brackets: - (A,B,(C,D)); - ((A,B),C,D); Which would produce 3 components (\u201c(A,B)\u201d, \u201cC\u201d and \u201cD\u201d in the latter case). Roughly the same as in your 2nd example, that worked. By having more than 2 components in the outer bracket it represent an inner node of the tree, such as all other brackets in the Newick string. I hope that helps you. Best regards, Heiko Schmidt ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Thanks Heiko for the explanation ;-) @Trevor: greetings from the other side of ANU. Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Thank you Heiko and Minh. I wasn't aware of that convention. But I'm very pleased to see that v1.7beta5 ignores it, and calculates the constrained tree anyway. Fantastic program! Trevor "]}, "2PYzdwAU5r4": {"topic": "Tree not rooted with provided outgrip", "initializeDate": "Oct 9, 2020, 5:35:34 PM", "timeStamp": "Oct 11, 2020, 5:12:17 PM", "content": ["Dear Members, I specified outgroup in my DNA alignment for rooting my Cipres run analysis, but lo-and-behold, the trees returned are still not rooted. Please, can somehow try and explain what is going on? Many thanks! ", "Hi Kehinde, The outgroup is used merely for drawing purpose, i.e. you will still see a trifurcation around the node connecting outgroup and ingroup taxa. If you really want to have a bifurcation, use FigTree or other tree viewer software. Is that what you wondered about? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4311f569-9525-44ca-9b77-c674aa446602n%40googlegroups.com ", "Kehinde Adewole Oyeniran PhD Scholar | Computational Biology | Institute of Infectious Diseases and Molecular Medicine (IDM) | Faculty of Health Sciences | University of Cape Town | Health Sciences Campus, Anzio Road, Observatory, 7925 | Blog: https://electoralreform-ng.blogspot.com | UCT Email: OYNK...@myuct.ac.za +27(0)619507372 +27(0)736207568 +234(0)8038294995 \u201cAs you rise you must lift the others up\u201d -- Justice Skweyiya (RIP) On Sun, 11 Oct 2020, 01:07 Minh Bui, < minh...@univie.ac.at > wrote: Hi Kehinde, The outgroup is used merely for drawing purpose, i.e. you will still see a trifurcation around the node connecting outgroup and ingroup taxa. If you really want to have a bifurcation, use FigTree or other tree viewer software. Is that what you wondered about? Minh Dear Prof, I was thinking the tree will be rooted already without me needing to reroot in Figtree for instance. Even without specifying the outgroup. These taxa are still drawn outside. I thought after specifying the outgroup, the returned .treefile for instance, will be rooted. Many thanks. ", "I am trying to make rooted trees with iqtree such that when I read it into R with read.iqtree I will get something like : ...@ phylo: Phylogenetic tree with 608 tips and 607 internal nodes. Tip labels: Fusarium-oxysporum2, Fusarium-mangiferae3, Fusarium-avenaceum2, Fusarium-poae3, Nectria-haematococca3, Colletotrichum-graminicola, ... Node labels: , 97.2/98, 75.1/95, 85/97, 96/98, 81.9/93, ... Rooted; includes branch lengths. with the following features available: 'SH_aLRT', 'UFboot'. Also when I read same tree into R with read.tree, I will get this: Phylogenetic tree with 608 tips and 607 internal nodes. Tip labels: Fusarium-oxysporum2, Fusarium-mangiferae3, Fusarium-avenaceum2, Fusarium-poae3, Nectria-haematococca3, Colletotrichum-graminicola, ... Node labels: , 97.2/98, 75.1/95, 85/97, 96/98, 81.9/93, ... Rooted; includes branch lengths. Many thanks! Kehinde Adewole Oyeniran PhD Scholar | Computational Biology | Institute of Infectious Diseases and Molecular Medicine (IDM) | Faculty of Health Sciences | University of Cape Town | Health Sciences Campus, Anzio Road, Observatory, 7925 | Blog: www.electoralreform-ng.blogspot.com | UCT email: OYNK...@myuct.ac.za +27(0)619507372 +27(0)736207568 +234(0)8038294995 "]}, "f_ciZuIEJXU": {"topic": "Re: [iqtree] installation problem", "initializeDate": "Feb 9, 2017, 6:49:26 PM", "timeStamp": "Feb 9, 2017, 6:49:26 PM", "content": ["Dear Franz, This is because the current build folder already cached the previous compilers and setting CC, CXX does not have any effect. Alternatively you can set these variables: cmake -DIQTREE_FLAGS=omp -DCMAKE_C_COMPILER=clang-3.9 -DCMAKE_CXX_COMPILER=clang++-3.9 .. This will change the compilers for sure. Cheers, Minh On Feb 9, 2017, at 8:42 AM, 'Franz Krah' via IQ-TREE < iqt...@googlegroups.com > wrote: Hi all, I am trying to install IQ-Tree on my mac. Therefore I installed clang (3.9) following this protocol http://clang.llvm.org/get_started.html Then I ran the instructions on the IQ-tree website () CC=clang-3.7 CXX=clang++-3.7 cmake -DIQTREE_FLAGS=omp .. However, since in my folders there is clang-3.9 and only clang++ I changed it to CC=clang-3.9 CXX=clang++ cmake -DIQTREE_FLAGS=omp .. its not working... see output below.. If I download the 3.7 version, there is no clang-3.7 or clang++-3.7. So I am confused how to install this. Please help! Using the online version will not help... it allows only 8 MB. I have around 12... :-( And I got the following output: CC=clang-3.9 CXX=clang++ cmake -DIQTREE_FLAGS=omp .. sh: ps: command not found sh: ps: command not found -- The CXX compiler identification is Clang 3.9.0 -- Check for working CXX compiler: /Applications/clang+llvm-3.9.0-x86_64-apple-darwin/bin/clang++ sh: ps: command not found sh: ps: command not found -- Check for working CXX compiler: /Applications/clang+llvm-3.9.0-x86_64-apple-darwin/bin/clang++ -- broken CMake Error at /Applications/CMake.app/Contents/share/cmake-3.6/Modules/CMakeTestCXXCompiler.cmake:54 (message): The C++ compiler \"/Applications/clang+llvm-3.9.0-x86_64-apple-darwin/bin/clang++\" is not able to compile a simple test program. It fails with the following output: Change Dir: /Applications/IQ-TREE/build/CMakeFiles/CMakeTmp Run Build Command:\"/usr/bin/make\" \"cmTC_a6b3b/fast\" /Applications/Xcode.app/Contents/Developer/usr/bin/make -f CMakeFiles/cmTC_a6b3b.dir/build.make CMakeFiles/cmTC_a6b3b.dir/build Building CXX object CMakeFiles/cmTC_a6b3b.dir/testCXXCompiler.cxx.o /Applications/clang+llvm-3.9.0-x86_64-apple-darwin/bin/clang++ -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.11.sdk -o CMakeFiles/cmTC_a6b3b.dir/testCXXCompiler.cxx.o -c /Applications/IQ-TREE/build/CMakeFiles/CMakeTmp/testCXXCompiler.cxx Linking CXX executable cmTC_a6b3b /Applications/CMake.app/Contents/bin/cmake -E cmake_link_script CMakeFiles/cmTC_a6b3b.dir/link.txt --verbose=1 /Applications/clang+llvm-3.9.0-x86_64-apple-darwin/bin/clang++ -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.11.sdk -Wl,-search_paths_first -Wl,-headerpad_max_install_names CMakeFiles/cmTC_a6b3b.dir/testCXXCompiler.cxx.o -o cmTC_a6b3b clang-3.9: error: unable to execute command: Executable \"ld\" doesn't exist! clang-3.9: error: linker command failed with exit code 1 (use -v to see invocation) make[1]: *** [cmTC_a6b3b] Error 1 make: *** [cmTC_a6b3b/fast] Error 2 CMake will not be able to correctly generate this project. Call Stack (most recent call first): CMakeLists.txt:48 (project) -- Configuring incomplete, errors occurred! See also \"/Applications/IQ-TREE/build/CMakeFiles/CMakeOutput.log\". See also \"/Applications/IQ-TREE/build/CMakeFiles/CMakeError.log\". You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "nFY8x__mUdc": {"topic": "testing version 1.4.0-beta2", "initializeDate": "Feb 1, 2016, 6:18:46 AM", "timeStamp": "Feb 1, 2016, 6:18:46 AM", "content": ["Dear users, We have just released version 1.4.0-beta2 for testing purpose, which fixed an issue with the likelihood mapping feature: * Fix a bug in likelihood mapping (reported by Giap Nguyen) * Support partition models for likelihood mapping This version also merges recent bug fixes from ver. 1.3.12 and 1.3.13. More details: https://github.com/Cibiv/IQ-TREE/releases We appreciate if you continue to test and give us feedback. Best, IQ-TREE development team "]}, "olH0R9sdYNM": {"topic": "IQ-TREE release 1.6.9", "initializeDate": "Dec 19, 2018, 7:22:50 PM", "timeStamp": "Jan 31, 2019, 12:38:54 PM", "content": ["Dear Users, We\u2019re pleased to release the maintenance version 1.6.9 with one important bugfix. If you've already done the AU test with partition models in v1.6.8, please disregard the results and use this version. Sorry for the inconvenience. Bugfixes: \u2022 IMPORTANT: Incorrect AU test p-values with partition models, introduced in v1.6.8 (reported by Ales Bucek). \u2022 Crash in ModelFinder when having codon partitions with different genetic codes (reported by Morgan Jackson). \u2022 Crash with multiple runs option (--runs) and -bnni (reported by Vanessa Vera Fain). Other changes: \u2022 Better error checking for nexus partition file to prevent mis-specifying comma and semi-colon (reported by Denis Jacob Machado). \u2022 Safe writing checkpoint file via a temporary file (reported by Giuseppe Aprea and thanks Heiko). \u2022 -rcluster-max activates relaxed clustering algorithm without having to specify -rcluster. \u2022 --no-outfiles suppress .treefile as expected (reported by Cecile Ane). Cheers, Minh ", "Dear all, in earlier versoins it sometimes happened that, when you put in a file with trees to test (AUtest) several trees, e.g. best tree altern. tree 1 altern. tree 2 etc, the result was different from testing it seperately: test 1: best tree altern. tree 1 test 2: best tree altern. tree 2 is this still the case or has this been fixed? or when having several trees in one file, doe one have to apply whatever correction for multipe testing? (i try to figure out - also related to earlier verions except 1.6.8, e.g. 1.5, 1.4... if i would have to repeat the AU tests... - I always tested several trees in one file (1 tree per line). sorry in case this has been solved already. thanks Karen ", "Hi Karen, On 30 Jan 2019, at 4:40 am, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Dear all, in earlier versoins it sometimes happened that, when you put in a file with trees to test (AUtest) several trees, e.g. best tree altern. tree 1 altern. tree 2 etc, the result was different from testing it seperately: test 1: best tree altern. tree 1 test 2: best tree altern. tree 2 is this still the case or has this been fixed? Heiko can better answer here. But I think it\u2019s not unexpected that the results can be different from such tests. Same is true for other test. For example, SH test is known to reject less if there are more trees in the test set. Moreover, I think you should have all trees in the test, AU should do correction automatically. or when having several trees in one file, doe one have to apply whatever correction for multipe testing? (i try to figure out - also related to earlier verions except 1.6.8, e.g. 1.5, 1.4... if i would have to repeat the AU tests... - I always tested several trees in one file (1 tree per line). In the release note, I mark one important change: the AU p-values in version 1.6.9 are estimated my maximum likelihood method, whereas previous versions implemented the least-square estimates (for rationale see discussion https://github.com/Cibiv/IQ-TREE/issues/86 ). This implementation is now the same as the default of CONSEL. Therefore, the results can be different between 1.6.9 and previous versions. But generally the difference only occurs for two extremes, either when the logL differences are very small or very large. Nevertheless, I recommend to re-run the test if you can. Hope that this clarifies the issue. Minh sorry in case this has been solved already. thanks Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "ok many thanks - that helps (I did not use 1.6.8 for this) - also will wait for Heikos comment though :) Best, Karen Am Donnerstag, 31. Januar 2019 15:04:01 UTC+1 schrieb Minh Bui: Hi Karen, On 30 Jan 2019, at 4:40 am, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Dear all, in earlier versions it sometimes happened that, when you put in a file with trees to test (AUtest) several trees, "]}, "rwkt4aPOLsQ": {"topic": "Question re -fconst option", "initializeDate": "Mar 6, 2020, 7:45:39 AM", "timeStamp": "Mar 11, 2020, 3:54:37 AM", "content": ["Hi, I am running IQTree on the snippy-core output (core.aln) of ~200 staph aureus genomes. As I am using an alignment with the SNP sites only, I understand that I must use the -fconst option in order for my branches to be scaled correctly (is this correct?). My question is, how do I know what integer numbers to put after \"-fconst\" in my command? I understand that \"-fconst 10, 20, 15, 40\" relates to \"-fconst A, C, G, T\" but how do I know what exact numbers to use? My SNP site alignment is ~8000 nt and the staph aureus genome is ~2.8 MB, with a GC content of ~32% Any help would be really appreciated. Thanks, Megan ", "Hi Megan, On Fri, 6 Mar 2020 at 11:45 pm, Megan Earls < ear...@tcd.ie > wrote: Hi, I am running IQTree on the snippy-core output (core.aln) of ~200 staph aureus genomes. As I am using an alignment with the SNP sites only, I understand that I must use the -fconst option in order for my branches to be scaled correctly (is this correct?). Yes that\u2019s correct, but Iq-tree can still do ascertainment bias correction automatically to account for the absence of invariant sites. My question is, how do I know what integer numbers to put after \"-fconst\" in my command? I understand that \"-fconst 10, 20, 15, 40\" relates to \"-fconst A, C, G, T\" but how do I know what exact numbers to use? My SNP site alignment is ~8000 nt and the staph aureus genome is ~2.8 MB, with a GC content of ~32% Any help would be really appreciated. That\u2019s I don\u2019t know, perhaps this snippy program can tell you with some option? In case that\u2019s not possible, the ASC model mentioned above can be used Minh Thanks, Megan You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/802904d7-de67-49d4-95c6-da5485d1f507%40googlegroups.com ", "Hi Minh, Thank you for your response. I will check snippy for that detail. Re the +ASC option, I ran the following command: iqtree -s core.aln -m GTR+ASC And the tree turned out pretty much as expected. But how did the branch scaling get corrected when the I never told IQTree the number of invariant site or the size of the genome? Thanks, Megan ", "Hi Megan, This \u201cmystery\u201d was explained in a great paper by Paul Lewis: https://doi.org/10.1080/106351501753462876 IQ-TREE implemented exactly this correction. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/284bb805-4634-4162-8f37-71e163a497fe%40googlegroups.com ", "Thank you! On Friday, March 6, 2020 at 12:45:39 PM UTC, Megan Earls wrote: "]}, "DThHo4qdtUo": {"topic": "specifying partition schemes for locus trees", "initializeDate": "Mar 7, 2019, 3:38:14 PM", "timeStamp": "Aug 19, 2019, 7:57:03 PM", "content": ["Dear IQ-tree developers, When using the -S method to calculate locus trees across a directory of alignments, is it possible to specify accompanying directory of partition schemes for each locus? Best, Jake Berv ", "Hi Jake, There is no such option. But you can manually divide each locus into different files. Why do you need to further partition single locus? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "This could probably be useful for partitioning among codon positions for protein coding genes, or for partitioning with schemes that group sites by site rates. I suspect that if you have codon information, you can probably generate more accurate gene or locus trees by using that information. Best, Jake ", "I see, then I suggest the simplest way is to prepare a partition file, where you can embed the individual alignment file names. See this doc here: http://www.iqtree.org/doc/Complex-Models#partition-models . For example: #nexus begin sets; charset part1 = aln1.phy: 1-100\\3 201-300; charset part2 = aln1.phy: 101-200; charset part3 = aln2.phy: *; end; This partition file can also be input via -S option. Minh ", "Hey Minh Is this possible in partitions file for a protein coding gene? nad5_1ndpos = 9001-10704\\3 nad5_2ndpos = 9002-10704\\3 nad5_3rdpos = 9003-10704\\3 Regards Jigyasa On Friday, March 8, 2019 at 11:36:30 AM UTC+9, Minh Bui wrote: I see, then I suggest the simplest way is to prepare a partition file, where you can embed the individual alignment file names. See this doc here: http://www.iqtree.org/doc/Complex-Models#partition-models . For example: #nexus begin sets; charset part1 = aln1.phy: 1-100\\3 201-300; charset part2 = aln1.phy: 101-200; charset part3 = aln2.phy: *; end; This partition file can also be input via -S option. Minh On 8 Mar 2019, at 10:07 am, Jacob Berv < jaco...@gmail.com > wrote: This could probably be useful for partitioning among codon positions for protein coding genes, or for partitioning with schemes that group sites by site rates. I suspect that if you have codon information, you can probably generate more accurate gene or locus trees by using that information. Best, Jake On Mar 7, 2019, at 5:37 PM, Minh Bui < min...@univie.ac.at > wrote: Hi Jake, There is no such option. But you can manually divide each locus into different files. Why do you need to further partition single locus? Minh On 8 Mar 2019, at 7:38 am, Jacob Berv < jaco...@gmail.com > wrote: Dear IQ-tree developers, When using the -S method to calculate locus trees across a directory of alignments, is it possible to specify accompanying directory of partition schemes for each locus? Best, Jake Berv You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Yes, That\u2019s possible. Please look carefully at the URL you forwarded. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8c9c3034-a0db-4566-9f13-111b0f8770af%40googlegroups.com "]}, "DVGjsri9BOk": {"topic": "ERROR: Fixing branch lengths not supported under specified site rate model", "initializeDate": "Jan 30, 2019, 6:46:01 AM", "timeStamp": "Jan 31, 2019, 9:07:28 AM", "content": ["I keep getting this error when trying to run the analysis (i only need to get the best models for 3 partitions in my dataset) and I don't seem to be able to 'unfix' branch lengths anywhere... What might the solution be? ", "Hi, I\u2019m not 100% sure, but did you use the edge-equal partition model (-q option)? If yes, then simply do edge-proportion model instead (-spp) should fix it. This is actually the recommended setting for partition analysis: http://www.iqtree.org/doc/Complex-Models#partition-models Cheers, Minh On 30 Jan 2019, at 10:46 pm, Sofiia Kolchanova < 19rub...@gmail.com > wrote: I keep getting this error when trying to run the analysis (i only need to get the best models for 3 partitions in my dataset) and I don't seem to be able to 'unfix' branch lengths anywhere... What might the solution be? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "I7qrdcSPK8s": {"topic": "MODELFINDER not testing all the models", "initializeDate": "Sep 25, 2020, 5:17:19 AM", "timeStamp": "Sep 30, 2020, 12:08:18 AM", "content": ["Hi, I've been running two versions of iqtree, version 1and version version , both for Linux 64-b it built. I'm using the flag \"-m TEST\" to have MODELFINDER test for standard model selection, with the command : for iqtree 1.6.1 : iqtree -nt AUTO -s input.fasta -m TEST -seed 10101 Seed: 10101 for iqtree 2.0.6: iqtree2 -nt AUTO -s input.fasta -m TEST Seed: 316299 In the log files, I get different outputs for ModelFinder: for iqtree 1.6.1 : ModelFinder will test DNA models (sample size: 1901 ) ... --> all 88 models tested for iqtree 2.0.6: ModelFinder will test up to DNA models (sample size: 1901 ) ... --> only 25 models tested This issue has been happening with different datasets, and even using the default ModelFinder command. I'd like to know if this is a bug, or if iqtree 2 implements a faster way of running ModelFinder without having to test all possible models. Many thanks in advance for your help, Paul ", "Hi Paul, It\u2019s all good. IQ-TREE 2 has a heuristic to filter out non-promissing models, before having to evaluate them. That\u2019s why the \u201cup to\u201d is added to the phrase. So it\u2019s not a bug, but a feature. We are still preparing a manuscript about ModelFinder2 with all these heuristics to be described. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4fb0dcfe-0ed4-4ee1-864f-65c322911e9dn%40googlegroups.com "]}, "OOg8oi4GIcI": {"topic": "Number of parameters and sample size", "initializeDate": "Mar 29, 2019, 1:24:32 PM", "timeStamp": "Apr 9, 2019, 8:23:49 PM", "content": ["Hello, My Sample size (n, alignment length) is 258 (I can not have nothing better because I'm trimming the MSA, and the rest of the regions have not nice alignments). I've 345 sequences. The comand that I use is: iqtree -s 030119_0777.fas -nt AUTO -bb 1000 -alrt 1000 -mset JTT,LG,WAG,Blosum62,VT,Dayhoff -mfreq F -mrate R -bnni MAXIMUM LIKELIHOOD TREE Log-likelihood of the tree: -23692.5597 (s.e. 1985.7231) Unconstrained log-likelihood (without tree): -1393.1406 Number of free parameters (#branches + #model parameters): 714 Akaike information criterion (AIC) score: 48813.1194 Corrected Akaike information criterion (AICc) score: 1069833.1194 Bayesian information criterion (BIC) score: 51349.9326 Then, I've got the Warning message : Number of parameters (K, model parameters and branch lengths): 714 Sample size (n, alignment length): 258 Given that K>=n, the parameter estimates might be inaccurate. Thus, phylogenetic estimates should be interpreted with caution. .... Here are my questions: - Do you suggest to \"Specify the parameter values for the rates-across-sites model (e.g., the shape parameter for the discrete Gamma distribution, the proportion of invariable sites, or the rates of change for different rate categories under the FreeRate model). How can I do this? - May I be in a better situation if I use Codon aligments, then my sample size will be 3 times bigger? - How can I use the Log-likelihood of the tree and BIC to understand if I'm getting a \"good\" tree or not? Thank you a lot Romina Fox ", "Hi Romina, On 30 Mar 2019, at 4:24 am, foxromina < foxr...@gmail.com > wrote: Hello, My Sample size (n, alignment length) is 258 (I can not have nothing better because I'm trimming the MSA, and the rest of the regions have not nice alignments). I've 345 sequences. The comand that I use is: iqtree -s 030119_0777.fas -nt AUTO -bb 1000 -alrt 1000 -mset JTT,LG,WAG,Blosum62,VT,Dayhoff -mfreq F -mrate R -bnni MAXIMUM LIKELIHOOD TREE Log-likelihood of the tree: -23692.5597 (s.e. 1985.7231) Unconstrained log-likelihood (without tree): -1393.1406 Number of free parameters (#branches + #model parameters): 714 Akaike information criterion (AIC) score: 48813.1194 Corrected Akaike information criterion (AICc) score: 1069833.1194 Bayesian information criterion (BIC) score: 51349.9326 Then, I've got the Warning message : Number of parameters (K, model parameters and branch lengths): 714 Sample size (n, alignment length): 258 Given that K>=n, the parameter estimates might be inaccurate. Thus, phylogenetic estimates should be interpreted with caution. All I can say, is that you\u2019re dealing with difficult data, simply because of small sample size\u2026 but some hints below. Here are my questions: - Do you suggest to \"Specify the parameter values for the rates-across-sites model (e.g., the shape parameter for the discrete Gamma distribution, the proportion of invariable sites, or the rates of change for different rate categories under the FreeRate model). How can I do this? I wouldn\u2019t recommend to do so, just let IQ-TREE estimate these parameters from your data. But if you insist: yes you can specify those parameters, see: http://www.iqtree.org/doc/Substitution-Models#rate-heterogeneity-across-sites - May I be in a better situation if I use Codon aligments, then my sample size will be 3 times bigger? You can try to analyse the DNA data that way. But better would be: (i) add more genes or (ii) reduce the number of sequences or both. For (ii), you can for example cluster sequences with some identity threshold and then infer a tree from representatives of each cluster. For 16S DNA people typically use the 96% identity threshold for this purpose. - How can I use the Log-likelihood of the tree and BIC to understand if I'm getting a \"good\" tree or not? Well, you can't say anything about this. What I would do, is to invoke several runs (with --runs 10 option) and look at the 10 resulting trees. You can then perform SH or AU test with the 10 trees. If none is rejected, then I\u2019d have to accept that all 10 trees can explain the data well. Hope that helps a little. Minh Thank you a lot Romina Fox You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hello Minh, I'm trying to follow your advise but I've a new problem... I invoked several runs as you suggested (with --runs 10 option) and I got a file .runtrees Now I want to perform the AU test but I don't know how to do it because there is not an example in the manual. I only find the following command: iqtree -s example.phy -m TIM2+I+G -z example.treels -n 0 -zb 1000 -au but I already perform the -m action and then I think that this is not good for me. I try some modifications but they didn't work out. Can you tell me how to run the AU test from the .runtrees file? Thank you, Romina ", "Hi Romina, From the previous run you will find the name of the best model from .iqtree file. Then use this model name for -m option, and .runtrees for -z option, in your pasted command line. Cheers, Minh "]}, "A6Oeke1PwnY": {"topic": "Extra values in bootstrap support?", "initializeDate": "Jan 12, 2018, 3:23:23 PM", "timeStamp": "Jan 22, 2018, 9:32:33 PM", "content": ["Hello, I've been using iqtree on a protein dataset (single gene). I'm using the SH-aLRT and UFBoot to compute node support values, but curiously there's three values appearing the bootstrap location rather than 2. I'm using a starting ML tree that I built beforehand using Fasttree. The output file lists only SH-aLRT/UFBoot as the values, but there is a third value that proceeds these two in the actual tree and it is a proportion (between 0-1). See below. Parameters of my run: \"iqtree -s my_alignment.fas -m WAG+R7 -t my_tree.newick -pers 0.2 -nstop 500 -bb 1000 -alrt 1000 From the .iqtree file: \"Numbers in parentheses are SH-aLRT support (%) / ultrafast bootstrap support (%)\" +--Penicillium-brasilianum | +--| (0.780/100/100) | | +--Penicillium-subrubescens | +--| (0.987/91.8/98) | | | +--Penicillium-antarcticum | | +--| (0.513/81.7/100) I've sifted the documentation and papers for UFBoot but can't seem to figure out where this extra value is coming from. Thanks, Will ", "Hi Will, Sorry I somehow overlooked your message. The first number seems to come from the tree file (my_tree.newick) that you input as the starting tree. Can you check this, just to be sure? IQ-TREE could detect this, and then append SH-aLRT and UFBoot values onto the branches so that existing values are not destroyed. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Yes, I tried running the same alignment with no starting tree and I only get 2 support values, so it seems the first value was from my starting tree... curious. Cheers, Will On Mon, Jan 22, 2018 at 7:33 PM, Bui Quang Minh minh...@univie.ac.at wrote: Hi Will, Sorry I somehow overlooked your message. The first number seems to come from the tree file (my_tree.newick) that you input as the starting tree. Can you check this, just to be sure? IQ-TREE could detect this, and then append SH-aLRT and UFBoot values onto the branches so that existing values are not destroyed. Cheers, Minh On 13 Jan 2018, at 7:23 AM, Will Chase < wcha...@gmail.com > wrote: Hello, I've been using iqtree on a protein dataset (single gene). I'm using the SH-aLRT and UFBoot to compute node support values, but curiously there's three values appearing the bootstrap location rather than 2. I'm using a starting ML tree that I built beforehand using Fasttree. The output file lists only SH-aLRT/UFBoot as the values, but there is a third value that proceeds these two in the actual tree and it is a proportion (between 0-1). See below. Parameters of my run: \"iqtree -s my_alignment.fas -m WAG+R7 -t my_tree.newick -pers 0.2 -nstop 500 -bb 1000 -alrt 1000 From the .iqtree file: \"Numbers in parentheses are SH-aLRT support (%) / ultrafast bootstrap support (%)\" +--Penicillium-brasilianum | +--| (0.780/100/100) | | +--Penicillium-subrubescens | +--| (0.987/91.8/98) | | | +--Penicillium-antarcticum | | +--| (0.513/81.7/100) I've sifted the documentation and papers for UFBoot but can't seem to figure out where this extra value is coming from. Thanks, Will You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/A6Oeke1PwnY/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Will Chase Research Assistant Cosgrove lab 352 North Frear Building The Pennsylvania State University "]}, "bm40rWqANI8": {"topic": "Manual outgroup", "initializeDate": "May 1, 2017, 7:02:37 PM", "timeStamp": "May 2, 2017, 8:14:53 AM", "content": ["Hi IQ-TREE, Hope this email finds you well. Is there any manual way to indicate an outgroup from my input fasta file (in the Web-Application)? Looking forward to your reply! Regards, Taek ", "Hi Taek, there is no such specific option from http://iqtree.cibiv.univie.ac.at , but you can move the outgroup sequence as the first sequence in your fasta file. By default IQ-TREE takes it as outgroup when writing tree file. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "HLhTbmYwdoE": {"topic": "Eigensystem doesn't satisfy eigenvalue equation", "initializeDate": "Feb 20, 2017, 9:19:38 AM", "timeStamp": "Feb 21, 2017, 11:59:05 AM", "content": ["Hello, I'm working with a small alignment (75 sites) and 195 protein sequences, using -m LG+I+G -nt 16 -bb 1000 but i got the following error: WARNING: Eigensystem doesn't satisfy eigenvalue equation! (gap=4.09493) iqtree-omp: /home/CIBIV/minh/Dropbox/iqtree-git/eigendecomposition.cpp:271: void EigenDecomposition::eigensystem_sym(double**, double*, double*, double*, double*, int): Assertion `error < 1e-2' failed. STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: Rad23_modif2.gap3.prueba.log *** Alignment files (if possible) Aborted Any idea about what's going on? Thanks ", "Dear Rafael, this crash is indeed weird. Can you please send me the log file and alignment via personal email? Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "hwz2is9vSNc": {"topic": "fixed user tree evaluation", "initializeDate": "Apr 1, 2016, 12:16:56 PM", "timeStamp": "Apr 2, 2016, 3:49:03 PM", "content": ["Dear developers, I was using the \"-te\" option to evaluate trees, and sometimes the output tree (in the \".treefile\" file) has different topology from the input tree. Am I missing something, or is this caused by (near-)zero length branches in the tree? Anyway, such changes in topology might cause problem for other analyses. I have attached one such data set as example. Could you take a look at this? Thanks very much! Best, Xiaofan ", "Dear Xiaofan, thanks for reporting this problem. It was because: NOTE: 2 identical sequences (see below) will be ignored for subsequent analysis NOTE: Homo (identical to Pongo) is ignored but added at the end NOTE: Pan (identical to Macaca) is ignored but added at the end (extracted from the log file). Here IQ-Tree internally ignores Homo and Pan at the beginning of the analysis, and then adds them back at the end in the corresponding clade. However, in your case when evaluating user trees, IQ-Tree should not do this. I will change the behavior in the next release. As a work around for now, please add option: -keep-ident Keep identical sequences (default: remove & finally add) This should solve it. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout > <example.tar.gz> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Thanks for the explanation, using -keep-ident did solve the problem! Another question, just curious, by using '-keep-ident', the branches leading to Homo and Pan now each has a length of 0.000003, while they were zero-length without '-keep-ident'. Is this by design? Best, Xiaofan ", "yes that\u2019s right, branch lengths in such case have to be strictly positive for numerical reason. Minh "]}, "1BVY6C-81ic": {"topic": "Implementation of combined mixture models (e.g. JTT+UL3+G)", "initializeDate": "Nov 15, 2017, 12:08:58 PM", "timeStamp": "Dec 12, 2017, 10:25:23 AM", "content": ["Dear IQ-tree users/teams, A) I have a case where the best fit amino acid models for my dataset is JTT+UL3+G, and wished to enquire about its behaviour. Does this become a 4-matrix model (JTT+buried+intermediate+exposed), or are the three mixtures of UL3 replaced with independent JTT matrices? I am assuming this is more like the later case; if so, just for clarity, this would then mean that say, JTT+EX3+G and JTT+UL3+G would be effectively the same model? B) Similarly, is this behaviour the same for other n-matrix models (UL2,EX2,EX3,EHO,EX_EHO)? With CF4 on the other hand sharing behaving more like C10-60? Thank you! Anthony ", "Hi Anthony, That\u2019s an interesting question. In fact I never considered such mixture combination before. It is possible but with some change in model specification: On Nov 15, 2017, at 6:08 PM, Anthony Redmond < anthon...@gmail.com > wrote: Dear IQ-tree users/teams, A) I have a case where the best fit amino acid models for my dataset is JTT+UL3+G, and wished to enquire about its behaviour. Does this become a 4-matrix model (JTT+buried+intermediate+exposed), or are the three mixtures of UL3 replaced with independent JTT matrices? I am assuming this is more like the later case; if so, just for clarity, this would then mean that say, JTT+EX3+G and JTT+UL3+G would be effectively the same model? 1. I\u2019m not sure why JTT+UL3+G was the best-fit model, but a simple run with option \"-m JTT+UL3+G\u201d, IQ-TREE ignores +UL3 in the model string. Thus it is equivalent to -m JTT+G. 2. Likewise, if you do -m UL3+JTT+G, then IQ-TREE ignores +JTT, resulting in UL3+G model instead. 3. If you want to really do a 4-class mixture model, then you need to specify this: iqtree -m 'MIX{JTT,Q1_UL3,Q2_UL3,Q3_UL3}+G' ... Note that the model string must be rounded by quote. For other combination: you can look at the line like this in the log file when running with -m JTT+UL3+G: Model JTT+UL3+G is alias for JTT+MIX{Q1_UL3:0.484340397,Q2_UL3:0.492780514,Q3_UL3:1.15597274}+G And then rename the model string the way I described above. B) Similarly, is this behaviour the same for other n-matrix models (UL2,EX2,EX3,EHO,EX_EHO)? Yes, the same behavior for other mixture models you listed. With CF4 on the other hand sharing behaving more like C10-60? Yes, CF4 has a different behavior, just like C10 to C60. Hope that helps, Minh Thank you! Anthony You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Sorry for the delay in my reply and thank you for your help. Just a thought on your answers: I'm delighted that IQ-tree allows the user to specify a model like 'MIX{JTT,Q1_UL3,Q2_UL3,Q3_UL3} +G', but it does not seem to be possible to compare the fit of a mixture of this type against a standard JTT+G, or UL3+G model with IQ-tree/ModelFinder. It might be interesting if something akin to this were possible in future versions as some alignment sites could presumably be better modelled in this way. Thanks again for your help, Anthony ", "Dear Anthony, We are working towards a more flexible ModelFinder, i.e., allowing to test different kinds of mixture models. This will hopefully come with version 1.6. Cheers, Minh ", "Dear Minh, Sounds great! Thanks again, Anthony "]}, "BJsZmUUNMVM": {"topic": "assign weigths to columns", "initializeDate": "Oct 21, 2020, 11:38:31 AM", "timeStamp": "Oct 26, 2020, 5:25:54 PM", "content": ["Hi, Is there a way to assign individual weights to each column of the alignment, as with the flag \"- a\" in RAxML? If not, I think it it would be a great improvement to the software, especially for morphological data. Thanks, Paul ", "Hi Paul, This option is not available. In fact I\u2019m not aware of -a option in RAxML. But you can manually duplicate columns in the alignment, before running IQ-TREE, right? Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d50ece73-cc7a-470e-86d5-1cde4ee64fafn%40googlegroups.com ", "Hi Minh, Yes, that was my plan B, thanks! Cheers, Paul ", "cheers. Sent from my Verizon, Samsung Galaxy smartphone To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9f816bea-7399-4e6c-b66c-4e0635a15630n%40googlegroups.com "]}, "5wJYRslXZCQ": {"topic": "Rooted constraint tree not accepted in v1.6 but not in v2.0?", "initializeDate": "May 8, 2020, 9:23:54 PM", "timeStamp": "May 13, 2020, 7:32:07 PM", "content": ["Hi all, I was trying to make run iqtree v1.6.11 using a rooted guide tree \"((1,2),(3,4));\" with the command \"iqtree -s -m LG+G+I -g topo.tre\". However, I was only told that \"ERROR: Rooted constraint tree not accepted \". When I tried with an unrooted tree, \"(1,2,(3,4));\", a different error message was shown: ERROR: Initial tree is not compatible with constraint tree (which I think could be solved by \"-te\"?). Interestingly, iqtree v2.0 did not give me any problem with the same command in either case. I was wondering whether this is a new feature for v2.0 and if so maybe it is suggested to use v2.0 for constrained tree search? Or was there anything with my inputs? Thanks. Sishuo ", "Hi Sishuo, On 9 May 2020, at 11:23 am, Sishuo Wang < tomas...@gmail.com > wrote: Hi all, I was trying to make run iqtree v1.6.11 using a rooted guide tree \"((1,2),(3,4));\" with the command \"iqtree -s -m LG+G+I -g topo.tre\". However, I was only told that \"ERROR: Rooted constraint tree not accepted I believe this restriction was lifted in v1.6.12. Rooted constraint will be converted to unrooted. When I tried with an unrooted tree, \"(1,2,(3,4));\", a different error message was shown: ERROR: Initial tree is not compatible with constraint tree (which I think could be solved by \"-te\"?). Well, the error is informative. your initial tree (input via -t or -te) has some branch that conflicts with the constraint tree, and IQ-TREE refuses to continue, of course. Interestingly, iqtree v2.0 did not give me any problem with the same command in either case. I was wondering whether this is a new feature for v2.0 and if so maybe it is suggested to use v2.0 for constrained tree search? Or was there anything with my inputs? Thanks. See above, about lifted restriction. Nevertheless I recommend to use v2.0 for constraint tree search. Because implements a much quicker algorithm to build the starting trees to be fully compatible with the constraint. Cheers Minh Sishuo You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/41e7361e-5ef6-4d0f-aae8-b7708223c344%40googlegroups.com <topo.unrooted.tre> <topo.tre> <combined.aln> ", "Hi Minh, Thank you so much! Cheers, Sishuo \u5728 2020\u5e745\u670811\u65e5\u661f\u671f\u4e00 UTC+8\u4e0a\u53488:17:43\uff0cMinh Bui\u5199\u9053\uff1a Hi Sishuo, On 9 May 2020, at 11:23 am, Sishuo Wang < tomas...@gmail.com > wrote: Hi all, I was trying to make run iqtree v1.6.11 using a rooted guide tree \"((1,2),(3,4));\" with the command \"iqtree -s -m LG+G+I -g topo.tre\". However, I was only told that \"ERROR: Rooted constraint tree not accepted I believe this restriction was lifted in v1.6.12. Rooted constraint will be converted to unrooted. When I tried with an unrooted tree, \"(1,2,(3,4));\", a different error message was shown: ERROR: Initial tree is not compatible with constraint tree (which I think could be solved by \"-te\"?). Well, the error is informative. your initial tree (input via -t or -te) has some branch that conflicts with the constraint tree, and IQ-TREE refuses to continue, of course. Interestingly, iqtree v2.0 did not give me any problem with the same command in either case. I was wondering whether this is a new feature for v2.0 and if so maybe it is suggested to use v2.0 for constrained tree search? Or was there anything with my inputs? Thanks. See above, about lifted restriction. Nevertheless I recommend to use v2.0 for constraint tree search. Because implements a much quicker algorithm to build the starting trees to be fully compatible with the constraint. Cheers Minh Sishuo You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "Q8W5KQOPiag": {"topic": "ERROR: Tree file does not start with an opening-bracket", "initializeDate": "Jan 16, 2019, 3:07:38 AM", "timeStamp": "Jan 16, 2019, 1:57:14 PM", "content": ["Hi Minh, I've received the same error message about an opening bracket posted by Mark Miller and others. In this case it was early in step 2 of the analyses to find gCF and sCF (e.g., in the search started with ' iqtree -S ALN_DIR --prefix loci -nt 10 ') after the initial parsimony tree was created. I've attached the log and parstree files. Cheers, Sarah ", "Hi Sarah, This is actually a different issue, -nt AUTO does not work yet with the new -S option in the beta version 1.7. So pls specify the number of cores explicitly. We will fix this before the official release. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <loci.log> <loci.parstree> ", "Hi Minh, Thanks, I do remember reading that. I\u2019ll set number of cores. Cheers Sarah Sent from my iPhone "]}, "Lb6Dt6de_as": {"topic": "IQ-Tree release 1.3.2", "initializeDate": "Jun 11, 2015, 11:58:56 AM", "timeStamp": "Jun 11, 2015, 11:58:56 AM", "content": ["Dear IQ-Tree users, We are pleased to announce version 1.3.2 with substantial improvements: Reduce memory requirement by a factor of 3 (e.g. from 60 GB down to 20 GB) Increased performance of multicore version. Increased performance of edge-linked partition models. 32-bit version is finally supported. Happy computing! Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at "]}, "v9d8q2uNxI0": {"topic": "query regarding ancestral reconstruction", "initializeDate": "Mar 16, 2021, 2:51:15 AM", "timeStamp": "Mar 18, 2021, 1:46:29 AM", "content": ["Dear all, Nowadays ancestral reconstruction is a trending process to speculate the biochemical state of a particular protein in the past. I tried to reconcile papers related to ancestral reconstruction, but it has a lot of mathematics and it is hard to follow them after some time. I have a few questions regarding the fundamental understanding of how does this method work. 1. For a given phylogenetic tree, what does it mean by an ancestor with respect to the evolutionary time scale. 2. How do I get the philosophy of the ancestral reconstruction without going into detail mathematics. 3. How to judge your ancestral sequence is meaningful or no? Kind of cutoff value or anything else. Any valuable suggestions will be appreciated. ------------------------------------------------------------------------------------------------------ Raghvendra Singh D.Phil. SERB-National Post-Doc Fellow C/o Dr. R Sankaranarayanan Structural Biology Lab CSIR-Centre for Cellular and Molecular Biology Uppal Road, Hyderabad - 500 007 ", "HI there, If you want to a less mathy explanation of ancestral state reconstruction, look at chapter 6 of Inferring Phylogenies (Felsenstein) for a parsimony method. But IQ-TREE implemented a maximum likelihood method. Look at chapter 16, section \u201cInferring ancestral sequences\u201d, p. 259. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAP7cDT_R2QZrOs6Hv7X7S%3D%3DEG2HhZcWEe7BaedWewRPqJynDfQ%40mail.gmail.com "]}, "ZxrAty8br0E": {"topic": "BUG: IQTree 2.1.12 fails to run on input with ERROR: Tree taxa and alignment sequence do not match (see above)", "initializeDate": "Oct 27, 2020, 3:50:42 AM", "timeStamp": "Dec 3, 2020, 9:23:40 AM", "content": ["Hey Minh, I have found an interesting bug with IQTree 2.1.2 that is not present in 2.0.6 or 1.6.12. Please reach out to me if the input I used with full logs is needed. Expected Behavior: IQTree runs on the input.fasta file. BUG: input.fasta runs successfully on IQTree 1.6.12 but not on 2.1.2. Detailed Description: input.fasta has 6 sequences. When IQTree 1.6.12 is run using input.fasta as input, the program runs successfully. However when IQTree 2.1.2 is run using the same input, the bionj tree computed only contains four taxa and IQTree fails to run. Seed was fixed to be 10101, and I've tested on three different platforms with the same results every time. The sequences are not identical and therefore I don't think -keep-ident option would help in this case. I can confirm that in IQTree version 2.0.6, the same input.fasta runs successfully with no issues. Relevant Lines: WARNING: Some pairwise ML distances are too long (saturated) Computing RapidNJ tree took 0.000036 sec (of wall-clock time) 0.000063 sec (of CPU time) ERROR: Alignment sequence WXCBW does not appear in the tree ERROR: Alignment sequence ELFQP does not appear in the tree ((LOFIF,TXTZE),VNDFT,VLAZJ); ERROR: Tree taxa and alignment sequence do not match (see above) Commands: ./iqtree-1.6.12-Linux/bin/iqtree -s input.fasta -seed 10101 -pre 1.6.12_run ./iqtree-2.1.2-Linux/bin/iqtree2 -s input.fasta -seed 10101 -pre 2.1.2_run Platform: Linux 4.15.0-118-generic #119-Ubuntu SMP Tue Sep 8 12:30:01 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux User Specified Seed: 10101 Thanks, Min ", "Made a github issue with the files attached in the github issue. https://github.com/Cibiv/IQ-TREE/issues/175#issue-730208466 ", "James, can you please look at this? It looks like something to do with the new code on distance based methods\u2026 Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6c2332ec-3075-428c-8966-3baaee376741n%40googlegroups.com "]}, "uc1OUGGcMFc": {"topic": "\"-sup command\": more (informative) options?", "initializeDate": "Mar 2, 2015, 12:06:26 AM", "timeStamp": "Mar 4, 2015, 6:20:08 PM", "content": ["Hello, I\u00b4m testing the IQTREE options, and I think that one nice option would be even more informative (in p19 the manual said): \"Finally, an useful feature is to read in an input tree and a set of trees, then IQ-TREE can assign the support value onto the input tree (number of times each branch in the input tree occurs in the set of trees) by: iqtree -sup input_tree set_of_trees\" I think it would be useful (and informative) to identify from which tree (from the set_of_trees file) a certain branch is represented. This idea comes from the navajo rug strategy (something like the cladescan approach https://rc.fas.harvard.edu/resources/documentation/software/cladescan/ )... maybe a combined result would be informative too! (% from total trees@and tree(s) order(s) in the mentioned set_of_trees file: 75@1@2@4 -considering a total of 4 trees-). Best, max ", "Dear Max, such an option should be relatively easy to implement. Just to be sure: I can append node labels with \u2018@id\u2019 series, where id is the index of tree where the corresponding clade occurs. Such information can then be viewed with tree viewing programs like Figtree. When do you want to use such feature? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Hello Minh, thanks for the fast response! Besides FigTree, I prefer the TreeGraph program http://treegraph.bioinfweb.info/ I would like to use the aforementioned option with the -sup command, maybe adding an extra tag, being explicit that we want to identify the @tree(s) where a certain branch is represented.... example normal way iqtree -sup input_tree set_of_trees with a tag for \"extra info\" iqtree -sup @tag input_tree set_of_trees I think this options would be useful to compare_summarize a main result (\"input_tree\"; eg, a multilocus analysis) with several types of \"set_of_trees\", like 1. single gene analysis; 2. traditional (previous) systematic proposals for the group; 3. alternative results, i) using different evolutionary models, ii) partitioned vs non-partitioned datasets, iii) masking vs non-masking datasets. In most cases, differences between some alternative topologies are concentrated just in some branches: that\u00b4s the reason why I think it would be useful to \"tag\" these differences. Others options I think would be interesting to see in IQTREE: > Partitioned support (like raxml\u00b4s option \"-f J\" combined with \"-M\" for Sh-like support) > alRT and aBAYES support method (from PhyML), including a partitioned version. Best, max You received this message because you are subscribed to a topic in the Google Groups \"IQTREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/uc1OUGGcMFc/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com ", "Dear Max, I added this into the TODO list. Will get back to you in case something pops up. Cheers, Minh ", "Hello Minh, great! Thanks for your fast response (and interest in our opinions)!!! best, max "]}, "6_sAl1EXTTc": {"topic": "C60 and H4", "initializeDate": "Oct 19, 2018, 9:41:38 AM", "timeStamp": "Oct 29, 2018, 4:52:38 AM", "content": ["Hey all: We are trying to analyze several large phylogenomic datasets and would like to incorporate site-heterogeinity models into our model test. Here is the command we are using: ```iqtree -s $FILENAME -nt 20 -bb 1000 -mset LG,WAG,GTR20 -madd GTR20+C60+F+G,WAG+C60+F+G,LG+C60+F+G,GTR20+C60+F+G,LG+FO*H4,WAG+FO*H4,GTR20+F0*H4 -pre $FILENAME.iqtree``` Some analyses are finished but they always suggest WAG+C60+F+G is the best fitting model compared to others. I looked the log file and it mentioned \"Model WAG+C60+F+G is alias for WAG+POISSON+G+FMIX\". The default of C60 is poisson model but why it becomes a mix model when I specify using WAG substitution model? Another waring message I got is WARNING: The mixture model might be overfitting because some mixture weights are estimated close to zero. Does this mean the C60 has too many categories that the data has? I have put the log file in the attachment if that will help. Thanks a lot, Best, ", "Hi Li, On 20 Oct 2018, at 12:41 am, yl2...@yale.edu wrote: Hey all: We are trying to analyze several large phylogenomic datasets and would like to incorporate site-heterogeinity models into our model test. Here is the command we are using: ```iqtree -s $FILENAME -nt 20 -bb 1000 -mset LG,WAG,GTR20 -madd GTR20+C60+F+G,WAG+C60+F+G,LG+C60+F+G,GTR20+C60+F+G,LG+FO*H4,WAG+FO*H4,GTR20+F0*H4 -pre $FILENAME.iqtree``` The log file shows that the run successfully finished for such complicated analysis! Some analyses are finished but they always suggest WAG+C60+F+G is the best fitting model compared to others. I looked the log file and it mentioned \"Model WAG+C60+F+G is alias for WAG+POISSON+G+FMIX\". The default of C60 is poisson model but why it becomes a mix model when I specify using WAG substitution model? That\u2019s alright. WAG+C60+F+G is a mixture model which replaces the Poison matrix by WAG. When IQ-TREE writes \"WAG+POISSON+G+FMIX\u2026\u201d, the rate matrix will be set to WAG as it appears in front of the model string. Another waring message I got is WARNING: The mixture model might be overfitting because some mixture weights are estimated close to zero. Does this mean the C60 has too many categories that the data has? Yes, indeed one of the mixture weight estimates is zero: Mixture weights: 0.041 0.024 0.008 0.018 0.026 0.016 0.007 0.006 0.013 0.002 0.018 0.049 0.013 0.007 0.011 0.003 0.004 0.016 0.031 0.004 0.005 0.002 0.041 0.012 0.001 0.016 0.015 0.029 0.024 0.013 0.032 0.014 0.006 0.018 0.048 0.031 0.031 0.018 0.012 0.005 0.024 0.006 0.007 0.074 0.008 0.016 0.000 0.011 0.017 0.005 0.013 0.016 0.028 0.011 0.031 0.006 0.004 0.004 0.010 0.015 0.007 What you can do is to add WAG+C10+F+G,\u2026 WAG+C50+F+G into the -madd option (Right now your command only includes +C60 of the C series). Then IQ-Tree will determine which one of the +Cxx models fits best to the data. Cheers, Minh I have put the log file in the attachment if that will help. Thanks a lot, Best, You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <iqtree.log> ", "Hey Minh: Thanks a a lot for explanation. Sorry we do have another question about the WAG and LG models. I looked the command line of IQ-tree and found LG model do have equilibrium frequencies build-in within the model (last line of the model). I am curious in which case the build-in frequency is used or not been used? Best, ", "Hi Li, The builtin frequency of LG/WAG is ignored for such mixture model, because C60 already defines mixture of 60 AA frequency vectors. Moreover, if +F is included (e.g LG+C60+F) then there will be one more class of empirical frequency from the alignment. Cheers Minh "]}, "xpgWvC1qXVA": {"topic": "Maximun Likelihood Tree vs. Consensus tree bootstrap values and selecting outgroups", "initializeDate": "Dec 9, 2020, 11:48:34 AM", "timeStamp": "Jan 25, 2021, 10:24:53 AM", "content": ["Hello, I am running a concatenation-based species tree using a partition model with Ultrafast bootstrap and the SH-aLRT fast branch test. My code: iqtree -p ALIGNMENT_FOLDER --prefix concat -alrt 1000 -B 1000 -T AUTO I have two questions: 1) In the concat.iqtree output I get a Maximun Likelihood Tree with SH-aLRT support (%) / ultrafast bootstrap support (%) values and also a Consensus Tree with bootstrap supports (%). How are the bootstrap values in the Consensus different from the values in the first tree? I don't fully understand how this two trees are different or how to interpret them. 2) The output indicates: \"Tree is UNROOTED although outgroup taxon '1' is drawn at root\". Is there a way to avoid this? Is there any way to visualize the tree without a radon taxa as outgroup (or to select a more suitable outgroup)? I would really appreciate some help. Thanks! Isabel ", "Hi Isabel, On 10 Dec 2020, at 3:48 am, Isabel Fernandez Escapa < isabel.fern...@gmail.com > wrote: Hello, I am running a concatenation-based species tree using a partition model with Ultrafast bootstrap and the SH-aLRT fast branch test. My code: iqtree -p ALIGNMENT_FOLDER --prefix concat -alrt 1000 -B 1000 -T AUTO I have two questions: 1) In the concat.iqtree output I get a Maximun Likelihood Tree with SH-aLRT support (%) / ultrafast bootstrap support (%) values and also a Consensus Tree with bootstrap supports (%). How are the bootstrap values in the Consensus different from the values in the first tree? I don't fully understand how this two trees are different or how to interpret them. Please look up the IQ-TREE forum, I recalled that someone asked the same question. IQ-TREE even tells you the Robinson-Foulds distance between ML and consensus tree (see .iqtree file). 2) The output indicates: \"Tree is UNROOTED although outgroup taxon '1' is drawn at root\". Is there a way to avoid this? Is there any way to visualize the tree without a radon taxa as outgroup (or to select a more suitable outgroup)? Use -o option, see the documentation. Cheers Minh I would really appreciate some help. Thanks! Isabel You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/784fc300-4eeb-4e2c-9026-b1eddcf93fc8n%40googlegroups.com ", "Hi Minh, I will try the -o option to root my trees. About the ML vs. consensus, my understanding is that the consensus tree is build from the bootstrap trees, so it is an extended majority consensus from the UFBoot bootstrap trees. Is this correct? Thanks, Isabel ", "Hi Isabel, Sorry for the long delay, I\u2019m back from a long break. Yes, that is correct. Some bonus infos: You can use the -minsup option ( http://www.iqtree.org/doc/Advanced-Tutorial#consensus-construction-and-bootstrap-value-assignment ) such as -minsup 0.5 to build the majority-rule consensus. The default is -minsup 0, i.e., extended majority-rule consensus. If you want to build a strict consensus, use -minsup 1.0. Cheers Minh ", "Thanks! "]}, "jOXisuZHzXc": {"topic": "Transition:transversion ratio over 50:1?", "initializeDate": "Sep 21, 2018, 4:54:55 PM", "timeStamp": "Sep 25, 2018, 3:22:04 AM", "content": ["Hi, I have an alignment of bat mitochondrial COI genes, attached here. The rate matrix it saying that G <-> A and C <-> T transitions are more than 50-fold higher than G <->T transverions and that C <-> G transversions are almost non-existent in this data set. When I look at the data in a multiple sequence alignment editor, these values seem believable, but they are very extreme compared to most data sets I have seen in the past. Also, it seems a little odd that the two lowest rate categories (I was using iqtree-omp -wsr -nt 8 -s Kerivoula_COI_PlusOtherBatUNIQ98.FASTA -m GTR+R8 ) are so very low, but this is probably due to the rather extreme number of invariant sites in the data due to selection pressure on this protein-coding gene. Do these numbers seem reasonable? Is this common for other mammals or something special about bat mitochondria? The rate matrix I got from iqtree is: ========== run number 1 ============ SEQUENCE ALIGNMENT ------------------ Input data: 79 sequences with 656 nucleotide sites Number of constant sites: 387 (= 58.9939% of all sites) Number of invariant (constant or ambiguous constant) sites: 387 (= 58.9939% of all sites) Number of distinct site patterns: 287 SUBSTITUTION PROCESS -------------------- Model of substitution: GTR+F+R8 Rate parameter R: A-C: 8.5683 A-G: 59.8100 A-T: 9.5804 C-G: 0.0001 C-T: 99.9929 G-T: 1.0000 State frequencies: (empirical counts from alignment) pi(A) = 0.2579 pi(C) = 0.2466 pi(G) = 0.1729 pi(T) = 0.3227 Rate matrix Q: A -0.6466 0.08789 0.4301 0.1286 C 0.09191 -1.434 7.191e-07 1.342 G 0.6415 1.026e-06 -0.655 0.01342 T 0.1028 1.026 0.007191 -1.136 Model of rate heterogeneity: FreeRate with 8 categories Site proportion and rates: (0.4216,0.0002098) (0.1474,0.0002095) (0.03237,0.05729) (0.02139,0.3703) (0.04628,0.7034) (0.1817,1.812) (0.1299,3.525) (0.01935,8.806) Category Relative_rate Proportion 1 0.0002098 0.4216 2 0.0002095 0.1474 3 0.05729 0.03237 4 0.3703 0.02139 5 0.7034 0.04628 6 1.812 0.1817 7 3.525 0.1299 8 8.806 0.01935 ============================ ==== on another run I get similar results ============ SEQUENCE ALIGNMENT ------------------ Input data: 79 sequences with 656 nucleotide sites Number of constant sites: 387 (= 58.9939% of all sites) Number of invariant (constant or ambiguous constant) sites: 387 (= 58.9939% of all sites) Number of distinct site patterns: 287 SUBSTITUTION PROCESS -------------------- Model of substitution: GTR+F+R8 Rate parameter R: A-C: 8.5795 A-G: 59.9514 A-T: 9.5900 C-G: 0.0001 C-T: 100.0000 G-T: 1.0000 State frequencies: (empirical counts from alignment) pi(A) = 0.2579 pi(C) = 0.2466 pi(G) = 0.1729 pi(T) = 0.3227 Rate matrix Q: A -0.6474 0.08795 0.4308 0.1286 C 0.09196 -1.433 7.186e-07 1.341 G 0.6426 1.025e-06 -0.656 0.01341 T 0.1028 1.025 0.007186 -1.135 Model of rate heterogeneity: FreeRate with 8 categories Site proportion and rates: (0.4237,0.0002615) (0.1473,0.0002612) (0.0308,0.06193) (0.0195,0.3692) (0.04743,0.6914) (0.1822,1.813) (0.1297,3.528) (0.01931,8.803) Category Relative_rate Proportion 1 0.0002615 0.4237 2 0.0002612 0.1473 3 0.06193 0.0308 4 0.3692 0.0195 5 0.6914 0.04743 6 1.813 0.1822 7 3.528 0.1297 8 8.803 0.01931 ================ ", "I explored this more myself, using complete mitochondiral genomes of mammals, and then the COI gene clipped out of that same alignment. It turns out that the COI gene has a very very much more biased transition:transversion ratio that the genomes overall. This is not totally unexpected given that selection pressures are very different on protein-coding regions than on structural RNA coding regions and other regions. ========. COI gene alone ========= SEQUENCE ALIGNMENT ------------------ Input data: 295 sequences with 658 nucleotide sites Number of constant sites: 318 (= 48.3283% of all sites) Number of invariant (constant or ambiguous constant) sites: 318 (= 48.3283% of all sites) Number of distinct site patterns: 357 SUBSTITUTION PROCESS -------------------- Model of substitution: GTR+F+R8 Rate parameter R: A-C: 4.7487 A-G: 41.3674 A-T: 8.0939 C-G: 0.7901 C-T: 72.3660 G-T: 1.0000 State frequencies: (empirical counts from alignment) pi(A) = 0.2579 pi(C) = 0.266 pi(G) = 0.1694 pi(T) = 0.3067 Rate matrix Q: A -0.6135 0.07206 0.3999 0.1416 C 0.06988 -1.344 0.007637 1.266 G 0.6087 0.01199 -0.6382 0.0175 T 0.1191 1.098 0.009666 -1.227 Model of rate heterogeneity: FreeRate with 8 categories Site proportion and rates: (0.5026,0.002362) (0.07239,0.04088) (0.0369,0.2612) (0.04947,0.821) (0.06283,1.404) (0.1447,2.188) (0.1134,3.622) (0.01768,7.349) Category Relative_rate Proportion 1 0.002362 0.5026 2 0.04088 0.07239 3 0.2612 0.0369 4 0.821 0.04947 5 1.404 0.06283 6 2.188 0.1447 7 3.622 0.1134 8 7.349 0.01768 ==================== ================== Complete Mitochondrial Genomes ============= SEQUENCE ALIGNMENT ------------------ Input data: 295 sequences with 16329 nucleotide sites Number of constant sites: 4497 (= 27.54% of all sites) Number of invariant (constant or ambiguous constant) sites: 4497 (= 27.54% of all sites) Number of distinct site patterns: 11748 SUBSTITUTION PROCESS -------------------- Model of substitution: GTR+F+R8 Rate parameter R: A-C: 2.1057 A-G: 12.1351 A-T: 1.8481 C-G: 0.5756 C-T: 21.0980 G-T: 1.0000 State frequencies: (empirical counts from alignment) pi(A) = 0.3274 pi(C) = 0.2668 pi(G) = 0.1318 pi(T) = 0.2739 Rate matrix Q: A -0.5397 0.1136 0.3236 0.1024 C 0.1395 -1.324 0.01535 1.169 G 0.8038 0.03106 -0.8903 0.05541 T 0.1224 1.139 0.02667 -1.288 Model of rate heterogeneity: FreeRate with 8 categories Site proportion and rates: (0.3089,0.006579) (0.1211,0.08639) (0.09146,0.2752) (0.08668,0.5947) (0.09702,1.1) (0.1307,1.905) (0.1323,3.025) (0.03183,4.868) Category Relative_rate Proportion 1 0.006579 0.3089 2 0.08639 0.1211 3 0.2752 0.09146 4 0.5947 0.08668 5 1.1 0.09702 6 1.905 0.1307 7 3.025 0.1323 8 4.868 0.03183 ========================== The overall tree of the mammals was quite ugly when using COI gene alone. For example the carnivores were no longer a nice clade in COI alone, when they did form one clade for complete mitochondrial genomes. Of course this is not surprising, just interesting. ", "Hi Brian again, I don\u2019t know what the expectation is, but such extreme estimates indicate that there is likely model over-paramerization. So I would do model selection first, instead of just using GTR+R8. Moreover, there can be substitution saturation, which can be checked with Ts/Tv plot. And perhaps you should remove very fast evolving sites from the alignment. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thanks, Minh! In my experience, large data sets with a reasonable amount of diversity (like maybe greater than 20 OTU, greater than 1000 columns in the alignment, and distances ranging from 2% to 15%) always get GTR recommended with ModelTest. However this alignment had fewer sequences, short region all under very high selection pressure and small distances so more than 50% of the sites were invariant leaving very few phylogenetically informative sites. It is certainly less than an ideal data set, but COI is quite often used in published papers, so I was having a look at it. A less than ideal data set is certainly not useless, but I was curious about what type of problems it might have. In this case, removing any fast-evolving sites would not be a good choice, because at this low level of diversity only the faster sites have any phylogenetic information, the invariant sites tell us nothing. As a general trend, I notice that the Ts/Tv ratio for a single given organism is most extreme in the most closely related sequences with few differences and less time for selection pressures to have had an effect. For some organisms it is not unusual to observe a ratio of 20 or more in closely related species, and G <-> A is quite often much higher than C <-> T on the coding strand of protein-coding regions. I was just a little surprised by the numbers from this data. Quite often, I am not as interested in \"the tree\" but more interested in how evolution is taking place in a data set. My first guess with this COI data is that a lot of the extreme value issue is caused by codon use selection because the mitochondria have a limited set of tRNAs compared to the nuclei of mammal cells. I have not given much thought to how selective sweeps should influence mitochondria vs chromosomes or genes within chromosomes. ", "Hi Brian, then how about first clustering similar sequences (say >= 97% identity; but threshold really depends on your data set) and pick one representative sequence from each cluster for subsequent tree reconstruction\u2026 That way, you reduce the number of sequences and the analysis might be more stable. Of course, this is based on the assumption that sequences within a cluster will form a clade in the tree. Cheers Minh "]}, "as1ePWvrQY0": {"topic": "IQTREE2 missing Concatenated data matrix from multiple sequence alignments", "initializeDate": "Dec 1, 2020, 5:31:41 AM", "timeStamp": "Feb 22, 2021, 5:55:53 PM", "content": ["Hi there, i just started playing with the new -p option in IQTREE2 that reads a folder with multiple alignments and conducts a concatenated analyses. According to the documentation it also generates a concatenated matrix as an ouput (\"For your convenience IQ-TREE writes the concatenated alignment into the file example.nex.conaln\"). So far I have not been able to locate such file. This is my command line: iqtree2 -p example_partition.nex --prefix bestmodel_ -T AUTO -m MFP+MERGE -B 1000 Cheers Miquel ", "Hi Miquel, The option is -wca, for riting oncatenated lignment. Let me know if adding this option works. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e1499dd2-86ed-4e39-9b07-14754d9d583dn%40googlegroups.com ", "Hi Minh, I am using version 2.0.3, and even using the -wca parameter, it does not generate the concatenation. The log says it does (see below), but it doesn't. iqtree -s test_dir -m LG -pre concat -nt AUTO -safe -keep-ident -st AA -wca -redo Analysis results written to: IQ-TREE report: concat.iqtree Maximum-likelihood tree: concat.treefile Likelihood distances: concat.mldist Concatenated alignment: concat.conaln Screen log file: concat.log I am missing something? best, Thiberio L. Thib\u00e9rio Rangel , Ph.D. Postdoctoral Associate Department of Earth, Atmospheric & Planetary Sciences Massachusetts Institute of Technology 77 Massachusetts Ave Cambridge, MA 02139 To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/725AA974-C849-41AA-A200-F1A7E0EF2A7E%40univie.ac.at "]}, "shapRuNXlrQ": {"topic": "Version 1.4.3-heterotachy for Mac OS: IQ-TREE CRASHES WITH SIGNAL ABORTED", "initializeDate": "Apr 27, 2017, 3:55:09 PM", "timeStamp": "Apr 28, 2017, 6:19:36 AM", "content": ["Hello Minh, IQ-TREE heterotachy version crashed with my data set. But the same data worked just fine with IQ-TREE version 1.5.4 for Mac OS X 64-bit. I use OS X 10.10.5 and my alignment is binary data (presence/absence matrix). I got the same error with both the multi-core version and the serial version. As you will see this happens after optimizations, which took over 4 hours (multi-core version). The relevant parts of the log is as follows, IQ-TREE multicore version 1.4.3-heterotachy for Mac OS X 64-bit built Aug 12 2016 Copyright (c) 2011-2015 Nguyen Lam Tung, Olga Chernomor, Arndt von Haeseler and Bui Quang Minh. Host: myroom.local (AVX, 8 GB RAM) Command: iqtree-omp-ht -s Eq_47_Occ.IQ.phy -m GTR2+FO+H4 -nt 4 Seed: 297054 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Sun Apr 23 22:54:30 2017 Kernel: AVX - 4 threads (4 CPU cores detected) .................. ................. ................ Heterotachy mixture model name: MIX{GTR2,GTR2,GTR2,GTR2}+FO Initializing heterotachy model with 4 mixture branch lengths Creating fast SIMD initial parsimony tree by random order stepwise addition... 0.028 seconds, parsimony score: 13911 (based on 1542 informative sites) NOTE: 13 MB RAM is required! Estimate model parameters (epsilon = 0.100) tree_lh = -5388.652 1. Initial log-likelihood: -16584.246 Optimal log-likelihood: -31875.441 Mixture weights: 0.543 0.351 -0.225 0.331 Parameters optimization took 1 rounds (16966.252 sec) -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Computing ML distances based on estimated model parameters... 0.467 sec Computing BIONJ tree... 0.299 seconds Log-likelihood of BIONJ tree: -24424.529 Generating 98 parsimony trees... 1.860 seconds 100 distinct starting trees Computing log-likelihood of 100 initial trees ... 25.982 seconds Optimizing top 20 initial trees with NNI... STACK TRACE FOR DEBUGGING: 1 std::vector<std::vector<int, std::allocator<int> >, std::allocator<std::vector<int, std::allocator<int> > > >::reserve(unsigned long) 2 _sigtramp() 6 double PhyloTree::computeSitemodelLikelihoodFromBufferEigenSIMD<Vec2d, 2, 20>() 7 double** aligned_alloc<double*>(unsigned long) 8 BioNj::create(char const*, char const*) 9 std::vector<NNIMove, std::allocator<NNIMove> >::clear() 10 CandidateSet::operator=(CandidateSet const&) 11 bool Checkpoint::get<std::string>(std::string, std::string&) 12 bool Checkpoint::get<std::string>(std::string, std::string&) 13 std::vector<ModelInfo, std::allocator<ModelInfo> >::~vector() 14 std::vector<PartitionInfo, std::allocator<PartitionInfo> >::operator=(std::vector<PartitionInfo, std::allocator<PartitionInfo> > const&) 15 std::vector<std::vector<int, std::allocator<int> >, std::allocator<std::vector<int, std::allocator<int> > > >::reserve(unsigned long) *** IQ-TREE CRASHES WITH SIGNAL ABORTED Could you please suggest what might be wrong here? Thanks. Cheers, Ajith ", "Dear Ajith, Thanks for using this model. We haven\u2019t tried the heterotachy model (+H) on binary data. Thus, can you pls send us the data for debugging purpose (via personal email!) ? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "X-z_GF-HAXA": {"topic": "Re: [iqtree] Nexus partition file", "initializeDate": "Jan 17, 2021, 11:23:57 PM", "timeStamp": "Jan 17, 2021, 11:23:57 PM", "content": ["Hi there, Sorry for the long delay, I\u2019m back from a long break. Indeed it\u2019s simple but not easy to spot. A semi-colon is missing in the declaration of p3. So change: charset p3 = 3297-6512 charset p3 = 3297-6512; Everything else looks OK with me. Cheers Minh On 22 Dec 2020, at 11:36 pm, jlr120 < jl...@connect.hku.hk > wrote: Hi, I have what I assume (and hope) to be a pretty simple issue though I've been unable to find a solution. I've got a partitioned alignment and I've written a nexus partition file with the model parameters I'd like for each partition based on examples I've seen #NEXUS begin sets; charset p1 = 1-1519; charset p2 = 1520-3296; charset p3 = 3297-6512 charpartition matrices = TIM+F+I+G4:p1, TIM3e+R5{0.7112,0.1773,0.07464,1.502,0.09283,1.502,0.0545,3.213,0.06685,6.69}:p2, TNe+R6{0.5992,0.07424,0.005797,0.1616,0.003189,0.1817,0.1342,0.6685,0.07942,1.579,0.1783,4.145}:p3; end; Yet each time I try to run the command iqtree2 -s alignmentfile -spp partitionfile -nt AUTO I get the error \"ERROR: Unknown sequence type p1\" My alignment file is in nexus format and specifies that the data type is DNA. Is there something that must be included in the partition file that I've missed? Thanks! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/60eee243-2608-4c95-a5b1-f40b5e1a6449n%40googlegroups.com "]}, "hx4p0-O7-bE": {"topic": "IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT", "initializeDate": "Jun 21, 2017, 3:41:34 AM", "timeStamp": "Jun 21, 2017, 7:09:13 AM", "content": ["Hi, i'm testing iq-tree v1.5.3 installed with anaconda on our cluster. I used your example fasta file. iqtree -s test.fasta -m TEST -AIC -nt AUTO -redo i had a segmentation fault. May you help me? Thanks, Lynn ", "Dear Lynn, thanks for the report. This bug is somehow associated with the BIONJ step, where the code originated from Olivier Gascuel group. Can you please send me the test alignment via personal email, so that I can examine it? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <error_file.txt> <iq_tree.txt> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "Yz5y1gUTucA": {"topic": "Substitution models on MrBayes", "initializeDate": "Apr 18, 2019, 7:26:10 AM", "timeStamp": "Apr 18, 2019, 9:54:24 AM", "content": ["Dear IQ-TREE users, Does anyone know how to parse the +Rk parameter to MrBayes block? My MF result is: 1 GTR+F+I+G4 1.8259 GTR{1.33097,3.31018,1.56886,0.624047,3.77648}+F{0.226885,0.218572,0.20682,0.347724}+I{0.0816278}+G4{1.06559} 2 SYM+R4 0.1516 SYM{0.82179,4.34755,2.20895,0.304489,8.17202}+FQ+R4{0.840231,0.215117,0.0684688,3.29175,0.046207,3.29201,0.0450931,9.79654} 3 SYM+R3 1.2000 SYM{1.5155,4.83189,0.483565,1.37314,6.88262}+FQ+R3{0.557698,0.0442323,0.269038,1.3703,0.173264,3.50142} For the partition 1 I managed to do it (see below) however I'm not sure how to do it for the partitions 2 and 3. Best regards, Caio MrBayes model for partition 1 GTR+F+I+G4: lset applyto=(1) nst=6 rates=invgamma ngammacat=4; prset applyto=(1) statefreq=fixed(0.226885,0.218572,0.20682,0.347724) pinvar=fixed(0.08162784989) shapepr=fixed(1.065590673) revmat=fixed(1.33097109,3.310175277,1.568862078,0.6240469534,3.776481586,1); ", "Hi Caio, I believe MrBayes does not support the free-rate model (+R). So no way to convert it. To force ModelFinder restrict to those models supported by MrBayes, pls rerun with options: -m TESTONLY -mset mrbayes Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "Ih08XYEIn8w": {"topic": "Windows error (how to trace?)", "initializeDate": "Nov 9, 2015, 1:35:30 PM", "timeStamp": "Dec 10, 2015, 10:05:45 AM", "content": ["Hi, I am new to IQ tree and am running a 600+ taxa, 3K+ SNP dataset on the omp version (or trying to). When I enter iqtree -s example.phy -m TESTONLY -nt 8, the program runs fine, however when I run my data with the same commands, I receive a windows error: iqtree.exe has stopped working correctly. Windows will close the program and notify you if a solution is available. The last line of my console prior to exiting reads: Create initial parsimony tree by phylogenetic likelihood library (PLL)... The log simply ends after the composition chi square tests. Is there a way to trace what went wrong? Thanks, Aaron ", "Dear Aaron, thanks for your interest! I am not sure what happened. Thus can you pls send me the log file? Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Aaron, I was able to reproduce the issue already. Interestingly it only happened with multicore Windows version. All other versions (multicore and sequential Mac and Linux) worked. Even the sequential Windows version also worked. Since IQ-TREE stopped at the step using phylogenetic likelihood library ( http://www.libpll.org ), I suspect that something went wrong there. Thus we may need some time to trace the problem. Nevertheless, can you pls switch to other versions for the moment? Thanks, Minh ", "Thanks Minh, I switched over and model selection went fine. Attempting non-parametric bootstraps yielded the same result (a Windows error and nothing specific in the log file) Here is my command in case you want to try and replicate that as well. iqtree -s Clade2.phy -m SYM+ASC+G4 -b 1000 ultrafast bootstrapping and alrt both went fine with the sequential version. Aaron ", "Dear Aaron, I repeated this analysis on a Linux machine but reduced number of standard bootstrap replicates (-b 100). It finished after >2 days using 9 CPU cores. No crash at all. So it was likely Windows-specific problem, which I unfortunately don\u2019t have enough facility to debug right now. I will send you the output files via personal email. Cheers, Minh ", "Dear Aaron, this Windows-specific problem should now be fixed with version 1.3.11 Cheers, Minh "]}, "3c63XooyGPk": {"topic": "Problems with IQTREE in CIPRES", "initializeDate": "Jun 15, 2020, 7:45:01 PM", "timeStamp": "Jun 19, 2020, 7:38:53 PM", "content": ["Dear IQTREE community I am using IQTREE version 1.6.10, which is available in CIPRES. But the run fails and throws me this error: ERROR: alignment.cpp: 70: std :: __ cxx11 :: string & Alignment :: getSeqName (int): Assertion `i> = 0 && i <(int) seq_names.size () 'failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: output.log ERROR: *** Alignment files (if possible) I am using the command line: iqtree -s infile.txt -spp partition.txt -bb 1000 -bspec GENESITE -safe -bnni -alrt 1000 -abayes -st AA -nm 1000 -nt AUTO -pre output -m TESTNEW How can I fix the error? ", "Hi there, This has been reported before, it\u2019s due to a bug in the combination of -bspec GENE and -bnni options, which sometimes happens when there are a lot of missing data. The quick fix is to use \u201c-keep_empty_seq\u201d option in the presence of these 2 options, which will make IQ-TREE run slower but no crash. This has been fixed in the latest version 2. I\u2019ll inform the CIPRES team about this. But for now you can download all output files and run IQ-TREE on your local computer, the current checkpoint file will be loaded to resume this analysis quickly, so no computation will be lost. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6547ab48-4059-4d3b-9fdc-a34fc52b4850n%40googlegroups.com <DNALM.log> <2.jpg> <1.jpg> ", "Hi all, I saw this post and modified the CIPRES interface so if those two flags are used together,( -bsam XXXX -bnni ) the -keep_empty_seq flag will be added automatically. Best, Mark ", "Hi Mark, That\u2019s awesome! Thanks for your quick reaction. Moreover, can you also change this behaviour, when two options -bsam and -b (standard bootstrap) are used together? It will also cause the same crash, though I\u2019m not sure if standard bootstrap is provided in CIPRES. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e5afa894-3beb-43c3-b45a-bf5b71006cfbo%40googlegroups.com "]}, "4SSMiivQfK0": {"topic": "partition model not recognized", "initializeDate": "Apr 9, 2016, 2:03:49 AM", "timeStamp": "Apr 25, 2016, 10:52:57 AM", "content": ["Dear developers, I was trying to run an analysis with partition model. However, the semi-empirical codon models (except for the first one in the file) cannot be correctly recognized. Please find attached such an example. Could you please take a look at this? Thanks! Best, Xiaofan ", "dear Xiaofan, this bug was just fixed in version 1.4.2 thanks for the report Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Thanks very much! I want to report another problem where iqtree crashed in an analysis of codon data. I have attached the alignment and log file for your reference. Best, Xiaofan ", "Dear Xiaofan, thanks for the report. Can you please repeat adding an option \u201c-fastlk\u201d and let me know if it works or not? Minh > <data.tar.gz> ", "Hi Minh, Sorry for the late reply. It works with \"-fastlk\", and I also found that it works on linux (without \"-fastlk\"), or on MacOS with the omp version (also without \"-fastlk\"). Best, Xiaofan "]}, "38WiBL12vcM": {"topic": "Test multiple trees from different datasets", "initializeDate": "Jul 3, 2017, 11:00:50 PM", "timeStamp": "Jul 5, 2017, 8:17:14 PM", "content": ["Hi, I work with mitochondrial genome data and have constructed a few trees using different combinations of datasets (e.g. protein-coding genes only, protein-coding genes + rRNA, etc). Is it possible to compare the topologies that resulted from the various analyses (perhaps reported as lnL values or something)? I know there is the tree topology test - but it requires a nexus or phylip file and my trees were constructed from different datasets (but same taxon sampling). Thanks, Mun ", "Hi Mun, 1. You can compare the topologies by tree distance metric such as Robinson-Foulds distance. 2. If you mean tree topology test: such tests compare the log-likelihoods of the trees. Since log-likelihoods are only comparable given the same input alignment, what you can do is to concatenate all datasets and perform the tests on the concatenated alignment. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thanks Minh. My objective is to find the most likely tree out of the 5 trees that I have constructed from different datasets. With the Robinson-Foulds distance method, how do I conclude which is the so-called \"best\" tree? As for your suggestion on the tree topology test, my datasets were the following: 1) protein-coding genes only (amino acid) 2) protein-coding genes only (nucleotide) 3) protein-coding + rRNA genes (mixed aa + nuc) 4) protein-coding + rRNA genes (nucleotide) If I concatenate my dataset, it will contain a mix of aa + nuc characters as well as duplicated entries, assuming you meant a concatenation like this: PCG (aa) + PCG (nt) + rRNA (nuc)? Will that work? Thanks, Mun ", "Hi Mun, On Jul 5, 2017, at 1:57 AM, mht < mh.t...@gmail.com > wrote: Thanks Minh. My objective is to find the most likely tree out of the 5 trees that I have constructed from different datasets. With the Robinson-Foulds distance method, how do I conclude which is the so-called \"best\" tree? No of course not, it was just an option as you wrote \u201ccompare the topologies\u2026\" As for your suggestion on the tree topology test, my datasets were the following: 1) protein-coding genes only (amino acid) 2) protein-coding genes only (nucleotide) 3) protein-coding + rRNA genes (mixed aa + nuc) 4) protein-coding + rRNA genes (nucleotide) If I concatenate my dataset, it will contain a mix of aa + nuc characters as well as duplicated entries, assuming you meant a concatenation like this: PCG (aa) + PCG (nt) + rRNA (nuc)? Will that work? In theory you can you all these 4 data sets plus the last one to do separate tree tests, and see how the results agree or not. Am I right that 1) and 2) are the same genes and just differ by analyzing DNA or the translated-AA? In fact I\u2019m not really sure if the last option PCG (aa) + PCG (nt) + rRNA (nuc) makes sense\u2026 my feeling is that the PCG are kind of duplicated and may dominate the signal compared with rRNA. However, I suggest that you consult the author of these tests (Shimodaira). Cheers, Minh ", "Yes my bad, after your reply to my first post I realized that I was not specific enough in conveying my objective. Yes 1) and 2) contain the same genes but just different sequence character types. I'll try your suggestion and see what I get. Thanks Minh! "]}, "caPurU55p64": {"topic": "What are the differences between the user-provided tree file and the \".treefile\", generated from an ASR job?", "initializeDate": "Jun 12, 2020, 4:42:53 AM", "timeStamp": "Jun 12, 2020, 6:05:45 PM", "content": ["Hi, I am doing ancestral sequence reconstructions (ASR), and I have a question about some output files. I am launching the ASR analysis by specifying the best-fit substitution model and my consensus tree in my command line. After the job was done, a \".treefile\" is generated, in which node labels were automatically added for every internal node. Is this \".treefile\" the same tree as mine, with internal node labels added? Can this \"treefile\" differ to my consensus tree in terms of genetic distances between nodes and topology? I am not sure how this \".treefile\" was built. Can I have more information about its construction? Best regards Gabriel ", "Hi Gabriel, On 12 Jun 2020, at 6:42 pm, Gabriel DUPRE < gabriel...@gmail.com > wrote: Hi, I am doing ancestral sequence reconstructions (ASR), and I have a question about some output files. I am launching the ASR analysis by specifying the best-fit substitution model and my consensus tree in my command line. After the job was done, a \".treefile\" is generated, in which node labels were automatically added for every internal node. Is this \".treefile\" the same tree as mine, with internal node labels added? Depends on whether you fixes the topology of the starting tree or not. What is the command line? If you use \u201c-t\u201d option then IQ-TREE uses the input tree as starting tree and will further optimise it. With \u201c-te\u201d option, it will fix the tree topology. Can this \"treefile\" differ to my consensus tree in terms of genetic distances between nodes and topology? See above I am not sure how this \".treefile\" was built. Can I have more information about its construction? I assume this is a general question about IQ-TREE algorithm. If so, have a look at our paper: https://doi.org/10.1093/molbev/msu300 Minh Best regards Gabriel You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e57abb01-8651-4edc-918a-d53a19bfa712o%40googlegroups.com "]}, "Yoh47UYBhiw": {"topic": "RY coding", "initializeDate": "Jan 11, 2018, 12:40:14 PM", "timeStamp": "Jan 18, 2018, 3:20:37 PM", "content": ["Dear iq-tree team, How does IQtree treat nucleotide positions in an alignment which are RY recoded? I have a big alignmernt of protein coding nt sequences that are aligned according to codons. I want to recode the 3rd codon position in RY and analyze this as a DNA alignment (not with codon models) by estimating the most appropriate model in ModelFinder. Which nt model would be the most appropriate for analyzing a dataset like that? I have the impression that those sites are treated as missing data. Is this correct? Below is my output log. What happens if the entire alignment is RY recoded? Is this treated as total missing data? Host: compute-0-0.local (AVX, 504 GB RAM) Command:iqtree-omp -nt 12 -s FcC_supermatrix_recoded.fas -spp partitions.txt -st DNA -m MFP -mset GTR -gmedian -pre recoded_1 -safe Seed: 177934 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Thu Jan 11 18:24:30 2018 Kernel: Safe AVX - 12 threads (48 CPU cores detected) Reading partition model file... Reading alignment file ... Fasta format detected Alignment most likely contains protein sequences WARNING: Your specified sequence type is different from the detected one WARNING: 2 sites contain only gaps or ambiguous characters. Alignment has 14 sequences with 4098894 columns and 915701 patterns (506352 informative sites, 2361631 constant sites) Gap/Ambiguity Composition p-value WARNING: 8 sequences contain more than 50% gaps/ambiguity **** TOTAL 54.08% 14 sequences failed composition chi2 test (p-value<5%; df=3) NOTE: No CharPartition defined, use all CharSets Many thanks Alex ", "Dear Alex, If you recode nucleotide into RY, then the state space is reduced from 4 to 2 states. Therefore it should be analyzed as binary data, which is supported in IQ-TREE. So you can convert into 01 instead of RY and IQ-TREE will automatically detect your alignment as binary data and apply binary models. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, 1) if not doing this like you described belo but keep it as it is: is it treated as missing data or not? (I need to know this also for other analyses) - or is e.g.ld the probability splittet by 50:50 for A and G (R) and for C and T (Y) ? (I think this is this way in RAxML/ExaML but I am not sure) 2) if doing like below, so the charpartition would contain DNA & binary models (e.g. DNA for pos. 1+2 and binary for pos. 3 - recoded): how exactly to make the partition file and what to use: GTR2? would this be appropriate and comparable with scenoario in 1) (50/50 splitting) ? Best & thanks Karen ", "Hi Karen, On Jan 12, 2018, at 11:19 AM, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Dear Minh, 1) if not doing this like you described belo but keep it as it is: is it treated as missing data or not? (I need to know this also for other analyses) - or is e.g.ld the probability splittet by 50:50 for A and G (R) and for C and T (Y) ? (I think this is this way in RAxML/ExaML but I am not sure) Yes that\u2019s right. They are treated as ambiguous code, not as missing data. You will see in the result that pi(A)=pi(G) and pi(C)=pi(T). I\u2019m 95% sure that RAxML does the same. I just did two two runs, one with RY coding and GTR model, the other with 01 coding and GTR2 model. And I got exactly the same log-likelihoods from the two runs. So I can confirm that RY codind works just fine. 2) if doing like below, so the charpartition would contain DNA & binary models (e.g. DNA for pos. 1+2 and binary for pos. 3 - recoded): how exactly to make the partition file and what to use: GTR2? would this be appropriate and comparable with scenoario in 1) (50/50 splitting) ? This will be a bit complicated, that you have to create another alignment containing the 3-codon positions recoded as 01. And then follow the guide to have mixed data here: http://www.iqtree.org/doc/Complex-Models#partition-models But since RY encoding also works as I noted above, you may just simply stick with RY analysis. Minh ", "perfect, cool :) & thanks for the answer (I was expecting this - and I checked: its like this is RAxML/ExaML as well). Have a nice weekend!! ", "Hi Minh, Thanks for your quick reply. I recoded the entire matrix in 01 and the -/N into ?. If i use then partitioned analysis with proportional branch lengths among partitions (-spp) eg: /iqtree/1.5.5/iqtree-omp -nt 12 -s FcC_supermatrix_recoded.fas -spp partitions.txt -st BIN -m MFP -gmedian -pre recoded_1_spp -safe i get the following error: Computing ML distances based on estimated model parameters... 9.016 sec Computing BIONJ tree... 0.137 seconds Estimate model parameters (epsilon = 0.100) Initial log-likelihood: -12361282.910 Current log-likelihood at step 1: -12266805.736 Current log-likelihood at step 2: -12260040.222 Current log-likelihood at step 3: -12259464.596 Current log-likelihood at step 4: -12259426.850 Current log-likelihood at step 5: -12259420.031 Current log-likelihood at step 6: -12259417.204 Current log-likelihood at step 7: -12259415.397 Current log-likelihood at step 8: -12259413.961 Current log-likelihood at step 9: -12259412.701 Current log-likelihood at step 10: -12259411.535 Current log-likelihood at step 11: -12259410.434 Current log-likelihood at step 12: -12259409.378 Current log-likelihood at step 13: -12259408.351 Current log-likelihood at step 14: -12259407.350 Current log-likelihood at step 15: -12259406.374 Current log-likelihood at step 16: -12259405.417 Current log-likelihood at step 17: -12259404.480 Current log-likelihood at step 18: -12259403.559 Current log-likelihood at step 19: -12259402.646 Current log-likelihood at step 20: -12259401.754 ERROR: Too high (saturated) partition rates of the proportion partition model! Please switch to the edge-equal partition model via -q option instead of -spp (see command above) On the other hand when i used the -q option instead i get another error message: 2947 JC2+FQ+I 1366.043 EOG090R0AKM 0h:4m:23s (0h:0m:0s left) 2948 GTR2+FO 5929.921 EOG090R015Q 0h:4m:23s (0h:0m:0s left) Partition information was printed to recoded_1_q.best_scheme.nex Partition information in Raxml format was printed to recoded_1_q.best_scheme All model information printed to recoded_1_q.model CPU time for ModelFinder: 3082.482 seconds (0h:51m:22s) Wall-clock time for ModelFinder: 264.054 seconds (0h:4m:24s) NOTE: 831 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.100) Initial log-likelihood: -12666965.051 ERROR: Unsupported -spj. Please use proportion edge-linked partition model (-spp) Only with thoption -sp (unlinked branch lengths) i have made it to work.I have been told though that the -sp model is not very advisable to use. Any idea why this is happening? Many thanks again Alex ", "ops, this is chicken and egg. Unfortunately I can\u2019t have a look until February. Nevertheless can you pls send me your data set and I will have a look later. Cheers, Minh "]}, "JLnjHsH3I4o": {"topic": "IQ-Tree release 1.3.0", "initializeDate": "May 20, 2015, 5:01:36 PM", "timeStamp": "May 20, 2015, 5:01:36 PM", "content": ["Dear IQ-Tree users, I am happy to announce the new release version 1.3.0 with new features: Support for ClustalW and MSF alignment file formats and RAxML-styled partition file format. With Lars Jermiin and his team we developed a new model selection strategy, which is invoked via option \"-m TESTNEW\" or \"-m TESTNEWONLY\". Among others, it uses the FreeRate model (Soubrier et al. 2012; MBE 29:3345-3358) as replacement for the problematic I+G model. FreeRate model is also implemented in PhyML and BEAST 2. Improved codon model implementation, which is more compatible with codonPhyML, e.g. including models of Kosiol et al. (2007). Codon model selection now allows up to 60 codon models to be tested! Improved support for mixture models. Accepting two new amino-acids: U (Selenocysteine; treated as unknown character) and J (I or L). Several bug fixes, notably a bug in FreeRate model optimization observed by Lars Jermiin and fixed by Thomas Wong. So I strongly recommend you to update the new version. Best, Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at "]}, "78itZxrzYww": {"topic": "unexpectable root added in Lie maekov model", "initializeDate": "Feb 19, 2021, 5:17:44 AM", "timeStamp": "Mar 3, 2021, 9:05:01 AM", "content": ["Hello Minh, I'm a freshman for phylogenetic tree, called Nancy. These days, I used IQ-tree with some Lie markov models. The dataset is Rokas_etal_Nature_2003. AND I find, when using LMM, the .treefile will produce a root , but IQ-TREE always produces an unrooted tree as it knows nothing about this biological background. So, I want to know how to choose the root. In Lie markov Model's paper, it says, midpoint is the root. But, when using Lie markov model, the file say, Tree is ROOTED at virtual root '__root__'. So is IQ-tree choose the root or Lie markov model decide the root? the command: bin\\iqtree -s 106_8_yeast.phy -redo -m 12.12+G4+I+F -pre 106_8_yeast_GTR1212G4I_Calb the environment: window10 64-bit the version: 1.6.12 Thank you and Best wishes. Nancy ", "Hi Nancy, This is actually expected. 12.12 is a non-reversible model, which infers a rooted tree. See: https://www.biorxiv.org/content/10.1101/2020.07.31.230144v1.abstract Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ac82d0d5-9b17-4a58-80e6-b8ea8e24db69n%40googlegroups.com ", "Hi Minh, Sorry for the slow reply. So LMM in Iqtree doesn't keep the original method to root the tree in LMM's paper, but use ML methods with non-reversible substitution models to infer rooted trees? I'll try to read the paper thoroughly. It will help a lot. In fact, I was going to run the program with different .treefiles to find some intereting differences. Thanks again. Best wishes Nancy "]}, "uWQlvwXcyUo": {"topic": "topology test for higher groups", "initializeDate": "May 4, 2017, 7:30:33 AM", "timeStamp": "May 6, 2017, 8:01:48 AM", "content": ["I would like to perform topology testing for a few different topologies based on higher level groups. For example, I have Human, Cow, Lizard, Octopus, Rat and Crow and I would like to test for topology of relationships among the Mammal, Reptile, Cephalopod and Bird groups. I am more interested in the relationships at the higher level between the different Classes rather than within each class. How should I go about preparing the input files - specifically the input file for '-z'? Thanks! ", "Hi there, I think this should be similar to the advanced tutorial explained here: http://www.iqtree.org/doc/Advanced-Tutorial#testing-constrained-tree you just need to prepare the constraint tree differently according to your hypothesis. Another useful tool is to perform a four-cluster quartet mapping analysis as described here: http://www.iqtree.org/doc/Command-Reference#likelihood-mapping-analysis where you need to specify species falling into each of the 4 clusters (Mammal, Reptile, etc. in your case). Cheers, Minh On May 4, 2017, at 1:30 PM, mht < mh.t...@gmail.com > wrote: I would like to perform topology testing for a few different topologies based on higher level groups. For example, I have Human, Cow, Lizard, Octopus, Rat and Crow and I would like to test for topology of relationships among the Mammal, Reptile, Cephalopod and Bird groups. I am more interested in the relationships at the higher level between the different Classes rather than within each class. How should I go about preparing the input files - specifically the input file for '-z'? Thanks! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thanks Minh. I was already looking at the first advanced tutorial you mentioned. However, my tree is quite large (>100 taxa), so it can be quite hard to prepare a constraint tree that is different from my hypothesis given that there are so many possibilities. Does IQ-TREE have an option to produce trees of all different topologies possible from the alignment? ", "Then you can make use of the fact that the constraint tree does not need to include all taxa. Let\u2019s say if you want to test how 4 species groups A, B, C, D are related, it is possibly enough to pick a few representative species from each group, e.g. the constraint: (((A1,A2,A3),(B1,B2,B3)), ((C1,C2,C3),(D1,D2,D3)), X); to test if A,B are separated from C,D (where X is an outgroup species). And similar constraint for other 2 hypotheses. Does IQ-TREE have an option to produce trees of all different topologies possible from the alignment? No, but there are many many\u2026 Minh ", "I understand now, thanks for the suggestion! "]}, "Y4r-LB1jet8": {"topic": "multiple runs of ModelFinder", "initializeDate": "May 30, 2017, 5:20:04 AM", "timeStamp": "May 30, 2017, 8:38:32 AM", "content": ["Dear All, I\u2019ve been using ModelFinder in IQ-TREE for quite a while now. The other day, I thought of running the program multiple times on the same dataset. The results are a bit puzzling (see attached excel file). Compare runs 1 vs 2, 3 vs 4, and 5. Was wondering if anyone has faced this issue already. I am running ModelFinder in v 1.5.4 I have to say that my aln carries little phylogenetic signal. Yet, if this were the problem, I would have expected the w-BIC to be smaller (ie unable to \u201cdecide\u201d), which is not the case. Comments? Is there something trivial I am missing here? All the best, Giorgio. ", "Dear Giorgio, This is due to the so-called \"guide tree biased\u201d. IQ-TREE quickly constructs a maximum parsimony (MP) tree and fix it as a guide tree to compare the likelihoods, AIC, BIC scores of different models. Since your alignment is short, the MP tree can be very different between the runs, leading to this observation. If you alignment is long with enough phylogenetic signal, this discrepancy may disappear (or show very little difference in the chosen models). Alternatively, you can use -mtree option, which will co-estimate both models and trees (i.e., a full tree search is conducted for each model considered). Thus, it leads to substantially more runtime but will be more accurate. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <ModelFinder_5runs.xlsx> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Very clear as usual, thanks. This being said, model selection (and poor phylogenetic signal) is such a crucial issue that maybe it is worth adding a \u201cTIP\u201d in the manual suggesting for example to run ModelFinder 2-3 times on the data set. If results agree, fine, if they don\u2019t, then rerun with \u2013mtree option. I\u2019m running with \u2013mtree; will see what come out of it. Best, Giorgio "]}, "9UxuGY6U7Ok": {"topic": "Checkpoint/Restart", "initializeDate": "Dec 2, 2015, 9:44:51 AM", "timeStamp": "Dec 3, 2015, 4:02:46 PM", "content": ["Hello, I noticed there is a checkpoint.cpp file in the IQTree source code, but I haven't been able find in the documentation how to use checkpoint/restart. This would be great, since I am running on a system with a 24 hour limit. Thanks! Erin ", "Dear Erin, that\u2019s right, but we are still implementing this feature. It is planned for version 1.4. So stay tuned ;-) Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Sounds great! Thanks for getting back to me! -Erin "]}, "U5E36uvzvqQ": {"topic": "Tree file no accepted if more taxa in treefile than in MSA", "initializeDate": "Jan 25, 2018, 1:44:13 AM", "timeStamp": "Jan 26, 2018, 12:16:42 PM", "content": ["Hello, I have a problem with the Modelfinder: When I provide a tree file which has more taxa than the MSA, modelfinder reports: \u201cERROR: Tree taxa and alignment sequence do not match (see above)\u201d - what can I do to get it work? All the best Dieter ", "Hi Dieter, Well, IQ-TREE also prints which taxa in the tree do not occur in the alignment and vice versa. You can just then remove them. I believe some tree editor will allow you to do this. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Thank you Minh, By hand impossible for such larga datasets I have, but yes, I can use any prunetree command in R, Phytools, Quiime or Tree doctor in phast. You can add this \"prunetree\" option to the user wishlist for IQ-Tree since it would save much time, not pruning every tree, and it is quite standard that a tree contains more taxa than the singel partitions. All the best Dieter You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/U5E36uvzvqQ/unsubscribe To unsubscribe from this group and all its topics, send an email to "]}, "ns1-weCEt_A": {"topic": "mset includes raxml-ng models?", "initializeDate": "May 2, 2017, 3:22:01 PM", "timeStamp": "May 3, 2017, 9:01:53 AM", "content": ["Hello, I was wondering if the setting mset raxml will include all the new models from the latest version of RAxML (raxml-ng)? Thanks, ", "Dear A, I don\u2019t have that much experience with raxml-ng. Thus you should better ask its authors\u2026 Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Thanks for your suggestion... "]}, "n0K5F3Ooj28": {"topic": "Specifying bootstrap cut-off", "initializeDate": "Feb 18, 2020, 1:23:38 PM", "timeStamp": "Feb 19, 2020, 6:29:51 AM", "content": ["Hi all, I am trying to use Iqtree to make gene trees. I am wondering if there is a way to specify bootstrap support cut-off, such that poorly supported branches are not included at all in the consensus tree. Thanks for your help. ", "Hi, You can use -minsup option. E.g, -minsup 0.5 is to retain branches with support > 50%. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c8d51295-e6ad-4168-936a-c16e1223cace%40googlegroups.com ", "Thanks Minh. To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/C3434416-617A-4692-A5F0-1DFE4D8968D1%40univie.ac.at Kehinde Adewole Oyeniran PhD Scholar | Computational Biology | Institute of Infectious Diseases and Molecular Medicine (IDM) | Faculty of Health Sciences | University of Cape Town | Health Sciences Campus, Anzio Road, Observatory, 7925 | Blog: www.electoralreform-ng.blogspot.com | UCT email: OYNK...@myuct.ac.za +27(0)619507372 +27(0)736207568 +234(0)8038294995 \u201cAs you rise you must lift the others up\u201d -- Justice Skweyiya (RIP) "]}, "ItU0XxBKOr4": {"topic": "\"Partition model has worse fit than single model\" warning", "initializeDate": "Jan 13, 2021, 12:24:46 AM", "timeStamp": "Feb 5, 2021, 12:12:22 AM", "content": ["Hello! I was hoping to get some help about the \"Partition model has worse fit than single model\" warning. I have a large, sparse DNA matrix (4,510 taxa x 48,167 bp, 62 genes, 93% missing data). It's a rather unusual dataset: a very small number of taxa are completely sampled for all genes (from next-gen sequencing), and a very small number of genes are nearly completely sampled for all taxa (from Sanger sequencing data), and the rest of the data are missing. I'm hoping to combine these two sources to enable broad taxon sampling across many genes. I was able to get IQTREE to finish in a reasonable amount of time (about a week with 18 threads) with an unpartitioned analysis. Now I am trying a partitioned analysis with one partition per gene: iqtree -s alignment.phy -bb 1000 -nt 32 -spp gene_blocks.nex -redo After model finder finished, it issued these two warnings: WARNING: Partition model has worse fit than single model! WARNING: Add MERGE to -m option to increase model fit! With this type of data, is there any a-priori expectation that a simple concatenated analysis without partitions would be better than partitioning by gene? Thanks! ", "Hi there, Whether or not there is a prior expectation like this, I can\u2019t say. You will only know after running the analysis. But 93% missing data in your data sound like the main reason for the overfitting of partition models. As the WARNING said, it\u2019s better if you merge the partitions together with e.g., -m MFP+MERGE option. It implements the PartitionFinder algorithm, which tries to reduce the number of partitions to avoid over-parameterization. Perhaps you can try the relaxed clustering algorithm to speed up this analysis. All these are documented here: http://www.iqtree.org/doc/Advanced-Tutorial#choosing-the-right-partitioning-scheme Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/240566d8-edb1-43fb-826c-8b492e85cfacn%40googlegroups.com ", "Hi Minh, Thanks so much for getting back to me about this! I did go ahead and try with MFP+MERGE. It ran for a few days, then crashed before finishing the merge with \"WARNING: Too many iterations in tqli\" followed by \"ERROR: Numerical underflow (lh-branch). Run again with the safe likelihood kernel via `-safe` option\". There were also several instances of \" WARNING: ABNORMAL_TERMINATION_IN_LNSRCH\". Here is a link to the output: https://www.dropbox.com/s/uwrmyc7hkdbi6nd/plastid_gene_blocks.nex.log?dl=0 I have not tried yet with the relaxed clustering algorithm. Do you think from the results so far though, that it may be better to just do the concatenated analysis without partitioning on this dataset? Best, Joel ", "Hi Joel, It sounds like your very gappy alignments caused numerical issues if using complex models. If there is little information to estimate parameters of very complex models, IQ-TREE might struggle and many WARNINGs like this are a good indicator of over-parameterization. Therefore, Yes I\u2019d recommend just to use a single model without partitioning for your dataset. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/42d195f9-ab5c-4a41-95f6-367c69b0a90cn%40googlegroups.com ", "Hi Minh, I see, thanks so much for the advice! Best, Joel "]}, "UTRzfhg5ADY": {"topic": "Recommendations for handling coded indels?", "initializeDate": "Dec 2, 2020, 8:10:08 PM", "timeStamp": "Dec 3, 2020, 12:30:00 PM", "content": ["I have created a file indels.phy composed of coded indels, including multi-state indels, from cpDNA of alders (pop gen study). The indel states are coded as A (consistent with reference), B, C, D, and E (various indel forms). Most columns have just A and B forms. Does anyone have a suggestion how best to handle this data? I ran using -m MFP and the selected model was mtVer (mitochondrial amino acid substitution model) which is not likely the best fit.. I could convert the data to binary (presence/absence of every indel form) if there is not a good way to handle the multi-state data. Once I settle this, I plan to run a partitioned analysis combining coded indels and DNA alignments. thanks in advance ", "Hi George, I don\u2019t think that the chacters A, B, C, D, E are recognised in IQ-TREE. What did IQ-TREE say about type of your sequences that it detected when loading in the alignment file? I\u2019d encode them as 0, 1, 2, 3,\u2026 9, A, B, \u2026 Z (starting from 0, not A). Such alignment will be interpreted as morphological data, and you can specify GTR model for it. Cheerrs Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1c390f60-cf4b-48b2-aa10-26d5ab7d84e9n%40googlegroups.com ", "Hi Minh This is great, thank you. I will recode as 0,1,2,3,and 4. IQTree identified them as amino acids. George On Wed, Dec 2, 2020 at 10:44 PM Minh Bui < minh...@univie.ac.at > wrote: [This email originated from outside of OSU. Use caution with links and attachments.] To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2FC1E34C-68C8-4E7E-AFA0-A77E5B399F22%40univie.ac.at "]}, "NDcE-PVNguE": {"topic": "2 questions: FcLM with 1.6.12 and comparing AICc of codon version DNA models (partitioned)", "initializeDate": "Nov 30, 2019, 6:08:43 AM", "timeStamp": "Dec 2, 2019, 7:50:04 PM", "content": ["Hi all, I have 2 quick questions: 1) referring to the bug in 1.6.12 with -spp and FcLM: could this bug be fixed already (1.6.9 ran smoothly) 2) I have a small alignment (nuc protein coding) - now trying to find the best model for a) partitioned (1. codon pos, 2. codon pos, 3. codon position) and b) using a codon model (only one marker): Can I actually compare here the AICc or isn't this reasonable since the parameter space is probably completely different? Many thanks & best Karen ", "Hi Karen, On 30 Nov 2019, at 10:08 pm, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Hi all, I have 2 quick questions: 1) referring to the bug in 1.6.12 with -spp and FcLM: could this bug be fixed already (1.6.9 ran smoothly) I haven\u2019t had enough time to inspect this issue further. But will get to it next week. 2) I have a small alignment (nuc protein coding) - now trying to find the best model for a) partitioned (1. codon pos, 2. codon pos, 3. codon position) and b) using a codon model (only one marker): Can I actually compare here the AICc or isn't this reasonable since the parameter space is probably completely different? The AIC/BIC scores between DNA and codon models are directly comparable. So you can safely compare these scores from .iqtree file. However, they are not comparable with a protein model, one needs to perform some adjustment to the likelihoods and degrees of freedom. See Simon Whelan paper ( https://www.ncbi.nlm.nih.gov/pubmed/25209223 ). This method is now implemented in IQ-TREE version 2, with the --modelomatic option. Cheers, Minh Many thanks & best Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/a62cf6ae-e48e-4a89-af5a-2825bbffb9f6%40googlegroups.com "]}, "1YwSbuUxmJQ": {"topic": "Iq- tree webserver is not working?", "initializeDate": "May 17, 2020, 4:40:37 AM", "timeStamp": "May 17, 2020, 11:13:10 PM", "content": ["Hi, guys I'm trying to use IQ-tree webserver. When I download my aligned data and submit it, it says the server has a problem. What is going on? Best regards ", "Hi Bruno, I just tried to upload an example alignment and it works. Got the job running and the result. So can you describe what problem it is? A screen shot will help. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b51972d3-cbef-4839-bc6f-ff63ad72f865%40googlegroups.com "]}, "S6PTYRb7IpI": {"topic": "Issue with constraint tree", "initializeDate": "May 15, 2020, 12:39:31 PM", "timeStamp": "May 16, 2020, 9:04:16 PM", "content": ["Greetings, I'm having an issue with making an unrooted constraint tree file. The file is given below: ((cf_Poulinea_gomDur29,Majewska20C,Poulinea_Majewska5A,Poulinea_RMgomDur32,cf_Poulinea_gomDur87,Majewska14C,cf_Poulinea_gomDur89,Poulinea_TB0077,Poulinea_T11_ChelMyC,Poulinea_T3_ChelMyC,Poulinea_T8_ChelMyC,Poulinea_THgomF57,Majewska17C,Majewska21C,Majewska39a,Majewska40a,Chelonicola_caribeana_A24_CC032217a,Chelonicola_caribeana_B26_DeepCreek1,Chelonicola_caribeana_B33_DeepCreek1,Chelonicola_caribeana_T17_Ccskin,Chelonicola_caribeana_T15_Ccskin),(Tursiocola_Majewska9C,Medlinella_B,Majewska4C,Majewska3C,Majewska18C)); When I run the linux version of IQtree 1.6.12, I get the following error. Reading constraint tree EpiGoV9.constrPC.txt... ERROR: Rooted constraint tree not accepted Is the Newick format list above considered a root tree? Thanks in advance, Daryl ", "Hi Daryl, Somebody asked the same question a few days ago. So pls look up the forum. I believe you used a version earlier than 1.6.12, I\u2019m sure that this restriction was lifted in 1.6.12. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/81747dec-3fce-4f66-8bb4-cf490ec6ed66%40googlegroups.com "]}, "yOSR9bBUNOc": {"topic": "codon partition to construct gene tree", "initializeDate": "May 22, 2020, 3:27:15 AM", "timeStamp": "May 27, 2020, 6:32:36 PM", "content": ["Dear all: I had seen many examples to build gene tree using gene partition, however, i usually use concatenation method and codon partition to construct a tree because i used the mito genes (13pcg fo each sp), but now i want to try a coalescent method using -S, but it seems this can only be used in gene partition, and only if i make 13 files and each contain codon partitions for each gene, and the build the gene tree, is there simple way to do this? Regards Jiachen ", "Hi Jiachen, You should be able to use the very same partition file and alignment file and run something like: iqtree -s ALN_FILE -S PARTITION_FILE ... This is actually written here: http://www.iqtree.org/doc/Concordance-Factor Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/12fa6e1d-056b-49cc-a0d5-f68c65355ff4%40googlegroups.com ", "Dear Minh: Thanks for the reply, maybe i was not tell it clear, but if i use codon partition, then i had 39 partitions like: c1p1, c1p2, c1p3, and then i use the command like iqtree -s ALN_FILE -S PARTITION_FILE, then i think i will get 39 trees, not 13 gene trees, but i want to had gene trees build from codon partitions. Regards Jiachen \u5728 2020\u5e745\u670822\u65e5\u661f\u671f\u4e94 UTC+8\u4e0b\u53485:55:46\uff0cMinh Bui\u5199\u9053\uff1a Hi Jiachen, You should be able to use the very same partition file and alignment file and run something like: iqtree -s ALN_FILE -S PARTITION_FILE ... This is actually written here: http://www.iqtree.org/doc/Concordance-Factor Minh On 22 May 2020, at 5:27 pm, jiachen zhu < zjche...@gmail.com > wrote: Dear all: I had seen many examples to build gene tree using gene partition, however, i usually use concatenation method and codon partition to construct a tree because i used the mito genes (13pcg fo each sp), but now i want to try a coalescent method using -S, but it seems this can only be used in gene partition, and only if i make 13 files and each contain codon partitions for each gene, and the build the gene tree, is there simple way to do this? Regards Jiachen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "I don\u2019t know what is the problem here, if you want to build from different partitions, then change the partition file accordingly Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/220b7985-2ab5-4b41-bc96-0e4c435a33d0%40googlegroups.com ", "Hi Minh, I think I see the problem. Jiachen wants to generate 13 gene trees, using 13 alignments each with its own codon-partitioning file. As far as I know, this is not possible with -S, since using -S it isn't possible to specify the 13 partition files. Equally, trying to do it with -s aln -S partition means you get 39 trees (one per partition). Jiachen, I think the best solution for now is to simply write the partition files you want and then run 13 analyses. You can do this in 13 lines of code of course, or with a simple for loop in your favourite programming language if that's something you're comfortable with. Minh - one thing I wonder is if we could generalise the option -S to look for partitions inside each alignment file, if the alignment file is a nexus file. That would provide a very simple solution to the case (which I expect is fairly common) that a user wants to estimate gene trees and for some of those gene trees (e.g. protein coding genes) wants to specify particular partitions. Rob To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ABA62F47-9AF7-4961-AC1B-213D2DD9D9DF%40univie.ac.at Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "OK I understand now. To do this we need to extend the nexus format for partitions. However the nexus file is quite complicated and I would not do this. But this is something for the grant about the model format... Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmpAd_rNJpgDWZKPiV19D-K59SCZZsOOfrZf1ybABLbCoQ%40mail.gmail.com "]}, "UPWEhl-JM64": {"topic": "\"substitution rate fix\" problems", "initializeDate": "May 9, 2018, 5:05:40 AM", "timeStamp": "May 14, 2018, 2:50:27 AM", "content": ["I tried to apply the parameter from model finder to construct the phylogenetic tree. However, when i used the command \"/iqtree -s ITSalignedseqtree.fas -m TIM2{1.4323,2.7986,3.5779}+F+G4{0.3645} -nt 2\" it reported error: \"Reading input tree file TIM22.7986+F+G4{0.3645} ...ERROR: File not found or incorrect input, pls check it again.TIM22.7986+F+G4{0.3645}\" I examined the log file and it appeared that my command looked like: \"./iqtree -s ITSalignedseqtree.fas -m TIM21.4323+F+G4{0.3645} TIM22.7986+F+G4{0.3645} TIM23.5779+F+G4{0.3645} -nt 2\". Please help me to solve this problem. Thank you for your help P/S I also attach the print screen pictures of my command and the log file ", "Dear Qu\u1ef3nh, Quick fix: put the model string into double-quote, e.g.: -m \"TIM2{1.4323,2.7986,3.5779}+F+G4{0.3645}\u201d. Reason: Linux command line interprets curly-brackets with comma differently. Putting these into double or single quote will avoid this. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <Screenshot from 2018-05-09 16-00-37.png> <Screenshot from 2018-05-09 16-00-52.png> <ITSalignedseqtree.fas.log> ", "Thank you for your reply, I solved my problem V\u00e0o 19:46:15 UTC+7 Th\u1ee9 T\u01b0, ng\u00e0y 09 th\u00e1ng 5 n\u0103m 2018, Minh Bui \u0111\u00e3 vi\u1ebft: "]}, "pXwmRNVk0ic": {"topic": "ModelFinder crashes with large dataset", "initializeDate": "Aug 15, 2017, 2:57:43 AM", "timeStamp": "Aug 17, 2017, 5:49:30 AM", "content": ["Hi, I run IQTREE with command iqtree omp s input fas mem 120G st CODON m MFP alrt 1000 1000 pre bash for a rather big dataset (\" Alignment has 68 sequences with 2481972 columns and 2098161 patterns (1658205 informative sites, 490863 constant sites)\" as outputed by IQTREE. The run failed after ca 20hours. I'm sending the last lines of *.log file: NOTE ModelFinder requires 115859 MB RAM ModelFinder will test 195 codon models sample size 2481972 ... Model LnL df AIC AICc BIC F1X4 68114470.271 137 136229214.542 136229214.557 136230957.807 F1X4 68039394.328 138 136079064.656 136079064.671 136080820.645 F1X4 66930270.749 138 133860817.497 133860817.513 133862573.487 F1X4 66952819.104 139 133905916.208 133905916.223 133907684.922 STACK TRACE FOR DEBUGGING *** TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers *** Log file bash log *** Alignment files possible Do you have any idea what might be the source of this error? (besides the fact that ModelFinder would probably take incredible amount of time on 24CPUs with this dataset - so in case you might have suggestions how to elegantly limit the resources required by ModelFinder, I'll be glad for your suggestions). Please let me know if you need the full *.log file or any other information. (Previously I was receiving errors for this dataset due to large RAM requirements (over 200GB RAM) which I could not satisfy at this time so I tried a run with limiting the RAM to 120G via \"-mem 120G\" - might the insufficient RAM still be the problem?) Thanks and best regards, Ales ", "Hi Ales, That\u2019s indeed a big data set, and using codon models will slow down the analysis much further. My suggestion is to use \"-m TEST\u201d instead of -m MFP, so that the time consuming free-rate models are not considered. Regarding the abort: do you see any other assertion printed on the screen? (because assertions are not printed in the .log file in version 1.5.X or earlier). Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, thanks for your reply and suggestions. I'm trying now \"-m TEST\u201d. I will also try DNA models instead of the codon models. Concerning the abort: indeed, there were additional info printed: NOTE ModelFinder requires 115859 MB RAM ModelFinder will test 195 codon models sample size 2481972 ... Model LnL df AIC AICc BIC F1X4 68114470.271 137 136229214.542 136229214.557 136230957.807 F1X4 68039394.328 138 136079064.656 136079064.671 136080820.645 F1X4 66930270.749 138 133860817.497 133860817.513 133862573.487 F1X4 66952819.104 139 133905916.208 133905916.223 133907684.922 iqtree omp /home/ minh Dropbox iqtree git phylokernelnew 2670 double PhyloTree computeLikelihoodBranchGenericSIMD PhyloNeighbor PhyloNode VectorClass Vec4d SAFE_NUMERIC true FMA true SITE_MODEL false Assertion `!std::isnan(tree_lh) && !std::isinf(tree_lh) && \"Numerical underflow for lh-branch\"' failed. STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: bash.log *** Alignment files (if possible) /tmp/slurmd/job14175845/slurm_script: line 21: 340 Aborted (core dumped) /home/a/ales-bucek/bin/iqtree-omp-1.5.5-Linux/bin/iqtree-omp -s ${workingpath}/${SETNAME}/FcC_smatrix_nostops.fas -nt 24 -mem 120G -st CODON -m MFP -alrt 1000 -bb 1000 -pre ${SLURM_JOB_NAME} Could the \"-safe\" parameter help in this situation? Thanks and best regards, Ales ", "Dear Ales, As seen the message, -safe is already turned on for codon models [ SAFE_NUMERIC true ]. Thus specifying it does not help. Moreover, there are known numerical problem with codon model, which was fixed in version 1.5.5. Thus please make sure that you use version 1.5.5: Improved numerical stability for codon models (reported by Giorgio Matassi, Sarah Mathews, Ricardo Alves). Note that numerics may still fail if many codons are absent in the data. (see announcement: http://www.iqtree.org/release/v1.5.5 Moreover, -m TEST may have less numerical problems than -m MFP, because the more parameter-rich free-rate models are not considered. And yes, trying DNA models will certainly speed up the analysis. You may also try protein models by simply using option -st NT2AA, where IQ-TREE will automatically translate the protein-coding into protein sequences. Cheers, Minh ", "Hi Minh, thanks for the feedback! I'm indeed using v1.5.5. so that should not be the source of the error. (I'm now running IQ-TREE with either -m TEST and codon models -m MFP and DNA models) Best, Ales "]}, "sMBubgZFDqY": {"topic": "ERROR: Tree taxa and alignment sequence do not match - LSD2", "initializeDate": "Jun 17, 2020, 12:54:35 PM", "timeStamp": "Jun 17, 2020, 3:17:42 PM", "content": ["Hello, I am trying to use the new LSD2 dating method using the command: ./iqtree2 -s myalignment.fasta --date date_iqtree -te myphylogeny_rooted.tre -T AUTO However, I am running into the error Tree taxa and alignment sequence do not match. After checks and re-checks of labels names with grep and renaming my alignment labels with my tree labels using pxrls (Taxon relabelling for sequences from phyx), I realised that IQ-TREE might be complaining about the taxa that have identical sequences in my alignment and ignored. For example, when parsing the alignment, this is printed: NOTE: Chamaecrista_potentilla_Rando_1139_KX264356 (identical to Chamaecrista_lagotois_Rando_1029_KX264358) is ignored but added at the end And later IQ-TREE prints: ERROR: Tree taxon Chamaecrista_potentilla_Rando_1139_KX264356 does not appear in the alignment Is there a way around it? My phylogeny has almost 4,000 tips and it would be much faster to date it if I could include the topology. Thank you very much in advance, Fl\u00e1via ps. IQ-TREE keeps some taxa identified as identical eg. NOTE: Zygia_juruana_Iganci_879_KX374534 is identical to Zygia_cataractae_Bonadeu_647_KX374531 but kept for subsequent analysis. Why some identical taxa is kept and other discarded? ", "Dear Flavia, Indeed IQ-TREE reduces identical sequences to only two remaining. It does it basically to save running time and adds them at the end of the analysis, because identical sequences will end up in the same subtree anyways. Why are two kept? The reason is that this way IQ-TREE is able to infer support values for the branch to their subtree. This support might not be 1.0 or 100% for example in the case that there are sequences are almost identical but have some wildcards (e.g. N, Y, R\u2026 for DNA or X in proteins) or gaps. However, by adding the option \u201c-keep-ident\u201d to the command-line you can tell IQ-TREE to keep all sequences of the alignment and to not reduce identical ones. This will typically increase the runtime of the analysis, but sometimes this is not avoidable ;) I hope that helps you. Best wishes, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/271c5918-07d2-4e30-a0b4-9d7e1d5be918o%40googlegroups.com ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Hi Heiko, Thank you! All working fine now. With all best wishes, Fl\u00e1via To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/301CBE37-3723-46A7-95E6-0F0A4FBD577C%40univie.ac.at Fl\u00e1via Fonseca Pezzini University of Exeter | Royal Botanic Garden Edinburgh 20a Inverleith Row Edinburgh, EH3 5LR, UK Tel: +44 (0)131 248 2899 +44 (0) 7721445316 f.pe...@rbge.org.uk flavia...@gmail.com | skype: flaviapezzini1 Vamos preservar as Matas Secas tropicais da Am\u00e9rica Latina: veja a anima\u00e7\u00e3o! | Help Latin American Dry Forests: see our film http://elmer.rbge.org.uk/dryflor/ "]}, "zSWCr2WeSnc": {"topic": "Can't submit DNA alignment in web server", "initializeDate": "Jan 7, 2017, 4:21:42 PM", "timeStamp": "Jan 9, 2017, 11:33:45 AM", "content": ["Hi, I have the problem that I can't submit DNA (codon) alignments to the web server. The note I get says 'Sorry, there is an issue with the cluster system. We are trying to resolve it asap'. Initially I thought there really was a problem with the cluster but I realised I can submit protein alignments (127 sequences) without any problem. Is this a problem anyone else has? Thanks, Sybille ", "Hi Sybille, I was not able to reproduce your problem. Could you tell me which other parameters you specified? It would also be helpful if you could send me your alignment to my personal email address! Thanks, Jana You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Jana, I found the mistake, while preparing the file to send to you I realised that the only difference between the protein and DNA alignments were the brackets in the file names of the DNA alignments (from exporting it out of a different software). Thanks for your help! And sorry for taking your time for something so minor! Best wishes, Sybille ", "Hi Sybille, Great that you figured it out! I didn't know that brackets would cause such a behavior, thanks for pointing it out! Best, Jana Sybille "]}, "khnS3lrHn5c": {"topic": "BUG: iqtree -m 12.12 UNREST", "initializeDate": "Nov 2, 2020, 12:30:57 PM", "timeStamp": "Dec 3, 2020, 9:13:03 AM", "content": ["Hi! I am trying to infer the root of my alignment, as done in a recent preprint using iqtree By default RootDigger uses no rate categories, and currently only supports the UNREST model [27]. IQ-TREE was executed with the arguments iqtree -m 12.12 -s <MSA FILE> -g <TREE FILE> The -m 12.12 argument to IQ-TREE specifies that the UNREST model should be used [26] and the -g <TREE FILE> option constrains the tree search to the given user tree. When given an fully resolved unrooted tree, this has the effect of rooting the tree. ... https://doi.org/10.1101/2020.02.13.935304 (suppmat) but it almost immediatelly crashes with (full log attached): ... Computing log-likelihood of 1 initial trees ... 0.050 seconds Current best score: -37132.749 Do NNI search on 2 best initial trees ERROR: phylotree.cpp:3575: virtual NNIMove PhyloTree::getBestNNIForBran(PhyloNode*, PhyloNode*, NNIMove*): Assertion `node1->degree() == 3 && node2->degree() == 3' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 6 PhyloTree::getBestNNIForBran(PhyloNode*, PhyloNode*, NNIMove*) ERROR: 7 IQTree::evaluateNNIs(std::map<int, std::pair<Node*, Node*>, std::less<int>, std::allocator<std::pair<int const, std::pair<Node*, Node*> > > >&, std::vector<NNIMove, std::allocator<NNIMove> >&) ERROR: 8 IQTree::optimizeNNI(bool) ERROR: 9 IQTree::doNNISearch(bool) ERROR: 10 IQTree::initCandidateTreeSet(int, int) ERROR: 11 IQTree::doTreeSearch() ERROR: 12 runTreeReconstruction(Params&, IQTree*&) ERROR: 13 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 14 main() ERROR: 15 __libc_start_main() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: scuba_21oct_fullmtDNA.fasta.log ERROR: *** Alignment files (if possible) aln is a 14943 bp one of full mtDNA with > 200 seqs. (can be send if needed of course) any hint of what can be happening? thanks in advance, sara ", "Hi Sara, I discussed this with Ben and -g option does not work with non-reversible models. This preprint may contain outdated information. If you have a fully resolved unrooted tree and want to root it, please supply this tree with -te option and turn on --root-find. Moreover, by default IQ-TREE only searches the root up to 2 branches away from the current arbitrary rooting position. If you want to search thoroughly, you need to increase it with --root-dist option. So for example, iqtree -m 12.12 -s <MSA FILE> -te <TREE FILE> --root-find --root-dist 1000 Moreover, I wouldn\u2019t use 12.12 substitution model without rate heterogeneity. So better something like: iqtree -mset 12.12 -s <MSA FILE> -te <TREE FILE> --root-find --root-dist 1000 And IQ-TREE will automatically detect the best rate model for this 12.12 model. Please have a look at our preprint: Assessing Confidence in Root Placement on Phylogenies: An Empirical Study Using Non-Reversible Models View ORCID Profile Suha Naser-Khdour View ORCID Profile Bui Quang Minh Robert Lanfear doi: https://doi.org/10.1101/2020.07.31.230144 Suha (CC\u2019d) may provide additional information. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5942b474-09cd-42be-a51a-bd3d84de4cc3n%40googlegroups.com <iqtree_crash_log.txt> ", "uau, great, thanks lot for the fast reply! just a little question for now: in \"--root-dist 1000\", what are the \"units\" ??... you say the default is 2 steps away from the current root but then 1000? many thanks! Sara Rocha \u00b7 PostDoc Researcher CINBIO Phylogenomics Group Universidade de Vigo - Campus Universitario Lagoas Marcosende 36310 Vigo Tlf. +34 986 130 050 LAB WEB www.cinbio.es IUCN SSC Skink Specialist Group (Twitter: @skinks_IUCN) https://www.skinks.org/ Protecci\u00f3n de datos ", "sorry, one more doubt that seems silly but: now when trying to run the cmd you advised I get this (unrelated) error (somehow it was not happening before so maybe related with current options, but I don't know why). it complains of not finding all taxa from the tree in the aln, but they do are (they are read at start). maybe something to do with the sequences it \"ignores but added at the end\" (the identical ones)? but then there are 19 of those and it only specifically complains about 5 of those... any way to prevent this behaviour, or I'll really have to infer a tree with \"unique\" sequences? thanks! **** TOTAL 0.00% 0 sequences failed composition chi2 test (p-value<5%; df=3) NOTE: EUCE18_1027H_T is identical to EICE18_887H_T but kept for subsequent analysis NOTE: ENCE17_4511M_N is identical to EICE18_900H_N but kept for subsequent analysis NOTE: EICE18_906H_T is identical to EICE18_900H_T but kept for subsequent analysis NOTE: ENCE17_4528H_T1 is identical to ENCE17_4511H_T but kept for subsequent analysis NOTE: ENCE17_4531H_T is identical to ENCE17_4528H_T2 but kept for subsequent analysis NOTE: EPCE18_827H_T is identical to EOCE18_469F_T but kept for subsequent analysis NOTE: EUCE18_1015H_N is identical to EPCE18_826H_unk1 but kept for subsequent analysis NOTE: EUCE18_1018H_T is identical to EUCE18_1015H_T but kept for subsequent analysis NOTE: EUCE18_994H_T is identical to EUCE18_1031H_T but kept for subsequent analysis NOTE: FRCE17_840H_T is identical to FRCE17_701H_T but kept for subsequent analysis NOTE: IDCE19_636H_T is identical to ICCE19_431H_T but kept for subsequent analysis NOTE: N0_ICCE19_366F_N0 is identical to N0_ICCE19_364F_N0 but kept for subsequent analysis NOTE: PACE17_433H_T is identical to PACE17_421H3_T but kept for subsequent analysis NOTE: PVCE17_1351H_T is identical to PVCE17_1247H_T but kept for subsequent analysis NOTE: UGCE17_2333H_T is identical to UGCE17_2106H_T but kept for subsequent analysis NOTE: 19 identical sequences (see below) will be ignored for subsequent analysis NOTE: N0_EECE18_925F_N0 (identical to EICE18_900H_N) is ignored but added at the end NOTE: EPCE18_851H_T (identical to EICE18_900H_T) is ignored but added at the end NOTE: EPCE18_853H_T (identical to EICE18_900H_T) is ignored but added at the end NOTE: EUCE18_1024A_N (identical to EPCE18_826H_unk1) is ignored but added at the end NOTE: EUCE18_1032H_T (identical to EUCE18_1015H_T) is ignored but added at the end NOTE: EYCE18_9H_T (identical to EUCE18_1031H_T) is ignored but added at the end NOTE: PACE17_970H_T2 (identical to EUCE18_1031H_T) is ignored but added at the end NOTE: IXCE19_750H_T (identical to ICCE19_431H_T) is ignored but added at the end NOTE: IXCE19_759H_T (identical to ICCE19_431H_T) is ignored but added at the end NOTE: PACE17_569H_T (identical to PACE17_421H3_T) is ignored but added at the end NOTE: PACE17_668H_T (identical to PACE17_421H3_T) is ignored but added at the end NOTE: PACE17_670H_T (identical to PACE17_421H3_T) is ignored but added at the end NOTE: PACE17_947H_T (identical to PACE17_421H3_T) is ignored but added at the end NOTE: PACE17_959H_T (identical to PACE17_421H3_T) is ignored but added at the end NOTE: PACE17_970H_T1 (identical to PACE17_421H3_T) is ignored but added at the end NOTE: PACE17_976H_T (identical to PACE17_421H3_T) is ignored but added at the end NOTE: PVCE17_1395H_T (identical to PVCE17_1247H_T) is ignored but added at the end NOTE: PVCE17_1402H_T (identical to PVCE17_1247H_T) is ignored but added at the end NOTE: UGCE17_2401H_T (identical to UGCE17_2106H_T) is ignored but added at the end Alignment was printed to scuba_21oct_fullmtDNA.fasta.uniqueseq.phy For your convenience alignment with unique sequences printed to scuba_21oct_fullmtDNA.fasta.uniqueseq.phy Reading input tree file scuba_21oct_fullmtDNA.fasta.raxml.bestTree ... ERROR: Tree taxon PVCE17_1395H_T does not appear in the alignment ERROR: Tree taxon PACE17_569H_T does not appear in the alignment ERROR: Tree taxon UGCE17_2401H_T does not appear in the alignment ERROR: Tree taxon IXCE19_759H_T does not appear in the alignment ERROR: Tree taxon N0_EECE18_925F_N0 does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxon does not appear in the alignment ERROR: Tree taxa and alignment sequence do not match (see above) [uvibesrp@c6601 iqtree_rooting]$ ", "Hi Sara, Quick answer: use -keep-ident option to keep identical sequences in the alignment, so they won\u2019t be ignored in the analysis and match your tree file. The treatment is explained here: http://www.iqtree.org/doc/Frequently-Asked-Questions#how-does-iq-tree-treat-identical-sequences But indeed IQ-TREE should also detect this when reading the tree file. I\u2019ll fix that in a future release. Minh ", "Hi Sara again, the unit is the number of branches. So --root-dist 1000 means to search the root up to 1000 branches away from the initial root. This should be enough as you said to have a couple of hundred taxa. The maximal number of branches between any two taxa will be at most the number of taxa in the alignment. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAG%3Ds9gwzO-gZqO8%2Br%3DX8xKx%2BFgMWJhMBnP4nPB%2Bs4%3DJgnKHe4w%40mail.gmail.com ", "Great, thanks! I was puzzles because yesterday using the same alignment and tree (but -g options) it did not give this error -thus i thought It wqs options related and did not even searched the manual. Thanks! sent from my mobile. sorry for the short reply ", "Thanks again! sent from my mobile. sorry for the short reply To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/30B80672-80E5-421F-A0D3-D03C3B652B3B%40univie.ac.at ", "Hi again, so, I tried to run it now with your suggested cmds (and it now reads properly aln and tree): iqtree2 -mset 12.12 -s scuba_21oct_fullmtDNA.fasta -keep-ident -te scuba_21oct_fullmtDNA.fasta.raxml.bestTree --root-find --root-dist 500 but then: All model information printed to scuba_21oct_fullmtDNA.fasta.model.gz CPU time for ModelFinder: 546.613 seconds (0h:9m:6s) Wall-clock time for ModelFinder: 552.244 seconds (0h:9m:12s) NOTE: 42 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.010) Thoroughly optimizing +I+G parameters from 10 start values... Init pinv, alpha: 0.000, 0.677 / Estimate: 0.000, 0.163 / LogL: -36855.298 Init pinv, alpha: 0.100, 0.677 / Estimate: 0.101, 0.218 / LogL: -36853.487 Init pinv, alpha: 0.200, 0.677 / Estimate: 0.201, 0.290 / LogL: -36851.903 Init pinv, alpha: 0.301, 0.677 / Estimate: 0.302, 0.391 / LogL: -36850.569 Init pinv, alpha: 0.401, 0.677 / Estimate: 0.402, 0.552 / LogL: -36849.525 Init pinv, alpha: 0.501, 0.677 / Estimate: 0.501, 0.849 / LogL: -36848.894 Init pinv, alpha: 0.601, 0.677 / Estimate: 0.599, 1.566 / LogL: -36849.183 Init pinv, alpha: 0.701, 0.677 / Estimate: 0.659, 2.863 / LogL: -36851.264 Init pinv, alpha: 0.802, 0.677 / Estimate: 0.670, 3.321 / LogL: -36853.838 Init pinv, alpha: 0.902, 0.677 / Estimate: 0.690, 4.671 / LogL: -36857.869 Optimal pinv,alpha: 0.501, 0.849 / LogL: -39465.529 ERROR: modelfactory.cpp:1180: virtual double ModelFactory::optimizeParametersGammaInvar(int, bool, double, double): Assertion `fabs(tree->getCurScore() - bestLogl) < 1.0' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 6 ModelFactory::optimizeParametersGammaInvar(int, bool, double, double) ERROR: 7 IQTree::optimizeModelParameters[abi:cxx11](bool, double) ERROR: 8 runTreeReconstruction(Params&, IQTree*&) ERROR: 9 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 10 main() ERROR: 11 __libc_start_main() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: scuba_21oct_fullmtDNA.fasta.log ERROR: *** Alignment files (if possible) /var/log/slurm/spool_slurmd/job4795231/slurm_script: line 6: 10251 Aborted (core dumped) iqtree2 -mset 12.12 -s scuba_21oct_fullmtDNA.fasta -keep-ident -te scuba_21oct_fullmtDNA.fasta.raxml.bestTree --root-find --root-dist 500 [uvibesrp@fs6804 iqtree_rooting]$ any idea :( ? thanks in advance again! ", "Hi again, any idea on how to solve this problem now?? may it have to do with being a huge alignment (full mtDNA genome), and with it being trying to optimize a single model for it? for running the ML tree before I estimated different models for a bunch of partitions - is there a way to do it here for the non-reversible model, and would that help/be the correct way to do it? thanks again, sara ", "Hi, sorry to insist but can you have a look at the problem bellow? I've not been able to solve it... thanks in advance ", "Hi Sara, Sorry, I didn\u2019t have the time to look at this. Does it work if you don't use I+G model. Say by adding -m 12.12+G to the command line? Minh "]}, "5TnBw4QC0EE": {"topic": "IQ-TREE release 1.5.4", "initializeDate": "Apr 3, 2017, 3:08:51 PM", "timeStamp": "Apr 3, 2017, 3:08:51 PM", "content": ["Dear users, IQ-TREE version 1.5.4, downloadable at http://www.iqtree.org , was just released with the following news: Important changes: \u2022 If no model is specified via -m, IQ-TREE will perform the new model selection, ModelFinder (MF). Accordingly, two new options are introduced: -m MF (equivalent to -m TESTNEWONLY) and -m MFP (equiv. to -m TESTNEW). For backward compatibility TESTNEW will still be available but might be removed in a future release. \u2022 Combining standard bootstrap (-b) and constraint tree option (-g) will impose the constraint on bootstrap trees (previously not). Thanks to Matthew Prebus for discussions. New features: \u2022 The precompiled Linux executables are now backward compatible with the old Linux kernel 2.X, which resolves the error message \u201cFATAL: kernel too old\u201d. \u2022 Support input files with different newline formats to resolve conflicts between Mac, Windows or Linux files. \u2022 For data sets with identical sequences, redundant sequences are ignored. However, IQ-TREE will now keep two identical sequences (i.e. if five sequences A,B,C,D,E are identical to each other, then A,B are kept and C,D,E are ignored). This avoids incompatibility between bootstrap and non-bootstrap runs. \u2022 Warning about too many threads for short alignments (reported by Joran Martijn). \u2022 New option -wbsf to print individual bootstrap alignments and sitefreq files for standard bootstrap (requested by Huaichun Wang). Bug fixes: \u2022 Segfault caused by combining standard bootstrap, partition model and constraint tree (reported by Matthew Prebus). \u2022 Crash by -nni1 option (reported by Carlos Rivera). \u2022 Illegal instruction on older Mac which does not support AVX instruction set (reported by Richard Moir and Matthew Fullmer). \u2022 Crash when combining -mtree and -bb during model selection (reported by Chris Buddenhagen). We thank all users mentioned above, who helped to improve the stability of the software. Cheers, IQ-TREE development team "]}, "mjUkiv4BUwQ": {"topic": "Large constraint tree for a phylogeny", "initializeDate": "Mar 12, 2019, 12:19:12 PM", "timeStamp": "Mar 12, 2019, 11:41:59 PM", "content": ["Hi all, I have a question regarding the assembly of a constrained tree from an alignment and a constraint tree, along with a partition file (I'm using two genes). It looks something like this: iqtree -s my_alignment.phy -spp partition_file.nexus -m TESTNEWMERGE -bb 1000 -pre constrained_tree -g constraint_tree.newick There are ~1400 taxa in the alignment file and the same amount on the constraint tree. I left this particular model running for 2 days and nothing happened, it got stuck on this line: \"Creating fast initial parsimony tree by random order stepwise addition\u2026\" Am I doing something wrong or does using a constraint tree as large as the alignment take a really long time? Thanks, Max ", "Hi Max, Quick answer: Please try beta version 1.7 from here: https://github.com/Cibiv/IQ-TREE/releases Long answer: There is nothing wrong, the constrained tree search was known to be slow for many taxa. But good news is that we fixed it in version 1.7. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "EQF43SBu88E": {"topic": "Number of steps performed during the run", "initializeDate": "Jan 18, 2020, 1:46:32 PM", "timeStamp": "Feb 18, 2020, 7:34:21 AM", "content": ["Hi, I would like to compare the efficiency of different runs of iqtree on the same taxa, using different data at each run. In order to do that, I want to estimate the overall number of steps performed at each run. I see in the log file data about number of iterations, but I couldn't find the overall number of steps.( I could use the running time to estimate the efficiency, but I prefer using number of steps instead as it is more accurate for this purpose). Can I get this data somehow? Thanks! Noa ", "Hi Noa, Thanks for your interest. Perhaps you overlooked the log file, this line will give you this information: TREE SEARCH COMPLETED AFTER 102 ITERATIONS / Time: 0h:0m:4s Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4dfbc7f3-c0f7-4960-8642-3bad228705d1%40googlegroups.com ", "Hi, thanks!!! I'm not sure about using \"iterations\" as a measure of model efficiency and expected running time, when comparing different datasets on same taxa. I have few more questions- 1.For the same taxa , if I use dataset 1 with x loci, and then I use dataset 2 with 2*x loci, should I expect that each iterations during the run of dataset 2 will take x2 running time as well ? (If not, than I need some more detailed data about the number of steps that actually depend on the size of the given data) More general questions: 2. what is the exact defenition of the stopping rule? how is the convergence defined? 3. If I have a starting tree that I believe to be pretty close to the true one(but branch lengths are probably not accurate), than what default parameters should I change ? I thought I should change nstop and -pers, but I'm not sure how to determine their value based on the amount of data I have, and based on how much I believe the starting tree is close to the true . Thank you very much!!! Noa On Wednesday, January 22, 2020 at 2:49:22 AM UTC+2, Minh Bui wrote: Hi Noa, Thanks for your interest. Perhaps you overlooked the log file, this line will give you this information: TREE SEARCH COMPLETED AFTER 102 ITERATIONS / Time: 0h:0m:4s Cheers, Minh On 19 Jan 2020, at 1:46 am, Noa Ecker < n12...@gmail.com > wrote: Hi, I would like to compare the efficiency of different runs of iqtree on the same taxa, using different data at each run. In order to do that, I want to estimate the overall number of steps performed at each run. I see in the log file data about number of iterations, but I couldn't find the overall number of steps.( I could use the running time to estimate the efficiency, but I prefer using number of steps instead as it is more accurate for this purpose). Can I get this data somehow? Thanks! Noa You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Noa, Sorry for the delay - I\u2019m on annual leave. Answers below: On 22 Jan 2020, at 3:49 pm, Noa Ecker < n12...@gmail.com > wrote: Hi, thanks!!! I'm not sure about using \"iterations\" as a measure of model efficiency and expected running time, when comparing different datasets on same taxa. I have few more questions- 1.For the same taxa , if I use dataset 1 with x loci, and then I use dataset 2 with 2*x loci, should I expect that each iterations during the run of dataset 2 will take x2 running time as well ? (If not, than I need some more detailed data about the number of steps that actually depend on the size of the given data) Yes, the run time will scale linearly with the number of sites. So assuming 2*x loci have roughly twice the number of sites as x loci. More general questions: 2. what is the exact defenition of the stopping rule? how is the convergence defined? This was described in our original IQ-TREE papper ( https://doi.org/10.1093/molbev/msu300 ). Briefly, IQ-TREE stops after 100 consecutive iterations that no better tree was found. The 100 can be changed with -nstop option. 3. If I have a starting tree that I believe to be pretty close to the true one(but branch lengths are probably not accurate), than what default parameters should I change ? You can simply use -t TREE_FILE option to set the starting tree. I thought I should change nstop and -pers, but I'm not sure how to determine their value based on the amount of data I have, and based on how much I believe the starting tree is close to the true These options don\u2019t need to change - if your starting tree is good enough, then IQ-TREE might just stop after fewer iterations than without starting tree. Hope that helps, Minh Thank you very much!!! Noa On Wednesday, January 22, 2020 at 2:49:22 AM UTC+2, Minh Bui wrote: Hi Noa, Thanks for your interest. Perhaps you overlooked the log file, this line will give you this information: TREE SEARCH COMPLETED AFTER 102 ITERATIONS / Time: 0h:0m:4s Cheers, Minh On 19 Jan 2020, at 1:46 am, Noa Ecker < n12...@gmail.com > wrote: Hi, I would like to compare the efficiency of different runs of iqtree on the same taxa, using different data at each run. In order to do that, I want to estimate the overall number of steps performed at each run. I see in the log file data about number of iterations, but I couldn't find the overall number of steps.( I could use the running time to estimate the efficiency, but I prefer using number of steps instead as it is more accurate for this purpose). Can I get this data somehow? Thanks! Noa You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4dfbc7f3-c0f7-4960-8642-3bad228705d1%40googlegroups.com You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f37754bc-802c-4b3a-8486-ae46f6ad6223%40googlegroups.com ", "Thanks!!! To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f37754bc-802c-4b3a-8486-ae46f6ad6223%40googlegroups.com "]}, "zOUt2beyp6o": {"topic": "\"ERROR: Invalid model name GTR\" with partition scheme in RAxML format and specified codon model (-m SCHN05+F+I+G4)", "initializeDate": "Aug 17, 2017, 7:25:54 AM", "timeStamp": "Jul 7, 2018, 3:20:54 AM", "content": ["Hi! I'm runnin IQTREE v1.5.5. on linux as follows: iqtree omp s input fas m SCHN5 spp partitioning txt st CODON alrt 1000 1000 pre IQTREE33 I'm getting an error on the output (last couple of lines): Computing Juke Cantor distances ... Computing BIONJ tree ... 0.298 seconds Generating 1000 samples for ultrafast bootstrap seed 761280 )... ERROR Invalid model name GTR I guess there is problem with how I specified the partitions - the partitioning.txt file looks like this (just 1st two lines): DNA EOG090W001U 21846 DNA EOG090W002J 21847 31554 ...and apparently IQTREE ignores the codon model since also during listing the partitions, it outputs (again just few begining lines of the partition-related output): Partition file not NEXUS format assuming RAxML style partition file ... Reading partition EOG090W000W model GTR seq DNA pos 13248 ... sequences and 4416 sites extracted I'm not sure why there is \"GTR+F+I+G4\" - probably a default model in case IQTREE is missing a sensible model? The output is the same even if I put there a nonexistent model (some random letters) after the \"-m\" switch so therefore I expect it is completely ignored. Could you suggest me a way how to run IQTREE with a particular codon model and partitioning scheme? Let me know if you need me to send you any files ... Thanks and best, Ales ", "UPDATE: it seems that I succeded by substituting the \"DNA\" for \"CODON\" string in the partitioning file. Now the IQTREE run proceeds and ouptuts that the partitions are readed as follows (just 1st two lines): Partition file not NEXUS format assuming RAxML style partition file ... Reading partition EOG090W001U model seq CODON pos 21846 ... ...if that is the correct way how to set to analyze all the partitions with a specified codon model, my question is solved. Ales ", "Hi Ales, yes changing DNA to CODON is the right syntax for partitioned codon models. However, I recommend to use NEXUS partition file (instead of RAxML partition file), because it is more flexible (e.g. you can specify completely different models per partition). The problem with RAxML file right now is that, IQ-TREE will always assume GY+\u2026 codon models, even if you specify m SCHN5 G4. See this doc: http://www.iqtree.org/doc/Complex-Models#partition-models Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi, i was running Iqtree in windows these days, and I read the manual carefully, but I was confused about how to get a NEXUS partition file, just like the example in the manual ,where contains charset part1 = XXXXX; charset part2=XXXX charpartition mine = model 1 +G:part1 , moderl 2+I+G:part2; I can\u2018t find the answers in the manual. I also tried the partition scheme in PartitionFinder2, and I wang to compare with the two results. Could you suggest me a way to get the NEXUS partition file? Thanks Yunx \u5728 2017\u5e748\u670817\u65e5\u661f\u671f\u56db UTC+8\u4e0b\u53488:16:16\uff0cBui Quang Minh\u5199\u9053\uff1a "]}, "fwPF9EITl_A": {"topic": "Combined morphological and molecular data", "initializeDate": "Jul 11, 2019, 9:32:05 AM", "timeStamp": "Jul 14, 2019, 8:16:34 PM", "content": ["Hi all, I'm trying to run a combined morphology+molecular analysis. At first I got the error message of \"numerical underflow\" that calls for using the -safe option. I rerun with the -safe option but now I get the following error: WARNING: Numerical underflow for lh-branch ERROR: partitionmodelplen.cpp:142: virtual double PartitionModelPlen::optimizeParameters(int, bool, double, double): Assertion `cur_lh > tree_lh - 1.0 && \"partition rate opt reduces LnL\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: partitions.nex.log ERROR: *** Alignment files (if possible) I called IQtree with the following command: iqtree -spp partitions.nex -m TESTNEWMERGE -bb 1000 -safe My partition, log and alignment files are here: https://www.dropbox.com/s/etm6by8mdb0ewv8/Santos_IQtree_combined_alignments.zip.zip?dl=0 Would really appreciate any insight here! Thanks! ", "I use a partitioned nexus file #nexus begin sets; charset part1 = mol117.nexus: 1-769; charset part7 = morfo117p.nexus: 1-39; charpartition mine = TIM3e+I+G4:part1, MK+ASC:part2; end; and use this command bin\\iqtree -sp partitionedctst.nex -alrt 1000 -bb 1000 -bnni works fine Eric de Camargo Smidt Prof. Associado II Laborat\u00f3rio de Sistem\u00e1tica e Ecologia Molecular de Plantas Departamento de Bot\u00e2nica, sala 446 Setor de Ci\u00eancias Biol\u00f3gicas Centro Polit\u00e9cnico - UFPR Caixa Postal 19031 Cep 81531-990 Curitiba, PR - Brasil e-mail: ecs...@ufpr.br http://orcid.org/0000-0002-1177-1682 https://publons.com/researcher/2905687/eric-smidt/ http://lattes.cnpq.br/1539716845687200 https://sites.google.com/view/lsemp-ufpr You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/bba6d73d-3084-4e2d-a8e5-65202a381ca5%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Hi Bernardo Santos, Thanks for the report. I confirm that there is a bug with -spp option and mixed data type. We will fix in the next release. So please wait until I send further notice. However, there is also a problem with your data: the DNA and morphology partitions have no taxa in common. So please check it out. Cheers, Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAN3iz%2BkJW-5B_KMgR1CK4s3vpjVFOseoXuT6WBQpiLoByyMHyg%40mail.gmail.com ", "Sorry, to be more precise: this bug happens in the model selection step with these two options. Otherwise, iqtree works fine as Eric pointed out below. So as a quick workaround, you can do the following: perform model selection separately for DNA and morphology data. Then look at the two partition files, combine them into one file by merging the two charpartition commands. And now you can run iqtree on this combined partition file. Cheers, Minh "]}, "BpKkjwp-EYo": {"topic": "the problem of Partitioned analysis for multi-gene alignments", "initializeDate": "Sep 17, 2020, 8:17:38 AM", "timeStamp": "Sep 18, 2020, 12:52:54 AM", "content": ["Hi \uff0c I want to use supermatrix conbining with multi-gene to establish phylogenetic tree using Partitioned analysis my command line \uff1aiqtree -s supermatrix.phy -p supermatrix.nex the error \uff1aExpecting floating-point number, but found \" supermatrix.nex \" instead then i use example to do \uff0c unfortunately\uff0c the error\uff1a\u201cExpecting floating-point number, but found \"example.nex\" instead\u201d why\uff1f Can you tell me \uff1f Thanks ", "Hi there, try using -spp instead of -p. Cheers, Olga You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/171b9904-e9e3-4742-8f50-8e751536863dn%40googlegroups.com ", "Thanks\uff0cOlga ", "This is because you used version 1.x, where the option is -spp. In version 2 we change this option to -p for short. But -spp is still working in v2 for backward compatibility. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/3b457724-04bf-4ba6-a15e-f398caa29693n%40googlegroups.com ", "thank you Minh "]}, "Y5qF_HWY0kI": {"topic": "how to update iqtree version in Linux", "initializeDate": "Jul 24, 2019, 3:46:30 PM", "timeStamp": "Jul 25, 2019, 1:08:18 AM", "content": ["Hi, Just a simple question, could you tell me how to update the version of iqtree in Linux 64-bit? Now my version is 1.3.11.1. Thank you very much. Best wishes Zhifang ", "Hi Zhifang, See http://www.iqtree.org/doc/Quickstart#installation Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/63e0b1e3-9748-486a-8e9e-042d06264e1a%40googlegroups.com "]}, "x6haUQmYRzU": {"topic": "seeking recommendations for large trees with difficult tree searching", "initializeDate": "Jul 20, 2020, 11:04:43 PM", "timeStamp": "Jul 24, 2020, 11:53:31 AM", "content": ["Hi, I have several datasets that are quite large: 1'000 taxa and a pretty sparse data matrix with 72'000 sites. I'm seeking advice on how to go about inferring this phylogeny. I have tried doing many default iterations (50x) with different seed numbers, and I have tried doing follow-up --allnni runs (10x), using the best tree out of my default runs as a starting tree. But even with 60 runs total, only one analysis found the best-scoring topology, leading to low confidence that I have found the best topology given the data. I'm wondering what the best strategy here might be. Is it: (1) many independent runs with different seed values, with default settings? (2) many independent runs, followed by additional runs with --allnni? (3) not quite as many iterations, but with changes to the default settings, for example with different values set for -nstop and for -pers, as suggested in the documentation? (4) some other recommendation? Advice greatly appreciated. Thanks! -Pascal ", "Hi Pascal, I think you're on the right track. My suggestion would be: lots of analyses with different starting trees, and for each analysis change the settings to be as rigorous as you can (this depends on how long you want to wait, how much compute you have, and how much you care). However, I think some more general advice might also help. With a large tree and a sparse alignment the likelihood surface is likely to be pretty flat. This accords pretty well with your observation that different analyses seem to give different trees, and only one analysis so far found the best tree you've seen. There are two things to think about here. First, no heuristic search can ever guarantee it has found the best tree (that's the definition of heuristic search). So even you run 1000 analyses and 50 of them find the same 'best' tree, you can never be certain this is the ML tree (that's true of all phylogenetic software - there are too many possible trees to ever be sure). Second and more importantly, it's likely from what you've laid out that the differences in likelihood between your trees are very very small. If this is the case it's probably unlikely that any of these differences are meaningful either statistically or biologically. In these situations, it's never a good idea to rely a lot on a single tree. Instead, you should look into ways of estimating a range of trees that fit your data roughly equally well. In a likelihood framework you can do this with nonparametric bootstraps and concordance factors. But your situation is probably better suited to a Bayesian framework, where the whole aim is to estimate a distribution of plausible trees (along with estimates of how plausible each one is), rather than the likelihood framework which is centered around a paradigm of estimating a single 'best' tree. In your case there probably is no meaningful single 'best' tree. In terms of practical advice, this means that it may be better to spend your time working on estimating a plausible set of trees, rather than working hard to find an estimate of a single 'best' tree. MrBayes or ExaBayes would certainly be worth looking at for the Bayesian analyses. The likelihood analyses (nonparametric bootstraps, concordance factors) can be done in IQ-TREE and details are in the documentation. Sorry - long email and I know it goes off the original question quite a bit! Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b515251a-08c2-48af-9411-1cdcd4a54981n%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Rob, thanks for this very helpful reply! This all makes a lot of sense, and I will keep these suggestions in mind as I move forward. -Pascal ", "Hi Pascal, Rob gave excellent advice! I\u2019m just adding a few more things that might help, mainly in terms of processing the data before even trying to reconstruct a tree: - Because both ML and Bayesian methods will have convergence issue for such sparse dataset, I believe the best solution here is to reduce the sparsity of your matrix. For example, sequence the missing genes. - Alternatively, try to remove sparse sequences and very gappy sites or genes from your alignment. For example, those with >20% gaps. This threshold is arbitrary and you can play around it until the result tree becomes more stable. - Remove \u201crogue\u201d taxa, i.e., those sequences that jump around and distort bootstrap supports. Tools like RogueNaRok can be applied. On another note, you can also obtain a set of plausible ML trees by performing tree topology test such as AU test on the set of trees found from different runs. You can then look at the consensus tree, and/or doing some statistic like concordance factor or internode certainty to pick up tree that is most concordant with the gene trees. Good luck ;-) Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/917739bd-6289-472b-94d5-1cfd8dd70cf0n%40googlegroups.com ", "Thanks Minh, those are also excellent suggestions that I will keep in mind. "]}, "YN2SBK7W_T0": {"topic": "W-IQ-TREE partition models", "initializeDate": "Sep 23, 2020, 9:55:29 PM", "timeStamp": "Oct 6, 2020, 9:27:14 PM", "content": ["Hello, I would like to know if there is a way to force W-IQ-TREE use the models for each partition previously generated by PartitionFinder2 and included in the partition file. I uploaded the partition file to the web server, but, although the analysis took the partitions into consideration, it ignored the extant models in the file and calculated new models for each partition... Best regards, Gabriel ", "Hi Gabriel, Can you please attached the partition file that you used for the IQ-TREE run? PartitionFinder generate a summary file and I\u2019m not sure if you have taken the right part in that part. Also make sure to use a plain text file, instead of some other format (e.g. rich text). Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/27c03cca-540e-4560-814e-7269f4958b4bn%40googlegroups.com ", "Hi Minh. Please, find attached the file with the partition and models from PartitionFinder. I used on the server http://iqtree.cibiv.univie.ac.at/ but it only recognizes the partitions, not the models. Edit: I was not able to attach the file, so I copied and pasted below: #nexus begin sets; charset part1 = 1-566; charset part2 = 567-1224\\3; charset part3 = 568-1222\\3; charset part4 = 569-1223\\3; charset part5 = 1663-2059\\3 1225-1660\\3; charset part6 = 1226-1661\\3; charset part7 = 1227-1662\\3; charset part8 = 1664-2057\\3 1665-2058\\3; charpartition PartitionFinder = GTR+I+G:part1, GTR+G:part2, GTR+I+G:part3, K81u+I:part4, TVM+G:part5, TNe+I+G:part6, F81+I:part7, TNe+I:part8; end; ", "Hi Gabriel, I see the problem now. Your partition file looks just fine, but the web server insisted on finding the model itself, Due to the option \u201cSubstitution model\u201d is set to \u201cAuto\u201d. If you look at the log, you\u2019ll see the command line option \u201c-m TEST\u201d is added, but this is not what you want. I just tried to play around with it to change this default behaviour, but couldn\u2019t find a way to go around it. Therefore, I suggest that you download IQ-TREE and run it locally without \u201c-m TEST\u201d option, then IQ-TREE should take the models in the partition file into account. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6f8c772f-18b8-4365-b3e4-7fd6658260d8n%40googlegroups.com "]}, "WVGhakvxWLY": {"topic": "Phylogenetic dating: calibration problem", "initializeDate": "Aug 15, 2020, 1:00:26 AM", "timeStamp": "Aug 20, 2020, 7:25:46 PM", "content": ["Hi, I have a problem when trying to calibrate a tree. When I add two calibration points, the analysis runs as it supposed to be (as far as I can understand) and yields 'timetree' files. However, when I add a third calibration point (near the tree root), the analysis fails and does not produce 'timetree' files. Instead, this is what I get in the log file: --- Start phylogenetic dating --- Reading date file date.txt ... 3 dates extracted Building time tree by least-square dating (LSD) with command: lsd -i rRNA.nex.timetree.subst -s 2941 -o rRNA.nex.timetree -f 100 -r a -d rRNA.nex.timetree.date -z 0 TREE 1 *PROCESSING: Reading the tree ... Collapse 0 (over 201) internal branches having branch length <= 0.00017 (settable via option -l) Parameter to adjust variances was set to 0.0156 (settable via option -b) Minimum branch length of time scaled tree (settable via option -u and -U): 2.81, rounded to 2.81 (281/100) using factor 100 (settable via option -R) Any suggestions? ", "Hi, Is it possible to send me your input tree (rRNA.nex.timetree.subst) and date file (rRNA.nex.timetree.date) via my email if you prefer ( toth...@gmail.com )? I'll try to see which causes the issue. Cheers, Hien You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b2bf1d6c-4cf1-4ed1-9b32-80ca5d3c9e12n%40googlegroups.com ", "Hi, Thanks for sending me the data. It looks like a bug that I have fixed from version 1.8.4 of lsd2 but have not been integrated in iq-tree. Either you could install lsd2 from the most up to date master branch of lsd2 and run it using the LSD command suggested by iq-tree above, or you can wait until @Minh Bui includes the new version. @Minh Bui In the new version 1.8.5, I've fixed some bugs related to some cases of rooting and outgroup removal. It'd be great if you include it in iq-tree. Thanks. Hien ", "Dear Hien, Honestly, I do not understand what I need to do. Where is that \" up to date master branch of lsd2\"? Please keep in mind, I am just a dummy user of your software, so that I need clear instructions how to use it, preferably step-by-step. Best, Volodymyr To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAKjtwTxuRwoNd0CoD%3DyCTV6-Qjdiy3%3D1%3D0h4b4REcas5ZckPVQ%40mail.gmail.com ", "Hi Volodymyr, The lsd2 github repo is here: https://github.com/tothuhien/lsd2 You need to clone it by typing the following in a terminal: git clone https://github.com/tothuhien/lsd2 and follow the instructions on that page to compile the program (assuming you use linux or mac). Once you have the binary file lsd2, you can run it on your data, for example: ./lsd2 -i rRNA.nex.treefile -s 2941 -o rRNA.nex.timetree -f 100 -r a -d rRNA.nex.timetree.date -z 0 If you have problems with this, we can discuss more possibly via email. Cheers, Hien To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CADymio-q58MCdJkEiAn1FNqRcsnbS0aOjvAjTv5Bd%3DuP5Pqrwg%40mail.gmail.com ", "Dear Hien, Thanks a lot for your instructions. However, I have Windows. Best, Volodymyr To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAKjtwTwGLKLna-%3D5pMC8RLwE7f9-6VBj0b1LiUy3BMRC%2BYXwqA%40mail.gmail.com ", "Hi Volodymyr, We\u2019ve just released iqtree 2.1.1 that integrates the latest lsd2 code. Downloads from www.iqtree.org Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CADymio-4RtQ-Ycxu85aAwe8gCRbTvVN0ngVHurHkkJz5QrvYAQ%40mail.gmail.com "]}, "VojrrVUdlJE": {"topic": "How to generate a single p-value from AU test", "initializeDate": "Apr 4, 2019, 6:02:46 AM", "timeStamp": "Apr 9, 2019, 9:25:59 PM", "content": ["Dear IQ-TREE staff, I wish to using AU test on IQ-TREE to test the compatibility between my nuclear DNA ITS and Plastid markers, following the parameter (iqtree -s ITS.phy -m GTR+G -n 0 -z Plastid.trees -zb 10000 -au ) in the Cipres online service. But in the output file, I have 1000 p-values, one for each tree in the set of trees (Fig.1). While when I applied a best tree (.tree file) or a constraint tree (.newick file), there is no p-value at all (Fig.2). I wonder, in what way can I obtain a single p-value? What's wrong with my parameter setting or my uploaded tree/trees file? Best Lei Duan ", "Hi Lei Duan, That\u2019s right, because the AU test (and other tree tests) work on a set of at least 2 trees: it compares each tree with the best tree in the set. Having a single tree won\u2019t invoke the test. Btw, you should make sure to always have the best-known tree in this set! And look at .iqtree file for AU test p-values. They have much higher precision than the log file. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <Fig.1.jpg> <Fig.2.jpg> "]}, "YsgBIeW1c3k": {"topic": "difference LG+C40 and LG+C40+G", "initializeDate": "Jul 2, 2018, 12:11:30 PM", "timeStamp": "Jul 9, 2018, 8:16:59 PM", "content": ["Hi Bui Quang Minh, Is there a difference between running -m LG+C40 and -m LG+C40+G? The manual says that C10 to C60 \"assume Poisson AA replacement and implicitly include a Gamma rate heterogeneity among sites.\" Does that mean that gamma is employed automatically and there is no difference? If, however, there is a difference, why are the .rate files obtained with the following two commands exactly identical? -s file.fasta -m LG+C40 -wsr -te allboottrees.suptree -n 0 -s file.fasta -m LG+C40+G8 -wsr -te allboottrees.suptree -n 0 I also realized that although G8 is called, only four categories are used?! Thanks you! ", "Hi there, On 3 Jul 2018, at 2:11 am, stra...@protist.eu wrote: Hi Bui Quang Minh, Is there a difference between running -m LG+C40 and -m LG+C40+G? The manual says that C10 to C60 \"assume Poisson AA replacement and implicitly include a Gamma rate heterogeneity among sites.\" Does that mean that gamma is employed automatically and there is no difference? There is no difference between these two runs. LG+C40 implies LG+C40+G. If, however, there is a difference, why are the .rate files obtained with the following two commands exactly identical? -s file.fasta -m LG+C40 -wsr -te allboottrees.suptree -n 0 -s file.fasta -m LG+C40+G8 -wsr -te allboottrees.suptree -n 0 I also realized that although G8 is called, only four categories are used?! Short answer: change to \u201c-m LG+G8+C40\u201d to have the wanted effect (8 rate categories). Long explanation: If you run -m LG+C40+G8, you\u2019ll see something like this in the log: Model LG+C40+G8 is alias for LG+POISSON+G+FMIX{C40pi1:1:0.0223853788,C40pi2:1:0.0338891820,C40pi3:1:0.0577169375,C40pi4:1:0.0252416233,C40pi5:1:0.0108607921,C40pi6:1:0.0462373793,C40pi7:1:0.0102293175,C40pi8:1:0.0147523625,C40pi9:1:0.0143161352,C40pi10:1:0.0182302541,C40pi11:1:0.0204025079,C40pi12:1:0.0425505156,C40pi13:1:0.0248627269,C40pi14:1:0.0105892988,C40pi15:1:0.0188238725,C40pi16:1:0.0086663445,C40pi17:1:0.0148496147,C40pi18:1:0.0343037402,C40pi19:1:0.0225335203,C40pi20:1:0.0174068578,C40pi21:1:0.0112207827,C40pi22:1:0.0443532245,C40pi23:1:0.0392573370,C40pi24:1:0.0196756555,C40pi25:1:0.0287690328,C40pi26:1:0.0114441177,C40pi27:1:0.0112338740,C40pi28:1:0.0582694099,C40pi29:1:0.0444272279,C40pi30:1:0.0112010942,C40pi31:1:0.0145176111,C40pi32:1:0.0114629026,C40pi33:1:0.0239628061,C40pi34:1:0.0266266492,C40pi35:1:0.0481201159,C40pi36:1:0.0371147423,C40pi37:1:0.0160476688,C40pi38:1:0.0237249267,C40pi39:1:0.0235226203,C40pi40:1:0.0261998398}+G8 While parsing this full model string from left to right, \u201c+G\u201d occurs first before \u201c+G8\u201d, and therefore it is taken as Gamma model with default 4 categories. If you now do LG+G8+C40, then you\u2019ll see: Model LG+G8+C40 is alias for LG+G8+POISSON+G+FMIX{C40pi1:1:0.0223853788,C40pi2:1:0.0338891820,C40pi3:1:0.0577169375,C40pi4:1:0.0252416233,C40pi5:1:0.0108607921,C40pi6:1:0.0462373793,C40pi7:1:0.0102293175,C40pi8:1:0.0147523625,C40pi9:1:0.0143161352,C40pi10:1:0.0182302541,C40pi11:1:0.0204025079,C40pi12:1:0.0425505156,C40pi13:1:0.0248627269,C40pi14:1:0.0105892988,C40pi15:1:0.0188238725,C40pi16:1:0.0086663445,C40pi17:1:0.0148496147,C40pi18:1:0.0343037402,C40pi19:1:0.0225335203,C40pi20:1:0.0174068578,C40pi21:1:0.0112207827,C40pi22:1:0.0443532245,C40pi23:1:0.0392573370,C40pi24:1:0.0196756555,C40pi25:1:0.0287690328,C40pi26:1:0.0114441177,C40pi27:1:0.0112338740,C40pi28:1:0.0582694099,C40pi29:1:0.0444272279,C40pi30:1:0.0112010942,C40pi31:1:0.0145176111,C40pi32:1:0.0114629026,C40pi33:1:0.0239628061,C40pi34:1:0.0266266492,C40pi35:1:0.0481201159,C40pi36:1:0.0371147423,C40pi37:1:0.0160476688,C40pi38:1:0.0237249267,C40pi39:1:0.0235226203,C40pi40:1:0.0261998398} Since +G8 appears first in this model string, it \u201ctricks\u201d IQ-TREE to interpret it as 8 Gamma categories. Hope that helps, Minh Thanks you! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi, Thanks for the fast reply! So it is impossible then to run iq-tree with LG+C40 only? I am asking since the model test favored LG+C40 over LG+C40+G. What would iq-tree do if I run a tree with -m TEST (and the best model is C40 without gamma)? Would it ignore its own test and run it with gamma? Best, Jurgen ", "I am attaching the model test here to make clear what I mean. How should I interpret the output when C40 and C40+G is the same and why are the values different then? ", "Hi Jurgen, Can you send me the log file via my personal email? Will have closer look to see why this output\u2026 Minh <Output_telo.fasta.iqtree> ", "Hi Minh, I have one more question that is related to the one below. I understand now that gamma with default 4 categories is used when it is not specified at first appearance. But what happens with +F? Let's say I used: -s file.fasta -m LG+C40+G8+F -wsr -te allboottrees.suptree -n 0 Will +F still be considered or be ignored just like +G8 because it is at a wrong position in the string? Thank you! Am Dienstag, 3. Juli 2018 05:07:16 UTC+2 schrieb Minh Bui: ", "Hi Juergen, +F will be considered. I.e. your model below is a profile mixture model with 41 classes, 40 from C40 and one from +F class. The discussion was only concerning +G. Cheers Minh "]}, "cPujHIMeCYA": {"topic": "How to run IQTREE faster while maintaining accuracy for large dataset", "initializeDate": "Jun 23, 2020, 1:41:58 AM", "timeStamp": "Jul 3, 2020, 6:27:50 PM", "content": ["Hello, We are running about 20,000 sequences with an average length of 1,000~1,200 amino acids (aligned). The code we ran is taking nearly two months to complete, so we are looking for ways to make the process faster while maintaining the accuracy of the tree. These are the options we used: iqtree(v1.6.12) -s PEP.fa -alrt 1000 -bb 1000 -nt AUTO -safe 1. Is there an option like \"-bo -pre\" to split bootstrap runs for SH-aLRT test and ultrafast bootstrap? 2. We installed IQTREE-2 and are thinking of using iqtree-mpi and limiting model choices with \"-mset nuclear\" to quicken the process. Are there any other options we could use? Thank you for your time. Best Regards, Jenny ", "Hi Jenny, MPI may help, though your alignments are not very long so I'm not totally sure on how much you will be able to speed things up. How many processors does it select under -nt AUTO? If it's a small number, I'm pretty sure MPI can't help you. The best way for us to understand how to help you speed it up would be to post your log file. That would let us see what is taking the most time. For example, my intuition is that it's unlikely to be the model selection, but rather just the challenge of inferring a tree with 20K sequences. IQ-TREE does tend to get slower with more than about 10K sequences, so it would be worth trying out raxml-ng and/or fasttree as well (or just try both, and compare the lnLs by re-running the fasttree tree in raxml-ng). Both of those pieces of software are more optimised for very large datasets. Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0acbc81f-e0d0-4be5-a682-b129f1fbded2o%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Dear All, We are working on a fast version that works with >10K sequences datasets. Details will follow next week. Please note that using MPI version is perfectly fine as it does not depend on the sequence length, whereas multi-threading does not scale well with such short sequences. Moreover, even the ultrafast bootstrap will become slow for such large dataset. So I\u2019d suggest just to use the SH-aLRT test. To speed up ModelFinder further, you can use option -m TEST, to ignore the free-rate model. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmrqwpNGCM%3DT6f_doVx2P0p3aXoy4ibswjih%3D7ZjTrJRGg%40mail.gmail.com "]}, "D_9irNNn5BQ": {"topic": "Shimodaira-Hasegawa test for incongruence", "initializeDate": "Apr 23, 2020, 11:44:11 AM", "timeStamp": "Apr 28, 2020, 9:04:13 AM", "content": ["Dear IQ-TREE Users, I am trying to learn how to use the IQ-TREE for Shimodaira-Hasegawa test for incongruence. I have two separate alignments with their respective trees (generate using ML in IQ-TREE). My questions: 1) Besides the trees, do I need to concatenate the two alignments in order to use in the following command? If not, does it mean that I have to run two separate analyses? One, with the first alignment and the two trees, and then the other alignment with these trees again? iqtree -s alignment.phy -z concatenated_tree.nxs -zb 1000 -au -zw 2) How does IQ-TREE know what tree to use as the reference? Regards, Harris ", "Dear Harris, > On 23 Apr 2020, at 17:44, Harris < do79h...@gmail.com > wrote: > Dear IQ-TREE Users, > I am trying to learn how to use the IQ-TREE for Shimodaira-Hasegawa test for incongruence. > I have two separate alignments with their respective trees (generate using ML in IQ-TREE). My questions: > 1) Besides the trees, do I need to concatenate the two alignments in order to use in the following command? > If not, does it mean that I have to run two separate analyses? > One, with the first alignment and the two trees, and then the other alignment with these trees again? You do not concatenate the alignments, but run two different analysis. What these tests do is testing whether the maximum likelihood values you obtain for some trees are significantly worse than those of other trees. So you would concatenate all trees in one treefile (make sure you remember which trees are which ;) Then you would run the tree tests using all trees in the treefile for each of the alignments. The tests will then tell you for each alignment, which trees are significantly worse. Those trees which are not marked as significantly worse they are a possible scenario/hypothesis for this alignment and cannot be discarded even if their likelihood value is lower. Giving an example, imagine two genomic regions of a certain RNA virus. If you obtain two different trees, what could be the reason? One thing that comes to mind are recombination breakpoints between the two regions. However, we have also seen cases where in one of the regions the tree reconstructed from it was significantly better. But in the other region none of the trees could be rejected. There are several other reasons which might lead to this scenario like missing phylogenetic information. If the latter region is very conserved there might be not enough divergence to reconstruct a tree with certainty. Moreover, if the latter region if to divergent the information to reconstruct the tree with certainty might be lost in mutational noise. In these cases we cannot discuss recombination as the cause, because we do not have a solid hypothesis in the latter region. (Cf. the Tree Topology Testing chapter in The Phylogenetic Handbook by Salemi et al., 2009) > iqtree -s alignment.phy -z concatenated_tree.nxs -zb 1000 -au -sew > 2) How does IQ-TREE know what tree to use as the reference? These do not use a reference. Tests like Kishino-Hasegawa (KH), Shimodaira-Hasegawa (SH) or the approximately unbiased test (AU) do treat all trees the same. So there is no order involved. Unfortunately, people have (mis)used the KH test in the past to test the ML tree against every other tree in question. However, this is not the way KH was defined. It assumed both trees could be the better one and used a two-sided test. Giving the ML tree first and another tree second, as frequently done and published in the past, was wrong because than a single-sided test should have been used. If interested please check with Goldman et al. (2000, in Syst. Biol. 49(4)) or in the chapter on Tree Topology Testing in The Phylogenetic Handbook by Salemi et al. (2009). Best wishes, Heiko > Regards, > Harris > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7a9e3362-3580-4202-a41f-5b58e34d359f%40googlegroups.com ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Dear Heiko, Thanks so much for your comprehensive response. For each of the two alignment files (alignment-1 and alignment-2) that I have, I opted to generate a ML tree using the following command: iqtree -s alignment.phy So, I ended up with two separate ML tree files (one from from alignment-1 and the other from alignment-2). I'm not sure if my next step was correct, but I then concatenated these two tree files - and that is what I used in the command below: iqtree -s alignment.phy -z concatenated_treels -zb 1000 -au -zw Was that right - concatenating the two ML trees from the two alignments? For the -s in the above (second) command, I used alignment-1 for the first analysis, then alignment-2 for the second analysis (with the same concatenated ML trees for the -z option). Kindly clarify. Pardon my ignorance, I am very new to this IQ-TREE. Regards, Harris ", "Hi Harris, Heiko gave a very nice answer (thank you ;-). Now to your new questions: > On 24 Apr 2020, at 4:54 am, Harris < do79h...@gmail.com > wrote: > Dear Heiko, > Thanks so much for your comprehensive response. > For each of the two alignment files (alignment-1 and alignment-2) that I have, I opted to generate a ML tree using the following command: > iqtree -s alignment.phy > So, I ended up with two separate ML tree files (one from from alignment-1 and the other from alignment-2). I'm not sure if my next step was correct, but I then concatenated these two tree files - and that is what I used in the command below: > iqtree -s alignment.phy -z concatenated_treels -zb 1000 -au -zw > Was that right - concatenating the two ML trees from the two alignments? Yes that\u2019s right. > For the -s in the above (second) command, I used alignment-1 for the first analysis, then alignment-2 for the second analysis (with the same concatenated ML trees for the -z option). Yes, correct > Kindly clarify. Pardon my ignorance, I am very new to this IQ-TREE. No worries, it\u2019s the aim of the forum here, Cheers Minh > Regards, > Harris > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/183eba04-9fa0-44d3-abd7-68f8001dae0b%40googlegroups.com ", "Hi Mihn, I very much appreciate your help. A lot continues to make sense now. Warm regards, Harris On Tuesday, 28 April 2020 06:30:26 UTC+2, Minh Bui wrote: Hi Harris, Heiko gave a very nice answer (thank you ;-). Now to your new questions: > On 24 Apr 2020, at 4:54 am, Harris < do79h...@gmail.com > wrote: > Dear Heiko, > Thanks so much for your comprehensive response. > For each of the two alignment files (alignment-1 and alignment-2) that I have, I opted to generate a ML tree using the following command: > iqtree -s alignment.phy > So, I ended up with two separate ML tree files (one from from alignment-1 and the other from alignment-2). I'm not sure if my next step was correct, but I then concatenated these two tree files - and that is what I used in the command below: > iqtree -s alignment.phy -z concatenated_treels -zb 1000 -au -zw > Was that right - concatenating the two ML trees from the two alignments? Yes that\u2019s right. > For the -s in the above (second) command, I used alignment-1 for the first analysis, then alignment-2 for the second analysis (with the same concatenated ML trees for the -z option). Yes, correct > Kindly clarify. Pardon my ignorance, I am very new to this IQ-TREE. No worries, it\u2019s the aim of the forum here, Cheers Minh > Regards, > Harris > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "duxEaqsGqzA": {"topic": "Estimating nucleotide substitution equilibrium using QMaker, testing DNA models (e.g. \"GG95\") using ModelFinder, midpoint rooting using IQ-TREE", "initializeDate": "Mar 19, 2021, 12:48:51 PM", "timeStamp": "Apr 20, 2021, 9:58:34 AM\u00a0(8 days ago)\u00a0", "content": ["Dear Sir or Madam: I wonder if QMaker ( https://pubmed.ncbi.nlm.nih.gov/33616668/ ) can estimate nucleotide substitution rate matrices from our own data, and test whether base composition was at equilibrium based on multiple alignments and phylogenetic trees. I wonder if ModelFinder could test DNA models (e.g. \"GG95\") used in dist.dna from R package ape. http://finzi.psych.upenn.edu/library/ape/html/dist.dna.html GG95: Galtier and Gouy (1995) introduced a model where the G+C content may change through time. Different rates are assumed for transitons and transversions. I wonder if IQ-TREE could place the root at the midpoint of the tree, in the branch located midway between the two most distant sequences (MEGA put a bend in branch by the midpoint rooting method for display purposes). https://learninglink.oup.com/access/hall-5e-student-resources Yours sincerely, Haruo Suzuki ", "Hi Haruo, On 20 Mar 2021, at 3:48 am, Haruo Suzuki < haruo...@gmail.com > wrote: Dear Sir or Madam: I wonder if QMaker ( https://pubmed.ncbi.nlm.nih.gov/33616668/ ) can estimate nucleotide substitution rate matrices from our own data, Yes it works for DNA. And I believe due to the way it\u2019s implemented, it also works with codon (and other) models. Though we haven\u2019t tested that thoroughly. and test whether base composition was at equilibrium based on multiple alignments and phylogenetic trees. I assume you want to test for (non)stationarity. Then you can use the tests of symmetry ( Naser-Khdour et al., 2019 ), see: http://www.iqtree.org/doc/Assessing-Phylogenetic-Assumptions Please note that QMaker assumes stationarity. That means, while it allows different partitions to have different base frequencies, the base frequencies stay constant along each partition tree. I wonder if ModelFinder could test DNA models (e.g. \"GG95\") used in dist.dna from R package ape. http://finzi.psych.upenn.edu/library/ape/html/dist.dna.html GG95: Galtier and Gouy (1995) introduced a model where the G+C content may change through time. Different rates are assumed for transitons and transversions. No it doesn\u2019t. In fact there is no non-stationary models in IQ-TREE. I wonder if IQ-TREE could place the root at the midpoint of the tree, in the branch located midway between the two most distant sequences (MEGA put a bend in branch by the midpoint rooting method for display purposes). https://learninglink.oup.com/access/hall-5e-student-resources There is no such option. As this is for visualisation, you can use MEGA or FigTree to midpoint root the tree. On a side note, IQ-TREE can root the tree when using a non-reversible models, see https://doi.org/10.1101/2020.07.31.230144 Cheers Minh Yours sincerely, Haruo Suzuki You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7799a9e5-8aa0-4da7-ac6a-113c4057f9f3n%40googlegroups.com ", "Dear Minh, Thank you for your reply. http://www.iqtree.org/doc/Command-Reference#automatic-model-selection Regarding Non-reversible models, the following options should work? For DNA analyses: `-m MFP+LM` For Amino acid analyses: `-m MFP+NONREV` http://www.iqtree.org/doc/Concordance-Factor For Amino acid analyses (using iqtree-2.1.2-Linux) performing the following commands printed the following WARNING messages: ``` # infer a concatenation-based species tree with 1000 ultrafast bootstrap and an edge-linked partition model iqtree -p ALN_DIR --prefix concat -B 1000 -T AUTO -m NONREV # infer the locus trees iqtree -S ALN_DIR --prefix loci -T AUTO -m NONREV # compute concordance factors iqtree -t concat.treefile --gcf loci.treefile -p ALN_DIR --scf 100 --prefix concord -T 10 -m NONREV --seed 123 WARNING: NONREV model will estimate 379 substitution rates that might be overfitting! WARNING: Please only use NONREV with very large data and always test for model fit! ``` http://www.iqtree.org/doc/Concordance-Factor#inferring-genelocus-trees It would be useful to know the correspondence of the trees in `loci.treefile` and locus alignments in a directory `ALN_DIR`. I wonder if `iqtree -S ALN_DIR --prefix loci -T AUTO` could generate individual locus trees in `loci.treefile` separately? Yours sincerely, Haruo Suzuki 2021\u5e743\u670822\u65e5\u6708\u66dc\u65e5 8:48:29 UTC+9 Minh Bui: ", "Hi Haruo, On 3 Apr 2021, at 7:15 pm, Haruo Suzuki < haruo...@gmail.com > wrote: Dear Minh, Thank you for your reply. http://www.iqtree.org/doc/Command-Reference#automatic-model-selection Regarding Non-reversible models, the following options should work? For DNA analyses: `-m MFP+LM` Yes, correct for DNA. For Amino acid analyses: `-m MFP+NONREV` No. For amino-acid you can do: -m MFP -mset +NONREV -mset option to to specify a list of models to be tested. With a special \u201c+\u201d prefix, it tells IQ-TREE to consider all existing models plus a list a model in this option. http://www.iqtree.org/doc/Concordance-Factor For Amino acid analyses (using iqtree-2.1.2-Linux) performing the following commands printed the following WARNING messages: ``` # infer a concatenation-based species tree with 1000 ultrafast bootstrap and an edge-linked partition model iqtree -p ALN_DIR --prefix concat -B 1000 -T AUTO -m NONREV # infer the locus trees iqtree -S ALN_DIR --prefix loci -T AUTO -m NONREV # compute concordance factors iqtree -t concat.treefile --gcf loci.treefile -p ALN_DIR --scf 100 --prefix concord -T 10 -m NONREV --seed 123 WARNING: NONREV model will estimate 379 substitution rates that might be overfitting! WARNING: Please only use NONREV with very large data and always test for model fit! ``` You can ignore this warning, it\u2019s only meant for when you do tree reconstruction. But here you only do a concordance factor calculation - so it should be fine. http://www.iqtree.org/doc/Concordance-Factor#inferring-genelocus-trees It would be useful to know the correspondence of the trees in `loci.treefile` and locus alignments in a directory `ALN_DIR`. I wonder if `iqtree -S ALN_DIR --prefix loci -T AUTO` could generate individual locus trees in `loci.treefile` separately? We put all trees in one file to save space and for convience actually. You can look at .iqtree file to see the connection, which tree corresponds to which alignment. The alignment file names are sorted in alphabetical order, btw. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6948a287-000a-4133-9f04-efc676b02bd4n%40googlegroups.com ", "Dear Minh, Thank you for your advice. Regarding \"Tests of symmetry\", the following commands are same? iqtree2 -p \"${ALN_DIR}\" --prefix concat -T AUTO --symtest-only iqtree2 -S \"${ALN_DIR}\" --prefix loci -T AUTO --symtest-only P-values varied from run to run. There were loci showing values of 'nan' in \"MarPval\" and \"IntPval\" columns in *.symtest.csv* file when amino acid sequences were used, while there were not such loci when nucleotide sequences were used. I wonder how I could interpret the values of 'nan' (NaN = \"Not a Number\" in R?) http://www.iqtree.org/doc/Advanced-Tutorial#consensus-construction-and-bootstrap-value-assignment Regarding \"Consensus construction\", The following messages were printed. ``` $iqtree2 --con-tree Invalid \"--con-tree\" option. $iqtree2 --con-net Invalid \"--con-net\" option. $iqtree2 --support Use -sup <target_tree_file> ``` I checked help messages printed by `iqtree-2.1.2-Linux/bin/iqtree2` and `iqtree-1.6.12-Linux/bin/iqtree`. ``` $iqtree2 --help CONSENSUS RECONSTRUCTION: -t FILE Set of input trees for consensus reconstruction --sup-min NUM Min split support, 0.5 for majority-rule consensus (default: 0, extended consensus) --burnin NUM Burnin number of trees to ignore --con-tree Compute consensus tree to .contree file --con-net Computing consensus network to .nex file --support FILE Assign support values into this tree from -t trees --suptag STRING Node name (or ALL) to assign tree IDs where node occurs $iqtree --help CONSENSUS RECONSTRUCTION: -t <tree_file> Set of input trees for consensus reconstruction -minsup <threshold> Min split support in range [0,1]; 0.5 for majority-rule consensus (default: 0, i.e. extended consensus) -bi <burnin> Discarding <burnin> trees at beginning of <treefile> -con Computing consensus tree to .contree file -net Computing consensus network to .nex file -sup <target_tree> Assigning support values for <target_tree> to .suptree -suptag <name> Node name (or ALL) to assign tree IDs where node occurs ``` Yours sincerely, Haruo Suzuki 2021\u5e744\u670812\u65e5\u6708\u66dc\u65e5 9:44:52 UTC+9 Minh Bui: ", "Hi Haruo, On 19 Apr 2021, at 11:29 pm, Haruo Suzuki < haruo...@gmail.com > wrote: Dear Minh, Thank you for your advice. Regarding \"Tests of symmetry\", the following commands are same? iqtree2 -p \"${ALN_DIR}\" --prefix concat -T AUTO --symtest-only iqtree2 -S \"${ALN_DIR}\" --prefix loci -T AUTO --symtest-only YES P-values varied from run to run. There were loci showing values of 'nan' in \"MarPval\" and \"IntPval\" columns in *.symtest.csv* file when amino acid sequences were used, while there were not such loci when nucleotide sequences were used. I wonder how I could interpret the values of 'nan' (NaN = \"Not a Number\" in R?) That can happen, because for amino-acid, the test need to fill the substitution matrix of size 20x20, which can be sparse (with many zeros). That only happens when a partition has very limited information, e.g. due to short sequences. NaN means that the test is not applicable, it can\u2019t say anything from that particular locus. So it can\u2019t whether it\u2019s good or bad. The doc link you is stil valid, i.e. all options are valid in IQ-TREE 2 as well. IQ-TREE 2 is backward compatible with IQ-TREE 2, that means old options are still valid and new options are introduced and synonymous to the old option. For example, --burnin is equivalent to -bi. It\u2019s just a long form. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/20b371f4-ee21-409d-8fab-0271c087fd51n%40googlegroups.com "]}, "3Qp-C0SX3XE": {"topic": "iqtree 2.0 crushes at while computing bootstrap consensus tree..", "initializeDate": "Jan 23, 2020, 7:37:02 PM", "timeStamp": "Mar 4, 2020, 7:06:35 AM", "content": ["IQ-TREE multicore version 2.0-rc1 for Linux 64-bit built Nov 21 2019 command: iqtree -p ./gblocks/ --prefix concat -B 1000 -T 2 Lines displayed just before crushing Computing bootstrap consensus tree... Reading input file concat.splits.nex... 16 taxa and 29 splits. Consensus tree written to concat.contree Reading input trees file concat.contree Log-likelihood of consensus tree: -7202214.843 ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ILLEGAL INSTRUCTION ERROR: *** For bug report please send to developers: ERROR: *** Log file: concat.log ERROR: *** Alignment files (if possible) Illegal instruction (core dumped) ", "Hi All, I'm having the same problem, and it also crashes with illegal instruction error message. However all the steps including the ML tree, seem to be right, so I'm not sure what is the problem... Have you solved this issue? Thank you in advance! Wendy ", "Hi there, Pls add \u201c--no-terrace\u201d option, it was discussed in another recent thread. Thanks! Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/97cd6d92-5af9-40ea-9cc0-dd35d11ce2a6%40googlegroups.com "]}, "iBhSp_6iNNY": {"topic": "IQTREE Web Server Not Working?", "initializeDate": "Jul 31, 2018, 1:27:35 AM", "timeStamp": "Aug 1, 2018, 6:03:16 AM", "content": ["Hi There, I have successfully used the web server ( http://iqtree.cibiv.univie.ac.at ) in the past, approx. a month ago. However, it has been acting strangely and then not working at all. 1) July 26, 2018 : I tried to retrieve my results and it would not let me. I went to Analysis Results > selected my analysis > DOWNLOAD SELECTED JOBS but it would not let me download. 2) July 30, 2018 : I tried to submit my alignment file (FASTA format) into the Model Selection > sequence type : protein > new model selection procedure : yes [+R] selected > Email (i entered my email) > SUBMIT JOB However, the uploading dialog popped up and I waited for 20+ mins but it would not finish submitting the job. It eventually just disappears and everything refreshes. I have tried several files that had worked in the past, different browsers, different times throughout the day, and it is still not working. I am unclear as to why this is happening? Is the online server no longer supported or should I just wait a couple days and then try again? Thank you, Jan ", "Dear Jan and others: There has been a severe hardware failure. The admin just recovered it temporarily. So I think you can submit jobs now, but please expect interruption until further notice. We\u2019ll let once the issue is fully resolved. Thanks for your understanding, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "SJt4gFj78zo": {"topic": "Crash with cat-like model search", "initializeDate": "Jan 22, 2018, 10:38:48 AM", "timeStamp": "Feb 7, 2018, 3:22:11 PM", "content": ["Dear Minh and all, I am trying to run iqtree on a large dataset with the following command: iqtree-omp-mpi -nt 32 -st AA -ninit 10 -bb 1500 -pre 37taxa -msub nuclear -s ../../matrices/Concatenated_37taxa/37taxa_concatenated.nex -m MFP+MERGE -rcluster 10 -madd LG4M,LG4X,LG+C10,LG+C20,LG+C30,LG+C 40,LG+C50,LG+C60 -mrate G,R,E A smaller dataset with very similar setting worked, but it didn't have the LG+C models. Now my job keeps failing. Initially because of memory (although I have tried with over 100GB), but it seems there is something else. This is the error message and below is the last model recorded on the output file. Error: STACK TRACE FOR DEBUGGING: 1 double* aligned_alloc<double>(unsigned long) 2 PhyloTree::initializeAllPartialLh(int&, int&, PhyloNode*, PhyloNode*) 3 PhyloTree::initializeAllPartialLh() 4 testModel(Params&, PhyloTree*, std::vector<ModelInfo, std::allocator<ModelInfo> >&, std::ostream&, ModelsBlock*, int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) 5 initializeParams(Params&, IQTree&, std::vector<ModelInfo, std::allocator<ModelInfo> >&, ModelsBlock*) 6 runTreeReconstruction(Params&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, IQTree&, std::vector<ModelInfo, std::allocator<ModelInfo> >&) 7 runPhyloAnalysis(Params&, Checkpoint*) 8 main() 9 __libc_start_main() ERROR: Not enough memory, allocation of 239324851232 bytes failed (bad_alloc) slurmstepd: error: Exceeded step memory limit at some point. slurmstepd: error: Exceeded job memory limit at some point. srun: error: holy7c17101: task 0: Out Of Memory slurmstepd: error: Exceeded job memory limit at some point. End of Output: 200 LG4X 9082542.352 151 18165386.703 18165386.843 18167002.882 Model LG+C10 is alias for LG+POISSON+G+FMIX{C10pi1:1:0.1191344178,C10pi2:1:0.0874372456,C10pi3:1:0.1037105070,C10pi4:1:0.0922584809,C10pi5:1:0.1070492801,C10pi6:1:0.1329945166,C10pi7:1:0.0538028458,C10pi8:1:0.0691986212,C10pi9:1:0.1319937434,C10pi10:1:0.1024203429} 201 LG+C10 9048557.235 146 18097406.470 18097406.601 18098969.133 Model LG+C20 is alias for LG+POISSON+G+FMIX{C20pi1:1:0.0559910600,C20pi2:1:0.0514824870,C20pi3:1:0.0812922124,C20pi4:1:0.0721976867,C20pi5:1:0.0556718858,C20pi6:1:0.0331003080,C20pi7:1:0.0589501763,C20pi8:1:0.0263756889,C20pi9:1:0.0307584220,C20pi10:1:0.0376701125,C20pi11:1:0.0303058290,C20pi12:1:0.0808775576,C20pi13:1:0.0263349134,C20pi14:1:0.0579101455,C20pi15:1:0.0371248064,C20pi16:1:0.0586867766,C20pi17:1:0.0561479138,C20pi18:1:0.0349810886,C20pi19:1:0.0544937394,C20pi20:1:0.0596471901} Appreciate any suggestions. Thank you! Best, Tauana ", "Hi Tauana, This line is relevant: ERROR: Not enough memory, allocation of 239324851232 bytes failed (bad_alloc) which means ~240 GB is needed to test LG+C20 model. Whereas LG+C10 went through. Have you tried -mem option? (which tells IQ-TREE the max memory to use). Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thanks Minh! I have been increasing memory, but somehow that line with the specific number escaped me. I just launched it again with 250GB and it hasn't failed yet. Do you anticipate the job will need even more memory when it gets to LG+C30, C40 etc? Tauana ", "Hi Minh, Indeed I need more memory for the other models, but I got to the LG+C50, so I think I am only missing C60. However I cannot allocate all the memory iqtree requests (598GB) in only on Node, so I will probably just remove that one model. Do you think I can edit the script to remove that model, and still have the same analysis finished? It wouldn't be the exact same command for iqtree, so I am worried I will lose all the model test done so far if it starts over. Thanks! ", "Hi Tauana, Yes C50 needs 5 times more RAM than C10, and so on. However, IQ-TREE will automatically detect your RAM size and try not to exceed 95% of the total RAM. Except if the RAM is smaller than the least amount required, then an ERROR will be issued. Moreover, you can also restrict the RAM with -mem option (e.g., -mem 200G). Cheers, Minh ", "Sorry, I forgot this question: Do you think I can edit the script to remove that model, and still have the same analysis finished? It wouldn't be the exact same command for iqtree, so I am worried I will lose all the model test done so far if it starts over. Yes you can, no worry. ModelFinder will checkpoint all models tested so far, nothing will be lost if you started out, as past model results will be loaded. Minh ", "Thanks, Minh! I relaunched again without the last model LG+C60, but it still failed with the same memory requirement. I am guessing the last model written to the output file (Model LG+C50 is alias for LG+POISSON+G+FMIX{C50pi1:1:0.0164297003,C\u2026\u2026\u2026}) was actually not calculated yet right? So I will try relaunching without C50 as well assuming the last successful one that I can computationally analyze is C40. Thanks for all the help "]}, "MJPR6N9z_hk": {"topic": "How to interpret Modelfinder Results for Codon models in MrBayes", "initializeDate": "Jan 26, 2018, 4:41:37 AM", "timeStamp": "Jan 27, 2018, 7:39:07 AM", "content": ["Hello all, I try to find out how to interpret the Modelfinder results for codon model setting for MrBayes. You might know, at MrBayes we have no such settings like MG, GY, +F, +FQ, +F1X4, +F3X4, +G etc. At MrBayes we first need to specify the codon model with command lset nucmodel=codon Then we have to specify the model and the state frequencies, for the nucleotide substitutions MrBayes should use for the Codon model (a short summary you surely know): Model (degrees of freedom) base frequencies provides transition/ transversion rate ratio (Kappa) Substitution rates red = transition = alpha blue = transversion = beta Bayes command JC = JC69 equal AC= =AT=CG= =GT nst=1 statefreqpr=fixed(equal) F81 unequal AC= =AT=CG= =GT nst=1 K80 = K2P equal yes AC=AT=CG=GT; =GT nst=2 statefreqpr=fixed(equal) HKY = HKY85 unequal yes AC=AT=CG=GT; =GT nst=2 SYM equal AC;CG;AT;GT; nst=6 statefreqpr=fixed(equal) GTR = REV unequal AC;CG;AT;GT; nst=6 Then we can set the across-site nonsynonymous/synonymous (omega) variation with command Omegavar Omegavar = Equal: no variation on omega across sites Omegavar = Ny98: three classes, with potentially different omega values (omega1, omega2, omega3): omega2 = 1; 0 < omega1 <1; and omega3 > 1 Omegavar = M3: Like the Ny98 model, the M3 model has three omega classes. However, their values are less constrained, with omega1 < omega2 < omega3 For these 3 across-site nonsynonymous/synonymous (omega) variations there are additional parameters: Omegavar = Equal is set we have the additional parameter omegapr This parameter specifies the prior on the nonsynonymous/synonymous rate ratio prset omegapr = uniform(<number>,<number>) prset omegapr = exponential(<number>) prset omegapr = fixed(<number>) Omegavar = Ny98 is set we have the additional 3 parameters Ny98omega1pr and Ny98omega3pr Ny98omega1pr: This parameter specifies the prior on the nonsynonymous/synonymous rate ratio for sites under purifying selection. prset Ny98omega1pr = beta(<number>,<number>) prset Ny98omega1pr = fixed(<number>) number = 0\u20261 Ny98omega3pr: This parameter specifies the prior on the nonsynonymous/synonymous rate ratio for positively selected sites. prset Ny98omega3pr = uniform(<number>,<number>) prset Ny98omega3pr = exponential(<number>) prset Ny98omega3pr = fixed(<number>) Omegavar = M3 is set we have the additional parameter M3omegapr This parameter specifies the prior on the nonsynonymous/synonymous rate ratios for all three classes of sites for the M3 model. prset M3omegapr = exponential prset M3omegapr = fixed(<number>,<number>,<number>) Omegavar = Ny98 Omegavar = M3 is set we have the additional parameter Codoncatfreqs Codoncatfreqs: This parameter specifies the prior on frequencies of sites under purifying, neutral, and positive selection prset codoncatfreqs = dirichlet(<num>,<num>,<num>) prset codoncatfreqs = fixed(<number>,<number>,<number>) Now I try to find out what I need to set at MrBayes when Modelfinder provides the following results: I see that MrBayes does not support the \"KOSI\" and \"SCHN\" Codon model, but what do I need to set for: MGK MG1KTS MG1KTV MG2K GY0K (what is that?) GY1KTS GY1KTV GY2K What do I need to set for: +FQ +F1X4 +F3X4 +FU +FO What do I need to set for: +G4 Note: with codon model there is no Gamma across-site rate variation selectable at MrBayes, but the across-site nonsynonymous/synonymous (omega) variation. You\u2019ll find the settings explained here: http://mrbayes.sourceforge.net/mb3.2_manual.pdf At page 139 (note hints at page 138f), 48, 164 Any help would be greatly appreciated. All the best Dieter ", "Hi Dieter, Unfortunately I can\u2019t answer this question - you should better ask MrBayes developers. In IQ-TREE I tried to conform with a subset of codon models in PAML. Some codon models implemented in IQ-TREE are not available in MrBayes and vice versa. Also, I don\u2019t know all these (frankly messy) MrBayes commands. - GY0K is a restricted version of GY (Goldman-Yang) model where kappa is set = 1. - MGK is an extended version of MG (Muse-Gaut) model with an additional kappa parameter (whereas MG essentially sets kappa = 1). Sorry that I can\u2019t be more helpful on this. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "u93QoYd5uGA": {"topic": "Issues with -TESTNEWMERGE option - IQTREE crashes with no signal", "initializeDate": "Sep 24, 2020, 4:04:09 PM", "timeStamp": "Sep 30, 2020, 12:04:45 AM", "content": ["Hi, I'm trying to build a species tree from concatenated sequences with partitioned analysis, by using this command: iqtree -Q <partition-nexus> -s <iqtree-input> --prefix <iqtree-output> --rate -B 5000 -T AUTO -m TESTNEWMERGE --sampling GENESITE -wbt My input fasta contains aligned amino acid sequences from ~70 species. I have run the same command with cds sequences from the same group of species and it worked fine. But in the recent runs with aa seq, IQTREE did fine initially - taking up around 30 cpus and log file was updating, then after around 2 days it started to slow down drastically- using 1 cpu and log file seems to be stuck while finding partition models . I reran a few times but it just got stuck at the same place - I always waited for at least a week to check if there's any log update - but no luck. Can someone please tell me what I did wrong and how I may improve? Any help would be greatly appreciated. Thanks a lot in advance! ", "Hey, I'm really sorry but I made a copy and paste mistake - and posted my question from the IQTree email and it went out as admin. I'm not and this email was not intended to come from IQTree. I apologize for any confusion. ", "Hi there, I'm really sorry but I made a copy and paste mistake - and posted my question from the IQTree email and it went out as admin. I'm not and this email was not intended to come from IQTree. I apologize for any confusion. It\u2019s OK. Sometimes people chose to post using the web interface. And that\u2019s how it appears. On Thursday, 24 September 2020 at 13:04:09 UTC-7 IQ-TREE wrote: Hi, I'm trying to build a species tree from concatenated sequences with partitioned analysis, by using this command: iqtree -Q <partition-nexus> -s <iqtree-input> --prefix <iqtree-output> --rate -B 5000 -T AUTO -m TESTNEWMERGE --sampling GENESITE -wbt My input fasta contains aligned amino acid sequences from ~70 species. I have run the same command with cds sequences from the same group of species and it worked fine. But in the recent runs with aa seq, IQTREE did fine initially - taking up around 30 cpus and log file was updating, then after around 2 days it started to slow down drastically- using 1 cpu and log file seems to be stuck while finding partition models . I reran a few times but it just got stuck at the same place - I always waited for at least a week to check if there's any log update - but no luck. Can someone please tell me what I did wrong and how I may improve? Any help would be greatly appreciated. Thanks a lot in advance! If it\u2019s still stuck at finding partition models, I suggest that you use the (fast) relaxed clustering algorithm to speed it up (significantly). This is done with -rclusterf option. For example, -rclusterf 10 is to consider only 10% of the top pairs. You can lower it to e.g. -rclusterf 5, if it still takes too long. You can also speed up by removing \u201cNEW\u201d in the -m option, that will ignore the free-rate model, which is typically slow to estimate, compared with the Gamma model. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ba055e2f-a594-46eb-85dd-3f796f2cb3c2n%40googlegroups.com "]}, "t-x6O7Mn-Ec": {"topic": "MFP excluding +I models", "initializeDate": "Mar 2, 2019, 7:09:26 PM", "timeStamp": "Mar 4, 2019, 6:54:08 AM", "content": ["Dear IQ-Tree developers, Is it possible to execute an MFP model+tree search, automatically excluding all +I models? Best, Jacob Berv ", "Hi Jacob, You can make use of the -mrate option. The default is: \"-mrate E,I,G,I+G,R\u201d. You can do \u201c-mrate E,G,R\u201d to exclude all +I models. See http://www.iqtree.org/doc/Command-Reference#automatic-model-selection Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Awesome, thanks. To clarify, I guess I was mostly interested in excluding the I+G models, now that you have clarified the options. It seems there is some reason to believe that it may not be best practice to simultaneously estimate I and G parameters\u2026do you have an opinion on that? Best, Jake ", "Hi Jake, Historically there has been some concern about I+G model. However, we have recently shown that the I+G model parameters can be reliably estimated, and the new strategy is implemented in IQ-TREE. Please see our Syst Biol paper: https://doi.org/10.1093/sysbio/syx092 So I would say, you can safely use I+G model as provided in IQ-TREE. Minh "]}, "8scMypWAJFY": {"topic": "Saving each bootstrap replicate", "initializeDate": "Dec 6, 2017, 1:31:45 PM", "timeStamp": "Dec 11, 2017, 10:37:48 AM", "content": ["Hello, I am running the ultrafast bootstrapping option using the -bb flag with partitions. Is there a way to write every bootstrap tree replicate to a file? Thanks! Frank ", "Dear Frank, The simple answer is: -wbt option (write bootstrap trees). This is actually written in the manual: http://www.iqtree.org/doc/Command-Reference#ultrafast-bootstrap-parameters Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thanks. Is it possible to write these bootstraps with branch lengths? ", "Whoops. I see it -wbtl. Thanks! "]}, "zrV3EaVC-Ow": {"topic": "ERROR", "initializeDate": "May 17, 2020, 10:16:32 AM", "timeStamp": "May 17, 2020, 10:55:34 AM", "content": ["Please, guys I need to run some data for my thesis and a paper I am about to submit. What is going with IQ-tree webserver? It says \"there is an issue with the cluster system. I beg you guys, please, help me. Best regards Bruno (University of S\u00e3o Paulo) ", "Bruno, J\u00e1 tentou rodar a vers\u00e3o de linha de comando? \u00c9 bem simples se voc\u00ea estiver rodando o tutorial deles. Ou tente usar a vers\u00e3o do CIPRES. Outra coisa, checa pra ver se n\u00e3o tem nenhum car\u00e1cter proibido no nome dos arquivos quando voc\u00ea submete para o servidor. Abra\u00e7os Vinicius You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d63b1f2e-ab3b-4226-9006-aa7d59c4f468%40googlegroups.com Vinicius S. Ferreira, M. Sc. Ph.D.Candidate Montana Entomology Collection (MTEC) Montana State University, Marsh Labs, Rm 05 1911 W. Lincoln St. Bozeman, MT 59717 E-mail: vinici...@gmail.com Phone: (406) 209-5116 Web Researchgate Lattes Orcid \"Nomina si pereunt, perit et cognitio rerum: \u200b\u200bnomina si confundantur, confunda\u200bn\u200btur omnia necesse est. \" Johann C. Fabricius, 1778 "]}, "Od0PnqbWT70": {"topic": "crashing with partitioned analysis", "initializeDate": "Oct 25, 2019, 10:45:20 AM", "timeStamp": "Oct 30, 2019, 1:26:10 AM", "content": ["Hi there, I am trying to run a partitioned analysis in version 1.6.12 and the program keeps crashing. I am running the following command: ./iqtree -s 6genes_21Oct19.phy -o AF471064_Drymarchon_corais -nt AUTO -bb 10000 -alrt 1000 -spp OxybelisClade_partition.txt -m MFP+MERGE And receive the following error: Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.005 seconds ERROR: phylotree.cpp:400: void PhyloTree::setRootNode(const char *, bool): Assertion `root' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 2 _sigtramp() ERROR: 5 PhyloTree::setRootNode(char const*, bool) ERROR: 6 PhyloTree::getTreeString() ERROR: 7 PhyloTree::saveCheckpoint() ERROR: 8 runModelFinder(Params&, IQTree&, ModelCheckpoint&) ERROR: 9 startTreeReconstruction(Params&, IQTree*&, ModelCheckpoint&) ERROR: 10 runPhyloAnalysis(Params&, Checkpoint*) ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: OxybelisClade_partition.txt.log ERROR: *** Alignment files (if possible) Abort trap: 6 Any help would be greatly appreciated. Chris ", "Hi Chris, Thanks for reporting this bug. I think it has to do with \u201c-o\u201d option. So please rerun without this option. In the mean time, we will investigate the problem. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/bca2dbf1-d9b1-45da-9084-2e48734eb22f%40googlegroups.com "]}, "LmveCIaDmOg": {"topic": "problem at run resume with IQ-TREE v 1.6.8", "initializeDate": "Nov 3, 2018, 8:33:46 PM", "timeStamp": "Nov 5, 2018, 10:25:50 PM", "content": ["Hi! I am running iq-tree v 1.6.8 on a cluster. Due to queue runtime window of 24 hours, I am forced to resume runs. Quite often I am receiving the following error when resubmitting with exactly the same commandline: File not found or incorrect input, pls check it again. If course input file (-s) is present. Any clue, please? Thanks in advance. Best, Giuseppe ", "Hi Giuseppe, What is the size of the checkpoint file (.ckp.gz)? Are you able to gunzip it? (And then gzip again). If yes, can you send the log file for further look? The reason why I asked is because it looks like IQ-TREE was killed while writing the (large) checkpoint file. In such case it will be corrupted, leading to this error message. If that\u2019s the case, then it\u2019s not possible to resume I\u2019m afraid. You can increase the checkpoint time internal from 60 sec (default) to something like -cptime 201, so that it reduces the chance of this happening. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh and thank you very much for your answer. Since resumes didn't fail always I suspected some sort of file corruption when the cluster queue kills my job. You are right: gunzip -t ALBERO-LORENZO-REDO.ckp.gz gzip: ALBERO-LORENZO-REDO.ckp.gz: unexpected end of file It's a pity we can't rescue our job now; I will retry from the beginning using the cptime option. Thanks again, Giuseppe ", "Hi Minh, As a suggestion - to prevent such losses (at the cost of higher disk usage): One could implement the checkpointing to alternatingly use two different checkpoint files (e.g. .1.ckp.gz and .2.ckp.gz). This way always the 2nd last is always still present even if the latest was interrupted, for instance by the queuing system. Since this uses twice the disk space, it might be preferable to switch on such behaviour by a cmdline switch and keep the current behaviour as default. What do you think? Cheers, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "That\u2019s a neat solution, Heiko! A more refined way to avoid double disk space is to: Write the checkpoint to another temporary file. Once done, then rename this file to .ckp.gz. Renaming takes a fraction of mili-second, thus the interruption is unlikely happening here. And good thing is that no need for a new option. Cheers Minh ", "> On 5 Nov 2018, at 02:19, Minh Bui < minh...@univie.ac.at > wrote: > That\u2019s a neat solution, Heiko! > A more refined way to avoid double disk space is to: Write the checkpoint to another temporary file. Once done, then rename this file to .ckp.gz. Renaming takes a fraction of mili-second, thus the interruption is unlikely happening here. And good thing is that no need for a new option. Indeed! I had asked you once in the past, whether that would be the way you are writing the checkpoints/ufboot files, and you said no. So I thought there is a good reason not to (e.g. multi-platform differences among the different OSes/filesystems). An even saver variant of your suggestion would be: rename the old checkpoint file to a tmp name, write the new checkpoint file, remove the old tmp file. Do you agree? Best wishes down-under, Heiko Campus Vienna Biocenter 5 (VBC5) A-1030 Vienna, Austria ----------------------------------------------------------------------------- Email: heiko.schmidt(AT) univie.ac.at Tel. : ++43 +1 / 4277 - 74321 http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Hi Heiko, I had just underestimated this problem for very large data sets\u2026 posted an issue on github to fix for the next release. Minh "]}, "ftDIjyNdnVM": {"topic": "IQTREE 1.6.6. anomalously slow (parallelization issue?)", "initializeDate": "Jul 16, 2018, 1:11:29 PM", "timeStamp": "Aug 16, 2018, 3:25:41 AM", "content": ["Hi guys, I stumbled upon what seems to be a regression bug in IQTREE 1.6.6: On some datasets - cannot find any specific features so far, can be both DNA or AA data, single or multiple partitions - IQTREE 1.6.6 takes several times longer to finish compared to v1.5.5. It seems like at some point, all threads but one become inactive (see screenshot), which is supposedly causing the slowdown. I'm attaching one example dataset for which I observed this weird behavior, and outputs for both v1.5.5 and v1.6.6 (the latter was interrupted once the slowdown became obvious). Any ideas? Many thanks in advance! Best, Alexey ", "Hi Alexey, I found the problem, thanks! IQ-TREE implements two ways of parallelisation: (1) over partitions and (2) over sites within partitions. Somehow v1.6 always performs (1), whereas v1.5 has a check: do (1) if #partitions >= #cores and (2) otherwise. I\u2019ll need to fix this (probably happened during the merge of the v1.6 branch into master branch). In your input, you have a partition model with just 1 partition (don\u2019t know why do you this). But this makes v1.6 to use only 1 core whereas v1.5 correctly uses 16 cores for this one partition. That\u2019s what you observed. As a quick fix (before I release the new version), can you please just do a run without partition file? You can also do \"-nt AUTO\u201d (instead of -nt 16), that does not have this problem. Thanks for your patience! Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <iqtree-slowdown.tgz> <IQTREE-sleeping-threads.png> "]}, "xG2PhywvL_A": {"topic": "GHOST crashes", "initializeDate": "Sep 26, 2020, 7:19:58 AM", "timeStamp": "Oct 11, 2020, 4:01:42 AM", "content": ["Hi, I'm having problems running an analysis using partitioned data (only four genes) using GHOST. I have tried running theanalysis with and without bootstrapping, but I get the same error message. Is this a bug or am I doing something wrong? I would be very grateful for any advice! Command: >bin\\iqtree2 -s infile.fasta -p infile.nex -nt AUTO Command: >bin\\iqtree2 -s infile.fasta -p infile.nex -nt AUTO -minsup 0.5 -B 10000 Version: 2.0.6-Windows Random Seed: 987863 (Using SPRNG - Scalable Parallel Random Number Generator) Kernel: AVX+FMA - auto-detect threads (8 CPU cores detected) ERROR: \\Users\\minh\\Dropbox\\iqtree-git\\model\\partitionmodelplen.cpp:146: virtual double PartitionModelPlen::optimizeParameters(int, bool, double, double): Assertion `cur_lh > tree_lh - 1.0 && \"individual model opt reduces LnL\"' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: infile.nex.log ERROR: *** Alignment files (if possible) Many thanks, Suzanne Williams ", "Is IQTREE running correctly? For three days now, every time I submit a nexus and partition file and I get a message telling me to wait, because there are too many submissions. Is anyone else having this problem? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/3e6b3ea5-debe-40c6-bd89-2524831afd35o%40googlegroups.com Professor L. Lee Grismer, Director of Research Herpetology Laboratory Department of Biology, La Sierra University 4500 Riverwalk Parkway Riverside, CA 92515-8247, USA Tel. 951-785-2345 \"A risk free world is a very dull world, one from which we are apt to learn little of consequence.\" - Geerat Vermeij \"If people are good only because they fear punishment, and hope for reward, then we are a sorry lot indeed.\" - Albert Einstein ", "Hi Suzanne, Do you mean that you used the GHOST model for each partition? Can you send me the partition file? (infile.nex). Because I\u2019m actually not sure if the GHOST model works with partition model at all. Minh ", "Hi Heiko, Robert, When I submit a job on the web server ( http://iqtree.cibiv.univie.ac.at ), there is an error message (attached). But the server load is only 4%. So it looks like an issue with the web server. Can you please check? Minh On 28 Sep 2020, at 4:13 am, Lee Grismer < lgri...@gmail.com > wrote: Is IQTREE running correctly? For three days now, every time I submit a nexus and partition file and I get a message telling me to wait, because there are too many submissions. Is anyone else having this problem? Professor L. Lee Grismer, Director of Research Herpetology Laboratory Department of Biology, La Sierra University 4500 Riverwalk Parkway Riverside, CA 92515-8247, USA Tel. 951-785-2345 \"A risk free world is a very dull world, one from which we are apt to learn little of consequence.\" - Geerat Vermeij \"If people are good only because they fear punishment, and hope for reward, then we are a sorry lot indeed.\" - Albert Einstein You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAMe9Yo9VP72OJBXCB3EYGNG7mtD4RSrX-oB3K08o9rm6S2RqBg%40mail.gmail.com ", "Hi Suzanne, CC Stephen (the GHOST guy ;-), We actually didn\u2019t test the combined GHOST partitioned model. Here, you allow each partition to have a set of branch lengths (under the GHOST model), and between partition the branch lengths need to be rescaled properly. But I believe that does not work in IQ-TREE, I don\u2019t think that the branch length optimizations work here. Even if we could make it work, there would be an over-parameterization or identifiability issue here. We should have printed an error message about that. So the answer is no, you can\u2019t use this model. Cheers, Minh On 7 Oct 2020, at 9:46 pm, Suzanne W < elaph...@gmail.com > wrote: Hi Minh, I was wondering what you thought about the model I used. I set it up with the partitions before I realised that wasn't appropriate, but in fact it gives the most sensible tree of all my analyses. My dataset is proving to be very difficult to work with, so I would be grateful for your ideas on the model I used. Is it an acceptable, if unusual approach? best wishes, Suzanne ", "Hi Suzanne and Minh, Sorry I didn\u2019t get to this earlier. I think Minh is right, the GHOST model should not work when combined with a partition model. From a theoretical point of view, the GHOST model is an alternative to the partition model, they shouldn\u2019t be used together. They are similar in some ways, but in essence the partition model makes assumptions about which sites belong to which partitions whereas the GHOST model doesn't. In this paper there isa good example of an electric fish dataset, where we compare the GHOST model to a partition model. Have a read of that and if you have any questions I\u2019d be happy to answer them. Cheers, Stephen ", "Sorry, I forgot to include the link to the paper! https://academic.oup.com/sysbio/article/69/2/249/5541793 Stephen ", "Thanks Minh and Stephen. I realised I had done the wrong thing after I had run the analysis, but the tree was more sensible than most and I\u2019m really struggling with this dataset so I just thought I would check! Thanks for letting me know. Best wishes, Suzanne "]}, "bfbYQbmjCIQ": {"topic": "BUG: IQ-Tree crashes in molecular dating", "initializeDate": "Sep 22, 2020, 9:26:30 AM", "timeStamp": "Oct 2, 2020, 4:32:20 AM", "content": ["Hi Minh, Very happy to see IQ-Tree implements a powerful molecular dating algorithm. It seems that I encountered a bug when dating using IQ-Tree with a very small data set. Basically, I tried a few different options, either with or without \"'-te\", and either with or without polytomies. However, none of them seemed to work well. May I ask what's wrong with the data? I attach my data and log files here. An example command is \"iqtree -s anfG.aln --date-root 100 --date-tip 0 -redo\". Thank you. TREE 1 *PROCESSING: Reading the tree ... Collapse 0 (over 1) internal branches having branch length <= 0.00379 (settable via option -l) Parameter to adjust variances was set to 0.194 (settable via option -b) Minimum branch length of time scaled tree (settable via option -u and -U): 0 Estimating the root position on all branches using fast method ... ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: anfG.aln.log ERROR: *** Alignment files (if possible) Best, Sishuo ", "Here come the data and results. ", "Hi Sishuo, The root date has to be smaller than the tip dates, so the command should look something like: --date-root -100 --date-tip 0, could you try again with this setting? However, normally in this case it should throw a message about conflict dates, so there's maybe another probleem. Hien On Tue, Sep 22, 2020 at 3:28 PM Sishuo Wang < tomas...@gmail.com > wrote: Here come the data and results. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/19618355-6512-4bd9-99cc-c5d251cdf78en%40googlegroups.com ", "Hi Hien, Thank you for your help. However, it seemed that there was still a problem as I tried \"--date-root -100 --date-tip 0\" but: Thanks. Sishuo ", "Hi Sishuo, I've tried to run lsd2 alone with your data in the previous email and didn't get any error. Do you have the log file of your second try? Hien To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d412a35c-7476-4f13-8278-18a90d2aeb45n%40googlegroups.com ", "Hi Hien, It is attached. Thanks. Sishuo ", "Hi Sishuo, Thanks for the file and pointing out the issue. I've found the bug now. I had tried the version for mac before which worked well; but the linux version had problems. There's an error of uninitialized value for a variable that the mac version sets 0 to it - which by chance is correct; while the linux version gives it a random value. I've fixed it now in the new update of lsd2, @Minh Bui could it be possible to include the new version of lsd2 in iq-tree? Thanks. Hien To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/af870486-9476-49f1-9750-f713d22b941en%40googlegroups.com ", "Hi Minh, I will affect the case of unrooted tree with a root date. I'd be nice if if the new version is integrated which fixes another bug Thanks, Hien On Wed, Sep 30, 2020 at 6:40 AM Minh Bui < m....@anu.edu.au > wrote: Hi Hien, Do you think if this is a serious bug? (e.g., does it affect most analyses?). If yes, I\u2019ll integrate it today or tomorrow. Minh "]}, "LL-G-ht9os0": {"topic": "long time single cpu usage when requesting 40 threads", "initializeDate": "Aug 17, 2017, 5:17:50 AM", "timeStamp": "Oct 8, 2018, 5:53:02 PM", "content": ["Hi there, thanks for maintaining IQ-TREE. I have recently observed that, despite the fact of running iqtree with 40 threads (with and alignment of ~20000 aa positions), the process seems to use only one cpu. The command was started as: $ iqtree-omp-1.5.5 -s alignment.faa -nt 40 -m LG -mem 256G with version: IQ-TREE multicore version 1.5.5 for Linux 64-bit built Jun 2 2017 cpu usage has been stuck at 100% for many hours: PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND 31637 huerta 20 0 30.759g 0.028t 28 R 100.0 2.8 3016:39 iqtree-omp-1.5.5 Am I doing something wrong? thanks, -jaime ", "Hi Jaime, Thanks for your interest. Can you please paste the last few lines of the log, just to know at what stage of the analysis is it? There is one part that is not parallelized yet, is the construction of the parsimony trees. Typically this is quick and thus OK, but for very large data sets that might be a limiting factor. We are working on a solution. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Indeed, the analysis is stuck in the parsimony trees. The dataset is 7000 taxa and 20k sites, and it has been there for the last 48h. Is there any way to speed up that step? Maybe -t BIONJ? or -t RANDOM? thanks, -jaime ", "I see, 7000 taxa will make parsimony construction quite slow. Pls don\u2019t use -t RANDOM: starting tree search from 7000-taxon random trees is not a good idea. -t BIONJ will definitely help but that reduces the initial sampling of the tree space because only one starting BIONJ is constructed. I would suggest that: To speed up parsimony trees, you can set -sprrad 1 to reduce SPR radius to 1 ( http://www.iqtree.org/doc/Command-Reference#tree-search-parameters ) and you can also set -ninit 10 to construct only 10 (instead of 100) parsimony trees. I think that is OK for such long (20K amino-acid) alignment. Minh ", "thanks, I will try that. ", "Hi Minh, some time ago I used your tips to speed up the computation of large trees. Everything worked well, thanks! However, I got stuck again when trying to compute a large tree (5000 taxa, 10k aa sites) using a constraint topology containing multifurcations. The following command got stuck for a couple of days using very little CPU: iqtree -s concat_alg.phy -m LG -g tree_ref.nw -nt 20 -fast -sprrad 1 -ninit 10 The last log message is: \"Creating fast initial parsimony tree by random order stepwise addition...\" is there anything I can do to speed up the process? What I would like is to resolve the multifurcations in the constraint tree, even with a fast approach. thanks a lot for your help, -jaime ", "Hi Jaime, This issue is known: this parsimony step with constraint tree is very slow when there are many taxa due to inefficient implementation. There is a GitHub issue ( https://github.com/Cibiv/IQ-TREE/issues/8 ), but we haven\u2019t had enough time to improve the current implementation, unfortunately. In short, there is nothing wrong, IQ-TREE is still running on your data set\u2026. Minh ", "I see, thanks for the answer! Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com ", "Hi Jaime, I\u2019m now testing a much faster version with constraint tree search. Thus, can you please send me your alignment and constraint tree for testing purpose? Thanks, Minh ", "Hi Minh and Jaime, I'm running into the same issue. :) Minh, would be happy to test your new version and/or send my data if you want to give them a whirl! ", "Hi Jon, Thanks for your interest! Can you pls test this version here: https://github.com/Cibiv/IQ-TREE/releases/tag/v1.7-beta3 Please check that the resulting tree obeys the constraint. Let me know how it goes. Cheers Minh "]}, "tEgToV4GuK8": {"topic": "Comparing Partition Models", "initializeDate": "Aug 17, 2018, 7:28:50 AM", "timeStamp": "Aug 22, 2018, 6:04:21 AM", "content": ["Hello, I have run four different models using the same alignment data for 136 different proteins. Two are split into 136 partitions with appropriate substitution models for each protein, whereas the others do not and instead apply the same substitution model to every protein based on the entire dataset as a whole. I would like to compare the BIC scores to determine which is a better fit to the data. Is this possible in IQ-TREE? ", "Hi here, Yes it is possible to just compare the log-likelihoods, AIC, BIC between partition model (with 136 partitions in your case) and single model. They are printed in .iqtree file. Cheers Minh On 17 Aug 2018, at 9:28 pm, jb1...@my.bristol.ac.uk wrote: Hello, I have run four different models using the same alignment data for 136 different proteins. Two are split into 136 partitions with appropriate substitution models for each protein, whereas the others do not and instead apply the same substitution model to every protein based on the entire dataset as a whole. I would like to compare the BIC scores to determine which is a better fit to the data. Is this possible in IQ-TREE? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Great, thank you Minh! "]}, "qmAGLY7EGcY": {"topic": "Fixed parameters in codon models", "initializeDate": "Aug 21, 2020, 11:24:15 PM", "timeStamp": "Aug 31, 2020, 7:29:18 AM", "content": ["Hi all, Is there a way to pass fixed parameters for codon models? For instance, we can pass a fixed alpha param for gamma rate variation in a model as: LG+G10{1.8} Is there a similar way to pass fixed values for, say, the omega, kappa, kappa2 parameters of the GY2K model? I expect it would be something like: GY2K{0.146,3.302,2.224}+G10 but this does not work. Thank you! Douglas ", "Hi Douglas, I checked the code: there is no facility to input codon model parameters. Sorry about that. One would need to change the source code in model/modelcodon.cpp source file. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/eec84650-e7d7-4905-9d75-01b1f387ebe8n%40googlegroups.com ", "Thanks Minh. Would there be a way to do it using a nexus model file? If not, can you point me to the place in the code where other user-set parameters are passed in, like G{1.8} for the alpha parameter. If I could see how that is done in iqtree, I could probably modify the modelcodon code myself. Douglas ", "Hi Douglas, Have a look at this function: void ModelCodon init const char *model_name, string model_params, StateFreqType freq, string freq_params) The model parameters are passed into model_params string, which are now processed at this line: (model_params != ) { readRates (model_params); that might not be what you want. You can write another function to replace this readRates() function call. If you can do this, let me know and make a pull request. I\u2019m more than happy to integrate it into the mainstream version. Thanks Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/126b0ea5-cffc-409c-bc8c-c7fa7e13a32en%40googlegroups.com "]}, "a5B5cXh6YJg": {"topic": "Calibrate the dates with range", "initializeDate": "Jul 6, 2020, 12:21:57 AM", "timeStamp": "Jul 9, 2020, 2:24:13 AM", "content": ["I using ancestral dates to calibrate the dates of the ancestral nodes by the format \"x:y\u201d to specify the date range from x to y. I checked the \u201cNode Labels\u201d of result by FigTree, they are still point value not a range. Are Node Labels\u201d means the median of the range? ", "Hi YanYan, My understanding (perhaps Hien will correct me) is that the estimates are point estimates based on the least-squares approach. Thus, they shouldn't fall outside the range you provided as a calibration, but you should still expect them to be point estimates. Rob On Mon, 6 Jul 2020 at 14:21, YanYan < lil...@163.com > wrote: I using ancestral dates to calibrate the dates of the ancestral nodes by the format \"x:y\u201d to specify the date range from x to y. I checked the \u201cNode Labels\u201d of result by FigTree, they are still point value not a range. Are Node Labels\u201d means the median of the range? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/366f117b-027e-44b6-90dc-bc73f10ecbf7o%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Thank you for your explanation I understand. \u5728 2020\u5e747\u67089\u65e5\u661f\u671f\u56db UTC+8\u4e0a\u534811:49:33\uff0cRob Lanfear\u5199\u9053\uff1a Hi YanYan, My understanding (perhaps Hien will correct me) is that the estimates are point estimates based on the least-squares approach. Thus, they shouldn't fall outside the range you provided as a calibration, but you should still expect them to be point estimates. Rob On Mon, 6 Jul 2020 at 14:21, YanYan < lil...@163.com > wrote: I using ancestral dates to calibrate the dates of the ancestral nodes by the format \"x:y\u201d to specify the date range from x to y. I checked the \u201cNode Labels\u201d of result by FigTree, they are still point value not a range. Are Node Labels\u201d means the median of the range? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/366f117b-027e-44b6-90dc-bc73f10ecbf7o%40googlegroups.com "]}, "fp3LrkqUW7k": {"topic": "BUG: -o command causes crash in IQ-TREE2.0 on Mac", "initializeDate": "Apr 5, 2020, 3:42:02 PM", "timeStamp": "Apr 6, 2020, 6:11:15 AM", "content": ["Greetings, I'm running IQ-TREE2.0 on a Mac running OS 10.14.6. The following set of commands causes IQ-TREE to crash: bin/iqtree -s amat.phy -p amatpart.nex -o RF140025_Nymphalidae_Satyrinae_Morphini_NS_Morpho_helenor -t starttree.tre -m MFP+MERGE -rclusterf 25 -merit AICc -T AUTO --safe -B 1000 -alrt 1000 -pre Amat20200405b -v Here are the last few lines of the .log file: _________________________________________________________________________________________ Parameters optimization took 23 rounds (121. 8133351803 sec) WARNING: Estimated model parameters are at boundary that can cause numerical instability! Time for fast ML tree search: 364. 3189201355 seconds ERROR: phylotree.cpp:419: virtual void PhyloTree::setRootNode(const char *, bool): Assertion `root' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 2 _sigtramp() ERROR: 5 PhyloTree::setRootNode(char const*, bool) ERROR: 6 PhyloTree::getTreeString() ERROR: 7 PhyloTree::saveCheckpoint() ERROR: 8 computeFastMLTree(Params&, Alignment*, ModelCheckpoint&, ModelsBlock*, int&, int) ERROR: 9 runModelFinder(Params&, IQTree&, ModelCheckpoint&) ERROR: 10 startTreeReconstruction(Params&, IQTree*&, ModelCheckpoint&) ERROR: 11 runPhyloAnalysis(Params&, Checkpoint*) ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: Amat20200405b.log ERROR: *** Alignment files (if possible) Abort trap: 6 _________________________________________________________________________________________ If I remove the outgroup command \" -o RF140025_Nymphalidae_Satyrinae_Morphini_NS_Morpho_helenor\" from the list of commands, then the analysis seems to run fine. I have moved the outgroup data to the top line of my .phy file to specify it as the outgroup, and therefore do not require the -o command. However, I'm posting this message to alert others to this possible bug. Best wishes, David Lohman ", "Hi Dave, If I remember correctly, the -o option is simply for viewing purposes. In other words, IQ-TREE still yields an unrooted topology. You can simply open up the tree in FigTree to root/re-root after the analysis is finished. Chris You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8fc7e398-8ee6-483a-aa1d-da67d460de45%40googlegroups.com <{===================~~~~~~~~~~~ /\\ /\\ Christopher Blair, Ph.D. Associate Professor Department of Biological Sciences New York City College of Technology and Ecology, Evolution and Behavior PhD Program Graduate Center The City University of New York 285 Jay Street Brooklyn, NY 11201 CBl...@citytech.cuny.edu cbl...@gc.cuny.edu Website: https://sites.google.com/site/christopherblairphd/home Office: Academic Complex 501A; Ph: 718-260-5342 Lab: Academic Complex 401 ", "Hi Chris, Thanks for the quick reply. I managed to figure out a work-around, but I thought the developers would like to know about this potential bug nonetheless. Dave To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8fc7e398-8ee6-483a-aa1d-da67d460de45%40googlegroups.com "]}, "QhPxocbZtzM": {"topic": "Assertion `num_threads > 0'  fails in 1.6.1 with the -mtree flag", "initializeDate": "Jan 24, 2018, 3:12:36 PM", "timeStamp": "Mar 14, 2018, 7:45:24 AM", "content": ["Hi all, I am running 1.6.1 with a data set that run ok on 1.5.4. My command lines like this fail with 1.61, but work with 1.5.4: iqtree -s infile.txt -st DNA -nstep 10 -mtree -pre output -m TEST -mset raxml -nt AUTO iqtree -s infile.txt -st DNA -nstep 10 -mtree -pre output -nt AUTO My command lines like this succeed: iqtree -s infile.txt -st DNA -pre output -nt AUTO iqtree -s infile.txt -st DNA -nstep 10 -pre output -nt AUTO That is, the -mtree flag produces the error. Here is the stack trace: ERROR: phylotree.cpp:735: size_t PhyloTree::getBufferPartialLhSize(): Assertion `num_threads > 0' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 6 PhyloTree::getMemoryRequired(unsigned long&, unsigned long&, unsigned long&) ERROR: 7 PhyloTree::initializeAllPartialLh() ERROR: 8 PhyloTree::readTreeString(std::string const&) ERROR: 9 IQTree::computeInitialTree(std::string&, LikelihoodKernel) ERROR: 10 initializeParams(Params&, IQTree&, ModelCheckpoint&, ModelsBlock*, std::string&) ERROR: 11 runTreeReconstruction(Params&, std::string&, IQTree*&, ModelCheckpoint&) ERROR: 12 testOneModel(std::string&, Params&, Alignment*, ModelCheckpoint&, ModelInfo&, ModelsBlock*, int&, int) ERROR: 13 testModel(Params&, PhyloTree*, ModelCheckpoint&, ModelsBlock*, int, int, std::string, bool, std::string) ERROR: 14 initializeParams(Params&, IQTree&, ModelCheckpoint&, ModelsBlock*, std::string&) ERROR: 15 runTreeReconstruction(Params&, std::string&, IQTree*&, ModelCheckpoint&) ERROR: 16 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 17 main() ERROR: 18 __libc_start_main() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: output.log ERROR: *** Alignment files (if possible) /projects/ps-ngbt/home/cipres/ngbw/contrib/tools/bin/iqtree_1.6.1_comet: line 12: 1673 Aborted iqtree $* srun: error: comet-11-10: task 0: Exited with exit code 134 ", "Dear Mark, Many thanks! I can confirm that this crash occurs in v1.6 with the combination of -mtree and -nt AUTO option. Whereas v1.5 works fine. We will fix in the next release. Right now to overcome this issue, please explicitly specify the number of threads (e.g. -nt 4) when using -mtree option. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Thanks Minh! I will do that. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com ", "Hi Minh, I am still seeing this issue in v.1.6.2. Is that expected? Mark ", "Hi Mark, No this was unfortunately not fixed in v1.6.2 due to other more urgent issues. But I put it now for the next release. Thanks for your patience. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com "]}, "MADQ_H7iYa8": {"topic": "Warning: Taxon not found in full tree", "initializeDate": "Mar 31, 2021, 3:24:20 PM", "timeStamp": "Apr 1, 2021, 4:17:33 PM", "content": ["Hello, I am using IQ-Tree for calculating both concordance factors and concordance sites. My input files are the output tree from ASTRAL with 23 species and multiple individuals per species (Cembroides_n206_multi. tre ) and the concatenated file with 206 RAxML trees. The ASTRAL tree was performed from 206 RAxML trees. When I write the syntaxis to estimate gCF the program say that one taxon is not found in the full tree (below) but I don't have missing data in the trees. I reviewed the files and all is in order. Syntaxis: iqtree2 -t Cembroides_n206_multi. tre gcf alltrees3.tre --prefix gene_concordance There is a command or flag to evaluate multiple individuals per species? or What is the problem? I estimated both gCF and sCF in IQ-Tree with other files with the same syntaxis. The individual trees also were performed in RAxML and the species tree was also estimated in ASTRAL but these data only include one individual per species and I don\u00b4t had a problem. Host: pinaceae (AVX2, FMA3, 31 GB RAM) Seed: 904691 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Mar 31 12:53:44 2021 Kernel: AVX+FMA - 1 threads (24 CPU cores detected) HINT: Use option to specify number of threads because your CPU has 24 cores! HINT: - AUTO will automatically determine the best number of threads to use. Reading tree Cembroides_n206_multi. tre ... rooted tree with 23 taxa and 45 branches Reading tree(s) file alltrees3.tre ... 206 tree(s) loaded (206 rooted and 0 unrooted) Computing gene concordance factor... ERROR: Taxon not found in full tree: ariKF30 Best regards, Rub\u00e9n ", "Hi Ruben, This error message is quite informative. Taxa in all gene trees must appear in the species tree. In your case, ariKF30 does not appear in the species tree. That\u2019s why the error. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/36d3f85a-55ca-42fa-a022-6bcbe441026an%40googlegroups.com ", "Hi, Yes I do. I know that because I estimated the species tree in ASTRAL with the option multi- maping . This is the reason that ariKF30 does not appear in the species tree, but not only ariKF30 also the rests of 92 individuals. species_name: individual_1, individual_2,... ambertiana: lamD1195 krempfii: krePT242 aristata: ariKF30,ariKF36,ariKF37 longaeva: lonD1027 balfouriana: balfOM11 bungeana: bun03s3A gerardiana: ger41105 nelsonii: nel10198,nel31798,nelD1095,nelD1096 californiarum: calD1537,calD1545,calD1551,calD1555,calD1590,calD1621,calD1627,caliJD fallax: falDS492,falDS493,falDS496 edulis: eduD1020,eduD1028,eduDS485,eduDS870,eduDS876 remota: rem19498,rem22498,rem23298,remD1301,remDS588,remDS801 cembroides: cemD1042,cemD8599,cemDG569,cemDRD18,cemDS444,cemDS593,cemDS923,cemMPC1 lagunae: lagA9263,lagA9279,lagJ2154,lagJ2156,lagJ2157 orizabensis: oriD7399,oriJRM02,oriJRM08,oriJRM14 culminicola: cul01S6,culD1118,culD1135,culD1137,culDOB12,culJC735 discolor: dis02s2,disD1069,disDS787,disDS847 johannis: johD2001,johD7999,johD8199,johD8299,johDS501,johDS502,johDS508 quadrifolia: quaD1535,quaD1546,quaD1568,quaD1599,quaD1603 monophylla: monA1298,monD1214,monD1509,monD1512,monD1513,monR6668 pinceana: pinD1163,pinDS440,pincMG2,pincPA1,pincPMZ,pincPT maximartinezii: maxD1010,maxD6499,maxD7799 rzedowskii: rze47131,rzeDS635,rzeDS636,rzeDS637 So the output tree ASTRAL is this: (californiarum:0.011271,((monophylla:0.145033,quadrifolia:0.097328)0.97:0.122351,(fallax:0.0,(edulis:0.027243,(((lagunae:0.127726,(cembroides:0.0,orizabensis:0.067089)0.47:0.020036)0.69:0.053537,(remota:0.200087,(culminicola:0.434712,(johannis:0.059857,discolor:0.020571)0.61:0.047559)1:0.164765)0.44:0.021884)1:0.167836,((rzedowskii:1.008872,(maximartinezii:1.022244,pinceana:0.402043):0.241377)1:0.545519,((balfouriana:1.0,(longaeva:1.0,aristata:1.03328)0.53:0.043364)1:0.886838,(nelsonii:2.504427,((krempfii:1.0,lambertiana:1.0)0.99:0.144008,(bungeana:1.0,gerardiana:1.0)1:0.822685)1,:1.844654)0.53:0.049889)1:1.492857)1:0.547291)0.88,:0.099962)0.51,:0.028586)0.6,:0.040283):0.0); What can I do to calculate the gCF and sCF with multiple individuals per species? Best regards, Rub\u00e9n "]}, "rv868S1gvY8": {"topic": "Crash Report: Crashing on \"Computing log-likelihood...\"", "initializeDate": "Jan 28, 2017, 10:43:48 PM", "timeStamp": "Jan 30, 2017, 8:41:50 AM", "content": ["I'm running an alignment through IQtree multi-core v 1.4.2-beta and get this error: Computing log-likelihood of 100 initial trees ... STACK TRACE FOR DEBUGGING: 1 funcAbort() 3 gsignal() 4 abort() 6 __assert_perror_fail() 8 PhyloTree::assignLeafNames(Node*, Node*) *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: test_alignment.log *** Alignment files (if possible) The alignment I am using is nearly identical to a previous one that ran fine except for two things: 1) Fasta names have been replaced with numbers (still have the appropriate \">\") 2) Several sequences have been removed I have tried a reduced dataset, which appears to run without errors - but without an informative error on the larger dataset I do not know what to change in order to get it to run. Are there any suggestions on how to proceed? Thank you, -Andrew ", "Dear Andrew, can you please send me the command line used? From the messages, I suspect that some taxa names in the initial trees do not appear in the alignment. But as for exactly why it is, I don\u2019t know. Can you try the latest version 1.5.3? Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "t8Wzdj653ds": {"topic": "phy.splits and phy.splits.nex", "initializeDate": "Sep 6, 2018, 3:03:00 PM", "timeStamp": "Sep 6, 2018, 11:14:40 PM", "content": ["May be I miss something but in the Manual (pdf version) on page 38 two files are mentioned as the result of a run: example.phy.splits AND example.phy.splits.nex But I do not find any xxx.phy.splits file at the end of the runs, but only the xxx.phy.splits.nex Typically the instruction we use is iqtree-1.6.7-MacOSX/bin/iqtree -s alignment.faa -m MFP -bb 1000 -wbt -wsr -nt AUTO Note this was the same in earlier versions of IQtree 1.6.x I cannot find any information in the documentation. Does the xxx.phy.splits exists in some conditions, and if true what are the instructions? Thank you for the help JP Flandrois LBBE UMR5558 Lyon, France ", "Hi JP, This part of document is out-dated: by default .splits file is not written to reduce the number of outputs. If you want to print this file, then you need to use option \u201c-wsplits\u201d. Thanks for pointing this out, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "tYn2V6o_MEM": {"topic": "Drawbacks to using Larger Numbers of Gamma Rate Categories?", "initializeDate": "Oct 11, 2016, 4:57:25 PM", "timeStamp": "Oct 12, 2016, 8:40:36 AM", "content": ["Hi All: We have fairly short amino acid alignments (typically less than 200 aligned columns). I have used IQTree to test for optimal evolutionary models for phylogenetic tree inference (i.e. the model which produces the lowest BIC score). Models of the LG family are always best for our data. I have found that a higher number of gamma rate categories (i.e. LG+G20) is superior to the typically used LG+G4, or to LG+R7 (usually the best Free Rate model). Aside from the increase in computation time, is anyone aware of objections to using a higher number of gamma rate categories, like LG+G20? Thanks, David Kerk ", "Dear David, At least I am not aware of any objections to using more rate categories. In fact, you are encouraged to use more categories; there have been simulation studies showing that just 4 categories might lead to wrong trees. The default of 4 in IQ-TREE is just because other ML software also has this default value, so that the results (e.g. log-likelihoods) are comparable. As a side note, if you want to estimate site-specific rates (e.g. via -wsr option), then you should definitely use 16 categories or more, as a paper by Tal Pupko and colleagues showed: http://mbe.oxfordjournals.org/content/21/9/1781.abstract Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "yMLS863s920": {"topic": "ModelFinder on large alignments", "initializeDate": "Jan 3, 2020, 6:37:23 PM", "timeStamp": "Jan 3, 2020, 9:46:45 PM", "content": ["Hi all, I am analyzing a data set with 34 taxa and about 2 million bp and find that ModelFinder will take quite a long time to finish. I was hoping that the developers might have some thoughts. Given the length of the alignment, I am tempted to simply specify something like GTR + R10. I am interested to hear thoughts. Best wishes, Chris ", "Hi Chris, I agree, for such long alignments the best model is almost always GTR+R10. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/cc8d856c-5928-4b43-abc3-0980022a0963%40googlegroups.com "]}, "S-_gPyMkIjc": {"topic": "Alignment Phylogenetic Information vs Tree Quality?", "initializeDate": "Nov 28, 2016, 12:03:13 PM", "timeStamp": "Nov 28, 2016, 12:03:13 PM", "content": ["It seems to me intuitive that if an alignment has low phylogenetic information, a tree inferred from it would tend to be unreliable. I am wondering if anyone is aware of literature which has looked at this, and perhaps characterized a \u201ctwilight zone\u201d where the phylogenetic information of an alignment would be low enough that inferred trees would be suspect? It also seems to me intuitive that this problem would be exacerbated by taxon number (i.e. trees in this situation would become more unreliable as the number of taxa increased). Is anyone aware of literature where this effect would have been studied? If one had an alignment with low phylogenetic information, I am wondering what the \u201cphenotype\u201d of a set of unreliable trees inferred from it would be? Low branch supports? Poor consistency of topology over multiple tree inference runs? Low consistency of logL over multiple runs? How would this contrast with the phenotype of a \u201creliable\u201d set of trees? "]}, "C2D2ppIcEaA": {"topic": "Problem with partitioned analysis.", "initializeDate": "Apr 27, 2017, 8:15:30 AM", "timeStamp": "Apr 27, 2017, 9:11:37 AM", "content": ["Hello, I'm in trouble when using IQ-tree for a partitioned analysis with nucleotide sequence data. I think it may be because I have to much partitions, one for each gene, with more than 10000 concatenated loci for most datasets. To evaluate this I made a smaller dataset with 2073 loci and had the same problem. It appears that the estimated time to conclude the analysis only increases along the run, which is unexpected. I'm sending my alignment, the partition file and the command I used. The bug report shown is: terminate called after throwing an instance of 'std::bad_alloc' what(): std::bad_alloc *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: apes_part_min_entropia.txt.log *** Alignment files (if possible) Abortado (imagem do n\u00facleo gravada) My command is: iqtree-omp -nt AUTO -s apes_entropia_min_concat.nex -spp apes_part_min_entropia.txt -m TESTMERGE -bb 1000 -alrt 1000 -rcluster 10 -redo The files: https://drive.google.com/file/d/0B_pZ60bYrI6eS0dfMG9hR0VGTFU/view?usp=sharing https://drive.google.com/file/d/0B_pZ60bYrI6eM2U5d3lJNXRKSms/view?usp=sharing https://drive.google.com/file/d/0B_pZ60bYrI6ecVFIN3BDa1UtYzQ/view?usp=sharing I wonder if it would be a problem if I made a partition for each set of genes that fits with a model. What are the consequences of this for the inference of topologies and branch lengths? It seems to me that this has not been fully explored. At least I couldn't find anything about this in the literature. Thank you in advance, Filipe. ", "Hi Filipe, yes \u2018bad_alloc' message means that you don\u2019t have enough RAM for such large data set. Beginning of log file: Host: DESKTOP-12KMH6R (AVX2, FMA3, 7 GB RAM) This is too small RAM. Try another one. You can copy all current output files to another PC so that IQ-TREE can restart from checkpoint to save time. I wonder if it would be a problem if I made a partition for each set of genes that fits with a model. What are the consequences of this for the inference of topologies and branch lengths? It seems to me that this has not been fully explored. At least I couldn't find anything about this in the literature. -m TESTMERGE should do the job, where it tries to merge partitions (see PartitionFinder). So this should reduce the fear of over-parameterization. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thank you, Minh! "]}, "EPui_TFKttE": {"topic": "Analysing big data", "initializeDate": "Aug 1, 2017, 10:14:06 AM", "timeStamp": "Aug 2, 2017, 6:45:50 AM", "content": ["Hi, We've been analysing some very large datasets (>1000 taxa + >10000 sites), but currently your documentation on that subject is unfinished. I was wondering if you had any particular hints. I've been using the -fast option to 'emulate' fastTree, and it's really fast and giving nice results. Are there any other tricks you'd recommend? I'm also interested in adding taxa to large trees. I've noticed that the initial parsimony method sometimes changes. Is it possible/useful to be able to define this? Thanks, Simon ", "Hi Simon, On Aug 1, 2017, at 4:14 PM, Simon Harris < simonr...@gmail.com > wrote: Hi, We've been analysing some very large datasets (>1000 taxa + >10000 sites), but currently your documentation on that subject is unfinished. I was wondering if you had any particular hints. Right, there are a few tips, for example, to reduce the runtime and memory. For your data sets (many sequences and many sites) I recommend you use the MPI version. But you need to compile the binary yourself (see http://www.iqtree.org/doc/Compilation-Guide#compiling-mpi-version ). Here, IQ-TREE will distribute computations across different nodes (e.g. in a cluster) and also use multicore per node. I've been using the -fast option to 'emulate' fastTree, and it's really fast and giving nice results. Yes you can do this as well. You can also combine this fast option with the standard bootstrap (-b), which works well under our benchmark, meaning that the bootstrap supports closely resemble those of standard bootstrap under default search option. However, I would recommend to only use this option for explorative purpose, i.e. to have an idea how the tree looks during your analysis. For the final tree (e.g. in publication), you should do the default (more thorough) search. See an independent comparison study ( http://www.biorxiv.org/content/early/2017/05/25/142323 ) which concluded that FastTree is much worse than RAxML and IQ-TREE. Are there any other tricks you'd recommend? see above I'm also interested in adding taxa to large trees. Do you mean the constraint tree option (-g)? See this tutorial: http://www.iqtree.org/doc/Advanced-Tutorial#constrained-tree-search I've noticed that the initial parsimony method sometimes changes. Is it possible/useful to be able to define this? Yes, you can use -t option to specify your own starting tree. Cheers, Minh Thanks, Simon You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "nO18JTXqtB8": {"topic": "Wrong likelihoods with the ORDERED model?", "initializeDate": "Feb 12, 2018, 2:40:31 AM", "timeStamp": "Feb 13, 2018, 10:04:54 PM", "content": ["Hi everyone, I think there might be a problem with IQTree's computation of the likelihood with the ordered multistate model. I have been simulating data using the ordered model, and IQTree 1.6.1 is giving me worse likelihood values for the true tree with the ordered model than with the unordered (Mk) model. RAxML and phangorn (the package that I use for the simulations) give always better likelihoods for the ordered model, so I don't think the problem is with the simulation itself. Or maybe there is a problem with the IQTree settings I'm using? Log likelihoods: IQTree phangorn RAxML Ordered -20011.044 -16696.3 -8474.798474 Unordered -17188.471 -17188.47 -8612.959340 The log likelihoods of RAxML are greater because it optimises the branch lengths as well. I don't know how to prevent that. I copy the R code for an example simulation and the commands I used for the programs below. Cheers, Eduardo R code ``` #!/usr/bin/env Rscript library(phangorn) # Set the seed number set.seed(18057) # Number of characters. Integer > 0 NCHARS <- 300L # Number of character states. Integer > 1 NSTATES <- 8L # Create an ordered transition rate matrix. The rate vector corresponds to the # lower triangle of the Q matrix filled column-wise. 0 means that the transition # is allowed. -1 means that the transition is prohibited. q <- unlist(sapply((NSTATES-1):1L, function (x) c(0L, rep(-1L, x-1L)))) # Create a random tree with 50 tips tr <- rtree(50) # Save the random tree in Newick format write.tree(tr, \"test.tre\") # Simulate character evolution with the ordered model and the random tree charmat <- simSeq(x = tr, l = NCHARS, Q = q, type = \"USER\", levels = 0L:(NSTATES - 1L), rate = 0.1) # Save the generated data in Phylip format write.phyDat(charmat, \"test.phy\") # Compute the tree likelihood with the ordered model optim.pml(pml(tr, charmat, Q = q), optEdge = FALSE) # loglikelihood: -16696.3 # Compute the tree likelihood with the unordered model optim.pml(pml(tr, charmat, model = \"symmetric\"), optEdge = FALSE) # loglikelihood: -17188.47 ``` Commands for IQTree and RAxML: iqtree -s test.phy -m ORDERED -pre ordered -blfix -te test.tre # -20011.044 iqtree -s test.phy -m MK -pre unordered -blfix -te test.tre # -17188.471 raxmlHPC -f n -s test.phy -m MULTICAT -K ORDERED -n ordered -z test.tre # -8474.798474 raxmlHPC -f n -s test.phy -m MULTICAT -K MK -n unordered -z test.tre # -8612.959340 ", "Hi Eduardo, Can you try ORDERED+F (empirical state frequency) or ORDERED+FO (optimised state frequency) model ? The default is equal state frequency (for morphological data), which might not match exactly what you simulated. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, I tried both settings and it didn't change the result. I am sure that the simulations were set with equal frequencies. The computation of the likelihoood with phangorn in the R script assumes equal frequencies too, so the results of phangorn and IQTree should be more similar if that were the problem. Best, Eduardo ", "OK. Then since I don\u2019t know much what the R code does, can you please confirm that the unnormalised Q matrix matches the following: * 1 0 0 0 0 0 0 1 * 1 0 0 0 0 0 0 1 * 1 0 0 0 0 0 0 1 * 1 0 0 0 0 0 0 1 * 1 0 0 0 0 0 0 1 * 1 0 0 0 0 0 0 1 * 1 0 0 0 0 0 0 1 * (Used in IQ-TREE for ORDERED model) Cheers, Minh ", "Yes, that's it. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com ", "Hi Minh, Sorry, I might have to take that back. I ran tree searches with IQTree and RAxML on 30 simulated matrices and while IQTree-ordered still gets worse trees, there seems to be no difference between RAxML-ord and RAxML-mk (plot attached), so I think there could some problem with the simulation. I set up the simulation Q matrix correctly as far as I can tell, with the same structure as you told me and closely following the manual, but I'll double-check with the R-sig-phylo guys and get back to you when I clear this up. Best, Eduardo On Monday, 12 February 2018 14:33:50 UTC+1, Eduardo Ascarrunz wrote: Yes, that's it. 2018-02-12 14:27 GMT+01:00 Minh Bui OK. Then since I don\u2019t know much what the R code does, can you please confirm that the unnormalised Q matrix matches the following: * 1 0 0 0 0 0 0 1 * 1 0 0 0 0 0 0 1 * 1 0 0 0 0 0 0 1 * 1 0 0 0 0 0 0 1 * 1 0 0 0 0 0 0 1 * 1 0 0 0 0 0 0 1 * 1 0 0 0 0 0 0 1 * (Used in IQ-TREE for ORDERED model) Cheers, Minh ", "Hi Eduardo, I was about to suggest the same, because I don\u2019t know what the R code is doing. Cheers, Minh <Rplot.png> "]}, "mA7-OIaHm9Y": {"topic": "add aLRT/UFBoot to a completed tree", "initializeDate": "Feb 6, 2019, 12:54:18 PM", "timeStamp": "Feb 6, 2019, 4:52:20 PM", "content": ["Hello community, I wonder if one can add aLRT/UFBoot after a tree is already made. I did quite a few large-scale runs with tree search only, but without turning on the aLRT/UFBoot options. Afterwards I realized that I need some support values for the trees. Is there an easy way to do so? Thank you very much! Best, Qiyun ", "Hi Qiyun, Unfortunately in this case I think you will need to repeat the tree reconstruction. The UFBoot supports are calculated concurrently during the tree search, so they rely not only on the final tree but also on the other trees encountered during the tree search algorithm. So it is not possible to do this without doing the tree search process again. Cheers, Stephen Stephen Crotty, PhD Centre for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC 5, Ebene 1 A-1030 Vienna, Austria Email: stephen...@univie.ac.at You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hello Stephen, Thanks for letting me know! Best, Qiyun "]}, "6UNpLJynCl0": {"topic": "LSD Crashes with Partitions File", "initializeDate": "Jul 5, 2020, 3:56:58 PM", "timeStamp": "Jul 5, 2020, 9:18:35 PM", "content": ["I am having issues running iqtree2 v2.0.6 on my linux machine. The following command I am using is: ./iqtree2 -s Taxon.phy --date Taxon_dates.txt --date-ci 1000 --threads-max 8 --date-root -60 --date-tip 0 --date-options '-p Taxon_Partitions.txt' The analysis seems to work without the partitions file, so I am not quite sure what is going on here. Any insight will be helpful! For reproducibility, I am attaching the three files used in my example. Sincerely, Gio ", "Adding the log file as well. ", "Hi Gio, The partition file you provided looks like an input for IQ-TREE partition models. It contains partitioning of alignment sites. But the partition file for LSD2 has a completely different meaning: it\u2019s partitioning the taxa. So the file is not in the correct format. @Hien: Can you fix throw an error message about what went wrong, instead of a segmentation fault? Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6f8051c2-c708-4a2f-985a-fabef59eae6eo%40googlegroups.com <Taxon.phy.log> "]}, "kLUfiKLw5pA": {"topic": "Why is BIC default?", "initializeDate": "Jan 24, 2018, 7:50:36 PM", "timeStamp": "Jan 26, 2018, 7:19:12 AM", "content": ["I am just wondering why BIC is the default for model selection in ModelFinder? I am primarily seeing AICc used in recent publications. Is there research suggesting BIC is better in model selection for phylogenetics? I have read that BIC has a higher penalty for more parameters, and will prefer simpler models compared to AICc. Thank you, Therese ", "Dear Therese, This is a good question indeed! To the best of my knowledge there is no real research why BIC is better than AIC(c) and vice versa for phylogenetics. It\u2019s mainly from one\u2019s preference. It\u2019s true that BIC penalises parameter-rich models more than AICc and that\u2019s IQ-TREE's preference in the beginning. Moreover, some previous simulations done in jModelTest suggested that BIC gave slightly more accurate models compared with AICc. Our ModelFinder paper ( https://www.nature.com/articles/nmeth.4285 ) also observed this trend, though the difference is tiny. Note that PartitionFinder uses AICc as default \u2014 this can be one factor that explains the difference in ModelFinder and PartitionFinder results, if any. Finally you can always change the default in IQ-TREE via -merit AICc option. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout "]}, "h66g-H4pFsQ": {"topic": "How do you parse IQ-Tree data?", "initializeDate": "Jul 19, 2017, 6:23:41 PM", "timeStamp": "Aug 1, 2017, 5:53:20 AM", "content": ["My question is how do you parse this output? I want to be able to use this in a program like R or Python, but I'm not sure how to go about parsing this. For PAML/Codeml... ggtree has a nice parser for many of the Phylogenetic packages (but not IQ-Tree): If you look at the Codeml section you can see that ggtree is able to nicely parse the .rst and .mlc files that are produced by CODEML. Which one of these files can I use to reproduce this type of output? Thanks again, -Rob PS - I also noticed that this page has a big TODO tag on it: http://www.iqtree.org/doc/Analyzing-Big-Data ", "Dear Rob, On Jul 20, 2017, at 12:23 AM, Rob Gilmore < robgil...@gmail.com > wrote: My question is how do you parse this output? I want to be able to use this in a program like R or Python, but I'm not sure how to go about parsing this. can you be more specific, which information do you want to parse? In any case, most of the information are written in .iqtree report file. For PAML/Codeml... ggtree has a nice parser for many of the Phylogenetic packages (but not IQ-Tree): If you look at the Codeml section you can see that ggtree is able to nicely parse the .rst and .mlc files that are produced by CODEML. Which one of these files can I use to reproduce this type of output? I don\u2019t know what ggtree is, but assuming that you want to plot the tree. Then you can use .treefile, which has the final ML tree in NEWICK format. Thanks again, -Rob PS - I also noticed that this page has a big TODO tag on it: http://www.iqtree.org/doc/Analyzing-Big-Data Right, I was planning to write this chapter \u2026 but could not find the time yet. Will let you know once I\u2019m able to do so\u2026 Cheers, Minh ", "Minh, I think my biggest question is about the data. In PAML you get a giant output file. ggtree is an R package that allows you to parse phylogenetic data from different programs like PAML and then visualize it in R-Studio. Unfortunately there isn't one for IQ-Tree. Anyways, in the above files, of interest are the .treefile, the .mldist file. The .mldist file is the symmetric pairwise distance matrix (ML) that contains dN/dS ratios for each pair of sequences. This is valuable data. The .treefile contains the ML tree with dN/dS as the branch lengths. In the PAML output, you get a table: dN & dS for each branch branch dN/dS N*dN S*dS 16..17 0.184 356 127 1.004 0.0614 0.0611 21.9 7.8 17..18 0.045 356 127 1.004 0.015 0.0149 5.3 1.9 18..8 0.043 356 127 1.004 0.0142 0.0142 5.1 1.8 18..19 0.058 356 127 1.004 0.0193 0.0193 6.9 2.4 19..14 0.116 356 127 1.004 0.0387 0.0385 13.8 4.9 19..20 0.022 356 127 1.004 0.0074 0.0074 2.6 0.9 20..5 0.014 356 127 1.004 0.0046 0.0046 1.6 0.6 20..21 0.006 356 127 1.004 0.002 0.002 0.7 0.3 21..3 0.02 356 127 1.004 0.0066 0.0066 2.4 0.8 21..7 0.013 356 127 1.004 0.0044 0.0044 1.6 0.6 17..22 0.283 356 127 1.004 0.0944 0.094 33.6 11.9 22..12 356 127 1.004 22..23 0.027 356 127 1.004 0.009 0.0089 3.2 1.1 23..1 0.047 356 127 1.004 0.0157 0.0156 5.6 23..24 0.007 356 127 1.004 0.0022 0.0022 0.8 0.3 24..10 0.007 356 127 1.004 0.0022 0.0022 0.8 0.3 24..15 356 127 1.004 16..25 0.14 356 127 1.004 0.0469 0.0467 16.7 5.9 25..13 0.072 356 127 1.004 0.0239 0.0238 8.5 25..26 0.085 356 127 1.004 0.0283 0.0282 10.1 3.6 26..27 0.12 356 127 1.004 0.0401 0.04 14.3 5.1 27..11 0.035 356 127 1.004 0.0117 0.0116 4.2 1.5 27..9 0.027 356 127 1.004 0.0088 0.0088 3.1 1.1 26..28 0.023 356 127 1.004 0.0078 0.0078 2.8 28..4 0.02 356 127 1.004 0.0068 0.0068 2.4 0.9 28..2 0.014 356 127 1.004 0.0045 0.0045 1.6 0.6 28..6 0.014 356 127 1.004 0.0045 0.0045 1.6 0.6 I was wondering if there was a way to parse this data out from an iqtree run? So is there a way in IQ-Tree to get the same information that you get from PAML? Or at least this table with N, S, dN/dS, dN, dS, N*dN, and S*dS?? -Rob ", "Dear Rob, Now I see. The feature to generate such a table is NOT available in IQ-TREE - frankly I don\u2019t know how to compute these values. However, if you can generate it with PAML, then you can use PAML and I don\u2019t really see a point why you need IQ-TREE for this. Unless you can tell us, what output would you expect, that is currently not supported in PAML (and might not be available in near future). Cheers, Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thanks for the reply Minh. I just really enjoy the features of the IQ-Tree setup. And how easy it is to do the multiprocessing. PAML is very useful. It was created by one of the authors that you site for several of your models, etc. GY: Nonsynonymous/synonymous and transition/transversion rate ratios ( Goldman and Yang, 1994 Ziheng Yang It's tried and true, but it's more difficult to use. What I will probably end up doing is using IQ-Tree to generate trees for PAML input. ", "Dear Rob, Yes this also what I would suggest to do. Assuming that PAML is fast enough to compute these statistics... Cheers, Minh "]}, "wyW5F8al5Kc": {"topic": "Checkpointing for four-cluster likelihood mapping and likelihood mapping analyses", "initializeDate": "Oct 22, 2020, 5:04:32 AM", "timeStamp": "Oct 28, 2020, 4:17:51 AM", "content": ["Hi Minh, It would be nice if some checkpointing can be supported in the future versions for analyses of four cluster likelihood mapping and simple likelihood mapping (quartet analyses) so in case of power outage or similar problem not all quartets have to be calculated again. I am using 1.6.12 though I am not sure if in version 2 it is already supported? Thanks Alex ", "Hi Alex, You are right, likelihood mapping feature does not have checkpoint, also in version 2. This is normally fast, but indeed depends on the dataset. Especially if you do \u201c-lmap ALL\u201d to assess all possible quartets. Also, it\u2019s not a frequently used feature and we didn\u2019t prioritize it. Heiko: howevre, You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/44de5e99-57e5-406d-908c-1f1d12cfdfd7o%40googlegroups.com ", "PS: Heiko, do you think you can help to implement the checkpointing? ", "Hi Minh, Many thanks. You are right this is usually very fast but also depends on the model. I used a C60 model on a relatively large dataset so for some branches with a lot of quartets it is very slow. Best wishes Alex To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7750F23D-BCA6-4FD4-BDE3-E651A1187DC7%40univie.ac.at ", "Maybe its not used that oft, but I agree, I would also highly appreciate checkpointing!!!! Since I need it as well. Many thanks in advance :))! Best, Karen "]}, "7bAid4WAepA": {"topic": "BUG: virtual void error? `NUM_RATES==getNumRateEntries()' failed.", "initializeDate": "Aug 4, 2020, 3:41:08 PM", "timeStamp": "Aug 6, 2020, 8:13:06 PM", "content": ["Hello, I received the following errors when trying to run 'iqtree -s INPUT_ALIGNMENT -mset 1.1,2.2b,3.3a,3.3c,3.4,4.4a,4.4b -nt 20' with version 2.0.3 on linux using seed 407959 (though I have tried multiple runs with different seeds) ModelFinder will test up to 52 protein models (sample size: 401632) ... No. Model -LnL df AIC AICc BIC ERROR: modelliemarkov.cpp:331: virtual void ModelLieMarkov::init(const char*, std::__cxx11::string, StateFreqType, std::__cxx11::string): Assertion `NUM_RATES==getNumRateEntries()' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 5 () ERROR: 6 ModelLieMarkov::init(char const*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, StateFreqType, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) ERROR: 7 ModelLieMarkov::ModelLieMarkov(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, PhyloTree*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, StateFreqType, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) ERROR: 8 ModelMarkov::getModelByName(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, PhyloTree*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, StateFreqType, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) ERROR: 9 createModel(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, ModelsBlock*, StateFreqType, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, PhyloTree*) ERROR: 10 ModelFactory::ModelFactory(Params&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, PhyloTree*, ModelsBlock*) ERROR: 11 IQTree::initializeModel(Params&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, ModelsBlock*) ERROR: 12 CandidateModel::evaluate[abi:cxx11](Params&, ModelCheckpoint&, ModelCheckpoint&, ModelsBlock*, int&, int) ERROR: 13 CandidateModelSet::test(Params&, PhyloTree*, ModelCheckpoint&, ModelsBlock*, int, int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, bool) ERROR: 14 runModelFinder(Params&, IQTree&, ModelCheckpoint&) ERROR: 15 startTreeReconstruction(Params&, IQTree*&, ModelCheckpoint&) ERROR: 16 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 17 main() ERROR: 18 __libc_start_main() ERROR: 19 () The model seems to run without issue on a smaller alignment (~2 genes, ~50 taxa) but fails when I try to scale up to ~2,000 genes, though I am providing 50gb of memory and the log file tells me only 42gb is required. Let me know if you have any ideas and thank you! ", "Hi there, That\u2019s interesting, I never saw this assertion before. Just did a quick test on an example alignment and it worked. Can you send me this alignment to my personal email? Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/3f9d692c-a448-4c1a-bf2a-8c4d97e60237o%40googlegroups.com ", "It turned out that the alignment is protein, one can actually see that from the pasted log file: ModelFinder will test up to 52 protein models (sample size: 401632) \u2026 But -mset option specifies Lie Markov models for DNA sequences only. IQ-TREE should have printed some error message like that, instead of these messy ERRORs. But anyway problem solved. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/39A9D5E2-C78F-4FFA-9258-66EFAB2529E2%40univie.ac.at "]}, "gh-GnBPSSPc": {"topic": "AAmodel_Debugs", "initializeDate": "Jun 11, 2017, 12:22:47 PM", "timeStamp": "Jun 12, 2017, 10:59:37 AM", "content": ["Hi everyone I am going to use AA model to reconstruct standard bootstrap trees. In the last run, I used the version 1.5.4 and got an error message of: ===> START BOOTSTRAP REPLICATE NUMBER 1 Creating bootstrap alignment (seed: 670162)... WARNING: C is not present in partition Subset14 that may cause numerical problems WARNING: 1 states (see above) are not present that may cause numerical problems CHECKPOINT: Initial tree restored NOTE: 188 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.100) STACK TRACE FOR DEBUGGING: 1 funcAbort() 2 () 3 gsignal() 4 abort() 5 () 6 () 7 void computeBounds<Vec4d>(int, unsigned long, std::vector<unsigned long, std::allocator<unsigned long> >&) 8 double PhyloTree::computeLikelihoodBranchSIMD<Vec4d, false, 20, true, false>(PhyloNeighbor*, PhyloNode*) 10 GOMP_parallel() 11 PhyloSuperTreePlen::computeLikelihoodBranch(PhyloNeighbor*, PhyloNode*) 12 PhyloTree::optimizeAllBranches(int, double, int) 13 PartitionModelPlen::optimizeParameters(int, bool, double, double) 14 IQTree::optimizeModelParameters[abi:cxx11](bool, double) 15 runTreeReconstruction(Params&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, IQTree&, std::vector<ModelInfo, std::allocator<ModelInfo> >&) 16 runStandardBootstrap(Params&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, Alignment*, IQTree*) 17 runPhyloAnalysis(Params&, Checkpoint*) 18 main() 19 __libc_start_main() 20 _start() *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: /home/lk476/AA_model/IQtree_partition_AA.txt.log *** Alignment files (if possible) Do anyone know how to solve such problem? Or should I use the most updated version? P.S. I also used a partition file (see in attachment) generated by PartitionFinder 2. Best, Li-Yaung ", "Dear Li Yaung, can you pls paste the first 10 lines of the log file? (to know how many threads do you use). I noticed from the partition file: charset Subset23 = 16756-16841; Subset23 has only 86 sites, thus may have less distinct site patterns causing this abort. I would actually remove this subset from the analysis\u2026 Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <IQtree_partition_AA.txt> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh Thank you for reply! I will remove that subset and try again. The beginning of log file is: IQ-TREE multicore version 1.5.5 for Linux 64-bit built Jun 5 2017 Copyright (c) 2011-2017 by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, and Arndt von Haeseler. Host: william (AVX, FMA3, 125 GB RAM) Command: /home/lk476/IQ-TREE/build/iqtree-omp -s /home/lk476/AA_model/concatentated_neverIR_codon_170526.translated.phy -st AA -spp /home/lk476/AA_model/IQtree_partition_AA.txt -b 1000 -wbt -nt 30 Seed: 670162 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Sun Jun 11 09:53:44 2017 Kernel: AVX+FMA - 30 threads (64 CPU cores detected) Reading partition model file /home/lk476/AA_model/IQtree_partition_AA.txt ... Reading alignment file /home/lk476/AA_model/concatentated_neverIR_codon_170526.translated.phy ... Phylip format detected Alignment most likely contains protein sequences WARNING: 133 sites contain only gaps or ambiguous characters. Alignment has 32 sequences with 20580 columns and 12780 patterns (9792 informative sites, 8079 constant sites) .... Best, Li-Yaung Bui Quang Minh\u65bc 2017\u5e746\u670812\u65e5\u661f\u671f\u4e00 UTC+8\u4e0b\u53485\u664243\u520611\u79d2\u5beb\u9053\uff1a ", "Hi Minh The same debug message as mentioned previously also came out after removing subset 23. Best, Li-Yaung Bui Quang Minh\u65bc 2017\u5e746\u670812\u65e5\u661f\u671f\u4e00 UTC+8\u4e0b\u53485\u664243\u520611\u79d2\u5beb\u9053\uff1a Dear Li Yaung, ", "ok now I see why. Please reduce the number of threads to be at most the number of partitions. This should resolve it. Moreover, having too many threads does not speed up the analysis. Cheers, Minh "]}, "Y7fAhL3Slf0": {"topic": "Partition finding error", "initializeDate": "May 1, 2017, 10:08:33 AM", "timeStamp": "May 2, 2017, 8:10:47 AM", "content": ["Hello, I have been trying to partition some large alignments using IQ-TREE, but keep encountering the following error (a failed assertion): iqtree: /home/mussmann/local/src/IQ-TREE/phylokernelnew.h:2486: double PhyloTree::computeLikelihoodBranchSIMD(PhyloNeighbor*, PhyloNode*) [with VectorClass = Vec4d; bool SAFE_NUMERIC = true; int nstates = 4; bool FMA = true; bool SITE_MODEL = false]: Assertion `!std::isnan(tree_lh) && !std::isinf(tree_lh) && \"Numerical underflow for lh-branch\"' failed. I tried to attach the log file, but it was too large. It is instead hosted on my google drive: https://drive.google.com/open?id=0B9Rmakzgf6MQSHM0TUtTYVJPeU0 Thank you in advance for any help you can provide, -Steve ", "Hi Steve, thanks for the report. From one line in the log file: NOTE : minimal branch length is reduced to 0.000000079048 for long alignment While this minimal branch length is ok for analysis on your whole alignment, it seems too small for the partitions during the merging phase, which may cause numerical underflow. Therefore, can you pls override this behavior by option -blmin. Eg., -blmin 1e-6 to set min branch length to 10^-6. Let me know how it goes. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Great, thank you. I will give this a try and report back. -Steve "]}, "8_Yoars0-GE": {"topic": "Bypass Model selection when dating tree", "initializeDate": "Sep 15, 2020, 2:38:47 PM", "timeStamp": "Sep 22, 2020, 9:49:55 PM", "content": ["Hello, I am trying to avoid running model selection when estimating divergence dates (already have one), but when i try to include the model, it still estimates a model so far. I am using iqtree v 2.06. My command line is below, Any thoughts? ~/bigdata/iqtree-2.0.6-Linux/bin/iqtree2\\ -s LCOMP_8.phy -te DROOT.tree -m TVM+F+I+G4 --date-root 55 --date-tip 0 --date-ci 100 -nt 4 -pre DATE_1 Thanks, Dylan ", "Hello again, I figured it out. This was my code, I think updating to the new iqtree 2.1.1 helped. module load IQ-TREE ~/bigdata/iqtree-2.1.1-Linux/bin/iqtree2\\ -s LCOMP_8.phy\\ -te DROOT.tree\\ -m TVM+F+I+G4\\ --date DATE_FILE\\ --date-tip 0\\ --date-ci 100\\ -nt AUTO\\ -pre DATE_2 Thanks, Dylan ", "I assume that this issue has been resolved\u2026 thanks for doing it yourselves ;-) Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/864afe9f-45c3-4f64-8442-e3d79cae8cb9n%40googlegroups.com "]}, "DigX-8S5DQo": {"topic": "IQ Tree Data set", "initializeDate": "Feb 23, 2017, 3:24:05 AM", "timeStamp": "Feb 23, 2017, 5:30:22 AM", "content": ["Hi, I need your data set that you used during construct your software(IQ Tree) that you compared your results with others thanks ", "Hi there, the benchmark data sets used in Nguyen et al., 2015 can be downloaded from here: https://bitbucket.org/tung_nguyen/iq-tree/downloads/alignments.tar.gz Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "t81jM4q2ScA": {"topic": "Modelfinder - all partitions of a set or only codon partition for partition merging", "initializeDate": "Jan 25, 2018, 2:15:20 AM", "timeStamp": "Jan 29, 2018, 2:37:02 PM", "content": ["Hello all, If I want to find the best partition scheme for a partition containing 3 codon positions, partitioned into 3 sets - is it better to test only this one set, or should I test it within a set of all partitions of the analysis together, or does it make no difference? I think it should make a differnce, since the guide tree is calculated on the complete set in the second case. But is it more accurate? All the best Dieter ", "Hi Dieter again, yes the second option is preferred: > I test it within a set of all partitions of the analysis together You correctly stated the reason (about the guide tree). However, whether is it more accurate or not: I don\u2019t know. But it will tend to be more accurate given full data set with all partitions. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Thank you Minh again, That helps. All the best Dieter You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/t81jM4q2ScA/unsubscribe To unsubscribe from this group and all its topics, send an email to ", "Hello Minh, Sorry to ask again - I forgot one thing: When I already have an accurate guide tree, which was calulated with all partitions, can I then only use the single partition containing 3 codon positions without loosing accuracy? All the best Dieter ----- Original Message ----- From: \"Bui Quang Minh\" < minh...@univie.ac.at To: < iqt...@googlegroups.com Sent: Friday, January 26, 2018 1:31 PM Subject: Re: [iqtree] Modelfinder - all partitions of a set or only codon partition for partition merging You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/t81jM4q2ScA/unsubscribe To unsubscribe from this group and all its topics, send an email to ", "Hi Dieter, Yes you can use -t option to specify a starting (guide) tree, which was computed before. Minh ", "Thank you Minh for the confirmation. That helps a lot. "]}, "BHvOe-QKWGg": {"topic": "BUG (?): IQTREE crashing when running MF", "initializeDate": "Oct 21, 2018, 12:14:14 PM", "timeStamp": "Oct 22, 2018, 5:01:44 AM", "content": ["I've attempted this run in three different PCs (Windows 8 and 10) and on two IQTREE versions (1.6.4 and 1.6.7.1) and get the same issue everytime. Command line is: iqtree -s data.nex -spp partitions.nex -bb 1000 --runs 10 The moment it starts running MF, it crashes and IQTREE is forced to close. Seed number: 127001 The last log files are (there is no ERROR message): Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.024 seconds NOTE: ModelFinder requires 13 MB RAM! Testing GTR+F+G on supermatrix... GTR+F+G4 / LnL: -17971.561 / df: 142 / AIC: 36227.122 / AICc: 36290.381 / BIC: 36889.649 Selecting individual models for 2 charsets using BIC... No. Model Score Charset Thanks for the help! ", "Hi Michele, Can you please send here the screenshot of the crash message/window? Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "HWqeJCYo9QI": {"topic": "C60 Model with rRNA Data?", "initializeDate": "Jun 23, 2017, 10:10:27 AM", "timeStamp": "Jun 24, 2017, 2:24:02 PM", "content": ["I have just read a paper where they apparently ran the C60 model in IQTree with rRNA data (i.e. they have \"IQTreeC60.contree\" files within a rRNA data directory). The IQTree Documentation page describes the C60 model for protein data. Is it appropriate to use with nucleotide data? I have tried to replicate these runs using the following command strings, but each has returned an error: iqtree-omp -s <alignment> -m C60 -bb 1000 -nt 4 iqtree-omp -s <alignment> -m GTR+C60 -bb 1000 -nt 4 Would someone please tell me the correct command syntax for using the C60 model? Thanks, David Kerk ", "Hi David, can you send us the link to that paper? There was a discussion here about recoding amino-acid sequences into a 4-state space, and there one can transform C60 model ( https://groups.google.com/forum/#!topic/iqtree/j884eSJiugY ). However, I guess that is not what you meant here. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh: Thanks for your kind reply. The paper is: Asgard archaea illuminate the origin of eukaryotic cellular complexity PMID: 28077874. The first author is Katarzyna Zaremba-Niedzwiedzka. I followed the link on the previous recoding conversation you had with Joran and Kasia, and it is clear that Kasia is this first author. In the data archive I got from a link posted at the Ettema Lab web site, there are \u201crRNA_genes\u201d folders. Within them, there are IQTree runs listed as \u201cGTRIG4\u201d and \u201cC60\u201d. Knowing now that recoding was probably done, I found in their Supplementary Methods the statement that they used \u201cthe user defined model \u2018C60SR4\u2019 for recoded datasets.\u201d It is curious that they chose to publish an ML tree (Fig1c) which has support for the Asgard sequences which is lower than that in the C60 tree (recoded data) in their data archive. Anyway, the mystery is solved. Thanks again for your help. Dave You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/HWqeJCYo9QI/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com "]}, "3BHXhyBbkG0": {"topic": "Re: [iqtree] Test for incongruence", "initializeDate": "Apr 26, 2020, 9:41:04 PM", "timeStamp": "Apr 27, 2020, 5:31:19 AM", "content": ["Hi Harris, The answers to your questions depend on what you are trying to do. 1) Are these the trees that I am to use in the above command? If not, do I generate the trees using IQ-TREE? If you want to compare these two tree topologies you generated in PhyML, then yes you should use these two trees. If you want to compare these two trees to the best tree that IQ-TREE can find, you should also estimate a tree with IQ-TREE and add that into your set of trees. 2) I understand that -z is supposed to be a set of trees. In this case, do I provide all the trees in this command? For instance, have -z tree.1nxs,tree2.nxs. You should add all the trees into a single file, with one tree per line. You can follow the example usage given here: http://www.iqtree.org/doc/Command-Reference (search for '-z' and you'll fine it). I am a bit confused on how to run the command using my two alignments and two trees (generated using Phylm). Here you need to understand exactly what you are doing. These tests are based on likelihoods of observing alignments. In other words, the tests ask a question something like: Assuming alignment X and model Y, are these trees significantly different from one another. So you need to decide which alignment you are going to use, and which model you are going to use. A common approach is to use the model used to infer the ML tree, and ask if the other trees can be rejected under that model. A much more detailed and more thorough explanation of these tests can be gained from this excellent paper: https://academic.oup.com/sysbio/article/49/4/652/1678908 The tests all make somewhat different assumptions about the data, so it's often important to understand these in detail before making interpretations. Yours, Rob I would be pleased to here from you. Regards, Harris You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4dfcdc2a-38e1-448f-9457-2c61783a5631%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Dear Rob, Thanks a lot for your detailed reply. Now a lot makes sense. Regards, Harris On Monday, 27 April 2020 03:41:04 UTC+2, Rob Lanfear wrote: Hi Harris, The answers to your questions depend on what you are trying to do. 1) Are these the trees that I am to use in the above command? If not, do I generate the trees using IQ-TREE? If you want to compare these two tree topologies you generated in PhyML, then yes you should use these two trees. If you want to compare these two trees to the best tree that IQ-TREE can find, you should also estimate a tree with IQ-TREE and add that into your set of trees. 2) I understand that -z is supposed to be a set of trees. In this case, do I provide all the trees in this command? For instance, have -z tree.1nxs,tree2.nxs. You should add all the trees into a single file, with one tree per line. You can follow the example usage given here: http://www.iqtree.org/doc/Command-Reference (search for '-z' and you'll fine it). I am a bit confused on how to run the command using my two alignments and two trees (generated using Phylm). Here you need to understand exactly what you are doing. These tests are based on likelihoods of observing alignments. In other words, the tests ask a question something like: Assuming alignment X and model Y, are these trees significantly different from one another. So you need to decide which alignment you are going to use, and which model you are going to use. A common approach is to use the model used to infer the ML tree, and ask if the other trees can be rejected under that model. A much more detailed and more thorough explanation of these tests can be gained from this excellent paper: https://academic.oup.com/sysbio/article/49/4/652/1678908 The tests all make somewhat different assumptions about the data, so it's often important to understand these in detail before making interpretations. Yours, Rob I would be pleased to here from you. Regards, Harris You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4dfcdc2a-38e1-448f-9457-2c61783a5631%40googlegroups.com "]}, "teMmFHg3J6I": {"topic": "Why iq-tree not speedup on cluster environment?", "initializeDate": "Sep 27, 2018, 2:26:44 AM", "timeStamp": "Sep 28, 2018, 6:21:27 AM", "content": ["I submit iq-tree job to a slurm cluster environment with this command: #!/bin/bash #SBATCH --nodes=16 #SBATCH --cpus-per-task=24 #SBATCH --partition=work srun iqtree nt AUTO s file1 2000 srun iqtree nt AUTO s file2 2000 The iqtree binary is compiled with omp-mpi option. I expect iq-tree to use 8*24 = 192 (CPUs), but iqtree show this message in log file. NOTE 1665 MB RAM required Measuring multi threading efficiency up to CPU cores trees examined Threads Time 38.875 sec Speedup 1.000 Efficiency 100 / LogL: -602418 Threads: 2 / Time 62.595 sec Speedup 0.910 Efficiency LogL 708891 BEST NUMBER OF THREADS After submit the job, I login to the computation node find out the CPU load is ultra low. It seems that iqtree is not speedup on mpi run. ", "Hi Chang, The student who initiated the MPI feature left the project, so it\u2019s not well tested. I\u2019m not sure if -nt AUTO option works with MPI\u2026 Please specify the number of threads. Thanks, Minh <DeepinScreenshot_select-area_20180927140933.png> You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <DeepinScreenshot_select-area_20180927140933.png> ", "Thanks for the info. But I wonder why the speedup fold value is lower than 1 when multiple thread is used. Speedup 0.910 ", "Yes it looks weird indeed, but as said the combination of -nt AUTO and MPI might not work. Cheers, Minh ", "Ok, I\u2019ll adjust the -nt argument and report the performance here. "]}, "NJGaHstIgUo": {"topic": "Tree search estimation", "initializeDate": "Feb 19, 2016, 8:19:06 AM", "timeStamp": "Feb 20, 2016, 4:03:33 AM", "content": ["Hello .. iam interested in your sofware iqtree i'd thank you about it but i have several questions about your source code my first question is about tree search and why did you use greedy search + localsearchPD + exhaustive search ?? and iam very confused about your algorithms sequence from generate your initial tree to choose your final optimal tree ?? please estimate this point to me . thanks alot ", "Hi, Our search algorithm is described in the following paper: https://mbe.oxfordjournals.org/content/early/2014/11/03/molbev.msu300 There we explain every single steps of our search strategy. If you have any other questions (after reading the paper), feel free to contact us. Cheers Tung You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "I already red this paper but what is your point of view to use greedy search function , localsearchPD and exhaustive search . i need to know your opinion in this point particularlly ?? why 3 local search strategies ?? thanks :) ", "Hi there, these functions have nothing to do with the IQ-TREE algorithm but the phylogenetic diversity (PD) analysis, a complete different topic. If you have further technical questions on the code, please contact Tung, Olga and me directly. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "o8fAMPa1qHg": {"topic": "Error running IQTREE: Wrong computeFuncDerv", "initializeDate": "Jan 30, 2016, 10:35:19 PM", "timeStamp": "Feb 1, 2016, 4:37:49 AM", "content": ["Dear Minh, I tried codon model of IQTREE 1.3.11, specifying like this: -s my_alignment -st CODON -m TESTNEW -pers 0.1 -alrt 1000 -bb 1000 I got the following error: Computing ML distances based on estimated model parameters...NUMERICAL ERROR: Wrong computeFuncDerv. *** IQ-TREE CRASHES WITH SIGNAL ABORTED Would you please help? Best regards, Giap Nguyen ", "Dear Giap, it is not clear what caused the crash. Therefore, can you please send me the alignment and the log file via my personal email? Thanks, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "pu5mFR56K84": {"topic": "iqtree2 OMP message", "initializeDate": "Apr 15, 2021, 8:12:56 AM\u00a0(13 days ago)\u00a0", "timeStamp": "Apr 15, 2021, 10:25:12 PM\u00a0(12 days ago)\u00a0", "content": ["When I run iqtree2, iqtree2 -s ${SAMPLE}.nex -nt 6 -wbt -bb 1000 It shows this message ? OMP: Info #270: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead #25 Best, Kevin ", "Hi Kevin. >When I run iqtree2, That message can be ignored. Those are two OMP functions (OMP is what IQTree2 uses to run things in parallel). In older versions of OMP, you had to use a omp_set_nested function to turn nested parallelization on or off (if it is turned on, and the code asks to do something in parallel, inside something else that is already being done in parallel, OMP allows it). IQTree2 is calling omp_set_nested to explicitly turn off nested parallelization because the tree search malfunctions when it is turned on. (And it might be turned on, by default, or via an environment variable, depending on which OMP implementation IQTree2 is being compiled to use). In more recent versions of OMP, there is an omp_set_max_active_levels function that does something similar. For now, IQTree2 calls the older function, for the sake of compatibility with older versions of OMP. (In some OMP implementations, like Oracle's, it is still necessary to call omp_set_nested, because omp_set_max_active_levels only controls \"how many levels of nesting will be allowed if nesting is allowed\"; it doesn't control whether nesting will be allowed) (In some other OMP implementations, calling omp_set_max_active_levels, is by itself sufficient to control nesting behaviour). Regards, James "]}, "HAxyKySfAXI": {"topic": "BOOSTER precision", "initializeDate": "Nov 13, 2018, 12:50:32 PM", "timeStamp": "Nov 14, 2018, 9:36:36 PM", "content": ["Hi Minh, you wrote in the BOOSTER discussion: \"That\u2019s right. Because TBE was designed to correct Felsenstein\u2019s bootstrap, not UFBoot. In fact, UFBoot already has a bias correction, thus doing a double correction (UFBoot+TBE) is not valid. I clarified this with Booster author ( https://github.com/evolbioinfo/booster/issues/1 ). \" I would appreciate some clarification concerning this point. TBE is computed from a set of bootstrap trees and in the cas of UFB we have also a set of 'FSB-like'-bootstrap trees. This set is conceptually similar to the set of Felsestein bootstrap trees. After a careful reading of the first and second paper concerning UFB, I cannot find the indication of a 'correction' of the set of trees or individual UFB tree. Even if there are build under another assumptions and by another way, the UFB bootstrap trees set remains a set of \"possibles\" trees. So I do not understand why TBE cannot be computed from the UFB bootstrap set. I think that the early position of the BOOSTER team was close to mine and that the answer you received was mainly due to a misunderstanding (the discussion with F Lemoine on the booster github site with is -for me- frustrating). Of course I agree that much precautions have to be taken in the interpretation as the demonstration of the interest of TBE is dealing only on FSB. JPF LBBE Lyon I have already put this post within the BOOSTER discussion, but I think better to individualize it. ", "Hi JPF, I believe this was explained in our 2013 paper ( https://doi.org/10.1093/molbev/mst024 ). Fig 1 showed that the support values of UFBoot (red) and SBS (blue) are (substantially) different, where UFBoot is close to the diagonal line. Then we discussed that: Although SBS and RBS estimates of clade support are conservative (see also Hillis and Bull 1993; Anisimova et al. 2011), the clade support estimated by UFBoot appears less biased according to our large-scale simulations. This leads to a different and easy-to-understand interpretation of the support values. For example, a support of at least 95% should be used if one wants to control the false-positive rate of 5%\" In fact we repeated the simulations several months ago: when doing UFBoot+TBE, then the support values become too high, leading to very high false positives. We clarified this with the TBE team, that one shouldn\u2019t apply TBE on UFBoot trees. Does this answer your question? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Thank you for the answer. If I understand correctly the mode of construction of the UFBoot \"quasi-bootstrap tree set\" i.e using RELL-IQPNNI is the cause of the over-optimistic results obtained by using UFBoot-BOOSTER. Am I right ? JPF ", "Hi JPF, Yes you can call them quasi-bootstrap trees. They are sampled from the original alignment, not independently from bootstrap alignments. That\u2019s why they might be different, leading to different BS support values. Minh "]}, "orf5DhZ4Tfs": {"topic": "Quartet mapping from predifined groups", "initializeDate": "Mar 16, 2016, 8:47:31 PM", "timeStamp": "Apr 26, 2016, 3:59:13 AM", "content": ["Dear Minh, Heiko, great that you have implemented this feature! My aim is to use this tool to test for conflicting signal with respect for particular nodes. Therefore I would like to sample all possible but unique quartets from predefined groups - which would be in the given example in the manual 4*3*2*1 = 24 quartetts. I am a bit confused after reading the thread: https://groups.google.com/forum/#!topic/raxml/h4Hsv2lNODo 1) I wonder how I can use the quartet mapping for all possible quartets considering only unige quartets ? If I don't specify -lmap is this done then automatically? 2) If the number gets too large to restrict the number to e.g. 20000 from which quartets are randomly drawn, but still unique? Can this be done optional? I will post the same question in the RAXML google group because the question applies for RAxML and IQtree. Thanks, Karen ", "Dear Karen, the feature to use all possible is not (yet) possible. That is the next on my list and I already know how I want to do this. (The way to state that to IQ-TREE will certainly using \u201c-lmap 0\u201d ;) Best wishes, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Dear Heiko and all, many thanks :) I will wait for this then since I need this option. Furthermore I would still appreciate if the user can choose between with/without replacement (for both, all possible and random sampling up to an limited number, since I would choose without. It would be also great to clarify this with the RAxML/ExaML developers. Many Many thanks Karen ", "Dear Karen, can you please give an explicit example why drawing with/without replacement matters for the resulting likelihood mapping analysis? We just need a concrete evidence, before implementing the \"without replacement\" option, because such implementation is not simple at all. Thanks, Minh ", "Dear all, sorry for my delayed reply (moving back to Europe). Here I try a n explanation: Lets say I have 4 predefined groups (in brackets), in each group 2 species (A, B), (C,D), (E,F), (G,H) If for example G has a conflicting signal and give different results than H, I would like to consider only quartets without replacement to figure this out, so I would need all quartets without replacement. With replacement might bias my result or makes it more difficult to find out about this conflicting signla since quartet mapping in this way provides me a very useful tool for testing single nodes. Therefore implementing a) all possible quartets and b) drawing without replacement (as option if you like) would be much appreiated (also implemented in ExaML) Best Karen ", "Dear Karen, with version 1.4.2 there is now option -lmap ALL to draw all unique quartets. Cheers, Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Absolutely awesome :) ! We are running tests and trying it right know! Many thanks to all of you ! Best (and sorry for the delayed reply) Karen "]}, "qXqJYmE9o2I": {"topic": "IQ-Tree release 1.3.6", "initializeDate": "Aug 16, 2015, 4:47:54 PM", "timeStamp": "Aug 17, 2015, 4:55:43 AM", "content": ["Dear all, we are happy to release IQ-Tree version 1.3.6 with following substantial changes: An expectation-maximization (EM) algorithm is implemented to optimize weights of mixture models (thanks to Huaichun Wang, Andrew Roger, Edward Susko for reporting initial issue on local optimum and providing this solution). The EM algorithm guarantees convergence on global optimum and was described in Wang et al. (2008), BMC Evol. Biol. 8:331. Fix an issue in reading morphological alignments (thanks to Max Maronna for reporting this). +I+G is added back into the candidate model list of new model selection procedure (-m TESTNEW). The starting phase of tree search now includes a BIONJ into the candidate tree set, which is sometimes better than parsimony trees. Building from source code now generates dynamically linked binary. To build static binary, run cmake with e.g. \"cmake -DIQTREE_FLAGS=static source_dir\" Best, IQ-Tree development team ", "Dear Minh, sounds great! short questions: 1) Did you observe problems with protein mixture models and getting stuck local optima (especially using LG4X) - if so, which one and is this accomplished with the new release? 2) starting tree option: * is including the BIONJ tree included as the parsimony tree automatically (did not get how to specify this) * can you please also implement an option to use a completely randomized tree as starting tree? (or do I have to generate one with the option(s) -r (any recommendations?) (we observed in several programs that randomized starting trees might be better - at least than parsimony or stepwise parsimony - for sampling and avoid local optima) Many thanks Karen ", "Dear Minh, great work! Karen's first question is realy important for us. Does the new release indeed solve the local optimum problem of e.g. a LG4X model? Best, Bernhard >> - An expectation-maximization (EM) algorithm is >>implemented to >> optimize weights of mixture models (thanks to >>Huaichun Wang, Andrew Roger, >> Edward Susko for reporting initial issue on local >>optimum and providing >> this solution). The EM algorithm guarantees >>convergence on global optimum >> and was described in Wang et al. (2008), BMC Evol. >>Biol. 8:331. >> - Fix an issue in reading morphological alignments >>(thanks to Max >> Maronna for reporting this). >> - +I+G is added back into the candidate model list of >>new model >> selection procedure (-m TESTNEW). >> - The starting phase of tree search now includes a >>BIONJ into the >> candidate tree set, which is sometimes better than >>parsimony trees. >> - Building from source code now generates dynamically ", "Dear Karen and Bernhard: On 17 Aug 2015, at 03:46, Karen Meusemann < kmeus...@googlemail.com > wrote: Dear Minh, sounds great! short questions: 1) Did you observe problems with protein mixture models and getting stuck local optima (especially using LG4X) - if so, which one and is this accomplished with the new release? Yes I observed local optimum problem in LG4X implementation as Alexis also informed me. Unfortunately this problem with LG4X is not resolved yet. The mixture models I meant are e.g. CF4 and C20, where I optimize the weights, whereas LG4X in addition has individual rates for mixture components. Right now this EM algorithm is not applicable to optimize both weights and rates. But I will communicate with Wang et al. to see if one can adjust the EM algorithm for this more general case. 2) starting tree option: * is including the BIONJ tree included as the parsimony tree automatically (did not get how to specify this) yes the BIONJ tree is included automatically, among the initial parsimony trees, thus you don\u2019t need to specify anything ;-) IQ-Tree will consider those trees that have the highest likelihoods. * can you please also implement an option to use a completely randomized tree as starting tree? (or do I have to generate one with the option(s) -r (any recommendations?) Ok I will add such option. However, right now you can input a starting tree via -t option. (we observed in several programs that randomized starting trees might be better - at least than parsimony or stepwise parsimony - for sampling and avoid local optima) I see\u2026 actually IQ-Tree is a already a series of hill-climbing search, each starting from a randomized tree (obtained from the current best trees by perturbing a proportion of branches). This is controlled via a perturbation strengthen (-pers option) varying from 0 to 1 (default = 0.5). 1 means completely randomized\u2026 Thus you can set \u201c-pers 1\u201d if you believe that this is better for your data set. Cheers, Minh Many thanks Karen Am Montag, 17. August 2015 06:47:54 UTC+10 schrieb Bui Quang Minh: Dear all, we are happy to release IQ-Tree version 1.3.6 with following substantial changes: An expectation-maximization (EM) algorithm is implemented to optimize weights of mixture models (thanks to Huaichun Wang, Andrew Roger, Edward Susko for reporting initial issue on local optimum and providing this solution). The EM algorithm guarantees convergence on global optimum and was described in Wang et al. (2008), BMC Evol. Biol. 8:331. Fix an issue in reading morphological alignments (thanks to Max Maronna for reporting this). +I+G is added back into the candidate model list of new model selection procedure (-m TESTNEW). The starting phase of tree search now includes a BIONJ into the candidate tree set, which is sometimes better than parsimony trees. Building from source code now generates dynamically linked binary. To build static binary, run cmake with e.g. \"cmake -DIQTREE_FLAGS=static source_dir\" Best, IQ-Tree development team Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, 1) thanks for clarification according to LG4X and the other mixture models and optimization. It would be great if you - maybe having a work around/solution - communicate it back to Alexis. (We observed so far that LG4X outperformes other models so would be awesome to have an imoproved solution not to get stuck in local optima during tree recnstructions 2) start tree: thanks for considering to implement this and secondly I will try :) Thanks Karen ", "Dear Karen, for 1): yes sure, Alexis and we are exchanging ideas constantly ;-) Minh "]}, "M-rtp9jpEqI": {"topic": "Explicitly reporting observed amino acid frequencies of the alignment", "initializeDate": "Oct 26, 2017, 6:32:14 AM", "timeStamp": "Nov 8, 2017, 4:42:59 AM", "content": ["Hi! I'm currently trying to run some parametric simulations using SiteSpecific.seq-gen ( http://www.mathstat.dal.ca/~hcwang/Procov/SiteSpecific.seq-gen/ ). Ideally, I would like to run simulations with the +F version of the model, meaning I need to extract the observed amino acid frequencies from the alignment, and feed them into the simulation software. It would therefore be great if IQTREE would report the observed frequencies it uses for the +F somewhere (maybe in the .log, or a separate output file?). I could write a little script myself, but since I want to be absolutely sure I'm using the same +F frequencies as IQTREE, I feel this would be a bit better. My apologies if IQTREE already does this, but I wasn't able to find them. Cheers, Joran ", "Hi Joran, When you run the protein analysis with -m LG+F for example, then the amino-acid frequencies will be printed into .iqtree file like this: SUBSTITUTION PROCESS -------------------- Model of substitution: LG+F State frequencies: (empirical counts from alignment) pi(A) = 0.0790 pi(R) = 0.0395 pi(N) = 0.0358 pi(D) = 0.0544 pi(C) = 0.0193 pi(Q) = 0.0487 pi(E) = 0.0513 pi(G) = 0.0881 pi(H) = 0.0245 pi(I) = 0.0509 pi(L) = 0.0932 pi(K) = 0.0741 pi(M) = 0.0237 pi(F) = 0.0433 pi(P) = 0.0423 pi(S) = 0.0604 pi(T) = 0.0561 pi(W) = 0.0136 pi(Y) = 0.0372 pi(V) = 0.0646 Which you can use. Moreover, I CC my collaborator, Huaichun here, in case he has further tip. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, I can't find this information in the .iqtree file. Under substitution process, it only reports the mixture weights for the 60 components and the F component, and the gamma relative rate parameters. Maybe it doesnt report the observed frequencies when you invoke a mixture model? For this analysis, I'm using version 1.5.0, and invoked the model LG+C60+F+G. For now I'll just run a dummy LG+F analysis to get the frequencies, but I suppose it would be nice to have them reported when you run LG+C60+F+G or similar models as well. Joran ", "Dear Joran, I am not completely sure what you need. If you need the observed column-wise AA frequencies (a wild guess because you use SiteSpecific.seq-gen), I think this is not output by IQ-Tree. If I remember correctly, I had implemented that output into TREE-PUZZLE sometime in the past. If that is what you need\u2026 I can dig up the command line options required to get this. However, TREE-PUZZLE requires standard PHYLIP/Newick input for the alignment, that means the whole alignment has to be in one file and sequence names are only allowed up to 10 letters. For the latter restriction (10 letter) there is a pretty easy way to ensure this, because just for extracting the site AA frequencies, you do not need to keep the original names. (I can provide more information if required.) Best, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) Campus Vienna Biocenter 5 (VBC5) A-1030 Vienna, Austria http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Hej Heiko, IQ-TREE does output the overall observed amino acid frequencies, which is what I need. It just doesn't seem to output it when I specify a mixture model. It did output them when using LG+F , like Minh said. And yes, the frequencies are meant for SiteSpecific.seq-gen. Huaichun updated the tool recently so you can input your own amino acid frequencies. So, for me the problem is solved. I just run IQ-TREE with LG+F to get the observed frequencies of a dataset, and then use those as input for SiteSpecific.seq-gen. I was just pointing out that it was a bit strange that if you specify a mixture model in addition to +F, IQTREE does not output the observed overall amino acid frequencies. Cheers, Joran ", "Hi Joran again, I put this into the TODO list\u2026 "]}, "3Wa0iiwg4w8": {"topic": "Relative rate clarification", "initializeDate": "Oct 12, 2016, 4:51:35 AM", "timeStamp": "Oct 12, 2016, 9:09:43 AM", "content": ["Hi all, I'm just seeking a clarification on how relative rates are calculated? More specifically, what are relative to? For example, in my output I get this: Category Relative_rate Proportion 0 0 0.7933 1 0.6464 0.05166 2 2.282 0.05166 3 4.825 0.05166 4 11.6 0.05166 Relative rates are computed as MEAN of the portion of the Gamma distribution falling in the category. I understand that the relative rate of category 4 is calculated as the mean relative rate of all sites that fall in that category, but I do not understand what it is relative to. Sorry if this is an obvious question, but I haven't been able to find an answer. Thank you in advance, Tim ", "Dear Tim, this is a good question. The \u201crelative\u201d means that the Gamma rates are rescaled such that the weighted sum of rates is 1 (see below), so that the branch lengths of the tree are interpreted as the number of substitutions per site. More specifically, the +I+G4 model effectively means that one has five rate categories: Category Rate Proportion 0 0 p_inv 1 r_1 (1-p_inv)/4 2 r_2 (1-p_inv)/4 3 r_3 (1-p_inv)/4 4 r_4 (1-p_inv)/4 where p_inv is the proportion of invariable sites. The rates r_i are first inferred from the Gamma distribution, and then rescaled s.t. the following weighted sum is 1: sum_i (r_i * (1-p_inv)/4) = 1 Does this answer your question? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "7lUH2iDFiYw": {"topic": "Merging partitions into best-fit partitioning scheme without model selection", "initializeDate": "Dec 27, 2017, 6:37:50 AM", "timeStamp": "Dec 28, 2017, 10:55:24 AM", "content": ["Is it possible to search in IQ-TREE for best-fit partitioning scheme without model selection (i.e. with a particular user-selected model of sequence evolution) ? I'm running IQ-TREE as follows with partitions definde in \"geneANDcodonpartitions.txt\" for each codon position of each gene: iqtree omp 1.5 Linux bin iqtree omp FcC_smatrix_nostops fas spp geneANDcodonpartitions txt m GTR rcluster alrt 1000 1000 pre IQTRE1 I have large dataset and the above run with option mset GTR mrate I m TESTMERGE will not finish in reasonable time. Therefore I was wondering if it actually make sense to search for a best-fit partitioning scheme without model selection? I might be here misunderstanding the partition scheme selection process. Thanks in advance for any clarification. ", "Hi Ales, On Dec 27, 2017, at 12:37 PM, Ales Bucek < bucek...@gmail.com > wrote: Is it possible to search in IQ-TREE for best-fit partitioning scheme without model selection (i.e. with a particular user-selected model of sequence evolution) ? I'm running IQ-TREE as follows with partitions definde in \"geneANDcodonpartitions.txt\" for each codon position of each gene: iqtree omp 1.5 Linux bin iqtree omp FcC_smatrix_nostops fas spp geneANDcodonpartitions txt m GTR rcluster alrt 1000 1000 pre IQTRE1 I assume that you want to apply GTR+I+G for all partitions. Then that\u2019s the right command. -rcluster is not necessary here because no partition scheme merging is performed. I have large dataset and the above run with option mset GTR mrate I m TESTMERGE will not finish in reasonable time. If you want to speed up this analysis: then please download version 1.6 just released. It introduced an option -rcluster-max (like PartitionFinder2) to restrict the number of partition pairs to consider, which will considerablly speed up the analysis. Moreover, you can also try -rclusterf (instead of -rcluster) for fast relaxed clustering. The modified command may look like this: iqtree FcC_smatrix_nostops fas spp geneANDcodonpartitions txt mset GTR mrate I m TESTMERGE rclusterf alrt 1000 1000 pre IQTRE1 Therefore I was wondering if it actually make sense to search for a best-fit partitioning scheme without model selection? I might be here misunderstanding the partition scheme selection process. Thanks in advance for any clarification. Saying \u201cbest-fit partitioning scheme without model selection\u201d is a bit confusing, because finding best-fit partitioning scheme must include model selection. I would just simply call this using a particular user-selected model, as you noted above. Does this answer your question? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, thanks for your explanation and pointing out the new features in version 1.6. \"[...] finding best-fit partitioning scheme must include model selection.\" I'm obviously confused here. I was expecting that since the merged partitions can have the same best-fitting model of sequence evolution and yet not be merged together (e.g. subset 1 and 2 in section 5 in http://www.robertlanfear.com/partitionfinder/tutorial/ ) the benefit of partitioned analysis is that distinct values of model parameters can be assigned to distinct partitions. Therefore I thought that the partitions could be merged based on the similarity of their model parameters' values even in case that single model of evolution is considered. I will be thankful if you are eager to provide further explanations, however, I realize that this goes beyond specific IQ-TREE-related question. Best, Ales ", "Hi Ales, OK I see what you meant, that you just want to fix a model for every partition to speed up the process, where model parameters will be separately estimated for each partition. This is fine. The confusion is only the terminology: finding a best-fit partition scheme is also a model selection process, because a partitioning scheme is a model on its own. That\u2019s why the name \u201cpartition model\u201d. That\u2019s all I wanted to say. Cheers, Minh "]}, "-_Rh-j0iOjI": {"topic": "AU test: A taxon has no name", "initializeDate": "Jan 26, 2018, 12:43:45 PM", "timeStamp": "Jan 31, 2018, 10:30:17 AM", "content": ["Hello, I am trying to run an AU test in iq-tree, but I get an error: Tree 1ERROR: A taxon has no name. (line 6 column 45). I checked other resolved issues with the same error, but my tree file doesn't seem to suffer from the same problem as other users. The tree file loads into figtree fine, so I don't know what may be going on. I've also run the program on individual topologies from the input topology set separately, and they get the same error, but at a different column number. I have a feeling the problem may be due to too many parentheses, but any attempt at reducing them results in an incorrect topology. I've attached a log file, along with one of the topologies that triggers an error. Thank you for the help! ", "Hi Connor, I believe this was discussed in the forum before. Please search it. The problem is due to an outer-most parentheses pair. Removing it will resolve the problem. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <top.tre> <mafft-nexus-clean-75p_10.phylip.log> ", "Hello Minh, I have tried removing the outermost parentheses pair, but the tree topology changes and I get a new error \"Tree file must be ended with a semi-colon ';' (line 1 column 49)\". My outgroup contains two taxa, so the outer parentheses pair is necessary to enclose the entire tree. If I root the tree to where one of my outgroup taxa is the outgroup \"(out1,(out2,(....)))\" I still get the same error. Thanks for your help! Connor On Sat, Jan 27, 2018 at 6:43 AM, Bui Quang Minh minh...@univie.ac.at wrote: Hi Connor, I believe this was discussed in the forum before. Please search it. The problem is due to an outer-most parentheses pair. Removing it will resolve the problem. Cheers, Minh On 27 Jan 2018, at 4:43 am, Connor French < confr...@gmail.com > wrote: Hello, I am trying to run an AU test in iq-tree, but I get an error: Tree 1ERROR: A taxon has no name. (line 6 column 45). I checked other resolved issues with the same error, but my tree file doesn't seem to suffer from the same problem as other users. The tree file loads into figtree fine, so I don't know what may be going on. I've also run the program on individual topologies from the input topology set separately, and they get the same error, but at a different column number. I have a feeling the problem may be due to too many parentheses, but any attempt at reducing them results in an incorrect topology. I've attached a log file, along with one of the topologies that triggers an error. Thank you for the help! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com ", "Hi Connor, I had a look at your tree file again. There is indeed a double-brackets \u201c((\u2026))\u201d for the subtree ending at the reported position, which is not the outer-most bracket. So the error message: ERROR: A taxon has no name. (line 6 column 45) should have been something like ERROR: Redundant double-bracket \u2018((\u2026))\u2019 with closing bracket ending at line 6 column 45 We will change this for the next release to make error message more informative. Please find the corrected tree file attached. Cheers, Minh ", "Hello Minh, Thank you very much for working through this with me! No problems after the correction. Best, Connor "]}, "0MR7wxrQsVk": {"topic": "ModelFinder help", "initializeDate": "May 27, 2020, 10:49:58 AM", "timeStamp": "May 27, 2020, 4:32:31 PM", "content": ["Hi, I found the description of the ModelFinder results quite confusing. For example, the following one: Another example is for model TIM2 that has the 6-digit code 010232 . Thus, TIM2{4.39,5.30,12.1} means that A-C=A-T=4.39 (coded ), A-G=5.30 (coded ), C-T=12.1 (coded ) and C-G=G-T=1.0 (coded ). This is, in turn, equivalent to specifying GTR{4.39,5.30,4.39,1.0,12.1} According to the 6-digit model code, A-C=A-T is coded 0, not C-G=G-T (which are coded 2). Therefore, I am totally confused what the values in the result correspond to. ", "Hi Volodymyr, The codes simply specify how the six possible parameters should be grouped together. Any parameter with the same integer is set to be equal to other parameters which share that integer. Maybe it would help to look at the 'phyml commandline' column of this file: https://github.com/brettc/partitionfinder/blob/master/partfinder/models.csv It specifies the six-digit codes for a whole heap of models. One thing to note though, is that you should rarely if ever really need to use these codes. Simply running ModelFinder with the default settings will test all of the most commonly-used models for you. Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/218e70c9-ef3e-4d8f-9404-6b7572328fe1%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com "]}, "ETpjn-hiWVU": {"topic": "Does protein model Jones==JTT?", "initializeDate": "Nov 21, 2018, 11:40:07 PM", "timeStamp": "Dec 7, 2018, 9:39:52 AM", "content": ["Hi all, Is the Jones model in MrBayes identical to JTT model in IQ-TREE? Thanks in advance Best Dong ", "Hi Dong, I\u2019m not 100% sure, but it sounds like JTT model with the citation: Jones et al., 1992 ). See http://www.iqtree.org/doc/Substitution-Models#protein-models But please double check with MrBayes manual or MrBayes people (if not stated in the manual). Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Thank you for your reply. I noticed that JTT is included in \"-mset mrbayes\" parameter, instead of jones model. However, MrBayes only allows jones model, thus I replaced JTT with jones when use the results of ModelFinder for MrBayes. Best, Dong \u5728 2018\u5e7411\u670823\u65e5\u661f\u671f\u4e94 UTC+8\u4e0a\u534811:31:33\uff0cMinh Bui\u5199\u9053\uff1a "]}, "hqvxQErJPBo": {"topic": "IQ-TREE release 1.4.3", "initializeDate": "Jul 15, 2016, 4:40:08 AM", "timeStamp": "Jul 15, 2016, 4:40:08 AM", "content": ["July 15, 2016 Dear users, We are happy to announce version 1.4.3, which fixes various problems improving software stability. New features: * Better parameter estimates for I+G model. * More flexible mixture models for model testing with `-madd` option (requested by David Kerk). * The protein mixture model `CF4` of Wang et al. (2008) now includes Gamma rate heterogeneity by default. * Support invariable sites plus FreeRate [+I+R] model (requested by Lars Jermiin). * New option `--sequential` to read sequential phylip alignment file format. Bug fixes: * Failture too estimate too extreme GTR rate parameters (reported by Stephen Crotty). * Bug with likelihood scaling for constant sites under invariable site [+I] model (reported Remi Denise). * Crash with optimizing codon model parameters (reported by Xiaofan Zhou). * Redundant codon models for model selection (reported by Xiaofan Zhou). * Segfault caused by unaligned memory for partition model with binary data (reported by Marek L. Borowiec). * Crash with `-wbtl` option (reported by Teo). * Crash with `-mtree` for partition finding (reported by a web user). * A rare bug in NNI hill-climbing search. * A bug in printing .rate file via -wsr option (reported by Tim McInerney). * Several other minor issues. Best, IQ-TREE development team "]}, "yDNKlPDT6WA": {"topic": "Crash Iq-tree IQ-TREE multicore version 1.3.10 with random start tree", "initializeDate": "Nov 17, 2015, 11:58:10 PM", "timeStamp": "Dec 10, 2015, 10:01:55 AM", "content": ["When using a random starting tree in multicore v1.3.10, 40 out of 100 runs have crashed. I attached one of the logs (R_0.log) and the error that pumped out I pasted below. This is a data set partitioned by site using kmeans in partitionfinder2. I then used iqtree to select the best model for each partition. I did get a warning when selecting the best model for each partition \"WARNING: Estimated model parameters are at boundary that can cause numerical instability!\". I have attached the model selection log as well (opmod.log) since this was done in a separate analysis. I can send the dataset via email or send any other information you may need. This issue only seems to happen when using a random starting tree. Thanks for any help you can give Jesse \"iqtree-omp: /home/CIBIV/minh/Dropbox/iqtree-git/phylosupertreeplen.cpp:122: virtual double PartitionModelPlen::optimizeParameters(bool, bool, double, double): Assertion `cur_lh > tree_lh - 1.0 && \"individual model opt reduces LnL\"' failed. /var/spool/torque/mom_priv/jobs/ 16844582.moab.ufhpc.SC : line 17: 3074 Aborted iqtree-omp -s BOMBY_PROBE.phy -spp opmod.best_scheme.nex -pre R_0 -t RANDOM -nt 8\" ", "Dear Jesse, thanks for reporting the problem. It is possible for you to send me (via personal email) the alignment file as well as the best_scheme.nex file for debugging purpose? I think another user has similar problem with the recently introduced random starting tree option. Thus it will be prioritized in my agenda. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout > <R_0.log><opmod.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Jesse, I found that with -t RANDOM option, IQ-Tree first generates a completely random tree and then uses this random tree to estimate model parameters. But this distorts all the numerical estimation because the tree is random. In fact, for model parameter estimation one should use a reasonable tree, instead. I will think about a solution\u2026 if somebody gives me a hint, I will be grateful! Thus, for the moment I would not recommend to use -t RANDOM option. As an unrelated note, I noticed that IQ-Tree estimated the rate for the 1st partition as 0. In fact, your first partition contains only constant sites! Thus, it does not contribute any phylogenetic information. I don\u2019t know why PartitionFinder produced such a partition, but this is really weird. I recommend that you ask the author of PartitionFinder about this first, before any subsequent tree reconstruction. Cheers, Minh > On Nov 18, 2015, at 5:58 AM, jessebr...@gmail.com wrote: ", "Hi Minh Thanks for the information about the random tree. As far as a suggestion to fix this could you not use a reasonable tree to estimate model parameters like the same tree that is generated and used in the standard search but then start the treesearch from the random tree? Or will this bias the ending tree toward the tree you estimated the models on? Perhaps modify the standard search algorithm to start as normal but instead of generate 100 parsimony trees make it do 100 random trees, therefore allowing you to move around tree spaces but still use a reasonable tree to optimism model parameters. Also I already know the first partition has zero variation. I used a fairly new method to partition by site which uses the rate/entropy of the site to cluster sites into partitions by kmeans. Now the question is should i delete these site completely or will they have some affect on BL. These sites would would be present in the data set if i partitioned by any other method such as by loci or rcluster of loci. Given the way Iq-tree handles non variable sites will this partition have any affect on the resulting branch length or topology? Jesse You received this message because you are subscribed to a topic in the Google Groups \"IQTREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/yDNKlPDT6WA/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Jesse Breinholt Post Doctoral Associate Florida Museum of Natural History McGuire Center for Lepidoptera and Biodiversity University of Florida E-mail: jbrei...@flmnh.ufl.edu jessebr...@gmail.com ", "Hi Minh Thanks for the information about the random tree. As far as a suggestion to fix this could you not use a reasonable tree to estimate model parameters like the same tree that is generated and used in the standard search but then start the treesearch from the random tree? Or will this bias the ending tree toward the tree you estimated the models on? Perhaps modify the standard search algorithm to start as normal but instead of generating 100 parsimony trees make it do 100 random trees, therefore allowing you to move around tree spaces but still use a reasonable tree to optimism model parameters. Also I already know the first partition has zero variation. I used a fairly new method to partition by site which uses the rate/entropy of the site to cluster sites into partitions by kmeans. Now the question is should I delete partition completely or will they have some affect on branch lengths. These sites would would be present in the data set if I partitioned by any other method such as by loci or rcluster by loci. Given the way Iq-tree handles non variable sites will this partition have any affect on the resulting branch length or topology? ", "Dear Jesse, thanks for the suggestion. I just released version 1.3.11 that fixes this -t RANDOM issue accordingly. Cheers, Minh "]}, "R4itsNB4IoM": {"topic": "IQtree hanging on generating initial parsimony trees", "initializeDate": "May 29, 2020, 5:05:02 PM", "timeStamp": "May 29, 2020, 6:21:58 PM", "content": ["I'm using the command: iqtree -bb 1000 -alrt 1000 -abayes -numstop 500 -nt AUTO -g constraints.tre -m LG+G4 -s aligned.fasta I made the constraint tree in IQtree then manipulated it constraint tree in TreeGraph to pull out a few leaves that weren't in the alignment file, then I unrooted it in R. It is a multifurcating tree with no branch lengths or support values. IQtree is hanging (I left it over night when it will normally make the tree without a constraint tree in under an hour) on the \"generating 99 parsimony trees\" step. When I open the .parsetree file there is only one tree in it. If i use this first parsimony tree as a start tree, I get around this problem. Any ideas on what I'm doing wrong? ", "Nothing wrong here. This problem has been discussed several times in the forum. In short, pls use version 2. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/3fca34e4-9378-4c8e-8eb4-93b885198fb2%40googlegroups.com ", "Sorry thank you, I used the forum search function incorrectly. I switched to v2 and it's working now! On Friday, May 29, 2020 at 2:47:14 PM UTC-7, Minh Bui wrote: Nothing wrong here. This problem has been discussed several times in the forum. In short, pls use version 2. Minh On 30 May 2020, at 7:05 am, Ajna R < ajn...@gmail.com > wrote: I'm using the command: iqtree -bb 1000 -alrt 1000 -abayes -numstop 500 -nt AUTO -g constraints.tre -m LG+G4 -s aligned.fasta I made the constraint tree in IQtree then manipulated it constraint tree in TreeGraph to pull out a few leaves that weren't in the alignment file, then I unrooted it in R. It is a multifurcating tree with no branch lengths or support values. IQtree is hanging (I left it over night when it will normally make the tree without a constraint tree in under an hour) on the \"generating 99 parsimony trees\" step. When I open the .parsetree file there is only one tree in it. If i use this first parsimony tree as a start tree, I get around this problem. Any ideas on what I'm doing wrong? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "0Wow3f0cExI": {"topic": "ERROR: Numerical underflow (lh-branch)", "initializeDate": "Jun 25, 2019, 9:40:49 AM", "timeStamp": "Jun 25, 2019, 11:40:33 AM", "content": ["Hello, I'm try to use IQTREE web server for evaluating the best substitution model and partition scheme. It was returned with an error message. This job STOPPED because there was a problem! WARNING: Too many iterations in tqli WARNING: Too many iterations in tqli WARNING: Too many iterations in tqli ERROR: Numerical underflow (lh-branch). Run again with the safe likelihood kernel via `-safe` option I couldn't figure out what the problem is. Thanks for your help. Best regards, Chih-Wei The following is the running log IQ-TREE multicore version 1.6.11 for Linux 64-bit built Jun 6 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: kronig (SSE4.2, 31 GB RAM) Command: ../../iqtree -s 20190625_align_COIwithOG.fas -st DNA -sp COI_partition.txt -pre 20190625_align_COIwithOG.fas -m TESTONLYNEWMERGE Seed: 351943 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Tue Jun 25 15:39:17 2019 Kernel: SSE2 - 1 threads (24 CPU cores detected) HINT: Use -nt option to specify number of threads because your CPU has 24 cores! HINT: -nt AUTO will automatically determine the best number of threads to use. Reading partition model file COI_partition.txt ... Reading alignment file 20190625_align_COIwithOG.fas ... Fasta format detected Alignment most likely contains DNA/RNA sequences Alignment has 150 sequences with 575 columns, 277 distinct patterns 253 parsimony-informative, 24 singleton sites, 298 constant sites Gap/Ambiguity Composition p-value 1 B5 0.00% passed 54.90% 2 D3 0.00% passed 54.90% 3 VAL_00_Ea_Kar 0.00% passed 36.91% 4 VAR4 0.00% passed 54.17% 5 VAK_00_Xuyen_Moc 0.00% passed 62.54% . 147 OG_BRAI02 0.00% passed 83.99% 148 OG_BRNS01 0.00% failed 0.55% 149 ZY4 0.00% passed 13.50% 150 OG_J 0.00% failed 3.98% **** TOTAL 0.00% 2 sequences failed composition chi2 test (p-value<5%; df=3) Partition file is not in NEXUS format, assuming RAxML-style partition file... Subset Type Seqs Sites Infor Invar Model Name 1 DNA 150 192 191 0 GTR part1 2 DNA 150 192 48 133 GTR part2 3 DNA 150 191 14 165 GTR part3 Degree of missing data: 0.000 Info: multi-threading strategy over partitions NOTE: D3 is identical to B5 but kept for subsequent analysis NOTE: YD1 is identical to R50 but kept for subsequent analysis NOTE: YD7 is identical to YD2 but kept for subsequent analysis NOTE: YD8 is identical to YD4 but kept for subsequent analysis NOTE: XI3XI4XI6XI7XI8 is identical to XI0XI2 but kept for subsequent analysis NOTE: R31 is identical to R30 but kept for subsequent analysis NOTE: T71 is identical to T70 but kept for subsequent analysis NOTE: X61X62X63X64 is identical to X50-1-2-3-4-5-7 but kept for subsequent analysis NOTE: T30 is identical to T21 but kept for subsequent analysis NOTE: XA3567 is identical to XA1 but kept for subsequent analysis NOTE: VAY0 is identical to S51 but kept for subsequent analysis NOTE: VAO1 is identical to VAG_00_Chu_Prong but kept for subsequent analysis NOTE: XX6 is identical to XX0123457 but kept for subsequent analysis NOTE: T61 is identical to T60 but kept for subsequent analysis NOTE: X24 is identical to X21 but kept for subsequent analysis NOTE: XV0 is identical to X23 but kept for subsequent analysis NOTE: XH0XH2XH6789 is identical to XG1XG2XG8 but kept for subsequent analysis NOTE: XG4XG5 is identical to X22 but kept for subsequent analysis NOTE: XH4 is identical to XG7XG9 but kept for subsequent analysis NOTE: XV6 is identical to XG6 but kept for subsequent analysis NOTE: ZF9 is identical to ZE8 but kept for subsequent analysis NOTE: VAU1 is identical to T41 but kept for subsequent analysis NOTE: 16 identical sequences (see below) will be ignored for subsequent analysis NOTE: YD3 (identical to R50) is ignored but added at the end NOTE: YE4 (identical to R50) is ignored but added at the end NOTE: YE1 (identical to YD2) is ignored but added at the end NOTE: YE3 (identical to YD2) is ignored but added at the end NOTE: T31 (identical to T21) is ignored but added at the end NOTE: XW1XW3 (identical to XA1) is ignored but added at the end NOTE: VBA4 (identical to S51) is ignored but added at the end NOTE: T81 (identical to T60) is ignored but added at the end NOTE: X25 (identical to X21) is ignored but added at the end NOTE: XG0XG3 (identical to X21) is ignored but added at the end NOTE: XH1XH5 (identical to X21) is ignored but added at the end NOTE: XV3 (identical to X21) is ignored but added at the end NOTE: XV7 (identical to X21) is ignored but added at the end NOTE: XV2XV9 (identical to X23) is ignored but added at the end NOTE: XV5 (identical to XG1XG2XG8) is ignored but added at the end NOTE: XV1 (identical to XG7XG9) is ignored but added at the end Concatenated alignment was printed to 20190625_align_COIwithOG.fas.uniqueseq.phy For your convenience alignment with unique sequences printed to 20190625_align_COIwithOG.fas.uniqueseq.phy Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.018 seconds NOTE: ModelFinder requires 12 MB RAM! Testing GTR+F+G on supermatrix... GTR+F+G4 / LnL: -9241.935 / df: 274 / AIC: 19031.870 / AICc: 19534.204 / BIC: 20224.968 Selecting individual models for 3 charsets using BIC... No. Model Score Charset 1 TIM2+F+ASC+G4 14954.630 part1 WARNING: Too many iterations in tqli WARNING: Too many iterations in tqli WARNING: Too many iterations in tqli ERROR: Numerical underflow (lh-branch). Run again with the safe likelihood kernel via `-safe` option ", "I've try again. No error message. Thanks! Chih-Wei Huang\u65bc 2019\u5e746\u670825\u65e5\u661f\u671f\u4e8c UTC+8\u4e0b\u53489\u664240\u520649\u79d2\u5beb\u9053\uff1a ", "Hi Chih-Wei, Just as a head up: I saw that part1 has no invariant sites. This might or might not be problematic, but you should check the data carefully. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0c974298-dfe2-4174-9b8a-7a4fdab60855%40googlegroups.com For more options, visit https://groups.google.com/d/optout "]}, "4qx4ZjOKrjA": {"topic": "WARNING: bootstrap analysis did not converge", "initializeDate": "Jan 9, 2020, 4:40:19 AM", "timeStamp": "Jan 10, 2020, 8:39:36 AM", "content": ["Hello, I'm running in: IQ-TREE 1.6.10 built Feb 19 2019, platform Windows Command: iqtree -s 0835_070120trematMSA_E_INS_i.fas -nt AUTO -bb 1000 -alrt 2000 -nm 6000 -mset JTT,LG,WAG,Blosum62,VT,Dayhoff -mfreq F -mrate R -bnni Seed: 725790 (Using SPRNG - Scalable Parallel Random Number Generator) Alignment has 243 sequences with 579 columns, 566 parsimony-informative. WARNING in the test of tree branches by SH-like aLRT: Testing tree branches by SH-like aLRT with 2000 replicates... 7.379 sec. WARNING: bootstrap analysis did not converge. You should rerun with higher number of iterations (-nm option) Creating bootstrap support values... Split supports printed to NEXUS file 0835_070120trematMSA_E_INS_i.fas.splits.nex Total tree length: 147.352 I read in a previous post that when the -bnni option is apply we should not pay attention to this warning but, if I understood well, the -bnni is for UFboot not for the SH-like aLRT test. Therefore I should run with even higher -nm? can you suggest me a number? Thank you ", "Hi there, This is indeed associated with -bnni option: you are doing both SH-alRT and UFBoot. You may notice that this warning was printed after the SH-aLRT test was done, so it has nothing to do with this test. So the short answer is: you can ignore the warning. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2ef9d4f7-ba01-4b79-96de-5e960207aaba%40googlegroups.com "]}, "IO7Hd4i-7D4": {"topic": "My job is succes but there's not a pdf/svg file", "initializeDate": "Apr 21, 2020, 5:29:11 PM", "timeStamp": "Apr 22, 2020, 3:23:17 PM", "content": ["When I downloaded the zip file with the results I see there's not a pdf/svg file, even it say the job is succes. I tried to generate these files downloding and installing ete-view on my PC but I couldn't be successful. Could you support me to get these files?, please, Many thanks in advance! ", "Hi Daniel, This seems to be an issue with the server, which is in the process of being fixed. For now you will need to generate the plots yourself. You could always use something like FigTree (or any tree viewer) to visualise the trees if you can't get ETE to work for you. More discussion of the same issue is here: https://groups.google.com/d/msgid/iqtree/EE61F9F5-BE83-4E41-B6DD-3501D0455FF5%40univie.ac.at Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/46e72614-5fea-4a9e-9d57-a52be9534c63%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Hi Rob Thank you so much for the information. It helped me a lot. I was able to generate the files with FigTree. Daniel To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmqcQAc21cFLS0ufRYQTY7-XAre-Dk8axK94UJHcAodc_Q%40mail.gmail.com "]}, "9AbMScqjwxo": {"topic": "Questions about adding support values to an existing tree", "initializeDate": "Aug 22, 2018, 10:33:38 AM", "timeStamp": "Aug 30, 2018, 12:13:18 PM", "content": ["Hi Minh, I have a few small, but related questions: If I have a set of trees and I have a 'reference tree', I can add the percent occurrences of each split in the set of trees to the according split in the 'reference tree' using: iqtree -sup reference_tree set_of_trees Now my questions: (a) is it possible to use a splits file to do the same? In the case that I run an UFboot analysis the splits file is written automatically containing all information I need to add the support of the set of UFboot trees to another reference tree. (Otherwise I had to run iqtree again just to add the '-wbt' parameter. (b) Is there a way to tell 'iqtree -sup reference_tree set_of_tree' to drop/discard any support values which may already be present in the reference tree? (c) The manual says that '-scale' and '-prec' determine the behavior in the '-sup' option. Is there a way to influence scale and precision in the splits file created after an UFboot run? Best wishes, Heiko ", "Hi Heiko, On 23 Aug 2018, at 12:33 am, Heiko < heiko....@univie.ac.at > wrote: Hi Minh, I have a few small, but related questions: If I have a set of trees and I have a 'reference tree', I can add the percent occurrences of each split in the set of trees to the according split in the 'reference tree' using: iqtree -sup reference_tree set_of_trees Now my questions: (a) is it possible to use a splits file to do the same? In the case that I run an UFboot analysis the splits file is written automatically containing all information I need to add the support of the set of UFboot trees to another reference tree. (Otherwise I had to run iqtree again just to add the '-wbt' parameter. Yes, that\u2019s already possible. This option supports both trees file and splits file. You can just specify .splits.nex file instead of set_of_trees, e.g.: iqtree -sup reference_tree FILE.splits.nex IQ-TREE will automatically detect the file format. If the document does not say this, can you pls help update it. Thanks! (b) Is there a way to tell 'iqtree -sup reference_tree set_of_tree' to drop/discard any support values which may already be present in the reference tree? There is no such option. Support values will be appended to the existing node values, separated by a slash. (c) The manual says that '-scale' and '-prec' determine the behavior in the '-sup' option. Is there a way to influence scale and precision in the splits file created after an UFboot run? That does not seem possible (i.e. I just checked an example run and these two options do not influence .splits.nex file). Cheers Minh Best wishes, Heiko You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, > On 23 Aug 2018, at 03:51, Minh Bui < minh...@univie.ac.at > wrote: >> On 23 Aug 2018, at 12:33 am, Heiko < heiko....@univie.ac.at > wrote: >> I have a few small, but related questions: >> If I have a set of trees and I have a 'reference tree', I can add the percent occurrences of each split in the set of trees to the according split in the 'reference tree' using: >> iqtree -sup reference_tree set_of_trees >> Now my questions: >> (a) is it possible to use a splits file to do the same? In the case that I run an UFboot analysis the splits file is written automatically containing all information I need to add the support of the set of UFboot trees to another reference tree. (Otherwise I had to run iqtree again just to add the '-wbt' parameter. > Yes, that\u2019s already possible. This option supports both trees file and splits file. You can just specify .splits.nex file instead of set_of_trees, e.g.: > iqtree -sup reference_tree FILE.splits.nex > IQ-TREE will automatically detect the file format. Nice to know, but\u2026 This only works if you do not also specify an alignment with \u201c-s\u201d, e.g. to estimate branch lengths and add support values. In that case you get the error message ERROR: Tree file does not start with an opening-bracket '(' (line 1 column 1) And the program stops (no other complaints). If you only do -sup then it works. > If the document does not say this, can you pls help update it. Thanks! I will update the documentation. >> (b) Is there a way to tell 'iqtree -sup reference_tree set_of_tree' to drop/discard any support values which may already be present in the reference tree? > There is no such option. Support values will be appended to the existing node values, separated by a slash. Then this would be a \u201cnice to have\u201d because removing existing support values from trees with hundreds to thousands of sequences might be a big obstacle for several users. >> (c) The manual says that '-scale' and '-prec' determine the behavior in the '-sup' option. Is there a way to influence scale and precision in the splits file created after an UFboot run? > That does not seem possible (i.e. I just checked an example run and these two options do not influence .splits.nex file). Then it would be nice to if the precision reported in the splits file would be at least 1 digit to keep the precision you get from 1000-10000 sampled UFboot trees. What do you think? Best wishes, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Hi Heiko, -sup option works without alignment. OK this can be done in future version 1.7. Version 1.6 will only include bug fixes and no new features. Thanks Minh "]}, "8LxiMNeJFNY": {"topic": "BUG", "initializeDate": "Jun 11, 2018, 3:03:46 AM", "timeStamp": "Jun 12, 2018, 4:38:38 AM", "content": ["Hi, I tried to make an iq-tree for a supermatrix in the follwoing way and it crashes with an error message after some time: IQ-TREE multicore version 1.6.3 for Linux 64-bit built Mar 22 2018 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: compute-0-3.local (AVX, 504 GB RAM) Command: /share/scientific_bin/iqtree/1.6.3/bin/iqtree -nt 20 -s /home/dlieberz/supermatrix_iq/aa_95/FcC_supermatrix_aa_95.fas -spp /home/dlieberz/supermatrix_iq/aa_95/FcC_supermatrix_partition_aa_95.nex -st AA -pre supermatrix_aa_gene_tree_95_1 -m MFP -mset WAG,LG,DCMut,JTT,JTTDCMut -madd LG4X,LG4M -safe Seed: 193248 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Fri Jun 8 23:43:27 2018 Kernel: Safe AVX - 20 threads (48 CPU cores detected) Model LG4X is alias for MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4 Model LG4M is alias for MIX{LG4M1,LG4M2,LG4M3,LG4M4}*G4 935 LG+R6 38790.331 {name.aa} 31h:40m:46s (38h:53m:47s left) ERROR: ratefree.cpp:525: double RateFree::optimizeWithEM(): Assertion `score > old_score-0.1' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: supermatrix_aa_gene_tree_95_1.log ERROR: *** Alignment files (if possible) Thank you for your help Doria ", "Gesendet von Mail f\u00fcr Windows 10 You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Sorry, please ignore my previous empty email. I clicked the wrong button :) To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com ", "Hi Doria, This line caught my attention: 935 LG+R6 38790.331 {name.aa} 31h:40m:46s (38h:53m:47s left) So there is a partition called \u201c{name.aa}\u201d. So can you pls rename such partitions and rerun the analysis. If the issue persists pls send me all data files, log file and .model.gz file for debugging purpose. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com ", "Hi Minh, {name.aa} was just a place holder for the actual name. Sorry for the confusion. The actual line looks like this: 935 LG+R6 38790.331 EOG761PJ8.linsi.aa 31h:40m:46s (38h:53m:47s left) best Doria "]}, "r_tYYPbOVPI": {"topic": "How to make phylogenetic tree using no-group option in IQ-TREE?", "initializeDate": "Jul 25, 2017, 10:41:59 PM", "timeStamp": "Jul 26, 2017, 5:29:21 AM", "content": ["Hello. I have a question. I would like to make phylogenetic tree in IQ-TREE. This tool is -o option (Default : first taxon in alignment) but I want to use no-outgroup. so I just used this command line. # iqtree-omp -s MSA_protein.faa -bb 1000 -nt 10 -m TEST (This is no -o option) Any answer please. Thanks. ", "Dear Jeonghan Seo, (I guess that is the correct name) thank you for your interest in IQ-TREE. We quickly discussed your question and are not quite sure what it is about. Just some information on the \u2018-o\u2019 option, that might be of help. IQ-TREE always reconstructs unrooted trees, so you do not need an outgroup. Just in a few cases the user might know that a certain sequence in the alignment is an outgroup and (s)he wants to have the output tree rooted at the branch to this sequence, then (s)he would use the \u2018-o\u2019 option to tell IQ-TREE to start at this branch to output the tree. The tree reconstructed is still unrooted, there is just a starting point added which might be meaningful for the user. Since the tree output has to start somewhere in that tree, IQ-TREE by default starts at the first sequence in the alignment. However, that just affects the order of output, but not at all the reconstruction of the tree. Whatever point in the tree the program would start the output at, the tree topology is still the same. Using a tree-browser like FigTree one can always visualise the same unrooted tree structure. There is no need to use the \u2018-o\u2019 option at all - it is just an option to incorporate prior knowledge in advance for viewing, which could as well be done in a tree viewer while visualising the tree, if a rooted visualisation does make any sense at all. I hope that helps to answer you question. Best regards, Heiko Schmidt You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "Cx-Tb1kAbcg": {"topic": "Doubts about .log files and other", "initializeDate": "Oct 5, 2020, 5:53:02 PM", "timeStamp": "Oct 10, 2020, 7:41:12 PM", "content": ["Hello. I am a new IQ-tree user. I have run some analyses with this great software and I have a few doubts. In the .log file (one of the output files) there is table like the following: Subset Type Seqs Sites Infor Invar Model Name DNA 1200 134 1003 TVM+F+R2 part1 DNA 900 863 TIM+F+I part2 DNA 800 638 TVM+F+R2 part3 1350 101 1204 K3Pu+F+G4 part4 1000 100 848 K3Pu+F+G4 part5 DNA 600 111 427 GTR+F+I+G4 Part6 In this table, I have noticed that if the partition model was K3Pu, the program does not indicate the data type of those partition (e.g. DNA, AA, BIN, etc). So I want to know if IQ-tree analyze these partitions as DNA data, and therefore, if I should ignore this information of the .log file. Also, I don't understand why the number of total sites in the alignment is greater than the number of informative sites plus invariants sites . On the other hand, if my dataset includes less than 10 loci, do you recommend that I perform the UFBoot analyzes with the partition-resampling strategies GENE and / or GENESITE? And should I also apply bnni preventively (although I do not know if there are severe violations of the model)? Thank you Best regards ", "Hi there, K3Pu is a DNA model. I don\u2019t know why the log file does not indicate that, but you can look at .iqtree file when the run finished. The datatype will for sure be mentioned there. Also, I don't understand why the number of total sites in the alignment is greater than the number of informative sites plus invariants sites . Because there is the 3rd category of sites called singleton, that are neither parsimony-informative nor invariant. If you look at the log file again, you may see something like this: Alignment has 17 sequences with 1998 columns, 1152 distinct patterns 1009 parsimony-informative, 303 singleton sites, 686 constant sites (note that constant sites == invariant sites). Singleton is a site that has the same character for n-1 sequences and just one sequence shows a different character, some sequences may show gaps/unknown characters. For example, a site with ATA-AAA- is a singleton (A in seq1, T in seq2, A in seq3, - in seq4, etc.). On the other hand, if my dataset includes less than 10 loci, do you recommend that I perform the UFBoot analyzes with the partition-resampling strategies GENE and / or GENESITE? And should I also apply bnni preventively (although I do not know if there are severe violations of the model)? Good question, I don\u2019t have an answer. But I lean towards not using GENE / GENESITE resamplings for such small number of partitions. You can analyse with and without -bnni and compare the results. Cheers Minh Thank you Best regards You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/13e66db6-fa48-4914-8ab8-d2020c8a9aa1o%40googlegroups.com ", "Thank you very much for your quick response. I ran analyses with the same seed, with and without bnni. The supports of some branches are higher in the analysis without bnni. What would be the appropriate criterion for choosing between the two analyzes (bnni vs. without bnni)? If my dataset contains 5-10 loci, could I calculate the gene and site concordance factor? Could be appropriate? Thank you again! Cheers Hi there, To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Elsa, On 8 Oct 2020, at 8:35 am, Elsa < folga...@gmail.com > wrote: Thank you very much for your quick response. I ran analyses with the same seed, with and without bnni. The supports of some branches are higher in the analysis without bnni. What would be the appropriate criterion for choosing between the two analyzes (bnni vs. without bnni)? To be on the safe side, I\u2019d use the supports from using -bnni option. If my dataset contains 5-10 loci, could I calculate the gene and site concordance factor? Could be appropriate? Yes for site concondance factor. But No/Yes (I\u2019d say rather No) for gene concordance factor: if you have just 10 genes, the gCF values will be quite discrete and not smooth between 0% and 100%. Cheers Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1ca41c3c-ccc7-4c7e-8449-1bfdf4c9a043o%40googlegroups.com "]}, "J0IO6GLnyyE": {"topic": "revPoMo and seqs/species (missing data)", "initializeDate": "Apr 3, 2019, 9:47:51 AM", "timeStamp": "Apr 4, 2019, 10:13:25 AM", "content": ["Hi, I am considering using revPoMo for species-tree inference on a set of closely related species, but after reading the paper/manual still have a couple questions before I start: 1. I see that the method will likely perform well (relative to others) at low theta(s) (perhaps < 0.0025) and low mean gene-tree lenght (=low mutation rate). How would you see if your data is likely to fit this? by estimating the thetas per gene per \"species\"? because my overall thetas (for each gene, considering all \"species\" - 25 or 18 depending on the delimitation scheme) are much larger (min=0.00898; max=0.058)... but maybe values /gene/species are lower... 2. it seems that the method NEEDS at least 2 sequences per gene per \"species\". Is this correct? no chance of missing data in any gene at all? 3. regarding the virtual pop size N. I see it is allowed to vary between 2 and 19 (default 7 and one can adjust according to n individuals in the dataset). Is it correct then to think one should have an homogeneous dataset, i.e., with a similar number of individuals per \"species\", so that all can be properly modelled by the given N? If I have a huge variation (min=0; max > 20), the best thing is to resample to a similar nr (say 5-8), when possible, to analyse with this method, right? 4. is the output tree supposed to be rooted or unrooted? many thanks in advance, sara ", "Hi Sara, thanks for your interest in PoMo. I try to address your questions below! Sara Rocha < spr...@gmail.com > writes: > Hi, > I am considering using revPoMo for species-tree inference on a set of > closely related species, but after reading the paper/manual still have a > couple questions before I start: > 1. I see that the method will likely perform well (relative to others) at > low theta(s) (perhaps < 0.0025) and low mean gene-tree lenght (=low > mutation rate). > How would you see if your data is likely to fit this? by estimating the > thetas per gene per \"species\"? > because my overall thetas (for each gene, considering all \"species\" - 25 or > 18 depending on the delimitation scheme) are much larger (min=0.00898; > max=0.058)... but maybe values /gene/species are lower... You are right. The lower theta, the better is the approximation of disallowing mutations while a polymorphism is present at a specific site in a specific species. However, in a recent study [1], we address the question of whether higher theta values lead to larger inference errors, and find that error is not affected up to a value of theta=0.1 (that's the highest value we tried). In conclusion, I think that your level of heterozygosity is well within the scope of PoMo. > 2. it seems that the method NEEDS at least 2 sequences per gene per > \"species\". Is this correct? no chance of missing data in any gene at all? The method needs more sequences per leaf of the tree. Mostly, those leaves are different species, and so it does not need two sequences per gene. Neither does it require two sequences for all of your species (see below). However, the more sequences you have per species, the better. > 3. regarding the virtual pop size N. I see it is allowed to vary between 2 > and 19 (default 7 and one can adjust according to n individuals in the > dataset). Is it correct then to think one should have an homogeneous > dataset, i.e., with a similar number of individuals per \"species\", so that > all can be properly modelled by the given N? > If I have a huge variation (min=0; max > 20), the best thing is to resample > to a similar nr (say 5-8), when possible, to analyse with this method, > right? The virtual population size defines the bin size of the discretization of the allele frequencies. It is advantageous, if N is close to your actual number of sequences per leaf of the tree, but that's not a requirement. It is perfectly fine, if you do not have polymorphic data for some of your species, and have, e.g., twenty samples for some other species. The default value of N is 9, and I would leave it like that. If you want, you can set it to the value closest to the average number of sequences per leaf (which is output by IQ-TREE+PoMo close to the beginning of the screen output). IQ-TREE+PoMo also takes care of the resampling for you, it uses a more sophisticated way to include all the information present in your alignment. > 4. is the output tree supposed to be rooted or unrooted? The output is unrooted, since PoMo is reversible and no information about the root is gathered throughout inference. To get information about the root, you may include an outgroup into your analysis, if you wish! > many thanks in advance, > sara You are welcome, I hope that I could address all of your concerns. Dominik [1] Schrempf, D., Minh, B. Q., Haeseler, A. v., & Kosiol, C. (2019). Polymorphism-aware species trees with advanced mutation models, bootstrap, and rate heterogeneity. Molecular Biology and Evolution, (), . http://dx.doi.org/10.1093/molbev/msz043 ", "Great, a couple additional questions bellow, sorry :S On 4 Apr 2019, 09:19 +0200, Dominik Schrempf < dominik....@gmail.com >, wrote: Hi Sara, thanks for your interest in PoMo. I try to address your questions below! Sara Rocha < spr...@gmail.com > writes: Hi, I am considering using revPoMo for species-tree inference on a set of closely related species, but after reading the paper/manual still have a couple questions before I start: 1. I see that the method will likely perform well (relative to others) at low theta(s) (perhaps < 0.0025) and low mean gene-tree lenght (=low mutation rate). How would you see if your data is likely to fit this? by estimating the thetas per gene per \"species\"? because my overall thetas (for each gene, considering all \"species\" - 25 or 18 depending on the delimitation scheme) are much larger (min=0.00898; max=0.058)... but maybe values /gene/species are lower... You are right. The lower theta, the better is the approximation of disallowing mutations while a polymorphism is present at a specific site in a specific species. However, in a recent study [1], we address the question of whether higher theta values lead to larger inference errors, and find that error is not affected up to a value of theta=0.1 (that's the highest value we tried). In conclusion, I think that your level of heterozygosity is well within the scope of PoMo. Great, will have a look at the paper, thanks! 2. it seems that the method NEEDS at least 2 sequences per gene per \"species\". Is this correct? no chance of missing data in any gene at all? The method needs more sequences per leaf of the tree. Mostly, those leaves are different species, and so it does not need two sequences per gene. Neither does it require two sequences for all of your species (see below). However, the more sequences you have per species, the better. ok, so, just to be clear, I do can have missing data (= genes for which there are no representatives at some species?) such as in the data matrix attached for example (where nrs are the nr of sequences, lines are loci, columns are \"species\") missing data in yellow asking because I read in a thesis (still unpublished): \" I considered only conditions with more than one individual per species, since revPoMo failed to run with only one.\" IQ-TREE PoMo 1.4.3 -pomo with the GTR+rP+F model error of the thesis or behaviour different in current version? thanks! 3. regarding the virtual pop size N. I see it is allowed to vary between 2 and 19 (default 7 and one can adjust according to n individuals in the dataset). Is it correct then to think one should have an homogeneous dataset, i.e., with a similar number of individuals per \"species\", so that all can be properly modelled by the given N? If I have a huge variation (min=0; max > 20), the best thing is to resample to a similar nr (say 5-8), when possible, to analyse with this method, right? The virtual population size defines the bin size of the discretization of the allele frequencies. It is advantageous, if N is close to your actual number of sequences per leaf of the tree, but that's not a requirement. It is perfectly fine, if you do not have polymorphic data for some of your species, and have, e.g., twenty samples for some other species. The default value of N is 9, and I would leave it like that. If you want, you can set it to the value closest to the average number of sequences per leaf (which is output by IQ-TREE+PoMo close to the beginning of the screen output). IQ-TREE+PoMo also takes care of the resampling for you, it uses a more sophisticated way to include all the information present in your alignment. ok! one related thing\u2026 one should use all the sequences one has and not reduce the dataset to haplotypes, right?? so theta is not biased, etc... [cause in GT based inferences datasets of \"haplotypes\" are often the way to go\u2026 but not here I would say, right?] 4. is the output tree supposed to be rooted or unrooted? The output is unrooted, since PoMo is reversible and no information about the root is gathered throughout inference. To get information about the root, you may include an outgroup into your analysis, if you wish! as I though, thanks! many thanks in advance, sara You are welcome, I hope that I could address all of your concerns. Dominik [1] Schrempf, D., Minh, B. Q., Haeseler, A. v., & Kosiol, C. (2019). Polymorphism-aware species trees with advanced mutation models, bootstrap, and rate heterogeneity. Molecular Biology and Evolution, (), . http://dx.doi.org/10.1093/molbev/msz043 You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi, I am happy that I could address most of your questions! Below are additional comments! Yes, just set the counts to zero. A site without counts (i.e., 0A 0C 0G and 0T) is handled in the same way as unknown nucleotides (N) in nucleotide alignments. > asking because I read in a thesis (still unpublished): \"I considered only > conditions with more than one individual per species, since revPoMo failed to > run with only one.\" > [IQ-TREE PoMo 1.4.3-pomo with the GTR+rP+F model] > error of the thesis or behaviour different in current version? thanks! Hm, PoMo should work with data, where some species only contain information of one individual. If a considerable amount of species in your alignment only has one individual, IQ-TREE+PoMo prints a warning. If all species have only one individual, it returns an error. In this case, it is better to use a standard substitution model. Please make sure, to use a recent version of IQ-TREE! Please contact me, if you have trouble, most likely we can provide a fix. Yes, I would use the information of both haplotypes in an individual, if available. E.g., an individual is heterozygous for A/G at a position -> increase the count of A and G at this position. The conversion scripts that we provide do this (if you provide IUPAC codes, e.g., an R for A/G in the alignment). Best, Dominik ", "did not explained myself very well, sorry. my question on the \"haplotypes\" was if sequences within a \"species\" a) were best reduced to only \"unique\" haplotypes [common practice at estimating Its of course] or b) one should use ALL sequences available (our data is phased) if I understood well how the methods works b) should be the proper way to do it, right? thanks for all the info! I will for sure try it and let u know if it worked. best, sara Sara Rocha Post-Doc Researcher Phylogenomics Group University of Vigo (Spain) http://darwin.uvigo.es/sara-rocha/ ", "Oh, yes, you should use all the information, because the actual nucleotide counts matter! Dominik "]}, "9EYYrZw7If8": {"topic": "difference between -fast and standard search", "initializeDate": "Nov 10, 2019, 12:43:20 PM", "timeStamp": "Nov 10, 2019, 8:35:25 PM", "content": ["Hi, Can someone please explain what the difference is between running iqtree with default parameters, compared to running it with the -fast option? I see that there is a difference in the number of type of starting trees and a difference in the log likelihood epsilon for estimating final parameters, but if I compare a \"fast\" analysis with one where I set the number of initial parsimony trees to 2 or 3, the runtime is different by an order of magnitude. Are there any other differences? thanks! -Pascal ", "Hi Pascal, -fast option is equivalent to: -ninit 2 -n 2 -me 0.05 That means, iqtree will construct 2 starting trees (MP + BIONJ; which are then optimised with NNI), and set the likelihood epsilon to 0.05 (insead of the default 0.01). I don\u2019t know which command line you used to compare. But perhaps if you don\u2019t specify \"-n 2\u201d, then iqtree will still do thorough tree seach from 2 starting trees. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c12c40ea-23cc-40a5-8054-c1e7ac0ba8dd%40googlegroups.com ", "Great, thanks for this. On Sunday, November 10, 2019 at 6:37:49 PM UTC-5, Minh Bui wrote: Hi Pascal, -fast option is equivalent to: -ninit 2 -n 2 -me 0.05 That means, iqtree will construct 2 starting trees (MP + BIONJ; which are then optimised with NNI), and set the likelihood epsilon to 0.05 (insead of the default 0.01). I don\u2019t know which command line you used to compare. But perhaps if you don\u2019t specify \"-n 2\u201d, then iqtree will still do thorough tree seach from 2 starting trees. Cheers, Minh On 11 Nov 2019, at 4:43 am, Pascal Title < pasca...@gmail.com > wrote: Hi, Can someone please explain what the difference is between running iqtree with default parameters, compared to running it with the -fast option? I see that there is a difference in the number of type of starting trees and a difference in the log likelihood epsilon for estimating final parameters, but if I compare a \"fast\" analysis with one where I set the number of initial parsimony trees to 2 or 3, the runtime is different by an order of magnitude. Are there any other differences? thanks! -Pascal You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "w7kaH0QgCSg": {"topic": "IQTree_Crashes: Two_DATASETS_TWO_ERRORS", "initializeDate": "May 17, 2016, 11:30:28 AM", "timeStamp": "May 19, 2016, 5:53:11 AM", "content": ["Dear Devs@IQTree I am trying to run I QTREE_v_1.4.2 on two datasets of 1421 Seq and 118 Sequences . Both are the Multiple Sequence Alignment files. IQtree crashes in both cases but with different errors. IQtree_1421: Command: iqtree-omp -st AA -nt 16 -wbtl -b 1000 -abayes -con -m TESTNEW -madd C20,C60,EX2,EX3,EH0,UL2,UL3,EX_EHO,LG4M,LG4X -s MSA_118.phy Error: ERROR: Not enough memory, allocation of 49476787216 bytes failed (bad_alloc) (For details checkout the attached Log File_ outStd_1421) IQtree_118: Command: iqtree-omp -st AA -nt 16 -wbtl -b 1000 -abayes -con -m TESTNEW -madd C20,C60,EX2,EX3,EH0,UL2,UL3,EX_EHO,LG4M,LG4X -s MSA_118.phy Error: ERROR: Invalid model name EH0. (Log File: outStd_118) Why does the first one throws a memory allocation (RAM) error, when I have enough space in my cluster's RAM? Why does the error of Invalid model name does not appear in IQTree1421? ", "Hi Tarun, On May 17, 2016, at 5:30 PM, Tarun JaiRaj Narwani < tjrna...@gmail.com > wrote: Dear Devs@IQTree I am trying to run I QTREE_v_1.4.2 on two datasets of 1421 Seq and 118 Sequences . Both are the Multiple Sequence Alignment files. IQtree crashes in both cases but with different errors. IQtree_1421: Command: iqtree-omp -st AA -nt 16 -wbtl -b 1000 -abayes -con -m TESTNEW -madd C20,C60,EX2,EX3,EH0,UL2,UL3,EX_EHO,LG4M,LG4X -s MSA_118.phy Error: ERROR: Not enough memory, allocation of 49476787216 bytes failed (bad_alloc) (For details checkout the attached Log File_ outStd_1421) the error message says that IQ-TREE requires ~49GB, whereas you computer has only ~31 GB as reported at the beginning of the run: Host: r1i0n4 (AVX, 31 GB RAM) For your more information, this is the RAM required for the C60 model. If you don\u2019t have computer with that much memory, remove C60 from the list. Otherwise (if you have another high-memory PC), then copy the checkpoint file .ckp.gz and the model file (.model) into this PC, there you can resume the analysis using the same command line, so that no computation time is lost. IQtree_118: Command: iqtree-omp -st AA -nt 16 -wbtl -b 1000 -abayes -con -m TESTNEW -madd C20,C60,EX2,EX3,EH0,UL2,UL3,EX_EHO,LG4M,LG4X -s MSA_118.phy Error: ERROR: Invalid model name EH0. (Log File: outStd_118) Why does the first one throws a memory allocation (RAM) error, when I have enough space in my cluster's RAM? see above Why does the error of Invalid model name does not appear in IQTree1421? There is a typo, this model name should be EHO (letter O) instead of EH0 (zero) in your command line. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <outStd_1421> <outStd_118> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh Please find my replies inline. On May 17, 2016, at 5:30 PM, Tarun JaiRaj Narwani < tjrna...@gmail.com > wrote: Dear Devs@IQTree I am trying to run I QTREE_v_1.4.2 on two datasets of 1421 Seq and 118 Sequences . Both are the Multiple Sequence Alignment files. IQtree crashes in both cases but with different errors. IQtree_1421: Command: iqtree-omp -st AA -nt 16 -wbtl -b 1000 -abayes -con -m TESTNEW -madd C20,C60,EX2,EX3,EH0,UL2,UL3,EX_EHO,LG4M,LG4X -s MSA_118.phy Error: ERROR: Not enough memory, allocation of 49476787216 bytes failed (bad_alloc) (For details checkout the attached Log File_ outStd_1421) the error message says that IQ-TREE requires ~49GB, whereas you computer has only ~31 GB as reported at the beginning of the run: Host: r1i0n4 (AVX, 31 GB RAM) For your more information, this is the RAM required for the C60 model. If you don\u2019t have computer with that much memory, remove C60 from the list. Otherwise (if you have another high-memory PC), then copy the checkpoint file .ckp.gz and the model file (.model) into this PC, there you can resume the analysis using the same command line, so that no computation time is lost. Yes, I just confirm that RAM per node is 31 GB. I am running IQtree on a cluster of 48 computers each with similar no. of RAM, therefore I can access far much greater RAM only iff I can use MPI. I searched for IQTree MPI version and could not find it. Can you direct me towards a mpi version of IQtree, if available? IQtree_118: Command: iqtree-omp -st AA -nt 16 -wbtl -b 1000 -abayes -con -m TESTNEW -madd C20,C60,EX2,EX3,EH0,UL2,UL3,EX_EHO,LG4M,LG4X -s MSA_118.phy Error: ERROR: Invalid model name EH0. (Log File: outStd_118) Why does the first one throws a memory allocation (RAM) error, when I have enough space in my cluster's RAM? see above Why does the error of Invalid model name does not appear in IQTree1421? There is a typo, this model name should be EHO (letter O) instead of EH0 (zero) in your command line. I apologize for this one.. My Bad.. Thanks..!! :) Cheers, Minh ", "Dear Tarun, The MPI version of IQ-TREE is not quite ready yet because we still need to test it thoroughly. Nevertheless, even if you use the MPI version your problem with the memory limitation will not be solved. In fact, we do not distribute the memory but rather the computation. Thus, IQ-TREE-MPI will still require the same amount of memory for each node. Distributing the memory over different cluster nodes will make the computation very slow. In every analysis, the tree likelihood is computed millions of times. If the memory is distributed, then every time the tree likelihood is computed the cluster nodes need to \"talk\" to each other to collect the results. Thus, the performance will heavily depend on your network speed and the number of nodes you can use will be limited. I would suggest that you do what Minh already suggested: remove the C60 from the model list to reduce memory consumption, C60 is rather an overkill. Cheers Tung "]}, "dgzpSylNYng": {"topic": "fails to complete MFP model selection", "initializeDate": "Jun 2, 2018, 5:22:12 PM", "timeStamp": "Jun 15, 2018, 12:12:25 AM", "content": ["Thank you for the wonderful piece of software. I am attempting to do MFP model selection on a large partitioned aa data set and failing due to an assertion error, after which the software core dumps. Here the first and last lines of the log file: FIRST: IQ-TREE multicore version 1.6.5 for Linux 64-bit built May 8 2018 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: compute-9-5.local (AVX2, FMA3, 2019 GB RAM) Command: iqtree-1.6.5-Linux/bin/iqtree -s FcC_smatrix.phy -m MFP -spp raxml_def.txt -pre ALL_MFP_clean_ptilo -bb 1000 -nt 64 -safe Seed: 696569 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Sat Jun 2 16:58:01 2018 Kernel: Safe AVX+FMA - 64 threads (96 CPU cores detected) LAST: 3054 LG 640.794 SubsetEOG77B0BP.linsi 0h:0m:56s (0h:0m:1s left) 3055 FLU+G4 2246.244 SubsetEOG7TV1N6.linsi 0h:0m:56s (0h:0m:1s left) WARNING: Numerical underflow for lh-branch WARNING: Numerical underflow for lh-branch WARNING: Numerical underflow for lh-branch WARNING: Numerical underflow for lh-branch WARNING: Numerical underflow for lh-branch WARNING: Numerical underflow for lh-branch WARNING: Numerical underflow for lh-branch <tree output, not shown in this thread> Site proportion and rates: (0.2500000000,-0.3862943614) (0.2500000000,1.0000000002) (0.5000000000,1.6931471810) ERROR: ratefree.cpp:522: double RateFree::optimizeWithEM(): Assertion `score < 0' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: ALL_MFP_clean_ptilo.log ERROR: *** Alignment files (if possible) Any ideas would be much appreciated. Thank you, Paul ", "Hi Paul, Thanks for the report. This seems to be a very big data set. But I can already see some strange problem with negative rate estimates of the free-rate model. In order to replicate this result quickly I need all data files (alignment, partition) and the checkpoint files (.ckp.gz and .model.gz). So can you just send to my personal email all the output files IQ-TREE generated for this run? Thank you, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Ok, I sent it to the email that I could find in a previous group message. Many thanks! Paul ", "Hi Paul, While debugging I found that your data set is a corner-case with many extremely short partitions, some having identical sequences. This causes numerical overflow for likelihood calculations (likely for other software as well, not just IQ-TREE). I\u2019ll fix this issue, but at the same time I think your data set is not appropriate for analysis at this stage \u2014 you need to filter out \u201cbad\u201d loci first. Here are some examples (not comprehensive): SubsetEOG7WMPZ9 has all identical sequences (38 sites) SubsetEOG7C065X.linsi has all identical sequences (only 9 sites!) SubsetEOG73RNQN.linsi has only 4 sites! Cheers Minh ", "Dear Minh, Thank you for your help! I thought I had filtered out those alignments. My apologies! Thanks, Paul "]}, "wKldy-eN-MI": {"topic": "FreeRate model for rate heterogeneity results in variation of topology when compared to the GTR+I+G", "initializeDate": "Jan 21, 2020, 10:13:14 PM", "timeStamp": "Sep 13, 2020, 11:48:31 PM", "content": ["Hi IQtree users, I am reconstructing a phylogeny analysing a dataset of 70 plastid coding regions concatenated and analysed as a single partition. The IQtree model test indicates the best model is GTR+F+R5 and the resulting phylogeny showed a change in topology among some major clades compared to previous analyses i had done in RAxML based on the GTR+G model. I ran another analysis in IQtree specifying the GTR+F+I+G4 (the best model that did not include the FreeRate parameter) and produced a topology consistent with the RAxML analyses based on the GTR +G model. The conflicting relationships were supported in analyses based on both models (ultrafast bootstap values of 91 vs 98). Also worth noting is that the branch lengths that separate these lineages are very short. Now I am unsure of which topology I should trust or if the discordance between trees reconstructed with or without the freeRate parameter is an indication that relationships among these clades remains unclear. I read through the papers on the FreeRate model referenced in the IQtree manual: Soubrier et al (2012) and Yang (1995), to get a better understanding but i must confess i did not understand them very well. This statement from one of the papers: \"Our results suggest that data partitioning or simple nonparametric mixture models of RHAS significantly improve the accuracy with which node ages and substitution rates can be estimated\" suggests the improvements of the freeRate model are in node ages and substitution rates so i am a little cautions about this change in topology. It also made me consider if i should perhaps be partitioning my dataset, which i had previously thought was not required given my data is all plastid coding regions. Does anyone have any advice or insights for this situation? Many thanks, Lalita ", "Hi Lalita, Here's my two cents - others may have more to add and/or disagree, so I don't claim to have all the answers. First, well-supported changes in topology around short branches are not uncommon when you analyse datasets with different models, even if the models seem fairly similar. We wrote a paper on this a few years ago (based on partitioning, but that's mostly just another way of estimating rate distributions) here: https://academic.oup.com/mbe/article/32/6/1611/1068429 Second, as to which tree to trust, I would trust the tree with the best-fit model more than the other tree, but I wouldn't trust any tree completely. There are a few extra bits of information you can get to help you decide how much to believe the GTR+F+R5 tree over the GTR+F+I+G4 tree: (i) the difference in AICc score between the two trees and their respective models, where a difference of >2 is considered good evidence for the model with the lower AICc, and differences >>10 are considered fairly strong evidence, but I don't make tooo much of AICc differences; (ii) tree topology tests (IQ-TREE docs have a section on this), to see if you can reject the GTR+F+I+G4 tree in favour of the GTR+F+R4 tree. For the latter, you should do the analysis assuming the best model, and you should probably read this paper to get a good handle on what the tests do and which one(s) to use in your particular situation: https://academic.oup.com/sysbio/article/49/4/652/1678908 Third, be aware that if the tree is different under the two models you describe, there may well be even better models that you can fit to your data under which the tree will change again. For example, you could consider looking at partitioned models, mixture models, GHOST models, codon models, amino acid models etc. If you have 70 plastid coding regions, it would be fairly standard to at least fit partitioned models first (partitioned by gene and codon position), and optimise the partitioning scheme with something like PartitionFinder or ModelFinder. Indeed, if you are really interested in the relationship in question, it's probably worth exploring the full range of models. You can compare all models in a standard AICc framework to decide which is best (you need some tricks to add the amino acid models to the comparison, but it can be done). Finally, after doing some extra analyses, it may be sensible to just conclude that it's hard to know which resolution of the taxa in question is correct. That's a perfectly reasonable conclusion, and to be honest given the gross simplifications that all of our phylogenetic models make I think it's often the most sensible when two reasonably good models give different trees. Hope some of that helps, Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/332a69cc-bc87-456c-b86a-9a3d1517f544%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Hi Rob, Thanks for your comments. This gave me a lot to think about and good direction for further investigation. I have now partitioned my plastid alignment into the 70 plastid genes it contains. In regards to partitioning by codon position, I must confess I am confused how this works when there is indels present in some individuals that change the reading frame in these taxa. For example in some places the '1st' codon position with respect to the entire alignment is not the 1st codon position for some taxa. How is this dealt with? Is it perhaps standard to remove all the indels to partition an alignment by codon positions? Or am i missing something here? I have forged ahead with the alignment partitioned by genes and have tried testing partition schemes in PartitionFinder2 and the ModelFinder in iqtree. With 70 plastid genes and 130 taxa (and an old slow mac) it looks like PartitionFinder might finish in about 3 weeks - is this run time standard? ModelFinder in iqtree is crashing with the error \"IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT\" which i have made an independent post about. If anyone has any other insights or advice it is always much appreciated. Thanks, Lalita To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/332a69cc-bc87-456c-b86a-9a3d1517f544%40googlegroups.com ", "Hi Lalita, W.r.t. partitioning, the main thing is to get the broad patterns right, to give the models as good a chance as possible of fitting the data. In that sense, I wouldn't worry too much about small indels or overlaps such that a small number of sites in a 1st codon position partition are not actually 1st codon positions. Generally it's more important to get the codon positions than the genes, because variation in molecular evolution is usually much stronger between codon positions than between genes. The best setup is to partition by codon position AND gene, and start from there. On the other hand, I'd be surprised if there are real indels that change the reading frame in any significant way: your alignments should look pretty well conserved at the amino acid level for cp genes I would have thought. W.r.t. the run time - your run time will depend on two things: how you are running partitionfinder, and how many processors you have available. Without getting too off topic (it's an IQ-TREE list after all), the partitionfinder manual lays out various options for speeding things up. If you want help running something on a larger machine, feel free to email off list and I might be able to help out. Rob To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/10f6d833-814f-4906-ab50-677e20088362%40googlegroups.com ", "Thanks for the quick response and the clarification around partitioning by codon position....I will take another look at my alignments. And I'll also take a better look at the PartitionFinder2 manual to get things going faster there. Thanks for your support. To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/10f6d833-814f-4906-ab50-677e20088362%40googlegroups.com ", "Hi all, I found a quiet similar problem with my mitochondrial dataset, and I found maybe writing here directly would be best than open another conversion in the google group. My problem is more related to the position of two taxa, which change when I perform a maximum likelihood tree using codons+rRNAs and aminoacid+rRNAs; in both cases, the topology of the tree is very well supported for the two taxa mentioned. Running the analysis for coding-genes (not as codon) + rRNA results in a tree similar to that of the codon+rRNA based tree. I wonder what would you suggest as a next step to confirm which topology is true? I clearly cannot do a topology test, because it requires the same alignment file. Thanks ", "I forgot to mention that I used model finder for each partition ", "Hi there, I was a bit confused by several emails in this thread, I hope that the one below is your original question? It\u2019s known that using different models may result in different trees. Especially between codon and amino-acid models, which operate on different sequences. For the next step: I don\u2019t really have a good answer. You can try more complex models such as amino-acid mixture models (see http://www.iqtree.org/doc/Substitution-Models#protein-models ) which was known to eliviate some long-branch attaction. You can also try other method like Bayesian inference (e.g. MrBayes or BEAST). Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b0173753-2d99-4e01-93fa-d1f9d1307dd9n%40googlegroups.com "]}, "s2zHW5ka-dk": {"topic": "\"Error\" URGENT, I am running IQTree for my thesis within 1 week and I get: Loading 11 partitions ... ERROR: Expecting integer, but found \"\" instead", "initializeDate": "Dec 31, 2019, 1:07:33 AM", "timeStamp": "Jan 5, 2020, 11:46:34 PM", "content": ["Hello good morning Urgently I am running IQtree on my Windows PC, I have been working on my thesis for months and I never had any problems until today a few days after delivering the complete book of my thesis. My error happens when the partitions are going to be read. Please I need your help and thank you very much for your collaboration. The run starts like this: IQ-TREE multicore version 1.6.11 for Windows 64-bit built Jun 6 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: CRISTIANCADENA (AVX, 3 GB RAM) Command: iqtree -s Arbol_DNALM.nex -spp Arbol_DNALM_particiones.nex -pre Arbol_DNALM.nex -m TESTNEW -bb 1000 -alrt 1000 -abayes -bsam GENESITE Seed: 439618 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Tue Dec 31 00:21:02 2019 Kernel: AVX - 1 threads (4 CPU cores detected) HINT: Use -nt option to specify number of threads because your CPU has 4 cores! HINT: -nt AUTO will automatically determine the best number of threads to use. Reading partition model file Arbol_DNALM_particiones.nex ... Reading alignment file Arbol_DNALM.nex ... Nexus format detected Alignment has 520 sequences with 3823 columns, 2924 distinct patterns 956 parsimony-informative, 1112 singleton sites, 1755 constant sites Gap/Ambiguity Composition p-value 1 Out_RF_An_eleg 88.62% failed 0.00% 2 LW_Hy_vulg 89.46% failed 0.00% ....... It ends like this: 517 GnRH_Ci_inte_Lik 97.10% passed 58.64% 518 GnRH_Sc_medi_Lik 97.46% failed 1.11% 519 GnRH_Ch_trit_Iso 96.55% passed 6.30% 520 GnRH_Ma_rose_Iso 97.70% failed 0.02% WARNING: 520 sequences contain more than 50% gaps/ambiguity **** TOTAL 97.41% 244 sequences failed composition chi2 test (p-value<5%; df=19) Loading 11 partitions... ERROR: Expecting integer, but found \"\u202c\" instead That is, it recognizes all sequences but does not recognize partitions. I look forward to your kind and cordial collaboration. Greetings from Colombia. ", "Please send your partition file here so that i can have a look at it Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6b84fff6-e5d9-46e0-94d7-d9745d0335a9%40googlegroups.com ", "Yes doctor thank you very much. I checked the partition file many times but I did not find the problem, I think it was a flaw in the Mesquite version and therefore did not allow me to perform the analysis. Thank you very much for your help, I'm almost a biologist. Thank you ", "El martes, 31 de diciembre de 2019, 1:07:33 (UTC-5), Cristian Enrique Cadena Caballero escribi\u00f3: ", "Hi Dr Bui Quang Minh. My partition file is this: #nexus begin sets; charset part1 = 1-837; charset part2 = 838-1329; charset part3 = 1330-1556; charset part4 = 1557-1758; charset part5 = 1759-2094; charset part6 = 2095-2164; charset part7 = 2165-2373; charset part8 = 2374-2526; charset part9 = 2527-2939\u202c; charset part10 = 2940-3471; charset part11 = 3472-3823; charpartition mine = LG+F+I:part1, rtREV+F+I+G4:part2, VT+I:part3, JTT+G4:part4, JTT+I+G4:part5, mtZOA+I:part6, LG+I+G4:part7, WAG:part8, JTT+I+G4:part9, LG+I+G4:part10, JTT+G4:part11; end; To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Chirag, This looks totally fine. Can you try to run it from the command line? (instead of via Mesquite). If it works, then there is some problem connected with Mesquite and you should contact its author. Otherwise if it still does not work, then get back to me. Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d1d6104e-87e4-474a-b4c3-283c2bbacb6c%40googlegroups.com ", "Ops, sorry for mispelling your name, Cristian. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/584E437F-6120-4AB5-BEBA-7A294FFFE2A9%40univie.ac.at "]}, "0dD2Tfnaz80": {"topic": "Tracing character history", "initializeDate": "Oct 21, 2020, 10:00:33 AM", "timeStamp": "Oct 22, 2020, 12:41:03 AM", "content": ["I was wondering if it is possible to use IQtree to trace the history of discrete binary characters, coded as either 0 or 1, in a phylogeny. From what I've read, I believe the tool can be used for this purpose, but I haven't been able to find out exactly how to do this, and how to code the data. I imagine the phylogeny can be supplied in a Newick tree format, but I don't know how to format the binary character data. I would really appreciate any help on the matter. Vicente Mu\u00f1oz Walther Ph.D.(c) Laboratorio de Ontogenia y Filogenia Las Palmeras 3425 Universidad de Chile ", "Hi Vincente. I was wondering if it is possible to use IQtree to trace the history of discrete binary characters, coded as either 0 or 1, in a phylogeny. Yes. >From what I've read, I believe the tool can be used for this purpose, but I haven't been able to find out exactly how to do this, and >how to code the data. >I imagine the phylogeny can be supplied in a Newick tree format, but I don't know how to format the binary character data. Use 0 and 1 (and - for unknown). IQTree should auto-detect that the sequences, in the alignment, are binary. Regards, James "]}, "iwtaqzbHA7c": {"topic": "MPI Send/Recv errors on a Cray XC40 system", "initializeDate": "Aug 31, 2016, 4:15:40 AM", "timeStamp": "Aug 31, 2016, 12:23:24 PM", "content": ["Hi, Now iqtree v1.4.4-mpi can be run on our general linux cluster using OpenMPI. However we encountered MPI run-time errors when run the v1.4.4-mpi on a Cray XC40 system $ aprun -n 4 iqtree-mpi -s example.phy the error messages likes ... Rank 3 [Wed Aug 31 09:45:32 2016] [c2-1c1s2n2] Fatal error in MPI_Recv: Invalid argument, error stack: MPI_Recv(196): MPI_Recv(buf=0xeac520, count=6, MPI_CHAR, src=0, tag=2, MPI_COMM_WORLD, status=(nil)) failed MPI_Recv(95).: Null pointer in parameter status STACK TRACE FOR DEBUGGING: Optimal log-likelihood: -11831.521 Rank 1 [Wed Aug 31 09:45:32 2016] [c2-1c1s2n2] Fatal error in MPI_Recv: Invalid argument, error stack: MPI_Recv(196): MPI_Recv(buf=0xeabc40, count=6, MPI_CHAR, src=0, tag=2, MPI_COMM_WORLD, status=(nil)) failed MPI_Recv(95).: Null pointer in parameter status STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: example.phy.1.log *** Alignment files (if possible) ... Notice that there is not \"example.phy.1.log\" available and he case seems to be finished as *.ckp.gz are created. Do you have any idea about this ? Thanks a lot. /Jing ", "Dear Jing, Thanks for the testing and detailed report. I was able to quickly fix this \u2014 apparently on your system, null status pointer is not accepted, which however works fine on our system. I push the fix and retag the version, which you can download from here again: https://github.com/Cibiv/IQ-TREE/releases/tag/v1.4.4-mpi Please take the source code only. I did not have time to recompile the binaries yet. Thanks! Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi, Thanks for your quick response. Now the bug fixed version works fine on the cray xc40 system. Now only one checkpoint file (example.phy.ckp.gz) is created with the new version. Is it correct ? (In the old version, each MPI rank saves itself checkpoint file) Thanks again. Regards, Jing ", "Dear Jing, thanks for the confirmation. That\u2019s the correct behavior \u2014 we slightly changed the checkpointing, so that only one checkpoint file is written to avoid cases that 100 MPI processes print 100 separate files. So everything seems to be fine. Cheers, Minh "]}, "nSPs3FNolaY": {"topic": "Updated web site", "initializeDate": "Nov 19, 2015, 9:04:54 AM", "timeStamp": "Nov 19, 2015, 9:04:54 AM", "content": ["Dear IQ-TREE users, We are happy to announce the launch of the new IQ-TREE web site immediately available at the same URL: http://www.cibiv.at/software/iqtree Notably we updated extensive online user documentation for using IQ-TREE including quick start guide, tutorials, command reference, maximum likelihood models and compilation guide. This is to replace the outdated pdf manual. The IQ-TREE source code is now hosted at github: https://github.com/Cibiv/IQ-TREE for developers\u2019 convenience. Best, IQ-TREE development team "]}, "NHgP4yBkmag": {"topic": "partition and site -log likelihoods", "initializeDate": "Sep 12, 2016, 4:31:14 AM", "timeStamp": "Sep 14, 2016, 1:02:41 PM", "content": ["Hi Minh, after the quartet mapping works fine (thanks again) I wanted in addition to cacluclate the partition logLH of the best tree I got and from a fixed input tree (with another topology) and compare them. I found how I can do this for each site (would be also another aim to do this per partition for each site), with e.g. -wsl... - but how can I do this for each partition? Background: I want to analyse if there are different probabilities for one or the other topology but partitionswise, not via an AU test etc... Thanks & best Karen I actually looked in the log and iqtree file of the best tree, but ", "Dear karen, there is no such specific option. I add this to the todo list. Nevertheless you can always compute partition loglh by just summing up the site loglh belonging to each partition. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hey Minh, would be great to implement this at some point. in the meantime I try what you suggest - just a shoert question again: if I then take the complete dataset (partitioned) and run the option -wsl (turn on writing site log-likelihoods to .sitelh file in TREE-PUZZLE format. Such file can then be passed on to CONSEL for further tree tests. DEFAULT: OFF) in the file it does not give me info about the partition boundaries does it? (so do some scripting to summ up it correctly) ? Best, Karen Am Mittwoch, 14. September 2016 11:42:47 UTC+2 schrieb Bui Quang Minh: Dear karen, there is no such specific option. I add this to the todo list. Nevertheless you can always compute partition loglh by just summing up the site loglh belonging to each partition. Minh On Sep 12, 2016 10:31 AM, \"'Karen Meusemann' via IQ-TREE\" < iqt...@googlegroups.com > wrote: Hi Minh, after the quartet mapping works fine (thanks again) I wanted in addition to cacluclate the partition logLH of the best tree I got and from a fixed input tree (with another topology) and compare them. I found how I can do this for each site (would be also another aim to do this per partition for each site), with e.g. -wsl... - but how can I do this for each partition? Background: I want to analyse if there are different probabilities for one or the other topology but partitionswise, not via an AU test etc... Thanks & best Karen I actually looked in the log and iqtree file of the best tree, but You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com ", "Hi karen, sorry i forgot to give this information: the .sitelh file will always contain sites per partition contiguously, no matter if the partition was specified to contain non contiguous blocks or not. As an example if your input partition file is: #nexus Begin sets; Charset part1=1-99\\3; Charset part2=2-99\\3; Charset part3=3-99\\3 100-119; End; Then for .sitelh file the sites 1-33 belong to part1, sites 34-66 belong to part2 and sites 67-119 belong to part3. Hope that helps Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com ", "ok thanks, that helps (my files are contiguously anyway! I will give it a go and summ it up for partitions :) best Karen "]}, "hWwyZIM4eyg": {"topic": "Re: [iqtree] How can I estimate the running time needed?", "initializeDate": "Mar 9, 2021, 5:50:48 PM", "timeStamp": "Mar 9, 2021, 5:50:48 PM", "content": ["Hi there, there is nothing wrong here, IQ-TREE is still running. Your data set is just too big for it. You can check the CPU usage, which will tell you if iqtree2 is still running and how much CPU it\u2019s using. Minh On 4 Mar 2021, at 2:05 pm, Hewei Liang < homer...@gmail.com > wrote: Hi there, I am running an analysis with 16 cores and up to 500Gb of RAM by iqtree2.0.7 for Linux. And my data include 2000 sequence amount to 2.7Gb. All the parameters are default or AUTO. Do I have enough computing resources? IQ-TREE's output have been not update for more than 24hrs(fig. the last output). I am wondering if there any errors. <\u622a\u5c4f2021-03-04 \u4e0a\u534810.45.22.png> Best wishes. Thanks. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7f782498-148d-4a9e-886b-255728ece90en%40googlegroups.com <\u622a\u5c4f2021-03-04 \u4e0a\u534810.45.22.png> "]}, "tM4qAxoNWu8": {"topic": "IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT", "initializeDate": "Nov 11, 2020, 10:05:40 AM", "timeStamp": "Jan 3, 2021, 10:28:15 AM", "content": ["I searched the group for similar cases, but I see all of them are slightly different. In any case, I had not found solution. I run IQ-TREE multicore version 2.1.2. I have a partitioned dataset and want to calculate model for each partition and build an ML tree after that. The software works on small portion of loci, but fails on big. I did not catch a limit yet, it can take time )) I think my dataset is not too big for genomic studies... it is 8G and 1149904 partitions. Firstly I tried iqtree2.exe -s ind.phy -p ind.partitions.phy -T AUTO -B 1000 --alrt 1000 --redo later I had an idea that I can calculate models first and run tree construction after that: iqtree2.exe -s ind.phy -p ind.partitions.phy -T AUTO -m MF But all my runs had the same final: 1149903 DNA 25 292 0 292 GTR p1149903 WARNING: No variant sites in partition p1149903 1149904 DNA 25 290 0 290 GTR p1149904 WARNING: No variant sites in partition p1149904 Degree of missing data: 0.000 Info: multi-threading strategy over partitions ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: ind.partitions.phy.log ERROR: *** Alignment files (if possible) The beginning of log is: IQ-TREE multicore version 2.1.2 COVID-edition for Windows 64-bit built Oct 22 2020 Developed by Bui Quang Minh, James Barbetti, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: Lissovsky (AVX, 15 GB RAM) Command: iqtree2.exe -s ind.phy -spp ind.partitions.phy -T AUTO -m MF Seed: 603877 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Nov 11 16:42:11 2020 Kernel: AVX - auto-detect threads (12 CPU cores detected) Reading partition model file ind.partitions.phy ... Reading alignment file ind.phy ... Phylip format detected Alignment most likely contains DNA/RNA sequences WARNING: 10842150 sites contain only gaps or ambiguous characters. Alignment has 25 sequences with 332097087 columns, 1510679 distinct patterns 797310 parsimony-informative, 1761842 singleton sites, 329537935 constant sites Gap/Ambiguity Composition p-value 1 t01 3.67% failed 0.00% 2 h01 3.76% failed 0.00% 3 opa 3.90% passed 57.07% 4 t02 3.70% failed 0.00% 5 h02 4.05% failed 2.44% 6 a01 3.99% passed 99.95% 7 nn1 4.03% passed 15.02% 8 a02 3.93% passed 92.77% 9 t03 3.98% passed 91.83% 10 a03 3.88% passed 40.22% 11 t04 4.08% failed 0.36% 12 pus 4.14% failed 0.00% 13 nn2 3.87% passed 7.26% 14 h03 4.04% passed 9.86% 15 h04 3.60% failed 0.00% 16 pa1 3.96% passed 34.96% 17 pa2 4.03% failed 1.14% 18 t05 4.02% passed 18.57% 19 a04 4.08% failed 1.26% 20 a05 4.01% passed 95.44% 21 a06 4.01% passed 58.33% 22 man 3.96% passed 99.38% 23 h05 4.17% failed 0.00% 24 h06 3.94% passed 56.62% 25 a07 3.70% failed 0.00% **** TOTAL 3.94% 11 sequences failed composition chi2 test (p-value<5%; df=3) Partition file is not in NEXUS format, assuming RAxML-style partition file... Subset Type Seqs Sites Infor Invar Model Name 1 DNA 25 290 0 290 GTR p1 WARNING: No variant sites in partition p1 2 DNA 25 292 0 292 GTR p2 WARNING: No variant sites in partition p2 3 DNA 25 292 8 280 GTR p3 4 DNA 25 292 0 292 GTR p4 WARNING: No variant sites in partition p4 5 DNA 25 292 0 288 GTR p5 WARNING: No parsimony-informative sites in partition p5 6 DNA 25 292 0 292 GTR p6 WARNING: No variant sites in partition p6 7 DNA 25 292 0 292 GTR p7 WARNING: No variant sites in partition p7 8 DNA 25 290 6 280 GTR p8 9 DNA 25 290 4 286 GTR p9 10 DNA 25 292 2 284 GTR p10 ", "Well, I have seen the error in one of my scripts and rerun it right now. Command: iqtree2.exe -s ind.phy -p ind.partitions1.phy -T AUTO -m MF There is the same error report. However there was some additional information that is absent in the log unfortunately ", "This is the final part. Without additional information in this case ", "New error today 257772 DNA 290 290 GTR p257772 WARNING: No variant sites in partition p257772 Degree of missing data: 0.000 Info: multi-threading strategy over partitions ERROR: \\Users\\minh\\Dropbox\\iqtree2\\main\\phylotesting.cpp:537: std::__cxx11::stri ng computeFastMLTree(Params &, Alignment *, ModelCheckpoint &, ModelsBlock *, in t &, int, std::__cxx11::string): Assertion `subst_names.size() == rate_names.siz e()' failed. This application has requested the Runtime to terminate it in an unusual way. Please contact the application's support team for more information. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: ind.partitions2.phy.log ERROR: *** Alignment files (if possible) ", "Well. I found IQ tree falls down every time I use -m flag. I tried all possible options after -m. Deleting \"-m\" starts normal execution. ", "My apology for the delay in replying. Just too much commitment at the moment. Your dataset is simply toooo big. Does it work if you add -t PARS option to the command line? I just want to filter out that this might due to the PLL library internally used in IQ-TREE. This librarry had known issue with big alignment. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e02bdf70-41d8-4f22-9bae-20b06aa14535n%40googlegroups.com ", "Sorry, I did not receive a notification of your answer. Will check. Dear Minh, what dataset is not big? Could you give me some starting point? "]}, "caMLlPZ8c60": {"topic": "estimating branch lengths", "initializeDate": "Aug 6, 2017, 8:56:02 AM", "timeStamp": "Aug 10, 2017, 12:50:42 PM", "content": ["Dear Minh & all, using iqtree 1.5.5 we struggled over following: For 2 aims (AU Test & calculating partition & site log likelihoods) we have as input one tree with branch lengths (best tree) and one alternative tree we wanna test (without brlength because its \"constructed. Both we pas for calculating the partition/sige loglh like this for the best one where we want to fix the given tree 1) iqtree-omp -nt 10 -st AA -s alignment.fas -spp best_scheme.nex -te best_tree_rooted.treefile -blfix -gmedian -wpl -wsl -safe it works but afterwards it again outputs a treefile where the brlength are again somewhat different. Why it outputss again a tree (with slightly different brlength) and are really the one from the input tree are taken for estimating the log-lh values? (in the manual online its btw \"fixbl\" but is you call iqtree the command is -blfix...) for the other one we wanted to estimate the brlengths before * must we do this separately? * we did not find something in the manual but calling IQtree there is \"--blscale\" so we used this: (input tree without brlengths) 2) iqtree-omp -nt 10 -st AA -s alignment.fas -spp best_scheme.nex -t alternative_tree_rooted.treefile -blscale -gmedian -wpl -wsl -safe This simply crashed with a segmentaion fault and nothing what I could see in the logfile A) Shall we send you the alignment & trees / Logfiles? B) Maybe -blscale is not implemented yet, is this the one to estimate brlength (and optimies then? Earlier this was also needed before doing the AU test in ConSel (e.g. with -f e in Examl) Alternatively we do this WITHOUT estimating brlength and use as input both trees (the best and the alternative one) WITHOUT brlength? (as I did before for datasets for AU test & calculating part.logLH) which worked - (urgent like always) Thanks in advanvce!! Karen :) ", "Dear Karen, Sorry for the delay. My answers below: On Aug 6, 2017, at 2:56 PM, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Dear Minh & all, using iqtree 1.5.5 we struggled over following: For 2 aims (AU Test & calculating partition & site log likelihoods) we have as input one tree with branch lengths (best tree) and one alternative tree we wanna test (without brlength because its \"constructed. Both we pas for calculating the partition/sige loglh like this for the best one where we want to fix the given tree 1) iqtree-omp -nt 10 -st AA -s alignment.fas -spp best_scheme.nex -te best_tree_rooted.treefile -blfix -gmedian -wpl -wsl -safe it works but afterwards it again outputs a treefile where the brlength are again somewhat different. Why it outputss again a tree (with slightly different brlength) and are really the one from the input tree are taken for estimating the log-lh values? This is a good question. There are different treatments with branch length fixing option (-blfix). 1. If you use a single (non-partition) model, branch lengths will be fixed as they are. 2. If you use a partition model, then there are 3 cases: (i) edge-equal partition model (-q option): branch lengths are fixed, (ii) edge-unlinked partition model (-sp option), branch lengths are also fixed and finally (iii) edge-proprotional partition model (-spp option): branch lengths are rescaled by a factor due to a normalization step. So in the last case (iii), which is also the one you specified, that the branch lengths are different. But as I said IQ-TREE does not change the branch lengths entirely: e.g. if you display the tree in a tree viewer then you will get exactly same figure as the input tree, only the scale bar is different. Olga and I will need to think how to handle this case consistently. But for now it is still ok for your analysis: the log-likelihood values are always the same with and without branch length rescaling. Thus, it does not affect tree testing analysis. (in the manual online its btw \"fixbl\" but is you call iqtree the command is -blfix\u2026) The two options -fixbr and -blfix are synonymous. for the other one we wanted to estimate the brlengths before which other one did you mean? * must we do this separately? * we did not find something in the manual but calling IQtree there is \"--blscale\" so we used this: (input tree without brlengths) 2) iqtree-omp -nt 10 -st AA -s alignment.fas -spp best_scheme.nex -t alternative_tree_rooted.treefile -blscale -gmedian -wpl -wsl -safe This simply crashed with a segmentaion fault and nothing what I could see in the logfile Please do not used -blscale option for partition models. It only works with single models. I added this option after a request by Rob Lanfear. A) Shall we send you the alignment & trees / Logfiles? not necessary, as I explained above already B) Maybe -blscale is not implemented yet, is this the one to estimate brlength (and optimies then? Earlier this was also needed before doing the AU test in ConSel (e.g. with -f e in Examl) Alternatively we do this WITHOUT estimating brlength and use as input both trees (the best and the alternative one) WITHOUT brlength? (as I did before for datasets for AU test & calculating part.logLH) which worked - (urgent like always) Thanks in advanvce!! Did these answer your questions? Cheers, Minh Karen :) You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, answers in between Dear Minh & all, using iqtree 1.5.5 we struggled over following: For 2 aims (AU Test & calculating partition & site log likelihoods) we have as input one tree with branch lengths (best tree) and one alternative tree we wanna test (without brlength because its \"constructed. Both we pas for calculating the partition/sige loglh like this for the best one where we want to fix the given tree 1) iqtree-omp -nt 10 -st AA -s alignment.fas -spp best_scheme.nex -te best_tree_rooted.treefile -blfix -gmedian -wpl -wsl -safe it works but afterwards it again outputs a treefile where the brlength are again somewhat different. Why it outputss again a tree (with slightly different brlength) and are really the one from the input tree are taken for estimating the log-lh values? This is a good question. There are different treatments with branch length fixing option (-blfix). 1. If you use a single (non-partition) model, branch lengths will be fixed as they are. 2. If you use a partition model, then there are 3 cases: (i) edge-equal partition model (-q option): branch lengths are fixed, (ii) edge-unlinked partition model (-sp option), branch lengths are also fixed and finally (iii) edge-proprotional partition model (-spp option): branch lengths are rescaled by a factor due to a normalization step. So in the last case (iii), which is also the one you specified, that the branch lengths are different. But as I said IQ-TREE does not change the branch lengths entirely: e.g. if you display the tree in a tree viewer then you will get exactly same figure as the input tree, only the scale bar is different. Olga and I will need to think how to handle this case consistently. But for now it is still ok for your analysis: the log-likelihood values are always the same with and without branch length rescaling. Thus, it does not affect tree testing analysis. ok great: then we will do it with topologies without brlength (AU test and calculating the partitionlogLHs). Many thanks ! (in the manual online its btw \"fixbl\" but is you call iqtree the command is -blfix\u2026) The two options -fixbr and -blfix are synonymous. for the other one we wanted to estimate the brlengths before which other one did you mean? I meant for the \"hypothetical tree\" we artificially created * must we do this separately? * we did not find something in the manual but calling IQtree there is \"--blscale\" so we used this: (input tree without brlengths) 2) iqtree-omp -nt 10 -st AA -s alignment.fas -spp best_scheme.nex -t alternative_tree_rooted.treefile -blscale -gmedian -wpl -wsl -safe This simply crashed with a segmentaion fault and nothing what I could see in the logfile Please do not used -blscale option for partition models. It only works with single models. I added this option after a request by Rob Lanfear. ok I see A) Shall we send you the alignment & trees / Logfiles? not necessary, as I explained above already ok I think its finished (see above) B) Maybe -blscale is not implemented yet, is this the one to estimate brlength (and optimies then? Earlier this was also needed before doing the AU test in ConSel (e.g. with -f e in Examl) Alternatively we do this WITHOUT estimating brlength and use as input both trees (the best and the alternative one) WITHOUT brlength? (as I did before for datasets for AU test & calculating part.logLH) which worked - (urgent like always) Thanks in advanvce!! Yes :)) thanks again! cheers karen "]}, "ZHwV7MJGGms": {"topic": "Trouble getting morphological data to run", "initializeDate": "Mar 29, 2019, 7:14:36 AM", "timeStamp": "Apr 2, 2019, 3:19:22 AM", "content": ["Hi all, I am having trouble getting my morphological file to run. I have it in the normal phylip format, but for some reason it keeps insisting that there are errors in the sequence length indicated. I've tried shortening the names, inserting tab spaces instead of normal spaces - I just can't figure it out. Any help please? Sariana ", "Hi Sariana, I don\u2019t know exactly what the problem is, but you may try fasta format\u2026 simply because you don\u2019t have to deal with space between the sequence names and the sequences (they are on different lines). Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, I've tried putting my morphological data in fasta format but it is still not working. My command is: \"bin\\iqtree -s morph.fas -st morph\" but the program keeps saying: \"Alignment most likely contains binary sequences. ERROR: Invalid sequence type\" Any ideas? Kind regards, Sariana On Sunday, March 31, 2019 at 12:00:15 PM UTC+2, Minh Bui wrote: Hi Sariana, I don\u2019t know exactly what the problem is, but you may try fasta format\u2026 simply because you don\u2019t have to deal with space between the sequence names and the sequences (they are on different lines). Minh On 29 Mar 2019, at 10:14 pm, Sariana Faure < sarian...@gmail.com > wrote: Hi all, I am having trouble getting my morphological file to run. I have it in the normal phylip format, but for some reason it keeps insisting that there are errors in the sequence length indicated. I've tried shortening the names, inserting tab spaces instead of normal spaces - I just can't figure it out. Any help please? Sariana You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "VN1DSoQyVgc": {"topic": "3rd codon position RY coded", "initializeDate": "Jul 14, 2017, 8:22:50 AM", "timeStamp": "Jul 14, 2017, 9:09:40 AM", "content": ["Dear Minh, I have a question about running a nucleotide (codon) alignment where the 3rd codon position is RY coded. In the manual I found that any codon, which has at least one ambiguous nucleotide, will be treated as an unknown codon character. I tried to start running my alignment with iqtree to find the best nucleotide model, (bin\\iqtree-omp -s mydata.phy -bb 1000 -nt AUTO) but IQ-Tree always detected amino acid sites. How can I run IQ-Tree with the 3rd codon position RY coded as nucleotide sequence. Thanks in advance and have a nice weekend Nadja ", "Hi Nadja, The quick answer is to add \u201c-st DNA\u201d into the command line. It will override the data type auto detection. The reason is: IQ-TREE uses a heuristic to determine the data type. It counts the number of A,C,G,T compared with the number of non-gap characters in the alignment. If this is > 90% (or similar threshold, I don\u2019t recall the exact threshold), then the alignment is classified as DNA. In your case, due to many polymorphic characters, this threshold is not met and that\u2019s why IQ-TREE thinks that you have protein. To avoid this, pls add -st DNA into your command line. This should resolve it. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thank you very much! Nadja "]}, "bqgwXW0s9AE": {"topic": "Citation for concordance factor", "initializeDate": "May 7, 2020, 7:37:17 PM", "timeStamp": "May 7, 2020, 7:37:17 PM", "content": ["Dear Users, The gene and site concordance factor paper is now published in Molecular Biology and Evolution. So if you use these measures please cite the paper: New methods to calculate concordance factors for phylogenomic datasets B.Q. Minh, M.W. Hahn, R. Lanfear Molecular Biology and Evolution in press (2020) https://doi.org/10.1093/molbev/msaa106 Here is the tutorial: http://www.iqtree.org/doc/Concordance-Factor And a practical guide with walkthrough example how to use and intepret these measures: http://www.robertlanfear.com/blog/files/concordance_factors.html Cheers, Rob, Matt and Minh "]}, "d4owFVRa7w0": {"topic": "estimate branch length, constrained tree - error analyse fail", "initializeDate": "Mar 20, 2021, 3:53:00 AM", "timeStamp": "Mar 25, 2021, 7:14:34 AM", "content": ["Dear IQtree community, I tried to run on iqtree2 (2.1.2) a constraint search to estimate branch length of my tree. Here is the command line used: iqtree2 -s concat_50loci.phy -p partitions.txt -g pcoc_new_full_constraint.tre --prefix Branch_length -safe Iqtree run, estimate the models for my partitions and start estimate the tree. Then I endup with this error: WARNING: Numerical underflow for lh-derivative ERROR: phylokernelnew.h:3268: double PhyloTree::computeLikelihoodFromBufferSIMD() [VectorClass = Vec4d, nstates = 4, FMA = false, SITE_MODEL = false]: Assertion `std::isfinite(tree_lh) && \"Numerical underflow for lh-from-buffer\"' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: Branch_length.log ERROR: *** Alignment files (if possible) /opt/sge_spool/8.5.4/sm8/job_scripts/1496701: line 11: 24014 Aborted iqtree2 -s concat_50loci.phy -p partitions.txt -g pcoc_new_full_constraint.tre --prefix Branch_length -safe I tried to run it instead on iqtree 1.6.12, but in this case it didnt like my constrained tree. Reading constraint tree pcoc_new_full_constraint.phy... ERROR: Rooted constraint tree not accepted I can try on others software, but I would like to run it on iqtree. Do you have an idea of how to fix this? I thank you in advance for the help. best regards ", "Hi there, When you wrote \u201cto estimate branch length of my tree\u201d, does that mean that your contraint tree actually contains all taxa, and you want to estimate branch lengths of that tree? If that\u2019s the case, use -te instead of -g option. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/00233de7-6321-4862-84d4-c0c4eb8a51e9n%40googlegroups.com "]}, "-NV38rEavN4": {"topic": "what is the connection between pairwise distance and branch length ?", "initializeDate": "Jun 29, 2018, 12:10:04 AM", "timeStamp": "Jun 29, 2018, 6:03:14 AM", "content": ["Hi, IQ-tree gives pairwise distance matrix (.mldist file) and tree in newick format. I wonder, what is the relation / or is there any relation between branch length and pairwise distance between any two OTU ? if the branch length is measure of number of nucleotide substitution per site, my question is what is the reference sequence used to compare the nucleotide substation for each branch ?? Chirag, ", "Hi Chirag again, On 29 Jun 2018, at 2:10 pm, Chirag Parsania < chirag....@gmail.com > wrote: Hi, IQ-tree gives pairwise distance matrix (.mldist file) and tree in newick format. I wonder, what is the relation / or is there any relation between branch length and pairwise distance between any two OTU ? See my answer in a previous thread. if the branch length is measure of number of nucleotide substitution per site, That\u2019s right. my question is what is the reference sequence used to compare the nucleotide substation for each branch ?? Well, I would say, the set of all sequences in the alignment is the reference! They all contribute to the branch length estimates. For more details, refer to textbook like Inferring Phylogenies by Joe Felsenstein. Cheers Minh Chirag, You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "HyJNLug2aJw": {"topic": "modelomatic and ModelFinder", "initializeDate": "Jan 21, 2019, 9:50:39 AM", "timeStamp": "Jan 22, 2019, 12:47:01 AM", "content": ["Hello, I see that since the 5th beta version 1.7, it is possible to use modelomatic (--modelomatic). Will modelomatic replace ModelFinder? Thank you ! ", "Hi Antony, Thanks for testing this new feature of the beta version. You will need to use this switch when performing ModelOMatic for codon alignments. We don\u2019t intend to make it a default option for the official release. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "gdMUrz57nKI": {"topic": "Re: questions conc. modelfinder", "initializeDate": "May 22, 2017, 4:04:32 AM", "timeStamp": "May 22, 2017, 4:04:32 AM", "content": ["Hi Karen, On May 21, 2017, at 7:05 PM, Karen Meusemann < meus...@gmx.de > wrote: Dear Minh, just a quick question (I asked based on the paper preprint a couple of times already Lars but either he did not understand my question or I misunderstood him, - also asked Rob Lanfear and he said the opposite): I see, will try to clarify Lars J. explained that its like \"ProtTest etc but much more sophistacated etc - taking a partition as one block (no merging etc). My questions 1) having a supermartix with a partitionfile (e.g. genes), it still considers the partition, is that correct (without merging)? Yes partitions will always be considered. Whether merging or not depends on -m option: http://www.iqtree.org/doc/Command-Reference#automatic-model-selection If you just do \u201c-m MF\u201d or \u201c-m MFP\u201d, then IQ-TREE will find the best-fit model for each partition, keeping the original partitioning scheme. If you append \u201c+MERGE\u201d into this -m option, then the PartitionFinder algorithm will be invoked. (so e.g. a supermatrix having 100 partitions + Modelfinder it will do it for 100 partitions? (Lars said no, Rob said yes\u2026) Yes. I think Lars might have missed the point, that you also input a partition file. 2) can one restrict it also to certain models (like before?) testing a limited set? yes, -mset option will do 3) for us improtant as well: with linked or unlinked brlength? Right now, ModelFinder only implements the unlinked branch lengths. But it is in our agenda to implement the linked branch lengths into version 1.6, after I clarified a few questions with Rob. if 1) is possible, doesi it work only with unlinked brlentghs or with linked as well? see above (I also have from Lars different emaILS ABOUT THIS... many many thanks A LOT ALWAYS FOR ANSWERING :) * i WILL TRY AND CITE IT :) * THANKS A LOT FOR IMPLEMENTING THAT QUARTET STUFF THIS IS GREAT :)))))))) you are welcome ;-) Minh cheers, many many thanks and have a nice weekend!! karen Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "MuHjMnnnvy0": {"topic": "IQ-TREE interpreting multistate matrix as binary (even though it isn't)", "initializeDate": "May 9, 2018, 8:10:56 PM", "timeStamp": "May 15, 2018, 1:24:56 PM", "content": ["I have a multistate morphology character matrix that I am trying to run in IQ-TREE to do a simple ML analysis on this dataset. The problem is, when I give IQ-TREE the dataset it reports: Alignment most likely contains binary sequences Thi report is followed by many errors saying that taxa X, Y, Z etc. \"has invalid character 2 at site X\"-- I have run other multistate morphology datasets through IQ-TREE with no issues before, so I am not sure why it is considering this particular matrix to be binary when it clearly isn't (numbers other than 0 and 1 exist in the matrix). Has anyone run into similar issues? Is there a way to force IQ-TREE to treat the matrix as multistate, or does it only autodetect? Thanks! Ryan ", "Hi Ryan, I believe this question was asked before. Quick answer: please use option \u201c-st MORPH\u201d to force multi-state data. Long answer: the auto-detection is not perfect. IQ-TREE observed that the number of 0 and 1 exceeds 90% of the characters in the alignment and thus think that you have binary data. The -st option above (for sequence type) will override this behaviour. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Great, thank you. This worked. However, the main reason why I brought this up was because I am trying to run a combined morphology + molecular dataset using the explanations in the IQ-TREE manual. As required, I am providing IQ-TREE with a nexus partition file that calls the individual morphological and molecular matrices individually (see below), but the issue is that because this specific morphology matrix is not interpreted correctly as morphological, and instead is read as binary, the entire analysis does not run. Is there a way to override this behavior in a mixed dataset? In other words, the DNA runs fine on its own, and the morphology runs fine on its own with the -MORPH option, but I cannot figure out how to provide the -MORPH option for just the morphological data without IQ-TREE then trying to interpret the DNA data as morphology as well. Thanks in advance! Ryan My partition file (morph2.fas is the morphology matrix, DNA.fas is the molecular alignment): #nexus begin sets ; charset AA_L_EF1a_sequences_new1 = DNA.fas: 1-1259\\3; charset AA_L_EF1a_sequences_new2 = DNA.fas: 2-1259\\3; charset AA_L_EF1a_sequences_new3 = DNA.fas: 3-1259\\3; charset AA_L_tektinin_sequences_new1 = DNA.fas: 1260-2010\\3; charset AA_L_tektinin_sequences_new2 = DNA.fas: 1261-2010\\3; charset AA_L_tektinin_sequences_new3 = DNA.fas: 1262-2010\\3; charset AA_L_COI_sequences_new = DNA.fas: 2011-4342; charset morphology = morph2.fas: *; end; ", "Hi Ryan, I see the problem now. Simply change this line: charset morphology = morph2.fas: *; charset morphology = morph2.fas: MORPH, *; To enforce this partition to be MORPH data. Then this should work. Cheers, Minh ", "Hi Minh, This worked perfectly, thank you! Ryan "]}, "hjiWUmX1lyQ": {"topic": "chi-square composition test only", "initializeDate": "Jan 16, 2019, 9:46:14 AM", "timeStamp": "Jan 16, 2019, 1:54:56 PM", "content": ["Hi, Is it possible to make IQ-Tree just do the chi-square composition test results quickly and not go on to do any tree-building or anything else? I can't see an option for this. Thanks ", "Hi, There is no such option. However, you can tell IQ-TREE to stop early by adding \u201c-n 0\u201d option. This will do model parameter estimation on an initial tree and then stop. So it does some extra work after the chi2 test, but shouldn\u2019t take too long to complete. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "dNfbpkRKQXw": {"topic": "Edge linked or Edge Unlinked For Merging Partitions", "initializeDate": "Oct 24, 2017, 10:23:07 AM", "timeStamp": "Oct 25, 2017, 7:10:46 AM", "content": ["Dear iq tree developers, I would like to emulate partitionfinder by using the model for linked branchlengths between partitions. Is this implemented in iqtree? In the documentation it is mentioned there is the edge linked and the edge unlinked model but i know this was not possible to do some time ago. I just want to make sure. I tried to do this once with the options -m TESTMERGEONLY and -spp <supermatrix> and version 1.5.5 trying to emulate partitionfinder but it came to my attention it was running really slow, like in the case of brlens=unlinked. Best wishes and many thanks Alex ", "Hi all, I have a similar question as well (since I am a bit confused using Partitionfinder or Modelfinder in IQtree and defualts concerning linked/unlined brlength): If I use a command like iqtree-omp -s align.fas -st AA -spp partitions.nex -m MF+MERGE -msub nuclear -madd LG4X -mrate E,I,G,R -m\\ erit AICc -rcluster 100 -safe -pre best_model isn't it edle linked but only evolu. different speed? or is it still unlinked? if I then do a tree search (with -spp) brlength are also linked or not? and isn't this then a kind of mixture out of ModelFinder and PartitionFinder!? Thanks & best (in a thread 2 years ago I think to implement it was planned). Karen ", "Dear Alex and Karen, You are right, I believe this was discussed already\u2026 Right now ModelFinder only does edge-unlinked partition testing, no matter if you specify -sp or -spp. Once this step is done, then IQ-TREE search will use the partition model as specified, i.e. edge-unlinked with -sp and edge-linked with -spp. I know this caused some confusion, but the main reason is that at the time (2 years ago) I did not know how exactly edge-linked PartitionFinder works. Now Rob clarified this, there is a plan to implement it ( https://github.com/Cibiv/IQ-TREE/issues/20 ). I will notify you once done. How urgent would you like this feature? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, thanks a lot for our reply. I think its rather urgent... many thanks in advance :) Karen ", "Hi Minh, I think this would be rather urgent ;) Many thanks in advance :) Karen Am Dienstag, 24. Oktober 2017 16:23:07 UTC+2 schrieb Alexandros Vasilikopoulos: ", "Hi Minh, Many thanks for that. Does what you mentioned apply to all options for model selection in iqtree irrespective of whether you are doing merging? Eg is it doing the same (unlinked brlens) with -TESTMERGEONLY and -MF+MERGE? If someone does not merge partitions but you only specify them for model selection (eg -m MF -m TESTONLY) is it again the unlinked model that is used? Best and many thanks Alex ", "Dear Alex, I should have clarified it: this behavior is only applied when you have \u201cMERGE\u201d in the -m option. If you do not merge the partitions (e.g. -m MF, -m TESTONLY) then iqtree works as usual, i.e. obeying the -sp or -spp option. Thanks for asking and I hope it\u2019s clear now. Minh "]}, "tZOnYXCthZc": {"topic": "Missing Support Values Webserver Tree", "initializeDate": "Sep 11, 2016, 11:39:28 AM", "timeStamp": "Sep 13, 2016, 12:04:31 PM", "content": ["I've ran trees fine on the web server before but when I include mixture models, the output tree appears to be missing support values. Am I missing something? Thanks, Will ", "Hi Will! From the log file, it seems that you wanted to include mixture models in the model selection process and that you therefore used the \"Model Selection\" tab. In this tab, IQ-TREE only searches for the best-fit model for your data. You can find the following line in your log file: \"Best-fit model: LG4X chosen according to BIC\". If you now want to reconstruct the maximum-likelihood tree with this information, please use the \"Tree Inference\" tab. There you can choose LG4X as substitution model and specify your desired branch support analysis parameters. IQ-TREE will then search for the maximum likelihood tree and output the tree with support values. In the web server only the most commonly used IQ-TREE features are provided. This is the reason why you can find more model selection features in the \"Model Selection\" tab than in the \"Tree Inference\" tab. However, with the IQ-TREE command line version, it is possible to combine all desired model selection options (like the custom candidate set of mixture models that you used) and subsequent tree reconstruction in one run. If you want to try out the command line version, you can find a quickstart guide here: http://www.iqtree.org/doc/Quickstart/ Hope this helps! Jana You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "On Tuesday, 13 September 2016 15:38:15 UTC+1, Jana Trifinopoulos wrote: > Hi Will! > From the log file, it seems that you wanted to include mixture models in the model selection process and that you therefore used the \"Model Selection\" tab. In this tab, IQ-TREE only searches for the best-fit model for your data. You can find the following line in your log file: \"Best-fit model: LG4X chosen according to BIC\". If you now want to reconstruct the maximum-likelihood tree with this information, please use the \"Tree Inference\" tab. There you can choose LG4X as substitution model and specify your desired branch support analysis parameters. IQ-TREE will then search for the maximum likelihood tree and output the tree with support values. > In the web server only the most commonly used IQ-TREE features are provided. This is the reason why you can find more model selection features in the \"Model Selection\" tab than in the \"Tree Inference\" tab. However, with the IQ-TREE command line version, it is possible to combine all desired model selection options (like the custom candidate set of mixture models that you used) and subsequent tree reconstruction in one run. If you want to try out the command line version, you can find a quickstart guide here: http://www.iqtree.org/doc/Quickstart/ > Hope this helps! > Jana > On 11 September 2016 at 17:39, billiesrus via IQ-TREE < iqt...@googlegroups.com > wrote: > I've ran trees fine on the web server before but when I include mixture models, the output tree appears to be missing support values. Am I missing something? > Thanks, > Will > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Excellent! Thank you for the detailed response! "]}, "b_RnfvHg2Fs": {"topic": "IQ-TREE CRASHES WITH SIGNAL ABORTED while computing likelihood mappin", "initializeDate": "Nov 22, 2019, 5:36:56 AM", "timeStamp": "Nov 25, 2019, 5:59:11 AM", "content": ["Hi iq-tree users, i got an error while computing FcLM with a mixed dataset (binary and nucleotides) and the -spp option either using the 1.7 beta 7 version and the 1.6.9 version. command: iqtree-1.7-beta7 -spp RY.fill.cfg.best_scheme.nex -lmap 60000 -nt 4 -n 0 error: Performing likelihood mapping with 60000 quartets... Computing 60000 quartet likelihoods (one dot represents 100 quartets). ERROR: phylotreepars.cpp:63: void PhyloTree::computePartialParsimonyFast(PhyloNeighbor *,phylotreepars.cpp PhyloNode *):: Assphylotreepars.cppertion `phylotreepars.cpp:!aln->ordered_pattern.empty():63' failed.: 6363 : : void PhyloTree::computePartialParsimonyFast(PhyloNeighbor *, PhyloNode *): Assertion `void PhyloTree::computePartialParsimonyFast(PhyloNeighbor *, PhyloNode *)void PhyloTree::computePartialParsimonyFast(PhyloNeighbor *, PhyloNode *): Assertion ` !aln->ordered_pattern.empty()!aln->ordered_pattern.empty(): Assertion `' failed.!aln->ordered_pattern.empty() 'ERROR: STACK TRACE FOR DEBUGGING:' failed. ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED failed. ERROR: ERROR: *ERROR: ERROR: *** IQ-TREE CRASH*** For bug report please send to developers:ES WITH SIGNAL ** IQ-TREE CRASHES WITH SIGNAL ABORTED ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: RY.fill.cfg.best_scheme.nex.log *** For bug report please send to developers: *** Log file: RY.fill.cfg.best_scheme.nex.log ERROR: *** Alignment files (if possible)ERROR: *** Log file: RY.fill.cfg.best_scheme.nex.log *** Alignment files (if possible) *** Alignment files (if possible) Aborted (core dumped) best Jacopo ", "Hi Jacopo, Someone else also reported this (perhaps same) issue with the likelihood mapping. I could reproduce and localise the bug, but didn\u2019t manage to fix that yet. But it is in my list now. So pls be patient and I\u2019ll get back to you. Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9a8a868d-5943-4421-949d-04a1b0bff62b%40googlegroups.com "]}, "dRRKpz38Rr8": {"topic": "Computing BIC for a list of candidate models in IQ-Tree 2", "initializeDate": "Feb 22, 2020, 6:03:32 AM", "timeStamp": "Feb 23, 2020, 10:28:37 PM", "content": ["Hello, in IQ-Tree 1.x, it was possible to supply a list of extra models to the model selection mode (-m MFP) with -madd, e.g. -m MFP -mset LG -madd LG+C20 would test, in addition to all of the \"LG-based\" models, LG+C20 and use it if it had the lowest BIC. In IQ-Tree 2, it seems like the -madd argument is ignored, with the above command stopping the model comparison after LG+F+R10. Is there a new syntax for asking modelfinder to look at additional models? Thanks, Tom ", "Hi Tom, I confirm that it\u2019s true, thanks for spotting this! It\u2019s due to a heuristic that we newly introduced to filter out non-promissing models, which intefere with -madd option. As a result it will ignore -madd option. We\u2019ll fix this, but for now please add option \u201c--score-diff ALL\u201d to your command line. This will effectly disable the heuristic and test all models, just like version 1.x. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e85e2685-00c9-44b0-af6d-52e124d16961%40googlegroups.com "]}, "oYGQRd-DI7M": {"topic": "topology tests in iqtree", "initializeDate": "Mar 21, 2020, 2:33:43 PM", "timeStamp": "Apr 16, 2020, 3:59:26 PM", "content": ["Hi - I am new to iqtree and want to conduct some topology tests. I want to test a series alignments against a null hypothesis topology, to see if the topology is rejected. Can I do this in iqtree? Second - my hypothesis topology only includes two branches of interest - the relationships within the rest of the tree are not relevant. Can I use two unresolved clades (star tree) from each of these two branches as a test tree? Finally, my alignments have some missing taxa. Is it ok if my test topology has all the taxa included in each alignment but is not tailored to each alignment? Thank you, Scott Edwards ", "Hi Scott, On 22 Mar 2020, at 5:33 am, Scott Edwards < sedw...@g.harvard.edu > wrote: Hi - I am new to iqtree and want to conduct some topology tests. I want to test a series alignments against a null hypothesis topology, to see if the topology is rejected. Can I do this in iqtree? Thanks for your interest. You can run the tree topology tests (e.g. AU test) on a set of tree topologies for each alignment individually. So if you have a series of alignments, I\u2019ll have to do a for-loop. In v2.0 there is an option -S to input a series of alignments, but this option is fairly new and does not work with tree tests yet. Second - my hypothesis topology only includes two branches of interest - the relationships within the rest of the tree are not relevant. Can I use two unresolved clades (star tree) from each of these two branches as a test tree? Yes you can! Multifurcating trees are accepted in IQ-TREE, you just need to turn off the tree search, e.g. with -n 0 option. Otherwise, an error message about NNI not working will occur. Finally, my alignments have some missing taxa. Is it ok if my test topology has all the taxa included in each alignment but is not tailored to each alignment? Unfortunately not, you have to strip taxa from the tree for those alignments that do not have these taxa. Again, it\u2019d be great to do this automatically with -S option, but some coding effort is necessary. Cheers Minh Thank you, Scott Edwards You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8f4070ab-acce-452e-bd60-0d6b7c2ac31a%40googlegroups.com ", "Dear Minh, Belated thanks for these excellent suggestions. The AU tests worked great and I am now a fan of IQ-TREE! So sorry I won't see you in Woods Hole this year but hopefully you are well. I'm impressed with IQ-Tree's interface, model finding capabilities, speed and ease of use. Being able to input multiple alignments from different genes will be a big advance, helpful for coalescent methods. I will use IQ-TREE in my next paper, which I hope to submit soon. Best, Scott ", "Hi Scott, Thanks a lot for the positive comments! It certainly encourages us to continue support the community. Hope that we\u2019ll meet again next year in Woods Hole, when the covid-19 is over hopefully. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGJnDx9OmaR9UT_1VKBB65hJxbozK0d2h1KqO%3DksyE%3DMkjG2OA%40mail.gmail.com "]}, "R7QsnaCP6RE": {"topic": "Constraining tree topology issue", "initializeDate": "Mar 9, 2021, 4:19:39 PM", "timeStamp": "Mar 10, 2021, 6:06:02 PM", "content": ["Hello, I am trying to generate a tree where the topology is completely constrained by a constraint tree and IQ-TREE estimates the branch lengths. I have tried a couple of methods, but the resulting tree seems to still have a different topology to the constraint tree. I have provided details of the methods I have used below. All sequence alignments and the constraint tree contain the same set of 800 species (there are no species in the sequence alignment that are not present in the constraint tree).The constraint tree is provided in a newick file with species names, bootstrap values and branch lengths. It is also a bifurcating tree. The constraint tree was previously generated in IQ-TREE using the following command: iqtree -s large_sequence_alignment -alrt 1000 -bb 1000 -nt 46 The constraint tree was then used to define the topology of the tree being generated for a much smaller sequence alignment. There are many pairs of sequences in this smaller alignment that identical (~50) The two commands I have tried are shown below. The model of evolution I provided was the same as the one used to build the constraint tree in the previous step (identified by IQ-TREE). 1.) iqtree -s sequence_alignment.aln -st DNA -m model_of_evolution -te constraint_tree -nt 46 2.) iqtree -s sequence_alignment -st DNA -m model_of_evolution -g constraint_tree -nt 46 To evaluate whether the output tree has the same topology as the constraint tree, I have had a look in a tree visualisation software (I can see small differences \u2013 there is an example below) and calculated the Robinson-Foulds distance (which is >0). I am not quite sure what I am doing wrong here and any help would be greatly appreciated! Thanks in advance. Best wishes, Lizzie ", "Hi Lizzi, Quick answer: Use -keep_ident option to keep identical sequences in the alignment. The identical seqs are internally removed during the analysis with -g option, and then added back on at the end, but might be another position near another identical seqs. The part of tree you highlighted might be the identical sequences. Moreover, you don\u2019t need to use the constraint tree option -g here. If you already enforce a full strictly bifurcating tree, it does not make sense to use this option. Actually IQ-TREE will issue a WARNING about this, see the log file. Only use it if you have a non-complete tree or a multifurcating tree. Your other run with -te option is valid. Cheers Minh <IQ_TREE_example.png> I am not quite sure what I am doing wrong here and any help would be greatly appreciated! Thanks in advance. Best wishes, Lizzie You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/89420a7d-ca0d-4378-822b-d1566a79a274n%40googlegroups.com <IQ_TREE_example.png> "]}, "zRBJmyk9fHI": {"topic": "AU test ouptut vaules", "initializeDate": "Mar 13, 2019, 3:20:32 PM", "timeStamp": "Mar 14, 2019, 8:34:58 AM", "content": ["Hello, I am using iqtree to do tree topology test in order to get AU p values of the different constrained topologies tested. As trees input I have got 15 constrained topologies + 1 unconstrained topology for each of my loci. I run iqtree with the following command: iqtree -s gene_alignment.phy -z gene_constrainedTopo.tree -te gene_ML.treefile -n 0 -zb 10000 -zw -au In the log file created to what correspond the value RSS d and c? Also what does that mean when there is ! for example: TreeID AU RSS d c 1 0.652 11.210 0.394 0.786 2 0.050 12.818 2.303 0.659 3 0.041 8.619 2.403 0.666 4 0.280 25.042 1.175 0.593 !!! 5 0.308 13.815 0.952 0.451 6 0.452 10.207 0.582 0.461 7 0.695 7.826 0.012 0.521 8 0.054 3.824 2.208 0.601 9 0.018 13.178 2.748 0.660 10 0.056 5.786 2.662 1.069 11 0.069 4.864 2.074 0.587 12 0.133 12.533 1.536 0.425 13 0.379 25.333 1.051 0.743 !!! 14 0.590 15.409 0.274 0.501 15 0.082 2.665 1.777 0.387 16 0.079 4.298 1.687 0.272 Thanks Nicolas ", "Hi Nicolas, Not sure why you want to know, but RSS is the weighted sum of square differences, d and c follows from Shimodaira\u2019s paper, from which to estimate the p-value from the AU test theory. The triple \"!!!\u201d means that RSS is too high and the estimates might not be stable numerically. But I never saw a problem with it. Also Shimodaira never discussed this value. Nevertheless, you should look at .iqtree file for the results. This information is only printed for debugging purpose. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Thank you for the answer. Yes I am looking at the results in .iqtree file. Is there an option to sort the results by their AU p-values for example? I think I saw the information somewhere but If I use iqtree 1.6.10 AU test use ML like CONSEL right? Thanks, Nicolas ", "Thank you for the answer. Yes I am looking at the results in .iqtree file. Is there an option to sort the results by their AU p-values for example? There is no such option. I think I saw the information somewhere but If I use iqtree 1.6.10 AU test use ML like CONSEL right? Yes, that\u2019s right. Cheers, Minh Thanks, Nicolas "]}, "EtaygvNj1qo": {"topic": "BOOSTER / -tbe issues", "initializeDate": "Apr 23, 2019, 10:07:51 AM", "timeStamp": "Apr 25, 2019, 11:37:31 PM", "content": ["Hi all, I'm trying to run an analysis using BOOSTER / -tbe with the PMSF model (LG+C20+G+F; including specifying a tree -ft) with but the output produced has no bootstrap support values. Would someone be willing to share a sample command / input & output data that worked correctly with this approach. What should be provided to the -tbe flag? I tried using the bootstrapping output from the RAxML run I used to produce the -ft tree, but maybe that's the problem? Thanks! Kevin Kocot ", "Hi Kevin, Did you specify the number of bootstrap replicates with -b option? Otherwise, --tbe has no effect. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "Gtno1oFH-pI": {"topic": "Fixing models a priori", "initializeDate": "Aug 22, 2017, 3:00:44 PM", "timeStamp": "Aug 23, 2017, 9:27:47 AM", "content": ["Hi all, Is there a way to fix the models a priori without estimating them de novo in IQTREE using the command -m? In practice we have already estimated the models for >>1000 partitions in an independent run with the same dataset and settings using the TESTNEW command. Ideally we would like to skip the estimation of models for future runs by providing the models already estimated in IQTREE. Is there way to do this and if yes how to should the input file look like? Cheers Emmanuel ", "Hi, If I understood your question properly, I think you have got a *.best.scheme.txt file as (one among the many) output of the model test run. This should have the correct way to specify the models. So you need not do it once again simply choose that file as your input for -sp option. Else see this section of the documentation ( http://www.iqtree.org/doc/Advanced-Tutorial#choosing-the-right-partitioning-scheme ) to find how to set the models for partitions in the charpartition specifications. Then I guess you need not input the -m part in your command line. Hope this helps, PS: please of ore this reply if this is not what you wanted. I think the developers will have some more things to say. philipS You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Emmanuel, PhilipS is right, thanks! There is a .best_scheme.nex file generated by ModelFinder, which stores the best partition model. You can input this partition file (e.g. -spp option) and skip this step for subsequent analysis (here -m is not required). Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "-703-UcXcfg": {"topic": "Test if SSR or Codon Model is better", "initializeDate": "Jan 10, 2018, 4:28:34 AM", "timeStamp": "Jan 12, 2018, 3:30:52 PM", "content": ["Hello all, I want to test if a SSR (singel site rate) or a codon model is better for a protein coding MSA. For normal I start 2 tree inference runs for 2 best trees, one with best fit SSR model, one with best fit codon model, and test which one is better. Is there a way I can test if a SSR or a codon model is better with IQ-Tree without doing the tree inference runs? All the best Dieter ", "Hi Dieter, Can you explain what is an SSR model? Is this the DNA model applied to the protein coding gene? The bottom line: the log-likelihoods computed for a DNA and a codon model (for the same protein coding MSA of course) are directly comparable. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hello Minh, Thank you for your note. Yes, with SSR I mean splitting the DNA MSA, which consists of protein coding Codons into Codon position 1, 2 and 3 and then applying an standard DNA model to each Codon position partition. MrBayes calls that \"SSR\" in the manual so I used it too. It's great to knoow that the -log-likelihoods are comparable - I guessed this before but I was unsure. This will save a lot of time in future. All the best Dieter ", "OK I see, then the log-likelihoods and the AIC/BIC between SSR and codon models are fully comparable. Quick comment: SSR (single site rate) is not an intuitive name, but your description is sufficient to understand. Cheers, Minh ", "Thank you Minh, That really helped. All the best Dieter "]}, "u1U310vWp6U": {"topic": "does anybody have an example Binary data file 0 and 1s", "initializeDate": "Feb 1, 2017, 7:54:56 AM", "timeStamp": "Feb 1, 2017, 11:42:17 AM", "content": ["I want to try IQ-TREE with some binary data but cannot figure out which of the import formats will be accepted. The format of the data is Taxa1 010101001 Taxa2 110101010 etc will phlyip format work or is Nexus the only one. I did search the help but did not find anything on this, Thanks for any help Guy ", "Dear Guy, IQ-TREE should read all common formats also for binary data. For your example: Phylip: 2 9 Taxa1 010101001 Taxa2 110101010 Fasta: >Taxa1 010101001 >Taxa2 110101010 Of course you should have more than 2 sequences. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thanks alot worked great "]}, "D2l5OSvEOVc": {"topic": "Prevent truncation of taxa names", "initializeDate": "Jul 9, 2019, 8:43:48 PM", "timeStamp": "Jul 10, 2019, 11:57:07 PM", "content": ["Thanks in advance for dealing with this, but I was wondering if there was an argument for preventing iqtree from truncating lengthy taxa names or at least specifying the length they can be? Attached is an example where, rather than the accession numbers alone, I am needing to keep the clone, isolate IDs, and country of origin information following. I know this is something I can easily do using a scripted find and replace, but I was just curious as to whether there was a solution that could simply be used during iqtree execution alone. Thanks again! ", "Hi, There is no way to do that. When reading a FASTA file, IQ-TREE will discard parts of the sequence name after the first empty space or tab character. Because this is typically extra description. You can, as you said, replace empty spaces with underscore to keep the rest part of the names. Cheers Minh On 10 Jul 2019, at 10:43 am, Brittany Rife Magalis < brma...@gmail.com > wrote: Thanks in advance for dealing with this, but I was wondering if there was an argument for preventing iqtree from truncating lengthy taxa names or at least specifying the length they can be? Attached is an example where, rather than the accession numbers alone, I am needing to keep the clone, isolate IDs, and country of origin information following. I know this is something I can easily do using a scripted find and replace, but I was just curious as to whether there was a solution that could simply be used during iqtree execution alone. Thanks again! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0490df3c-85c7-4aa1-b70a-e6a87c9c5c2b%40googlegroups.com For more options, visit https://groups.google.com/d/optout <final_HIVenv_calign.fasta> "]}, "bYpJD7r5coY": {"topic": "iq-tree outputs", "initializeDate": "May 19, 2020, 3:22:29 AM", "timeStamp": "May 21, 2020, 8:49:28 PM", "content": ["Hey, I'm trying to better understand iq-tree outputs... The process is still running but I see two outputs: tree.tre.bionj tree.tre.treefile I guess the bionj stands for the bionj tree :) but though the the tree.file stands for the parsimony tree. But the treefile was created before \"Generating 98 parsimony trees...\" was written to the log file (and its till running), so I guess it's not the parsimony tree. So what is it actually contains? Best, ", "Hi there, Have you looked at the beginner tutorial: http://www.iqtree.org/doc/Tutorial In short, treefile is the maximum likelihood tree. BIONJ and parsimony are used to get the starting trees only. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/611ec407-bc29-477f-9f0d-1f4e96dc53da%40googlegroups.com ", "Thanks Minh, Sure, I've looked at the documentation. I'm still confused, so I'll rephrase the question- in all test trees I've executed the .treefile was similar to the tree within the final .iqtree file. In this case the treefile was created few days ago and iqtree is still running (currently- Generating 98 parsimony trees), so if the ML tree and bionj were already calculated and written the treefile and bionj files respectively, what is being done with the parsimony trees being calculate? Best On Tuesday, May 19, 2020 at 10:41:33 AM UTC+3, Minh Bui wrote: Hi there, Have you looked at the beginner tutorial: http://www.iqtree.org/doc/Tutorial In short, treefile is the maximum likelihood tree. BIONJ and parsimony are used to get the starting trees only. Minh On 19 May 2020, at 5:22 pm, wild < yis...@wildbio.tech > wrote: Hey, I'm trying to better understand iq-tree outputs... The process is still running but I see two outputs: tree.tre.bionj tree.tre.treefile I guess the bionj stands for the bionj tree :) but though the the tree.file stands for the parsimony tree. But the treefile was created before \"Generating 98 parsimony trees...\" was written to the log file (and its till running), so I guess it's not the parsimony tree. So what is it actually contains? Best, You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi there, I\u2019m just guessing: are you using the constraint tree option (-g) and using IQ-TREE v1? If yes, please switch to v2. v1 is stuck (very slow) at this step \u201cgenerating parsimony trees\u201d for large trees (with many taxa). Whereas v2 fixes this issue. To your question: During the run iqtree will gradually improve the tree, and the current best tree is always written to .treefile. That way, if it runs for days, users can still look at the treefile to monitor the changes. And at the end when the run completed, the best tree will be written to .iqtree and treefile. So they must be the same. Does that answer your question? Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/da1db7d4-9aa3-4ce6-9844-ddffcd501904%40googlegroups.com "]}, "NUKYfbQk78M": {"topic": "ERROR: Number of Likelihood Mapping groups too high", "initializeDate": "May 8, 2018, 6:53:47 AM", "timeStamp": "May 10, 2018, 7:32:48 AM", "content": ["Dear IQTREE developers, Implemented the latest version of IQTREE with --runs option, there was an error: ERROR: Number of Likelihood Mapping groups too high! PLEASE report this to the developers! So, I would like to report to you. If you want to know for details, please inquire me. Best regards, Giap Nguyen ", "Dear Giap, Could you please give more details about what you did? What was the command line you have used. How did you define the groups for likelihood mapping? What was the intention to combine the runs option with likelihood mapping. Best regards, Heiko Schmidt > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Good morning! I invoked the command like this: iqtree -s my_align -m MFP -lmap 10000 -bb 1000 --runs 10 I used -lmap option which would like to check whether the data was sufficient or not for phylogenetic tree (middle < 23%, as it was suggested somewhere). I just tried --runs option, because from the IQTREE website, it was recently suggested. Best regards, Giap Nguyen ", "Dear Giap, --runs option does not work with -lmap yet, because it\u2019s meant for multiple tree searches. So please avoid doing this at the moment, but we will fix later, i.e. by not doing multiple likelihood mapping analysis. Cheers, Minh "]}, "ym-Ahc849ks": {"topic": "ModelFinder", "initializeDate": "Jan 15, 2018, 7:59:35 AM", "timeStamp": "Jan 18, 2018, 3:36:06 PM", "content": ["Hi all, I am using currently a large dataset (~ 130 taxa, ~ 3900 partitions (domions) in ModelFinder why I used earlier PartitionFinder for merging. The output I get do not merge any partitions (command that I used (version 1.5.5) (I am aware of branch length unlinked) is: iqtree-omp -s XX.fas -st AA -spp XXpartition.nex -pre LALA -nt XX -m MF+MERGE -rcluster 100 -msub nuclear -mrate E,I,G,I+G,R -cmin 2 -cmax 10 -madd LG4X -gmedian -merit AICc -safe Is there something wrong? Or better: why was nothing merged ? surprised that its so much differing from e.g. PartitionFinder (although partitions have similar models) I think there was already a comment on this issue, but I cannot find it anymore. I would assume that at least something is merged, but also cannot see somethinmg iin the log file... Thanks Karen ", "Hi Karen that is likely due to the discrepancy between edge linked vs unlinked model selection. Thus can you pls test ver 1.6 that now implements the edge linked as specified? Minh ps: I will be offline for two weeks. Pls expect delay in response. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh,, ok thanks 1) hm ok :-/. its a huge dataset but will rerun again in 1.6.1 - is that ok? Is there a specific command in addition? and is it tested now? is this parallilized with mpoi or not? (I guess not!?) 2) still have to send a dataset for testing, so sorry for the delay best karen ", "Hi Karen, I got the test data sets directly from Rob, and ModelFinder gave the same result as PartitionFinder. So I would say it\u2019s working fine. So please go ahead doing ModelFinder with your data set. Cheers, Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, ok many thanks! I will give it a try, rerun and let you knwo/keep you updated. many thanks!!! cheers karen ", ""]}, "OfU8ue3QDOw": {"topic": "Why did my iqtree program termination unnormally?", "initializeDate": "Sep 11, 2019, 11:24:58 PM", "timeStamp": "Sep 11, 2019, 11:24:58 PM", "content": ["Dear Sir I carried out a Maximum Likelihood (ML) analysis using iqtree-1.6.11-Linux. I submited the task via PBS. After nearly 12 hours run, the progress suddenly terminated. .err file are as follows: Can't find file /XX/home/XXX/.vnc/mu01:69.pid You'll have to kill the Xvnc process manually The first 10 lines and last 10 lines of the .log file are as follows: IQ-TREE multicore version 1.6.11 for Linux 64-bit built Jun 6 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: c0401 (SSE4.2, 125 GB RAM) Command: /xx/soft/iqtree-1.6.11-Linux/bin/iqtree -s /xx/soft/iqtree-1.6.11-Linux/aligned.fas -m GTR+F+I+G4 -b 100 -alrt 1000 -nt 24 Seed: 694114 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Sep 11 11:12:37 2019 Kernel: SSE2 - 24 threads (32 CPU cores detected) Estimate model parameters (epsilon = 0.100) BETTER TREE FOUND at iteration 71: -316216.868 Estimate model parameters (epsilon = 0.100) BETTER TREE FOUND at iteration 78: -316205.451 Iteration 80 / LogL: -316513.769 / Time: 0h:29m:4s (0h:36m:1s left) Estimate model parameters (epsilon = 0.100) BETTER TREE FOUND at iteration 84: -316204.760 Iteration 90 / LogL: -316311.688 / Time: 0h:31m:54s (0h:33m:40s left) Estimate model parameters (epsilon = 0.100) BETTER TREE FOUND at iteration 93: -316155.966 I do not konw how to solve this problem. Could you give me a hand\uff1f Thanks hiccup "]}, "oW6NSGcVgK8": {"topic": "Bootstrap <1%issue", "initializeDate": "Jul 7, 2019, 9:55:04 PM", "timeStamp": "Jul 9, 2019, 1:42:05 AM", "content": ["Hello, I have created an IQ bootstrap tree, by bootstrapping my alignment and then running 100 trees: iqtree -sup 2.1.iqtree.c10.pmsf.fasttreeStart.rooted.tree boot_trees_100x.trees Then I concatenated all trees into one file and used it to map the BS values onto my snapshot tree: module load iqtree iqtree -sup snapshot.tree boot_trees_100x.trees The strange thing is that there is a trail for <1% BS that goes from the root all the way to one genus (see screenshot). I am confident that most of these <1% BS values are nonsense, since I get good support using other methods. This seems a very odd problem, but I was wondering did anyone of you ever encounter something like this? Cheers, Chris ", "Hi Chris, That looks strange. Before we can help, can you please paste the command line used to compute the bootstrap trees? Can you also send the newick tree file used to generate this figure? Did you follow this FAQ: http://www.iqtree.org/doc/Frequently-Asked-Questions#how-do-i-save-time-for-standard-bootstrap Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8a0b29a1-08ed-4327-ae8b-8ce6229e7ddc%40googlegroups.com For more options, visit https://groups.google.com/d/optout <IQtree_artifact_BS.gif> ", "Hi Minh, the command was (100 in total): iqtree -s boots/bootstrap_aln.1.faa -nt AUTO -m LG+C10+F+G -ft 01.fasttree.1248x.wag.g.tree -pre bootstrap_aln.1_pmsf .... iqtree -s boots/bootstrap_aln.100.faa -nt AUTO -m LG+C10+F+G -ft 01.fasttree.1248x.wag.g.tree -pre bootstrap_aln.100_pmsf (sorry, I had the wrong command in my first email) # concatenate trees into one file cat *.treefile > boot_trees_100x.trees # newick file attached <boot_trees_100x.trees> # Create BS tree file module load iqtree iqtree -sup 2.1.iqtree.c10.pmsf.fasttreeStart.rooted.tree boot_trees_100x.trees # newick file attached <boot_trees_100x.trees.suptree> # Decorate tree # in house script, newick file attached <3.iqtree.c10.pmsf.fasttreeStart.BS.decor.tree> Best, Chris On Monday, 8 July 2019 19:55:28 UTC+10, Minh Bui wrote: Hi Chris, That looks strange. Before we can help, can you please paste the command line used to compute the bootstrap trees? Can you also send the newick tree file used to generate this figure? Did you follow this FAQ: http://www.iqtree.org/doc/Frequently-Asked-Questions#how-do-i-save-time-for-standard-bootstrap Cheers, Minh On 8 Jul 2019, at 11:55 am, Christian Rinke < christi...@gmail.com > wrote: Hello, I have created an IQ bootstrap tree, by bootstrapping my alignment and then running 100 trees: iqtree -sup 2.1.iqtree.c10.pmsf.fasttreeStart.rooted.tree boot_trees_100x.trees Then I concatenated all trees into one file and used it to map the BS values onto my snapshot tree: module load iqtree iqtree -sup snapshot.tree boot_trees_100x.trees The strange thing is that there is a trail for <1% BS that goes from the root all the way to one genus (see screenshot). I am confident that most of these <1% BS values are nonsense, since I get good support using other methods. This seems a very odd problem, but I was wondering did anyone of you ever encounter something like this? Cheers, Chris You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Chris, Can you pls also send this tree: 2.1.iqtree.c10.pmsf.fasttreeStart.rooted.tree It could be a problem in this file, or your in-house script. Everything else looks fine. Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d5f73777-9a3e-4f63-b660-4671d37514c5%40googlegroups.com For more options, visit https://groups.google.com/d/optout <boot_trees_100x.trees> <3.iqtree.c10.pmsf.fasttreeStart.BS.decor.tree> <boot_trees_100x.trees.suptree> ", "Thanks Minh, the tree is attached. Minh ", "Alright, I could reproduce this now. My next question is: how did you reconstruct this tree? When I computed a consensus tree from 100 bootstrap trees with: iqtree-test -con boot_trees_100x.trees I don\u2019t see such \u201ctrail\u201d anymore. All branches of the consensus tree have okey supports, mostly > 50%. So I conclude there is something wrong with the tree you used to map the support values onto. Alternatively, you can use the consensus tree. Cheers Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/55509013-6df4-4516-b7e5-429024b3b748%40googlegroups.com For more options, visit https://groups.google.com/d/optout <2.1.iqtree.c10.pmsf.fasttreeStart.rooted.tree> "]}, "qoRYiIH-2sM": {"topic": "testing mixture model GTR*Hn", "initializeDate": "Jun 15, 2017, 6:26:57 PM", "timeStamp": "Jun 17, 2017, 8:15:10 AM", "content": ["Hello, I am curious about the GHOST model (Crotty et al.) that is implemented in IQ-TREE. It appears that setting -m GTR*Hn (where n is a number, say, 4) in IQ-Tree appropriately allows setting of this model and searches for the maximum likelihood tree on the example data. However, the Crotty et al. thesis suggests that the model fit should be tested independently multiple times, and that a range of n should be tested. I assume that it is possible, like with basic models with the -m MF setting, that only inferring the ML tree once the best model is found will save on computation. Hence, I am curious if there is a way to simply test the model fit of these heterotachy mdoels without performing the ML tree search. Thanks! ", "Hi Milton, Thanks for your question, I am happy to see that some users are interested in trying out the GHOST model. As yet we have not implemented the heterotachy models with the model finder option. So unfortunately there is no shortcut currently to save computation time. You will have to test different models of sequence evolution and different numbers of classes as I did in my thesis. I used AIC to determine the best fit but of course you can use some other criterion if you prefer. I\u2019d be happy to hear any feedback from you about how the model works for your data and any other problems you might notice. Thanks, Stephen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "o-G_O59O4sY": {"topic": "problem with the output of an ancestral sequence estimation (ASR) analysis, data set with indels", "initializeDate": "Jun 4, 2020, 2:03:05 PM", "timeStamp": "Jun 5, 2020, 3:05:08 AM", "content": ["Hi, I'm doing an estimation of ancestral sequences at every node of a tree that I built via IQtree. My data set corresponds to aligned nucleotide sequences (CDS), of which a central part (minimal in terms of size: ~<5% of the total sequence length) corresponds to a site of biologically known insertions: codon duplications and recombination). By using the indicated command, specifying at the same time my alignment, my phylogenetic tree and the best-estimated substitution model, I was able to obtain all the output files for an ASR analysis, with the different states for each internal node of my tree at each nucleotide position (with posterior probabilities, in table format). My problems are the following. By doing a little manipulation to convert this table into a fasta file and by doing an alignment of my computed ancestral sequences, I obtained some quirks: First of all, all the estimated sequences are longer than expected. I have the impression that IQtree interpreted the deletions present at the central part of the majority of my descendant sequences as missing information, and then, seems to have added codons artificially for the estimated ancestral sequences, as some descending sequences have insertions at this region. Is this the expected behavior of IQTree with this type of data (alignment with indels)? Moreover, for some computed ancestral sequences, a stop codon appears in the same region encoding the indels (that it is already known as insertion sites), which it is not biologically possible for these ancestors. I have the impression here also that this problem is related to the previous observation. Still, I would need a confirmation, in particular, on the behavior of IQTree when it deals with an alignment with indels. Obviously, I can pass on further information about this analysis if needed. Best regards, Gabriel ", "Hi Gabriel, I think I understand what\u2019s happening, and I think it\u2019s to do with how gaps are treated in ML inference, but just to be sure I\u2019ll start by clarifying. Let\u2019s imagine your alignment is like this: seq0 AACTTTGGG seq1 AACTTTGGG seq2 AAC---GGG seq3 AAC---GGG And the tree looks like this: ((seq0, seq1),(seq2,seq3)) If we focus on the node that is the MRCA of seq2 and seq3, the ancestral state reconstruction should be AACTTTGGG My guess is that you were expecting: AAC---GGG If I understood your question correctly, it is along the lines of \u201cWhy does the ASR have \u2018TTT\u2019 instead of three gaps\u201d? I\u2019ll answer that question, but of course do tell me if this is not what you were really asking. (In that case, please provide an example something like this so we can clarify). The reason the ASR for the MRCA of seq2 and seq3 contains the TTT is because ML inference treats gaps as N\u2019s. What this means is that we sum the log likelihoods of all possible states where we see a gap. Since the other two sequences in the alignment have T\u2019s at this point, assuming a sensible model of molecular evolution, we would find that most of the likelihood for the gapped sites comes from the T, with perhaps a tiny little bit from each of the other three bases (how much will depend on the branch lengths, details of the model, etc). So, inside the ML inference these gapped sites will be treated as most likely to be T\u2019s, which means that the MRCA of seq2 and seq3 will similarly have most of the likelihood assigned to T\u2019s for this site. This, of course, raises another question. Why on earth would ML inference treat gaps as N\u2019s? The answer to this is that we don\u2019t have good models of indels to use in our analyses. And since ML is a model-based inference, that means we can\u2019t treat indels as indels. So, in all phylogenetic software based on likelihood (e.g. IQ-TREE, RAxML, MrBayes, BEAST), gaps are treated as N\u2019s. Hopefully that helps a bit. On your other question - I imagine (but am not 100% sure) that the answer is that there is nothing stopping the ASR from inferring a stop codon. If the most likely codon is a stop codon, that\u2019s what it will infer. But Minh et al will know more about that. Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/3ea9a966-a1f7-4b0a-93b1-df296dc36640o%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Hi Gabriel, Rob gave an excellent answer! Re. appearance of stop codons in ancestral sequences: Did you use DNA or codon model? For DNA models that might happen \u2014 it\u2019s just not aware of any stop codons. But if you used codon models, that can\u2019t happen, because stop codons are not in the admissible set of states. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmoM%2B_VGGtAAMVcNfRWTtsbK2AybubzsynWBqv%2BKWaajPQ%40mail.gmail.com "]}, "vrp5GvaZo5o": {"topic": "Choose Models and estimate gene trees for alignments in a directory", "initializeDate": "Aug 10, 2020, 6:48:20 PM", "timeStamp": "Aug 13, 2020, 8:29:13 PM", "content": ["Hi all, I am trying to choose models and estimate trees for all alignments in a directory using IQ-Tree v2.0.6 (Linux). I am running the following command: iqtree2 -S [path to alignment folder] -m MFP -c 8 -redo -pre July14 During the model selection stage, I get an error, but I am not sure what the cause is. Below, I have copied the first ten and last 15 lines (which include the error) of the .log file. Any insight you can provide would be greatly appreciated! The error message said to post alignment files if possible, but I am running this on > 12,000 alignments. Is there a simple way to figure out on which alignment the error is occurring? First ten lines of log file: IQ-TREE multicore version 2.0.6 for Linux 64-bit built May 30 2020 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: c44 (AVX2, FMA3, 251 GB RAM) Command: ../Programs/iqtree-2.0.6-Linux/bin/iqtree2 -S /N/slate/mls16/PRIMATE_DATA/Available_14July2020/ -m MFP -c 8 -redo -pre July14 Seed: 457686 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Mon Aug 10 16:43:17 2020 Kernel: AVX+FMA - 8 threads (8 CPU cores detected) Last ten lines of log file: Estimate model parameters (epsilon = 1.000) Estimate model parameters (epsilon = 1.000) Estimate model parameters (epsilon = 1.000) Estimate model parameters (epsilon = 1.000) Estimate model parameters (epsilon = 1.000) Estimate model parameters (epsilon = 1.000) ERROR: ERROR: ***Estimate model parameters (epsilon = 1.000) QTREE CRASHES WITH SIGNAL SEGMEEstimate model parameters (epsilon = 1.000) NATION FAUEstimate model parameters (epsilon = 1.000) LATION FAUEstimate model parameters (epsilon = 1.000) ERROR: *** For bug report please send to developers: ERROR: *** Log file: July14.log ERROR: *** Alignment files (if possible) Thank you! Sincerely, Megan Smith ", "Hi Megan, Can you send me the log file via my email? In the mean time, can you please run without using -S option? Just to see if that works. That means, do a for loop to run iqtree2 on every alignment, separately. That way, you can figure out which alignment caused the problem. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/dabd8c55-2bfb-43cc-a811-ec36d84a502en%40googlegroups.com "]}, "zoe94jt7KqE": {"topic": "crash on large dataset because of saturated partition rates", "initializeDate": "May 23, 2018, 10:08:16 AM", "timeStamp": "Jun 6, 2018, 11:40:05 PM", "content": ["Hi, I used iqtree with these commands : IQ-TREE multicore version 1.6.3 for Linux 64-bit built Mar 22 2018 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: bradypus333-swag (AVX2, FMA3, 31 GB RAM) Command: iqtree -s params_datasetRev90_66samples_clean_Mindepth5Wclust.89MinCov7MaxSH.50.phy -spp params_datasetRev90_66samples_clean_Mindepth5Wclust.89MinCov7MaxSH.50.phy.partitions -nt 7 -safe -v Seed: 507280 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed May 23 14:35:38 2018 Kernel: Safe AVX+FMA - 7 threads (8 CPU cores detected) ...on a really large dataset (RAD-seq) of 66 terminals with 3107612 columns. I first applied ModelFinder on a 36282 partitions scheme and then I ran the analysis with the best model for each partition. At some point iqtree crashes and give me these lines : WARNING: Too high (saturated) partition rates for proportional partition model! [...] ERROR: phylotree.cpp:2631: virtual double PhyloTree::optimizeAllBranches(int, double, int): Assertion `fabs(new_tree_lh-tree_lh) < max_delta_lh' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: params_datasetRev90_66samples_clean_Mindepth5Wclust.89MinCov7MaxSH.50.phy.partitions.log ERROR: *** Alignment files (if possible) Is there any strategy to apply for such large datasets? Thanks! ", "Hi Paul, Thanks for the report. Can you pls send me the full log file via my personal email? Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Paul, After examining the log file, it becomes clear that you have an over-parameterized partition model with too many short partitions (almost all < 100bp). During the parameter optimisation, some partitions show a rate of >6000 whereas the rest have zero rate. This causes numerical problems (as the WARNING suggested). So I suggest that you do some PartitionFinder algorithm to merge the partitions first, before tree reconstruction, as follows. Since this is a huge data set (>30,000 partitions), you can: 1. Do partition model selection with fast rcluster algorithm and restricting candidate models to reduce run time: iqtree -s ALIGNMENT -spp PARTITION -m TESTMERGEONLY -rclusterf 5 --rcluster-max 5000 -mset GTR 2. Take the .best_scheme.nex file generated above and perform a more thorough model selection followed by tree reconstruction: iqtree -s ALIGNMENT -spp PREVIOUS_RUN.best_scheme.nex -m TEST And use a strong computer with many cores for this big analysis. Let me know if it works. Cheers, Minh "]}, "msoRXaipMDg": {"topic": "AU tests with -te option", "initializeDate": "May 15, 2020, 7:57:10 AM", "timeStamp": "May 17, 2020, 9:16:20 AM", "content": ["Hi, just a quick question: when doing the AU tests but providing a fixed topology (with -te) but still test e.g. 4 different trees, how exactly does this effect the result comparing to providing no fixed topology? Are simply with -te the logLHs calcuated for this topology and compared to the ones providing via -z? Also (since I used version 1.4.4. (for an old dataset) and long ago: can you again quickly refer to what I should cite/write since these p values are not similar to the ones e.g. implemented in tree puzzle (i think this was just changed in 1.6.9) ? MANY THANKS, Karen ", "sorry, I used 1.5.0 not 1.4.4 - or would you recommend to quickly repeat it with 1.6.9 and/or higher and then without -te option? ", "Hi Karen, On 15 May 2020, at 9:57 pm, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Hi, just a quick question: when doing the AU tests but providing a fixed topology (with -te) but still test e.g. 4 different trees, how exactly does this effect the result comparing to providing no fixed topology? This is the behaviour: 1. With -te option: IQ-TREE will use the given input tree to estimate model parameters, which are then fixed to optimize the branch lengths of the trees in the set (-z option). 2. Without -te and with -n 0: iqtree will use a parsimony tree to estimate model parameters. The rest is the same. 3. Without -te and without -n 0: IQ-TREE will fully infer an ML tree, having model parameters estimated on ML tree and use these to optimize the tree set. So the only difference is the tree used to get the model parameters. The 3rd way is most thorough but takes time. So if you already have some tree, do the 1st and if not, do the 2nd. Because model parameters are quite stable: as long as you have reasonable tree, it should be OK. Are simply with -te the logLHs calcuated for this topology and compared to the ones providing via -z? No. As said above, -te is only used to get model parameters. IQ-TREE will then only compare the trees in the -z option. Also (since I used version 1.4.4. (for an old dataset) and long ago: can you again quickly refer to what I should cite/write since these p values are not similar to the ones e.g. implemented in tree puzzle (i think this was just changed in 1.6.9) ? Yes, please double check with the latest v1.6.12 to make sure things are OK. But I\u2019d like to point out that, this only effects corner case, i.e., when delta log-likelihood is nearly 0. Cheers Minh MANY THANKS, Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4a0779b9-4cb7-4da9-974d-3a391fbc9ec8%40googlegroups.com ", "ok great. Many thanks Minh :) Hi Karen, To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "M0JR-ehkucM": {"topic": "Wrong model name *R4*R4", "initializeDate": "Nov 15, 2015, 1:36:42 PM", "timeStamp": "Nov 16, 2015, 12:11:32 PM", "content": ["Dear IQ-TREE developers, I am running the phylogenetic analysis of a concatenated dataset (\u02dc60 genes, and 500 taxa, i.e. around 70,000 sites, dataset is big and I haven't tried on a smaller one for now). I first estimated appropriate models for my gene partitions using the options \"-m TESTNEWONLY -madd LG4M,LG4X\". It worked and I obtained a .nex file with the partition scheme and the models estimated to be the best for each partition. Now I want to run a tree using the obtained models with this command line: iqtree -s concatenat.phy -sp concatenat.nex.best_scheme.nex -st AA -bb 1000 -nt 12 -wpi After the partitions and models were properly read. I obtained the following error twice for two slightly different datasets: ------ Reading partition part59 (model=LG4X*R4, aln=, seq=AA, pos=14991-15090) ... 461 sequences and 100 sites extracted Concatenated alignment was printed to /tmp/sabby_iqtree_modeltestNEWonly_lg4m_lg4x_mafft-bls30_taxa_to_rm_2_TREE/concatenat_59coregenes-mafft-bls30+450genomes_single_copygenes_RM_taxa_to_rm_2.nex.best_scheme.nex.conaln Degree of missing data: 0.014 Create initial parsimony tree by phylogenetic likelihood library (PLL)... 27.317 seconds Generating 1000 samples for ultrafast bootstrap... Max candidate trees (tau): 46300 Model LG4X*R4 is alias for MIX{LG4X1,LG4X2,LG4X3,LG4X4}*R4*R4 ERROR: Wrong model name *R4*R4 ------ Do you have an idea on what is happening? I've joined the alignment, the .nex files and the log file. Many thanks in advance for your help, and thanks for developing IQ-TREE! Best regards, Sophie ", "Dear Sophie, Thanks for reporting this problem\u2026 As a quick fix, can you please edit the ...best_scheme.nex partition file and manually replace all occurrences of \u201cLG4X*R4\u201d by \u201cLG4X\u201d and \u201cLG4M*G4\u201d by \u201cLG4M\u201d? This should resolve it\u2026 I will include this fix in the future release. The bottom line is that LG4X and LG4M implicitly assume FreeRate and Gamma rate model, respectively. Thus adding *R4 or *G4 is redundant. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <concatenat.nex.best_scheme.nex> <concatenat.nex.best_scheme.nex.log> <concatenat.phy> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Thank you very much, this seems to work with the replacement you suggested (at least it's been running for almost the whole day now, much longer than with the wrong model error). I keep you posted when the job is finished! Cheers, Sophie "]}, "PVIPZ7Md3KU": {"topic": "initial parsimoney tree", "initializeDate": "Aug 25, 2019, 9:08:25 AM", "timeStamp": "Aug 26, 2019, 9:31:37 AM", "content": ["Dears I am facing a problem during the initiization parsimoney tree construction after model selection, the server use only 3CPU, so for constructiong tree with thousand sequences takes too much time. is there any parameter that may enhance the thread number during initializing parsimoney tree construction. we have 82CPU for parallel threading. thank you Athar ", "Hi Athar, The default parsimony tree construction uses the PLL libary, that is not parallelised. You can switch to own parsimony kernel with -t PARS option. This should speed it up substantially using all cores. Moreover, there is some advice on taxon-rich data set, see the NOTE in this section: http://www.iqtree.org/doc/Command-Reference#tree-search-parameters Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/a18cb38c-b15e-45cc-a688-c28ac191bfc4%40googlegroups.com "]}, "lPG9by0OpEA": {"topic": "failed in modelfinder", "initializeDate": "Jun 28, 2019, 11:20:41 PM", "timeStamp": "Jul 2, 2019, 3:49:14 AM", "content": ["It works in 3 gene matrix\uff0cbut failed in 62 genes. Is there anyone who have time to give me some suggestion? Thanks! Host: DESKTOP-4QC0DVO (AVX2, FMA3, 63 GB RAM) Command: bin\\iqtree -s n20dal.phy -m MF -nt AUTO Seed: 134096 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Fri Jun 28 16:03:17 2019 Kernel: AVX+FMA - auto-detect threads (12 CPU cores detected) Reading alignment file n20dal.phy ... Phylip format detected Alignment most likely contains protein sequences WARNING: 1 sites contain only gaps or ambiguous characters. Alignment has 20 sequences with 47119 columns, 14598 distinct patterns 25073 parsimony-informative, 7627 singleton sites, 14419 constant sites Gap/Ambiguity Composition p-value 1 FauNEOPT 13.33% failed 0.00% 2 LfoCHILO 13.10% failed 0.00% 3 LpoXIPHOS 13.13% failed 0.00% 4 MgaARACH 13.21% failed 0.00% 5 NamDIPLO 13.51% failed 0.00% 6 OstOST 13.01% failed 0.00% 7 PaqCOLL 13.37% failed 0.11% 8 StuREMI 13.20% failed 0.00% 9 DmaBRANCH 13.10% passed 84.89% 10 HmaCEPHAL 12.32% failed 0.00% 11 ScolCHILO 13.37% failed 0.00% 12 SpoCHILO 13.44% failed 0.00% 13 AmaDIPLO 13.26% passed 99.24% 14 Han2SYMPH 13.42% failed 0.00% 15 Pge2DIPLO 12.82% failed 0.00% 16 Pol2DIPLO 13.04% failed 0.00% 17 Scu3SYMPH 13.21% failed 0.00% 18 Col2PYCNO 12.93% failed 0.00% 19 Ctas2CHILO 13.32% failed 0.00% 20 EuryPAURO 13.32% failed 0.00% **** TOTAL 13.17% 18 sequences failed composition chi2 test (p-value<5%; df=19) Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.109 seconds NOTE: ModelFinder requires 451 MB RAM! ModelFinder will test 546 protein models (sample size: 47119) ... No. Model -LnL df AIC AICc BIC Measuring multi-threading efficiency up to 12 CPU cores Increase to 10 rounds for branch lengths 21 trees examined Threads: 1 / Time: 12.341 sec / Speedup: 1.000 / Efficiency: 100% / LogL: -935133 (FauNEOPT:0.0861668353,(((((LfoCHILO:0.0526173546,(ScolCHILO:0.0611790508,(SpoCHILO:0.0761707159,Ctas2CHILO:0.1122432335):0.0165150318):0.0106031376):0.0127779567,(((LpoXIPHOS:0.0933324633,MgaARACH:0.1038009172):0.0454104437,(OstOST:0.1393593461,StuREMI:0.1163944343):0.0376380640):0.0116898091,NamDIPLO:0.0553629371):0.0242750003):0.0198689141,(((AmaDIPLO:0.0676351086,(Pge2DIPLO:0.1242395492,Pol2DIPLO:0.1532807224):0.0302866278):0.0272275184,(Han2SYMPH:0.0735391199,Scu3SYMPH:0.0729860441):0.0279327799):0.0367403485,EuryPAURO:0.1491317583):0.0412090034):0.0380166039,(PaqCOLL:0.1560448170,Col2PYCNO:0.1530822207):0.0585503395):0.0247971878,DmaBRANCH:0.1201145706):0.0645290081,HmaCEPHAL:0.3752526841); new_tree_lh: -865423.1692921221 tree_lh: -863818. 5083998179 ERROR: C:\\Users\\minh\\Dropbox\\iqtree-git\\tree\\phylotree.cpp:2652: virtual double PhyloTree::optimizeAllBranches(int, double, int): Assertion `fabs(new_tree_lh-tree_lh) < max_delta_lh' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: n20dal.phy.log ERROR: *** Alignment files (if possible) ", "Hi YanYan, I could not replicate this crash using the latest version 1.6.11. Which version did you use? Can you pls try the latest version. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c868e722-2307-4e8a-9730-3a5f7723892d%40googlegroups.com For more options, visit https://groups.google.com/d/optout <n20dal.phy> ", "Dear Minh: Thank you very much to give me suggestion so soon. Yes I using latest version 1.6.11, and test in win10 and win7. The n20dal.phy file I tried to analysis is a degenerated matrix, that is a coding method for nucleotides in which codons in a data matrix are completely degenerated, for the first and third codon positions using ambiguity coding e.g., CAT -- . CAY and TTA--. YTN. But IQ-tree detected: Alignment most likely contains protein sequences (not DNA), and try to use protein model to analysis and then failed. I do not know whether it is the reason that \u2013m MF requirement failed. I test an amino acid matrix. It works after I enter iqtree \u2013s aamatrix.phy Is it possible to let IQ-tree recognize degenerated DNA matrix? \u5728 2019\u5e746\u670829\u65e5\u661f\u671f\u516d UTC+8\u4e0a\u534811:20:41\uff0cYanYan\u5199\u9053\uff1a ", "Ah I see. That\u2019s the reason why IQ-TREE mis-identify your sequences as protein. You can use -st DNA to enforce DNA sequences, instead. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c3064706-578e-4b71-ba6f-36f40c47ab63%40googlegroups.com ", "Dear Minh: After adding -st DNA, IQ-tree works! Thank you! I am very happy that it is really fast. Cheers "]}, "HpFd2jcMNgQ": {"topic": "Topology testing ERROR: Tree file must be ended with a semi-colon ';'", "initializeDate": "Feb 14, 2018, 4:03:05 PM", "timeStamp": "Feb 15, 2018, 5:13:29 PM", "content": ["I have been getting the following error message when attempting a topology test. ERROR: Tree file must be ended with a semi-colon ';' (line 1 column 1094) My first tree, line 1, has only 582 characters, so I don't understand why I get the error message for column 1094. Thank you for any help, Therese ", "Dear Therese, thank you for your emails and your interest in IQ-TREE. Of all the emails I reply to this one, because it contained the information figuring out the problem. I tried to open your file Hypothtrees.txt in the tree-viewer FigTree and got a similar error: Error reading tree file: Missing closing \u2018)\u2019 in tree Scrutinising the trees in more detail revealed that your first tree contains 37 opening brackets, but only 35 closing ones! This is clearly an error that made IQ-TREE read further at the end of the (un-finished) first tree searching for the missing brackets. This caused the larger length of 1094 (because it had read well into the 2nd tree). Please fix your first tree in the multi-tree-file. I cannot help you there, because I have no idea how the tree is supposed to look. BTW, the single tree in Hypothtrees.newick was correctly formatted. Best wishes, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout > <Hypothtrees.txt> ", "Thank you very much Heiko! I am sorry it was such a simple error. I appreciate your help. Therese "]}, "xo4E_yS1PJs": {"topic": "Same error running Freerate or Heterotachy models", "initializeDate": "Aug 12, 2019, 8:49:50 AM", "timeStamp": "Aug 15, 2019, 9:33:21 PM", "content": ["Hello, I am getting the same error message trying to run the same dataset with the Freerate and Heterotachy models. ERROR: modelmarkov.cpp:1252: virtual void ModelMarkov::decomposeRateMatrix(): Assertion ` eigensolver.info () == Eigen::Success' failed. Logfiles are attached here. I have an additional question about rate categories for each--it was suggested I try categories 1-10 for both. Is there a way to automate this in IQTREE? Or should I run individually with each rate (10 runs total), and then somehow compare across runs (and if so, how should I compare, AICc?)? Thanks in advance for any suggestions. ", "Hi there, Thanks for reporting this crash in the beta version. Is it possible for you to send me the alignment file via my personal email? I\u2019ll then have a closer look. I have an additional question about rate categories for each--it was suggested I try categories 1-10 for both. Is there a way to automate this in IQTREE? Or should I run individually with each rate (10 runs total), and then somehow compare across runs (and if so, how should I compare, AICc?)? Yes you can, with -mrate option. For example iqtree -s ALN_FILE -mrate R,H will test all combinations of substitutions models together with +R2,..,+R10 and +H2 to +H10. If you want to do it manually, then look at the model with the lowest AIC/BIC values (should be printed in .iqtree file). Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ab8524e7-16f1-43f2-895d-a4cd07db7de9%40googlegroups.com <D4CP_F2.log> <D4CP_H2.log> ", "Hi Noor, This bug has been fixed since 1.7-beta10, whereas you used beta9. Thus please update the latest beta version: https://github.com/Cibiv/IQ-TREE/releases Thanks, Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/C4EF4A7C-A4E5-469B-B56C-0E3D3D2B180B%40univie.ac.at "]}, "tPDwmkPDIKI": {"topic": "IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT", "initializeDate": "Jun 18, 2018, 10:37:18 PM", "timeStamp": "Jun 22, 2018, 2:14:44 AM", "content": ["hello, I am attempting to run a partitioned analysis with mixed data on version 1.6.5 for windows of iqtree, but for some reason, IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT, when executing iqtree, using CP1bad3.nex. thank you for any assistance you can offer. ", "Hi Li, Thanks for the report. Can you pls send the alignment to my personal email? So that I can reproduce the crash. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <CP1bad3p.nex> <CP1bad3p.nex.log> ", "Hello, I am also getting the same error. I have a large alignment file. Do you think its for memory error? Is there any way so that I can allocate more memory for iqtree? ", "Hi Zillur, This does not look like the same issue. And I don\u2019t see any memory problem. However, I noticed you used version 1.5. Thus can you test the beta ver 1.6 here: https://github.com/Cibiv/IQ-TREE/releases/tag/v1.6.6.a And let me know how it goes. Cheers Minh <test_cl_fa.phy.log> <test_cl_fa.phy.ckp.gz> "]}, "Z0Zol-e_4yg": {"topic": "BUG: SIGNAL SEGMENTATION FAULT in v1.6.8", "initializeDate": "Nov 19, 2018, 9:24:52 PM", "timeStamp": "Dec 16, 2018, 10:11:48 PM", "content": ["Hello, I've been successfully running IQTREE to maintain much of nextstrain.org . It's a fantastic program and I truly appreciate all the effort that's gone into its construction. Most trees I have run without issue. However, I'm getting some consistent SIGNAL SEGMENTATION FAULT for recent Zika virus sequences. I'm running IQTREE v1.6.8: Fenrir:zika trvrb$ iqtree -ninit 2 -n 2 -me 0.05 -nt 1 -s iqtree_broken_full.fasta -m GTR IQ-TREE multicore version 1.6.8 for Mac OS X 64-bit built Nov 19 2018 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: Fenrir (AVX, 16 GB RAM) Command: iqtree -ninit 2 -n 2 -me 0.05 -nt 1 -s iqtree_broken_full.fasta -m GTR Seed: 880674 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Mon Nov 19 18:09:50 2018 Kernel: AVX - 1 threads (8 CPU cores detected) And getting the following crash: Estimate model parameters (epsilon = 0.500) 1. Initial log-likelihood: -29612.371 ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: iqtree_broken_full.fasta.log ERROR: *** Alignment files (if possible) Segmentation fault: 11 ----------------------------------- This is on a alignment of 228 taxa with 10,769 sites. Interesting, if I break the alignment in half and run the same command on either half individually, it works fine. So, there's some interaction effect rather than a specific bad sequence. The full \"broken\" alignment is available here: https://s3.amazonaws.com/trvrb/iqtree_broken_full.fasta The first half of the alignment that's working is available here: https://s3.amazonaws.com/trvrb/iqtree_working_split_1.fasta The second half of the alignment that's working is available here: https://s3.amazonaws.com/trvrb/iqtree_working_split_2.fasta In the first case, IQTREE is getting called with: iqtree -ninit 2 -n 2 -me 0.05 -nt 1 -s iqtree_broken_full.fasta -m GTR The other calls just have the FASTA swapped. Any help here would be much appreciated. Thank you, - Trevor Bedford ", "I've now determined that this issue is present on a different computer running version 1.6.8, so it is not hardware specific. Additionally, running with IQTREE version 1.6.6 does not show the issue. I also checked 1.6.7.2 and this doesn't show the issue either. Appears to have arisen in 1.6.8. This gives me a workaround to stick with 1.6.7.2 for the moment. Best, - Trevor ", "Hi Trevor, Thanks a lot for localising this issue! Apparently it was introduced in v1.6.8. I\u2019ll have a closer look in 2 weeks or so. But that\u2019s OK as you can still use the 2nd latest version. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Trevor, I've tested this run on my Mac and Linux and nothing crashed at all. However, I also noticed that this crash occurs when using iqtree package provided by Homebrew for Mac. Did you use this one? If yes, can you please use the official releases provided here: https://github.com/Cibiv/IQ-TREE/releases/tag/v1.6.8 Unfortunately, I don\u2019t know the homebrew iqtree package, so you may contact them directly. Cheers, Minh "]}, "KlBZE4oyQnU": {"topic": "mix data with DNA sequences and binary data", "initializeDate": "Jun 8, 2019, 5:40:20 AM", "timeStamp": "Jun 12, 2019, 9:09:19 PM", "content": ["Hi, I tried to code indel in my alignment as binary data. I would like to have iqtree infer the phylogenetic relationship using both the sequence and binary data. I wonder what is the input file looks like for this type of input data? Is it going to be sequence directly followed by the binary data e.g. atcgttg011101? Many thanks! Kind Regards, Diego ", "Can anyone help me with this, please? ", "Hi Diego, Sorry for the delay. You can\u2019t mix DNA and binary in one alignment file. You need to prepare 2 files: the DNA alignment (also your original file; say dna.phy) and the binary alignment file (e.g. bin.phy). Then prepare this partition file: #nexus begin sets; charset p1=dna.phy:*; charset p2=bin.phy:*; end; You can now run IQ-TREE, where the basic command is: iqtree -sp partition_file For more details see the doc: http://www.iqtree.org/doc/Complex-Models#partition-models Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7bc9c1b1-576f-4b45-a19f-582a1cc42d31%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Thank you very much Minh! I will have a go. On Wednesday, 12 June 2019 11:52:09 UTC+10, Minh Bui wrote: Hi Diego, Sorry for the delay. You can\u2019t mix DNA and binary in one alignment file. You need to prepare 2 files: the DNA alignment (also your original file; say dna.phy) and the binary alignment file (e.g. bin.phy). Then prepare this partition file: #nexus begin sets; charset p1=dna.phy:*; charset p2=bin.phy:*; end; You can now run IQ-TREE, where the basic command is: iqtree -sp partition_file For more details see the doc: http://www.iqtree.org/doc/Complex-Models#partition-models Cheers, Minh On 12 Jun 2019, at 8:46 am, Diego Zhu < diegoz...@gmail.com > wrote: Can anyone help me with this, please? On Saturday, 8 June 2019 19:40:20 UTC+10, Diego Zhu wrote: Hi, I tried to code indel in my alignment as binary data. I would like to have iqtree infer the phylogenetic relationship using both the sequence and binary data. I wonder what is the input file looks like for this type of input data? Is it going to be sequence directly followed by the binary data e.g. atcgttg011101? Many thanks! Kind Regards, Diego You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "ETgjXmPTxNE": {"topic": "IQ-TREE version 1.6.5 - crash segmentation fault", "initializeDate": "Nov 14, 2018, 10:56:22 AM", "timeStamp": "Nov 15, 2018, 10:23:32 PM", "content": ["Dear IQ-TREE Team, IQ-TREE multicore version 1.6.5 for Mac OS X 64-bit, crashed with signal segmentation faults after running the following command: iqtree -s Concat_alig_16S_COI_Myh6_Rag1_Rag2_30Oct2018.nex -st DNA -pre 14Nov2018_Run_1 -spp 14Nov2018_partition_file.nex -m TESTMERGEONLY -rcluster 10 -bb 1000 I would like to find the best partitioning scheme for my data with a relaxed clustering at 10% and run tree reconstruction with ultrafast bootstrap. See log file attached. Thanks for your help. Paola ", "Hi Paola, Just a quick comment right now: Can you please update to the latest version (1.6.8)? If it does not work, then let us know again. Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <14Nov2018_Run_1.log> ", "Thanks. It worked :) "]}, "h09LkA91jvE": {"topic": "Differences between MERGE with -q and -sp", "initializeDate": "May 25, 2018, 11:48:02 AM", "timeStamp": "May 28, 2018, 9:08:27 PM", "content": ["Hi guys, I am running the PartitionFinder greedy algorithm with -m MF+MERGE. Per your note on the command reference, I did not use -spp because I wanted to use edge-unlinked. I ran with -q because of the line \"However, for versions 1.6.X onwards, the edge-linked partition finding is performed by -spp option.\" However, now I have trialled the run again specifying -sp, I achieve different results. So does -q specify the edge-linked equal model to do the MERGE testing, even though it is implied that it will run edge-unlinked by the command reference? Thankful for any help you can give me, Best wishes, Nathanael ", "Hi Nathanael, On 26 May 2018, at 1:48 am, Nathanael Walker-Hale < nathanael....@gmail.com > wrote: Hi guys, I am running the PartitionFinder greedy algorithm with -m MF+MERGE. Per your note on the command reference, I did not use -spp because I wanted to use edge-unlinked. I ran with -q because of the line \"However, for versions 1.6.X onwards, the edge-linked partition finding is performed by -spp option.\" I\u2019m not sure if we clarified this in the document, but since version 1.6, ModelFinder will perform model merging exactly as users specified via -q, -spp or -sp. So -q will do edge-linked-equal, -spp for edge-linked-proportional and -sp for edge-unlinked partition models. And I recommend that you don\u2019t use -q, this is unrealistic as two genes hardly have the same evolutionary rates. However, now I have trialled the run again specifying -sp, I achieve different results. Do you mean that -sp gives different result in v1.6 compared with v1.5? if you have DNA data: note that there is a difference between v1.5 and v1.6. In v1.5 base frequencies are estimated by maximum likelihood (i.e. +FO) whereas in v1.6 they are empirical count from the alignment (+F). Typically this does not matter much. But if you have many partitions, the difference can add up. Moreover, with the same version different runs can have different guide tree (constructed with maximum parsimony by default), thus may result in different model. But I expect this to occur less frequently because model selection is typically not so sensitive to the guide tree. So does -q specify the edge-linked equal model to do the MERGE testing, even though it is implied that it will run edge-unlinked by the command reference? See above, -q will do edge-linked-equal model. Does that answer your question? Minh Thankful for any help you can give me, Best wishes, Nathanael You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "wF-sI38Aano": {"topic": "Just maximum parsimony tree?", "initializeDate": "Nov 17, 2017, 4:53:08 PM", "timeStamp": "Feb 8, 2018, 6:55:32 PM", "content": ["Hi, I can't seem to find the answer to this simple question anywhere: Can I use IQ-TREE to find an MP tree and/or a list of equally MP trees? Since you are already making MP trees through libpll and using these as starting trees for various ML models I see no reason why it shouldn't be possible to just get an MP tree out in the end (of course after a necessary tree space search). Look forwards to hear. Thanks for great software, Kristian ", "Hi Kristian, That\u2019s a good question. IQ-TREE constructs 100 starting trees using MP, which are based on heuristics implemented in libpll (technically: random stepwise addition plus subtree pruning and regrafting). Since no thorough tree search is performed here, I don\u2019t recommend to use them. In fact we have developed a separate version, which extends the IQ-TREE search strategy for MP. I will send you a link in another email. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi, could you please also send me the link to the separate version that allows for finding an MP tree? Thanks a lot in advance! Best regards, Tamara ", "Dear Tamara, Your question came just in time ;-) We recently published a paper on this: D.T. Hoang, L.S. Vinh, T. Flouri, A. Stamatakis, A. von Haeseler , and B.Q. Minh (2018) MPBoot: fast phylogenetic maximum parsimony tree inference and bootstrap approximation. BMC Evol. Biol. , 18, 11. http://dx.doi.org/10.1186/s12862-018-1131-3 with a link for download and manual. Let us know if you have any questions, Cheers Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com "]}, "_XiriapYkNM": {"topic": "Question to free rate model differences in 4 command line versions", "initializeDate": "Jan 10, 2018, 5:01:11 PM", "timeStamp": "Jan 29, 2018, 2:47:29 PM", "content": ["Hello, I'm not sure if I have found an error at the web interface here: http://iqtree.cibiv.univie.ac.at/ -> tab \"Model Selection\" There I can set: under more options > Heterogenity types: \"R\", when the checkbox \"New model selection procedure\" is not set. That produces the command line: iqtree ... -m TESTONLY ... -mrate .,.,R I think this is not allowed, since tha manual sais: \"Specify a comma-separated list of rate heterogeneity types for model selection. DEFAULT: -mrate E,I,G,I+G for standard procedure, -mrate E,I,G,I+G,R for new selection procedure. (E means Equal/homogeneous rate model).\" It should only be so: iqtree ... -m TESTNEWONLY ... -mrate .,.,R Am I right? And: what is the diffence between these two command lines (example with -mrate G only)?: iqtree ... -m TESTONLY ... -mrate G iqtree ... -m TESTONLYNEW ... -mrate G As far as I understood, -m TESTONLYNEW performs the extended model selection that additionally includes FreeRate model. But what happens if \"R\" is missing in the -mrate G command? All the best Dieter ", "Hi Dieter, Unfortunately I\u2019m a bit lost with your question. Can you paste some screen shots to show the problem? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thank you Minh, Sure, here we go: I am here: http://iqtree.cibiv.univie.ac.at/ There I go to the tab \u201cModel Selection\u201d Version 1 I can set up is: --> Swicht \u201c+R\u201d set and Heterogenity types including \u201cR\u201d That produces a command line like that: iqtree ... -m TESTONLYNEW -mrate R This is the standard way, described in the manual. All is well with that. Version 2 I can set up is: --> Swicht \u201c+R\u201d NOT set and Heterogenity types including \u201cR\u201d That produces a command line like that: iqtree \u2026 -m TESTONLY -mrate R This should not work, since the manual says: \"Specify a comma-separated list of rate heterogeneity types for model selection. DEFAULT: -mrate E,I,G,I+G for standard procedure , -mrate E,I,G,I+G, for new selection procedure (E means Equal/homogeneous rate model).\" But when I start it, it works without problems. The question is (if it really should work) \u2013 what is the difference to Version 1? Version 3 I can set up is: --> Swicht \u201c+R\u201d set and Heterogenity types not including \u201cR\u201d That produces a command line like that: iqtree \u2026 -m TESTONLYNEW -mrate E,I,G This will not include the free rate models (+R option). But\u2026 Version 4 I can set up is: --> Swicht \u201c+R\u201d set and Heterogenity types not including \u201cR\u201d That produces a command line like that: iqtree \u2026 -m TESTONLY -mrate E,I,G This will also not include the free rate models (+R option). The question is: What is the difference to Version 3 (TESTONLYNEW)? All the best Dieter ", "Hi Dieter, Now I see what you meant. A quick answer is: Specifying \u201cHeterogeneity types\u201d will override the default -mrate of TESTONLY or TESTONLYNEW. So on the web interface, entering this string will effectively ignore whether you checked \u201cNew model selection procedure\u201d or not. Does this clarify your question? Cheers, Minh On 25 Jan 2018, at 5:04 pm, die...@nocrotec.com wrote: Thank you Minh, Sure, here we go: I am here: http://iqtree.cibiv.univie.ac.at/ There I go to the tab \u201cModel Selection\u201d Version 1 I can set up is: <Auto Generated Inline Image 1.png> --> Swicht \u201c+R\u201d set and Heterogenity types including \u201cR\u201d That produces a command line like that: iqtree ... -m TESTONLYNEW -mrate R This is the standard way, described in the manual. All is well with that. Version 2 I can set up is: <Auto Generated Inline Image 2.png> --> Swicht \u201c+R\u201d NOT set and Heterogenity types including \u201cR\u201d That produces a command line like that: iqtree \u2026 -m TESTONLY -mrate R This should not work, since the manual says: \"Specify a comma-separated list of rate heterogeneity types for model selection. DEFAULT: -mrate E,I,G,I+G for standard procedure , -mrate E,I,G,I+G, for new selection procedure (E means Equal/homogeneous rate model).\" But when I start it, it works without problems. The question is (if it really should work) \u2013 what is the difference to Version 1? Version 3 I can set up is: <Auto Generated Inline Image 3.png> --> Swicht \u201c+R\u201d set and Heterogenity types not including \u201cR\u201d That produces a command line like that: iqtree \u2026 -m TESTONLYNEW -mrate E,I,G This will not include the free rate models (+R option). But\u2026 Version 4 I can set up is: <Auto Generated Inline Image 4.png> <Auto Generated Inline Image 1.png> <Auto Generated Inline Image 2.png> <Auto Generated Inline Image 3.png> <Auto Generated Inline Image 4.png> ", "Ahhh, OK, Thank you Minh. That clears up my confusion. Maybe that should be explained at the web interface.... All the best Dieter You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/_XiriapYkNM/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com "]}, "f7yTDzoqjqo": {"topic": "New paper: Site frequency model", "initializeDate": "Aug 17, 2017, 4:26:11 AM", "timeStamp": "Aug 17, 2017, 4:26:11 AM", "content": ["Hi everyone, We have recently published a new paper about a posterior mean site frequency (PMSF) model, as a rapid, low-memory and accurate approximation to the CAT models (C10 to C60). Details of the methods, IQ-TREE implementation and extensive analyses are presented here: H.C. Wang, B.Q. Minh, S. Susko and A.J. Roger (2017) Modeling site heterogeneity with posterior mean site frequency profiles accelerates accurate phylogenomic estimation. Syst. Biol., in press. https://doi.org/10.1093/sysbio/syx068 (please cite this paper if you use this model in a publication) Easy-to-use guideline is available here: http://www.iqtree.org/doc/Complex-Models#site-specific-frequency-models Cheers, Minh "]}, "YO678WNM7QI": {"topic": "Fixing models parameters", "initializeDate": "Jul 31, 2017, 5:32:33 AM", "timeStamp": "Aug 1, 2017, 8:51:54 AM", "content": ["Hi, I would like to fix the model parameters used in a constrained tree search. I am providing a model file with 10 values, one on each line, and these are being read correctly. However, IQTree then goes on to estimate the model parameters, which do change in some cases. It also reoptimises in the final tree search step. From the way I read the manual this isn't the behaviour I was expecting. Is there a way to fix these parameters and avoid the optimisations? Thanks, Simon ", "I should say that the rates appear to be being fixed, but not the composition. Thanks, Simon ", "Dear Simon, Minh is certainly the person who is best to help there\u2026 But what model exactly did you specify? Best wishes, Heiko You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Heiko, I followed these instructions from the documentation: Moreover, with the option one can input a file which contains the 6 rates (A-C, A-G, A-T, C-G, C-T, G-T) and 4 base frequencies (A, C, G, T). For example: iqtree -s example.phy -m mymodel+G where mymodel is a file containing the 10 entries described above, in the correct order. The entries can be seperated by either empty space(s) or newline character. One can even specify the rates within option by So I created a file with 10 rows with the desired values (taken from a previous IQTree run on the same data) Here's the pertinent output: Reading model parameters from file mymodel Rate parameters: A-C: 0.940 A-G: 5.338 A-T: 1.270 C-G: 0.188 C-T: 5.578 G-T: 1.000 Base frequencies: A: 0.154 C: 0.374 G: 0.307 T: 0.166 NOTE: 671 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.500) 1. Initial log-likelihood: -1422726.413 Optimal log-likelihood: -1405238.478 Rate parameters: A-C: 0.940 A-G: 5.338 A-T: 1.270 C-G: 0.188 C-T: 5.578 G-T: 1.000 Base frequencies: A: 0.154 C: 0.374 G: 0.307 T: 0.166 Parameters optimization took 1 rounds (41.838 sec) So you see in this case it didn't change any of the parameters, but still did the optimisation, which took 41s. Simon ", "Dear Simon, I do not think that the parameters have actually been touched (otherwise some digits should have changed at least). As far as I know from other uses of the program, what happens here is the the optimisation routine is entered (and, thus, counted). Then the branch lengths are optimised, and then usually the parameters would be optimised as well. However, now the program realises that this does not need to be done and leaves the routine, but some work (the initial optimisation of the branch lengths) has still been performed here. That parameters are fixed is typically an exception, hence, nobody realised this confusing message yet, I guess. @Minh: am I correct here? Anything to add? Cheers, Heiko ", "Hi Heiko, That appears to be the case for the rates, but not the base frequencies. e.g. if I slightly alter the values in my input file, the frequencies do change: Reading model parameters from file testmodel Rate parameters: A-C: 0.950 A-G: 5.358 A-T: 1.250 C-G: 0.158 C-T: 5.558 G-T: 1.000 Base frequencies: A: 0.124 C: 0.324 G: 0.327 T: 0.225 NOTE: 671 MB RAM (0 GB) is required! Estimate model parameters (epsilon = 0.500) 1. Initial log-likelihood: -1423468.057 Optimal log-likelihood: -1406077.547 Rate parameters: A-C: 0.950 A-G: 5.358 A-T: 1.250 C-G: 0.158 C-T: 5.558 G-T: 1.000 Base frequencies: A: 0.154 C: 0.374 G: 0.307 T: 0.166 Parameters optimization took 1 rounds (5.829 sec) I guess my question is whether there is a way to fix these as well as the rate parameters. Thanks for your help! Simon ", "I realise this may be as I'm using +F in the model, but if I use +F0 the optimizations run for a lot longer, so it must be reestimating the frequencies. Simon ", "Ah, this is why I asked what model exactly you did specify. As also stated in the manual, \u201c+F\u201d counts the (empirical) character frequencies from the alignment, while \u201c+FO\u201d does an ML estimate optimising the frequencies such that the ML value is maximal, which of course will take quite a bit longer. In both cases the addition of \u201c+F\u201d or \u201c+FO\u201d forces IQ-TREE do use different frequencies from whatever you where entering at the start (these would as far as I know only be used to initialise the parameters). Since you mentions before that you used mymodel+G (without e.g. +FO) and since the accompanying output stated twice the the same frequencies (A: 0.154 C: 0.374 G: 0.307 T: 0.166), I could not guess this. Please try again without a +F/+FO parameter and let\u2019s see what then happens ;) Cheers, Heiko ", "Hi Heiko, I didn't add +F, but it says in the documentation that this is the default. I added +FO to see if that made any difference. Anyway, it's no huge issue. I was just trying to work out how to make it read in the entire model. Thanks, Simon ", "Dear Simon and Heiko: Heiko made the right point and I admit that the tutorial was not clear: 1. \"-m mymodel\" is equivalent to \"-m mymodel+F\" (because +F is the default for DNA). Thus, IQ-TREE will read the rates and state frequencies from mymodel file, but then change the frequencies as empirically counted from the alignment. 2. \"-m mymodel+FU\" will have the desire effect, i.e. fixing state frequencies from mymodel file (+FU = user-defined frequency). This is what you wanted. 3. Alternatively, you can specify via command line: -m \"GTR{0.950,5.358,1.250,0.158,5.558}+F{0.124,0.324,0.327,0.225}\". Don't forget the double quote around the model string! This is the recommended option. Because you clearly see it from the command line. Another advantage is that when you have a partition model, you can then specify the model parameters for each partition this way in the partition file. And thanks for pointing this unclarity in the manual. We will fix this. Cheers, Minh ", "Thanks Minh, that's great! Simon "]}, "AUXblyehNkE": {"topic": "error message with -st codon option", "initializeDate": "Jul 11, 2017, 9:11:08 PM", "timeStamp": "Jul 12, 2017, 6:36:33 AM", "content": ["Hi Minh, Thanks for your help with the issues I've encountered running iq-tree on the cluster. In getting the desktop version up and running, I've encountered a new issue. When I attempt a test run with a protein-coding file using the -st codon option, I get an \"Invalid sequence type\" error: beliskner-be:bin mat314$ ./iqtree-omp -s atpA_plants4_test.fas -st codon -nt AUTO IQ-TREE multicore version 1.5.4 for Mac OS X 64-bit built Apr 2 2017 Copyright (c) 2011-2017 by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, and Arndt von Haeseler. Host: beliskner-be (AVX2, FMA3, 8 GB RAM) Command: ./iqtree-omp -s atpA_plants4_test.fas -st codon -nt AUTO Seed: 288731 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Jul 12 11:03:06 2017 Kernel: AVX+FMA - auto-detect threads (4 CPU cores detected) Reading alignment file atpA_plants4_test.fas ... Fasta format detected Alignment most likely contains DNA/RNA sequences ERROR: Invalid sequence type. beliskner-be:bin mat314$ The file translates with no issues into an amino acid file. There may be an incomplete codon somewhere in the file and there certainly are codons with ambiguity codes, but my experience when that is the case is that iq-tree will print out a list of both the incomplete codons and any codons with ambiguity codes. The example data files are all fine, and when I omit the -st codon option, the analysis proceeds. Thanks for your help! Cheers, Sarah ", "Hello, did you try to use `-st CODON` (not `-st codon`). I just checked the code and IQ-TREE expects a capitalized version. Maybe this solves your problem? Kind regards, Dominik Dominik Schrempf PhD Student Vienna Graduate School of Population Genetics Vetmeduni Vienna Austria > -- > You received this message because you are subscribed to the Google > Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, > send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout "]}, "EgqbNHGbiHA": {"topic": "Error - IQtree 1.6 beta - segmentation fault evaluating set of user trees.", "initializeDate": "Sep 27, 2017, 12:49:31 PM", "timeStamp": "Oct 9, 2017, 3:12:46 PM", "content": ["Hi Minh! I'm currently using IQtree 1.6beta to evaluate a set of trees and perform tests. I used the following command: iqtree-beta -nt AUTO -m GTR+G8 -s cat_info_10.txt -z trees_AU.txt -au -zb 10000 -n 0 -t PARS -redo and got the following error: Reading trees in trees_AU.txt ... 4 trees detected Note: 6392.079 MB of RAM required! Creating 10000 bootstrap replicates... done Tree 1(((((Erinaceus:0.1745237044,Sorex:0. 2123707052 ):0.0146538515,((Felis:0.0640998637,((Ailuropoda:0.0384655869,Mustela:0.0604338906):0.0121143955,Canis:0.0566375420):0.0121906200):0.0346157274,((Sus:0.0989642703,((Ovis:0.0268384785,Bos:0.0225912222):0.0566010793,Tursiops:0.0421358605):0.0095212538):0.0060156736,Vicugna:0.0688506996):0.0251339871,(Myotis:0.0857035395,Pteropus:0.0758444032):0.0210267830,Equus:0.0739209867):0.0047176272):0.0129892508,(((Ictidomys:0.1070741043,(Dipodomys:0.1469297988,(Mus:0.0446358055,Rattus:0.0872259022):0.1463703313):0.0121102826,Cavia:0.1593726991):0.0175789416,(Oryctolagus:0.0862063360,Ochotona:0.1297142984):0.0630468698):0.0088071391,(((((Chlorocebus:0.0093667256,(Macaca:0.0121305428,Papio:0.0070306440):0.0021163528):0.0145466296,((((Homo:0.0037169400,Pan:0.0048646410):0.0017183107,Gorilla:0.0152850835):0.0047783353,Pongo:0.0124131166):0.0018638511,Nomascus:0.0168137623):0.0057299193):0.0113115297,Callithrix:0.0508825935):0.0396326873,Tarsius:0.0922282779):0.0067265370,(Otolemur:0.0862547058,Microcebus:0.0671339891):0.0190400234):0.0118685991,Tupaia:0.1389549475):0.0130659695):0.0125083818,((Echinops:0.1737176931,(Loxodonta:0.0875451617,Procavia:0.0946010031):0.0143871869):0.0305052860,(Choloepus:0.0712954745,Dasypus:0.0971376278):0.0450769268):0.0037182121):0.1765373331,((Sarcophilus:0.1046010521,Macropus:0.0790856616):0.0158178363,Monodelphis:0.0833542182):0.1694785632,Ornithorhynchus:0.3433177094); new_tree_lh: -3028959. 2726053940 tree_lh: -2938367. 8002452487 (((((Erinaceus:0.1745237044,Sorex:0. 2123707052 ):0.0146538515,((Felis:0.0640998637,((Ailuropoda:0.0384655869,Mustela:0.0604338906):0.0121143955,Canis:0.0566375420):0.0121906200):0.0346157274,((Sus:0.0989642703,((Ovis:0.0268384785,Bos:0.0225912222):0.0566010793,Tursiops:0.0421358605):0.0095212538):0.0060156736,Vicugna:0.0688506996):0.0251339871,(Myotis:0.0857035395,Pteropus:0.0758444032):0.0210267830,Equus:0.0739209867):0.0047176272):0.0129892508,(((Ictidomys:0.1070741043,(Dipodomys:0.1469297988,(Mus:0.0446358055,Rattus:0.0872259022):0.1463703313):0.0121102826,Cavia:0.1593726991):0.0175789416,(Oryctolagus:0.0862063360,Ochotona:0.1297142984):0.0630468698):0.0088071391,(((((Chlorocebus:0.0093667256,(Macaca:0.0121305428,Papio:0.0070306440):0.0021163528):0.0145466296,((((Homo:0.0037169400,Pan:0.0048646410):0.0017183107,Gorilla:0.0152850835):0.0047783353,Pongo:0.0124131166):0.0018638511,Nomascus:0.0168137623):0.0057299193):0.0113115297,Callithrix:0.0508825935):0.0396326873,Tarsius:0.0922282779):0.0067265370,(Otolemur:0.0862547058,Microcebus:0.0671339891):0.0190400234):0.0118685991,Tupaia:0.1389549475):0.0130659695):0.0125083818,((Echinops:0.1737176931,(Loxodonta:0.0875451617,Procavia:0.0946010031):0.0143871869):0.0305052860,(Choloepus:0.0712954745,Dasypus:0.0971376278):0.0450769268):0.0037182121):0.1765373331,((Sarcophilus:0.1046010521,Macropus:0.0790856616):0.0158178363,Monodelphis:0.0833542182):0.1694785632,Ornithorhynchus:0.3433177094);ERROR: phylotree.cpp:2574: virtual double PhyloTree::optimizeAllBranches(int, double, int): Assertion `fabs(new_tree_lh-tree_lh) < max_delta_lh' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: cat_info_10.txt.log ERROR: *** Alignment files (if possible) I also found an error trying to do this in a previous version and without the '-t PARS' option: Reading trees in trees_AU.txt ... 4 trees detected Note: 6392.079 MB of RAM required! Creating 10000 bootstrap replicates... done Tree 1new_tree_lh: -3016015.822 tree_lh: -2953504.505 STACK TRACE FOR DEBUGGING: *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: cat_info_10.txt.log *** Alignment files (if possible) I'm sending both log files. I renamed the log file of the previous version to 'cat_info_10_old.txt' . I would like to share the alignment and the trees via personal email. May I? The trees contain some polytomies and I think this may be related to the problem. Thanks in advance, Filipe Moreira. ", "Hi Filipe, Thanks for the report. Does it work when user trees have no polytomy? Nevertheless, please send me the alignment and trees via my personal email. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <cat_info_10.txt.log> <cat_info_10_old.txt.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi, Mihn. I actually have not tested this yet. I will do this right now. I'm sending the files via personal email. Cheers, Filipe. ", "Hi, Minh. I'm trying again with different alignments and I get the following error: Reading trees in trees_AU.txt ... 4 trees detected Note: 5172.467 MB of RAM required! Creating 10000 bootstrap replicates... done Tree 1 / LogL: -2528621.856 Tree 2 / LogL: -2528651.592 Tree 3 / LogL: -2528637.634 Tree 4(Loxodonta:0.1000000000,Procavia:0.1000000000,(Echinops:0.1000000000,((Choloepus:0.1000000000,Dasypus:0.1000000000):0.1000000000,(((Sarcophilus:0.1000000000,Macropus:0.1000000000):0.1000000000,Monodelphis:0.1000000000):0.1000000000,Ornithorhynchus:0.1000000000):0.1000000000,((((Ictidomys:0.1000000000,(Dipodomys:0.1000000000,(Mus:0.1000000000,Rattus:0.1000000000):0.1000000000):0.1000000000,Cavia:0.1000000000):0.1000000000,(Oryctolagus:0.1000000000,Ochotona:0.1000000000):0.1000000000):0.1000000000,(((((Chlorocebus:0.1000000000,(Macaca:0.1000000000,Papio:0.1000000000):0.1000000000):0.1000000000,((((Homo:0.1000000000,Pan:0.1000000000):0.1000000000,Gorilla:0.1000000000):0.1000000000,Pongo:0.1000000000):0.1000000000,Nomascus:0.1000000000):0.1000000000):0.1000000000,Callithrix:0.1000000000):0.1000000000,Tarsius:0.1000000000):0.1000000000,(Otolemur:0.1000000000,Microcebus:0.1000000000):0.1000000000):0.1000000000,Tupaia:0.1000000000):0.1000000000,(((Felis:0.1000000000,((Ailuropoda:0.1000000000,Mustela:0.1000000000):0.1000000000,Canis:0.1000000000):0.1000000000):0.1000000000,((Sus:0.1000000000,((Ovis:0.1000000000,Bos:0.1000000000):0.1000000000,Tursiops:0.1000000000):0.1000000000):0.1000000000,Vicugna:0.1000000000):0.1000000000,(Myotis:0.1000000000,Pteropus:0.1000000000):0.1000000000,Equus:0.1000000000):0.1000000000,(Erinaceus:0.1000000000,Sorex:0.1000000000):0.1000000000):0.1000000000):0.1000000000):0.1000000000):0.1000000000); new_tree_lh: -2657594.9131249934 tree_lh: -2672354.5610774178 (Loxodonta:0.1000000000,Procavia:0.1000000000,(Echinops:0.1000000000,((Choloepus:0.1000000000,Dasypus:0.1000000000):0.1000000000,(((Sarcophilus:0.1000000000,Macropus:0.1000000000):0.1000000000,Monodelphis:0.1000000000):0.1000000000,Ornithorhynchus:0.1000000000):0.1000000000,((((Ictidomys:0.1000000000,(Dipodomys:0.1000000000,(Mus:0.1000000000,Rattus:0.1000000000):0.1000000000):0.1000000000,Cavia:0.1000000000):0.1000000000,(Oryctolagus:0.1000000000,Ochotona:0.1000000000):0.1000000000):0.1000000000,(((((Chlorocebus:0.1000000000,(Macaca:0.1000000000,Papio:0.1000000000):0.1000000000):0.1000000000,((((Homo:0.1000000000,Pan:0.1000000000):0.1000000000,Gorilla:0.1000000000):0.1000000000,Pongo:0.1000000000):0.1000000000,Nomascus:0.1000000000):0.1000000000):0.1000000000,Callithrix:0.1000000000):0.1000000000,Tarsius:0.1000000000):0.1000000000,(Otolemur:0.1000000000,Microcebus:0.1000000000):0.1000000000):0.1000000000,Tupaia:0.1000000000):0.1000000000,(((Felis:0.1000000000,((Ailuropoda:0.1000000000,Mustela:0.1000000000):0.1000000000,Canis:0.1000000000):0.1000000000):0.1000000000,((Sus:0.1000000000,((Ovis:0.1000000000,Bos:0.1000000000):0.1000000000,Tursiops:0.1000000000):0.1000000000):0.1000000000,Vicugna:0.1000000000):0.1000000000,(Myotis:0.1000000000,Pteropus:0.1000000000):0.1000000000,Equus:0.1000000000):0.1000000000,(Erinaceus:0.1000000000,Sorex:0.1000000000):0.1000000000):0.1000000000):0.1000000000):0.1000000000):0.1000000000); ERROR: phylotree.cpp:2574: virtual double PhyloTree::optimizeAllBranches(int, double, int): Assertion `fabs(new_tree_lh-tree_lh) < max_delta_lh' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: pars.cat_info_5.phy.log ERROR: *** Alignment files (if possible) I think this error message might be useful. Cheers, Filipe. ", "Dear Filipe, Am I right that this problem is still related to (or the same as) the one you sent not so long ago, right? I will have a look, was just too busy during the past weeks. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "4_fKySycR8g": {"topic": "mixture models", "initializeDate": "Nov 26, 2014, 1:36:07 PM", "timeStamp": "May 7, 2015, 11:06:55 AM", "content": ["Hi, This seems like a great piece of software. Are there any plans to incorporate site-heterogeneous mixture models into future releases? Specifically, the C10-C60 mixtures of Lartillot, Le and Gascuel, or their secondary structure-based mixture models? I think one of the most important advances in 'deep phylogenetics' has been the development of these mixture models and so it would be very very useful to have an efficient ML implementation (the PHYML implementation is far too slow for large super-matrices). Sincerely Andrew Roger ", "Dear Andrew Roger, thanks for your interest. Did you mean the model in this paper? PhyML-CAT This version of PhyML implements the CAT model described in: \"Empirical profile mixture models for phylogenetic reconstruction.\" Le S.Q., Gascuel O., Lartillot N. Bioinformatics, 24(20):2317-23, 2008. Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Yes I do mean the models in that paper. I also l mean models like: Mol Biol Evol. 2012 Oct;29(10):2921-36. Epub 2012 Apr 6. Modeling protein evolution with several amino acid replacement matrices depending on site rates. Le SQ Dang CC Gascuel O Syst Biol. 2010 May;59(3):277-87. doi: 10.1093/sysbio/syq002. Epub 2010 Mar 10. Accounting for solvent accessibility and secondary structure in protein phylogenetics is clearly beneficial. Le SQ Gascuel BMC Evol Biol. 2008 Dec 16;8:331. doi: 10.1186/1471-2148-8-331. A class frequency mixture model that adjusts for site-specific amino acid frequencies and improves inference of protein phylogeny. Wang HC Li K Susko E Roger AJ More generally it would be nice to have an ability to load in 'any' mixture models. That is the user specifies the dimension of the mixture (it would be worth restricting this probably to =<20 or so) and then they have to supply the stationary frequency vector and the exchangeability matrix for each of the components. Currently there is no 'fast' method to do ML tree-searching with such mixture models for large data sets available. The PhyML version you refer to in the Le et al. publication is actually extremely slow. In general the mixture models are a problem because the computation time goes up at least linearly with the number of the components in the mixture...So some kind of approximation might end up being important direction to take. In my view, this is the main reason why phylogenomic analyses these days almost exclusively use Lartillot's phylobayes program -- it implements the complex CAT model which is criticially important for modeling amino acid evolution. Cheers Andrew ", "Hi Andrew, thanks for the references. I added mixture models into the TODO list\u2026 BTW I saw a need to implement the mixture model in a flexible way, so that users can input the mixture model. Moreover, computation time is another factor. So it needs some thinking to have both an efficient and flexible implementation. I will get back to you once I have more ideas about that\u2026 Cheers, Minh ", "Dear Roger, dear Quang, I have just released version 1.2.0 that supports a number of mixture models. It also has the ability of specify user-defined model via syntax like \"MIX{WAG,LG}+G\" or via a nexus file. Check it out from the IQ-Tree web site. Since this feature is new, can you please check if it works as expected like in Phyml or QmmRaxml? Cheers, Minh ", "Hi Minh, I realy like IQtree!!! You mention in this post that you have implemented sets of mixture models and the IQtree website should be consulted for this. However, I don't find realy relevant information concerning mixture models there. Maybe I am just too stupid. My particular question are: 1) Are LG4M and/or LG4X implemented 2) Can these models be used in partitioned set ups 3) Can these models be used for aLRT tests 4) Can these models be used in multi-core set ups Many thanks, Bernhard Am Dienstag, 10. Februar 2015 10:58:00 UTC+1 schrieb Bui Quang Minh: > Dear Roger, dear Quang, > I have just released version 1.2.0 that supports a number of mixture models. It also has the ability of specify user-defined model via syntax like \"MIX{WAG,LG}+G\" or via a nexus file. Check it out from the IQ-Tree web site. Since this feature is new, can you please check if it works as expected like in Phyml or QmmRaxml? > Cheers, Minh > On Sunday, November 30, 2014 at 11:14:59 PM UTC+1, Bui Quang Minh wrote: > Hi Andrew, > thanks for the references. I added mixture models into the TODO list\u2026 BTW I saw a need to implement the mixture model in a flexible way, so that users can input the mixture model. Moreover, computation time is another factor. So it needs some thinking to have both an efficient and flexible implementation. > I will get back to you once I have more ideas about that\u2026 > Cheers, Minh > On 28 Nov 2014, at 17:49, Andrew Roger < andrew...@gmail.com > wrote: > Hi Minh, > Yes I do mean the models in that paper. I also l mean models like: > Mol Biol Evol. 2012 Oct;29(10):2921-36. Epub 2012 Apr 6.Modeling protein evolution with several amino acid replacement matrices depending on site rates. > Le SQ1, Dang CC, Gascuel O. > Syst Biol. 2010 May;59(3):277-87. doi: 10.1093/sysbio/syq002. Epub 2010 Mar 10.Accounting for solvent accessibility and secondary structure in protein phylogenetics is clearly beneficial. ", "Hi Bernhard, > On 07 May 2015, at 16:55, bernhar...@googlemail.com wrote: > Hi Minh, > I realy like IQtree!!! thanks ;-) > You mention in this post that you have implemented sets of mixture models and the IQtree website should be consulted for this. However, I don't find realy relevant information concerning mixture models there. Maybe I am just too stupid. not at all\u2026 I did not document it yet. Will update the manual soon. > My particular question are: > 1) Are LG4M and/or LG4X implemented yes, simply use \u201c-m LG4M\u201d option. > 2) Can these models be used in partitioned set ups yes, for example, a partition NEXUS file could look like: #nexus begin sets; charset part1=1-150; charset part2=151-300; charpartition mine=LG4M:part1,LG4X:part2; end; > 3) Can these models be used for aLRT tests yes, this works transparently. For example, just use option \u201c-alrt 1000\u201d to set 1000 replicates for SH-aLRT test > 4) Can these models be used in multi-core set ups yes, e.g., with \u201c-nt 2\u201d option for using 2 cores The full command line for 1,2,3,4 might look like: iqtree -s alignment_file -sp partition_file -alrt 1000 -nt 2 > Many thanks, you are welcome. Minh > To post to this group, send email to iqt...@googlegroups.com "]}, "-ngFmcumLA8": {"topic": "error in IQtree", "initializeDate": "Jul 3, 2018, 1:52:54 PM", "timeStamp": "Jul 5, 2018, 3:47:45 PM", "content": ["Dear Dr. Minh, I am running ModelFinder on a nt dataset (with only 1st and 2nd codon positions, 3rd codons removed) using IQtree version 1.6.3. The command line I used is as following: iqtree -nt 30 -st DNA -s ChalCOS.5561genes.nt.1and2codons.fas -spp ChalCOS.5561genes.nt.1and2codons.partition.nex -m MF+MERGE -rcluster 10 -rcluster-max 10000 -pre 2.1_5561genes.nt.1and2codons.IQtree.MFM10 -cptime 60 -safe But I kept getting error messages like: ....... WARNING: Numerical underflow for lh-branch WARNING: Numerical underflow for lh-branch WARNING: Numerical underflow for lh-branch WARNING: Numerical underflow for lh-branch WARNING: Numerical underflow for lh-branch WARNING: Numerical underflow for lh-branch ERROR: rategammainvar.cpp:244: double RateGammaInvar::optimizeWithEM(double): Assertion `newPInvar < 1.0' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: 2.1_5561genes.nt.1and2codons.IQtree.MFM10.log ERROR: *** Alignment files (if possible) /var/spool/slurmd/job2523971/slurm_script: line 20: 4113 Aborted iqtree -nt 30 -st DNA -s ChalCOS.5561genes.nt.1and2codons.fas -spp ChalCOS.5561genes.nt.1and2codons.partition.nex -m MF+MERGE -rcluster 10 -rcluster-max 10000 -pre 2.1_5561genes.nt.1and2codons.IQtree.MFM10 -cptime 60 -safe I put the original fasta alignment and partition files in the dropbox folder (following link) for the trouble-shooting purpose. And in this folder, you can also find the .sh file I used for submitting the job to the biocluster and the output log file. https://www.dropbox.com/sh/197rtfocmkinhya/AAAflp6bfDJqk8r_HddJ4PQRa?dl=0 Do you know what went wrong with this analysis and what should I do to fix it? Thank you very much! Best, Junxia ", "Hello all, Can someone help me out with this following problem? Thank you very much! Junxia ", "Hi Junxia, I just downloaded the files. Thanks for the report. Will have a look and get back later. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "GuwSXtns4xQ": {"topic": "generate pair wise distance matrix of unrooted phylogenetic tree given by \"iqtree\"", "initializeDate": "Jun 28, 2018, 11:18:11 AM", "timeStamp": "Jun 30, 2018, 10:35:58 AM", "content": ["Hi, I am quite new to phylogenetic analysis and so IQtree as well. Please bare with me if question does not make sense. I am using IQtree to analyse some horizontally transferred genes. I have successfully generated phylogenetic tree using IQtree. I have few questions related to interpretation of the trees given by IQtree. 1). I want to make pairwise comparison of each species given in the tree. To do this, first, I converted unrooted tree to rooted tree using outgroup sequence. Question is, how can I get the pairwise distance of rooted phylogenetic tree ?? I know IQtree gives .mldist file having pairwise distance matrix of final tree given by IQtree. However, I don't know how much the matrix of .mldist file is reliable to use if I converted original unrooted tree to rooted tree ?? Any answer would be highly highly appreciated. ", "Hi, I have started same discussion on biostar as well. if anyone would like to answer there. ", "Hi Chirag, Regarding .mldist: Please note that this is not the distance matrix computed from the tree. Instead this is the distance from pairwise sequence comparisons, i.e. just by looking at sequence content \u2014 no tree is involved here. The distance is computed using maximum likelihood (that\u2019s why it\u2019s called mldist) based on model parameter estimates from an initial tree. The main purpose of IQ-TREE was to use this distance matrix to build a neighbour-joining tree, which is used as one of the starting trees for more thorough ML tree search. For the 2nd question, if you want to use a tree to compute the distance (i.e. the path lengths between 2 species), I guess you can use some R package such as APE, though I haven\u2019t use it myself. This should work regardless of rooted or unrooted trees. Any finally since you mentioned HGT: since this is non-treelike event, you should use some phylogenetic networks such as those implemented in the SplitsTree software. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Thanks a lot for your reply. It was indeed very useful and important information that .mldist file does not represent the final tree given by IQ-tree. Without knowing that I would have missed tree information. I have been using cophenetic phylo function implemented in the ape package which converts tree in to distance matrix using branch length. One again thanks for your time. "]}, "6Ip8E195w60": {"topic": "BUG: IQTREE hangs with mixture model", "initializeDate": "Feb 21, 2018, 4:56:50 AM", "timeStamp": "Mar 1, 2018, 12:17:28 AM", "content": ["When I run a small dataset with the following command: iqtree -m LG+C20 -s data.fa -pre test The program proceeds to the point: Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.021 seconds Model LG+C20 is alias for LG+POISSON+G+FMIX{C20pi1:1:0.0559910600,C20pi2:1:0.0514824870,C20pi3:1:0.0812922124,C20pi4:1:0.0721976867,C20pi5:1:0.0556718858,C20pi6:1:0.0331003080,C20pi7:1:0 .0589501763,C20pi8:1:0.0263756889,C20pi9:1:0.0307584220,C20pi10:1:0.0376701125,C20pi11:1:0.0303058290,C20pi12:1:0.0808775576,C20pi13:1:0.0263349134,C20pi14:1:0.0579101455,C20pi15:1:0.037 1248064,C20pi16:1:0.0586867766,C20pi17:1:0.0561479138,C20pi18:1:0.0349810886,C20pi19:1:0.0544937394,C20pi20:1:0.0596471901} and then freezes. CPU is still being used, but there is no further progress.The same command works in version 1.5.5 and either LG or C20 alone works in version 1.6. Version Number 1.6 Linux Seed: 87670 (Using SPRNG - Scalable Parallel Random Number Generator) No warnings or errors Thanks! Craig ", "Hi Craig, It\u2019s likely that IQ-TREE is still running. It\u2019s at the stage of initial model parameter optimisation, which takes more time for such mixture model. You should use -nt option to specify more CPU cores to speed this up. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Craig, This is indeed a bug in v1.6 in parsing model option for LG+C20 or similar mixture models. We just released version 1.6.2 which fixes this bug and other issues. Please download the new version. Thank you! Minh On 21 Feb 2018, at 8:56 pm, Craig Herbold < hex...@gmail.com > wrote: "]}, "eB_SDwDi7a4": {"topic": "IQ-TREE killed", "initializeDate": "Jul 19, 2020, 7:26:37 AM", "timeStamp": "Jul 20, 2020, 8:13:18 AM", "content": ["Hi Iqtree team, I am trying to reconstruct a large alignment (~10,000 amino acid sequences). The tree search has converged to 200 iterations using a perturbation strength of 0.2 for 6 replicates, however I receive an error that the inference is killed with no additional information for each inference (line 20: 72318 Killed). I have tried on multiple systems with excessive resources (120 gb of system memory) and each produces the same error. I have also tried using the converged topologies in new inferences with the tree-search set to 1 iteration and still receive to same 'killed' exit status. Do you know what may be causing this and how I can repair it? Cheers, Matt ", "Hi Matt, Sorry, I forgot your email to my personal account. But if you send the question here, I won\u2019t. It\u2019s perhaps a memory issue, particularly this WARNING: WARNING: Memory required per CPU-core (9.76686 GB) is higher than your computer RAM per CPU-core (1 GB), thus multiple runs may exceed RAM! A few things may help: - Reducing the number of bootstrap replicates (for example -bb 1000) may help. - Try the latest version 2.1.0 released just a few days (look up previous email in this forum). It\u2019s tuned exactly for this type of data set, i.e. many many sequences. - Use a simpler model, e.g. LG+G will help to speed up and also reduce memory footprint. - Why do you need to do \u201c-nm 2000\u201d? Your first run before the checkpoint actually says: \"NOTE: Bootstrap correlation coefficient of split occurrence frequencies: 0.994\u201d So the BS already converged, to need to increase the number of iterations that much. And why did you kill and re-run the job several times? Perhaps due to long waiting time? But then, you shouldn\u2019t impose all these options, that make it run even longer... Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5bf710fb-feaf-47fe-8298-6f0979721022o%40googlegroups.com <restarted_search.sh.e7477076> <RNR_aln.fasta.log> "]}, "ZHGb-q-H9Ck": {"topic": "ERROR: NUMERICAL ERROR: Wrong computeFuncDerv", "initializeDate": "Apr 19, 2019, 2:56:43 PM", "timeStamp": "Apr 25, 2019, 11:14:30 PM", "content": ["Hi, I've been running iqtree v1.6.8 on a protein alignment in partitioned mode (with models generated by Prottest). Its a large alignment (189348aa long with 234 species). I'm running this on linux iqtree -s sequence.phy -bb 1000 -wbtl -spp partition_file -safe Random seed: 794170 It runs for several days and then stops with a numerical error, I think during the bootstrapping. I've tried running it a few times from checkpoint. Here are the warning and error log file lines: WARNING: No parsimony-informative sites in partition orthogroup0001829 WARNING: No parsimony-informative sites in partition orthogroup0002769 WARNING: No parsimony-informative sites in partition orthogroup0001816 WARNING: No parsimony-informative sites in partition orthogroup0001690 WARNING: No parsimony-informative sites in partition orthogroup0001744 WARNING: States(s) C rarely appear in partition orthogroup0002227 and may cause numerical problems WARNING: States(s) Y rarely appear in partition orthogroup0001745 and may cause numerical problems WARNING: States(s) H rarely appear in partition orthogroup0001765 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0001925 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002079 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002730 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002106 and may cause numerical problems WARNING: States(s) K rarely appear in partition orthogroup0001728 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0001725 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002596 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002193 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002117 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0001837 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0002076 and may cause numerical problems WARNING: States(s) H rarely appear in partition orthogroup0001668 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002712 and may cause numerical problems WARNING: States(s) H, F rarely appear in partition orthogroup0002084 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0001937 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0001638 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002100 and may cause numerical problems WARNING: States(s) M rarely appear in partition orthogroup0001829 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0002570 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002319 and may cause numerical problems WARNING: States(s) Y rarely appear in partition orthogroup0002195 and may cause numerical problems WARNING: States(s) C, F rarely appear in partition orthogroup0001688 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002180 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0001713 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002099 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0001809 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002213 and may cause numerical problems WARNING: States(s) C, H rarely appear in partition orthogroup0002376 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002719 and may cause numerical problems WARNING: States(s) C, W rarely appear in partition orthogroup0001645 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002002 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0002010 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002617 and may cause numerical problems WARNING: States(s) N rarely appear in partition orthogroup0002188 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002735 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0001729 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002358 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002591 and may cause numerical problems WARNING: States(s) N rarely appear in partition orthogroup0002723 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0001843 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002740 and may cause numerical problems WARNING: States(s) Y rarely appear in partition orthogroup0002607 and may cause numerical problems WARNING: States(s) H rarely appear in partition orthogroup0002455 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002452 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0001732 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002009 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002616 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002520 and may cause numerical problems WARNING: States(s) N rarely appear in partition orthogroup0002320 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0001807 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002328 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002515 and may cause numerical problems WARNING: States(s) K rarely appear in partition orthogroup0001761 and may cause numerical problems WARNING: States(s) C, W rarely appear in partition orthogroup0002628 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0002375 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0002382 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0001707 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0002360 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002083 and may cause numerical problems WARNING: States(s) D, W rarely appear in partition orthogroup0002224 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002236 and may cause numerical problems WARNING: States(s) H rarely appear in partition orthogroup0002769 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002494 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0001726 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002538 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0002279 and may cause numerical problems WARNING: States(s) F rarely appear in partition orthogroup0002754 and may cause numerical problems WARNING: States(s) M rarely appear in partition orthogroup0002698 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002187 and may cause numerical problems WARNING: States(s) H rarely appear in partition orthogroup0002576 and may cause numerical problems WARNING: States(s) F rarely appear in partition orthogroup0001648 and may cause numerical problems WARNING: States(s) C, P, W, Y rarely appear in partition orthogroup0001816 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0002633 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002389 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0002080 and may cause numerical problems WARNING: States(s) Y rarely appear in partition orthogroup0002114 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0001724 and may cause numerical problems WARNING: States(s) C, W rarely appear in partition orthogroup0002686 and may cause numerical problems WARNING: States(s) M rarely appear in partition orthogroup0002044 and may cause numerical problems WARNING: States(s) H rarely appear in partition orthogroup0002393 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0001779 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0001873 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002130 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002568 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0002697 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002693 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002725 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002619 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0001738 and may cause numerical problems WARNING: States(s) F rarely appear in partition orthogroup0002586 and may cause numerical problems WARNING: States(s) N rarely appear in partition orthogroup0001669 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0001867 and may cause numerical problems WARNING: States(s) P rarely appear in partition orthogroup0002456 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002653 and may cause numerical problems WARNING: States(s) H rarely appear in partition orthogroup0001653 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002372 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0001675 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002209 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0001671 and may cause numerical problems WARNING: States(s) Y rarely appear in partition orthogroup0002037 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0002135 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002523 and may cause numerical problems WARNING: States(s) M, F rarely appear in partition orthogroup0001869 and may cause numerical problems WARNING: States(s) H rarely appear in partition orthogroup0002450 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0002667 and may cause numerical problems WARNING: States(s) N rarely appear in partition orthogroup0002322 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002738 and may cause numerical problems WARNING: States(s) W rarely appear in partition orthogroup0002356 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0001687 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0002387 and may cause numerical problems WARNING: States(s) C rarely appear in partition orthogroup0001852 and may cause numerical problems WARNING: Memory required per CPU-core (12.8578 GB) is higher than your computer RAM per CPU-core (5 GB), thus multiple runs may exceed RAM! WARNING: Numerical underflow for lh-branch ERROR: rategammainvar.cpp:244: double RateGammaInvar::optimizeWithEM(double): Assertion `newPInvar < 1.0' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: partition_file.log ERROR: *** Alignment files (if possible) Computing ML distances based on estimated model parameters...ERROR: NUMERICAL ERROR: Wrong computeFuncDerv ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: partition_file.log ERROR: *** Alignment files (if possible) Last few lines of output file: Computing ML distances based on estimated model parameters...ERROR: NUMERICAL ERROR: Wrong computeFuncDerv ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: partition_file.log ERROR: *** Alignment files (if possible) Do you think this is a sequence problem or something related to my commands? Many thanks Michelle ", "Hi Michelle, Your command looks fine. Can you send me the entire log file to my email for further inspection? Thank you, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "gT9Ch67YIYw": {"topic": "BUG: IQ-TREE CRASHES WITH SIGNAL ABORTED", "initializeDate": "Sep 17, 2020, 9:47:03 AM", "timeStamp": "Sep 30, 2020, 12:36:30 AM", "content": ["Dear IQTree Developers, I am having trouble running a codon based analysis of 299 sequences of COI. It crashes, and curiously I am not getting the same model in different runs. I am running IQTree 2.0.6 for Windows 10. IQ-TREE multicore version 2.0.6 for Windows 64-bit built May 30 2020 Command: bin\\iqtree2 -s C:\\Users\\suzaw\\Downloads\\sol_COI_657bp_namesChckd_16Sep20_codons.fasta -st CODON5 -nt AUTO Seed: 612206 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Thu Sep 17 12:33:32 2020 Kernel: AVX+FMA - auto-detect threads (8 CPU cores detected) Last few lines of log: -------------------------------------------------------------------- | OPTIMIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Iteration 30 / LogL: -18257.954 / Time: 0h:34m:11s (1h:39m:3s left) Iteration 40 / LogL: -18198.495 / Time: 0h:43m:33s (1h:22m:39s left) Estimate model parameters (epsilon = 0.100) BETTER TREE FOUND at iteration 41: -18192.145 Iteration 50 / LogL: -18197.447 / Time: 0h:52m:57s (1h:38m:20s left) Iteration 60 / LogL: -18207.874 / Time: 1h:1m:49s (1h:24m:52s left) Iteration 70 / LogL: -18213.242 / Time: 1h:11m:10s (1h:13m:14s left) Iteration 80 / LogL: -18257.026 / Time: 1h:20m:52s (1h:2m:26s left) Iteration 90 / LogL: -18210.481 / Time: 1h:30m:51s (0h:52m:4s left) ERROR: phylokernelnew.h:3273: double PhyloTree::computeLikelihoodFromBufferGenericSIMD() [VectorClass = Vec4d, FMA = true, SITE_MODEL = false]: Assertion `std::isfinite(tree_lh) && \"Numerical underflow for lh-from-buffer\"' failed. ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED I would be grateful for your help! Thanks, Suzanne ", "Hi Suzanne, This looks like a bug, but codon models are known for numerical instability for small data. Just to be sure: can you run successfully in v1.6.12? This version is more stable. If still failed, can you add -m TEST option? It will ignore the complex free-rate models and thus may improve numerical stability. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/df4d40e6-50a8-4e3c-b6f1-83ee94743cd0n%40googlegroups.com "]}, "jJb8G2MrdTU": {"topic": "Conflict in outgroup for model finder and tree dating when dating fixed tree", "initializeDate": "Aug 26, 2020, 3:59:22 AM", "timeStamp": "Aug 26, 2020, 8:32:14 PM", "content": ["Dear IQ-TREE devs/users, I would like to date a fixed tree with outgroup specified using the -o command. Some of the outgroup sequences are identical to one another. When I specify the full set of outgroup sequences to -o, I get this error from model finder: ERROR: Alignment does not have specified outgroup taxon Iceland_330_2020|EPI_ISL_417659|2020-03-14 I think this is because the sequence is a duplicate and is ignored. I found this line in the log file: NOTE: Iceland_330_2020|EPI_ISL_417659|2020-03-14 (identical to England_20134010904_2020|EPI_ISL_423078|2020-03-25) is ignored but added at the end But when I tried specifying only unique outgroup sequences (those found in the .uniqueseq.phy file) I get this error from tree dating: ERROR: Error: The outgroups do not form a monophyletic in the input tree. How can I perform this analysis? I have attached the log files from each run and the type of file I am using to specify the outgroup. My full command is: OUTGROUP=`cat outgroup.txt` $IQTREE \\ -s $FASTA_FILE \\ -te $TREEFILE \\ -m HKY+F+G4 \\ -nt 4 \\ -o $OUTGROUP \\ --date TAXNAME \\ --date-ci 100 \\ --date-outlier 3 \\ --clock-sd 0.4 \\ --date-options \"-a b(2019.872,2019.98) -u 0 -t 0.0008\" \\ -pre $PREFIX ", "Dear Sarah\u2026 (if that is actual name), The easiest solution might be to tell IQ-TREE to keep all identical sequences, i.e. not to discard any. To do so just add the option -keep-ident to your command line. The problem is that if your outgroup contains some identical and some unique sequences then it can happen that the identical sequences are between the unique ones, rendering the unique sequences as being non-monophyletic, because the identical ones are missing from that outgroup subtree. I hope that helps. Best wishes, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2cacc748-cee4-497f-817f-2cb0bc9f31fan%40googlegroups.com > <outgroup.txt><rep_1_job_136057098.log><rep_1_job_136068237.log> ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Dear Heiko, Thanks for the suggestion! Adding -keep-ident solved my issue. All the best, Sarah You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/jJb8G2MrdTU/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6367CAD8-A548-476D-9042-E754490D1A11%40univie.ac.at ", "Thanks Heiko too, it\u2019s good to know Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/210F77DB-FA41-42A4-959E-2D6363134621%40gmail.com "]}, "QbE-csghhAg": {"topic": "Tree search does not work with initial multifurcating tree. Please specify `-n 0` to avoid this.", "initializeDate": "Feb 2, 2020, 1:09:16 PM", "timeStamp": "Feb 6, 2020, 9:10:40 AM", "content": ["Hello Sir, I have used a template tree as normally I could not get expected phylogeny of my taxa set in IQ tree. But an error showing that I have attached the template tree file. Tree search does not work with initial multifurcating tree. Please specify `-n 0` to avoid this Thanks ", "Hi there, What do you mean with \u201ctemplate tree\u201d? This error means that you used -t option, to provide a starting tree for tree search, and the reason provided is quite self-understandable. And I\u2019m a bit cautious when you said \u201ccould not get expected phylogeny\u201d\u2026 you should do some topology test, to make sure that your \u201cexpected phylogeny\u201d is not rejected by the best ML tree, given the data. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/1433308e-464e-4cb5-8d91-5810afa76994%40googlegroups.com <TemTree.txt> "]}, "sDYo9eVZ4Aw": {"topic": "question about site proportion of substitution rate categories", "initializeDate": "Mar 19, 2019, 6:22:44 PM", "timeStamp": "Mar 20, 2019, 7:47:38 AM", "content": ["Hi, while looking at both the \".log\" and \".iqtree\" output files I noticed how they report different proportions of sites in each substitution rate category. The \".log\" output provides the following proportions (12 rate categories example): Empirical proportions for each category: 0.036 0.070 0.072 0.095 0.110 0.108 0.113 0.106 0.110 0.083 0.075 0.022 While the \".iqtree\" output provides the following (12 rate categories example): Category Relative_rate Proportion 1 0.0233 0.0833 2 0.0897 0.0833 3 0.1752 0.0833 4 0.2782 0.0833 5 0.4004 0.0833 6 0.5458 0.0833 7 0.7210 0.0833 8 0.9372 0.0833 9 1.2147 0.0833 10 1.5957 0.0833 11 2.1943 0.0833 12 3.8243 0.0833 Which of those proportions should I use to calculate the expected number of substitutions from a rate category? For example, in a 10,000 sites alignment a branch length of 0.05 would represent 500 substitutions, correct? The sum of expected substitutions from all rate categories ((branch_length * substitution_rate) * (proportion_of_sites * alignment_length)) provide distinct results, as the proportion of each site is distinct. Using the empirical proportions reported in the \".log\" file yields 422.37, while using the fixed and equal proportions reported in the \".iqtree\" file yields the expected number of 499.79 (difference due to rounding proportions). I am aware that discrete categories from the continuous gamma distribution are obtained by dividing the area below the curve in equal areas, but I do not understand why those two distinct site proportions are being reported and which one should I use. Sorry if this is a obvious question, I read through the literature ( Mayrose et al., 2004 Yang 1996 , and Excoffier and Yang 1999 ) but could not figure this step of the IQTree specifically... best, L. Thib\u00e9rio Rangel ", "Dear Thiberio, Quick answer: please do not use this \u201cempirical proportions\u2026\u201d from the log file. Just use .iqtree outputs. The way you described to compute the substitutions makes sense to me. Long answer as you want to know: this so-called empirical proportions were computed using the empirical Bayesian. That means for each alignment site, I compute the posterior probability of that site belonging to each category. The site is then classified into the category with the highest probability. For each category I just counted how many sites are in there. The counts are then normalised by the alignment length, called \u201cempirical proportions\u201d. For whatever reason, I wanted to see how the \u201cprior\u201d correlates with the posteriors. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "0-QlxApggak": {"topic": "IQ-Tree web server", "initializeDate": "Jul 14, 2015, 9:37:15 AM", "timeStamp": "Jul 14, 2015, 9:37:15 AM", "content": ["Dear IQ-Tree users, We are happy to announce that we have substantially improved the IQ-Tree web server ( http://iqtree.cibiv.univie.ac.at ) with more features to match up with the development of the command line version. For example, the partition model now comes to more prominent place, and a bunch of substitution models become available, including protein mixture models like LG4X, C20, CF4, etc, and tree topology testings are also available. Moreover, the model selection now also supports the new selection procedure, which includes the FreeRate model as replacement for +I+G rate heterogeneity. You are welcome to test and use the new web interface and we are happy to take feedbacks. If you want to use any feature that you don\u2019t see in the web interface, please let us know! Best, The IQ-Tree development team "]}, "vxpFJkb3bOo": {"topic": "PMSF and bootstrap", "initializeDate": "May 3, 2018, 3:46:05 AM", "timeStamp": "May 3, 2018, 9:58:34 PM", "content": ["Hi all, We are trying to speed things up with bootstrap by running in parallel the replicates on a cluster. Our lines of command look like that: 1. Get the PMSF tree and freq profiles file.sitefreq: iqtree -nt AUTO -s <alignment> -m LG+C60+F+G -ft <guide_tree> 2. Run the bootstraps in parallel: iqtree -s <alignment> -bo 1 -m LG+C60+F+G -fs <file.sitefreq> -pre boot1 iqtree -s <alignment> -bo 1 -m LG+C60+F+G -fs <file.sitefreq> -pre boot100 My question is how are the frequency profiles at each site estimated from the original alignment fitted to the replicates? Thanks for your help, Fabien ", "No worries, I figured it out ", "Hi Fabien, OK. Nevertheless just in case other users may have similar question, this is explained in our paper ( https://doi.org/10.1093/sysbio/syx068 ), pasted here for convenience: To further ease the computational cost for bootstrap analysis under PMSF (or MAX), instead of refitting a full mixture model (e.g., LG+C20+F+G) to compute the PMSF profile for every bootstrap replicate, the site patterns and their associatedPMSF frequency vectors were resampled from the original alignments. The resampled PMSF profiles are then applied to compute the bootstrap trees for the corresponding bootstrap replicate. Experiments showed that a full refitting of PMSF for each bootstrap replicate yielded nearly identical results to this \u201cresampled PMSF strategy\u201d. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "q61wAdtqpog": {"topic": "IQ-TREE release 1.3.12", "initializeDate": "Jan 19, 2016, 5:08:51 AM", "timeStamp": "Jan 19, 2016, 5:08:51 AM", "content": ["Jan 19, 2016 Dear users, IQ-TREE version 1.3.12 is just released that improves stabilities ( http://www.cibiv.at/software/iqtree/release/ Bug fixes: * A crash when performing analysis on partitioning schemes produced by the k-means algorithm of PartitionFinder (reported by Pete Hosner). This is due to a partition containing only constant sites and the other partitions containing only variable sites. Such partitioning schemes are not recommended for phylogenetic analysis and users are advised to consult PartitionFinder author. * A crash with too high or too low rates for FreeRate model (reported by Hermes Escalona and Adrian Arellano Davin). Best, IQ-TREE development team "]}, "jlhctvrSJC4": {"topic": "Iqtree crashes with segmentation fault when use fixed clock", "initializeDate": "Apr 21, 2021, 5:38:20 AM\u00a0(7 days ago)\u00a0", "timeStamp": "Apr 24, 2021, 3:19:00 PM\u00a0(3 days ago)\u00a0", "content": ["Dear all, when I try to use a fixed clock rate with the command --date-options \"-w....\" the program stops always with the following message : --- Start phylogenetic dating --- Reading date file date355.txt ... 355 dates extracted Building time tree by least-square dating (LSD) with command: lsd -i B_355.fas.timetree.subst -s 29400 -o B_355.fas.timetree -r a -d B_355.fas.timetree.date -w rate.txt TREE 1 *PROCESSING: Reading the tree ... Collapse 287 (over 352) internal branches having branch length <= 1.7e-05 (settable via option -l) Parameter to adjust variances was set to 0.00034 (settable via option -b) ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: B_355.fas.log ERROR: *** Alignment files (if possible) The command was >iqtree2 -s B_355.fas -m GTR+F+I+G4 --date date355.txt --date-options \"-w rate.txt\" -te B_355.fas.treefile -o \"name.outgroup\" -nt AUTO Moreover, a message of Windows that iqtree stopped now appears (see image attached) I don't understand if there is a conflict in the instructions or if I made some other error. Thank you in advance for the help!!! I posted this help request under a different discussion, but I didn't received reply. So I decided to post a new conversation. Sorry, is important. Gianni ", "Hi Gianni, Can I ask what do you have in your file rate.txt? Does it contain the value of the rate you want to fix? Do you have the same error without option --date-options \"-w....\"? Hien You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7b6d6bc5-3655-4591-9edc-4a371edaf4c4n%40googlegroups.com ", "Hi Hien, thank you for your answer. The file Rate.txt contains only one evolutionary rate, because there is only one tree. You can find the rate file in attach for clarity. No, without the option \"-w....\" i didn't have problems. I have also tried the command --date-options \"-a......\" and it worked normally. I have problems only with \"-w...\". Gianni ", "Hi Gianni, Just wondering whether your file is Rate.txt or rate.txt because in the command you used 'rate.txt', while the attached file is 'Rate.txt' But if the file does not exist, it should return another error like 'cannot read the file ...' . If. there's no problem about the file name, could you send me your data (the tree inferred by iq-tree and the date file) so that I could look for the problem. Cheers, Hien To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/885b8ab3-c49e-4b06-89d8-9b10467a18f0n%40googlegroups.com "]}, "U7E7WTZXReI": {"topic": "quartet mapping and accompanying tree output", "initializeDate": "Feb 29, 2020, 4:52:01 AM", "timeStamp": "Mar 6, 2020, 10:52:29 AM", "content": ["Hi all, just a quick question: the tree you automatically get (and which is done a priori) when doing quartet mapping, is this similar to tree inference based on tree puzzling (like the in Tree Puzzle) or is it just a \"standard\" inferred ML tree (not using the quartet puzzling algorithm)? Thanks Karen ", "Hi Karen, Quick answer: it\u2019s the ML tree. But note that if you use \u201c-n 0\u201d option, then it\u2019s the maximum parsimony tree. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5ec44e1f-c6e4-407b-bdba-80db8ca1d34a%40googlegroups.com ", "Many thanks Minh!! :) (There is no \"plan\" to implement in IQ-TREE the tree-puzzling heuristics for inferring a ML tree, correct?) Thanks & best, Karen Am Samstag, 29. Februar 2020 15:20:26 UTC+1 schrieb Minh Bui: Hi Karen, Quick answer: it\u2019s the ML tree. But note that if you use \u201c-n 0\u201d option, then it\u2019s the maximum parsimony tree. Minh On 29 Feb 2020, at 1:52 am, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Hi all, just a quick question: the tree you automatically get (and which is done a priori) when doing quartet mapping, is this similar to tree inference based on tree puzzling (like the in Tree Puzzle) or is it just a \"standard\" inferred ML tree (not using the quartet puzzling algorithm)? Thanks Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Karen, That\u2019s right, there is no plan to implement quartet puzzling. That method is outdated and we don\u2019t see a point why to implement it. Heiko can perhaps shed further light into the reason. Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ef44f374-c538-4ad4-a9dc-ed1541321881%40googlegroups.com ", "Would be interested why not because I think it might be outdated but still valid - but Tree puzzle can just be applied to smaller datasets - also since other quartet based tree inference methods like e.g.Astral becomes againb ore and more popular... Thanks in advance! Best, Karen Am Freitag, 6. M\u00e4rz 2020 02:26:30 UTC+1 schrieb Minh Bui: Hi Karen, That\u2019s right, there is no plan to implement quartet puzzling. That method is outdated and we don\u2019t see a point why to implement it. Heiko can perhaps shed further light into the reason. Cheers, Minh On 1 Mar 2020, at 2:37 am, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Many thanks Minh!! :) (There is no \"plan\" to implement in IQ-TREE the tree-puzzling heuristics for inferring a ML tree, correct?) Thanks & best, Karen Am Samstag, 29. Februar 2020 15:20:26 UTC+1 schrieb Minh Bui: Hi Karen, Quick answer: it\u2019s the ML tree. But note that if you use \u201c-n 0\u201d option, then it\u2019s the maximum parsimony tree. Minh On 29 Feb 2020, at 1:52 am, 'Karen Meusemann' via IQ-TREE < iqt...@googlegroups.com > wrote: Hi all, just a quick question: the tree you automatically get (and which is done a priori) when doing quartet mapping, is this similar to tree inference based on tree puzzling (like the in Tree Puzzle) or is it just a \"standard\" inferred ML tree (not using the quartet puzzling algorithm)? Thanks Karen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5ec44e1f-c6e4-407b-bdba-80db8ca1d34a%40googlegroups.com You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ef44f374-c538-4ad4-a9dc-ed1541321881%40googlegroups.com "]}, "BKLGz78APIc": {"topic": "Multiple partitions and missing data", "initializeDate": "Sep 9, 2017, 12:10:47 PM", "timeStamp": "Sep 12, 2017, 7:13:06 AM", "content": ["I've got ~1,000 genes spanning ~60 taxa each in separate .phy alignments that were built from orthogroup clustering. I point to each .phy file as a charset in the .nex and specify the model based on the 'iqtree -m TEST' output for each individual alignment. Many (most) groups don't contain all taxa, so there is a large amount of missing data and I see the \"WARNING: Too high (saturated) partition rates for proportional partition model!\" in the logs. The resulting tree is built with equivalent branch lengths for all branches. I'm using 1.6b4.. is there a better way to deal with the missing data problem? Would decreasing the number of partitions by trying a partitionfinder run or combining partitions that fit the same model make any difference? .. neither would decrease the actual amount of missing data, though. Thanks! ", "Hi Dana, On Sep 9, 2017, at 6:10 PM, Dana Price < dana....@gmail.com > wrote: I've got ~1,000 genes spanning ~60 taxa each in separate .phy alignments that were built from orthogroup clustering. I point to each .phy file as a charset in the .nex and specify the model based on the 'iqtree -m TEST' output for each individual alignment. Many (most) groups don't contain all taxa, so there is a large amount of missing data and I see the \"WARNING: Too high (saturated) partition rates for proportional partition model!\" in the logs. Among the 1000 partitions (genes), what are the lengths of the shortest and longest partitions? This WARNING means that you may have over-parameterization problem (overfitting) for the edge-proportional partition model (-spp option) caused e.g., by many short partitions. You should definitely do PartitionFinder (or our implementation in ModelFinder) to merge partitions, which in effect reduce the number of model parameters. After that the WARNINGs might disappear. In case it still appears, then try the edge-equal partition model (-q option) to further reduce the number of parameters. The resulting tree is built with equivalent branch lengths for all branches. Do you mean that branch lengths in the resulting tree are all equal? That sounds something wrong, so please try my suggestions above. I'm using 1.6b4.. is there a better way to deal with the missing data problem? Would decreasing the number of partitions by trying a partitionfinder run or combining partitions that fit the same model make any difference? .. neither would decrease the actual amount of missing data, though. Right, the amount of missing data stay the same. But as I noted above, by reducing the number of partitions you will reduce the model parameters such that you are able to estimate them. That is actually the whole point behind PartitionFinder. Note that IQ-TREE is able to handle missing data via an efficient data structure (for details see 10.1093/sysbio/syw037 Cheers, Minh Thanks! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "CYb_5uWSxdQ": {"topic": "IQtree fails with codon model", "initializeDate": "Sep 26, 2019, 12:33:03 AM", "timeStamp": "Oct 2, 2019, 9:35:17 PM", "content": ["Dear Minh, I recently started an analysis using codon model in IQtree (version 1.6.10), but constantly receive error message like this: NOTE: 149682 MB RAM (146 GB) is required! Measuring multi-threading efficiency up to 64 CPU cores /var/spool/slurmd/job78437/slurm_script: line 20: 3146 Bus error iqtree -nt AUTO -st CODON -s 525TaxaChalcidoideaAHE.NT12NT123.989exons.fas -spp 3.8_525TaxaChalcidoideaAHE.NT12NT123.989exonsPart.CodonModel.best_scheme.nex -bb 1000 -bnni -wbt -pre 3.8_525TaxaChalcidoideaAHE.NT12NT123.989exonsPart.CodonModel.1000UFboots -cptime 60 -safe It seems like a problem without enough RAM. But when I set up this analysis, I assigned 60 CPUs each with 4G memory like following: #!/bin/bash -l #SBATCH --nodes=1 #SBATCH --ntasks=60 #SBATCH --mem-per-cpu=4G #SBATCH --time=30-00:00:00 #SBATCH --output=3.8_525TaxaChalcidoideaAHE.NT12NT123.989exonsPart.CodonModel.1000UFboots #SBATCH --mail-user= jxzha...@gmail.com #SBATCH --mail-type=All #SBATCH --job-name=\"3.8_525TaxaChalcidoideaAHE.NT12NT123.989exonsPart.CodonModel.1000UFboots\" #SBATCH -p batch Could you help me out with this problem? Thank you! Junxia ", "Hi Junxia, This \u201cBus error\u201d problem likely has something to do with the system. To filter out the not enough RAM issue, can you please re-run this analysis with half of the data or less (e.g. by just removing half of the partitions from the partition file). And let me know how it works. One thing I notice: -st CODON is not necessary, if you provide best_scheme.nex file, which already has CODON specification. Also please update the latest version 1.6.12. It is the most stable version. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/3FBC00B1-EE09-4F05-A2EB-C3460F25A0A4%40gmail.com "]}, "HT7F2yC_KIY": {"topic": "Re: iqtree - Google Groups: Message Pending [{IL6Q3K6MzIq9fCoCaWcwAPkZGH3Cg29H0}]", "initializeDate": "Feb 27, 2015, 3:41:33 PM", "timeStamp": "Feb 27, 2015, 4:26:19 PM", "content": ["Dear Laura, yes this option is \"-wsl\" (for write site log-likelihoods). You can also write log-likelihoods per site per category (if you specified \"+G\" or \"+R\" models) with \"-wslg\" option. Cheers, Minh ---------- Forwarded message ---------- From: eme....@gmail.com To: iqt...@googlegroups.com Cc: Date: Mon, 9 Feb 2015 08:49:11 -0800 (PST) Subject: Site likelihoods Hi all, I was wondering if there is an option to retrieve site likelihoods? Many thanks, Laura ", "Thank you so much! "]}, "8uM7r6gXR-M": {"topic": "Beta version 1.6.beta", "initializeDate": "May 7, 2017, 4:51:35 PM", "timeStamp": "May 18, 2017, 2:57:44 AM", "content": ["May 8, 2017 Dear IQ-TREE users, We are pleased to release the beta version 1.6.beta (available at http://www.iqtree.org ) with many new cool features. During this beta-testing phase, feedback is much appreciated. Notable new features: \u2022 Polymorphism-aware models accounting for incomplete lineage sorting (code contributed by Dominik Schrempf). \u2022 Lie Markov and non-reversible models (code contributed by Michael Woodhams). \u2022 Heterotachy models accounting for rate variation across sites and lineages. \u2022 Xeon Phi Knights Landing (AVX-512) support with 2X or more speedup. \u2022 New option -fast to match the speed of FastTree program while still obtaining better trees [Experimental]. New features: \u2022 -wql option now prints quartet area and corner in .quartetlh file (requested by Karen Meusemann). \u2022 Support GENE resampling (-bspec GENE) and GENESITE resampling (-bspec GENESITE) for standard bootstrap with partition models. \u2022 Sequential and multicore versions are merged, thus iqtree-omp executable becomes iqtree. Bugfixes (inherited from 1.5.5-beta): \u2022 Likelihood underflow for large multifurcating trees (e.g. consensus tree) (reported by Giap Nguyen). \u2022 Crash with -minsupnew option (reported by Longzhi Tan). \u2022 Compilation with gcc under Mac (thanks @ilovezfs). \u2022 Crash with -nni1 for partition model -spp (reported by Diep). Best, IQ-TREE development team ", "Dear developers, I'm running IQ-TREE v1.6 with the following call: ./iqtree -st DNA -s f18.28.16.afa -spp part.txt -m TESTNEWMERGE -pre setA_opt1 -o Bacillaria_paxillifer -nt AUTO -pers 0.31 and getting this error message: ERROR: phylokernel.h:1497: void PhyloTree::computePartialParsimonyFastSIMD(PhyloNeighbor *, PhyloNode *) [VectorClass = Vec4ui]: Assertion `!aln->ordered_pattern.empty()' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: setA_opt1.log ERROR: *** Alignment files (if possible) I have not tried to figure out what exactly throws this error. I've run the same dataset with a heterotachy model (GTR+F0+H2 and GTR+F0+H4) and it finished without trouble. So I presume the error is related to the partitioning. The log file and input data are attached to this message. Regards, Teo ", "Dear Teo, thanks. I found where the problem is introduced in this beta release, which I will fix. For now you can continue the analysis by replacing \" -spp part.txt\" with \"-spp setA_opt1.best_scheme.nex\". This file stores the best partitioning scheme found so far. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thanks Minh, please let me know when you've had a chance to push the fixed version. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com ", "Dear Teo, I just pushed the fix, you can download here: https://github.com/Cibiv/IQ-TREE/releases/tag/v1.6.beta2 Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "KVJ9Tx7YvRE": {"topic": "Polytomies while dating a tree", "initializeDate": "Jul 27, 2020, 10:09:39 PM", "timeStamp": "Aug 6, 2020, 4:59:52 PM", "content": ["I have a question regarding my dating tree. I found it strange to see a kind of polytomy in the node of the figure attached. It happed to me with other species before, which I deleted thinking that the short divergence time is creating polytomy. However, after deleting this species, the other closely related species appears now as the polytomy. Any suggestions on how to solve this? Thank you very much in advance. ", "Hi Gus, Polytomies in dating tree can be avoided if you set a positive minimum branch length for it. For example if you want that all branches of the dating tree have length >= 20My, you can add option --date-options \"-u 20\" I guess your sequences are very long, so the default estimated min branch length for dating tree is so small that allows polytomies in the tree. So for this case, I think you should manually set your own min branch length with your own value. A suggestion for this value could be approximately m/rate where is the minimum branch length of the input tree and rate is the estimated rate from your previous run. Another possible suggestion could be tree_height/nbTaxa , where tree_height in your case is 450 and nbTaxa is the number of taxa (you have 19 heree). Let me know if you have concern about this. Cheers, Hien From: iqt...@googlegroups.com \" < iqt...@googlegroups.com > on behalf of gusta10 < gus.san...@gmail.com Reply to: iqt...@googlegroups.com \" < iqt...@googlegroups.com Date: Tuesday, 28 July 2020 at 04:09 To: IQ-TREE < iqt...@googlegroups.com Subject: [iqtree] Polytomies while dating a tree I have a question regarding my dating tree. I found it strange to see a kind of polytomy in the node of the figure attached. It happed to me with other species before, which I deleted thinking that the short divergence time is creating polytomy. However, after deleting this species, the other closely related species appears now as the polytomy. Any suggestions on how to solve this? Thank you very much in advance. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/260c7bf1-87d5-4a33-94c5-ff419d87de5bo%40googlegroups.com ", "Thank you Hien, This tree is based on mitochondrial protein-coding genes, with model for partitions. I still cannot solve my problem. I tried the all the alternatives you gave me. The lowest value for --date-options was \"-u 0.04\", but still cannot resolve the polytomy. The rates estimated was: Partition-specific rate s: 0.755 0.838 1.182 0.962 1.212 1.117 1.192 1.087 0.946 1.022 1.249 0.943 0.745 rate 0.000829351, tMRCA -449.517 Is there any other possible solution? Thanks in advance To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Sorry to jump in, How about -u 0? I.e. setting the lower bound to 0. And Hien will set this as the default in the next version. As this sounds similar to another question posted just a few days ago. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ee887800-da34-4d99-b233-e7526a990644o%40googlegroups.com ", "Thank you Minh, Still the same problem by setting -u 0 Here is the log: Reading the tree ... Collapse 0 (over 16) internal branches having branch length <= 4.46e-05 (settable via option -l) Parameter to adjust variances was set to 0.0712 (settable via option -b) Minimum branch length of time scaled tree was set to 0 (settable via option -u and -U) Estimating the root position on all branches using fast method ... *RESULTS: - Dating results: rate 0.000829362, tMRCA -449.602 On Wednesday, July 29, 2020 at 12:09:58 PM UTC+9, Minh Bui wrote: Sorry to jump in, How about -u 0? I.e. setting the lower bound to 0. And Hien will set this as the default in the next version. As this sounds similar to another question posted just a few days ago. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ee887800-da34-4d99-b233-e7526a990644o%40googlegroups.com ", "From what pasted, it looks like \u201c-l\u201d is the relevant option, not -u. Can you try \"-l 0\"? Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7d2dede9-51eb-4af3-b6c7-9add2a1d7e54o%40googlegroups.com ", "Still the same problem. Here is how I run it: iqtree2 -s species.aln -spp partition.txt --date date_file.txt -te species.treefile -nt AUTO -pre species.dating -m species.best_model.nex --date-tip 0 --date-options -l 0 Other section of the output: TREE 1 *PROCESSING: Reading the tree ... Collapse 0 (over 16) internal branches having branch length <= 0 (settable via option -l) Parameter to adjust variances was set to 0.0712 (settable via option -b) Minimum branch length of time scaled tree (settable via option -u and -U): 0.0686, rounded to 0.069 (69/1e+03) using factor 1e+03 (settable via option -R) Estimating the root position on all branches using fast method ... *RESULTS: - Dating results: rate 0.00082937, tMRCA -449.576 And attach are the polytomy and the original tree with the branch length Thank you for your help On Wednesday, July 29, 2020 at 2:53:57 PM UTC+9, Minh Bui wrote: From what pasted, it looks like \u201c-l\u201d is the relevant option, not -u. Can you try \"-l 0\"? Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7d2dede9-51eb-4af3-b6c7-9add2a1d7e54o%40googlegroups.com ", "Hi Gus, I seems that there's a bug with the minimum branch length option when it has to estimate the root position. I'll look at that tomorrow and let you know. Hien ", "Hi Gus, I\u2019ve fixed this bug in the new version 1.8.3 of lsd2, available on master branch of lsd2 github. Let me know if the problem persists. Thanks for raising this. @Minh: could you integrate this version to IQ-tree? In this version, I also change the setting of min branch length as in this issue , and stop when there\u2019s not unique solution as in this issue Hien You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5d22393b-1694-49c0-9b70-3fa4085eee2do%40googlegroups.com ", "Thank you Hien, This time I run it like: lsd2_unix -i species.iqtree.modelF.treefile -s 11211 -o species.dating_lsd2.timetree -r a -d dates.lsd2.txt -u 0 -z 0 but the problem is that it puts the tMRCA much older than before (now 900, before 449) The estimate rates were: rate 0.00293835, tMRCA -900.113 , objective function 0.210712 Compared with the previous analysis (with the polytomy): rate 0.000829338, tMRCA -449.537 When I use \"-a 449\" I had a segmentation fault problem. PD: I am using the lsd2 format of calibration: mrca(sp1,sp2,sp3,sp4,..) -293 For iqtree, I used: sp1,sp2,sp3,sp4,.. -293 Am I doing something wrong? Best To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi all again, In order to solve the large estimation of the root age. I set the age in the commands using a rooted tree: lsd2_unix -i species.rooted.tree -s 11211 -o species.dating_lsd2_root.timetree -r a -d dates.lsd2.txt -a -449 -z 0 -u 0 And it works fine, however, I notice some the age of SOME nodes has changed to more recent estimates (for example 75 Mya to 35 Mya). ", "Hi Gus, I\u2019m a bit concerned about large differences between the 2 versions. If possible, could you send me your input tree and date file? I\u2019d like to see what causes that difference, maybe the root position \u2026 Thanks Hien To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6349154f-ae37-4848-b5fa-eeb6106fbe94o%40googlegroups.com ", "Thank you Hien, Please find attached the files. The size of the aligned matrix is 11211 bp. Thanks in advance On Friday, July 31, 2020 at 6:02:40 PM UTC+9, Hien To wrote: Hi Gus, I\u2019m a bit concerned about large differences between the 2 versions. If possible, could you send me your input tree and date file? I\u2019d like to see what causes that difference, maybe the root position \u2026 Thanks To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6349154f-ae37-4848-b5fa-eeb6106fbe94o%40googlegroups.com ", "To mention something else perhaps relevant. I notice the estimate dates using nucleotides and aminoacids changes. Thanks ", "Hi Gus, I've tried the data you sent on 2 versions and have the same results. Could you check again if the tree before is the same? I'll look further if there's any bug in the new version. Hien ", "Hi, I\u2019ve fixed a bug on the master branch of lsd2 github, relating to error when you specify root date for unrooted tree. Could you try the new version and let me know if there\u2019s any other issue? To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b8ab5fc4-9d72-494b-bd73-f512cee9543eo%40googlegroups.com "]}, "cEO_3g9-yQA": {"topic": "most probable root taxon", "initializeDate": "Jun 13, 2020, 5:08:03 AM", "timeStamp": "Aug 5, 2020, 11:51:07 PM", "content": ["dear all, is there any test in IQ-tree for detecting the most probable root taxon in the unrooted tree? is it possibble to estimate probabilities of every taxon in the alignment to be the root except performing a series of constraint analyses? ", "Hi Phillipp, The short answer to this is 'no'. However, we are working on just such tests, and will have a preprint out on these relatively soon. They are based on exactly the approach you suggest. Note that you will need to use non-reversible models (the likelihood will be the same no matter where the root is on the tree if you use a reversible model), and also note that the root could be on an internal branch, not just a terminal branch. Rob On Sat, 13 Jun 2020 at 19:08, Philipp Chetverikov < philipp.c...@gmail.com > wrote: dear all, is there any test in IQ-tree for detecting the most probable root taxon in the unrooted tree? is it possibble to estimate probabilities of every taxon in the alignment to be the root except performing a series of constraint analyses? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c5dc2713-204a-482f-bc4b-ff56630ab5f6o%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Hi Philipp and others, As a follow-up, we have just posted a preprint, with a measure that we call `rootstrap` (rooting by bootstrap), that can compute the support of every branch to be the root using non-reversible models: Assessing Confidence in Root Placement on Phylogenies: An Empirical Study Using Non-Reversible Models View ORCID Profile Suha Naser-Khdour View ORCID Profile Bui Quang Minh Robert Lanfear doi: https://doi.org/10.1101/2020.07.31.230144 Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmoTHJcROv_nrJQKfUP7LEPxXvBwV6MvO8_C-5iPM-gHPA%40mail.gmail.com "]}, "VGTrCXlTlSM": {"topic": "Selecting partition scheme is not progressing to tree construction", "initializeDate": "Jul 14, 2017, 9:32:18 AM", "timeStamp": "Jul 25, 2017, 8:33:35 AM", "content": ["Hi, Im trying to construct a partitioned phylogeny using loci locations. I input the partitions into the file part.nex and use the following command to determine the model of best fit for each iqtree -nt AUTO -s alignment.fasta -spp part.nex -m TESTMERGE --rcluster-max 100 My dataset has 140 tax and 2530 gene Im currently using iq-tree beta 1.6.4. To my understanding once the models have been selected it should progress into tree construction. I tried re-starting the analysis but it again ends after model selection. ", "Hi Lynda, Just to be sure: there is a typo with the option -rcluster-max instead of --rcluster-max TESTONLYMERGE will stop after model selection, but TESTMERGE should continue with tree reconstruction. Thus, I cannot reproduce this behavior. Can you please send me the log file? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "So I have restarted the run 3 times, here is the tail from each run Also Im running this on a HPC with a pbs script. I get this message at the end of the output PBS /var/spool/torque/mom_priv/jobs/ 615529.HPC.SC : line 14: 31117 Killed Run1: 303453 HKY 16623436.645 part956+part1727 42h:0m:32s (838h:51m:53s left) 303454 F81 16623271.919 part1792+part1855 42h:0m:33s (838h:51m:58s left) 303455 HKY 16623270.869 part234+part2247 42h:0m:34s (838h:52m:3s left) 303456 HKY+I 16623276.446 part964+part2107 42h:0m:34s (838h:52m:6s left) 303457 F81+I 16623264.428 part90+part2302 42h:0m:35s (838h:52m:7s left) 303458 F81 16623258.828 part912+part1871 42h:0m:35s (838h:52m:8s left) 303459 HKY+I 16623280.661 part234+part2026 42h:0m:36s (838h:52m:18s left) 303460 F81 16623273.202 part1792+part1867 42h:0m:37s (838h:52m:17s left) 303461 F81 16623243.196 part310+part1820 42h:0m:37s (838h:52m:18s left) 303462 HKY 16623247.447 part77+part2079 42h:0m:38s (838h:52m:23s left) 303463 F81 16623307.574 part1990+part2343 42h:0m:39s (838h:52m:30s left) 303464 F81 16623302.705 part1400+part1794 42h:0m:40s (838h:52m:33s left) 303465 F81 16623279.489 part35+part1564 42h:0m:40s (838h:52m:32s left) 303466 F81 16623232.532 part912+part1836 42h:0m:41s (838h:52m:45s left) 303467 F81 16623307.899 part912+part1011 42h:0m:42s (838h:52m:48s left) 303468 K2P+I 16623286.815 part100+part2380 42h:0m:43s (838h:52m:48s left) 303469 JC 16623271.297 part1400+part1793 42h:0m:43s (838h:52m:51s left) 303470 JC+I 16623275.429 part1654+part1903 42h:0m:44s (838h:52m:53s left) 303471 F81+I 16623265.064 part641+part2197 42h:0m:44s (838h:52m:53s left) 303472 F81 16623252.049 part779+part2343 42h:0m:45s (838h:52m:53s left) Run2: 2362 JC 3048.281 part2056 0h:0m:4s (3h:12m:25s left) 2363 JC 3088.686 part2063 0h:0m:4s (3h:12m:29s left) 2364 F81 3113.199 part2085 0h:0m:4s (3h:12m:33s left) 2365 F81 3088.530 part2080 0h:0m:4s (3h:12m:36s left) 2366 JC 2925.923 part2055 0h:0m:4s (3h:12m:46s left) 2367 JC 2321.794 part2032 0h:0m:4s (3h:12m:51s left) 2368 JC 2621.453 part2031 0h:0m:4s (3h:12m:55s left) 2369 JC 3317.867 part2039 0h:0m:4s (3h:13m:0s left) 2370 JC 3128.917 part2051 0h:0m:4s (3h:13m:5s left) 2371 JC 3108.823 part2050 0h:0m:4s (3h:13m:9s left) 2372 F81 3838.689 part1933 0h:0m:4s (3h:13m:15s left) 2373 JC 3735.121 part1921 0h:0m:4s (3h:13m:19s left) Run3: 2404 JC 4048.138 part1363 0h:0m:4s (2h:58m:57s left) 2405 F81 3365.618 part1311 0h:0m:4s (2h:59m:2s left) 2406 F81 4680.441 part1312 0h:0m:4s (2h:59m:7s left) 2407 JC 2632.204 part1262 0h:0m:4s (2h:59m:12s left) 2408 JC 1848.004 part1232 0h:0m:4s (2h:59m:17s left) 2409 JC 2180.950 part1237 0h:0m:4s (2h:59m:22s left) 2410 F81 2843.209 part1238 0h:0m:4s (2h:59m:27s left) 2411 JC 2263.824 part1173 0h:0m:4s (2h:59m:32s left) 2412 F81 5435.005 part1209 0h:0m:4s (2h:59m:38s left) ", "Hi Lynda, sorry I overlooked your log file sent in a previous email. As far as I see, there is no crash message. So it seems that IQ-TREE was stopped externally and not by itself, i.e. it could be killed by the HPC system. Can you check if there is any time limit on your HPC cluster? Is there RAM limit as well? Is there disk space limit? Have a look at .model file (which stores all model information), this file can be extremely large for your data set. You may also consult your admin about this. One more hint: you have a very large data set with ~2500 partitions, thus it is good to activate the rcluster algorithm. However, -rcluster-max option alone will not do it. You need to specify -rcluster 10 as well, so that both options are effective. Minh ", "Great thanks Minh. Ill let you know how I get on. Ill ask my admin also about limitations. Lynda Gunn, PhD Research Fellow - DPTC Center for Food Safety, School of Biosystems and Food Engineering, University College Dublin, Belfield, Dublin 4, Ireland. ", "Hi Minh, So iqtree appears to be running better but there is another issue which is cropping up again. The ETA to completion initially start decreasing but after ~1500 iterations the time to completion increases. Ive recently switch worker nodes on the HPC which provided 757GB RAM and 24 processors and its still happening. Current command: iqtree -nt AUTO -s alignment.fasta -spp part.nex -m TESTMERGE -rcluster-max 100 -rcluster 10 ", "Dear Linda, not knowing the output you are referring to, I am not entirely sure, but I guess the increased of the estimated time is caused by the following: Due to the stochastic nature of IQ-Tree with its perturbation step, it is hard to estimate the real amount of time still to go. Thus, the time IQ-Tree outputs to screen and logfile is the time until it stops if no better tree is found any more. That means, by default IQ-Tree stops if it does not find a better tree for 100 iterations (if the user did not set a different number), and the time is estimated until this point. That also means whenever there is a better tree found the counting starts anew for another 100 iterations and so on. I hope this answers your question, Heiko "]}, "Fr6cOz9Sbfg": {"topic": "Empirical codon models from Jesse Bloom", "initializeDate": "Feb 13, 2020, 2:06:02 PM", "timeStamp": "Feb 17, 2020, 12:16:41 AM", "content": ["Hi there, I was hoping to do some reconstruction of viral phylogenies using various codon models. Some models that have been getting traction and are of interest are Bloom's empirical models (e.g., Bloom, 2014 Hilton and Bloom, 2018 ). I saw the IQTREE 2 release, so I was wondering if there any plans to implement his lab's empirical models? They could be useful in generating more comparisons across codon models and reconstructions more broadly. Thank you! Best, Jonathan ", "Hi Jonathan, Rob and I had a quick chat about Bloom\u2019s model. Is is right, that you have site-specific substitution models, where the model parameters were estimated by some experiments, independent of the alignment? If yes, then you can already do that in IQ-TREE by specifying a partition model, each having exactly one site, and specifying the model parameters such as GTR{a,b,c,d,e,f}. Here is an example of a customized parttion model file: #nexus begin sets; charset part1 = 1-999\\3 2-999\\3; charset part2 = 3-999\\3; charset part3 = 1000 - .\\3; charpartition mymodels = TIM2{5.29804,8.30284,24.2956}+F{0.338664,0.243506,0.202156,0.215674}+G4{0.484649}: part1{4.21988}, TIM2{3.8281,6.34127,17.7824}+F{0.388585,0.211698,0.185192,0.214526}+G4{0.529975}: part2{3.62666}, TIM2{4.7751,6.22923,20.8781}+F{0.348488,0.235627,0.174244,0.241642}+I{0.25031}+G4{0.779882}: part3{4.82709}; end; Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/81381014-8e18-4421-908f-e56766fe0987%40googlegroups.com ", "Hi Minh, (I could just walk down the hallway, but I thought it might also be worth saying here). Turns out it's not that simple. The link Jonathan provided above describes the new codon model. They currently have their own software called phydms to fit the models. That software is decsribed here: https://peerj.com/articles/3657/?utm_content=bufferfc37b&utm_medium=TrendMD&utm_source=TrendMD&utm_campaign=PeerJ_TrendMD_1 and implemented here: https://github.com/jbloomlab/phydms The software is really nicely documented (and more importantly the methods are well described in the publications). Jonathan - to respond specifically to your question, I don't think there are plans to implement these models just yet. But we do have a grant to create a framework that would democratise model implementation such that anyone could implement any model, so these models are certainly something we'll have in mind during that process. Rob To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ED115469-5870-4E12-BFED-CBA4FA73EB6B%40univie.ac.at Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com "]}, "j70WAczjA6o": {"topic": "Confused about site rates calculations.", "initializeDate": "Apr 2, 2019, 10:53:47 PM", "timeStamp": "Apr 3, 2019, 12:13:09 PM", "content": ["I am interested in site-specific rates of evolution for a variety of reasons. For one reason, they can help with determining the relative selection pressure on different bases, codons, or protein regions. IQ-tree has a \"-wsr\" option to \"write site rates\" that would be highly useful for this. However, I am having trouble with the results I am getting. The log files (as well as just eyeballing the alignment file) show that 44% of all sites in this multiple sequence alignment (attached in FASTA format) are invariant. However the rates output does not even have a \"zero\" rate category, and less than 44% of sites fall in the slowest 3 rate categories. Full log file and tree, plus the alignment, are attached. Also, the high proportion of sites in rate category 15 seems a little odd. There is not a bell curve of sites/rates as a gamma distribution would mimic. I have used other methods of site-secific rate calculations over the years, never on this exact data set, and the rates often come close to a gamma plus invariant situation. There is usually a huge peak of invariant sites due to strong selection on first/second codon positions in protein-coding DNA, plus a \"bell curve\" of sites with some small to high rate of evolution. Often, there are a very few sites at the far side of the bell curve with very very fast rates of evolution, presumably due to positive selection for change over time. Anyway, my major question here is about the lack of a \"zero rate\" category with some 44% of the sites showing no change over time in this alignment. The data set is complete mitochondrial genomes of primates. The tree topology is completely as expected, for example with humans and neanderthals being slightly closer to chimpanzees than to gorillas. SEQUENCE ALIGNMENT ------------------ Input data: 76 sequences with 13994 nucleotide sites Number of constant sites: 6148 (= 43.9331% of all sites) Number of invariant (constant or ambiguous constant) sites: 6148 (= 43.9331% of all sites) Number of parsimony informative sites: 7079 Number of distinct site patterns: 7188 ... Category Relative_rate Proportion 1 0.001241 0.1693 2 0.004507 0.1218 3 0.01128 0.08395 4 0.0322 0.05398 5 0.1401 0.04736 6 0.1686 0.04064 7 0.2968 0.02949 8 0.5427 0.03561 9 0.5794 0.036 10 0.6215 0.03377 11 1.257 0.03156 12 1.341 0.03848 13 1.487 0.04456 14 2.878 0.07716 15 2.988 0.1292 16 5.436 0.0271 ... ", "I just found this line, about empirical proportions found for each of the 16 rate categories, in the run log: Empirical proportions for each category: 0.439 0.000 0.000 0.012 0.091 0.008 0.008 0.029 0.055 0.013 0.000 0.017 0.065 0.000 0.245 0.019 and here we see the 44% with zero rate, and then maybe sort of a bell curve plus a rather large 24.5% of sites in category 15. \"... Rate parameters: A-C: 0.50140 A-G: 22.95408 A-T: 0.66876 C-G: 0.78621 C-T: 12.49882 G-T: 1.00000 Base frequencies: A: 0.382 C: 0.330 G: 0.069 T: 0.219 Site proportion and rates: (0.169,0.001) (0.122,0.005) (0.084,0.011) (0.054,0.032) (0.047,0.140) (0.041,0.169) (0.029,0.297) (0.036,0.543) (0.036,0.579) (0.034,0.622) (0.032,1.257) (0.038,1.341) (0.045,1.487) (0.077,2.878) (0.129,2.988) (0.027,5.436) Parameters optimization took 7 rounds (85.654 sec) BEST SCORE FOUND : -233159.784 Empirical proportions for each category: 0.439 0.000 0.000 0.012 0.091 0.008 0.008 0.029 0.055 0.013 0.000 0.017 0.065 0.000 0.245 0.019 Site rates printed to /tmp/IQTREE/AUITdWKNLR/iqt.rate Total tree length: 6.586 Total number of iterations: 102 CPU time used for tree search: 1670.156 sec (0h:27m:50s) Wall-clock time used for tree search: 1670.493 sec (0h:27m:50s) Total CPU time used: 2459.760 sec (0h:40m:59s) Total wall-clock time used: 2461.602 sec (0h:41m:1s) ...\" ", "Hi Brian, I quickly tested this. But the alignment you sent does not match the .iqtree file, i.e. it has ~49% constant sites: Input data: 55 sequences with 13994 nucleotide sites Number of constant sites: 6935 (= 49.557% of all sites) Number of invariant (constant or ambiguous constant) sites: 6935 (= 49.557% of all sites) Number of parsimony informative sites: 6272 Number of distinct site patterns: 6173 Nevertheless, the model GTR+R16 is overfitting your data, it just has too many rate categories. If I do model selection, then GTR+I+R4 is the best-fit model, with the following parameter estimates (from the alignment you sent): Category Relative_rate Proportion 0 0 0.3898 1 0.1777 0.1835 2 1.036 0.1711 3 2.753 0.23 4 6.142 0.02555 And model overfitting might impact rate estimates (much) more than tree inference. This is the command I used, if you want to replicate the analysis: iqtree -s MitoGenomesGapstripped.fasta -nt 2 -seed 1 -mset GTR -mrate E,I,G,I+G,R,I+R -wsr Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Yes, sorry about the file missing 18 taxa. I noticed that after I uploaded it, but I did not have the full alignment with me at home when I noticed it. I don't see an \"edit\" option to replace the file above, so I will attach the correct version here, in case anyone wants it. Thanks for the speedy reply, Minh! I think it explains the issue. I used 16 rate bins not with the aim of getting the \"best tree\", but only hoping to get a better estimate of the profile of rates observed in the data. I normally work on HIV, the AIDS Virus, and we are very interested in the rate of change of codons in Envelope and other genes, because those rates are largely influenced by the human immune system driving the virus to evade immune responses (antibodies and T-cell epitopes). I wanted to look at mitochondrial DNA as a comparison for a number of reasons. For example I could compare rates and patterns of rates in non-protein coding regions (structural RNAs and intergenic regions) to the protein coding regions. Anyway, I think it may be interesting to many users, that all of the trees I make from this data, whether using simple neighbor-joining tree with Kimura 2 parameter with equal rates model or the best models and methods, have essentially identical topoplgies but the branch lengths change considerably. When using a GTR model allowing site-to-site rate variation, the changes in branch lengths differ by very small amounts, almost not at all, by altering the exact way in which site-to-site variation is allowed. The major difference, is most likely in those invariant sites. "]}, "TkZD2e8BD6w": {"topic": "IQ-TREE heterotachy version", "initializeDate": "Aug 22, 2016, 2:29:17 PM", "timeStamp": "Aug 31, 2016, 3:10:14 PM", "content": ["Dear IQ-TREE users, We have released an IQ-TREE variant which implements a heterotachy mixture model accounting for heterotachous evolution \u2014 rate heterogeneity among sites and lineages. This version can be downloaded from here: http://www.iqtree.org/#variant A user guide is available at http://www.iqtree.org/doc/Heterotachy-Models/ . For your convenience, here is a more detailed description of this model: Heterotachy (or Single Topology Heterotachy - STH) model is a mixture model composing of several site-classes, each having a separate set of branch lengths and model parameters. Thus, it is a complex model naturally accounting for heterotachous evolution (Lopez, Casane, and Philippe, 2002), which was shown to mislead conventional maximum likelihood and Bayesian inference (Kolaczkowski and Thornton, 2004). Our extensive simulations showed that an implementation of heterotachy models in IQ-TREE obtained almost 100% accuracy for heterotachously evolved sequences. One can think of the heterotachy model as an edge-unlinked mixture model, which will infer the probabilities of each alignment site belonging to each mixture class. This is in contrast to an edge-unlinked partition model, which requires the appropriate partitioning of the data in advance, an ambitious assumption and a potential source of error for biological datasets in practice. Please note that this is still a pre-release version \u2014 so suggestions and feedback are welcome! Best, Minh On behalf of other co-authors. Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "very very interesting :) many thanks and I will test it :) Best Karen ", "Dear Minh! Great with so many models available in Iqtree! I have now tried Iqtree heterotachy and I was wondering about a few things. I saw information about number of parameters estimated versus sites used printed to the screen while the program was running, giving some indication for whether the proportion was sensible. I cant find it now again the the log file. I am not sure if I am missing it or perhaps it is not there...? or maybe I am mixing this with another run? I wanted to look at the *.treefile which I am guessing it the output in newick format but it has very strange formatting with an endless line of numbers (label:0.016624/0.019725/0.109490/0.023641/0.000003/0.097604/0.000002/0.038263/0.344754/0.196423/0.153140/0.293479/0.328430..., label:) so I can not really open this in figtree or any other regular file viewer. Is that what it should look like...? Is the run perhaps not completed...? For one of the runs the log file finishes with the following line: \"WARNING: Some pairwise ML distances are too long (saturated)\" The log timestamp is much earlier than the *.iqtree and *.treefile. Another one, which also has this weird *.treefile finishes with information on RAM required, and one tree length. I am not sure how do I know if everything finished properly. We have seen in the group that sometimes the log file does not get all the lines printed - i guess it should finish with the information on where everything is written, but the other output files, including the treefile are fine. I guess one can add bootstraps to those runs, just as for the regular models with -bb 1000. I tried it and it seems to work and the *.contree files are fine. thanks! Kasia ", "Dear Kasia, > On Aug 31, 2016, at 3:51 PM, katarzyna.zarem...@gmail.com wrote: > Dear Minh! > Great with so many models available in Iqtree! > I have now tried Iqtree heterotachy and I was wondering about a few things. thanks for your interests in this model! > 1. > I saw information about number of parameters estimated versus sites used printed to the screen while the program was running, giving some indication for whether the proportion was sensible. I cant find it now again the the log file. I am not sure if I am missing it or perhaps it is not there...? or maybe I am mixing this with another run? I am not sure what\u2019s going on at your system, thus can\u2019t comment. But as you noted, do not mix up different runs by using -pre (prefix output file) option > 2. > I wanted to look at the *.treefile which I am guessing it the output in newick format but it has very strange formatting with an endless line of numbers (label:0.016624/0.019725/0.109490/0.023641/0.000003/0.097604/0.000002/0.038263/0.344754/0.196423/0.153140/0.293479/0.328430..., label:) so I can not really open this in figtree or any other regular file viewer. Is that what it should look like...? Is the run perhaps not completed\u2026? good question, in brief it is an extended NEWICK format to store multiple branch lengths per branch of the same tree topology. For example (A:0.1/0.2,B:0.2/0.3,(C:0.2/0.4,D:0.5/0.1):0.3/0.2); means a mixture of 2 trees: (A:0.1,B:0.2,(C:0.2,D:0.5):0.3); (A:0.2,B:0.3,(C:0.4,D:0.1):0.2); with exactly the same topology, just differ in branch lengths, which are separated by a slash after the colon. We should have written the treefile in this normal format to be readable by tree viewers\u2026 I put this into TODO list > 3. > For one of the runs the log file finishes with the following line: > \"WARNING: Some pairwise ML distances are too long (saturated)\" > The log timestamp is much earlier than the *.iqtree and *.treefile. Another one, which also has this weird *.treefile finishes with information on RAM required, and one tree length. I am not sure how do I know if everything finished properly. We have seen in the group that sometimes the log file does not get all the lines printed - i guess it should finish with the information on where everything is written, but the other output files, including the treefile are fine. Can you then pipe the stdout to a file, e.g. iqtree -s \u2026. > out.txt And then use such out.txt file instead. If you see a truncated .log file again, can you send it and out.txt file to me? > 4. > I guess one can add bootstraps to those runs, just as for the regular models with -bb 1000. I tried it and it seems to work and the *.contree files are fine. at least something works ;-) Minh "]}, "euOWPjG57CY": {"topic": "Getting error on -g constraint tree", "initializeDate": "Nov 12, 2019, 6:28:27 PM", "timeStamp": "Nov 12, 2019, 7:01:29 PM", "content": ["Hi, I'm getting an error when I run a tree using option -g My constraint tree contains a subset of the alignment sequences. I am getting the following message many times in a row: ERROR: Alignment sequence XXXXX not appear in the tree My understanding was that the constraint tree does not need to contain all of the species in the alignment. The final line in my log file is: ERROR: Tree taxa and alignment sequence do not match (see above) I am using IQ-TREE multicore version 1.6.11 for Linux 64-bit Thanks! ", "Hi there, Can you please paste the command line? I believe you didn\u2019t use -g option. This error message is more like loading a user-defined (starting) tree and not the constraint tree option. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/3d6ae767-771e-4790-ba13-274b1cabe765%40googlegroups.com "]}, "ghJ2O9si_B0": {"topic": "Tutorials and Manual in one PDF", "initializeDate": "Apr 10, 2017, 2:01:05 PM", "timeStamp": "Apr 10, 2017, 2:01:05 PM", "content": ["Dear users, We have now assembled all the online tutorials, manual and documentation of IQ-TREE into one single pdf, downloadable from here: http://www.iqtree.org/doc/ From now on we will keep the online documents and this pdf synchronized. We hope that some of you may find it helpful, e.g., to walk through the features provided in IQ-TREE. Cheers, Minh "]}, "tO4QA-8qjT4": {"topic": "Concordance factors and tree distances", "initializeDate": "Feb 5, 2019, 4:29:39 PM", "timeStamp": "Aug 25, 2019, 12:21:46 AM", "content": ["Hello, The new implementation of concordance factors is great, I've enjoyed playing around with it to examine my data (target capture, hundreds of loci). I was wondering, do any of the output files of the concordance factor analyses easily translate into determining which input gene trees (and thus, which input genes) are most concordant with the generated species tree? And if not, is this something that may be implemented in the future? I see in the concord.cf.stat file the various columns (e.g. gCF, gN) etc., but from what I understand these data are related to the various nodes of the species tree, so it's a nice way to summarize to what degree the different branches/nodes are concordant by gene/site with the species tree. But my question is more about the genes themselves, is there a way to see which of the input gene trees are most in agreement with the overall topology of the species tree? I am not quite sure how this would be implemented, maybe by computing RF differences from the gene trees to the species tree (though this could be tricky since the taxa are not the same across all my gene trees). I realize IQ-TREE already has a way to calculate RF distances, but again, I don't think this works when individual trees are missing some tips. Thanks! Ryan ", "Hi Ryan, Thanks for your interests! There is an option --cf-verbose that will print for each branch, which gene tree is concordant with that branch. The additional output concord.cf.stat_tree will look like this: # Concordance factor statistics for decisive trees # This file can be read in MS Excel or in R with command: # tab2=read.table('example.phy.treefile.cf.stat_tree',header=TRUE) # Columns are tab-separated with following meaning: # ID: Branch ID # TreeID: Tree ID # gC: 1/0 if tree is concordant/discordant with branch # gD1: 1/0 if NNI-1 tree is concordant/discordant with branch # gD2: 1/0 if NNI-2 tree is concordant/discordant with branch # NOTE: NA means that tree is not decisive for branch ID TreeID gC gD1 gD2 18 1 1 0 0 18 2 1 0 0 18 3 1 0 0 19 1 1 0 0 ... You might be able to summarise what you want from gC column in this file. For example, the gene tree with many gC=1 is mostly concordant with the species tree. The exact statistics need to be more well thought, though. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hello Minh and Ryan, Looks like a very interesting option. Is the option can be run with both -gcf and -scf commands in one line? (iqtree -t concat.tree --gcf loci.trees -s Alignment.phy --scf 100 --prefix concordance -nt AUTO --cf-verbose). For the input genes trees inferred with iqtree, is it better to remove bootsrap values of newick trees (treefile)? Thanks Nicolas ", "Hi Nicolas, On 6 Feb 2019, at 10:06 pm, nicola...@gmail.com wrote: Hello Minh and Ryan, Looks like a very interesting option. Is the option can be run with both -gcf and -scf commands in one line? (iqtree -t concat.tree --gcf loci.trees -s Alignment.phy --scf 100 --prefix concordance -nt AUTO --cf-verbose). Yes you can, but you need to add a partition file to your command (e.g. -p PARTITION_FILE). Or you can also provide a directory of alignments via this -p option. Then IQ-Tree will write additional output .cf.stat_loci, which looks like this: # Concordance factor statistics for loci # This file can be read in MS Excel or in R with command: # tab2=read.table('example.phy.treefile.cf.stat_loci',header=TRUE) # Columns are tab-separated with following meaning: # ID: Branch ID # PartID: Locus ID # sC: Number of concordant sites averaged over 100 quartets # sD1: Number of discordant sites for alternative quartet 1 # sD2: Number of discordant sites for alternative quartet 2 # NOTE: NA means that locus is not decisive for branch ID PartID sC sD1 sD2 18 1 26.23 13.07 17.97 18 2 15.91 4.64 6.62 18 3 43.37 19.38 21.88 ... For the input genes trees inferred with iqtree, is it better to remove bootsrap values of newick trees (treefile)? That doesn\u2019t matter. These values are ignored. Cheers Minh ", "Thanks Minh! I was already able to get this to run. In the future, I will investigate how I want to use these outputs. Thanks again, Ryan ", "Hi Minh, I have a similar question regarding the output of the new (and nice!) feature to calculate concordance factors. Is there a way to view what the NNI-1 and NNI-2 topologies are? In this way, we can visualize what the second best topology is. best, Jacob ", "Hi Jacob, There is no such option. But how do you want to print this information? E.g., the IDs of the branches associated with each NNI? Cheers, Minh ", "Hi Minh, I'd love to get this option working but I get the following error when typing --cf-verbose: 'Invalid \"--cf\" option. Is this option still available? I cant see it in the iqtree -h options My code works fine and calculates scf and gcf values as expected. thanks, Theo To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Theo, I believe the error message is correct, perhaps you have mistakenly specified --cf instead of --cf-verbose. Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/35a6ce55-2ce3-4263-9d58-9523b940ade1%40googlegroups.com "]}, "xgzuRcPPH70": {"topic": "Phylogenetic dating using a known or fixed clock rate", "initializeDate": "Mar 29, 2021, 3:15:09 PM", "timeStamp": "Apr 19, 2021, 12:06:01 PM\u00a0(9 days ago)\u00a0", "content": ["I have a dataset with time information but no appreciable temporal signal. I want to date the phylogeny using a separate clock rate estimate which is possible in BEAST. I'm interested in using a faster method and I'm wondering if there is any feature in IQ-TREE that allows the user to fix the clock rate without trying to estimate it? ", "Hi Hien, Do you know if that\u2019s possible? Cheers, Minh On 30 Mar 2021, at 6:15 am, Nicoletta Commins < naco...@g.harvard.edu > wrote: I have a dataset with time information but no appreciable temporal signal. I want to date the phylogeny using a separate clock rate estimate which is possible in BEAST. I'm interested in using a faster method and I'm wondering if there is any feature in IQ-TREE that allows the user to fix the clock rate without trying to estimate it? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7a3e5b21-6d13-45f6-9013-a75855f9d933n%40googlegroups.com ", "Hi, Sorry I didn\u2019t see this. Yes, you can fix the rate by using option -w in lsd2. So in iq-tree command, it should be --date-options \u201c-w ratefile.txt\u201d where ratefile.txt is a text file containing the fixed rate. Best regards, Hien ", "Hi dear all, I don't understand why when I try to use a fixed clock rate the program stops always with the following message : --- Start phylogenetic dating --- Reading date file date355.txt ... 355 dates extracted Building time tree by least-square dating (LSD) with command: lsd -i B_355.fas.timetree.subst -s 29400 -o B_355.fas.timetree -r a -d B_355.fas.timetree.date -w rate.txt TREE 1 *PROCESSING: Reading the tree ... Collapse 287 (over 352) internal branches having branch length <= 1.7e-05 (settable via option -l) Parameter to adjust variances was set to 0.00034 (settable via option -b) ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: B_355.fas.log ERROR: *** Alignment files (if possible) The command was >iqtree2 -s B_355.fas -m GTR+F+I+G4 --date date355.txt --date-options \"-w rate.txt\" -te B_355.fas.treefile -o \"name.outgroup\" -nt AUTO I don't understand if there is a conflict in the instructions or if I made some other error. Thank you in advance for the help!!! Gianni "]}, "fk-k99eh0S8": {"topic": "Error: Only one state is observed in partition EOG091300B3.fas.no.duplicates.fasta", "initializeDate": "Jun 8, 2020, 2:20:51 PM", "timeStamp": "Jun 9, 2020, 10:31:21 AM", "content": ["Hello, Can anyone tell me the meaning of this error? ", "Dear Mukta Joshi, > On 8 Jun 2020, at 20:20, Mukta Joshi < mukta...@gmail.com > wrote: > Hello, > Can anyone tell me the meaning of this error? I guess it means that there is no information in that partition, I guess, because all sites are constant (only one state). But with having more information, this is only guessing. Cheers, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Heiko is right, It means that all sites (columns) in your alignment are constant. Note that a constant site can be something like AAAAAA or A--AANA (for DNA data). It means that you have just one character, - or N in that site. I think this might have led to the numerical issue that you reported in an earlier email? Please remove all these partitions in your analysis with -S option. For -p option, it may be fine because when concatenating partitions, the concatenated alignment will have more states coming from other partitions. Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5CB21EF2-9E91-4E1B-A8C2-8D87D7AEE910%40univie.ac.at ", "Hi, Thank you both for your replies. The error disappeared when I used iqtree version 1.6.4 ", "Actually, this error disappeared but IQTREE crashed again :( "]}, "8tVHS7jZD1g": {"topic": "iqtree running for hours and seems to be stuck", "initializeDate": "Dec 3, 2019, 5:05:22 AM", "timeStamp": "Dec 3, 2019, 6:41:52 AM", "content": ["Hi, I launched a phylogenetic analysis of an alignment with around 1300 nucleotide sequences and 600 positions using a reference tree (-m GTR+F+I+G -g reference_tree.newick -alrt 1000 -bb 1000 ) but the job has been running for 38 hours now and it seems to be stuck, the end of the log file looks like this Parameters optimization took 329.690 sec -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Generating 99 parsimony trees... So I would like to know if this is normal or is it a bug? Do you how I can fix this? Thank you in advance for the help. Cheers, Rafael ", "Hi Rafael, Quick answer: please use version 2.0, it fixes the running time issue with -g option. There have been a few discussions here in this google group, that this option is very slow. This was now resolved in v2.0. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b91f084e-6391-4fb0-b6b3-3285672d6f43%40googlegroups.com "]}, "umOXrz0PYLw": {"topic": "ERROR: Sequence contains too many characters", "initializeDate": "Feb 15, 2017, 1:10:28 PM", "timeStamp": "Feb 23, 2017, 4:09:57 PM", "content": ["Hi, I'm trying to run IQ-Tree v1.5.0 for the first time on my phylogenomic dataset. Its a large alignment with 199 tips and 2180083 characters. At the moment. I'm trying to find the best partitioning scheme for my 4268 loci using the -m TESTONLYMERGE flag. I get the below error. I'm sure I'm missing something obvious something obvious, bit any advice would be greatly appreciated. Is there a limit on the size of an alignment that IQ-Tree can use? iqtree-omp -q ASTRAL_Final_alignment_Partition.txt -s Final_alignment.phylip -m TESTONLYMERGE -rcluster 10 -nt 15 ERROR: Sequence Amalosia_jacovae_QMJ77272_S214 contains too many characters (4360171) Thank you, Phillip ", "Dear Phillip, thank you for your interest in IQ-Tree. Regarding your problem - since the message states 4360171 characters which is a bit more than twice as much as your reported length of 2180083 characters, I guess that there is an error in your alignment file that leads to joining two sequences. For examples, if they are in a FASTA file, the \u2018>\u2019 at the beginning of the sequence name is missing or the newline before the \u2018>\u2019 was deleted by mistake. Please check the sequence following Amalosia_jacovae_QMJ77272_S214. I hope that helps. Best wishes, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Dear Philip, Heiko had a very good remark! For your question: IQ-Tree has no limit on the size of the alignment \u2014 it is just restricted by your computer RAM size. Therefore, this error message must have something to do with your input alignment format. Cheers, Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thanks for the help. - Phillip "]}, "XkCkjX7kxgU": {"topic": "Wrong reference for HIVw and HIVb Amino-acid exchange rate matrices", "initializeDate": "Jun 14, 2017, 2:53:05 AM", "timeStamp": "Jun 14, 2017, 5:14:38 AM", "content": ["Hi, the reference for HIVw and HIVb should be Nickle et al. 2007 ( https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1876811/ Cheers, Anna ", "Ops, thanks for pointing this out. I corrected the documentation accordingly ( http://www.iqtree.org/doc/Substitution-Models#protein-models Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "Irh3_1J26Xo": {"topic": "composition chi2 test inquiry", "initializeDate": "Nov 24, 2015, 3:11:53 PM", "timeStamp": "Nov 30, 2015, 11:22:29 AM", "content": ["Hi Minh, After rereading the manual and mol boil evol paper, I was unable to find anything about the composition chi2 test implemented by IQ tree. What is it? And should I be concerned that only one of my individuals (out of 193) reliably fails this test regardless of the section of the genome for which I am generating a phylogeny? I am thinking about removing it from my dataset. Thanks! Aaron ", "Dear Aaron, the Chi^2 test first implemented in the software TREE-PUZZLE as a chi-square test for homogeneity of base composition. This was later also incorporated into IQ-Tree. Typically one would call this a Chi^2 goodness-of-fit test computing: chi2 = sum[i from 1 to k] (O_i - E_i)^2 / E_i where k is the size of the alphabet (e.g. 4 for DNA, 20 for amino acids) and the values 1 to k correspond uniquely to one of the nucleotides or amino acids. O_i is the nucleotide or amino acid frequency in the sequence tested. E_i is the nucleotide or amino acid frequency expected from the \u2018master\u2019 distribution (e.g. the overall frequencies - depends on what one is using). Whether the nucleotide (or amino acid) composition deviates significantly for the \u2018master\u2019 distribution is done by testing the chi2 value using the chi2-distribution with k-1 degrees of freedom (df=3 for DNA or df=19 for amino acids). I hope that explains the strategy. By and large it is just a normal Chi^2 test. Best regards, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ----------------------------------------------------------------------- Dr. Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) Dr. Bohr Gasse 9 Tel. : ++43 +1 / 4277 - 74321 A-1030 Vienna, Austria Email: heiko.schmidt(AT) univie.ac.at http://www.cibiv.at/ ----------------------------------------------------------------------- ", "Dear Aaron, sorry I forgot to include the answer to your second part. I see this test more like an explorative tool which might help you to nail down problems in your dataset. I would typically not remove failing sequences by default. But if the tree shows unexpected topology the test might point you in direction of the origin of the problem. If you might discard such sequences by default, you may not able to analyse GC-rich with GC-poor species for instance. Or possibly a needed outgroup shows difference in the distribution. Might the GC content be the problem with your one sequence as well? Furthermore, please keep in mind, this test is performed in IQ-Tree at the very beginning. At this point the software does not know anything about partitions yet. That means, it might be more reasonable to test this separately for each partition. Because one might want to be able to decide whether some partitions might better be discarded, because it is hard (or even impossible) to find a composition representing the sequences in the partition. Or on the other hand if a sequence fails for many partition and show very expected phylogenetic topologies, try without it. In any case if you have sequences that fail, I suggest to always check the alignment (something one should always do anyway), especially if they have been collected and produced automatically. I have seen protein alignments translated with an alignment error in the DNA alignment and then wrongly translated for the rest of the coding sequence. Such a sequence would certainly fail the test as well. I hope I could help a little, Heiko ", "Hi Heiko, Thanks for the detailed response. You were right, the sequence does have reduced GC. I will leave it in the dataset for now. "]}, "IqfL92x4fWU": {"topic": "rooting with outgroup", "initializeDate": "Jan 9, 2020, 1:54:21 PM", "timeStamp": "Jan 10, 2020, 5:44:39 PM", "content": ["Hi all, I am running some IQ-TREE analyses and am specifying the outgroup taxon using the -o flag. When I open up the tree in FigTree there is a polytomy towards the root. I am not sure why I am seeing this, because IQ-TREE should be providing completely resolved trees. Perhaps that branch length is just exceptionally small? Chris ", "Hi Chris, This is the right behaviour, nothing wrong here. The -o option only changes the way how the newick tree was printed. With or without it, there is always a tri-furcation at the root, because the tree is unrooted. You can of course manually reroot the tree on the branch leading to the outgroup. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/94051fdd-b8f8-4af0-aee0-5618e1fe5f5a%40googlegroups.com ", "Thanks Minh. Also, I would like to perform a partitioned analysis, but am receiving an error that CharSet 1 is not found. I have gone through the partition file at length and cannot seem to find anything wrong. Would you mind if I emailed it to you to have a look? Also, on a more computational side, I am wondering if a partitioned analysis will run in a reasonable length of time. ModelFinder was taking a very long time on the unpartitioned matrix, which is why I used the GTR+R10 model. Best wishes, Chris On Friday, 10 January 2020 08:42:12 UTC-5, Minh Bui wrote: Hi Chris, This is the right behaviour, nothing wrong here. The -o option only changes the way how the newick tree was printed. With or without it, there is always a tri-furcation at the root, because the tree is unrooted. You can of course manually reroot the tree on the branch leading to the outgroup. Cheers, Minh On 10 Jan 2020, at 5:54 am, chris blair < blai...@gmail.com > wrote: Hi all, I am running some IQ-TREE analyses and am specifying the outgroup taxon using the -o flag. When I open up the tree in FigTree there is a polytomy towards the root. I am not sure why I am seeing this, because IQ-TREE should be providing completely resolved trees. Perhaps that branch length is just exceptionally small? Chris You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Minh, I think I figure it out. Best, Chris "]}, "Brlz-cog-ck": {"topic": "BUG: \"IQ-TREE CRASHES WITH SIGNAL ABORTED\"", "initializeDate": "Jan 25, 2018, 3:39:25 AM", "timeStamp": "Jan 26, 2018, 3:43:30 PM", "content": ["Hi all, When using Modelfinder with command line: iqtree -s DNAinputfile.fas -st DNA -sp partitionfile -pre DNAinputfile.fas -m TESTONLYMERGE -mrate E,G -mset JC,K80,SYM,GTR,F81,HKY -msub nuclear -te treefile.nex I got the following error: This job STOPPED because there was a problem! WARNING: 1057 sequences contain more than 50% gaps/ambiguity ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: phylotesting.cpp:1263: std::string testOneModel(std::string&, Params&, Alignment*, ModelCheckpoint&, ModelInfo&, ModelsBlock*, int&, int): Assertion `iqtree->root' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 6 testOneModel(std::string&, Params&, Alignment*, ModelCheckpoint&, ModelInfo&, ModelsBlock*, int&, int) ERROR: 7 testPartitionModel(Params&, PhyloSuperTree*, ModelCheckpoint&, ModelsBlock*, int) ERROR: 8 testModel(Params&, PhyloTree*, ModelCheckpoint&, ModelsBlock*, int, int, std::string, bool, std::string) ERROR: 9 initializeParams(Params&, IQTree&, ModelCheckpoint&, ModelsBlock*, std::string&) ERROR: 10 runTreeReconstruction(Params&, std::string&, IQTree*&, ModelCheckpoint&) ERROR: 11 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 12 main() ERROR: 13 __libc_start_main() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: DNAinputfile.fas.log ERROR: *** Alignment files (if possible) What must I do? All the best Dieter ", "Update: I testet without the tree file - and without the tree file it works. Tree file is original nexus format from RAxML output - taxa names are matching. All the best Dieter ", "Thanks for the report! Can you please send me the input files for debugging purpose? Please send all data to my personal email for confidential reason. Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Hello Minh, Data sent to you. All the best Dieter > You received this message because you are subscribed to a topic in the > Google Groups \"IQ-TREE\" group. > To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/Brlz-cog-ck/unsubscribe > To unsubscribe from this group and all its topics, send an email to "]}, "Qmdnjk0oVmo": {"topic": "Re: [iqtree] Problem calculating a consensus network: 'Invalid \"-net\" option.'", "initializeDate": "Feb 5, 2018, 7:12:13 PM", "timeStamp": "Feb 6, 2018, 4:29:32 AM", "content": ["Hi there, Thanks for reporting this. I confirm that there is a bug in parsing -net option from the command line. This will be fixed soon and I will send you a beta version for testing. Cheers, Minh On 5 Feb 2018, at 7:58 pm, cajawe < cameron...@gmail.com > wrote: Hello, I am attempting to take a set of trees and produce a consensus network. It's not working. I suspect there is a bug in the program. Following the iqtree manual, I've tried \"./iqtree -net repTrees.nwk\" and \"./iqtree -net -t repTrees.nwk\" but both fail, producing the error: \"Invalid \"-net\" option.\" This is true regardless of whether the input trees are in newick or nexus format. By contrast, producing a standard consensus tree via \"./iqtree -con repTrees.nwk\" works fine. I'm using \"IQ-TREE multicore version 1.6.0 for Mac OS X 64-bit built Dec 24 2017\" Of course I may simply be doing this incorrectly\u2014if so, please let me know what I should be doing differently. Many thanks You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Thanks for looking into this. Cheers Cam "]}, "AdzZDA6r2JE": {"topic": "phylokernelnew.h crash 1.5.3 on computer cluster", "initializeDate": "Mar 2, 2017, 4:22:49 AM", "timeStamp": "Mar 3, 2017, 5:40:41 AM", "content": ["Hi! I have submitted a large number of single gene IQTREE analyses on a computer cluster. Though for some it seems to work fine, for a significant amount of others IQ-TREE crashes at the start of the model selection: Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.767 seconds NOTE: MODEL SELECTION REQUIRES 77 MB MEMORY! Testing 28 protein models (sample size: 17) ... No. Model -LnL df AIC AICc BIC *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: clust_I16_00052_BMGE.aln.out/clust_I16_00052_BMGE.aln.log *** Alignment files (if possible) This doesn't give me much to work on. However, the STDERR output of the job submission on the cluster gave me an additional line: iqtree-omp: /home/joranm/tools/IQ-TREE/phylokernelnew.h:876: void computeBounds(int, size_t, std::vector<long unsigned int>&) [with VectorClass = Vec4d; size_t = long unsigned int]: Assertion `limits.size() == threads+1' failed. Further investigation also seems to suggest that this error occurs for very narrow alignments ( <60 amino acids ), and for the few genes that have finished or are currently running, the alignments are >68 amino acids Here was the command I used: IQ-TREE multicore version 1.5.3 for Linux 64-bit built Feb 27 2017 Copyright (c) 2011-2016 Nguyen Lam Tung, Olga Chernomor, Arndt von Haeseler and Bui Quang Minh. Host: m143.uppmax.uu.se (AVX, 252 GB RAM) Command: /home/joranm/tools/IQ-TREE/build/iqtree-omp -s clust_I16_00052_BMGE.aln -nt 16 -m TESTNEW -mset LG -madd LG+C10,LG+C20,LG+C30,LG+C40,LG+C50,LG+C60 -bb 1000 -wbtl -seed 12345 -pre clust_I16_00052_BMGE.aln.out/clust_I16_00052_BMGE.aln -keep-ident -quiet Seed: 12345 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Thu Mar 2 07:25:00 2017 Kernel: AVX - 16 threads(16 CPU cores detected) Cheers, Joran ", "Dear Joran, thanks for the details which help me to quickly see the problem. The quick answer is: please use only 1 thread (-nt 1) instead of 16 for these short alignments. The crash should be gone and moreover, iqtree will run even faster than -nt 16 for short alignments. Long answer: iqtree-omp parallelizes likelihood computation over alignment sites. Each thread will get at least 4 site-patterns (since AVX instructions are used), thus with 16 threads, alignment should have at least 4*16=64 site-patterns. This explains your observation. Nevertheless, iqtree shouldn\u2019t crash this way, but print some informative error message to warn users. I will do this for the next version. Hint: you shouldn\u2019t use too many threads for short alignments (see http://www.iqtree.org/doc/Frequently-Asked-Questions/#what-is-the-good-number-of-cpu-cores-to-use ). A new option \u201c-nt AUTO\u201d will automatically determine the best number of threads to use. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thanks Minh for your quick reply!! One thing I didn't mention was that even though these alignments are short, they have many sequences (typically >1000). Would a single thread still be adequate enough to finish the analysis in a decent amount of time? I will try the -nt AUTO option, that will hopefully solve it ! Joran ", "Dear Joran, that does not help, the multicore parallel efficiency is solely determined by the alignment length, not the number of sequences. However, there is an MPI version that distributes computations across different nodes in the cluster, there it will help to speed up further. The MPI version has to be compiled separately (see http://www.iqtree.org/doc/Compilation-Guide/#compiling-mpi-version Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "D8dzZ8cTKN8": {"topic": "testing version 1.4.0-beta", "initializeDate": "Jan 5, 2016, 7:40:14 PM", "timeStamp": "Jan 24, 2016, 2:45:19 PM", "content": ["Dear users, Happy new year! We have just posted IQ-TREE beta version 1.4.0-beta for testing purpose with new features: * Checkpointing. * Implementation of likelihood mapping plot [Strimmer and von Haeseler, 1997]. * Implementation of the approximately unbiased (AU) test [Shimodaira, 2002]. We will appreciate if anyone volunteers to test this version and gives us feedback. More details and downloads are available here: https://github.com/Cibiv/IQ-TREE/releases Best, IQ-TREE development team [Shimodaira, 2002]: http://dx.doi.org/10.1080/10635150290069913 [Strimmer and von Haeseler, 1997]: http://www.pnas.org/content/94/13/6815.long ", "Dear IQ-TREE developers, I applied IQ-TREE 1.4.0 beta for likelihood mapping, however, I got a very unusual result comparing to Puzzle. IQ-TREE reported 100% of quarterts in the central of the triangle while Puzzle reported only 14.7%. I include here the result generated by IQ-TREE 1.4.0 beta. Best regards, Giap Nguyen ", "Dear developers, Using Linux version of IQ-TREE, I got the following error when trying likelihood mapping analysis: Performing likelihood mapping with 10000 quartets... iqtree: /home/CIBIV/minh/Dropbox/iqtree-git/phylotree.cpp:285: void PhyloTree::assignLeafNames(Node*, Node*): Assertion `node->id >= 0 && node->id < leafNum' failed. Best regards Giap Nguyen ", "Dear Giap, your file does indeed look strange. It contains 10000 times the same value. While implementing and test that never happened to me. It would be nice if you could provide me with the input alignment you used and the exact command line you started the program with. Best you also send me the log time produced by IQ-TREE. Thank you for your interest in the software. Best wishes, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout > <iqtree-result.eps> ", "Dear Heiko, I include with this email the input alignment (fasta format) And here is what I asked the program does: iqtree -s orf12-pcv1-pcv2-nu-al.txt -m TPM3u+R7 -lmap 10000 -nt 8 Best regards Giap Nguyen You received this message because you are subscribed to a topic in the Google Groups \"IQTREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/D8dzZ8cTKN8/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com "]}, "xxFWjzMV73Y": {"topic": "Missing Model Selection output Folder", "initializeDate": "Jan 22, 2019, 1:00:22 PM", "timeStamp": "Jan 23, 2019, 11:50:34 PM", "content": ["Dear all, I am using this server version of IQTree ( http://iqtree.cibiv.univie.ac.at/ I have run a couple of analysis, and in all these I notice that the following file mentioned in the Run Log is missing in my output: All model information printed to \"MYFILENAME.nex.model.gz The line above appears in the Run Log just below the Model Selection summary. Any information about how to find this folder would be much appreciated. Thank you, ", "Hi Ana, This file is only for checkpointing purpose of the model selection step. Most users do not need to look at this file, thus not provided for download via the web interface. If you insist on having this file, then you need to run IQ-TREE locally in your PC. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thank you for your answer. On Jan 23, 2019 7:11 AM, \"Minh Bui\" < minh...@univie.ac.at > wrote: Hi Ana, This file is only for checkpointing purpose of the model selection step. Most users do not need to look at this file, thus not provided for download via the web interface. If you insist on having this file, then you need to run IQ-TREE locally in your PC. Cheers, Minh On 23 Jan 2019, at 5:00 am, Ana Laura Almendra < bioal...@gmail.com > wrote: Dear all, I am using this server version of IQTree ( http://iqtree.cibiv.univie.ac.at/ I have run a couple of analysis, and in all these I notice that the following file mentioned in the Run Log is missing in my output: All model information printed to \"MYFILENAME.nex.model.gz The line above appears in the Run Log just below the Model Selection summary. Any information about how to find this folder would be much appreciated. Thank you, You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com "]}, "mb_rIsAejjo": {"topic": "What do the mixture classes mean in GHOST?", "initializeDate": "Sep 26, 2017, 12:34:38 AM", "timeStamp": "Feb 13, 2018, 5:29:57 AM", "content": ["Hello, I have a theoretical question. How should I interpret the classes estimated by the GHOST model exactly? Are they a measure of what? This is not entirely clear to me. Can they be interpreted as heterotachous classes? Thank you, Sergio ", "Hi Sergio, Your question is a very good one, but it is not easy for me to answer. I am assuming that you have read our paper on the GHOST model that is available on the archive, if not then it would certainly be worthwhile: https://www.biorxiv.org/content/early/2017/08/10/174789 I found it difficult to write some of the text describing the interpretation of the model. This is because I think the natural tendency is to assume that if the weight of an inferred class is 0.2, then 20% of the sites in the alignment belong to that class and the remaining 80% belong to one of the other classes. However this is not the case, all sites actually contribute some component towards each class. No site \u201cbelongs\u201d to any individual class, although an individual site may be very likely to have evolved under one particular class. I think perhaps the best way to interpret the classes is as a manifestation of some historical signal present within the data. One might think of the information within a sequence alignment as the combined product of many different historical signals (and noise). If we fit a simple, single-class model and infer a tree then we are essentially looking at an \u201caverage\u201d (in some sense) of the historical signals (and noise) present in the data. Using the GHOST model and inferring three classes (for example) means you have the opportunity to visualise three distinct signals hopefully the three most dominant ones but this of course will depend on your data. This gives the opportunity to gain biological insight that would otherwise remain hidden. Finally, yes you can think of the classes as heterotachous. Heterotachy essentially means rate variability across lineages. Inferring different sets of branch lengths for each class allows this variability to be captured by the model. I hope this helps, Cheers, Stephen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thank you, Stephen. That helped. ", "Dear Stephen, Recently you have suggested a way to simulate replicates under the GHOST models, which involves simulation of separate alignments for each heterotachy class and their concatenation. To my knowledge, this is the standard way for simulation of the partitioned models which describe evolution in different loci of a concatenated alignment. Above simulation of the GHOST models as partitioned models implies, to my understanding, that the positions corresponding to each heterotachy class exist in the data. However, your description that \u201call sites actually contribute some component towards each class. No site \u201cbelongs\u201d to any individual class\u201d indicates that my above assumption (that the GHOST models can be viewed as partitioned models) was, perhaps, not correct. If each observed alignment site contributes components to each heterotachy class, than it seems reasonable to assume that simulation of each replicate site should also be performed taking into account the influence of all heterotachy classes (as under a mixture model). Could you please tell me if this is correct or wrong? If the above assumption is correct, could you tell how such simulation can be conducted, or perhaps provide a simulation option in IQTREE? If not, I would appreciate if you share your thoughts why simulation of GHOST models as partitioned models should be preferred over their simulation as mixture models. All the best, Vadim ", "Hi Vadim, Thanks for the question. I think perhaps it does not help to think of simulating replicates under the GHOST model. I think of the GHOST model as something to be used for inference, not simulation. I prefer to think that we simulate heterotachous data, and the easiest way I can think of is as you describe, to simulate two different alignments under different model conditions and then concatenate them together. You are also right when you say this is how one would simulate partitioned data as well. So from a simulation perspective I think it is clear, when simulating heterotachous alignments in the above way, each site does indeed belong to a particular partition/class. When it comes to inference however, we must imagine that we have no absolute knowledge of which sites belong to which partition/class. One approach is to use a partition model, in which we assume some partitioning scheme, based on some reasonable biological assumptions. The other approach is to use a mixture model, such as a discrete Gamma or GHOST, in which we do not assume any prior information about which sites belong to which class. So, since we have no other information, all classes contribute some component to the likelihood of each site. A consequence of this is that a site \u201cbelongs\u201d to each class, according to some probability distribution. In terms of your question about simulating under the mixture model, where each site takes into account all classes to some extent, I am not sure exactly how to do this or why we would want to. I prefer to consider the simulation process and the inference process as somewhat seperate. We simulate (in this case) heterotachously-evolved data and then we infer under the GHOST model or partition model. Cheers, Stephen Stephen Crotty, PhD Centre for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC 5, Ebene 1 A-1030 Vienna, Austria Email: stephen...@univie.ac.at "]}, "8cSvmjTHjZE": {"topic": "1.3.8 crashed on a large dataset", "initializeDate": "Sep 18, 2015, 7:40:09 AM", "timeStamp": "Sep 23, 2015, 11:57:12 AM", "content": ["Hi all, I try to run on my mashine another large test dataset (Antliophora, fleas, flies, scorpionflies, 54 taxa, ca. 600000 sites - including LG4X.). It crahsed after 2 h or so with the following error: ..... converged Current log-likelihood at step 3: -15658492.277 ... iqtree-omp: /home/CIBIV/minh/Dropbox/iqtree-git/phylosupertreeplen.cpp:140: virtual double PartitionModelPlen::optimizeParameters(bool, bool, double, double): Assertion `cur_lh > tree_lh - 1.0' failed. -> this is not part of the logfile, it appeared in the terminal. ... runtree1.sh: line 1: 31648 Aborted (core dumped) /home/meu00c/CSIRO/Programs/iqtree/iqtree-omp-1.3.8-Linux/bin/iqtree-omp -omp 20 -st AA -s DDC_aaDom_Antliophora_kmeans_brli.mare.phy -spp DDC_aaDom_Antliophora_kmeans_brli_iqtree_merged.nex -pre kmeans_linked_tree001 -alrt 1000 -v -numpars 200 -toppars 40 -numstop 150 I have 31 GB RAM (it announced to use 19 GB) - but since \"core dumped\" could it be that RAM is the issue? Or is a result of using LG4X in maybe partitions that have not all 20 states present (numerical instability) ? Anyway I now restart the run having more RAM available, but help is appreciated (logfile attached) Let me know if you need dataset & nex file as well Cheers Karen ", "Hi Karen, In the few runs performed so far i have not seen this error before.. Maybe you should ask in the googlegroups? Alex ", "Dear Karen, I assume this is associated with the LG4X problem that we are trying to solve currently\u2026 this will be sorted out in few days with the new release, please be a bit patient. I will inform you Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Ok - many thanks Minh :) ! sent from karens phone Bui Quang Minh < minh...@univie.ac.at > schrieb: ", "Hi Minh (and all) trying to analyse another large dataset (running 10 tree searhes) yesterday all analyses ailed after ca. 50 hours with following error message: (last lines of the log file see below, included is LG4X but not for all partitions): I assume it is maybe the same issue than before ? Do you need log files or do/did you have an idea already how the problem could be solved) (RAM and walltime was sufficient here) @Alex, bernhard: I will email you seperately Many thanks, cheers Karen WARNING: Estimated model parameters are at boundary that can cause numerical instability! BEST SCORE FOUND : -39970384.266 Testing tree branches by SH-like aLRT with 1000 replicates... CPU Time used: 5188.224 sec. Total tree length: 12.688 Total number of iterations: 152 CPU time used for tree search: 2476550.119 sec (687h:55m:50s) Wall-clock time used for tree search: 179023.523 sec (49h:43m:43s) Total CPU time used: 2605556.541 sec (723h:45m:56s) Total wall-clock time used: 188165.810 sec (52h:16m:5s) STACK TRACE FOR DEBUGGING: 1 funcAbort() 2 () 3 PhyloTree::computePatternLikelihood(double*, double*, double*) 4 PhyloTree::computeLogLVariance(double*, double) 5 reportPhyloAnalysis(Params&, std::string&, IQTree&, std::vector<ModelInfo, std::allocator<ModelInfo> >&) 6 runPhyloAnalysis(Params&) 7 main() 8 __libc_start_main() *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT *** For bug report please send to developers: *** Log file: rcluster_linked_full_dataset_tree002.log *** Alignment files (if possible) /cm/local/apps/slurm/var/spool/job8422887/slurm_script: line 10: 56569 Segmentation fault /home/meu00c/bin/iqtree/iqtree-1.3.8-Source/iqtree-omp -omp 20 -st AA -s /flush2/meu00c/neuro_iqtree/supermatrix_mare_SOS.phy -spp /flush2/meu00c/neuro_iqtree/model_partitions_rl.nex -pre rcluster_linked_full_dataset_tree002 -alrt 1000 -v -numpars 200 -toppars 40 -numstop 150 meu00c@pearcey-login:/flush2/meu00c/neuro_iqtree> tail -50 slurm-8422887.out final value 1223.707 converged final value 1223.707 converged final value 3295.119 converged final value 3295.119 converged final value 2227.916 converged final value 2227.916 converged final value 3060.934 converged final value 3060.934 converged NOTE: Restoring branch lengths as tree log-likelihood decreases after branch length optimization: -39970384.266 -> -39970384.266 Current log-likelihood at step 2: -39970384.266 Partition-specific rates: . [..] Parameters optimization took 1 rounds (412.075 sec) WARNING: Estimated model parameters are at boundary that can cause numerical instability! BEST SCORE FOUND : -39970384.266 Testing tree branches by SH-like aLRT with 1000 replicates... CPU Time used: 5188.224 sec. Total tree length: 12.688 Total number of iterations: 152 CPU time used for tree search: 2476550.119 sec (687h:55m:50s) Wall-clock time used for tree search: 179023.523 sec (49h:43m:43s) Total CPU time used: 2605556.541 sec (723h:45m:56s) Total wall-clock time used: 188165.810 sec (52h:16m:5s) STACK TRACE FOR DEBUGGING: 1 funcAbort() 2 () 3 PhyloTree::computePatternLikelihood(double*, double*, double*) 4 PhyloTree::computeLogLVariance(double*, double) 5 reportPhyloAnalysis(Params&, std::string&, IQTree&, std::vector<ModelInfo, std::allocator<ModelInfo> >&) 6 runPhyloAnalysis(Params&) 7 main() 8 __libc_start_main() *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT *** For bug report please send to developers: *** Log file: rcluster_linked_full_dataset_tree002.log *** Alignment files (if possible) /cm/local/apps/slurm/var/spool/job8422887/slurm_script: line 10: 56569 Segmentation fault /home/meu00c/bin/iqtree/iqtree-1.3.8-Source/iqtree-omp -omp 20 -st AA -s /flush2/meu00c/neuro_iqtree/supermatrix_mare_SOS.phy -spp /flush2/meu00c/neuro_iqtree/model_partitions_rl.nex -pre rcluster_linked_full_dataset_tree002 -alrt 1000 -v -numpars 200 -toppars 40 -numstop 150 ", "Dear Karen, thanks for reporting this issue. It seems like problem when writing IQ-tree report file at the end of the run. I will have a closer look. Note that it is not related to the issue you sent previously. Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, yes - thanks - that was Alex V. impression too (and also seems logical to me, but unsure. All kind of files including the tree file have been produced, In case its only an bug in the report, please let us know if we can use results in this case. (If yes would be great because then these 10 runs did not crash :)))) - because we need these results quite urgently) Looking fw to you answer cheers karen "]}, "aJLvK7Z2tLU": {"topic": "IQ-TREE Web Server Update", "initializeDate": "Dec 22, 2015, 6:58:21 AM", "timeStamp": "Dec 22, 2015, 6:58:21 AM", "content": ["Dear all, We are pleased to announce the updated IQ-TREE web sever ( http://iqtree.cibiv.univie.ac.at with new features: General updates: * Notable feature: the inferred tree is visualized directly in the web browser for a quick assessment and included in the download as an svg file. * Most options are equipped with a quick help by clicking the associated question mark (?). New features for Tree Inference: * For ultrafast bootstrap analysis users can additionally - turn on writing bootstrap trees to an .ufboot file which will be included in the download. - specify the maximum number of iterations to stop. - specify the minimum correlation coefficient for UFBoot convergence criterion. * Option to perform an approximate Bayes test (Anisimova et al., 2011). * Option -pers to change the perturbation strength for randomized nearest neighbor interchange (NNI). * Option -numstop to specify the number of unsuccessful iterations to stop. For more information about the Tree Search Parameters -pers and -numstop, please refer to the documentation ( http://www.cibiv.at/software/iqtree/doc ) and Nguyen et al., 2015 ( http://mbe.oxfordjournals.org/content/32/1/268 New features for Model Selection: * For the new model selection procedure [+R], users can specify the maximum number of categories for FreeRate model. * Users can also specify a list of mixture models to additionally consider for model selection. * In the field 'More options', it is possible to specify - base models - rate heterogeneity types - frequency types to be considered for model selection, e.g. to save computations. Best, IQ-TREE development team "]}, "hfKsERj6A5c": {"topic": "WARNING: Estimated model parameters are at boundary that can cause numerical instability!", "initializeDate": "Jul 16, 2015, 4:07:27 PM", "timeStamp": "Sep 22, 2017, 10:28:30 AM", "content": ["Dear IQ-TREE Developers and all, I have run several model selection tests using IQ-TREE web server for the same partitioned dataset (settings were the same in all cases). Sometimes I got the message \"WARNING: Estimated model parameters are at boundary that can cause numerical instability!\" (i.e. jobs 150716124645, 150716153513, 150716200616, 150716202852), but in other cases did not (e.g. 150710180510, 150710180224, 150710180008, 150709095002 etc). Does it mean that only test results without the warning message should be considered when choosing the best fit model for my dataset? Tests with the warning message always calculated lower kappa values of HKY85 (e.g kappa=10.XXXX) than those without the warning message (kappa=18.YYY). Also, there seemed to be an instability between different runs in choosing the best model for certain partitions (TNe changed to K2P and vice versa), independently from the presence or absence of the warning message. Probably this is normal for a difficult dataset??? Thanks for your comments in advance. Cheers, J\u00f3zsef ", "Dear Jozsef, this warning is issued in two conditions: some rate parameters of the rate matrix (e.g., 4x4 for DNA) are too large (>=100) or some state frequencies are too small (<0.0001; e.g. when at least one state does not appear in the alignment). In such case, one should be careful with the results. Note that if you do model selection (e.g. -m TEST), then this can happen for some models during the test, but might not happen for the final best-fit model. In this case, it is fine again as the problematic models are not chosen. To identify this, simply look at the .iqtree file and the model parameters printed in this report file. If you don\u2019t see the two above conditions, then things should be fine. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Again, a huge thank to you! I fully understood your explanation and just intend to add a minor comment. I only got those warning messages when using IQ-TREE web server with \u201e-mtree\u201d option, and only when doing -m TESTONLY for partitioned multigene dataset (with both -s and -sp the command line). Without applying -mtree, I can not see that warning message. Also, I do not have got this warning from IQ-TREE web server for non-partitioned individual genes constituting the above mentioned multigene dataset. And no warning at all when I used IQ-TREE 1.3.4 binary under win7 for the same datasets. Does these mean anything? Cheers, J\u00f3zsef ", "Dear Jozsef, On 17 Jul 2015, at 12:10, Jozsef Bakonyi < bakonyi...@agrar.mta.hu > wrote: Dear Minh, Again, a huge thank to you! sure ;-) I fully understood your explanation and just intend to add a minor comment. I only got those warning messages when using IQ-TREE web server with \u201e-mtree\u201d option, and only when doing -m TESTONLY for partitioned multigene dataset (with both -s and -sp the command line). Without applying -mtree, I can not see that warning message. \u201c-mtree\u201d will do model testing more thoroughly; thus the outcome might be differently... Also, I do not have got this warning from IQ-TREE web server for non-partitioned individual genes constituting the above mentioned multigene dataset. The logic is: the concatenated alignment is longer -> you have more phylogenetic information to estimate model parameters -> the warning does not appear. For partitioned data, IQ-Tree does model selection for each partition - some of them might be short -> you may not have enough information to estimate parameters of some complex model (e.g GTR) -> the warning appears. And no warning at all when I used IQ-TREE 1.3.4 binary under win7 for the same datasets. which analysis did you do with the win7 version? Cheers, Minh ", "Dear Minh, I have been getting the same warning. What can you do if some of the alignments indeed don't have one specific amino acid? I attached the output file in case it is helpful. Thank you, Tauana ", "Attachment! ", "Hi Tauana, If iqtree does not stop or crash (e.g. with numerical underflow message), then you can ignore this warning. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Great, thanks! "]}, "pgUcW1R4LjI": {"topic": "crash during sCF analysis", "initializeDate": "May 13, 2020, 3:31:53 PM", "timeStamp": "Jun 19, 2020, 7:30:48 PM", "content": ["Hi there, I'm attempting to run an sCF analysis, but am getting the following error: ERROR: STACK TRACE FOR DEBUGGING: ERROR: 2 _sigtramp() ERROR: 4 MTree::getTaxaID(std::__1::vector<int, std::__1::allocator<int> >&, Node*, Node*) ERROR: 5 MTree::getTaxaID(std::__1::vector<int, std::__1::allocator<int> >&, Node*, Node*) ERROR: 6 PhyloTree::computeSiteConcordance(std::__1::pair<Node*, Node*>&, int, int*) ERROR: 8 __kmp_invoke_microtask() ERROR: 9 __kmp_fork_call() ERROR: 10 __kmpc_fork_call() ERROR: 11 PhyloTree::computeSiteConcordance(std::__1::map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::less<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > >&) ERROR: 12 assignBranchSupportNew(Params&) ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: tree.new.log ERROR: *** Alignment files (if possible) zsh: segmentation fault iqtree2 -t tree.new -s concat-9Mar.phy --scf 10000 I have had success running similar analyses using the same command and alignment file, so I can only assume the tree is to blame. I've tried various tree formats, but I get the same error each time. I've attached all the relevant files to this post. Thanks for your help & all your work developing IQ-TREE, Danielle ", "Hi Danielle, Thanks for reporting this. It is because your tree is multi-furcating and this sCF calculation does not work with multifurcating trees. I don\u2019t know why IQ-TREE doesn\u2019t spit out this error (I thought it should have). But anyway this is the problem: sCF right now only supports bifurcating trees. How it could be extended to multifurcating trees is not trivial and I need to discuss with co-authors. Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/54cd545b-c5f9-4181-ad2d-a91dd464882d%40googlegroups.com <concat-9Mar.phy> <tree.new> <tree.new.log> ", "Hi Danielle, One option with a multifurcating tree is to feed it to IQ-TREE as a constraint tree with the original alignment. IQ-TREE tree will then find the best resolution of all the multifurcations, and then you have a bifurcating tree with which to calculate sCF values. If you are not interested in the sCF values on the branches that weren't in the multifurcating tree, you can just ignore them. Rob To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6B94ECC2-5ACF-4AC1-8B85-B14E8E30C14C%40univie.ac.at Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Hi Danielle, I have now changed the code s.t. sCF works on multifurcating trees. Can you pls try this again with the pre-release: https://github.com/Cibiv/IQ-TREE/releases/tag/v2.0.7 And let me know how it works. Thanks Minh On 19 May 2020, at 8:17 am, Danielle de Carle < danielle...@gmail.com > wrote: Aah, that makes sense. Thanks so much for your reply, Danielle ", "Hi Danielle, Yes, that\u2019s a very good summary of how it works! Technically, let\u2019s take a look a Figure 1 of our paper ( https://doi.org/10.1093/molbev/msaa106 ). When the tree is not strictly bifurcating, there can be more than 2 left and 2 right subtrees attached to branch x. In that case, we just randomly pick up two subtrees A,B on the left, and two subtrees C, D on the right. The rest of the calculation is then the same. Since this is quite simple, I quickly implemented it in IQ-TREE. Cheers Minh On 18 Jun 2020, at 3:21 pm, Danielle de Carle < danielle...@gmail.com > wrote: Hi Minh, Thank you so much - this was a really pleasant surprise I tested the code and it works perfectly. Just to clarify: do the sCF values on the multifurcating nodes express the proportion of decisive sites that are consistent with any of the possible resolutions of that (unresolved) node? Thanks again! Danielle "]}, "8MwTNW68lFE": {"topic": "BUG: Crash running IQTree v2.0.6 after NNI search", "initializeDate": "Apr 8, 2021, 8:40:59 AM", "timeStamp": "Apr 11, 2021, 9:20:55 PM", "content": ["Keep running into this error while running IQtree v2.0.6 on an Ubuntu 20.04 machine with 7 threads IQ-TREE multicore version 2.0.6 for Linux 64-bit built Apr 8 2021 (AVX2, FMA3, 15 GB RAM) Seed: 123456 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Thu Apr 8 12:53:03 2021 Kernel: Safe AVX+FMA - 7 threads (8 CPU cores detected) iqtree2 -s concatAln_gb.phylip --seqtype AA -t RAND -m LG4X+I --prefix Entero_OrthoFinder_IQTree2_SCCore -T 7 --seed 123456 --ufboot 1000 --safe --mem 8G 149 sequences with 57444 columns ERROR: ratefree.cpp:539: double RateFree::optimizeWithEM(): Assertion `score > old_score-0.1' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 5 () ERROR: 6 RateFree::optimizeWithEM() ERROR: 7 ModelFactory::optimizeParametersOnly(int, double, double) ERROR: 8 ModelFactory::optimizeParameters(int, bool, double, double) ERROR: 9 IQTree::optimizeModelParameters[abi:cxx11](bool, double) ERROR: 10 IQTree::doNNISearch(bool) ERROR: 11 IQTree::initCandidateTreeSet(int, int) ERROR: 12 IQTree::doTreeSearch() ERROR: 13 runTreeReconstruction(Params&, IQTree*&) ERROR: 14 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 15 main() ERROR: 16 __libc_start_main() ERROR: 17 _start() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: Entero_OrthoFinder_IQTree2_SCCore.log ERROR: *** Alignment files (if possible) Aborted (core dumped) ", "Hi there, The problem is the model LG4X+I. The +I part is not supported. Please only use LG4X without +I. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ef463403-724a-470f-8086-e033892ecfa1n%40googlegroups.com "]}, "Vxh2bYzCM1g": {"topic": "Incorrect tree when I use that partition file", "initializeDate": "Aug 8, 2018, 4:21:55 AM", "timeStamp": "Aug 8, 2018, 8:04:14 AM", "content": ["Hi! I am trying to analyse a data set of 211 taxa and 14 markers. Then I provide a partition file (partitions by codon). But the results are messy! (unexpected position of taxa). Then I redo the analyses without the partition file I got the expected tree (I said the expected tree because this dataset was published in a paper and I tried this dataset with others phylogenetic programs and recover same published topology but for some reason I can't recover something similar in IQTREE). This is the firs line command that I tried: bin/iqtree -s file.phy -spp Partitions -m TESTMERGE -mset mrbayes -bb 1000 -nt AUTO (but It did not work) Then I tried this : bin/iqtree -s infile.phy -spp Partitions -m TESTNEWMERGE -bb 1000 -bnni -nt AUTO (again I got a crazy tree) so..Then I avoid the -spp Partition option and I got the good tree. Am I doing something wrong? Many thanks in advances Leidys M ", "Hi Leidys, Which IQ-TREE version are you running? How much different are the two trees? (e.g. Robinson-Foulds distance or how many branches are different between them). Can you try the partition model by another program (e.g. RAxML) just to cross check? I have actually seen cases where partition models inferred the \u201cright\u201d tree whereas single models do not, which is explainable as a result of model violations. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "5LlleFo3UeU": {"topic": "Why there are not available bootstrap in teh fast mode of tree search?", "initializeDate": "Oct 15, 2020, 2:15:54 PM", "timeStamp": "Oct 16, 2020, 3:19:24 AM", "content": ["I am trying to run the following code: iqtree2 -s input.fasta -nt AUTO -mem 1000G -o EPI_ISL_406801 -fast -keep-ident -m GTR+F+R4 -alninfo -bb 1000 But a message appear that we cannot add -bb parameter when -fast is present. Why is that? How can i perform the bootstrap in this case? How can i accelerate the analysis of my analysis of roughly 50 000 sequences of 30 000 lenght? thanks for your answer ", "Dear Santiago, The ultra-fast bootstrap (UFBoot) which one enables by -bb, requires the huge amount of trees seen during the \u2018normale\u2019 tree search in IQ-TREE. The search here can even be prolonged by UFBoot if the sample is not large enough yet, when the normal tree search without UFBoot would already stop. The fast option causes IQ-Tree to no do the full search, but only do 2 trees (1x parsimony starting tree and the NJ starting tree) to be evaluated by ML and optimised by NNIs. This only gives a quick preliminary glimpse towards a result, and is similarly fast and similarly sub-optimal compared to, e.g., FastTree. These fast runs should not be seen as a proper substitute for the full search. The set of tree touched during the evaluation of the two trees and their NNI optimisation is by far to small to do any meaning full UFBoot analysis. This is the reason why you cannot have UFBoot with the -fast option, even if you state -bb. However, it is still possible to do a standard bootstrap (with -b) as this samples randomly from the alignment and does a fast mode tree search on this. Please member that the number of bootstraps performed should rather be larger than the often-used absolute minimum of 100 bootstrap samples. This minimum was once determined in the past for much smaller datasets than those we have nowadays. I hope this answers your question. Best wishes, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/36800a48-6fde-401f-a362-843ae0334239n%40googlegroups.com ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- "]}, "NkntBKtPkRY": {"topic": "IQ-TREE release 1.6.7", "initializeDate": "Aug 23, 2018, 9:00:56 AM", "timeStamp": "Sep 22, 2018, 9:58:06 AM", "content": ["23-Aug-2018 Dear users, We are pleased to release IQ-TREE version 1.6.7. It contains a number of bugfixes and is highly recommended for all users. Important changes: \u2022 Temporarily disable AU test due to unresolved numerical issue when bp-rell are all zeros. Bugfixes: \u2022 Checkpointing issue in ModelFinder for mixture models causing incorrect likelihoods with e.g. -madd C10 (reported by Juergen Strassert). \u2022 Checkpointing Lie Markov models. \u2022 (v1.6.6) Incomplete parsing of site positions of partition file (reported by Alexey Kozlov). \u2022 Parsing polymorphic states from NEXUS file (reported by Steven Heritage). \u2022 Use of only 1 thread when #partitions < #cores (reported by Alexey Kozlov). \u2022 Double RAM usage for -bnni option (reported by Juergen Strassert). \u2022 Over-bound for optimizeTreeLengthScaling causing too long branch lengths in extreme cases (reported by vikaszsi77). \u2022 Exclude ORDERED model by default for morphological data due to frequent numerical underflow. \u2022 (v1.6) -m ..MERGE.. wrong concatenateAlignments with missing data (reported by David Dunchene). \u2022 Error message instead of crash when using -bsam with non-partition model (reported by Sarah Jensen). Best, IQ-TREE development team ", "I just noticed that the IQ-Trees I was building today told me I was using IQ-TREE multicore version 1.5.6 for Mac OS X 64-bit built Dec 4 2017 I went and downloaded version 1.6.7. and then I noticed that it does not include an update of the iqtree-omp multicore version. Will there be an update of iqtree-omp? Brian Foley HIV Databases ", "Hi Brian, From version 1.6.X only omp version is provided. So the binary is just `iqtree`, which is already the multicore version. If you omit -nt option, then it runs exactly the same as sequential version. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thanks! I missed that, and have still been using the iqtree-omp command and thus running an older version. "]}, "1kxjz3RM_yI": {"topic": "\"IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT\", ASR anlysis with codon model", "initializeDate": "Jun 17, 2020, 3:12:39 AM", "timeStamp": "Jul 3, 2020, 6:46:37 PM", "content": ["Hi, I launched an ASR job and received the following error message: Optimal log-likelihood: -78003.192 Nonsynonymous/synonymous ratio (omega): 0.117 Transition/transversion ratio (kappa): 1.000 Site proportion and rates: (0.036,0.143) (0.138,0.326) (0.225,0.598) (0.373,0.952) (0.174,1.625) (0.053,3.092) (0.002,7.859) Parameters optimization took 38 rounds (20224.067 sec) BEST SCORE FOUND : -78003.192 ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: /home/gdupre/work/HA_phylo/muscleAlign/ancestors/with_codons_models/with_dnatreefile/ali_dna_HA5_ntCDSlist.trim.aln.log ERROR: *** Alignment files (if possible) /bin/bash: line 1: 47554 Segmentation fault iqtree -s /home/gdupre/work/HA_phylo/muscleAlign/ancestors/with_codons_models/with_dnatreefile/ali_dna_HA5_ntCDSlist.trim.aln -m MG+F1X4+R7 -st CODON -te ali_dna_HA5_ntCDSlist.trim.aln.contree -asr With another data set (alignment which is very similar to the previous one, above), I also tried to perform an ASR analysis with the same command, but without specifying any user-provided tree, and I received the same error message: FINALIZING TREE SEARCH | -------------------------------------------------------------------- Performs final model parameters optimization Estimate model parameters (epsilon = 0.010) 1. Initial log-likelihood: -87225.673 2. Current log-likelihood: -87225.637 3. Current log-likelihood: -87225.621 Optimal log-likelihood: -87225.615 Nonsynonymous/synonymous ratio (omega): 0.099 Transition/transversion ratio (kappa): 1.000 Site proportion and rates: (0.020,0.084) (0.144,0.353) (0.353,0.650) (0.257,1.039) (0.173,1.677) (0.052,3.083) Parameters optimization took 3 rounds (1701.168 sec) BEST SCORE FOUND : -87225.615 ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: /home/gdupre/work/HA_phylo/muscleAlign/ancestors/with_codons_models/without_treefile/ali_dna_HA7_ntCDSlist.trim.aln.log ERROR: *** Alignment files (if possible) I do not understand where the problem is. How can I fix this issue? The logfiles of these jobs are attached to this post. Best regards Gabriel ", "It looks like some problem with codon models when combined with free-rate model [+R]. Olga has also recently found this issue. So can you please avoid using the free rate model, and just use Gamma model [+G]. Before we have time to look into the issue. Note that this is specific to codon models. If the problem still persists, let me know. Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/16a00ba2-683d-4f8e-8e27-c63424676f41o%40googlegroups.com <ali_dna_HA5_ntCDSlist.trim.aln.log> <ali_dna_HA7_ntCDSlist.trim.aln.log> ", "Hi, Thank you very much for your response. I'll keep you informed. Best regards, Gabriel ", "Hi, I got the same error message using the command \"-T AUTO\", \"-T 15\", \"-T 10\",... So, I just removed it and it run. But it takes a while to finish. I had the same issue with IQTree 1 and looks like this hasn't been solved. Best, Janice Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.114 seconds Generating 1000 samples for ultrafast bootstrap (seed: 373364)... NOTE: 165 MB RAM (0 GB) is required! Measuring multi-threading efficiency up to 16 CPU cores Increase to 10 rounds for branch lengths 10 trees examined Threads: 1 / Time: 17.756 sec / Speedup: 1.000 / Efficiency: 100% / LogL: -142912 Threads: 2 / Time: 10.464 sec / Speedup: 1.697 / Efficiency: 85% / LogL: -142912 Threads: 3 / Time: 8.468 sec / Speedup: 2.097 / Efficiency: 70% / LogL: -142912 Threads: 4 / Time: 8.217 sec / Speedup: 2.161 / Efficiency: 54% / LogL: -142912 ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers :*** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: ERROR: *** For bug report please send to developers:*** Log file: concat.log ERROR: *** Alignment files (if possible) ERROR: *** Log file: concat.log ERROR: *** Alignment files (if possible) Segmentation fault: 11 ", "Hi everyone, Is anyone else having problems? I can't get my files to load. They just hang on \"waiting\". You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9f3e3f1c-f5a1-4888-89c2-9464288ed5f3o%40googlegroups.com L. Lee Grismer, Director of Research Herpetology Laboratory Department of Biology, La Sierra University 4500 Riverwalk Parkway Riverside, CA 92515-8247, USA Tel. 951-785-2345 \"A risk free world is a very dull world, one from which we are apt to learn little of consequence.\" - Geerat Vermeij \"If people are good only because they fear punishment, and hope for reward, then we are a sorry lot indeed.\" - Albert Einstein ", "Hi Lee, Janice, Can you please send me the data and the log file per my personal email? While this same crash message occurs, the issue may be actually different\u2026 so I can only say something once having a look at individual cases. Thanks Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAMe9Yo9WSQWKC7tUhu8Xk78oekE3d7d2zW10aaD9CAOdc2Ln8Q%40mail.gmail.com ", "Hi Minh, As you said in your previous email on this issue, I tried to redo my ASR analysis for some of my data sets with another codon model (without the free-rate model, when it was possible). ASR analysis with a provided-DNA-tree worked well, but the same analysis without any provided tree failed (with the following error message: \"IQtree crashes with signal aborted\"). Have you got any update on this problem? I cannot change the codon model with my other data sets (alignments) as the likelihood, AIC, and BIC scores are too far from the best-estimated codon-model. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Gabriel, I suggest that you avoid doing codon models for tree reconstruction for your dataset: Alignment has 1928 sequences with 597 columns, 595 distinct patterns 558 parsimony-informative, 18 singleton sites, 21 constant sites This is rather short for a full analysis with complex codon models. So I\u2019d better (as you did) reconstruct a tree with DNA model, and then use the DNA tree as input for codon models for the ASR reconstruction. This is the same when people use PAML - users typically input a tree inferred by another software for PAML codon analysis. Cheers Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9d6fbdb9-66f1-423c-a51f-29c048642775o%40googlegroups.com "]}, "o4mGIxg8_Bw": {"topic": "Re: [iqtree] only one model remains after MF+MERGE", "initializeDate": "Jul 14, 2018, 8:02:34 AM", "timeStamp": "Jul 14, 2018, 8:02:34 AM", "content": ["Hi HT, If MERGE option results in one partition, it means that evolutionary rates between your partitions are not much different. And you can better use a single model for your super-alignment\u2026 Cheers Minh On 12 Jul 2018, at 5:36 pm, Hyoung Tae Kim < rlad...@gmail.com > wrote: my 20 partitions merged into one. Without +MERGE, there were 9 different models. +MERGE option could affect the phylogeny? Sincerely, You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "3oef3aIBC0Q": {"topic": "gCF and sCF interpretation question", "initializeDate": "Jan 8, 2021, 12:23:55 AM", "timeStamp": "Jan 8, 2021, 12:23:55 AM", "content": ["Hi all, This may be a naive question from a neophyte but I have a node that has some CF data that has me a little puzzled. The analysis was done on a concatenated dataset of 760 single copy core genome orthologs from 9 different strains of bacteria (same genus different species) following the directions on the iqtree website. The node in particular has a bootstrap/gCF/sCF of 100/62.2/37.7, a gCF/gDF1/gDF2/gDFP of 62.24/8.03/11.45/18.29, a gCF_N/gDF1_N/gDF2_N/gDFP_N of 473/61/87/139, an sCF/sDF1/sDF2 of 37.68/27.62/34.7 and an sCF_N/sDF1_N/sDF2_N of 10427.1/7646.89/9608.56. Now I would expect based on my limited understanding of concordance factors that if the sCF is low (approaching 33% indicating that there is little signal in the sites being analyzed) that the gCF would be low as well at least not as high as 62. However here we see that the gCF >> gDF1 and gDF2 but the sCF is somewhat similar to sDF1 and sDF2. How would one interpret these results? Any help would be greatly appreciated! Thanks. "]}, "5OnGhIbba8c": {"topic": "IQ-TREE on arm architecture", "initializeDate": "Dec 15, 2018, 3:06:36 AM", "timeStamp": "Dec 15, 2018, 11:31:28 PM", "content": ["Dear IQ-TREE Team I was wondering if it would be possible to compile IQ-TREE for linux on a ARM architecture like the raspberry pi's raspbian. We have recently presented our work : PhyloPi: an affordable, purpose built phylogenetic pipeline for the HIV drug resistance testing facility\" https://www.biorxiv.org/content/early/2018/07/13/367946 We have submitted the work to PLOS ONE and one of the reviewers suggested IQ-TREE (we currently use fasttree). Kind regards Armand ", "Hi Armand, That\u2019s interesting to hear (I didn\u2019t review your paper). I don\u2019t know much about this architecture, so I\u2019m forwarding your email to Andreas Tille from Debian, who created the iqtree package for Debian. @Andreas: Do you know if such iqtree package supports ARM? FYI: the -fast option in IQ-TREE is meant to supersede FastTree. It\u2019s as fast as FastTree and still generates better trees in terms of log-likelihoods (see e.g. this independent benchmark https://www.ncbi.nlm.nih.gov/pubmed/29774245 Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thank you for the quick response. Andreas, how do you think I should edit the CMakeList.txt file. I notice a some sections with if statements. Especially the # detect 32 or 64 bit binary and # configure SSE/AVX/FMA instructions sections. If I uncomment these sections in the CMakeList.txt file I get compilation to 22% with this error: [ 22%] Building C object pll/CMakeFiles/pll.dir/hardware.c.o /home/pi/IQ-TREE-1.6.8/pll/hardware.c: In function \u2018pllGetHardwareInfo\u2019: /home/pi/IQ-TREE-1.6.8/pll/hardware.c:32:3: error: impossible constraint in \u2018asm\u2019 asm volatile(\"cpuid\" ^~~ /home/pi/IQ-TREE-1.6.8/pll/hardware.c:32:3: error: impossible constraint in \u2018asm\u2019 asm volatile(\"cpuid\" ^~~ /home/pi/IQ-TREE-1.6.8/pll/hardware.c:32:3: error: impossible constraint in \u2018asm\u2019 asm volatile(\"cpuid\" ^~~ /home/pi/IQ-TREE-1.6.8/pll/hardware.c:32:3: error: impossible constraint in \u2018asm\u2019 asm volatile(\"cpuid\" ^~~ pll/CMakeFiles/pll.dir/build.make:182: recipe for target 'pll/CMakeFiles/pll.dir/hardware.c.o' failed make[2]: *** [pll/CMakeFiles/pll.dir/hardware.c.o] Error 1 CMakeFiles/Makefile2:288: recipe for target 'pll/CMakeFiles/pll.dir/all' failed make[1]: *** [pll/CMakeFiles/pll.dir/all] Error 2 Makefile:149: recipe for target 'all' failed make: *** [all] Error 2 I honestly don't know what I am doing ;-) Your suggestions please. Kind regards Armand On Sat, Dec 15, 2018 at 12:52 PM Andreas Tille < and...@an3as.eu > wrote: Hi, in the Debian package I've set the Architectures to Architecture: amd64 hurd-i386 i386 kfreebsd-amd64 kfreebsd-i386 (in other words excluded all non-Intel architectures). I do not remember why this was necessary but the default would to set Architecture: any which means it would be build on all available architectures supported by Debian (including arm64, armel and armhf). I assume I did this for a reason (may be iqtree has some assembler instructions or needs some features of specific graphics hardware which is only available for Intel architectures. Unfortunately I do not remember this reason any more but for sure I'm open for enabling other than the architectures mentioned above. Hope this helps Andreas. On Sat, Dec 15, 2018 at 09:13:23PM +1100, Minh Bui wrote: > Hi Armand, > That\u2019s interesting to hear (I didn\u2019t review your paper). I don\u2019t know much about this architecture, so I\u2019m forwarding your email to Andreas Tille from Debian, who created the iqtree package for Debian. > @Andreas: Do you know if such iqtree package supports ARM? > FYI: the -fast option in IQ-TREE is meant to supersede FastTree. It\u2019s as fast as FastTree and still generates better trees in terms of log-likelihoods (see e.g. this independent benchmark https://www.ncbi.nlm.nih.gov/pubmed/29774245 https://www.ncbi.nlm.nih.gov/pubmed/29774245 >). > Cheers > Minh > > On 15 Dec 2018, at 7:06 pm, Armand Bester < bester...@gmail.com > wrote: > > > > Dear IQ-TREE Team > > > > I was wondering if it would be possible to compile IQ-TREE for linux on a ARM architecture like the raspberry pi's raspbian. We have recently presented our work : > > > > \"PhyloPi: an affordable, purpose built phylogenetic pipeline for the HIV drug resistance testing facility\" > > > > at > > > > https://www.biorxiv.org/content/early/2018/07/13/367946 https://www.biorxiv.org/content/early/2018/07/13/367946 > > > > We have submitted the work to PLOS ONE and one of the reviewers suggested IQ-TREE (we currently use fasttree). > > > > Kind regards > > Armand > > > > -- > > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com <mailto: iqtree+un...@googlegroups.com > > To post to this group, send email to iqt...@googlegroups.com <mailto: iqt...@googlegroups.com > > Visit this group at https://groups.google.com/group/iqtree https://groups.google.com/group/iqtree > > For more options, visit https://groups.google.com/d/optout https://groups.google.com/d/optout http://fam-tille.de "]}, "YQVvoibuukU": {"topic": "IQ-Tree package for FreeBSD", "initializeDate": "Dec 4, 2017, 2:40:55 PM", "timeStamp": "Dec 4, 2017, 2:40:55 PM", "content": ["Dear users, An IQ-TREE package for FreeBSD is kindly made available by Joseph Mingrone (Dalhousie University, Canada): https://www.freshports.org/biology/iqtree/ IQ-TREE can be easily installed via command line: pkg install iqtree IQ-TREE is also available on other platforms (Debian/Ubuntu, Anaconda, Homebrew etc.). See http://www.iqtree.org/doc/Quickstart#installation for more information. Cheers, Minh "]}, "0jJr3Xf0Sw4": {"topic": "Latest version of IQTREE", "initializeDate": "May 14, 2020, 8:31:41 AM", "timeStamp": "Sep 22, 2020, 9:54:07 PM", "content": ["Hello everyone, Can anyone tell me how do I install IQTREE version 2? ", "Hello Mukta, you can install version 2.0.3 using conda: https://anaconda.org/bioconda/iqtree All the best, -- Alex ", "Thanks for the answer Alex. And a follow-up: The normal \u201cconda install iqtree\u201d might just install v1. I have to run this to install the latest version: conda update -c bioconda -c conda-forge iqtree Here is the information I got from Torsten Seemann: that happens a lot and is due to your base env not being modern enough conda activate base conda update --all ideally then conda create -n iqtree_env iqtree conda activate iqtree_env iqtree --version Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/9eb84692-5e98-485e-bd5d-357ed8f19ee6%40googlegroups.com ", "Hi - Could someone tell me what file iqtree modifies so that it's path is found when you invoke it from any directory? It worked for me but I don't seem to see a .bash_profile on my Mac (OSX mojave 10.14.16). I would like to put some other paths in the same file as the iqtree path but I can't find the file. Thanks. Scott ", "Hi Scott, Am I right, that you want to see which path to the IQ-TREE executable is that? On a Mac (and Linux) you can run \u201cwhich iqtree\u201d from the command line to find that out. Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/3667c747-9285-423a-af40-c28b7471edb1n%40googlegroups.com "]}, "jh_XbOBALmE": {"topic": "Re: [iqtree] No rapid bootstrap support value for node?", "initializeDate": "Feb 28, 2019, 8:05:04 AM", "timeStamp": "Feb 28, 2019, 3:22:55 PM", "content": ["Hi Conrad, I believe that shouldn\u2019t happen. 0 support will be printed as 0. Can you send me the command line? Perhaps also the .contree file for further inspection. Cheers, Minh On 28 Feb 2019, at 5:32 pm, Conrad Izydorczyk < conradiz...@gmail.com > wrote: Hello, In a recent run of IQ-Tree on 2 separate bacterial data sets, I noticed that there usually ends up at least node with no value reported from rapid bootstraps in the .contree file. I run 100,000 rapid bootstraps, but certain branch points end up with no value. Does this mean there is 0 support for the node? Alternatively, what might cause 0 support for a node? Shouldn't the node end up placed (in the consensus tree) where there is at least 1 supporting bootstrapped tree? Any help in understanding this would be greatly appreciated. Thank you, Conrad Izydorczyk You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Dear Conrad, One additional comment about these support values. The (bootstrap) support values denote support for branches, not nodes. Technically, in the Newick string the support values are written as label of a node, but they refer to the branch root-wards of that tree. The \u2018root\u2019 is not the biological root, but just the node defined by the outer-most bracket of the Newick string. But this is only a technicality. Current Tree-Viewers like FigTree et al do interpret and apply theses values correctly and still place them correctly if the tree is re-rooted (e.g. TreeTool in the past did not and one had to correct them manually). If the support value would apply to a node, they would express support for a trifurcation (in a binary tree) meaning that the taxa/sequences are clustering in the three groups defined by the (at least) 3 branches attached to that node. (Ultrafast/rapid) Bootstrap support values, however, are computed by counting how often the respective branch, i.e. the bipartition or split into two groups of taxa, can be found in the bootstrap trees. Thus, it is clearly a branch and not a node support. I hope that helps to clarify matters, because sometimes these support values are falsely referred to as node support. Best wishes, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) Campus Vienna Biocenter 5 (VBC5) A-1030 Vienna, Austria ----------------------------------------------------------------------------- Email: heiko.schmidt(AT) univie.ac.at Tel. : ++43 +1 / 4277 - 74321 http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Hello, Thank you for your responses. I no longer think this is an issue - I believe I was just misinterpreting the view my treeviewer (Dendroscope/FigTree) gave me. In essence, I forgot that a branch leading to a tip will not have a bootstrap support value and that it is the branches that have bootstrap support, NOT nodes. I realized my mistake shortly after posting the issue - I tried to delete it afterward. Thank you again for your help. Best regards, Conrad "]}, "L3BuvSdd6NU": {"topic": "Sequence descriptor", "initializeDate": "Mar 8, 2021, 7:52:05 AM", "timeStamp": "Mar 9, 2021, 6:08:30 AM", "content": ["Hello, I am new to IQ-TREE. Prior to running IQ-TREE I passed my sequence alignments into a trimming programme. The trimming programme altered the species name in the following way: From \u2018>Arabidopsis_thaliana\u2019 to \u2018>Arabidopsis_thaliana 94 bp\u2019. In the resulting tree, the species names were not altered, i.e. they remained \u2018>Arabidopsis_thaliana\u2019. Will the additional \u201894 bp\u2019 text have altered the output tree, or will IQ-TREE have ignored it? Any help will be greatly appreciated! Best wishes, Lizzie ", "Hi Lizzie, We were aware of these extra bits added by some alignment editor. Here is how IQ-TREE parses the sequence names in the fasta file: IQ-TREE will try to use all sequence names up to the first occurence of an empty character, if that doesn\u2019t result in duplicated names. Otherwise, IQ-TREE will try all names up to the 2nd occurence of empty char. If that still doesn\u2019t work, it will try to the 3rd occurence. And so on. That helps remove the hassle of these alignment processing programs. For example, this file: >seq1 94 bp ... >seq2 94 bp ... >seqN 94 bp will result in the names seq1, seq2, \u2026, seqN. But this file: >seq1 1 94 bp ... >seq1 2 94 bp ... >seq2 1 94 bp will result in naming seq1_1, seq1_2, seq2_1,\u2026 Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b439ca71-ac31-48fa-9325-f903c4f79b99n%40googlegroups.com ", "Fantastic! Much appreciated. Best wishes, Lizzie "]}, "YqfkLcxWjiU": {"topic": "IQ-TREE multicore version 1.4.3 seems to hang", "initializeDate": "Aug 3, 2016, 5:56:29 AM", "timeStamp": "Aug 12, 2016, 10:17:50 AM", "content": ["Hello! I have been doing several Iqtree runs that I intend to compare and on one of the input files Iqtree run seems to have hanged without any error messages. The runs I am launching are of the following format on a series of alignments that vary in length and represent a gradual bias removal: iqtree-omp -s al_f$i.phy -m LG+C60+F -nt 35 -bb 1000 The run simply stopped using processors, did not output anything to the log for over a day after the following lines: -------------------------------------------------------------------- | OPTIMIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Iteration 30 / LogL: -447340.633 / Time: 1h:49m:55s (4h:29m:7s left) Iteration 40 / LogL: -447311.404 / Time: 2h:24m:54s (3h:46m:38s left) Estimate model parameters (epsilon = 0.010) UPDATE BEST LOG-LIKELIHOOD: -447308.671 Estimate model parameters (epsilon = 0.010) UPDATE BEST LOG-LIKELIHOOD: -447305.011 Iteration 50 / LogL: -447311.904 / Time: 3h:3m:11s (3h:10m:39s left) Log-likelihood cutoff on original alignment: -447399.228 Iteration 60 / LogL: -447317.510 / Time: 3h:41m:51s (2h:34m:9s left) Iteration 70 / LogL: -447348.883 / Time: 4h:17m:24s (1h:55m:38s left) Iteration 80 / LogL: -447340.217 / Time: 4h:51m:52s (1h:17m:35s left) Iteration 90 / LogL: -447304.607 / Time: 5h:28m:17s (0h:40m:34s left) Estimate model parameters (epsilon = 0.010) BETTER TREE FOUND at iteration 90: -447303.034 -------- It did not run out of memory - I have runs with higher memory requirements that completed. There is nothing special about that particular phylip file. I have now tried using the same file on another computer to see if something interrupted that particular run perhaps, but it stopped at the same point. So I guess with the same default seed it is getting stuck(?) at the exact same place. -------------------------------------------------------------------- | OPTIMIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Iteration 30 / LogL: -447310.312 / Time: 1h:32m:26s (3h:46m:16s left) Estimate model parameters (epsilon = 0.010) UPDATE BEST LOG-LIKELIHOOD: -447303.034 Iteration 40 / LogL: -447306.145 / Time: 2h:7m:51s (3h:19m:58s left) Iteration 50 / LogL: -447308.133 / Time: 2h:39m:15s (2h:45m:44s left) Log-likelihood cutoff on original alignment: -447387.690 Iteration 60 / LogL: -447319.700 / Time: 3h:10m:42s (2h:12m:30s left) Iteration 70 / LogL: -447321.769 / Time: 3h:42m:47s (1h:40m:5s left) Iteration 80 / LogL: -447352.411 / Time: 4h:12m:58s (1h:7m:14s left) Iteration 90 / LogL: -447303.149 / Time: 4h:44m:34s (0h:35m:10s left) -------- Have anyone encountered similar problem? Any advice on how to proceed? I could perhaps try explicitly giving a seed and make sure it is different from the default, and see what happens. What do you think? thanks, Kasia ", "Dear Kasia, that\u2019s weird, can you send me your alignment via my personal email? I will have a look. Thanks, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Kasia, I repeated the analysis in my machine, and IQ-TREE completed after 1 day using 12 cores without any problem. I will send you the output files via private email. Thus, I suspect this has something to do with your machines. Since IQ-TREE only hang without printing any crash message, is there any restriction in your system? Is using 35 cores too much for your machine? I suggest that you contact the local admin. Cheers, Minh > On Aug 3, 2016, at 11:56 AM, katarzyna.zarem...@gmail.com wrote: "]}, "yzyHDR3q8rM": {"topic": "Segmentation fault codon model", "initializeDate": "Nov 27, 2015, 5:11:24 AM", "timeStamp": "Dec 14, 2015, 11:32:25 AM", "content": ["Hi, I got a segmentation fault (see below) when running the model GY+F0+I+G on a single partition and using the command TEST. However, I did not get a segmentation fault if I did the same analyses with 2 partitions? Any tip to solve the problem? Thanks in advance, Joan Computing ML distances based on estimated model parameters... 27.790 sec WARNING: Some pairwise ML distances are too long (saturated) Computing BIONJ tree... 0.002 seconds Log-likelihood of BIONJ tree: -180892.061 Generating 98 parsimony trees... STACK TRACE FOR DEBUGGING: 1 funcAbort() 2 () 3 std::string::assign(std::string const&) 4 IQTree::initCandidateTreeSet(int, int) 5 runTreeReconstruction(Params&, std::string&, IQTree&, std::vector<ModelInfo, std::allocator<ModelInfo> >&) 6 runPhyloAnalysis(Params&) 7 main() 8 __libc_start_main() *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT *** For bug report please send to developers: *** Log file: 30typ13g.phy_TEST_CODON_MODEL_out.log *** Alignment files (if possible) ", "Dear Joan, there is a typo in your model string: should be +FO (Oh) instead +F0 (zero) Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Sorry, I did a mistake when I copyied the model, the correct one is GY+F+I+G4. Moreover, I got the same error/segmentation fault (see below) when I use this commands (i.e. TEST for the best model rather than specifying it) iqtree-omp -nt 20 -s 30typ13g.phy -pre 30typ13g.phy_TEST_CODON_MODEL_out -st CODON5 -m TEST Thanks a lot your help. Joan IQ-TREE multicore version 1.3.10 for Linux 64-bit built Nov 12 2015 Copyright (c) 2011-2015 Nguyen Lam Tung, Olga Chernomor, Arndt von Haeseler and Bui Quang Minh. Host: foner14 (AVX, 252 GB RAM) Command: iqtree-omp -nt 20 -s 30typ13g.phy -pre 30typ13g.phy_TEST_CODON_MODEL_out -st CODON5 -m TEST Seed: 470977 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Sat Nov 21 08:17:45 2015 Kernel: AVX - 20 threads (20 CPU cores detected) Reading alignment file 30typ13g.phy ... Phylip format detected Alignment most likely contains DNA/RNA sequences Converting to codon sequences with genetic code 5 ... WARNING: Sequence Tgarci has ambiguous character GTS at site 1333 WARNING: Sequence Lstyli has ambiguous character YTA at site 5386 Alignment has 30 sequences with 3651 columns and 3640 patterns (3579 informative sites) Gap/Ambiguity Composition p-value 1 Epacif 0.05% failed 0.00% 2 Achine 0.05% failed 0.00% 3 Mjapon 0.05% failed 0.55% 4 Lstyli 0.08% failed 0.00% 5 Mnippo 0.08% failed 1.70% 6 Upusil 0.14% failed 0.00% 7 Pcrass 0.19% failed 0.00% 8 Ngraci 0.05% failed 0.00% 9 Paustr 0.03% failed 0.00% 10 Hfowle 0.00% failed 0.26% 11 Hrubra 0.14% failed 0.00% 12 Ndenti 0.03% failed 0.00% 13 Slanci 0.03% passed 59.64% 14 Sstyli 0.03% passed 84.96% 15 Tconso 0.03% failed 0.94% 16 TgalIs 0.05% failed 0.00% 17 Tilife 0.03% failed 0.00% 18 Tmirav 0.05% failed 0.95% 19 Tmonae 0.03% failed 0.01% 20 Tpears 0.03% failed 0.00% 21 Ttaina 0.03% passed 7.76% 22 Tmadag 0.05% failed 0.00% 23 Tzanzi 0.03% failed 0.00% 24 Tmiche 0.03% failed 0.00% 25 TgalSc 0.05% failed 0.04% 26 Tarfea 0.03% passed 13.36% 27 Tdzila 0.03% failed 0.00% 28 Tgarci 0.05% failed 0.00% 29 Shispi 0.22% failed 0.00% 30 Ptritu 0.19% failed 0.00% **** TOTAL 0.06% 26 sequences failed composition chi2 test (p-value<5%; df=63) Creating fast SIMD initial parsimony tree by random order stepwise addition... 0.059 seconds, parsimony score: 41128 (based on 3579 informative sites) NOTE: MODEL SELECTION REQUIRES 246 MB MEMORY! Testing 28 codon models (sample size: 3651) ... No. Model -LnL df AIC AICc BIC 1 MG+F1X4 193668.931 61 387459.863 387461.970 387838.231 2 MG+F1X4+I 193603.864 62 387331.729 387333.906 387716.299 3 MG+F1X4+G4 186216.882 62 372557.763 372559.941 372942.334 4 MG+F1X4+I+G4 186216.266 63 372558.531 372560.779 372949.305 5 MG+F3X4 191710.766 67 383555.533 383558.076 383971.117 6 MG+F3X4+I 191648.450 68 383432.901 383435.521 383854.688 7 MG+F3X4+G4 184003.786 68 368143.572 368146.192 368565.359 8 MG+F3X4+I+G4 183998.833 69 368135.666 368138.364 368563.656 9 MGK+F1X4 192062.546 62 384249.092 384251.269 384633.662 10 MGK+F1X4+I 191978.377 63 384082.753 384085.002 384473.527 11 MGK+F1X4+G4 184684.419 63 369494.838 369497.086 369885.612 12 MGK+F1X4+I+G4 184671.074 64 369470.148 369472.468 369867.124 13 MGK+F3X4 189959.634 68 380055.269 380057.888 380477.056 14 MGK+F3X4+I 189882.793 69 379903.587 379906.284 380331.577 15 MGK+F3X4+G4 182590.628 69 365319.257 365321.954 365747.247 16 MGK+F3X4+I+G4 182572.812 70 365285.625 365288.401 365719.818 17 GY+F1X4 192210.881 62 384545.762 384547.939 384930.333 18 GY+F1X4+I 192104.105 63 384334.211 384336.459 384724.985 19 GY+F1X4+G4 184581.755 63 369289.511 369291.759 369680.284 20 GY+F1X4+I+G4 184573.972 64 369275.943 369278.264 369672.920 21 GY+F3X4 189175.538 68 378487.076 378489.696 378908.864 22 GY+F3X4+I 189074.897 69 378287.795 378290.492 378715.785 23 GY+F3X4+G4 182137.475 69 364412.951 364415.648 364840.941 24 GY+F3X4+I+G4 182101.598 70 364343.197 364345.974 364777.390 25 GY+F 187972.285 122 376188.570 376197.077 376945.306 26 GY+F+I 187860.342 123 375966.685 375975.333 376729.624 27 GY+F+G4 180426.471 123 361098.942 361107.591 361861.881 28 GY+F+I+G4 180393.302 124 361034.604 361043.396 361803.745 Akaike Information Criterion: GY+F+I+G4 Corrected Akaike Information Criterion: GY+F+I+G4 Bayesian Information Criterion: GY+F+I+G4 Best-fit model: GY+F+I+G4 chosen according to BIC CPU time for model selection: 15325.790 seconds. NOTE: 246 MB RAM is required! Estimate model parameters (epsilon = 0.100) 1. Initial log-likelihood: -235917.517 2. Current log-likelihood: -191812.704 3. Current log-likelihood: -182001.255 4. Current log-likelihood: -181121.766 5. Current log-likelihood: -180823.631 6. Current log-likelihood: -180664.901 7. Current log-likelihood: -180571.354 8. Current log-likelihood: -180513.641 9. Current log-likelihood: -180476.373 10. Current log-likelihood: -180451.505 11. Current log-likelihood: -180434.528 12. Current log-likelihood: -180422.770 13. Current log-likelihood: -180414.534 14. Current log-likelihood: -180408.697 15. Current log-likelihood: -180404.519 16. Current log-likelihood: -180401.512 17. Current log-likelihood: -180399.356 18. Current log-likelihood: -180397.763 19. Current log-likelihood: -180396.593 20. Current log-likelihood: -180395.737 21. Current log-likelihood: -180395.207 22. Current log-likelihood: -180394.783 23. Current log-likelihood: -180394.444 24. Current log-likelihood: -180394.186 25. Current log-likelihood: -180394.059 26. Current log-likelihood: -180393.948 Optimal log-likelihood: -180393.785 Nonsynonymous/synonymous ratio (omega): 0.014 Transition/transversion ratio (kappa): 2.271 Proportion of invariable sites: 0.002 Gamma shape alpha: 0.767 Parameters optimization took 26 rounds (87.158 sec) -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- ", "Dear Joan, Thanks for the details, I found that it is a minor problem with the multicore version. I fixed that here already and will include for the next release. Right now as a quick work around, please switch to the sequential version, which should not have this problem. Thanks, Minh ", "Dear Joan, this problem is now fixed in version 1.3.11 just released Cheers, Minh > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com ", "Dear Minh, Thanks a lot for the update. I will install it in our server to test our dataset. Thanks a lot, cheers, Joan Cheers, Minh > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at You received this message because you are subscribed to a topic in the Google Groups \"IQTREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/yzyHDR3q8rM/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com "]}, "LYhF3oxafto": {"topic": "Partitioned analysis with mixed aa and nt data", "initializeDate": "Mar 4, 2020, 12:49:13 PM", "timeStamp": "Mar 10, 2020, 5:32:14 PM", "content": ["Hi! I am using IQTree 2.0 with macOS Catalina and fairly new to ML. I am trying to run a partitioned analysis of bacterial sequence alignments. One is of 16S and the other is of rpoB amino acids. I am using the strategy that I found in the manual ( http://www.iqtree.org/doc/Advanced-Tutorial#partitioned-analysis-with-mixed-data ) to run the mixed data but I run in to a killed: 9 message. The partition file that I set up is: #nexus begin sets; charset part1 = Rhizobiales_16S_128.phy: 1-1553; charset part2 = Rhizobiales_rpoB_aa_95.phy: 1-1551; charpartition mine = GTR+F+R5:part1, LG+F+R8:part2; end; and in the command line I am trying the following (I am in the directory with my files): (base) Carmens-MacBook-Pro:rpob_aa_ML carmenallen$ /Users/carmenallen/Programs/ iqtree-2.0-rc1-MacOSX/bin/ iqtree -p Rhizobiales_mix_16s_rpoBaa.nex -nt auto -pre 16S_rpoBaa -mem 0.5 The run seems to start OK but then my computer thinks for awhile and then gives me a Killed:9 error which I think means that it took too much memory. There is one aa sequence that did not pass the chi2 (below) although it looks just fine on the alignment. Not sure if that is a problem. Any suggestions?? Thank you in advance, Carmen (base) Carmens-MacBook-Pro:rpob_aa_ML carmenallen$ /Users/carmenallen/Programs/iqtree-2.0-rc1-MacOSX/bin/iqtree -p Rhizobiales_mix_16s_rpoBaa.nex -nt auto -pre 16S_rpoBaa -mem 0.5 IQ-TREE multicore version 2.0-rc1 for Mac OS X 64-bit built Nov 21 2019 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: Carmens-MacBook-Pro.local (AVX2, FMA3, 16 GB RAM) Command: /Users/carmenallen/Programs/iqtree-2.0-rc1-MacOSX/bin/iqtree -p Rhizobiales_mix_16s_rpoBaa.nex -nt auto -pre 16S_rpoBaa -mem 0.5 Seed: 900334 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Mar 4 09:35:53 2020 Kernel: AVX+FMA - auto-detect threads (12 CPU cores detected) Reading partition model file Rhizobiales_mix_16s_rpoBaa.nex ... Loading 2 partitions... Reading alignment file Rhizobiales_16S_128.phy ... Phylip format detected Alignment most likely contains DNA/RNA sequences WARNING: 1 sites contain only gaps or ambiguous characters. Alignment has 128 sequences with 1553 columns, 809 distinct patterns 502 parsimony-informative, 201 singleton sites, 850 constant sites Gap/Ambiguity Composition p-value 1 Acetobacter_aceti 4.70% passed 46.11% 2 Endobacter_medicaginis 3.93% passed 52.99% 3 Rhodovastum_atsumiense 4.19% passed 17.14% 4 Aurantimonas_coralicida 9.85% passed 99.63% 5 Fulvimarina_pelagi 7.15% passed 91.96% 6 Bartonella_bacilliformis 5.28% passed 75.86% 7 Brucella_melitensis 9.08% passed 99.64% 8 Ochrobactrum_anthropi 10.62% passed 98.06% 9 Daeguia_caeni 7.21% passed 85.48% 10 Mycoplana_dimorpha 7.86% passed 93.18% 11 Sinorhizobium_fredii 7.47% passed 97.94% 12 Ensifer_adhaerens 8.18% passed 98.64% 13 Ciceribacter_lividus 10.37% passed 99.27% 14 Rhizobium_giardinii 4.89% passed 93.61% 15 Shinella_zoogloeoides 9.53% passed 94.43% 16 Shinella_granuli 8.89% passed 93.22% 17 Agrobacterium_tumefaciens 5.22% passed 85.07% 18 Neorhizobium_galegae 6.18% passed 95.18% 19 Pseudorhizobium_pelagicum 4.19% passed 97.68% 20 Chelativorans_multitrophicus 8.89% passed 90.46% 21 Mesorhizobium_loti 7.47% passed 99.80% 22 Aminobacter_aminovorans 5.34% passed 99.44% 23 Carbophilus_carboxidus 4.89% passed 99.55% 24 Phyllobacterium_myrsinacearum 9.79% passed 99.68% 25 Pseudaminobacter_salicylatoxidans 6.05% passed 98.43% 26 Corticibacterium_populi 7.60% passed 93.95% 27 Tianweitania_sediminis 6.83% passed 96.85% 28 Aquamicrobium_defluvii 8.37% passed 99.51% 29 Oricola_cellulosilytica 6.31% passed 99.59% 30 Pseudohoeflea_suaedae 6.70% passed 96.45% 31 Roseitalea_porphyridii 8.63% passed 99.35% 32 Rhizobium_undicola 7.86% passed 95.81% 33 Rhizobium_leguminosarum 8.37% passed 96.59% 34 Falsochrobactrum_ovis 6.12% passed 38.73% 35 Paenochrobactrum_gallinarii 13.39% passed 58.63% 36 Pseudochrobactrum_asaccharolyticum 6.25% passed 37.10% 37 Nitratireductor_aquibiodomus 6.25% passed 99.59% 38 Hoeflea_marina 4.89% passed 99.57% 39 Lentilitoribacter_donghaensis 7.08% passed 68.37% 40 Pseudahrensia_aquimaris 7.21% passed 70.62% 41 Amorphus_coralli 7.41% passed 89.36% 42 Afifella_marina 10.50% passed 91.26% 43 Butyratibacter_algicola 3.99% passed 84.54% 44 Lutibaculum_baratangense 6.31% passed 54.37% 45 Tepidamorphus_gemmatus 10.43% passed 37.93% 46 Rhodobium_orientis 9.34% passed 95.77% 47 Cucumibacter_marinus 12.56% passed 89.34% 48 Pelagibacterium_halotolerans 9.34% passed 67.29% 49 Arsenicitalea_aurantiaca 7.41% passed 100.00% 50 Methyloterrigena_soli 8.56% passed 91.79% 51 Paradevosia_shaoguanensis 9.40% passed 90.90% 52 Youhaiella_tibetensis 6.83% passed 84.10% 53 Devosia_riboflavina 8.44% passed 81.84% 54 Prosthecomicrobium_sp 7.73% passed 60.06% 55 Pseudoxanthobacter_soli 7.53% passed 98.31% 56 Chthonobacter_albigriseus 9.59% passed 70.73% 57 Oharaeibacter_diazotrophicus 9.34% passed 48.85% 58 Pleomorphomonas_oryzae 7.60% passed 92.12% 59 Pleomorphomonas_koreensis 8.76% passed 99.59% 60 Pleomorphomonas_diazotrophica 7.15% passed 96.57% 61 Angulomicrobium_tetraedrale 9.40% passed 96.57% 62 Starkeya_novella 9.47% passed 86.11% 63 Ancylobacter_aquaticus 8.56% passed 98.36% 64 Methylorhabdus_multivorans 13.91% passed 73.30% 65 Aquabacter_spiritensis 5.09% passed 97.27% 66 Xanthobacter_autotrophicus 9.08% passed 89.97% 67 Azorhizobium_caulinodans 5.47% passed 97.86% 68 Blastochloris_viridis 5.54% passed 58.55% 69 Hansschlegelia_plantiphila 10.24% passed 99.83% 70 Methylopila_capsulata 9.92% passed 93.40% 71 Albibacter_methylovorans 4.96% passed 97.17% 72 Rhodoblastus_acidophilus 4.89% passed 81.07% 73 Methylocapsa_acidiphila 8.89% passed 96.34% 74 Methylocella_palustris 10.30% passed 99.97% 75 Methylorosula_polaris 9.01% passed 80.04% 76 Methyloferula_stellata 9.34% passed 88.94% 77 Methylocapsa_palsarum 9.53% passed 93.47% 78 Beijerinckia_indica 4.70% passed 72.67% 79 Methylocella_silvestris 9.27% passed 98.38% 80 Methylocystis_parvus 9.34% passed 94.67% 81 Methylocystis_echinoides 9.40% passed 94.08% 82 Methylosinus_sporium 9.34% passed 99.45% 83 Methylosinus_trichosporium 9.21% passed 93.89% 84 Methylocystis_heyeri 8.24% passed 98.54% 85 Bosea_thiooxidans 5.67% passed 99.28% 86 Lichenihabitans_psoromatis 9.01% passed 99.44% 87 Rhodoplanes_roseus 6.44% passed 60.43% 88 Afipia_felis 8.56% passed 86.94% 89 Oligotropha_carboxidovorans 4.89% passed 97.86% 90 Rhodopseudomonas_palustris 9.08% passed 98.77% 91 Nitrobacter_winogradskyi 4.06% passed 96.80% 92 Bradyrhizobium_japonicum 4.64% passed 98.72% 93 Seliberia_stellata 6.83% passed 91.68% 94 Blastobacter_denitrificans 7.08% passed 98.71% 95 Tardiphaga_robiniae 7.34% passed 81.14% 96 Variibacter_gotjawalensis 9.40% passed 96.79% 97 Psychroglaciecola_arctica 12.88% passed 89.15% 98 Enterovirga_rhinocerotis 5.22% passed 95.48% 99 Methylobacterium_organophilum 7.73% passed 81.43% 100 Methylobacterium_extorquens 7.60% passed 70.70% 101 Uncultured_Methylobacterium 58.15% passed 79.13% 102 Microvirga_subterranea 4.96% passed 82.26% 103 Pseudolabrys_taiwanensis 10.75% passed 76.65% 104 Dichotomicrobium_thermohalophilum 5.41% passed 77.18% 105 Rhodoligotrophos_appendicifer 5.86% passed 58.94% 106 Anderseniella_baltica 9.47% passed 57.79% 107 Ancalomicrobium_adetum 9.47% passed 90.46% 108 Polyprosthecobacterium_yinchuanense 10.11% passed 70.87% 109 Cohaesibacter_gelatinilyticus 11.53% passed 55.72% 110 Mabikibacter_ruber 15.07% passed 96.37% 111 Parvibaculum_lavamentivorans 6.57% passed 98.43% 112 Liberibacter_crescens 4.57% passed 52.07% 113 Kaistia_adipata 9.14% passed 98.77% 114 Labrys_monachus 7.21% passed 93.87% 115 Lichenibacterium_ramalinae 8.44% passed 71.75% 116 Lichenibacterium_minor 8.69% passed 70.30% 117 Uncultured_Rhizobiales 58.02% passed 79.40% 118 Rhodomicrobium_vannielii 5.34% passed 95.00% 119 Meganema_perideroedes 10.95% passed 93.99% 120 Filomicrobium_fusiforme 9.21% passed 97.11% 121 Hyphomicrobium_denitrificans 7.02% passed 88.78% 122 Pedomicrobium_ferrugineum 9.98% passed 93.93% 123 Maritalea_myrionectae 12.94% passed 65.22% 124 Tepidicaulis_marinus 10.11% passed 97.30% 125 Salinarimonas_rosea 9.08% passed 52.48% 126 Thalassocola_ureilytica 7.08% passed 94.55% 127 Terasakiella_pusilla 7.98% passed 26.12% 128 Roseospirillum_parvum 15.84% passed 63.21% WARNING: 2 sequences contain more than 50% gaps/ambiguity **** TOTAL 8.79% 0 sequences failed composition chi2 test (p-value<5%; df=3) Reading alignment file Rhizobiales_rpoB_aa_95.phy ... Phylip format detected Alignment most likely contains protein sequences WARNING: 66 sites contain only gaps or ambiguous characters. Alignment has 95 sequences with 1551 columns, 902 distinct patterns 684 parsimony-informative, 170 singleton sites, 697 constant sites Gap/Ambiguity Composition p-value 1 Acetobacter_aceti 10.38% passed 98.74% 2 Rhodovastum_atsumiense 10.32% passed 52.87% 3 Roseospirillum_parvum 10.44% passed 97.65% 4 Terasakiella_pusilla 10.70% passed 99.60% 5 Aurantimonas_coralicida 10.44% passed 99.86% 6 Fulvimarina_pelagi 11.03% passed 98.92% 7 Brucella_melitensis 11.22% passed 100.00% 8 Ochrobactrum_anthropi 11.22% passed 100.00% 9 Falsochrobactrum_ovis 11.22% passed 99.99% 10 Pseudochrobactrum_asaccharolyticum 11.15% passed 99.98% 11 Phyllobacterium_myrsinacearum 10.77% passed 100.00% 12 Mesorhizobium_loti 11.15% passed 100.00% 13 Aminobacter_aminovorans 11.22% passed 99.94% 14 Aquamicrobium_defluvii 11.15% passed 100.00% 15 Pseudaminobacter_salicylatoxidans 11.09% passed 100.00% 16 Nitratireductor_aquibiodomus 11.09% passed 99.97% 17 Mabikibacter_ruber 10.32% passed 100.00% 18 Shinella_zoogloeoides 11.09% passed 99.99% 19 Shinella_granuli 11.09% passed 100.00% 20 Mycoplana_dimorpha 11.09% passed 100.00% 21 Sinorhizobium_fredii 11.03% passed 100.00% 22 Ensifer_adhaerens 11.09% passed 100.00% 23 Rhizobium_giardinii 11.09% passed 100.00% 24 Agrobacterium_tumefaciens 11.15% passed 99.03% 25 Ciceribacter_lividus 11.15% passed 99.05% 26 Rhizobium_undicola 11.09% passed 99.25% 27 Neorhizobium_galegae 11.15% passed 99.73% 28 Pseudorhizobium_pelagicum 10.64% passed 99.38% 29 Rhizobium_leguminosarum 11.09% passed 99.98% 30 Hoeflea_marina 11.03% passed 99.58% 31 Pseudohoeflea_suaedae 11.03% passed 100.00% 32 Oricola_cellulosilytica 10.96% passed 99.97% 33 Roseitalea_porphyridii 11.03% passed 100.00% 34 Bartonella_bacilliformis 10.83% passed 99.42% 35 Rhodoblastus_acidophilus 11.22% passed 100.00% 36 Methylocapsa_acidiphila 11.28% passed 100.00% 37 Methylocapsa_palsarum 11.28% passed 100.00% 38 Methylocella_silvestris 11.28% passed 100.00% 39 Beijerinckia_indica 10.57% passed 99.99% 40 Methyloferula_stellata 11.09% passed 99.98% 41 Lichenihabitans_psoromatis 11.61% passed 99.98% 42 Lichenibacterium_ramalinae 11.15% passed 99.51% 43 Lichenibacterium_minor 11.15% passed 99.73% 44 Methylocystis_parvus 9.74% passed 99.78% 45 Methylocystis_heyeri 11.03% passed 99.83% 46 Methylosinus_trichosporium 10.83% passed 99.99% 47 Methylosinus_sporium 10.90% passed 99.85% 48 Afipia_felis 11.15% passed 99.97% 49 Oligotropha_carboxidovorans 11.22% passed 99.99% 50 Rhodopseudomonas_palustris 11.41% passed 99.99% 51 Bradyrhizobium_japonicum 11.54% passed 99.97% 52 Nitrobacter_winogradskyi 11.03% passed 100.00% 53 Tardiphaga_robiniae 11.61% passed 99.92% 54 Pseudolabrys_taiwanensis 11.54% passed 99.94% 55 Rhodoplanes_roseus 11.48% passed 99.95% 56 Variibacter_gotjawalensis 11.54% passed 99.90% 57 Aquabacter_spiritensis 11.28% passed 100.00% 58 Azorhizobium_caulinodans 11.28% passed 100.00% 59 Xanthobacter_autotrophicus 12.44% passed 99.99% 60 Ancylobacter_aquaticus 11.28% passed 100.00% 61 Starkeya_novella 11.28% passed 100.00% 62 Blastochloris_viridis 11.28% passed 99.48% 63 Prosthecomicrobium_sp 11.22% passed 100.00% 64 Oharaeibacter_diazotrophicus 11.09% passed 99.91% 65 Pleomorphomonas_oryzae 11.15% passed 100.00% 66 Pleomorphomonas_diazotrophica 11.15% passed 100.00% 67 Pleomorphomonas_koreensis 11.15% passed 100.00% 68 Pseudoxanthobacter_soli 10.64% passed 99.90% 69 Amorphus_coralli 11.15% passed 99.99% 70 Kaistia_adipata 11.03% passed 99.99% 71 Bosea_thiooxidans 11.48% passed 100.00% 72 Salinarimonas_rosea 11.48% passed 99.85% 73 Enterovirga_rhinocerotis 11.48% passed 99.99% 74 Methylobacterium_organophilum 11.41% passed 99.86% 75 Methylobacterium_extorquens 11.28% passed 100.00% 76 Microvirga_subterranea 11.28% passed 99.99% 77 Rhodobium_orientis 11.03% passed 99.85% 78 Lutibaculum_baratangense 10.90% passed 99.96% 79 Tepidamorphus_gemmatus 10.90% passed 99.68% 80 Afifella_marina 10.77% passed 100.00% 81 Cohaesibacter_gelatinilyticus 11.03% passed 99.69% 82 Cucumibacter_marinus 10.83% passed 99.96% 83 Maritalea_myrionectae 10.77% passed 99.29% 84 Pelagibacterium_halotolerans 11.03% passed 99.90% 85 Arsenicitalea_aurantiaca 11.03% passed 99.95% 86 Devosia_riboflavina 11.22% passed 100.00% 87 Youhaiella_tibetensis 11.09% passed 99.06% 88 Parvibaculum_lavamentivorans 12.19% passed 99.93% 89 Tepidicaulis_marinus 12.25% passed 99.98% 90 Rhodoligotrophos_appendicifer 12.25% passed 98.44% 91 Liberibacter_crescens 10.96% failed 0.23% 92 Rhodomicrobium_vannielii 10.51% passed 99.31% 93 Dichotomicrobium_thermohalophilum 11.15% passed 99.91% 94 Hyphomicrobium_denitrificans 10.83% passed 99.32% 95 Meganema_perideroedes 11.99% passed 92.37% **** TOTAL 11.12% 1 sequences failed composition chi2 test (p-value<5%; df=19) Subset Type Seqs Sites Infor Invar Model Name DNA 128 1553 502 850 GTR+F+R5 part1 1551 684 697 LG+F+R8 part2 Degree of missing data: 0.129 Info: multi-threading strategy over partitions Killed: 9 ", "Hi Carmen, That\u2019s strange. Does it work without -mem option? Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ac5b3b54-3050-4e05-b80a-f2ba9d632fc3%40googlegroups.com ", "Hi Minh, It will not work even you go only with -p or -spp (no matter if use a partition file or alignments within a directory), but it works with the older versions of iqtree (1.6), It's only echoing this error in the 2.0 rc1 version, I haven't try rc2. David Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "I already tried Rc2 and the bug persist, I tried with the verbose option (-vvv) and the problem seems to be that it get stuck with ambiguous characters because is not recognizing the two partition sets type (DNA, AA), and it's literally showing (I already try different file formats, and ways to call it): Degree of missing data: 0.129 Info: multi-threading strategy over partitions Site 1552 contains only gaps or ambiguous characters Site 1161 contains only gaps or ambiguous characters Site 1552 contains only gaps or ambiguous characters Site 1161 contains only gaps or ambiguous characters Site 1552 contains only gaps or ambiguous characters Site 1161 contains only gaps or ambiguous characters Site 1552 contains only gaps or ambiguous characters Site 1161 contains only gaps or ambiguous characters Site 1552 contains only gaps or ambiguous characters Site 1161 contains only gaps or ambiguous characters Site 1552 contains only gaps or ambiguous characters Site 1161 contains only gaps or ambiguous characters Site 1552 contains only gaps or ambiguous characters Site 1161 contains only gaps or ambiguous characters Site 1552 contains only gaps or ambiguous characters Site 1161 contains only gaps or ambiguous characters Site 1552 contains only gaps or ambiguous characters Site 1161 contains only gaps or ambiguous characters Site 1552 contains only gaps or ambiguous characters Site 1161 contains only gaps or ambiguous characters Site 1552 contains only gaps or ambiguous characters Site 1161 contains only gaps or ambiguous characters Site 1552 contains only gaps or ambiguous characters Site 1161 contains only gaps or ambiguous characters Site 1552 contains only gaps or ambiguous characters Site 1161 contains only gaps or ambiguous characters Site 1552 contains only gaps or ambiguous characters And it continues repeating (110300 times) until it just finish with Site 1552 contains only gaps or ambiguous characters Site 1161 contains only gaps or ambiguous characters Site 1552 contains only gaps or ambiguous characters Site 1161 contains only gaps or ambiguous characters [4] Killed: 9 ~/Downloads/iqtree-2.0-rc1-MacOSX/bin/iqtree -v -p Rhizobiales_mix_16s_rpoBaa.txt Killed: 9 This is not happening in the previous versions (<2.0), I've only tested on mac versions so far. "]}, "t5bVI7WTDUE": {"topic": "iq-tree stuck at NNI search?", "initializeDate": "Dec 30, 2020, 10:35:02 AM", "timeStamp": "Jan 17, 2021, 11:43:38 PM", "content": ["Dear all, I am relatively new to iq-tree, but I am using it to generate a core genome tree on a 2Gb alignment. While the processe seem to be running, I realised the log file has not been updated for more than 24h and the last thing that was written to it was: -------------------------------------------------------------------- | INITIALIZING CANDIDATE TREE SET | -------------------------------------------------------------------- Generating 98 parsimony trees... 43764.190 second Computing log-likelihood of 98 initial trees ... 9739.769 seconds Current best score: -36991990.887 Do NNI search on 20 best initial trees Estimate model parameters (epsilon = 0.100) I am just wondering if this is normal behaviour or if it indicates that the process should be aborted? I am running this on a server, with the command: iqtree -s alignment.grp.aln -m GTR+F+I+G4 -B 1000 --wbtl -nt 18 While this takes 93Gb of RAM, this should not be a problem as we have 1Tb. I am running IQ-TREE multicore version 2.0.3 for Linux 64-bit built Dec 20 2020 Thanks for any help, Ricardo Ramiro ", "Hi Ricardo, Sorry for the long delay, I\u2019m back from a long break. I think IQ-TREE was still running on your BIG alignment. The last step NNI in your log is time consuming, esp. for larg dataset like this. You can try -fast option and see if that helps. This option invoke a much faster tree search, that resembles the behaviour of FastTree. If you say more what you want to do, incl. the command line, then we might be able to give some comments how to speed it up. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/205d9a25-dc7c-4d29-b435-e1d3a1a3ab17n%40googlegroups.com "]}, "1iATy9ZAVAo": {"topic": "how to get a NEXUS partition file", "initializeDate": "Jul 7, 2018, 10:36:34 AM", "timeStamp": "Jul 9, 2018, 11:43:16 AM", "content": ["Hi iqtree users : I was confused that how can I get a NEXUS partition file ? My data are mitochondrial protein-coding DNA, I had read the FAQ and manual careful, but I didn\u2019t understand how to get a partition scheme file? The partition file contains the site information and corresponding models like the example: #nexus begin sets; charset part1 = 1 -100 charset part2 = 101 -384 charpartition mine = HKY+G:part1 , GTR+I+G:part2 I had tried Partitionfinder2( PF2 ) t o calculate the partition scheme and corresponding models, in the PF2 the input file like this Gene1_pos1 = 1-1530\\3; Gene1_pos2 = 2-1530\\3; Gene1_pos3 = 3-1530\\3; Gene2_pos1 = 1531-2112\\3; Gene2_pos2 = 1532-2112\\3; Gene2_pos3 = 1533-2112\\3; in the PF2, I need to input the above file manually , and each gene has 3 sites departed, in the end, I will get some subsets, every subset contains the sites and the models. So if the partition file in iqtree also need to input manually ?or computed by the command lines? Thanks. ", "Hi there, PF2 should generate a best scheme file in nexus format, which is compatible with IQ-TREE. So why don\u2019t you use this file as input to IQ-TREE? Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thanks for your reply, I used the PF2 results into iqtree, and it runs successfully, but I got an unreliable result compared to the results from CIPRES(ML-tree), a clade has a very long branch, and contains ten species that belong to some different clades/taxon in real. The parematers as follows: iqtree -s XXXX.phy -spp XXXX.nex -bb 1000 And I also tried another method \u2014\u2014run every gene tree in iqtree used the command line: iqtree -s XXXX.phy -m MFP after that, I got the best fit model for every gene used BIC, and I write a NEXUS format file manually like this: #nexus begin sets; charset part1 = 1 -1530; charset part2 = 1531 -2112; charset part3 = 2113 -3114; ....... charpartition mine = TVMe+R3:part1 , K3Pu+F+R2:part2 ....... At last, I used : iqtree -s XXXX.phy -spp XXXX.nex -m MFP -bb 1000 I was very confused if I used a set of wrong parameters or if I had misunderstood these procedures. I look forward to your reply. Thanks. Yunxia \u5728 2018\u5e747\u67089\u65e5\u661f\u671f\u4e00 UTC+8\u4e0b\u53482:39:26\uff0cMinh Bui\u5199\u9053\uff1a "]}, "Nm2m0pe9JrY": {"topic": "Rs model?", "initializeDate": "May 26, 2015, 6:02:56 PM", "timeStamp": "May 29, 2015, 1:15:03 PM", "content": ["Hi, When evaluating the fit of a model, I consistently get the XX+R10+F model as best-fitted to my data. I don't seem to find a reference for the 'Rs' part, what does it refer to? Thanks for your help, Fabien ", "Dear Fabien, +Rk is the FreeRate heterogeneity model with k categories (Soubrier et al. 2012; MBE 29:3345-3358), which you typically get if using the new model selection procedure (-m TESTNEW option) just introduced in version 1.3. It generalizes and relaxes the discrete Gamma (+Gk) model, i.e. the site rates are inferred directly from the data without being drawn from a Gamma distribution. We have observed (with Lars Jermiin) that this +R model typically fits data much better than +G \u2014 there is no reason to believe that sequences were evolved under a \u201cGamma constraint\u201d. Hope that helps, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Hi Minh, Would iq-tree accept LG+R10+C60+F as a valid model? Fabien ", "Dear Fabien, YES it accepts such model! but carefully check memory usage at the beginning of the run\u2026 also you need a long protein alignment for the +C60 component and possibly many sequences for +R10 component, such that the model parameters can be estimated reliably. Cheers, Minh ", "Hi Minh, I have tried to start a job with LG+C60+R10+F and the memory requirement is ~2237Gb. Does that make sense? My alignment is 54000aa long and has 150 taxa. Thanks, Fabien ", "Hi Fabien, your data set is really overkilled now ;-) \u2026 this is indeed the right memory requirement for IQ-Tree, see also this thread https://groups.google.com/forum/#!topic/iqtree/WU8gbNiXvyM the bottom line is that there is some idea I am working on now to reduce memory consumption, but it is not trivial. An option might be available in the next few weeks and I will keep you posted Cheers, Minh "]}, "hbN1YPLDZ4c": {"topic": "\"Uniqueseq\"  alignment different from input", "initializeDate": "Dec 16, 2020, 10:39:05 AM", "timeStamp": "Jan 17, 2021, 8:29:42 PM", "content": ["Hi everyone, I have noticed something weird in the \" ...uniqueseq.phy \" alignment produced by IQ-TREE. Although the number of characters indicated in the heading of the phylip file is correct, the sequences seem to be different from the original ones used as input in the analysis. For example, a sequence that begins with \"?CGCCTCCCGCCCCA\" in the input file, begins with \"-------TCGCGTTG\" in the uniqueseq file. Another example, a sequence that begins with \"?CGCCTCCTGCAATA\" in the input file, begins with \"TCATTTTCCGCGTTG\" in the uniqueseq file. I know that the uniqueseq file is supposed to have a smaller number of taxa (as some of the identical ones are removed) but it should not make changes in the sequences, right? Any ideas of what is happening? ", "This might have something to do with it. Are you doing a partitioned analysis? https://github.com/Cibiv/IQ-TREE/issues/176 You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/22908adc-90d7-43b2-87b2-524d1ffce572n%40googlegroups.com ", "Yes, indeed! However, I am using IQ-tree v.1.6.12. ", "Hi Gabriel, Sorry for the long delay, I\u2019m back from a long break. Edward is right, that\u2019s the problem, but not a bug. Same behaviour for v1 or v2. Only with partition models will the uniqueseq file write the sites in the alignment in a different order compared to the original alignment. The reason why this is written in the github link below. Cheers Ninh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ef9bcf3f-d347-4b2b-9432-5b4ca7c6c968n%40googlegroups.com "]}, "5QlE_zAMWn8": {"topic": "Partition file format", "initializeDate": "Jan 20, 2021, 2:37:21 PM", "timeStamp": "Jan 27, 2021, 7:52:59 AM", "content": ["I am attempting to account for possible heterotachous evolution in my multiple sequence alignment by partitioning the data into the individual genes used to make up the superalignment. I having trouble correctly formatting a partition file in my analysis. I am attaching the two formats I have tried so far. The first file gives an error of \"File not found PROTEIN\" The second tweaked file gives an error of \"No partition found\" Here is the command I have used to run both attempts: $iqtree -s Super.alignment.cleaned.75trimal.fasta -m LG+F+I+R10 -bb 10000 -nt 22 -o Pyramimonas_parkeae -sp Partition.tweaked.txt ", "Hi there, Both of your partition files are not in the right format. Please have a look here: http://www.iqtree.org/doc/Complex-Models#partition-models Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f6a6bbe0-fdcc-4838-a196-f81409146387n%40googlegroups.com "]}, "lhNR2bDVDSI": {"topic": "Contradiction for Modelfinder between iqtree1 and iqtree2", "initializeDate": "Mar 7, 2021, 10:58:34 PM", "timeStamp": "Mar 9, 2021, 6:05:21 PM", "content": ["Hi Minh, My question is the contradiction for Modelfinder between iqtree1 ad iqtree2. I have used iqtree v1.6.10 and iqtree v2.1.2 to constrcut the phylogeentic tree for the same file. The best chosen model was LG+R10 for iqtree v1.6.10, but the best chosen model was LG+R9 for iqtree v2.1.2. I have pasted the two log files and could you help me with the best model choice? Furthermore, iqtree v2.1.2 tested 546 models but the correponding log file only showed 54 models. I am not sure if it was a problem for iqtree v2.1.2. I am willing to get your help. If you could help me, I really appreciate. Best, Yuan ", "Hi Yuan, IQ-TREE 2 uses a heuristic to avoid non-promissing models and speed up model selection. So the result might be slightly different from IQ-TREE 1. We believe that such small different in the models does not matter for the tree inference. See a couple of recent literature about this: https://www.nature.com/articles/s41467-019-08822-w https://doi.org/10.1093/molbev/msaa075 And the benefit is clear. The runtime from your iqtree1 log file: Wall-clock time for ModelFinder: 175412.741 seconds (48h:43m:32s) And the iqtree2 log file: Wall-clock time for ModelFinder: 9153.125 seconds (2h:32m:33s) That means, 20-fold speedup. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e82ea9d0-40f2-4ccf-9408-6d5a9c11d4aan%40googlegroups.com <16rp.concatenated.phy-iqtree v1.6.10.log> <16rp.concatenated.phy-iqtree v2.1.2.log> "]}, "1NQITELXQeU": {"topic": "constraint option (-g)", "initializeDate": "Oct 23, 2016, 10:06:55 PM", "timeStamp": "Oct 31, 2016, 6:48:17 AM", "content": ["Hi IQ-TREE development team, Thanks of releasing new option (-g) in the new version (IQ-TREE-1.5.0-beta)! After conducting tree search under a given constraint topology for my small data, I found that the resulting ML tree is topologically identical to the ML tree without any constraints. Is there anything I missed? Thanks, Xingxing Shen Command line: /gpfs21/scratch/shenx3/tools/IQ-TREE-1.5.0-beta/build/iqtree-omp -nt 6 -st AA -s Pro_ENSG00000119431.fasta -m LG+F+G -g Constraint.tre -pre constraint ", "Dear Xingxing, thanks for the report. This bug was fixed in the official version 1.5.0, which will be announced shortly. Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout > <test.zip> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "\u5728 2016\u5e7410\u670824\u65e5\u661f\u671f\u4e00 UTC-5\u4e0a\u53482:03:10\uff0cBui Quang Minh\u5199\u9053\uff1a Dear Dr. Minh, Thanks for letting me know the official version 1.5.0! After testing many cases for the new option (-g) in this version 1.5.0, I found that \u201c-g\u201d function sometime crashed in the INITIALIZING CANDIDATE TREE SET step under site-heterologous model (e.g., C60) but can work under site-homologous model for the same constraint topology and the same data matrix. Could you help me figure out it? Thanks, Xingxing PS: since the data matrix I tested is little big, I put them on the dropbox ( https://www.dropbox.com/sh/9f6838u0g2g95m9/AABe_uHIpvLH_w4TWnc6K_NUa?dl=0 ", "Dear Xingxing, thanks for extensive testing! I will have a look asap. Moreover, just a hint: if you want to keep your data confidential, send me the link/data via my personal email. Keep in mind that other people will see your email as well. Cheers, Minh ", "Dear Xingxing, this bug is now fixed in version 1.5.0a: \u2022 A bug when computing initial constrained trees (-g option) and recovering from checkpoint (thanks to Xingxing Shen for the report). It can be downloaded from http://www.iqtree.org Cheers, Minh "]}, "bb9gkCQjXa4": {"topic": "RY-coded, Degen-coded and Site Likelihoods", "initializeDate": "Mar 20, 2018, 6:22:58 PM", "timeStamp": "Mar 20, 2018, 11:35:12 PM", "content": ["Dear Bui Quang Minh, I have been trying IQ-TREE and if possible I would like to have some confirmation for the following 2 questions: 1) Does IQ-TREE work well in reconstructing phylogeny with RY-coded (3rd position) alignments and with degen-coded alignments ( http://www.phylotools.com/ptdegendocumentation.htm I am trying both approaches with the following simple command: iqtree -s infile.fas -st DNA -m TEST I have tested both and I got no error from IQ-TREE v.1.6.2, but I am not sure if the desired result is obtained. Will it work also if TEST is replaced with MFP? 2) I suspect that while obtaining the site likelihoods (-wsl) whether in standard bootstraps and/or UFboots (using the same data) the resulting values are very close if not the same, is this correct? Thanks for your attention. Best regards. Emanuel Maldonado, CIIMAR, University of Porto. ", "Hi Emanuel, On 21 Mar 2018, at 9:22 am, Emanuel < eman.ma...@gmail.com > wrote: Dear Bui Quang Minh, I have been trying IQ-TREE and if possible I would like to have some confirmation for the following 2 questions: 1) Does IQ-TREE work well in reconstructing phylogeny with RY-coded (3rd position) alignments and with degen-coded alignments ( http://www.phylotools.com/ptdegendocumentation.htm I would say Yes, IQ-TREE should work with degen-coded alignments as I don\u2019t see any problem with such recoding. Also have a look at the FAQ how IQ-TREE treats ambiguous characters: http://www.iqtree.org/doc/Frequently-Asked-Questions#how-does-iq-tree-treat-gapmissingambiguous-characters I am trying both approaches with the following simple command: iqtree -s infile.fas -st DNA -m TEST I have tested both and I got no error from IQ-TREE v.1.6.2, but I am not sure if the desired result is obtained. Will it work also if TEST is replaced with MFP? Yes, this simple command should do the job. 2) I suspect that while obtaining the site likelihoods (-wsl) whether in standard bootstraps and/or UFboots (using the same data) the resulting values are very close if not the same, is this correct? No, the site log-likelihoods are not the same between the recoded and original alignments. For example, if your alignment has 4 sequences and a site show: AACR (A at seq1,\u2026, R at seq4), then the likelihood L(AACR) = L(AACA) + L(AACG), because R=A or G. Hope that helps, Minh Thanks for your attention. Best regards. Emanuel Maldonado, CIIMAR, University of Porto. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "QVP9QLuXhYQ": {"topic": "Model selection: number of parameters and testing PMSF models", "initializeDate": "Feb 6, 2017, 12:33:03 PM", "timeStamp": "Feb 8, 2017, 2:31:28 PM", "content": ["Dear all, I recently started to use IQ-TREE and I am really excited with the million of options and yet easy use. Congrats and thanks! I have two questions regarding model testing: 1. Is it possible to test the fit of PMSF against let's say LG? The following command gave me this error: iqtree-omp -s infile.fa -pre modeltest.out -ft guidetree.tre -m TESTNEWONLY -mset LG -madd LG+C10+G,LG+PMSF+G error: ERROR: Invalid model name TESTNEWONLY Command exited with non-zero status 2 0.09user 0.00system 0:00.09elapsed 96%CPU (0avgtext+0avgdata 8420maxresident)k 0inputs+24outputs (0major+1331minor)pagefaults 0swaps 2. What is the meaning of the degrees of freedom \"df\" in the output of model testing? In my understanding, df would correspond to the number of free parameters being estimated from the data. However, the numbers in \"df\" do not seem to correspond to that. For example, both LG+C20+G and LG+C60+G have df=110 and yet they should have a different of 40 free parameters corresponding to 40 additional frequency profiles. Is there something I am missing here? Thank you very much for your help in advance!! Best wishes, Iker ", "Dear Iker, Thanks for your kind words. Detailed answers are below: On Feb 6, 2017, at 6:33 PM, Iker Irisarri < irisar...@gmail.com > wrote: Dear all, I recently started to use IQ-TREE and I am really excited with the million of options and yet easy use. Congrats and thanks! I have two questions regarding model testing: 1. Is it possible to test the fit of PMSF against let's say LG? The following command gave me this error: iqtree-omp -s infile.fa -pre modeltest.out -ft guidetree.tre -m TESTNEWONLY -mset LG -madd LG+C10+G,LG+PMSF+G error: ERROR: Invalid model name TESTNEWONLY Command exited with non-zero status 2 0.09user 0.00system 0:00.09elapsed 96%CPU (0avgtext+0avgdata 8420maxresident)k 0inputs+24outputs (0major+1331minor)pagefaults 0swaps No this is not supported. Model testing does not work with PMSF because it is solely an approximation technique for a mixture model. Thus you can do the following steps: 1. Find the best model (incl. mixture models) e.g: iqtree-omp -s infile.fa -pre modeltest.out -m TESTNEWONLY -mset LG -madd LG+C10+G,LG+C20+G,LG+C30+G (you are add more models up to C60 with -madd option. Note that guide tree is not needed here). 2. Assuming that LG+C20+G best fits the data. Then run this: iqtree-omp -s infile.fa -pre normalrun.out -ft guidetree.tre -m LG+C20+G 2. What is the meaning of the degrees of freedom \"df\" in the output of model testing? In my understanding, df would correspond to the number of free parameters being estimated from the data. However, the numbers in \"df\" do not seem to correspond to that. For example, both LG+C20+G and LG+C60+G have df=110 and yet they should have a different of 40 free parameters corresponding to 40 additional frequency profiles. Is there something I am missing here? The way you understand df is correct. C10 to C60 as defined in Le et al., 2008a not only have pre-defined AA frequencies but also pre-defined mixture weights. Thus they are not estimated from the current data and that\u2019s why LG+C20+G and LG+C60+G have the same df. What you can do is to add \u201c-mwopt\u201d option to tell IQ-TREE to estimate mixture weights. Then you will see that LG+60+G has 40 more degree of freedom than LG+C20+G. Moreover, I would suggest that you also test models LG+C20+F+G and LG+C60+F+G, which add a mixture component corresponding to the AA frequencies estimated from the data. It typically gives a better fit - the BIC or AIC should tell you if that\u2019s the case or not. Hope that helps, Minh Thank you very much for your help in advance!! Best wishes, Iker You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "ZDo-Qgop7fI": {"topic": "Mutation rate along branches", "initializeDate": "Dec 21, 2020, 4:04:16 AM", "timeStamp": "Jan 18, 2021, 6:55:22 PM", "content": ["Hello to the whole Iqtree community, I'm writing this post because I had two questions. For an analysis I have 300 housekeeping genes in 10 species, I would like to estimate from these 300 genes the mutation rates of the branches of 3 of these 10 species. Indeed in the example below I need to calculate the mutation rate of the branches of the sub-tree SP4,SP5,SP6 (noted \u00b51-\u00b54). The idea is then to retrieve the sum of \u00b5 for each of the 300 housekeeping genes and then use these values to construct a distribution of \u00b5 expected under the null hypothesis of the mutation rate expected since the last common ancestor of SP4,SP5 and SP6. Here is an idea of representation: So I wondered if (i) iQtree can give the mutationrate for each branch of a phylogenetic tree, and if yes how to do it ? and (ii) should I use a codon alignement or a AA alignment should be fine ? Thanks a lot and have a great Christmas Holiday ! ", "Hi Chippy, Sorry for the long delay, I\u2019m back from a long break. Answers embeded below: On 21 Dec 2020, at 8:04 pm, chippy centra < chippy...@gmail.com > wrote: Hello to the whole Iqtree community, I'm writing this post because I had two questions. For an analysis I have 300 housekeeping genes in 10 species, I would like to estimate from these 300 genes the mutation rates of the branches of 3 of these 10 species. Indeed in the example below I need to calculate the mutation rate of the branches of the sub-tree SP4,SP5,SP6 (noted \u00b51-\u00b54). The idea is then to retrieve the sum of \u00b5 for each of the 300 housekeeping genes and then use these values to construct a distribution of \u00b5 expected under the null hypothesis of the mutation rate expected since the last common ancestor of SP4,SP5 and SP6. Here is an idea of representation: <Capture d\u2019e\u0301cran 2020-12-21 a\u0300 09.55.17.png> So I wondered if (i) iQtree can give the mutationrate for each branch of a phylogenetic tree, and if yes how to do it ? To be sure: Do you mean mu as the number of mutations per site per unit time (like year)? If that is the case, IQ-TREE is not able to estimate the mutation rate. It and other ML software will estimate the number of substitutions per site, which are actually the branch lengths. To estimate the rate you will need the time information like tip dates or fossil records. Then you can use the dating feature recently introduced in IQ-TREE 2 ( http://www.iqtree.org/doc/Dating ), powered by the least square dating. It can estimate the date of internal nodes. I believe the rates per branch are output by LSD2, but better confirm with Hien, CC here. and (ii) should I use a codon alignement or a AA alignment should be fine ? Either codon or AA is fine. You can use the --modelomatic option in IQ-TREE 2, that can tell you whether a DNA, codon, or AA models are better. But I think with just 10 species, a codon model might be overfitting. Cheers Minh Thanks a lot and have a great Christmas Holiday ! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6103309f-8023-46da-a60c-126fc773faa3n%40googlegroups.com "]}, "diz11CpSLfg": {"topic": "IQTREE crashes when merging partitions", "initializeDate": "Mar 5, 2018, 5:46:18 AM", "timeStamp": "Mar 11, 2018, 4:08:18 AM", "content": ["Hi, I'm running the following analysis (and a bigger one with the same setting): iqtree -s FcC_smatrix.fas -bb 1000 -nt 6 -m MFP+MERGE -spp partition.nex the run suddenly crashes when the partition merging starts, without any specific error in the log file: ... 2013 K2P+R5 4722178.825 part4+part29 132h:21m:24s (124h:31m:56s left) 2014 GTR+F+R6 4722156.421 part21+part62 132h:21m:24s (124h:24m:17s left) 2015 TVMe+I+G4 4722190.039 part21+part27 132h:21m:26s (124h:16m:40s left) 2016 TIM3e+I+G4 4722150.849 part21+part29 132h:21m:53s (124h:9m:27s left) Merging part18+part52 with BIC score: 4721806.015 (LnL: -2352425.887 df: 1638) ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: partition.nex.log ERROR: *** Alignment files (if possible) I red a similar question here in the group but still with no answer, I tried to restart the run using models checkpoint archive but I got the same error in few second when the merging starts... thanks for your help! Claudio ", "in the linux shell I got also this after the error reported in the logfile: Segmentation fault (core dumped) ", "Hi Claudio, Did you use the latest version 1.6.2? There was a bug in v1.6.1 with multi-threading safety during partition merging. It was fixed in v1.6.2. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi, Claudio may be you need to compile your IQTREE using cmake and with Eigen3 (install it first), and when the installation is successfully finished, the new IQTREE can manage the \"-m MF+MERGE\"-flagged command best wishes, Liang "]}, "n0v0r6sJ-R8": {"topic": "Bootstrap values consensus tree [IQ-TREE 1.6.3]", "initializeDate": "Jul 2, 2020, 6:35:41 AM", "timeStamp": "Jul 4, 2020, 9:46:13 AM", "content": ["Hi! I was wondering what the bootstrap values on the consensus tree represent? Are they UFBoot values calculated anew for the consensus tree or are they somehow based on the trees that make up the consensus? My command: $ iqtree -nt AUTO -s seqs.msa -pre seqs.IQ-TREE -m MFP -msub nuclear -alrt 1000 -bb 1000 -nm 10000 -seed 12345 $ iqtree --version IQ-TREE multicore version 1.6.3 for Linux 64-bit built Mar 22 2018 Looking forward to your reply, thanks in advance for the help! Best wishes, Bastiaan ", "Hi, the support in consensus tree is based on the trees it was reconstructed from, i.e. how many trees have the same split/clade. In case, the consensus tree was build from the bootstrap trees, the support is not the result of an additional bootstrap run, but rather the support based on these bootstrap trees. But just to be sure, check .iqtree and .log files, maybe it is mentioned there. Cheers, Olga You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/d2b0731a-1ed0-451c-a3bd-8a4732a65388o%40googlegroups.com ", "Olga is right \u2014 the supports on the consensus treee are from the UFBoot, not the SH-aLRT. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/49ECA864-885A-458C-AA30-6AFC5DB27083%40gmail.com ", "Hi Olga and Minh, Thanks for your help, it's clear now! Best wishes, Bastiaan Op za 4 jul. 2020 om 00:58 schreef Minh Bui < minh...@univie.ac.at To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/94B44193-DFCF-4517-96FC-64CBF2345E6A%40univie.ac.at "]}, "VJTpns0e-9Q": {"topic": "Crash on large dataset: error message WARNING: Numerical underflow for site 468", "initializeDate": "May 18, 2016, 9:39:24 AM", "timeStamp": "Nov 9, 2016, 5:07:02 AM", "content": ["Dear Minh, I have tried to run IQ-TREE on a large dataset of short sequences(4878 seq) with aLRT and UF-Boostrap, and the program crashed after in the process of computing bootstrap consensus tree. Was I pushing my luck on trying this type of analysis with IQ-TREE? Command line that i passed: iqtree-omp -s ClO_0000_20160415_4878-seq.fas -m TEST -alrt 1000 -bb 1000 -nt 10. I tried to bring down aLRT and bb to 100 just for trial but it was 1000 minimum for each. Just to let you know the computer used has 128 gigs of RAM and 20 cpu cores. Thank you Best Benjamin ", "Dear Benjamin, Unfortunately this is a fundamental numerical issue for ML inference in general using +G model with many sequences. We are working to solve this problem. Did you have luck with other software e.g. RAxML? Moreover, for such short alignments I would not recommend to use that many core (-nt 10), because the parallel efficiency only increases with long alignments. I recommend to only use 2 or 3 cores for you data. Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout > <ClO_0000_20160415_4878-seq.fas.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Sorry for the delayed response I was doing more testing on this, and it seems that this problem only occurs (in my case) with ultrafast Bootstrap. Has I have done aLRT, Local Bootstrap prob and even non parametric bootstrap on this dataset without any problems...although 100 bootstraps took a week :) Pretty sure this is normal. Thanks for the information and I will probably go and try ultrafast bootstrap in RaxML in a near futur. Best Benjamin ", "Hi Benjamin, then can you pls still send me the data and this corresponding log file via personal email? Maybe the reason could be not what I thought. So just want to be sure. Thanks, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout ", "Dear Benjamin, this long-standing numerical issue for data set with many sequences is now fixed in version 1.5.1. Cheers, Minh "]}, "WU8gbNiXvyM": {"topic": "Mixture model implementation", "initializeDate": "May 18, 2015, 9:12:21 PM", "timeStamp": "Feb 17, 2021, 9:18:21 AM", "content": ["HI Minh, I am very excited to see that IQ-tree has implemented C60 etc mixture models! I recently tried LG+C60+G4 versus LG+G4 under IQ-1.2.3. I noticed that lnL's are very similar between the two, which was suspect to me as I would expect the lnL for LG+C60+G4 to have a better lnL. I also noticed that in the log file the number of free parameters for LG+G4 was 146 and that this is the same for LG+C60+G4. I have 74 taxa, so, (2x74)-3=145 branch lengths + 1 for the alpha parameter ==> 146. I would expect that with LG+C60+G4 would be 146 + 59 (for the C60 Mixture model [these are the weights for the 60 classes (60 weights minus 1 because the last weight is 1-(all the others)]) ==> 205 free parameters. I am wondering if there may be a bug in the implementation of the c-series mixture models or a bug in the code. Do you have any idea? Thank you, Matt Brown Log Files: IQ-Tree Non-Partitioned : LG+G4 Log-likelihood of the tree: -5805899.8515 (s.e. 13390.6396) Number of free parameters: 146 Akaike information criterion (AIC) score: 11612091.7030 Corrected Akaike information criterion (AICc) score: 11612092.1549 Bayesian information criterion (BIC) score: 11613473.3025 Unconstrained log-likelihood (without tree): -1084836.7826 IQ-Tree Non-Partitioned : LG+C60+G4 Log-likelihood of the tree: -5805899.8645 (s.e. 13390.7095) Number of free parameters: 146 Akaike information criterion (AIC) score: 11612091.7291 Corrected Akaike information criterion (AICc) score: 11612092.1810 Bayesian information criterion (BIC) score: 11613473.3286 Unconstrained log-likelihood (without tree): -1084836.7826 ", "Dear Matt Brown, thanks for trying it out! Can you paste the command line that you used? C60 model has 60 components, each is a Poisson model with unequal amino acid frequencies plus a Gamma rate heterogeneity. So I am not sure what is LG+C60\u2026 If you specify \u201c-m C60\u201d, the mixture weights are fixed by the model. Instead, if you want to optimize the weights, then add an option \u201c-mwopt\u201d into the command line. I saw that this option is not listed in the help usage, will add in the next release. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "Thanks for the reply Minh! I must have put the command in wrong. I am trying to use both the LG matrix and C60 mixture model. is this possible with IQ-tree? iqtree-omp -omp 20 -s Bordor.351.74.12-18-2014.dat -m LG+G -bb 1000 iqtree-omp -omp 20 -s Bordor.351.74.12-18-2014.dat -m LG+C60+G -bb 1000 ", "Dear Matt, in your 2nd command IQ-Tree will understand the model as LG+G (omitting +C60) because there is no LG+C60 model. The correct one is: iqtree-omp -omp 20 -s Bordor.351.74.12-18-2014.dat -m C60 -bb 1000 (C60 already includes +G; you will see in the log file that C60 is alias for POISSON+G4+FMIX{\u2026.} ) If you further want to optimize the mixture weights then: iqtree-omp -omp 20 -s Bordor.351.74.12-18-2014.dat -m C60 -bb 1000 -mwopt However, if you really want to use the LG matrix for C60 instead of POISSON, then the only way right now is: -m \u201cLG+G4+FMIX{\u2026.}\u201d (i.e. copy the whole alias and change POISSON to LG; and don\u2019t forget the double quote). However, I am not sure whether this is the right model to use and such model was not described in the literature (to my knowledge). Cheers, Minh ", "HI Minh, The LG+C20 model is described in http://www.ncbi.nlm.nih.gov/pubmed/24441033 From that paper \"The rate matrix for a site having one component in the cF4, cF9, or cF20 profiles is obtained from an empirical rate matrix, Q, using the usual adjustment, via exchangeabilities. The only change is that the role of the data set frequencies is now played by the set of profiles of interest in cF4 (or cF9 and cF20). All models also include an F class, which uses the data set frequencies. So, for instance, cF4 has five classes, one F class for the overall frequencies and four for the cF frequencies. We refer to the model that obtains rate matrices for the F and cF classes, via the usual adjustment to the exchangeabilities, as the cF4 (or, respectively, cF9 and cF20) model.\" The exchangeabilities are from LG and they used cseries mixtures. They did not do C60 because it was too slow in their implentation (QmmRAxML). My understanding is that the cF20 model in that paper is LG+G4+F+C20. So the LG q matrix with cseries mixture, plus one more general 'F' class in the mixture, so it is the C20 classes plus an F class. For implementing this LG+C60+G+F how would I try this? -m \u201cLG+G4+FMIX{\u2026.}\u201d, what do I put in the ... for this? Thank you, Matt ", "Hi Minh, I tried several options with mixtures, but there are RAM requirement issues. -m \u201cLG+G4+FMIX{c60 alias}\u201d ==> 722GB of RAM -m C60 ==> 722GB of RAM -m \u201cLG+G4+FMIX{c10 alias}\u201d ==> 125GB of RAM -m C10 ==> 125GB of RAM My cluster has 20threads but only 62GB of RAM so these will not run. I'm wondering if there is some mistake in the code and too much RAM is being allocated for mixtures. Bare in mind that my dataset is 100000AA sites 74 taxa. Best, Matt ", "Dear Matt, the memory requirement for mixture model is (in bytes): (3n-6) * m * s * c * k * sizeof(double) where n = number of taxa m = number of distinct site patterns (< alignment length) s = number of states (20 for AA) c = number of rate categories (4 for +G4) k = number of mixture components (60 to C60) I don\u2019t know how many site patterns (m) you have, but since m < 100000, the RAM required for your data is < 772 GB. I have a machine here with 512 GB; thus I could offer to analyze your data up to C30 or C40. What do you think? And finally thanks for the citation, I was not aware of this complex model. I will think about supporting such model directly without having to use such a long -m option. Cheers, Minh ", "Hi Minh, Really happy that you've implemented these models! I'm hoping it will be feasible to actually do bootstrapped analyses of such large data sets (such as the one Matt is talking about) in reasonable times. One thing that might work to speed things up (and lower RAM usage) would be to estimation under the various classes for each site with a starting tree (NJ or whatever you are using for IQTREE) to estimate the likelihoods of each of the classes for every site and optimize the weights. Then you could, as an approximation, only use the top 2-3 classes in terms of posterior probability for a given site and do tree searching with this instead of evaluating the full mixture for every tree. My guess is that the top 2-3 classes collectively comprise >0.99 of the posterior probability distribution over the classes for the site and so failing to evaluate the likelihood of the remaining ones for that site will make almost no difference to tree selection and could lead to substantial speed up. You could do something even riskier than this and only evaluate the class with the highest posterior probability for the site during the tree searching...I wonder if it would matter too much. In theory this is not the 'right' way to do things, I realize, however I suspect that evaluating only the top 3 classes will pretty much capture all you need from the mixture. In fact, I suspect this is exactly what happens under Bayesian inference with Phylobayes using the C10-C60 models because the mixture is only being approximated over the MCMC generations (not every generation) and it is practically impossible for MCMC to properly evaluate the mixture for every site with this many classes unless you did an infeasible number of MCMC generations. This is just an idea about how to speed up these large mixture models using an approximation. Cheers Andrew Roger ", "Dear Andrew Roger, thanks for sharing the ideas. Actually Arndt and I had similar thoughts, that quite possibly only a few mixture components will contribute to the likelihoods; the rest can be safely ignored. I will go further into that direction, such that the complex mixture models will be computationally feasible. The version 1.3.0 I just released accepts now mixture models like LG+C60 or LG+C60+F (empirical frequencies is added to the mixture as an extra component) or JTT+CF4+G. Cheers, Minh ", "Dear Minh, Thanks for adding these models, I am running LG+c10+F and LG+c20+F it by putting the entire mixture model as suggested. I am only able to run up to c30 as the RAM constraints. We have a 512GB node, but it is a little difficult to get ahold of for a long period. At the moment I have it running, I looks like ML + 1000 ultrafast BSreps will complete in a total of ~86hr for c10 and ~132hr for c20 (each 8 threads at 132GB and 250GB RAM, respectively). I look forward to seeing any sort of speed ups and RAM short cuts in the future as Andrew mentioned! THank you for your help with this. All the best, Matt ", "Dear Minh, That is great! I look forward to seeing the result of your investigations. BTW, our experience is that the LG+C20 (or C60)+F mixture fits large data sets MUCH better than LG+C60 or Poisson+C60 (we have done these evaluations using QMMRAxML...but its slower than IQTREE). Ideally it would be good to estimate an empirical exchangeability matrix for use with C-series mixtures...LG was never optimized for this use as you know. Cheers Andrew Roger ", "Dear Matt, We have just released new version 1.3.2 that reduces RAM requirement by a factor of 3 (e.g. from 600 GB down to 200 GB) using another technique. So it should be possible to analyze your data with C60 model now. Please have a try. Cheers, Minh ", "Hi Minh! Is there an updated version of this formula to estimate upfront the optimal RAM requirement for a given dataset? Many thanks, Laura ", "Hi Laura, Someone asked the same question but I couldn\u2019t find it anymore. Nevertheless, in the latest version of IQ-TREE, there are now two modes: full memory and memory-saving mode. In the full mode, the formula is for the RAM requirement in Bytes is: 8 x number_of_sequences x number_of_distinct_site_patterns x number_of_states x number_of_rate_categories x number_of_mixture_classes * Number of distinct site patterns is normally smaller than the number of sites in the alignment, when some sites appear repeatedly in the alignment (esp. constant sites). * Number of states is 4 for DNA, 20 for protein, 61 for codon models. * Number of rate categories is for 4 for the Gamma model +G4 or the free-rate model +R4. But can also be higher, say, 5 if you used +R5 model. * Number of mixture classes is 10 if using +C10 model, 20 for +C20 model, etc. In the memory saving mode, IQ-TREE can automatically reduce the RAM usage if the full requirrement exceeds 95% * the RAM size. This technique was described in this paper: https://cme.h-its.org/exelixis/pubs/Exelixis-RRDR-2011-8.pdf . In theory, you can replace number_of_sequences in this formula with log2(number_of_sequences)+2. This is a lot of reduction for large number of sequences. But there is a trade-off between run time and RAM requirement. What you can do is to use -mem option. For example, -mem 100G will make sure that IQ-TREE won\u2019t use more than 100GB RAM. You can also do something like -mem 0.5, meaning that IQ-TREE will use half memory of the full mode. In my own experience, 50% memory saving will make IQ-TREE run 10% to 20% slower. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/680509d6-e720-4ab2-a1be-436416b2dea6n%40googlegroups.com ", "Thank you so much, Minh, this is very helpful!! Best, Laura "]}, "cqPfsCq2Z58": {"topic": "Re: iqtree - Google Groups: Message Pending [{IOrFyaCYpI-PYCoCaWcwACe6etC6XDac0}]", "initializeDate": "Feb 27, 2015, 3:39:38 PM", "timeStamp": "Feb 27, 2015, 3:39:38 PM", "content": ["Dear Karen, I am not sure why your email was not posted in the group. However yes IQ-tree supports FreeRate model with, for example, \"-m GTR+R\" instead of \"-m GTR+G\". The default is 4 rate categories. But you can change with e.g. \"-m GTR+R5\". Cheers, Minh On Fri, Oct 31, 2014 at 10:37 AM, IQTREE iqtree+...@googlegroups.com wrote: A message has been sent to the iqtree group and is awaiting approval. We've included this message for your review. The message requires moderation because the user does not have permission to post. You can approve or reject this message or you can approve this message by replying to this email. Start your own group, visit the help center, or report abuse. ---------- Forwarded message ---------- From: kmeus...@googlemail.com To: iqt...@googlegroups.com Cc: Date: Fri, 31 Oct 2014 02:37:02 -0700 (PDT) Subject: FreeRate model Dear IQtree team, would it be possible to implement the FreeRate model into IQtree (it's currently only implemented in PhyML as far as I know (see MBE 2012 for a reference)... many thanks Karen "]}, "mvJMIRDgNcs": {"topic": "How to input mixed morphological and protein data", "initializeDate": "Jul 6, 2020, 12:19:39 AM", "timeStamp": "Jul 9, 2020, 2:24:47 AM", "content": ["I follow the suggestion: each data type should be stored in a separate alignment file. There are two file: Diplopoda10m.phy contains morphological data and Di90two.phy contains 90 gene amino acid. Both of they have been input into IQ-tree to test. They are works. Diplopoda10m.phy need to add -st MORPH, Otherwise will be regarded as binary data by software. I enter: bin\\iqtree2 -s Diplopoda10m.phy -st MORPH \u2013s Di90two.phy -st protein \u2013p morph_aa_LG.nex -o Pauropus_h --date datednew.txt --date-tip 0 But it do not work I attached to log and nex file here. ", "Hi there, This is not the valid command line, having two -s options, the second one will override the first one. Since you have already specified the alignment file names in the partition file, no need to use -s option. So the command line is something like: bin\\iqtree2 -p morph_aa_LG.nex -o Pauropus_h --date datednew.txt --date-tip 0 However, your partition file has \u201cmv\u201d for part1 model name, which is invalid. So something like: #nexus begin sets; charset part1 = Diplopoda10m.phy: *; charset part2 = Di90two.phy: *; charpartition mine = MK+G:part1, LG+C20+R4:part2; end; Or you can replace MK+G with the best-fit model for part1 (which can be done in a separate analysis). Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/04d86825-7c72-42fe-bfad-89974d4f6bfao%40googlegroups.com <morph_aa_LG.nex> <morph_aa_LG.nex.log> ", "Thank you very much I revised the nex file and the command as your suggestion. It works! Sorry for so much mistake in my materials. \u5728 2020\u5e747\u67089\u65e5\u661f\u671f\u56db UTC+8\u4e0a\u53487:52:07\uff0cMinh Bui\u5199\u9053\uff1a Hi there, This is not the valid command line, having two -s options, the second one will override the first one. Since you have already specified the alignment file names in the partition file, no need to use -s option. So the command line is something like: bin\\iqtree2 -p morph_aa_LG.nex -o Pauropus_h --date datednew.txt --date-tip 0 However, your partition file has \u201cmv\u201d for part1 model name, which is invalid. So something like: #nexus begin sets; charset part1 = Diplopoda10m.phy: *; charset part2 = Di90two.phy: *; charpartition mine = MK+G:part1, LG+C20+R4:part2; end; Or you can replace MK+G with the best-fit model for part1 (which can be done in a separate analysis). Minh On 6 Jul 2020, at 2:19 pm, YanYan < lil...@163.com > wrote: I follow the suggestion: each data type should be stored in a separate alignment file. There are two file: Diplopoda10m.phy contains morphological data and Di90two.phy contains 90 gene amino acid. Both of they have been input into IQ-tree to test. They are works. Diplopoda10m.phy need to add -st MORPH, Otherwise will be regarded as binary data by software. I enter: bin\\iqtree2 -s Diplopoda10m.phy -st MORPH \u2013s Di90two.phy -st protein \u2013p morph_aa_LG.nex -o Pauropus_h --date datednew.txt --date-tip 0 But it do not work I attached to log and nex file here. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "0M_KQmOxehA": {"topic": "why two nodes coexist with variable substitution matrix", "initializeDate": "May 20, 2020, 8:07:07 AM", "timeStamp": "May 22, 2020, 2:19:40 AM", "content": ["For a given MSA file, I have used basic amino acid substitution model like (JTT, VT, WAG, LG), Mixture model (LG4M, LG4X),Mixture model combination with a profile mixture model (LG+FO+I+G,GTR20+I+G, LG4X+I+G) and complex model (GTR20+F+H4,LG4M+R5+H4, LG4X+I+G+H4). Interestingly what i have observed, two organisms like A and B are always coexist. So my doubt is : 1. is it some kind of artifact? 2. I am doing something terribly wrong? suggestions are highly needed. syntax: iqtree2.exe -s LG4X.aln -m LG4X -bb 1000 - alrt 1000 - abayes iqtree2.exe -s GTR_I_G.aln -m GTR20+I+G -bb 1000 - alrt 1000 - abayes qtree2.exe -s WAG.aln -m WAG -bb 1000 - alrt 1000 - optlen BFGS iqtree2.exe -s LG4M_H4.aln -m LG4M+R5+H4 -bb 1000 - alrt 1000 - optlen BFGS ", "Dear Raghvendra Singh, Thank you for your interest. Unfortunately, it gets not quite clear what your problem is. What exactly do you mean by \u201ctwo organisms like A and B are always coexist\u201d? Just from the sentence I would say, if the sequences of two organisms are present in the alignment, they both have also to exist in the tree\u2026 \u2026but I cannot imagine that this is the co-existence you refer to ;) Could you please be more detailed describing your problem, maybe also using some explicit examples? Best regards, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/a364f8e4-87f0-4547-916f-0b1b81c1cee9%40googlegroups.com ----------------------------------------------------------------------------- Heiko Schmidt Vienna, Austria ----------------------------------------------------------------------------- ", "Dear Schmidt, Thank you for your quick response. What I meant is: in attached presentation1.pdf . Irrespective of substitution matrix (is i mentioned previously) what i found is A and B always come at the same place with >70 of boot strap value (please look at image). So My question is am i doing something wrong with program or what? Thank you To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/D8C4D91A-9485-43E8-8E3E-050528548143%40univie.ac.at ------------------------------------------------------------------------------------------------------ Raghvendra Singh D.Phil. SERB-National Post-Doc Fellow C/o Dr. R Sankaranarayanan Structural Biology Lab CSIR-Centre for Cellular and Molecular Biology Uppal Road, Hyderabad - 500 007 ", "Dear Raghvendra Singh, > On 21 May 2020, at 05:27, raghvendra singh < raghvendr...@gmail.com > wrote: > Dear Schmidt, > Thank you for your quick response. > What I meant is: in attached presentation1.pdf . Irrespective of substitution matrix (is i mentioned previously) what i found is A and B always come at the same place with >70 of boot strap value (please look at image). So My question is am i doing something wrong with program or what? A few questions and comments: Is there any reason to believe that the two taxa should not end up in these places? Why would you believe that changing the substitution model needs to change the resulting tree? From the command lines you have sent in your first email, I see that you do show UFboot support values (not standard bootstrap support values). In the interpretation of the values that makes a big difference. While one might start trusting standard bootstrap (SBS) values at about 70%, this is not the case for UFboot values. The latter behave more like probabilities. Thus, you would like to have them around 95% and above to be trustworthy. For UFboot values about 70% means no actual support. So, if these values are indeed UFboot values, all the support values are pretty low, which makes it hard to take any branch in there as certain. The reasons why the tree has low support can be manyfold and could also depend on the sequences used and their alignment. A question from my side: Which tool did you use to draw that tree? Best wishes, Heiko > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAP7cDT-KJrsY9XQgiuHtD8qar%3D5Xm65ehHmXr3vrPKj1bwJr3g%40mail.gmail.com > <Presentation1.pdf> ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "A few questions and comments: Is there any reason to believe that the two taxa should not end up in these places? No, in fact it is following my hypothesis. Why would you believe that changing the substitution model needs to change the resulting tree? It is my perception (though I am wrong now) when you use complex substitution model or other programs texa A and B may change. But they are not changing, So, they are not randomly placed. From the command lines you have sent in your first email, I see that you do show UFboot support values (not standard bootstrap support values). In the interpretation of the values that makes a big difference. Yes, You are right I have used UFboot. Along with UFboot I used -alrt also. Alrt+UfBoot together will make sense ( >= 80% and UFboot >= 95% ). But the problem is, in I-TOL I cannot represent two values together. It would be great help if you can suggest me how to represent UFboot+alrt values together in Itol? While one might start trusting standard bootstrap (SBS) values at about 70%, this is not the case for UFboot values. The latter behave more like probabilities. Thus, you would like to have them around 95% and above to be trustworthy. For UFboot values about 70% means no actual support. Yes, I agree, I have got clarity I will change So, if these values are indeed UFboot values, all the support values are pretty low, which makes it hard to take any branch in there as certain. The reasons why the tree has low support can be manyfold and could also depend on the sequences used and their alignment. Your suggestions are really improved my understanding. While selecting sequences I took care of diversity and minimum biasness. For alignment I have used MAFFT with structural constrain. A question from my side: Which tool did you use to draw that tree? I have used I-TOL. Can you suggest me something where I can represent UFboot and alrt and abayes value together? I have another doubt like when to use ML method and when do we use Bayesian based method for phylogeny Thank you for your valuable comments. Raghav To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/FCE08102-49B1-49F4-A2EA-49523D0C82C5%40univie.ac.at ", "Hi All, Just a couple of general comments. Fist, it's fairly normal that changing the substitution model doesn't change the tree. Indeed, although the substitution models are all different, they are still all very very similar. They all make very similar assumptions about the way molecular evolution works. So in general if changing the model changes the tree (particularly the part you are interested in) that is something to worry about. Normally one expects very little to change in the tree - when you do see changes they tend to be on short and/or poorly supported branches. There are lots of papers out there on this, here's one we wrote (the model differences here are about partitioning, but it's the same principle): https://academic.oup.com/mbe/article/32/6/1611/1068429 ggtree (in R) and ete tools (in python) are probably the best options for plotting lots of things on branches of trees. Finally: ML vs. Bayes. This is a good paper to get you started: https://www.nature.com/articles/nrg3186/ . But the short answer is that both methods are substantially similar if you are just looking to estimate a tree. The main difference is that ML provides you with a point estimate of the tree and branch lengths (which are usually the things you care about). You can get a nice idea of uncertainty in both via bootstrapping. Bayesian inference provides you with a posterior distribution of trees and branch lengths. If you are proper Bayesian then you would never really use a single tree, only the full distribution of trees. Since most people are interested in some kind of 'best' tree (e.g. in Bayesian inference people often like to use the MAP tree), this means that ML and Bayesian often show identical or near-identical trees. A couple of differences between ML and Bayesian are that Bayesian inference allows you to specify informative priors, and that the estimates of the tree and branch lengths that you get have integrated out any uncertainty you might have in nuisance parameters like the transition rates. In practice though this makes very little difference for building trees. Where it makes a really big difference is in fitting very complex models like those used in molecular dating and phylodynamics. Hope some of that helps! Rob To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAP7cDT9hQchPULDukevass5%3DUVC4-PQGwOEWYiPK8VFRZXjpAg%40mail.gmail.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Thanks Rob. It is really helpful for me. Thanks a lot :) To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmpM0uOyPkqF6SUkPuxJXZQrHBD98VoxDPeZBka8DiFqrQ%40mail.gmail.com "]}, "Mh7-2Xh5MaA": {"topic": "More detailed output for codon substitution models", "initializeDate": "Feb 18, 2021, 1:20:08 PM", "timeStamp": "Feb 22, 2021, 9:57:39 AM", "content": ["Dear developers, I've been playing around with IQ-TREE a bit (and I love it!) and I've noticed that the output of the codon substitution models is somewhat limited. It essentially only outputs the tree and omega (dN/dS). Perhaps this is sufficient for the wider usership, but I don't see why other useful metrics which are part of the same calculation can also be outputted. For example, many researchers looks at dN and dS values separately from omega values. Also, some times its is also valuable to look at the total number of synonymous and nonsynonymous sites. These two are very easy fixes. In addition, it would also be great to have a per branch model implementation where these same metrics are calculated for each branch on the tree. I think many people would benefit from having a more explicit account of the parameters in such a versatile and elegant program such as iq-tree. Thank you! Santiago ", "Hi Santiago, These complex codon models are implemented in the PAML software package. Implementing them are not that easy and currently we don\u2019t have the human resources. So I\u2019d infer a tree using IQ-TREE and then input the tree to PAML and do all sorts of statistics there. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ad3e523c-4aeb-4816-b14f-3ba952c770c8n%40googlegroups.com ", "Hi Minh, Thanks for your reply. Sure, I get that for the branch models. But global dn and ds values need to be estimated omega anyway (I can see them in the code), so having them separately would make this function and these models much more usable. It wouldn't take you 5 min to change the default output. Unfortunately, I don't know enough c++ to do these changes myself. Thanks, Santiago "]}, "Mi9j16LYr3M": {"topic": "topology doesn't change after constraint tree (-g) is used", "initializeDate": "Dec 6, 2017, 6:54:51 AM", "timeStamp": "Dec 7, 2017, 7:27:02 AM", "content": ["Hi IQ-TREE team, Thank you very much for developing this great software. I have been trying to use -g option in my analysis, by which we hope would get a topology supporting a monophyletic group that is always inferred as paraphyletic, but the result of using -g option is the same as the results without using -g. My constraint tree file is like this: (((CLADE1_sp1,CLADE1_sp2),(CLADE2_sp1,CLADE2_sp2),CLADE3,(CLADE4_sp1,CLADE4_sp2,CLADE4_sp3)),outgroup); The four clades (CLADE1, CLADE2, CLADE3, CLADE4) are supposed to be monophyletic, and the \"outgroup\" is the supposed sister to the previous group. My command of running iqtree is as following: iqtree-omp -s ALIGNMENT -spp PARTITION_SCHEME_WITH_MODEL -g constraint_tree -nt 28 -bb 1000 -wbtl -safe Could you give me a clue why I cannot get this group monophyletic, and what should I do to get it monophyletic? Thank you very much for the help! Cheers, Liping ", "Dear Liping, thank you for your interest in IQ-TREE. > I have been trying to use -g option in my analysis, by which we hope would get a topology supporting a monophyletic group that is always inferred as paraphyletic, but the result of using -g option is the same as the results without using -g. My constraint tree file is like this: > (((CLADE1_sp1,CLADE1_sp2),(CLADE2_sp1,CLADE2_sp2),CLADE3,(CLADE4_sp1,CLADE4_sp2,CLADE4_sp3)),outgroup); > The four clades (CLADE1, CLADE2, CLADE3, CLADE4) are supposed to be monophyletic, and the \"outgroup\" is the supposed sister to the previous group. I am not sure what the problem is. I assume that your dataset has \u2018just\u2019 9 sequences, which I could not be sure about from the naming. If that is correct, then according to that constraint tree, IQ-TREE has no choice to produce out with any of the 4 clades not being monophyletic. If you view the resulting tree as unrooted e.g. in FigTree: (a) CLADE1_sp1 and CLADE1_sp2 have to be neighbours in a cherry (a subtree of only 2 sequences), thus monophyletic, (b) CLADE2_sp1 and CLADE2_sp2 have to be neighbours in a cherry, thus monophyletic, (c) CLADE3 is only a single sequence, thus, automatically monophyletic, and finally (d) CLADE4_sp1, CLADE4_sp2 and CLADE4_sp3 have to end up monophyletically in a subtree of 3. IQ-TREE has only the freedom to infer which pair of the three forms a cherry at the exclusion of the third. Besides the branching order in clade 4, IQ-TREE only can decide which of the 15 branching orders of clade 1-4 and outgroup gains the highest likelihood. As a reviewer I might be curious why for this number of sequences you are actually restricting the trees such that there is only so little freedom and might request to run the analysis also without constraint and compare. I highly understand constraints in datasets with many taxa. > My command of running iqtree is as following: > iqtree-omp -s ALIGNMENT -spp PARTITION_SCHEME_WITH_MODEL -g constraint_tree -nt 28 -bb 1000 -wbtl -safe > Could you give me a clue why I cannot get this group monophyletic, and what should I do to get it monophyletic? As pointed out above, all clades have to be monophyletic (you leave IQ-TREE no choice in that). I guess that problem is that they are, but you do view the tree not rooted at the outgroup, which is the only purpose of the outgroup sequence(s). > Thank you very much for the help! You are welcome. I hope the answers help you. Best wishes, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Hi Heiko, Thank you very much for the answer. I didn't make my question quite clear in last post... So I have an analysis involving more than nine taxon, the tree construction result of which is in the figure below. I want to have the taxon with red branches to be monophyletic, and my constraint tree file is like this: (((GYSP,GAPE),(OELE,POMA),CUAU,(CETI,RHPU,CETR)),SACA); I cannot get these red-branched taxon cluster together with -g option of this constraint tree file. I would be very appreciate if you could let me know what is wrong here. Cheers, Liping ", "Dear Liping, > Thank you very much for the answer. I didn't make my question quite clear in last post... So I have an analysis involving more than nine taxon, the tree construction result of which is in the figure below. Indeed the picture helps quite a bit to understand the question. Especially, that the constraint tree is not complete with respect to the included taxa. > I want to have the taxon with red branches to be monophyletic, and my constraint tree file is like this: > (((GYSP,GAPE),(OELE,POMA),CUAU,(CETI,RHPU,CETR)),SACA); > I cannot get these red-branched taxon cluster together with -g option of this constraint tree file. I would be very appreciate if you could let me know what is wrong here. Of course, your constraint tree does not force any of the taxa not included in the constraint tree. To check whether the constraint tree is met, one just drops all taxa not in the constraint tree. The resulting so-called induced subtree looks like this: ((GYSP,GAPE),((OELE,POMA),(CUAU,((CETI,(RHPU,CETR)),SACA)))); This is congruent with the constraint tree because we find the subtrees GYSP+GAPE, OELE+POMA, and CETI+RHPU+CETR, thus, monophyletic. Since CUAU and the outgroup SACA are single sequences, they are automatically monophyletic. Just looking at the tree and its branch lengths, I would not get the idea that SACA acts like an outgroup. Moreover, judging from the branch length distribution along the tree SACA does not look wrongly placed. However, there are a number of informations which I do not have to properly interpret this tree: (a) What scale are the branch lengths? I cannot guess they reflect e.g. 1 substitution/1mio sites or 1 substitution in 100 sites. (b) Did you obtain any support values like Bootstrap (-b) or UFBoot (-bb)? If yes, they should be printed to the branches to be able to judge how certain one can be about a branch. If not, you should definitely add this. (c) Did you you check for phylogenetic signal, e.g. by doing likelihood mapping (-lmap) maybe in connection with looking at the number of informative sites listed in the log file. These points are important to actually be able ti interpret the tree. Best wishes, Heiko ", "> (a) What scale are the branch lengths? I cannot guess they reflect e.g. 1 substitution/1mio sites or 1 substitution in 100 sites. OK, I just found that there is a scale bar at the very top, which tells me that quite a number of branches even reflect about 10% change in the sequence. Still, the other two points would be important as well. Cheers, Heiko ", "Dear Heiko and Minh, first a) we are doing everything what is recommended and a lot more test: fast BS, non-param. slow BS, AU tests, Four-cluster likelihood mapping, looking at partition log-LHs etc pp. - but this is not the point. Our major issue / question is that we want to understand what is meant by \"constraint\" in IQtree. There are two different ways we understand it: a) what you described is a \"constraint\" like being a backbone tree, so its plausible that the other species (not in the constraint tree) might be inferred between them. Is this correct? b) We had another aim: having a dataset we get results that are implausible from morphological view. So The only aim was to \"force\" the red marked branches into one monophyletic clade (either multi-furcating and let IQtree infer internal relationships or providing a fixed topology for the \"red marked branches\") - and the let IQ inferring all other species \"around them\" (but the red clade (=constraint) should stay as it is - and not resulting in having other species between them. red : the species of interest that we want artificially to be together (non others in between). blue : possible outgroup (do we have to define this in the constraint tree? if so, can it be only one species or dor mre work, lets say \"SACA\" is a clade with 2 species) black: all other taxa. (GYSP,GAPE),((OELE,POMA),(CUAU,((CETI,(RHPU,CETR)) SACA )))),(ALL_OTHER_TAXA); Then we also would like to look what the support would be (maybe very low). A backbone (constraint) as result, having black taxa possibly inferred within the red clade - as we have now - is not what we want So: is it possible in IQ tree to do what we decribed above ? If not: any other ideas? Hope being understandable... Many thanks, Liping & Karen ", "Dear Karen, dear Liping, > first a) we are doing everything what is recommended and a lot more test: fast BS, non-param. slow BS, AU tests, Four-cluster likelihood mapping, looking at partition log-LHs etc pp. - but this is not the point. This might not be your point, but it is important to know for us if we are supposed to help and interpret the tree presented to us. I hope you understand this. > Our major issue / question is that we want to understand what is meant by \"constraint\" in IQtree. > There are two different ways we understand it: > a) what you described is a \"constraint\" like being a backbone tree, so its plausible that the other species (not in the constraint tree) might be inferred between them. Is this correct? A constraint tree can only impose constraints on the taxa presented in there. All others are free to be placed. The feature not to have all taxa to be included in the constraint tree is the only way to enforce certain subgroups and analyse them together with taxa for which you do not have any clue where they belong. I would not always call such an incomplete constraint tree a backbone tree. This term is applicable if the constraint tree is resolved, and then the missing ones get added to it (that is what a backbone tree does, it constraints the starting tree to which other taxa are added). If the constrain tree only contains e.g. a single split, I would not call that one a backbone tree at all. > b) We had another aim: having a dataset we get results that are implausible from morphological view. So The only aim was to \"force\" the red marked branches into one monophyletic clade (either multi-furcating and let IQtree infer internal relationships or providing a fixed topology for the \"red marked branches\") - and the let IQ inferring all other species \"around them\" (but the red clade (=constraint) should stay as it is - and not resulting in having other species between them. If you just want to force the \u2018red taxa\u2019 into their own subtree, the constraint tree should look like that: ((GYSP,GAPE,OELE,POMA,CUAU,CETI,RHPU,CETR),SACA,ALL_OTHER_TAXA); If you force SACA also into the subtree you might not be able to judge from the result whether it is actually a good outgroup with respect to the other taxa. It is always dangerous to enforce to many constraints as it may induce huge discussions with reviewers whether the constraints are justified\u2026 I am not the one to judge ;) > red: the species of interest that we want artificially to be together (non others in between). > blue: possible outgroup (do we have to define this in the constraint tree? if so, can it be only one species or dor mre work, lets say \"SACA\" is a clade with 2 species) > black: all other taxa. > ((GYSP,GAPE),((OELE,POMA),(CUAU,((CETI,(RHPU,CETR)),SACA)))),(ALL_OTHER_TAXA); If GYSP,GAPE,OELE,POMA,CUAU,CETI,RHPU,CETR are the in-group you are interested in (as I guess from the emails from Liping contrasting those to an outgroup, it should not be as resolved because there is nothing left that can be inferred from the data. > Then we also would like to look what the support would be (maybe very low). Please not that splits from the constraint tree are enforced and cannot change in the analysis. Thus, if you run a bootstrap/UFboot analysis to infer branch supports, the branch separating the red from all other taxa has always to be there by definition (it is a constraint). Hence the bootstrap/UFboot support has to be 100%. > A backbone (constraint) as result, having black taxa possibly inferred within the red clade - as we have now - is not what we want > So: is it possible in IQ tree to do what we decribed above ? If not: any other ideas? If you want to have the support of a constraint branch, constraint trees might not be the way to go. Best, Heiko ", "Dear Heiko, Am Donnerstag, 7. Dezember 2017 13:10:15 UTC+1 schrieb Heiko: Dear Karen, dear Liping, > first a) we are doing everything what is recommended and a lot more test: fast BS, non-param. slow BS, AU tests, Four-cluster likelihood mapping, looking at partition log-LHs etc pp. - but this is not the point. This might not be your point, but it is important to know for us if we are supposed to help and interpret the tree presented to us. I hope you understand this. sure :) ! We just wanted tried to describe what we aim to do... > Our major issue / question is that we want to understand what is meant by \"constraint\" in IQtree. > There are two different ways we understand it: > a) what you described is a \"constraint\" like being a backbone tree, so its plausible that the other species (not in the constraint tree) might be inferred between them. Is this correct? A constraint tree can only impose constraints on the taxa presented in there. All others are free to be placed. The feature not to have all taxa to be included in the constraint tree is the only way to enforce certain subgroups and analyse them together with taxa for which you do not have any clue where they belong. I would not always call such an incomplete constraint tree a backbone tree. This term is applicable if the constraint tree is resolved, and then the missing ones get added to it (that is what a backbone tree does, it constraints the starting tree to which other taxa are added). If the constrain tree only contains e.g. a single split, I would not call that one a backbone tree at all. ok - we agree !! I just tried to search then for another word to decribe the difference... > b) We had another aim: having a dataset we get results that are implausible from morphological view. So The only aim was to \"force\" the red marked branches into one monophyletic clade (either multi-furcating and let IQtree infer internal relationships or providing a fixed topology for the \"red marked branches\") - and the let IQ inferring all other species \"around them\" (but the red clade (=constraint) should stay as it is - and not resulting in having other species between them. If you just want to force the \u2018red taxa\u2019 into their own subtree, the constraint tree should look like that: ((GYSP,GAPE,OELE,POMA,CUAU,CETI,RHPU,CETR),SACA,ALL_OTHER_TAXA); ok cool. If you force SACA also into the subtree you might not be able to judge from the result whether it is actually a good outgroup with respect to the other taxa. got it. It is always dangerous to enforce to many constraints as it may induce huge discussions with reviewers whether the constraints are justified\u2026 I am not the one to judge ;) ok we are aware of this - we just want to see what happens... > red: the species of interest that we want artificially to be together (non others in between). > blue: possible outgroup (do we have to define this in the constraint tree? if so, can it be only one species or dor mre work, lets say \"SACA\" is a clade with 2 species) > black: all other taxa. > ((GYSP,GAPE),((OELE,POMA),(CUAU,((CETI,(RHPU,CETR)),SACA)))),(ALL_OTHER_TAXA); If GYSP,GAPE,OELE,POMA,CUAU,CETI,RHPU,CETR are the in-group you are interested in (as I guess from the emails from Liping contrasting those to an outgroup, it should not be as resolved because there is nothing left that can be inferred from the data. yes > Then we also would like to look what the support would be (maybe very low). Please not that splits from the constraint tree are enforced and cannot change in the analysis. Thus, if you run a bootstrap/UFboot analysis to infer branch supports, the branch separating the red from all other taxa has always to be there by definition (it is a constraint). Hence the bootstrap/UFboot support has to be 100%. yes > A backbone (constraint) as result, having black taxa possibly inferred within the red clade - as we have now - is not what we want > So: is it possible in IQ tree to do what we decribed above ? If not: any other ideas? If you want to have the support of a constraint branch, constraint trees might not be the way to go. yes - any other ideas? best Karen & Liping Best, Heiko "]}, "4bFx4msk81I": {"topic": "branch lengths missing for standard non-parametric bootstrap contree file", "initializeDate": "Sep 28, 2017, 4:58:24 AM", "timeStamp": "Jun 2, 2020, 12:24:34 AM", "content": ["Hi. Not sure if this is a feature request or a bug. Running these: 1. iqtree-omp -s example.phy -nt 4 -bb 1000 -pre example.phy.bb1000 2. iqtree-omp -s example.phy -nt 4 -b 100 -pre example.phy.b100 I get these contrees respectively: 1. (LngfishAu:0.1709694637,(LngfishSA:0.1883831199,LngfishAf:0.1648671706)100:0.107347,(Frog:0.2562447908,((((Turtle:0.2215285098,(Crocodile:0.3056817258,Bird:0.2310266099)97:0.065125)71:0.036477,Sphenodon:0.3446959619)49:0.020433,Lizard:0.3860705950)99:0.074003,(((Human:0.1851977105,(Seal:0.0944428932,(Cow:0.0823070449,Whale:0.1013098304)99:0.040444)72:0.025258)90:0.034061,(Mouse:0.0584277962,Rat:0.0905653375)100:0.121824)100:0.060722,(Platypus:0.1920402609,Opossum:0.1510480052)98:0.037331)100:0.149069)100:0.127576)100:0.094066); 2. (Bird,Crocodile,(Turtle,(Sphenodon,(Lizard,((((LngfishAf,LngfishSA)100,LngfishAu)100,Frog)100,((Opossum,Platypus)96,((((Cow,Whale)100,Seal)64,Human)91,(Mouse,Rat)100)100)100)100)38)70)97); The contree for the standard bootstrap is missing branch lengths, would it be possible to have these? Thanks. Tim ", "Dear Tim, This is a feature request ;-) I understand that one would like to compute branch lengths of the consensus tree, which IQ-TREE could have done actually. As a workaround for now you can input the contree with -te option via a second run like this: iqtree-omp -s example.phy -nt 4 -te example.phy.b100.contree I would also add -m option with the model determined before to save the model selection step. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "perfect, thanks ", "I was wondering whether this is still a feature request (calculation of branch lengths for standard non-parametric bootstrap contree?). I ran 20 jobs: \"iqtree -s infile.txt -bo 10 -st AA -m LG+G4+I+F -pre bootX -nt AUTO\" then combined 20 \"bootX.boottrees\" to a file named \"alltrees\" (using cat in linux) and then used the following command to create contree: \"iqtree -con -t alltrees\" but the contree is without branch lengths ... what would be the best way to include branch lengths? regards Wannes Op donderdag 28 september 2017 14:28:55 UTC+2 schreef ti...@posteo.de ", "Hi Wannes, You can input the consensus tree using -te option with the original alignment, e.g: iqtree -s ALN_FILE -te CONTREE_FILE to obtain its branch lengths estimated using the original alignment. I have added this into the FAQ. Thanks Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/f68a5232-4d84-47ec-9022-e315afbd5cad%40googlegroups.com ", "Hi Wannes, The key question here is: what is your defition of \u201cwell-supported\" branches? The two methods, UFBoot and SBS, have different meanings for support values, see: http://www.iqtree.org/doc/Frequently-Asked-Questions#how-do-i-interpret-ultrafast-bootstrap-ufboot-support-values I\u2019d only start to \u201cbelieve\u201d in a clade with UFBoot >= 95%, whereas this threshold for SBS is lower, say 70 or 80%. However, note that for phylogenomic (multi-gene) data, both values tend to be 100%, which is not always trustworthy. In that case, you can perform concordance factor analysis: http://www.iqtree.org/doc/Concordance-Factor that complements the bootstrap approach. Cheers Minh PS: I replied to the IQ-TREE group to keep track of the answers, and this also might be of general interests. On 31 May 2020, at 7:27 pm, Wannes Dermauw < dermau...@gmail.com > wrote: Dear Minh Thank you for the quick reply suggested solution. I do have a more general question regarding consensus trees obtained through \u2018classical\u201d bootstrapping versus consensus tree obtained through \u201cUFboot\u201d bootstrapping. For the same input alignment, I created a consensus tree -using either 3000 UFboot bootstraps (ran on CIPRES server): UFBOOTtree -200 \u201cclassical\u201d (SBS) bootstraps (split into 20 jobs of 10 bootstraps, could not do more jobs because of limited use of CPU/user). SBSboottree However, somel well-supported branches in the UFBOOTtree are not conserved in the SBSboottree. Hence, my question is, which consensus tree should we \u201cbelieve\u201d in? The one based on a high number of rapid bootstrapping (UFboot) or the one based on a low number of classical bootstrapping (SBS)? Kind regards Wannes "]}, "4ys38Wx70Ks": {"topic": "BUG: GHOST model crashing", "initializeDate": "Jan 24, 2021, 9:05:20 PM", "timeStamp": "Feb 17, 2021, 7:52:47 AM", "content": ["Running the GHOST model with 4 categories on a multigene amino acid alignment causes the program to crash. Other IQTREE models run without error on the same data. Iqtree version 1.6.12 on Linux. The analysis was restarted from the checkpoint once. Command line: $iqtree -s Super.alignment.cleaned.75trimal.fasta -m LG+F+I+H4 -bb 10000 -nt 18 -o Pyramimonas_parkeae -wspm Seed: 574880 Many log file lines have a warning about worse trees \"at EM step 1 new_tree_lh -38856567.515 worse than tree_lh -38856565.553\" The lines at the end with an ERROR look like this: ERROR: ratefree.cpp:539: double RateFree::optimizeWithEM(): Assertion `score > old_score-0.1' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: Super.alignment.cleaned.75trimal.fasta.log ERROR: *** Alignment files (if possible) See also attached full log file. ", "Hi there, I believe the I+H model does not work properly here. In fact we never tested this combination of invariable sites and GHOST models. So please avoid using it. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/bfe91d5f-e800-482d-8d56-db417cd3131fn%40googlegroups.com ", "Hello, Thank you for your response. After running GHOST without the invariant sites model, I received another error. Here is the iqtree command: $iqtree -s Super.alignment.cleaned.75trimal.fasta -m LG+F+H4 -bb 10000 -nt 16 -o Pyramimonas_parkeae -wspm Attached is the log file. "]}, "bkfO2vT4XV8": {"topic": "GHOST model- understanding the output", "initializeDate": "Jun 25, 2018, 10:02:41 PM", "timeStamp": "Jun 27, 2018, 8:49:15 AM", "content": ["Dear Developers, I recently read a paper about GHOST, and I am interested in figure 8, which is \" Probability of sites belonging to the convergent class by codon position\". Using command -wspm of IQTREE, I got an output which is said contains the probability of each site belonging to each class. I would like you to help me to clarify: 1. What does p1 -> p4 mean? are they site classes? And if yes, would you please to give me description/ explanation about \"class\" 2. How can I know where is the convergent class? 3. How to extract information about sites class by codon position (when I do not invoke -st CODON command) Thank you very much! Best regards, Giap Nguyen ", "Hi Giap, Thanks for your question and your interest in GHOST. You are right, the columns p1 refer to the classes. So you can interpret the numbers in the p1 column as \u201cthe probability that the site belonged to class 1. As for the convergent class, that finding was specific to the electric fish dataset that we analysed in the paper. So you won\u2019t necessarily find a convergent class in your dataset. I would just advise you to look at the trees returned by the GHOST model and see if you can notice any interesting features that may support or contradict some biological hypotheses that you have about your dataset. With regard to the question about codon position, I just did this manually as I knew for my dataset, which sites corresponded to codon positions 1, 2 and 3. The only information I used was the .siteprob file that you obtained using the -wspm option. Hope that helps! Stephen Stephen Crotty, PhD Centre for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC 5, Ebene 1 A-1030 Vienna, Austria Email: stephen...@univie.ac.at You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Stephen, Thank you for your reply. I still have a question, that is: GHOST model just predict site to each of 4 classes, but the name of class, such as 'convergent', 'conserved', etc. is depend on biological context? Thank you in advanced! Sincerely yours, Giap Nguyen ", "Yes, that\u2019s right Giap. Those names that we gave each class in the paper were based on what we observed in that particular example. We named the conserved class because the branch lengths were much shorter in this class than the other three classes, so nucleotides in this class had few substitutions. We named the convergent class because the tree showed there were long branches on two separate clades of electric fishes, but very short branches on all of the non-electric fish, so it appeared that this class was associated with the convergent evolution of the two clades. The other two classes we simply called \u201cfast-evolving\u201d, because they had much longer branch lengths relative to the convergent and conserved classes. Cheers, Stephen Stephen Crotty, PhD Centre for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC 5, Ebene 1 A-1030 Vienna, Austria Email: stephen...@univie.ac.at ", "Hi Stephen, Thank you so much for your explanation. It is very helpful. Best regards, Giap Nguyen "]}, "n0AsFOFoT6Y": {"topic": "IQ-Tree release 1.3.5", "initializeDate": "Jul 23, 2015, 7:18:23 PM", "timeStamp": "Jul 23, 2015, 7:18:23 PM", "content": ["Dear IQ-Tree users, we have released a new version 1.3.5 with some fixes mainly concerning the new model selection strategy: Thorough model selection (-mtree) now prints final tree corresponding to best-fit model. Fix slightly decreasing log-likelihood for more complex models during new model selection (-m TESTNEW). For bootstrap: .iqtree report file now includes log-likelihood of consensus tree and Robinson-Foulds distance between found ML tree and consensus tree. Thanks a lot to Lars Jermiin for the help identifying these problems. Cheers, Minh Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at "]}, "9InHeC_SKec": {"topic": "Binary data and concordance factors?", "initializeDate": "Oct 1, 2019, 9:19:39 AM", "timeStamp": "Oct 5, 2019, 4:17:17 PM", "content": ["Hi All, I'm working with a binary dataset which gives us a strange phylogeny with some very wrong phylogenetic relationships that well supported (by bootstrap and single branch tests). These wrong relationships are pretty interesting to us, and we'd like to calculate concordance factors on the data treating each site in the binary matrix as a partition. Is option implemented for the estimation of concordance factors? Thanks Vinny ", "Dear Vinny, Perhaps you are talking about site concordance factor (sCF)? It computes concordance factor at the site level. See our preprint for more details. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5962cb1c-6872-4061-ae65-bfe2c3535038%40googlegroups.com ", "Yes, thanks! That is what I was thinking about, I'll check the preprint.... On Wednesday, October 2, 2019 at 9:24:50 PM UTC-4, Minh Bui wrote: Dear Vinny, Perhaps you are talking about site concordance factor (sCF)? It computes concordance factor at the site level. See our preprint for more details. Cheers, Minh On 1 Oct 2019, at 11:19 pm, Vincent Lynch < vincen...@gmail.com > wrote: Hi All, I'm working with a binary dataset which gives us a strange phylogeny with some very wrong phylogenetic relationships that well supported (by bootstrap and single branch tests). These wrong relationships are pretty interesting to us, and we'd like to calculate concordance factors on the data treating each site in the binary matrix as a partition. Is option implemented for the estimation of concordance factors? Thanks Vinny You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "qGca5tzEYrc": {"topic": "aLRT/UFBoot order in support values", "initializeDate": "Aug 7, 2018, 2:25:21 AM", "timeStamp": "Aug 9, 2018, 1:52:42 AM", "content": ["Hi, Is the order of the support values always like this (aLRT%/UFBoot%), or does the order change depending on the order you add the commands in the command line argument? //David ", "Hi David, The order of these options in the command line do not matter, i.e. it is always like this. You can try 2 runs and see .iqtree file, which tells exactly what numbers are. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thank you for the reply! //David "]}, "uhTPCysfCVE": {"topic": "ERROR: State specified (y) for taxon 4, character 2815, not found in list of valid symbols", "initializeDate": "Feb 27, 2018, 9:26:40 AM", "timeStamp": "Feb 27, 2018, 6:25:32 PM", "content": ["Hi All, I have just started using IQtree and I get this error message after loading my nexus file. This job STOPPED because there was a problem! ERROR: ERROR: Error found at line 12, column 2833 (file position 26203): ERROR: State specified (y) for taxon 4, character 2815, not found in list of valid symbols Meanwhile, FORMAT DATATYPE =DNA in my nex file Does IQtree not accept ambiguity codes ? What am I doing wrong ? Regards ", "Hi K, Quick answer: please convert your NEXUS file into FASTA, PHYLIP or CLUSTAL format and input into IQ-TREE. This should work. Long answer: IQ-TREE does support such ambiguous code. But for NEXUS format, instead of \u201cY\" you have write \u201c[CT]\" for C or T. That\u2019s the NEXUS convention. However, for the other alternative formats listed above, the IUPAC convention is accepted. So the 2nd way is to modify your NEXUS file using the square-bracket like above as replacement for all the ambiguous codes. Hope that helps, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "pQ0vUhkDZ-c": {"topic": "iqtree file- speed info for partitions", "initializeDate": "Dec 4, 2017, 4:18:09 AM", "timeStamp": "Dec 4, 2017, 2:48:50 PM", "content": ["Dear iqtree team, I am running model selection and subsequent tree reconstruction (-m MFP) with partitioned models (-spp) on a phylogenomic dataset. One of the output files of iqtree has the suffix .iqtree In that file there is some information as follows: SUBSTITUTION PROCESS -------------------- Proportional partition model with joint branch lengths and separate models between partitions ID Model Speed Parameters 1 LG+I+G4 0.4203 LG+I{0.635497}+G4{0.368965} 2 JTT+I+G4 0.8845 JTT+I{0.403797}+G4{0.572132} 3 JTTDCMut+G4 1.3536 JTTDCMut+G4{0.462711} 4 LG+G4 0.8375 LG+G4{0.213218} 5 LG+G4 1.1085 LG+G4{0.223051} What does the second column (i.e speed) mean in this case? Is this related to the partition specific rate (i.e. evolutionary rate)? And if yes how is this calculated? If no is there anyway to get an overview of the evolutionary rate for each partition from the output files of this analyses? Many thanks Alex ", "Dear Alex, The Speed column is exactly as you asked: it is the partition specific rate. They are computed by maximum likelihood. The rates are normalized such that the weighted average is 1, where the weights are the partition alignment length divided by supermatrix length. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "qasxQTI2pXc": {"topic": "Re: [iqtree] Brand new to IQ Tree --DESPERATE for help!", "initializeDate": "Mar 25, 2016, 3:57:26 AM", "timeStamp": "Mar 25, 2016, 3:57:26 AM", "content": ["Hi Hannah, Did you look at the quick start tutorial: http://www.cibiv.at/software/iqtree/doc/Quickstart/ Alternatively, you can try out the IQ-TREE web server here: http://iqtree.cibiv.univie.ac.at Just input your alignment file, enter email address and submit job. Cheers, Minh > On Mar 22, 2016, at 7:07 PM, hsha...@sandiego.edu wrote: > Hello, everyone > I am a senior finishing up my undergrad, finishing up my honors thesis. > Long story short, I need to get my trees sooner than expected. > My problem is, I've never even USED a cmd line prompt before. > I followed the instructions on downloading IQ tree, but I don't know what it means to add a directory to my search path, etc. > I have followed countless tutorials and thought I had done it correctly, but I still cannot figure out how to run the program! > I am desperate for help. Could someone post STEP BY STEP instructions for Windows starting from the download of the Zip file until running it via the cmd line? > I am truly desperate--I don't know anyone who knows anything about computers and it all sounds like jibberish to me. > Thank you very much!!! > Hannah > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "gixn3Tzno_s": {"topic": "How to Parse Iqtree file in R ?", "initializeDate": "Apr 27, 2020, 4:46:36 PM", "timeStamp": "May 6, 2020, 3:48:05 AM", "content": ["Dear Experts, I am trying to visualize my Iqtree output in R using ggtree and treeio packages. The problem is I could not access the bootstrap values for overlay. I am suspecting I have not properly imported the file as I only used the read.iqtree file ) kindly help me, please. Thank you. ", "Hi Kehinde, This question was asked before and as far as I remember, somebody kindly provided the R code to process the tree file. So please search the google group: https://groups.google.com/forum/#!forum/iqtree Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/eca90396-3e2d-4269-a112-03eb87a3abdb%40googlegroups.com ", "Dear Minh, I have since resolved it. Thanks Kehinde Adewole Oyeniran PhD Scholar | Computational Biology | Institute of Infectious Diseases and Molecular Medicine (IDM) | Faculty of Health Sciences | University of Cape Town | Health Sciences Campus, Anzio Road, Observatory, 7925 | Blog: www.electoralreform-ng.blogspot.com | UCT email: OYNK...@myuct.ac.za +27(0)619507372 +27(0)736207568 +234(0)8038294995 \u201cAs you rise you must lift the others up\u201d -- Justice Skweyiya (RIP) "]}, "tdCjZrKY8j0": {"topic": "iqtree crashes", "initializeDate": "Dec 13, 2017, 1:34:26 AM", "timeStamp": "Dec 13, 2017, 3:57:21 AM", "content": ["I have used iqtree many times with successful tree construction. But this time it crashes and gives me following error aasim@aasim-ProLiant-ML150-Gen9:~/Aasim/bin/trimAl$ iqtree -s trimmed-hy -bb 1000 alrt 1000 -nt AUTO -o OUTLIER_AT IQ-TREE multicore version 1.5.5 for Linux 64-bit built Jun 21 2017 Copyright (c) 2011-2017 by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, and Arndt von Haeseler. Host: aasim-ProLiant-ML150-Gen9 (AVX2, FMA3, 62 GB RAM) Command: iqtree -s trimmed-hy -bb 1000 alrt 1000 -nt AUTO -o OUTLIER_AT Seed: 64777 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Dec 13 11:58:31 2017 Kernel: AVX+FMA - auto-detect threads (32 CPU cores detected) terminate called after throwing an instance of 'std::ios_base::failure[abi:cxx11]' what(): basic_ios::clear: iostream error Reading alignment file trimmed-hy ... STACK TRACE FOR DEBUGGING: 1 funcAbort() 2 () 3 gsignal() 4 abort() 5 __gnu_cxx::__verbose_terminate_handler() 6 () 7 () 8 __cxa_rethrow() 9 std::__throw_ios_failure(char const*) 10 std::basic_ios<char, std::char_traits<char> >::clear(std::_Ios_Iostate) 11 detectInputFile(char*) 12 Alignment::Alignment(char*, char*, InputType&) 13 runPhyloAnalysis(Params&, Checkpoint*) 14 main() 15 __libc_start_main() *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: trimmed-hy.log *** Alignment files (if possible) Aborted (core dumped) The input file is attached herewith. Please help me to fix it. Thanks ", "Dear Aasim, This abort crash is because the input alignment file does not exist or whatever failure with reading it. So please check this out. If you run version 1.5.6 just released, it will print a clear error message about the cause, instead of such messy failure crash. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <trimmed_hyd> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "eKPWESG-_DA": {"topic": "Tree taxa and alignment sequence do not match", "initializeDate": "Nov 18, 2016, 9:18:00 AM", "timeStamp": "Nov 19, 2016, 6:05:31 PM", "content": ["I've tried to use IQTREE with a partitioned dataset but just after merging it returned an error saying that an \"alignment sequence does not appear in the tree\" and after the tree: \"Tree taxa and alignment sequence do not match\". I tried on v1.5.1, v1.5.0 and experienced same matter. Although it bugs on the same sequence each time, the sequence in the alignment seems OK (I mean: at least for me) and the same dataset used in a non-partionned way proceeded well. Seems linked to partition tree building? I also tried to load the alignment in fasta and phylip format: same outcome and the program stopped. Any idea of the cause? Thx Olivier Some logs: IQ-TREE multicore version 1.5.1 for Linux 64-bit built Nov 8 2016 Command: ./iqtree-omp -s file.fasta -st DNA -spp partitions.txt -m TESTNEWMERGE -rcluster 10 -bb 1000 -alrt 1000 -nt AUTO Seed: 697279 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Wed Nov 16 18:05:51 2016 Kernel: SSE3 - 0 threads (4 CPU cores detected) Selecting individual models for 9 charsets using BIC... No. Model Score Charset 1 TVM+R5 65934.235 RPB1 2 TIM2+I+G4 57477.078 HSP60 3 TN+I+G4 51676.541 G3PDH 4 K3Pu+R5 53314.112 Tef1 5 TPM2u+I+G4 54930.862 Tub 6 TIM2+R4 49997.227 28S 7 TNe+R3 40098.280 18S 8 GTR+R5 115058.812 RPB2 9 GTR+R7 88985.288 ITS Full partition model BIC score: 582797.145 (lh=-279725.433 df=2397) Merging models to increase model fit (about 20 total partition schemes)... 10 TIM2e+R6 584205.992 RPB1+28S 2h:29m:52s (2h:29m:52s left) 11 TIM2e+R5 584210.477 G3PDH+28S 2h:42m:9s (2h:12m:40s left) 12 TIM2e+R5 585451.667 HSP60+18S 3h:3m:18s (2h:2m:12s left) 13 GTR+R6 582255.707 RPB1+RPB2 3h:4m:28s (1h:39m:19s left) Merging RPB1+RPB2 with BIC score: 582255.707 (lh=-280146.239 df=2255) 14 TIM2+R6 584047.032 RPB1+RPB2+28S 5h:35m:3s (2h:23m:35s left) BEST-FIT PARTITION MODEL: charpartition BIC = GTR+R7: ITS, GTR+R6: RPB1 RPB2, TN+I+G4: G3PDH, TIM2+I+G4: HSP60, K3Pu+R5: Tef1, TPM2u+I+G4: Tub, TNe+R3: 18S, TIM2+R4: 28S; Agglomerative model selection: (ITS,(RPB1,RPB2)1:582256,G3PDH,HSP60,Tef1,Tub,18S,28S) Merging into 8 partitions... Partition information was printed to partitions.txt.best_scheme.nex Partition information in Raxml format was printed to partitions.txt.best_scheme ERROR: Alignment sequence xxxx xxxx does not appear in the tree (.........) ERROR: Tree taxa and alignment sequence do not match (see above) ", "Dear Olivier, thanks for the detailed report. That sounds like a bug. Can you pls send me the data via my personal email? Cheers, Minh > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "bvEpouzQPpw": {"topic": "RF distances", "initializeDate": "Mar 9, 2017, 2:36:35 PM", "timeStamp": "Mar 14, 2017, 3:41:19 AM", "content": ["Hello, I performed a test that gave me the Robinson-Fould distances between all of my trees using the command: iqtree -rf_all tree_set and I got my matrix. I do have a question regarding the numbers inside the matrix (for example, I got a '6' when comparing two trees, and a '4' when comparing another two). I'm thinking a number '6' describes a higher difference between the trees than a number '4', but I wanted to see if those numbers had a deeper meaning than that. Thank you! Allyson ", "Dear Allyson, yes, 6 means higher difference than 4. The Robinson-Foulds distance counts the number of branches that appear in one tree and not the other tree. If two trees are strictly bifurcating, then it means that 3 branches in tree1 do not appear in tree2 and vice versa, that\u2019s why the RF distances are even numbers. Please note that, this definition also applies to multifurcating trees, then the distances can be an odd number. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Minh, Thanks for the reply! I discussed this with my peers and we are still a little confused as to which branches IQtree is using towards its RF score. I attached 2 different trees we are trying to compare, and we labeled different branches with numbers. The RF score between these two trees is 4, and I was wondering if you were able to look at them and tell me which branches were involved. Thank you, Allyson ", "Dear Allyson, thanks for the nice small example which helps to easily explain it. I assume that DT = Deinococcus-Thermus and FRM/TNR=Firmicutes/Tenericutes. From treeB: branches 3 and 4 do not occur in treeC. All other branches appear in treeC. From treeC: branches 2 and 3 do not occur in treeB. All other branches appear in treeB. Branches in common: treeB.branch5 = treeC.branch7 treeB.branch1 = treeC.branch1 etc\u2026. That\u2019s why the RF distance is 4. Cheers, Minh <treeB.PNG> <treeC.PNG> "]}, "Wgob9pyABtM": {"topic": "BUG: 1.6.5 crash on -madd LG4M and LG4X", "initializeDate": "Jun 2, 2018, 7:17:52 PM", "timeStamp": "Jun 6, 2018, 10:23:53 PM", "content": ["Hi guys, FYI: IQ-TREE multicore version 1.6.5 for Linux 64-bit built May 8 2018 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: ada (AVX2, FMA3, 503 GB RAM) Command: iqtree -nt 6 -wsr -wsl -t BIONJ -mset WAG,LG,JTT -madd LG4M -pre H_mod -s H_mft_lin.fasta -redo Seed: 39310 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Sun Jun 3 00:54:13 2018 Kernel: AVX+FMA - 6 threads (48 CPU cores detected) ....... 72 JTT+F+R4 15653.513 218 31743.025 33334.425 32534.629 73 JTT+F+R5 15630.945 220 31701.890 33378.442 32500.757 74 JTT+F+R6 15628.662 222 31701.324 33469.395 32507.453 Model LG4M is alias for MIX{LG4M1,LG4M2,LG4M3,LG4M4}*G4 ERROR: modelmarkov.cpp:274: void ModelMarkov::init_state_freq(StateFreqType): Assertion `freq_type != FREQ_UNKNOWN' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: Input+log saved, awaiting your request. Thanks for a great program! Cheers, Giddy ", "Hi Giddy, Thank you for this report. I could reproduce this crash with some example alignment here (so need to send your data files). It occurs whenever one uses LG4M or LG4X model. Interestingly there was no crash with v1.6.4. So we\u2019ll prioritise to fix this and other issues ASAP. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hey Minh, can you let me know when this is fixed pls? I would urgently need it (since working with LG4M/X - (meanwhile I go on then probably with version 1.6.2 or 1.6.3...) Best Karen ", "Hi Karen and others, This issue is fixed in a local version here (just one line of code). I need to look at other issues as well. Thus, the next version will be released (hopefully early) next week. Cheers Minh "]}, "K2d4otabctw": {"topic": "Likelihood testsuite", "initializeDate": "Apr 18, 2018, 11:38:14 AM", "timeStamp": "Apr 26, 2018, 11:08:06 AM", "content": ["Hi, I am working on assembling a collection of (alignment, tree, model, parameters) combinations with known likelihoods to check that phylogenetics packages compute likelihoods correctly. Hopefully this would help phylogenetics programs to implement new models by checking that a new implementation obtains the correct likelihood. I also hope that it will be an opportunity for different phylogenetics projects to collaborate. You can use the testsuite to automatically check changes to github using travis-ci. At the moment, optimization quality is not checked. I am wondering if you have any recommendations for using iqtree to simply compute a likelihood and exit without performing optimizations. Barriers so far include: 1. iqtree won't analyze a data set with no variant characters. 2. iqtree prints the \"Initial log-likelihood\" to only 3 digits after the decimal. I would like it to print 15 digits of precision. Other minor barriers include: 3. iqtree won't analyze a 2-taxon tree. 4. iqtree requires -redo to compute the likelihood twice in the same directory Very minor barriers include: 5. need to specify a collection of parameters including -keep-ident -blfix, -te versus t etc. Not really a problem, but if there was a \"compute-likelihood-and-exit\" kind of option, that could make this simpler. Q1. Is there an existing option to show more precision in the likelihood? Q2. If the user wants a likelihood, but does not want optimization, could you allow alignments with no variant characters? The command that I am using to check a JC96 model is: iqtree -s AT3.fasta -te AA3.tree -m JC69 -keep-ident -blfix Q3. Is this the right way to compute likelihoods for a fixed set of parameters? The testsuite is called testiphy, and I hope it is an opportunity for different projects to collaborate. Since iqtree implements a lot of models, it should be useful for checking if other software obtains the same likelihood. Q4. Does iqtree have an existing testsuite? Are you possibly interested in contributing test cases, or on collaborating on the testsuite below? See: https://gitlab.com/testiphy/testiphy git clone https://gitlab.com/testiphy/testiphy.git cd testiphy cd tests/likelihood/theoretical/JC/2/ iqtree $(cat iqtree-command.txt) thanks for any help, and thanks for building such well-engineered software! -BenRI ", "Hi Benjamin, On 19 Apr 2018, at 1:38 am, Benjamin Redelings < benjamin....@gmail.com > wrote: Hi, I am working on assembling a collection of (alignment, tree, model, parameters) combinations with known likelihoods to check that phylogenetics packages compute likelihoods correctly. Hopefully this would help phylogenetics programs to implement new models by checking that a new implementation obtains the correct likelihood. I also hope that it will be an opportunity for different phylogenetics projects to collaborate. You can use the testsuite to automatically check changes to github using travis-ci. At the moment, optimization quality is not checked. Sounds interesting! And thanks for your interests in IQ-TREE. I am wondering if you have any recommendations for using iqtree to simply compute a likelihood and exit without performing optimizations. Barriers so far include: 1. iqtree won't analyze a data set with no variant characters. 2. iqtree prints the \"Initial log-likelihood\" to only 3 digits after the decimal. I would like it to print 15 digits of precision. Other minor barriers include: 3. iqtree won't analyze a 2-taxon tree. 4. iqtree requires -redo to compute the likelihood twice in the same directory Very minor barriers include: 5. need to specify a collection of parameters including -keep-ident -blfix, -te versus t etc. Not really a problem, but if there was a \"compute-likelihood-and-exit\" kind of option, that could make this simpler. I see. However, IQ-TREE was designed for general users, and these barriers are there to avoid stupid mistakes. Q1. Is there an existing option to show more precision in the likelihood? Unfortunately no, the precision of 3 is hard coded. You can, however, look at the checkpoint file (.ckp.gz). If you gunzip this file, it\u2019s in YAML format which will store all information you need, from the tree, log-likelihood to model parameters etc. So for example, the CandidateSet section: --- # IQ-TREE Checkpoint ver >= 1.6 CandidateSet: 00: -21152.5225867 (0:0.1709545450,(1:0.1883603193,2:0.1648495407):0.1073332375,(3:0.2562185908,((((4:0.2215215338,(7:0.3056594412,8:0.2310083416):0.06512559802):0.03648138367,5:0.3446608814):0.02043590524,6:0.3860361852):0.07401300354,(((9:0.1851786613,(10:0.0944384042,(11:0.0822970496,12:0.1013007483):0.0404359863):0.02525077803):0.03405731592,(13:0.0584158203,14:0.0905572648):0.1218125813):0.06072570802,(15:0.1920242348,16:0.1510219773):0.03732126719):0.1490640127):0.1275674917):0.09405396367); 01: -21157.7265457 (0:0.1718064142,(1:0.1876897381,2:0.1643690692):0.1064771524,(3:0.2531400733,((4:0.2227472283,((5:0.3420921703,(7:0.3028431993,8:0.2290139617):0.06672720672):0.01527953664,6:0.3918081899):0.03085467614):0.0816909728,(((9:0.1847567720,(10:0.0944183184,(11:0.0821964503,12:0.1010585821):0.04041927178):0.02507032534):0.03413089741,(13:0.0585848378,14:0.0902054116):0.121192629):0.06054781944,(15:0.1909984485,16:0.1511030717):0.03781457652):0.1501666944):0.1259716122):0.09604627354); There the best log-likelihood is -21152.5225867 Q2. If the user wants a likelihood, but does not want optimization, could you allow alignments with no variant characters? The command that I am using to check a JC96 model is: iqtree -s AT3.fasta -te AA3.tree -m JC69 -keep-ident -blfix I just checked a local run here (v1.6.3), and it works fine with such invariant sites only alignment. E.g: 4 4 T1 ACGT T2 ACGT T3 ACGT T4 ACGT So not sure what happened there... Q3. Is this the right way to compute likelihoods for a fixed set of parameters? Yes it is. For models more complex than JC, you can specify and fix model parameters, see here: http://www.iqtree.org/doc/Advanced-Tutorial#user-defined-substitution-models The testsuite is called testiphy, and I hope it is an opportunity for different projects to collaborate. Since iqtree implements a lot of models, it should be useful for checking if other software obtains the same likelihood. Q4. Does iqtree have an existing testsuite? We do have some test suite ( https://github.com/Cibiv/IQ-TREE/tree/master/test_scripts ) written in Python. But it only checks if the runs crashed or not, with various combination of options and test data. But it would be better, if it checks that the results are correct or not. Are you possibly interested in contributing test cases, or on collaborating on the testsuite below? I just had a quick look at testiphy. Seems like a good idea. However, Tung, the one who created the Python test script, left the project. What I can provide you right now is a bunch of alignments that caused bugs in IQ-TREE. This could represent hard test cases for other software as well. Cheers, Minh See: https://gitlab.com/testiphy/testiphy git clone https://gitlab.com/testiphy/testiphy.git cd testiphy cd tests/likelihood/theoretical/JC/2/ iqtree $(cat iqtree-command.txt) thanks for any help, and thanks for building such well-engineered software! -BenRI You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Thank you for your help! The model interface seems very well designed - this must have taken a lot of work. Many ML programs do not allow setting parameters on the command line, and most ML programs do not seem to have as many models as IQ-TREE. Right now, testiphy gives this output: $ ./testiphy iqtree Running tests for 'iqtree': Running test: tests/likelihood/theoretical/JC/1 ... FAIL! ['exit', 'likelihood'] (expected) ERROR: Only one state is observed in alignment Running test: tests/likelihood/theoretical/JC/2 ... ok Running test: tests/likelihood/1 ... ok SUCCESS! (0 unexpected failures, 1 expected failures, 3 tests total) I will add iqtree commands for more of the tests as I have time. The first test here is specifed as an expected failure just for IQ-TREE (see below), so the testsuite as a whole passes instead of failing. I have some comments below - can you comment on these? On 04/20/2018 12:01 AM, Minh Bui wrote: I am wondering if you have any recommendations for using iqtree to simply compute a likelihood and exit without performing optimizations. ... I see. However, IQ-TREE was designed for general users, and these barriers are there to avoid stupid mistakes. Those options seem very useful to safefguard users who want to perform optimization. Some users may occasionally want just a likelihood. As you have time, maybe you could optionally add a \"--likelihood-only\" option to add \"-keep-ident -blfix -vvv -redo -blmin 0.0000000000000001 -safe -n 0\" without removing the safeguards. I filed an issue about this. Q1. Is there an existing option to show more precision in the likelihood? Unfortunately no, the precision of 3 is hard coded. You can, however, look at the checkpoint file (.ckp.gz). If you gunzip this file, it\u2019s in YAML format which will store all information you need, from the tree, log-likelihood to model parameters etc. So for example, the CandidateSet section: OK, I didn't know about the YAML. I could make the testsuite load and parse the YAML. However, for now I'm running iqtree with -vvv, which seems to make the initial likelihood printed to the standard output show more digits. Q2. If the user wants a likelihood, but does not want optimization, could you allow alignments with no variant characters? The command that I am using to check a JC96 model is: iqtree -s AT3.fasta -te AA3.tree -m JC69 -keep-ident -blfix I just checked a local run here (v1.6.3), and it works fine with such invariant sites only alignment. E.g: 4 4 T1 ACGT T2 ACGT T3 ACGT T4 ACGT So not sure what happened there... If you do 4 1 T1 A T2 A T3 A T4 A then it will fail with \"Only one state is observed in alignment\". If we could turn this off somehow (maybe under -n 0?) then that would be helpful. Q3. Is this the right way to compute likelihoods for a fixed set of parameters? Yes it is. For models more complex than JC, you can specify and fix model parameters, see here: http://www.iqtree.org/doc/Advanced-Tutorial#user-defined-substitution-models Great! This is very helpful. I would like to specify GTR parameters on the command line. It seems that IQ-TREE complains if we add more than 5 parameters for GTR, and the 6th parameter is assumed to be 1.0: % iqtree -s ~/Work/5d-muscle.fasta -m \"GTR{0.2,0.2,0.2,0.2,0.2,0.0}\" ... ERROR: More than 5 rate parameters specified in 0.2,0.2,0.2,0.2,0.2,0.0 ... It seems that one is allowed to specify a G-T exchangability in a file, but not the command line. However, specifying 10 parameters in a file results in a crash: $ cat mymodel 0.2 0.2 0.2 0.2 0.2 1.0 0.25 0.25 0.25 0.25 bredelings@telomere:~/Devel/testiphy$ iqtree -s ~/Work/5d-muscle.fasta -m mymodel -redo -n 0 IQ-TREE multicore version 1.6.1 for Linux 64-bit built Apr 15 2018 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: telomere (AVX2, FMA3, 19 GB RAM) Command: iqtree -s /home/bredelings/Work/5d-muscle.fasta -m mymodel -redo -n 0 Seed: 896460 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Fri Apr 20 11:46:33 2018 Kernel: AVX+FMA - 1 threads (4 CPU cores detected) HINT: Use -nt option to specify number of threads because your CPU has 4 cores! HINT: -nt AUTO will automatically determine the best number of threads to use. Reading alignment file /home/bredelings/Work/5d-muscle.fasta ... Fasta format detected Alignment most likely contains DNA/RNA sequences Alignment has 5 sequences with 141 columns, 97 distinct patterns 31 parsimony-informative, 57 singleton sites, 53 constant sites Gap/Ambiguity Composition p-value 1 Homo 14.18% passed 59.83% 2 Escherichia 14.89% passed 97.78% 3 Sulfolobus 10.64% passed 94.64% 4 Halobacterium 14.18% passed 89.25% 5 Pyrococcus 12.06% passed 30.46% **** TOTAL 13.19% 0 sequences failed composition chi2 test (p-value<5%; df=3) Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.000 seconds Reading model parameters from file mymodel Rate parameters: A-C: 0.20000 A-G: 0.20000 A-T: 0.20000 C-G: 0.20000 C-T: 0.20000 G-T: 1.00000 Base frequencies: A: 0.250 C: 0.250 G: 0.250 T: 0.250 NOTE: 0 MB RAM (0 GB) is required! ERROR: modeldna.cpp:228: virtual void ModelDNA::restoreCheckpoint(): Assertion `setRateType(rate_spec)' failed. ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 gsignal() ERROR: 4 abort() ERROR: 5 () ERROR: 6 ModelDNA::restoreCheckpoint() ERROR: 7 ModelFactory::restoreCheckpoint() ERROR: 8 runTreeReconstruction(Params&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, IQTree*&, ModelCheckpoint&) ERROR: 9 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 10 main() ERROR: 11 __libc_start_main() ERROR: 12 _start() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED ERROR: *** For bug report please send to developers: ERROR: *** Log file: /home/bredelings/Work/5d-muscle.fasta.log ERROR: *** Alignment files (if possible) Aborted This is not really important, but see https://academic.oup.com/sysbio/article/53/6/877/1651008 That paper is Bayesian, but I think the suggestion of normalizing GTR exchangabilities so that the sum is 1.0 is a good idea because it has more symmetries and does not privelege one of the exchangabilities. Currently, it looks like it is not possible to specify that the G-T exchangeability is 0. The testsuite is called testiphy, and I hope it is an opportunity for different projects to collaborate. Since iqtree implements a lot of models, it should be useful for checking if other software obtains the same likelihood. Q4. Does iqtree have an existing testsuite? We do have some test suite ( https://github.com/Cibiv/IQ-TREE/tree/master/test_scripts ) written in Python. But it only checks if the runs crashed or not, with various combination of options and test data. But it would be better, if it checks that the results are correct or not. I see. I will try to incorporate those data sets. Are you possibly interested in contributing test cases, or on collaborating on the testsuite below? I just had a quick look at testiphy. Seems like a good idea. However, Tung, the one who created the Python test script, left the project. What I can provide you right now is a bunch of alignments that caused bugs in IQ-TREE. This could represent hard test cases for other software as well. It should be possible to run the testsuite from travis-ci so that any changes pushed to are checked automatically. * see https://github.com/bredelings/BAli-Phy/blob/master/.travis.yml (uses meson) * see https://github.com/bredelings/BAli-Phy/blob/3.0.2/.travis.yml (uses autotools) You should also be able to run the testiphy testsuite from travis-ci if you like. I have integrated it into bali-phy as a git submodule, which allows specifying the git SHA of testiphy that will be used to test. I am running it as part of 'make check' or 'ninja test', but you can run it manually also. Thank you for taking time to read this. -BenRI ", "Hi BenRl, Sorry for the delay due to a short vacation. My answers below: On 21 Apr 2018, at 1:59 am, Benjamin Redelings < benjamin....@gmail.com > wrote: Hi Minh, Thank you for your help! The model interface seems very well designed - this must have taken a lot of work. Many ML programs do not allow setting parameters on the command line, and most ML programs do not seem to have as many models as IQ-TREE. Thanks! Indeed the design took a lot of time, but new models are easier to add as a pay-off... Right now, testiphy gives this output: $ ./testiphy iqtree Running tests for 'iqtree': Running test: tests/likelihood/theoretical/JC/1 ... FAIL! ['exit', 'likelihood'] (expected) ERROR: Only one state is observed in alignment Running test: tests/likelihood/theoretical/JC/2 ... ok Running test: tests/likelihood/1 ... ok SUCCESS! (0 unexpected failures, 1 expected failures, 3 tests total) Ah I see, this was due to some optimisation failure when only one state is observed... I will add iqtree commands for more of the tests as I have time. The first test here is specifed as an expected failure just for IQ-TREE (see below), so the testsuite as a whole passes instead of failing. Ok, problem solved ;-) I have some comments below - can you comment on these? On 04/20/2018 12:01 AM, Minh Bui wrote: I am wondering if you have any recommendations for using iqtree to simply compute a likelihood and exit without performing optimizations. ... I see. However, IQ-TREE was designed for general users, and these barriers are there to avoid stupid mistakes. Those options seem very useful to safefguard users who want to perform optimization. Some users may occasionally want just a likelihood. As you have time, maybe you could optionally add a \"--likelihood-only\" option to add \"-keep-ident -blfix -vvv -redo -blmin 0.0000000000000001 -safe -n 0\" without removing the safeguards. I filed an issue about this. Ok I will add this. Not difficult anyway. Q1. Is there an existing option to show more precision in the likelihood? Unfortunately no, the precision of 3 is hard coded. You can, however, look at the checkpoint file (.ckp.gz). If you gunzip this file, it\u2019s in YAML format which will store all information you need, from the tree, log-likelihood to model parameters etc. So for example, the CandidateSet section: OK, I didn't know about the YAML. I could make the testsuite load and parse the YAML. However, for now I'm running iqtree with -vvv, which seems to make the initial likelihood printed to the standard output show more digits. I see, did not realised that ---vvv printed higher-precision numbers... Q2. If the user wants a likelihood, but does not want optimization, could you allow alignments with no variant characters? The command that I am using to check a JC96 model is: iqtree -s AT3.fasta -te AA3.tree -m JC69 -keep-ident -blfix I just checked a local run here (v1.6.3), and it works fine with such invariant sites only alignment. E.g: 4 4 T1 ACGT T2 ACGT T3 ACGT T4 ACGT So not sure what happened there... If you do 4 1 T1 A T2 A T3 A T4 A then it will fail with \"Only one state is observed in alignment\". If we could turn this off somehow (maybe under -n 0?) then that would be helpful. Ok, this check can be turned off if branch lengths are fixed (-blfix). Q3. Is this the right way to compute likelihoods for a fixed set of parameters? Yes it is. For models more complex than JC, you can specify and fix model parameters, see here: http://www.iqtree.org/doc/Advanced-Tutorial#user-defined-substitution-models Great! This is very helpful. I would like to specify GTR parameters on the command line. It seems that IQ-TREE complains if we add more than 5 parameters for GTR, and the 6th parameter is assumed to be 1.0: % iqtree -s ~/Work/5d-muscle.fasta -m \"GTR{0.2,0.2,0.2,0.2,0.2,0.0}\" ... ERROR: More than 5 rate parameters specified in 0.2,0.2,0.2,0.2,0.2,0.0 That\u2019s right. G-T is fixed at 1 because other rates are relative to G-T. But you are right \u2014 this disallows G-T rate to be 0. But that rarely happens in real data. Nevertheless, I will have a look at a workaround. Thanks for reporting this! I could reproduce this crash. Will have a look why\u2026 The testsuite is called testiphy, and I hope it is an opportunity for different projects to collaborate. Since iqtree implements a lot of models, it should be useful for checking if other software obtains the same likelihood. Q4. Does iqtree have an existing testsuite? We do have some test suite ( https://github.com/Cibiv/IQ-TREE/tree/master/test_scripts ) written in Python. But it only checks if the runs crashed or not, with various combination of options and test data. But it would be better, if it checks that the results are correct or not. I see. I will try to incorporate those data sets. Are you possibly interested in contributing test cases, or on collaborating on the testsuite below? I just had a quick look at testiphy. Seems like a good idea. However, Tung, the one who created the Python test script, left the project. What I can provide you right now is a bunch of alignments that caused bugs in IQ-TREE. This could represent hard test cases for other software as well. It should be possible to run the testsuite from travis-ci so that any changes pushed to are checked automatically. * see https://github.com/bredelings/BAli-Phy/blob/master/.travis.yml (uses meson) * see https://github.com/bredelings/BAli-Phy/blob/3.0.2/.travis.yml (uses autotools) You should also be able to run the testiphy testsuite from travis-ci if you like. I have integrated it into bali-phy as a git submodule, which allows specifying the git SHA of testiphy that will be used to test. I am running it as part of 'make check' or 'ninja test', but you can run it manually also. Cool, I will have a look at your tool once the other issues are fixed. Cheers Minh "]}, "_lp0aNY5taw": {"topic": "omp-1.5.4-beta 'kernel too old' error Linux", "initializeDate": "Mar 31, 2017, 3:46:58 PM", "timeStamp": "Mar 31, 2017, 4:51:08 PM", "content": ["To whom it may concern, From the release notes for IQ-tree version 1.5.4-beta: \"Resolved error about \"kernel too old\": Precompiled Linux binaries are now backward compatible with old Linux kernel 2.X.\" This only appears to be resolved at present for the sequential version. Are there plans to do so for the omp version in the forthcoming version also? This would be very helpful if so, as I am attempting to perform a model selection for a partitioned amino acid dataset and wished to compare the CAT family mixture models to standard site homogeneous models. Unfortunately, I do not have permission to update the kernel on the machine I am using, and using older IQ-tree-omp versions (e.g. v1.3.10) I found that the TESTMERGE function does not seem to perform the \"MERGE\" when also using the -madd command. Thank you in advance, Anthony ", "Dear Anthony, thanks for your attention! The official version will be released until Monday, where this problem will be fully resolved. So stay tuned ;-) Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Dear Minh, Wow, that's great! Look forward to testing it! Thank you, Anthony "]}, "eeKowr0ZOqQ": {"topic": "IQ-tree's method for least-squares AU implementation", "initializeDate": "Nov 23, 2017, 5:15:07 PM", "timeStamp": "Nov 24, 2017, 5:07:51 PM", "content": ["Hi, I wonder which method IQ-tree uses to minimise the least-squares function for 'c' and 'd' estimation (during AU test p-value calculation). Does it implement some kind of numeric method or is the function minimised in a more analytical manner? And which is it? Being an amateur programmer with relatively poor backgrounds in mathematics, I've been struggling to figure out the most efficient way to calculate 'c' and 'd' and would very much appreciate any hint. Thanks in advance, Lucas ", "Hi Lucas, There is a closed formula for this, which I implemented in IQ-TREE. Have a look at phylotesting.cpp. For your convenience I paste here the method (copied from the comments in the code): Problem: solve the following linear system equation: a_1*x + b_1*y = c_1 a_2*x + b_2*y = c_2 .... a_n*x + b_n*y = c_n becomes minimizing weighted least square: sum_k { w_k*[ c_k - (a_k*x + b_k*y) ]^2 } the solution is: x = [(sum_k w_k*b_k*c_k)*(sum_k w_k*a_k*b_k) - (sum_k w_k*a_k*c_k)(sum_k w_k*b_k^2)] / [ (sum_k w_k*a_k*b_k)^2 - (sum_k w_k*a_k^2)*(sum_k w_k*b_k^2) ] y = [(sum_k w_k*a_k*c_k)*(sum_k w_k*a_k*b_k) - (sum_k w_k*b_k*c_k)(sum_k w_k*a_k^2)] / [ (sum_k w_k*a_k*b_k)^2 - (sum_k w_k*a_k^2)*(sum_k w*k*b_k^2) ] @param n number of data points @param w weight vector of length n @param a a value vector of length n @param b b value vector of length n @param c c value vector of length n @param[out] x x-value @param[out] y y-value @return least square value Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Thanks for your quick reply, Minh. This will be very helpful. I'll take a close look at the code now. Best regards, Lucas "]}, "ND5-wbiXo-U": {"topic": "best partition scheme search with 1 model", "initializeDate": "Aug 24, 2017, 9:35:44 AM", "timeStamp": "Aug 29, 2017, 5:19:03 AM", "content": ["Hi everyone, I would like to find the best partition scheme for my dataset while performing the tree reconstruction. I found that the option -m TESTMERGE does it, for instance, but trying all possible models in a certain list of model. What if I would like to do this research but already knowing the model I need? I am working with complete fish mitochondrion so I want to impose MTREV as a subtition model. Thank you very much for your time Bests, Luana PhD student ", "Hi Luana, You are can option -mset to restrict the model list. In your case, simply add \u201c-mset MTREV\u201d into your command line. See also http://www.iqtree.org/doc/Command-Reference#automatic-model-selection Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hi ! I am also using IQ tree with a constraint tree and it seems that my job is stuck for 24 hours on the same step : Creating fast initial parsimony tree by random order stepwise addition... Does that mean that something is wrong or is it a long step ? I used IQ tree as follow : iqtree -s FcC_supermatrix.phy -spp partition_file.best_scheme -nt 4 -g constr_mcv4.newick -keep-ident Thank you for you time, Luana phD student "]}, "nELPRhDzZM8": {"topic": "AU test failed with version 1.4.4", "initializeDate": "Sep 20, 2016, 6:43:59 AM", "timeStamp": "Sep 20, 2016, 6:43:59 AM", "content": ["Dear Minh and all, I have a quite large dataset which I want to apply the AU test with 3 different topologies (IQtree 1.4.4) All my trials fail, with following last lines of the logfile (see below). Maybe the command is wrong? I'm also don't know if I really need -te (I was using te as input tree since parameters should be optimized using this one) and also not sure if -spp is too oversized along with gmedian, or is it just a command problem since I first have to invoke that sitelogLH are calculated ( so would this be correct instead: ... -wsl -zb 1000 -au?) I also tried it with -wsl but it still failes... Shall I send you the files? FcLM and siteloglh calculation is running well now! :) Thanks best Karen ##### Parameters optimization took 26 rounds (698.949 sec) WARNING: Estimated model parameters are at boundary that can cause numerical instability! BEST SCORE FOUND : -17465086.983 Total tree length: 9.616 Total number of iterations: 0 CPU time used for tree search: 0.020 sec (0h:0m:0s) Wall-clock time used for tree search: 0.021 sec (0h:0m:0s) Total CPU time used: 12008.776 sec (3h:20m:8s) Total wall-clock time used: 714.420 sec (0h:11m:54s) Reading trees in /flush2/meu00c/ANTLIO/DDD_aa_ AU/three_tree_topologies.tre ... 3 trees detected Note: 22867.427 MB of RAM required! Creating 10000 bootstrap replicates... STACK TRACE FOR DEBUGGING: 1 funcAbort() 2 () 3 memset() 4 Alignment::createBootstrapAlignment(int*, char const*, int*) 5 SuperAlignment::createBootstrapAlignment(int*, char const*, int*) 6 evaluateTrees(Params&, IQTree*, std::vector<TreeInfo, std::allocator<TreeInfo> >&, std::vector<int, std::allocator<int> >&) 7 reportPhyloAnalysis(Params&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, IQTree&, std::vector<ModelInfo, std::allocator<ModelInfo> >&) 8 runPhyloAnalysis(Params&, Checkpoint*) 9 main() 10 __libc_start_main() *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT *** For bug report please send to developers: *** Log file: ANLTIO_DDD_aa_AU_fixtre01.log *** Alignment files (if possible) /cm/local/apps/slurm/var/spool/job1795200/slurm_script: line 12: 162032 Segmentation fault iqtree -nt 20 -st AA -s DDD_aa_mare.fas -spp DDD_aa_mare.partitions.nex -pre ANLTIO_AU_fixtre01 -te best_tree_boridae_nannoplusfleas_pistil_01.tre -gmedian -z three_tree_topologies.tre -zb 10000 -au "]}, "Pfszf_dQGcg": {"topic": "Morphological tree search", "initializeDate": "Jul 11, 2017, 9:36:38 AM", "timeStamp": "Jul 14, 2017, 8:15:48 AM", "content": ["Hi, I am attempting to estimate a phylogeny based on morphological data on IQ-tree. The analyses run but when I try independent runs the optimal tree is not converging on the same likelihood (i.e, some have better and some have worse final likelihoods). My input is shown here: iqtree -s morpho.phy -m MK+ASC+G -pers 0.1 -nstop 2000 -ntop 1000 -ninit 5000 Looking at the 'log' files it appears the searches find a local optimum at the start of the run and tend to stay there. I have altered the values of -pers from around (0.1 to 0.9) and increased the limit of -nstop and -ninit for different runs, and then run multiple searches with identical values. Would anyone be able to offer any suggestions? Thanks, Mark ", "Dear Mark, This sounds like your alignment does not have enough phylogenetic signals \u2026 What is the size of your alignment (#sequences, #sites)? It\u2019s difficult to analyze such data and the problem of local optima is quite well known (not specific to IQ-TREE but also other ML software). In fact, we recommended to repeat several runs and what you did sounds good to me. Then you can take the tree with highest likelihood out of those runs. You can also do the tree topology tests for all resulting trees, and compute the strict consensus tree of trees that passed the test, which can be more stable. If you have other sequences (e.g. ribosomal RNAs) for the same species set, then you can add them into the analysis, so that you have more phylogenetic information. Hope that helps a little bit, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "xjxjyr-ybFo": {"topic": "invalid alignment file?", "initializeDate": "Jul 30, 2018, 5:56:37 AM", "timeStamp": "Sep 17, 2018, 5:05:28 AM", "content": ["Dear madam/sir I tried to run Iqtree today. At first it seemed to work, but not progress was reported, when I cancelled my analysis and retried it I got the message that my aln file was invalid. It worked previously. in the input data I saw a strange name for the path to my file. I read c:/fakepath/filename.fas What did I do wrong? Is there a reset buton the reset the search and restart? Kind regards Floris ", "Hi Floris, Thanks for reporting this. I also realised something wrong with the IQ-TREE web server ( iqtree.cibiv.univie.ac.at ) yesterday and already asked the Admin about this. Currently it\u2019s not clear why so. I\u2019ll send another email once this is resolved. So I think there is nothing wrong with your alignment. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "I am having the same issue. I am attempting to use the web server interface but when I try to submit the job it quickly fails and read \"...aln_file invalid...\" Not sure what this means. My input files are in phylip format which is supported by IQtree. If any of you found a solution please let me know. ", "I am also having the same issue. I've tried both a phylip and fasta file, and both give me the same \"...aln_file invalid...\" response. I'm not sure what the problem is.. ", "I switched over to running the program via the command line in my terminal window and it works much better. I recommend not using the web server interface and using the command line. ", "That's what I am going to do as well. Thanks! ", "Hi there, this problem is forwarded to the Admin, who will hopefully solve it soon. Thanks for the report! Minh ", "The problem at the IQTREE web interface has now been fixed. Thus, the web interface at CIBIV is now working again. Best regards, Heiko Schmidt ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- "]}, "C-oFh9KaQHY": {"topic": "Adding SH-aLRT after the tree has been inferred?", "initializeDate": "Mar 2, 2021, 11:41:07 PM", "timeStamp": "Mar 3, 2021, 7:32:06 AM", "content": ["Hi, I was wondering if it is possible to add SH-aLRT to a tree that has already been inferred, or do I have to rerun the entire analysis again and add the -alrt flag? Thanks, Miles ", "Hi Miles, Yes you can annotate SH-aLRT values onto an existing tree, provided that this tree is bifurcating. If so, use -te option to provide a fixed user tree topology, a simple analysis is something like: iqtree -s ALN_FILE -te TREE_FILE -alrt 1000 should do the job. You might want to specify a model to speed up the analysis (by skipping ModelFinder). Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/67ef74ff-9aca-4833-8cc4-4f678d183c20n%40googlegroups.com ", "Perfect thank you very much for the quick response! Best, Miles "]}, "VvH2lO6sfNw": {"topic": "Trouble in running iqtree on intel KNL and other cluster environment", "initializeDate": "Sep 26, 2018, 1:50:19 AM", "timeStamp": "Sep 26, 2018, 7:00:35 PM", "content": ["Dear Iqtree team, I have compiled IQ-TREE MPI multicore Xeon Phi KNL version 1.6.7.1 for Linux and it generated 64-bit version of iqtree-mpi executable. I have furnished the output and error below. I wonder iqtree detects kernel and RAM (AVX512, FMA3, 94 GB RAM) but failed to use it. instead iqtree looking for (Memory required per CPU-core (0.562501 GB) is higher than your computer RAM per CPU-core (0 GB), hence fails with segmentation fault. how to overcome this problem. ************************************************ * START TREE SEARCH USING MPI WITH 1 PROCESSES * ************************************************ IQ-TREE MPI multicore Xeon Phi KNL version 1.6.7.1 for Linux 64-bit built Sep 25 2018 Host: nid00228 (AVX512, FMA3, 94 GB RAM) Command: /home/staff/bio/biosilva/Cray_XC40/Software/IQ-TREE/ 1.6.7.1/int/17.0.4/bin/iqtree-mpi -s /mnt/lustre/bio/biosilva/September/25/nr_J-protein_subfamily_final.msa -m JTT+G4 -safe -quiet -bb 2000 Kernel: Safe AVX-512 - 1 threads (256 CPU cores detected) ************************************************ NOTE: 576 MB RAM (0 GB) is required! WARNING: Memory required per CPU-core (0.562501 GB) is higher than your computer RAM per CPU-core (0 GB), thus multiple runs may exceed RAM! ##################### ERROR #################### ERROR: STACK TRACE FOR DEBUGGING: ERROR: 2 () ERROR: 3 _IO_vfscanf() ERROR: 4 fscanf() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: /mnt/lustre/bio/biosilva/September/25/nr_J-protein_subfamily_final.msa.log ERROR: *** Alignment files (if possible) ERROR: STACK TRACE FOR DEBUGGING: ERROR: 2 () ERROR: 3 _IO_vfscanf() ERROR: 4 fscanf() ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: /mnt/lustre/bio/biosilva/September/25/nr_J-protein_subfamily_final.msa.log ERROR: *** Alignment files (if possible) [NID 00231] 2018-09-25 23:08:20 Apid 680628: initiated application termination Thanks Vignesh ", "Hi Vignesh, I found a segfault bug in the KNL parsimony kernel. Thus, can you please disable KNL by option \"-lk FMA\u201d. Let me know if it works. Thanks! Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "pSHjozmyPmM": {"topic": "OpenMPI with ModelFinder", "initializeDate": "Apr 1, 2021, 4:02:58 PM", "timeStamp": "Apr 23, 2021, 6:31:03 PM\u00a0(4 days ago)\u00a0", "content": ["Good afternoon, I have been trying to construct a concatenated phylogeny to use in a concordance factor analysis for months. After getting multiple time-out and out-of-memory errors, I moved to compiling the MPI version of IQ-Tree to use on the HPC at my university. When I finally got the job to run in parallel on multiple nodes, it stopped from an MPI error saying ModelFinder cannot be used with IQ-Tree. Is there a way around this, or a different way to run in parallel? I have 57 taxa and 5288 partitions. Here is my script: #!/bin/bash #SBATCH --job-name=iqtree_squamates_concat.sh #SBATCH --mem-per-cpu = 2000 #SBATCH --ntasks=28 #SBATCH --time=14-00:00 module load anaconda3 module load openmpi conda activate iqtree mpirun iqtree2-mpi -s concatenated.out -p partitions.txt -st DNA --prefix ../iqtree/concat -alrt 10000 -m TESTMERGE* -T* AUTO ", "Hi! I went through the same issue. I ran many analyses but all times I got the same message: \"Error: please use only 1 MPI process...\". Searching in some IQ-Tree google groups, I found that model selection doesn't work with the MPI option (See attached image), and that the best option is to perform the analysis in two steps (model selection first, and then the tree inference). So, I ran a test analysis of just the model with the following script and it worked!!!: ----------------------------------------------------------------------------------------------------------------------------------------------------------- #BSUB -q q_htc #BSUB -n 24 #BSUB -m g3_a #BSUB -R \"span[hosts=1]\" #BSUB -eo modeltest.err #BSUB -oo modeltest.out module load iqtree iqtree-mpi* -s modeltest.phy -st DNA -spp set_partitions.nex -pre modeltest -m TESTMERGEONLY ----------------------------------------------------------------------------------------------------------------------------------------------------------- *Note that when typing the IQ-Tree command-line, you only have to set iqtree-mpi I hope this information is clear and helpful!!! Chers, Rub\u00e9n ", "Hi Ruben, That was super helpful, thank you!! Simone Gable Ph.D. Student Tollis Lab smg...@nau.edu Northern Arizona University School of Informatics, Computing & Cyber Systems tollislab.org/ You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/pSHjozmyPmM/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2fc3dc78-d1a2-4762-97ca-f6e7ccdc0113n%40googlegroups.com "]}, "ZcYvOFiGnsw": {"topic": "Question with morhology", "initializeDate": "Mar 16, 2016, 4:24:05 PM", "timeStamp": "Mar 16, 2016, 5:30:50 PM", "content": ["Hello IQTREE team, First off, I really appreciate this software and the work you do. I am trying to format a morphological dataset for use in IQTREE, but whatever I do I run into issues. I believe the problem is that some of my character states are coded as polymorphic (e.g. if the available states are 0, 1, and 2, and I observe 1 &2 on a specimen I have been coding it as (12), see attached .phy file. However, regardless of if I try it in Nexus or Phylip format, I get error messages. I am wondering how to code these polymorphisms so that IQTREE can handle it. Also. on a related note, I just wnated to confirm that to run an analysis with a DNA partition and a Morphological partition, I need to keep them in separate .phy files. Thanks, Gavin ", "Dear Gavin, thanks for your interest. And you are right, these polymorphic states are not supported, as iqtree issued an error message: ERROR: Line 5: Unrecognized character ( I assume that `(02)` corresponds to an ambiguous state of either 0 and 2. In fact this file is not defined in Phylip format. I am not sure if this is also supported in nexus format? If you point us to a documentation where such format is described, then we may start to consider such feature. Note, however, this is not trivial to implement. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "09kqSCtCrKc": {"topic": "Constraint tree - A way to consider branch length ?", "initializeDate": "Oct 6, 2018, 6:33:53 AM", "timeStamp": "Oct 20, 2018, 4:05:53 AM", "content": ["Hi all, I am aiming to generate a topogy based on a single gene but constraining the backbone thanks to previous analysis based on genomic data. I figured out the constraints concern only the topology and not the branch length. My question is : is there any way to fix these branchlengths with IQTREE ? (or any way you would think of) Any insights would be appreciated! Thanks, Pierre ", "Hi Pierre, On 6 Oct 2018, at 8:33 pm, Pierre Arnal < pierre...@gmail.com > wrote: Hi all, I am aiming to generate a topogy based on a single gene but constraining the backbone thanks to previous analysis based on genomic data. I figured out the constraints concern only the topology and not the branch length. That\u2019s right. My question is : is there any way to fix these branchlengths with IQTREE ? (or any way you would think of) Does your \u201cconstraint\u201d tree contain all taxa? If so, you can input it via -te <TREE_FILE> option and also -blfix to fix branch lengths of the input tree. If your constraint tree contains fewer taxa, then you can reduce the sequences in the alignment to match this tree and run the analysis like above. Is this what you intended to do? Cheers Minh Any insights would be appreciated! Thanks, Pierre You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, First of all, thanks for your help. The topology, includind branch lengths, I wish to fix does not contain all the species of my second alignment. I would like to fix that first topology to then estimate the position of the others species, for which I don't have genomic data. I was wondering if there is a way not to use a supermatrix approach and I was thinking fixing topology would be a solution. Did I make the draw clearer ? Cheers, Pierre ", "Ah I see, so you want to do some kind of evolutionary placement, right? Since the branch lengths were estimated from genomic data, it\u2019s not sensible to fix these branch lengths for the single gene\u2026 so I would only constrain the topology. Please also do an unconstrained analysis and a tree topology test between two resulting trees, to make sure that the constrained tree is not significantly worse than the unconstrained tree. Does that make sense? Minh ", "I did not know that method but it may be what I wish to do. Is there a tools developped in IQTREE to do so ? Otherwise, do you have any soft to advice ? ", "Hi Pierre, Unfortunately it\u2019s not clear to me what you want to do, and what are your input data for this. What was the command line you ran? Minh "]}, "eTLiuvDt-WI": {"topic": "Marginalization of missing taxa in partitions", "initializeDate": "May 1, 2018, 10:57:45 PM", "timeStamp": "May 2, 2018, 1:48:49 AM", "content": ["Hi guys, First, I would just like to confirm if IQ-TREE marginalizes over missing data, in partitions where some taxa are entirely absent (e.g. genes were not sequenced for that taxa). If IQ-TREE does marginalize, do you have any information about how this would affect the likelihood and branch length estimation for that partition? Best, Nat Walker-Hale ", "Dear Nat, I don\u2019t know what do you mean by \u201cmarginalise\u201d? There is a FAQ about this, which may help: http://www.iqtree.org/doc/Frequently-Asked-Questions#how-does-iq-tree-treat-gapmissingambiguous-characters Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "xiZrtQUWyv4": {"topic": "Option to NOT draw root on tree?", "initializeDate": "Mar 27, 2019, 1:01:25 PM", "timeStamp": "Mar 28, 2019, 6:21:29 PM", "content": ["I am very new to IQ-TREE and phylogenetics in general so apologies if this is a very obvious question. My understanding of IQ-TREE is that it will always draw an \"outgroup\" at the root, even if you have not specified one with the '-o' flag. By default, the program will use the first sequence in the input alignment file. My dataset has no outgroup as all taxa are closely related. For variant identification I simply picked one taxon to use as my reference. When I look at the IQ-TREE .treefile I can clearly see that this reference is being used as the outgroup and is drawn at the root. I find this misleading since this taxon should be clustered together with other taxa within a specific clade (I see this with FastTree which does not draw a root). I guess I'm confused as to why a root is needed to be drawn in IQ-TREE. Is there an option to produce a truly unrooted .treefile or will the program always draw an \"outgroup\" at the root? ", "Dear whatever-your-name-is, Thank you for your interest in IQ-Tree. > On 27 Mar 2019, at 18:01, eam < eamil...@gmail.com > wrote: > I am very new to IQ-TREE and phylogenetics in general so apologies if this is a very obvious question. My understanding of IQ-TREE is that it will always draw an \"outgroup\" at the root, even if you have not specified one with the '-o' flag. By default, the program will use the first sequence in the input alignment file. > My dataset has no outgroup as all taxa are closely related. For variant identification I simply picked one taxon to use as my reference. When I look at the IQ-TREE .treefile I can clearly see that this reference is being used as the outgroup and is drawn at the root. I find this misleading since this taxon should be clustered together with other taxa within a specific clade (I see this with FastTree which does not draw a root). Most of this was already answered in https://groups.google.com/d/msg/iqtree/zB8rWXCP7bk/J55N4gZ-CgAJ Both, IQ-Tree and FastTree write out unrooted trees (IQ-Tree states this explicitly in the Manual and output log/iqtree-file). The Newick string in the treefiles just looks rooted because for writing the tree to file every program has to start at some point in the tree. Please note, that IQ-Tree itself, does not \u2018draw\u2019 trees, but writes them in a 'text graphic\u2019 just to have some means to see the tree to have a quick look. To actually draw a tree, you need to use a tree-drawing program like FigTree. FigTree has also different options to draw the tree in an unrooted manner (3rd button on the top left). > I guess I'm confused as to why a root is needed to be drawn in IQ-TREE. Is there an option to produce a truly unrooted .treefile or will the program always draw an \"outgroup\" at the root? IQ-Tree exactly does write out an unrooted tree. A tree is unrooted by convention if the Newick string (e.g. in there treefile has (at least) 3 components in the outer bracket (IQ-Tree typically has 3 in there, one being what you identify as the outgroup or root, which is just the starting point to write out the tree. BTW this is exactly the same for FastTree - it also writes the tree starting from the first sequence from the alignment which is written first in the treefile, just the order of the two other components might be different which does not change the tree. If the treefile is rooted, the outer bracket would have only 2 components which are the two subtrees starting from the root. As mentioned above, there is no way to \u2018draw' trees in a star-like fashion in a text file (as the above mentioned button would cause FigTree to do) because you cannot draw lines or rotate labels in a pure text file. I hope that clarifies the misunderstanding and confusion. Best wishes, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Heiko, Thank you for your reply. My apologies, I am totally misusing the term \"root\". I do understand that IQ-TREEs trees are unrooted and that they just look rooted because of the way they are drawn in tree drawing programs such as FigTree. My question has to do with including an outgroup. Why does IQ-TREE always include an outgroup and is there a way to \"tell\" IQ-TREE not to write one to the treefile ? I do not want the first sequence in my alignment file to be an outgroup. Thank you, Eam ", "Dear Eam, I actually still do not understand the problem. IQ-TREE does not write \u2018an outgroup\u2019 into the tree. As I said every program has to start somewhere in the tree structure to write it to file. This has no implication whatsoever on the tree structure itself, which is by definition unrooted. You as a user have to tell the tree drawing program where to root the tree or to use an unrooted view. Otherwise, e.g. FigTree will draw the outermost bracket to the left. Interpreting anything into what is drawn left in the tree mis-interprets the tree and ignores the explicit messages that the tree is unrooted - and has, thus, to be interpreted as such! \u2026no matter which sequence name occurs first in the Newick string in the tree-file. Just as an example, all the following Newick strings encode the very same unrooted tree. Just the starting points to write them to file differs. All of the start at an internal node, where three branches of the the trees originate which represent the three components (separated by commas and maybe encapsulated in brackets as well if they contain more than one sequence name) in the outer bracket. ((A:0.10,B:0.11):0.13,(C:0.14,D:0.15):0.16,(E:0.17,F:0.18):0.19); (A:0.10,B:0.11,((C:0.14,D:0.15):0.16,(E:0.17,F:0.18):0.19):0.13); (C:0.14,((E:0.17,F:0.18):0.19,(A:0.10,B:0.11):0.13):0.16,D:0.15); (A:0.10,((C:0.14,D:0.15):0.16,(E:0.17,F:0.18):0.19):0.13,B:0.11); (((C:0.14,D:0.15):0.16,(E:0.17,F:0.18):0.19):0.13,B:0.11,A:0.10); ((A:0.10,B:0.11):0.13,(E:0.17,F:0.18):0.19,(C:0.14,D:0.15):0.16); (((E:0.17,F:0.18):0.19,(A:0.10,B:0.11):0.13):0.16,C:0.14,D:0.15); And there are many many more, because you can swap neighbouring components without changing the structure of the unrooted tree (because that just represents flipping two neighbouring subtrees - the trees are still isomorphic)! You may just copy these into a treefile, open it in FigTree, press the \u201cradial tree\u201d button (3rd button under Layout). Then you can flip trough the trees and you will see that they all represent the same tree topology - just compare which taxa group and what their branch lengths are. This would be different in the following, now rooted tree: (A:0.05,(B:0.11,((C:0.14,D:0.15):0.16,(E:0.17,F:0.18):0.19):0.13):0.05); Because the basal bifurcation between A and the rest of the tree, now introduces an additional node - the root. Here it would make a difference whether the node in the first position is A or another one. A side note - looking at the 7 trees at the top shows that it is difficult to recognise whether two tree string represent the same tree or not. For this reason, TREE-PUZZLE had introduces an ordering of the leafs and subtrees, such that a subtree or leaf is listed earlier if it contains a taxon occurring earlier in the alignment file. This way two tree strings are the same if the tree topologies (and the branch lengths) are the same. Even if the branch lengths are different, it is still relatively easy to recognise whether the topology is the same. Seamingly, IQ-Tree (and maybe other programs) uses the same ordering. But again this has no implications on the tree structure which remains unchanged and unrooted. And you can order the subtrees anyway you like, e.g. in FigTree by marking a branch and then press the \u201crotate\u201d button. And then you write it to file in the graphics format you prefer (like PDF). But this is part of the job of the authors preparing the figures for publications, because only they know whether, if and why subtrees might have to be rotated, although that does not change the tree itself. I typically only do that to, e.g., make comparison of trees easier. I hope helps, Heiko > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To post to this group, send email to iqt...@googlegroups.com > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout "]}, "CKrGoXuWY4I": {"topic": "bug fix release 1.3.8", "initializeDate": "Aug 26, 2015, 5:57:38 PM", "timeStamp": "Aug 26, 2015, 5:57:38 PM", "content": ["Dear all, we just released version 1.3.8: August 26, 2015: Bug-fix version 1.3.8 is released: A bug introduced in 1.3.7 when using two options \"-m TEST\" (model testing) and -spp/-spj (edge-linked partition model) within one run. So if you use this feature please download the new version. Sorry for the inconvenience Minh "]}, "BheJcZcApAg": {"topic": "incomplete sequencences", "initializeDate": "May 14, 2019, 4:23:32 AM", "timeStamp": "May 15, 2019, 9:39:09 PM", "content": ["Good morning everyone, I have a question for all the IqTree experts about a problem that I'm facing during these days. I'm building some phylogenetic trees using protein sequences coming from viruses, I started to use IqTree instead of MEGA because it tooks me a lot less for model selection and tree construction with the web server. When I was using MEGA, I used to produce alignments that were submitted to build a tree with a function active that allows to use only the conserved sites excluding gaps and ambiguous sites during tree construction. The question is: do Iqtree adjust somehow sequnence lenght and gaps in the alignment? I saw that there is a gap/ambiguity extimation at the beginning of the model extimation, what happen if the sequence fail that step? I could of course export the alignment keeping only the conserved sites, but I'm curious to understand if the algorithm can handle these situations. Indeed this question come from the fact that when I figured that I was not exporting the alignment without taking away the gaps I already had some tree built this way, and actually the resulted tree seems to be closer to the one I tried to build with MEGA than the tree resulted from the Iqtree analysis with the alignment containing just conserved sites. Thank you for your help, I'm neither a native speaker or an expert in the field so sorry for mistakes or basic/stupid question. Marco ", "Hi Marco, On 14 May 2019, at 4:23 pm, Marco Forgia < marco....@unito.it > wrote: Good morning everyone, I have a question for all the IqTree experts about a problem that I'm facing during these days. I'm building some phylogenetic trees using protein sequences coming from viruses, I started to use IqTree instead of MEGA because it tooks me a lot less for model selection and tree construction with the web server. When I was using MEGA, I used to produce alignments that were submitted to build a tree with a function active that allows to use only the conserved sites excluding gaps and ambiguous sites during tree construction. The question is: do Iqtree adjust somehow sequnence lenght and gaps in the alignment? No! IQ-TREE takes the input alignment as it is. I saw that there is a gap/ambiguity extimation at the beginning of the model extimation, what happen if the sequence fail that step? Nothing happens. IQ-TREE will continue the analysis. It serves mainly as a warning. Some users may find that useful. I could of course export the alignment keeping only the conserved sites, but I'm curious to understand if the algorithm can handle these situations. Yes, you can of course filter that in MEGA and then inputs to IQ-TREE. Indeed this question come from the fact that when I figured that I was not exporting the alignment without taking away the gaps I already had some tree built this way, and actually the resulted tree seems to be closer to the one I tried to build with MEGA than the tree resulted from the Iqtree analysis with the alignment containing just conserved sites. Thank you for your help, I'm neither a native speaker or an expert in the field so sorry for mistakes or basic/stupid question. No worries, it\u2019s the purpose of the forum. Does that answer your questions? Minh Marco You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7feaa477-8ee0-4169-804a-98b7d23d6394%40googlegroups.com For more options, visit https://groups.google.com/d/optout "]}, "87z7OYxP68o": {"topic": "Readable Publication Trees with Support Values along Branches?", "initializeDate": "Feb 22, 2017, 12:32:36 PM", "timeStamp": "Feb 23, 2017, 6:26:48 PM", "content": ["I am using IQTree run locally. I have tried visualizing the resulting trees with several standard tree display programs (Archaeopteryx, Dendroscope, NJPlot, TreeExplorer,TreeView). Of these, all seem to only show support at the nodes except NJPlot, which shows support along the branches. This is what I want for publication figures. However, when NJPlot produces a PDF file, all the results are crammed onto a single page with a border around it. For larger trees (i.e. several hundred taxa), this makes them too small to be readable. Can anyone recommend a display program which can show support values along the branches, and which can also produce an output file which is formatted so that it still remains readable for a larger tree? ", "Have you tried Treegraph ( http://treegraph.bioinfweb.info ) it has facility to show support values on branches and gives a better/proper output. You probably will have to sit with the programme for some time to get a hang.... Siby Philip. On Wed, 22 Feb 2017 11:02 pm 'David Kerk' via IQ-TREE, < iqt...@googlegroups.com > wrote: I am using IQTree run locally. I have tried visualizing the resulting trees with several standard tree display programs (Archaeopteryx, Dendroscope, NJPlot, TreeExplorer,TreeView). Of these, all seem to only show support at the nodes except NJPlot, which shows support along the branches. This is what I want for publication figures. However, when NJPlot produces a PDF file, all the results are crammed onto a single page with a border around it. For larger trees (i.e. several hundred taxa), this makes them too small to be readable. Can anyone recommend a display program which can show support values along the branches, and which can also produce an output file which is formatted so that it still remains readable for a larger tree? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "And you should definitely consider Figtree ( http://tree.bio.ed.ac.uk/software/figtree/ ) by Andrew Rambaut. It has a lot of features. Among them placing the support values along the branches or on the node tip-wards of the branch they belong to. Best regards, Heiko ", "Thanks to Philip and Heiko for recommendations on tree visualization programs! Best, Dave Kerk On Wednesday, February 22, 2017 11:19 AM, Heiko Schmidt < heiko....@univie.ac.at > wrote: And you should definitely consider Figtree ( http://tree.bio.ed.ac.uk/software/figtree/ ) by Andrew Rambaut. It has a lot of features. Among them placing the support values along the branches or on the node tip-wards of the branch they belong to. Best regards, Heiko > On 22 Feb 2017, at 19:06, Philip Siby < phi...@nirmalagiricollege.ac.in > wrote: > Have you tried Treegraph ( http://treegraph.bioinfweb.info ) it has facility to show support values on branches and gives a better/proper output. You probably will have to sit with the programme for some time to get a hang.... > Siby Philip. > On Wed, 22 Feb 2017 11:02 pm 'David Kerk' via IQ-TREE, < iqt...@googlegroups.com > wrote: > I am using IQTree run locally. I have tried visualizing the resulting trees with several standard tree display programs (Archaeopteryx, Dendroscope, NJPlot, TreeExplorer,TreeView). Of these, all seem to only show support at the nodes except NJPlot, which shows support along the branches. This is what I want for publication figures. However, when NJPlot produces a PDF file, all the results are crammed onto a single page with a border around it. For larger trees (i.e. several hundred taxa), this makes them too small to be readable. > Can anyone recommend a display program which can show support values along the branches, and which can also produce an output file which is formatted so that it still remains readable for a larger tree? > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+ unsub...@googlegroups.com. > To post to this group, send email to iqt...@googlegroups.com. > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+ unsub...@googlegroups.com. > To post to this group, send email to iqt...@googlegroups.com. > Visit this group at https://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/87z7OYxP68o/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+ unsub...@googlegroups.com. "]}, "eGHzPPrehgI": {"topic": "input for ASTRAL", "initializeDate": "Jan 20, 2020, 10:52:09 AM", "timeStamp": "Jan 22, 2020, 6:58:13 PM", "content": ["Hi Minh, I would like to use IQ-TREE to construct gene trees for input to ASTRAL. I have a directory of alignment files I wish to use as input. I ran IQ-TREE using the -S option, and the program crashed with a segmentation fault. Looking back at the individual alignment files I see that each consists of 34 taxa. However, some taxa in each alignment are composed entirely of missing data. Perhaps this is what's causing the crash? I am wondering how to deal with this issue, other than manually going through >3000 alignments deleting taxa with all missing data. Any suggestions would be great. Best wishes, Chris ", "Hi Chris, Thanks for the report. -S is a new option and may still not work with all options. Can you pls paste the command line and send me the log file? Please note that I\u2019m away until 10 Feb, which will result in delayed response. So my suggestion for now is to avoid this option, and manually run IQ-TREE for each alignment in the directory (e.g. with a for loop in bash under Linux). Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/86e54d94-bed0-496f-8a27-394b60436b6e%40googlegroups.com ", "Hi Minh, Here is the log file. This is the command I used: /home/cblair/programs/IQTREE_2.x/iqtree-2.0-rc1-Linux/bin/iqtree -S Alignments_80_final --prefix loci -T AUTO >> IQTREE_anguids_GeneTrees.out Best wishes, Chris On Tuesday, 21 January 2020 19:43:57 UTC-5, Minh Bui wrote: Hi Chris, Thanks for the report. -S is a new option and may still not work with all options. Can you pls paste the command line and send me the log file? Please note that I\u2019m away until 10 Feb, which will result in delayed response. So my suggestion for now is to avoid this option, and manually run IQ-TREE for each alignment in the directory (e.g. with a for loop in bash under Linux). Cheers, Minh On 20 Jan 2020, at 10:52 pm, chris blair < blai...@gmail.com > wrote: Hi Minh, I would like to use IQ-TREE to construct gene trees for input to ASTRAL. I have a directory of alignment files I wish to use as input. I ran IQ-TREE using the -S option, and the program crashed with a segmentation fault. Looking back at the individual alignment files I see that each consists of 34 taxa. However, some taxa in each alignment are composed entirely of missing data. Perhaps this is what's causing the crash? I am wondering how to deal with this issue, other than manually going through >3000 alignments deleting taxa with all missing data. Any suggestions would be great. Best wishes, Chris You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "T-TGI3G2cPA": {"topic": "Theoretical basis for bootstrap analysis \"failure to converge\"", "initializeDate": "Jul 1, 2019, 2:41:45 PM", "timeStamp": "Jul 2, 2019, 11:48:47 AM", "content": ["Greetings; this is a theoretical rather than operational query. Whenever I run IQ-Tree, I do so with ultra-fast bootstrapping under the -bnni option (just on the off-chance that there is a severe model violation). I receive an error message stating that the bootstrap analysis failed to converge, and a suggestion that I increase the number of iterations to compensate for this. Upon researching the question, I have learned that when using -bnni option, this error can be safely ignored . However, I would like to understand why. What is meant by \"convergence\" in the context of maximum likelihood? And why is it permissible to ignore this error message when running IQ-Tree with -bnni, but not otherwise? Thanks for your time! Regards, Zach ", "Hi Zach, This is a bit long to explain. The UFBoot assesses convergence in the support values as follows. Let\u2019s say at the search iteration 200, we gather the set of all bootstrap trees: S_200, which induces a set of splits (branches) and their occurence frequencies among the boostrap trees. The occurence frequencies are compared with those of S_100 (from iteration 100): if the correlation coefficient is >0.99, we say that UFBoot converges and stops. Now with the new option -bnni in UFBoot2, the set S_200 is \u201crefined\u201d (with NNI, see details in https://www.ncbi.nlm.nih.gov/pubmed/29077904 ), resulting in a modified set of trees S\u2019_200. The WARNING is not correct, because we computed the correlation between S_100 and S\u2019_200, which might be <0.99 and thus wrongly reported as not convergence. This is the behaviour up to version 1.6.10. Therefore in the latest version 1.6.11, we fixes this by now reporting the correlation between S_100 and S_200. Thus, the WARNING should not appear anymore, if the bootstrap values indeed converged. Hope that answers your question. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0f61891d-2fb9-4436-b41a-7d172d6b772c%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Good morning Dr. Minh, thank you; that was exactly the sort of explanation that I was looking for. I will let you know if I am in need of any further clarification regarding this warning from UFBoot. Regards, Zach To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5567A329-F649-4047-9B09-54FD631305B6%40univie.ac.at "]}, "tinLluF3N6U": {"topic": "Constraint tree (-g) not obeyed", "initializeDate": "May 30, 2020, 3:22:35 PM", "timeStamp": "Jun 2, 2020, 12:48:11 AM", "content": ["I've double checked this using a couple different ways (including using a stringfinder to grab clades as well as checking by eye in TreeGraph): I'm using a well-supported multifurcating constraint tree (-g) with an alignment representing a small subset of the original sites plus a handful of additional leaves (-s). However, one of the major groups in the constraint tree is paraphyletic in the resultant tree. I am using version 2.0.5 of IQTree. Thanks! ", "Hi there, I believe the constraint tree option is correctly implemented. It sounds like some confusion re. unrooted / rooted tree here. The constraint tree will be unrooted, even if you provide a rooted tree. So if you reroot the resulting tree in another place, these groups may become monophyletic again. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/8c99b519-95e1-4227-9513-ff4525b1e71d%40googlegroups.com ", "Thank you, I did try both a rooted and unrooted constraint tree. I also attempted a reroot of the resulting tree at the end just to make sure that wasn't the issue. It is still causing paraphyly though. It behaves fine when I run the constraint tree with the alignment I used to make it + 10 additional sequences. It's only when I run it with a vastly different site set that it misbehaves. On Saturday, May 30, 2020 at 5:24:40 PM UTC-7, Minh Bui wrote: Hi there, I believe the constraint tree option is correctly implemented. It sounds like some confusion re. unrooted / rooted tree here. The constraint tree will be unrooted, even if you provide a rooted tree. So if you reroot the resulting tree in another place, these groups may become monophyletic again. Cheers Minh On 31 May 2020, at 5:22 am, Ajna R < ajn...@gmail.com > wrote: I've double checked this using a couple different ways (including using a stringfinder to grab clades as well as checking by eye in TreeGraph): I'm using a well-supported multifurcating constraint tree (-g) with an alignment representing a small subset of the original sites plus a handful of additional leaves (-s). However, one of the major groups in the constraint tree is paraphyletic in the resultant tree. I am using version 2.0.5 of IQTree. Thanks! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Alright. Still, I can\u2019t really support with this decriptive information. Please explicity paste the constraint tree and the resulting tree here, as you normally visualise them with tree viewer software. And point out where the doubt is. Thanks Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ff4a52b9-d323-4cf4-a804-75b171b1b2ed%40googlegroups.com ", "I just reran it specifying an outgroup and it's working perfectly now. I must have just had something janky in my original command that I overlooked that I likely propogated into each new run. Thank you for all your help! Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ff4a52b9-d323-4cf4-a804-75b171b1b2ed%40googlegroups.com "]}, "OlyWcIbyux0": {"topic": "Why does iqtree not like / in sequence names?", "initializeDate": "Jul 2, 2018, 3:49:18 AM", "timeStamp": "Jul 2, 2018, 10:58:58 PM", "content": ["Hi, I'm wondering why iqtree doesn't like / in sequence names and if this can be changed in a future release? Influenza uses / to separate information in the sequence title like A/chicken/Spain/1234/2018 but they all get replaced by underscores by iqtree. I can open the *.treefile with a text editor and replace all _ with / to put it back but it would be nice not to have to. Thanks James ", "I just saw the release notes for 1.6.6 I haven't tried it yet but sounds like you've already fixed this. Thanks James ", "Hi James, The character replacement will still occur with v1.6.6. The deep reason is because internally IQ-TREE uses BIONJ code to infer a neighbor-joining tree, and this code does not like such characters\u2026 since several users asked about this, we look at it in a future release (but not with high priority as this is not a bug). Under Linux or Mac OS, you can use a command line to replace _ by / using, for example, sed command: sed \u2019s/_/\\//g\u2019 TREEFILE Thanks for your understanding, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "qpAyooApcDA": {"topic": "ModelFinder is much slower than PartitionFinder2", "initializeDate": "Jan 23, 2020, 6:51:19 PM", "timeStamp": "Mar 6, 2020, 6:27:28 PM", "content": ["I set up a ModelFinder analysis on my phylogenomic dataset that should mimic settings I used in PartitionFinder2. The PF2 analysis finished in 1.5 days using 72 cpus. The MF analysis, in contrast, was still running after 2 days and the estimated amount of time remaining kept increasing (> 2,000 hours). I have generally found the MF analysis available in IQTree to be much slower than PF2 and I am curious to know why that is and if there is a fix in the works or if I am setting up the analysis incorrectly. For some background, my dataset has 283 taxa, 694198 bp, and 5423 partitions. To reduce analysis time, I used the rclusterf algorithm and restricted the model to GTR+G only. Here is the exact execution script run in v1.6.12 on a cluster: iqtree -s aln.phy -spp aln-nodupes.part -m TESTMERGEONLY -rclusterf 10 -mset GTR+G -merit AICc -mrate G -nt 72 Any comments appreciated. Thanks, Michael ", "Hi Michael, It looks like there might be a mistake in your Modelfinder command line. From what I understand, -rclusterf is just a flag, and shouldn\u2019t be followed by a number. I don\u2019t know what happens when you follow it with a number, but given what you report I suspect ModelFinder might be ignoring the flag altogether. Maybe try this: iqtree -s aln.phy -spp aln-nodupes.part -m TESTMERGEONLY -rclusterf -mset GTR+G -merit AICc -mrate G -nt 72 and alternatively you could try this which should be very similar iqtree -s aln.phy -spp aln-nodupes.part -m TESTMERGEONLY -rcluster-max 5 -mset GTR+G -merit AICc -mrate G -nt 72 The latter will run the standard rcluster analysis, but only look at the top 5 potential pairs to merge. It should be fairly quick, and might help you figure out if it\u2019s something intrinsic to ModelFinder being slower for some reason (which I think is relatively unlikely) or something that can be fixed by changing your command line. Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0a71fc8f-a904-4b3f-8280-9434b7951f04%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Hi guys, Just to chime in. I recently used -rclusterf 10 and it seemed to work fine. Then again, there was nothing in the log file that said that ModelFinder just used to top 10% of candidates. Chris On Thursday, 23 January 2020 19:09:06 UTC-5, Rob Lanfear wrote: Hi Michael, It looks like there might be a mistake in your Modelfinder command line. From what I understand, -rclusterf is just a flag, and shouldn\u2019t be followed by a number. I don\u2019t know what happens when you follow it with a number, but given what you report I suspect ModelFinder might be ignoring the flag altogether. Maybe try this: iqtree -s aln.phy -spp aln-nodupes.part -m TESTMERGEONLY -rclusterf -mset GTR+G -merit AICc -mrate G -nt 72 and alternatively you could try this which should be very similar iqtree -s aln.phy -spp aln-nodupes.part -m TESTMERGEONLY -rcluster-max 5 -mset GTR+G -merit AICc -mrate G -nt 72 The latter will run the standard rcluster analysis, but only look at the top 5 potential pairs to merge. It should be fairly quick, and might help you figure out if it\u2019s something intrinsic to ModelFinder being slower for some reason (which I think is relatively unlikely) or something that can be fixed by changing your command line. Rob On Fri, 24 Jan 2020 at 10:51, Michael Branstetter < mgbran...@gmail.com > wrote: I set up a ModelFinder analysis on my phylogenomic dataset that should mimic settings I used in PartitionFinder2. The PF2 analysis finished in 1.5 days using 72 cpus. The MF analysis, in contrast, was still running after 2 days and the estimated amount of time remaining kept increasing (> 2,000 hours). I have generally found the MF analysis available in IQTree to be much slower than PF2 and I am curious to know why that is and if there is a fix in the works or if I am setting up the analysis incorrectly. For some background, my dataset has 283 taxa, 694198 bp, and 5423 partitions. To reduce analysis time, I used the rclusterf algorithm and restricted the model to GTR+G only. Here is the exact execution script run in v1.6.12 on a cluster: iqtree -s aln.phy -spp aln-nodupes.part -m TESTMERGEONLY -rclusterf 10 -mset GTR+G -merit AICc -mrate G -nt 72 Any comments appreciated. Thanks, Michael You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/0a71fc8f-a904-4b3f-8280-9434b7951f04%40googlegroups.com ", "Thanks for the comments. I initially tried to run the command without the number after rclusterf, but I received an error message stating that it expected there to be a number. I did think this was odd, given that PF2 does not require such a number when using rclusterf. I will keep trying, but I am curious to know if it is a reasonable expectation that MF should be as fast or faster than PF2 with the same number of cpus. Also, if MF has been tested on large phylogenomic datasets and compared to PF2 in terms of performance and speed? Thanks, Michael --------------------------------------------------------- Michael Branstetter, PhD USDA-ARS Pollinating Insects Research Unit Utah State University 5310 Old Main Hill Logan, UT 84322-5310 (435) 797-2588 --------------------------------------------------------- To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6077c882-1d1d-4289-8a65-6aca68f4b541%40googlegroups.com ", "Dear Michael, dear all, I think that providing a number to the rclusterf option is correct, in iqtree. I was also surprised how long my last rclusterf run took. It had about 260000 sites, 1300 data blocks and 135 taxa. So much smaller than your data set. (No Hymenoptera in fact.) It took almost exactly one month to complete on 50 cores. I did not compare this to PF2, but I was surprised that it took that long. Another point of interest: The time left during the merging phase increased almost steadily up to a maximum of about 6400 hours. Minutes after reaching that maximum, the merging phase successfully finished. I think the run time of the rclusterf simply cannot be estimated. It would be easier to estimate the time until the next merging step since for the current step, the number of remaining analyses is known. In an rcluster run (no f) the \"time left\" decreased to 0 and stayed there for days until it finished. Maybe this difficulty in estimating the remaining computation time could be pointed out somewhere. Best Christoph To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAJgYPPExc5BF4ZPaaPQmQV21eSX5UJ0mGMdfGWAOZ1ZnTLdLiw%40mail.gmail.com **************************************** Dr. Christoph Mayer Email: c.maye...@uni-bonn.de Tel.: +49 (0)228 9122 403 Zoologisches Forschungsmuseum Alexander Koenig - Leibniz Institut f\u00fcr Biodiversit\u00e4t der Tiere - Adenauerallee 160 53113 Bonn, Germany www.zfmk.de Stiftung des \u00f6ffentlichen Rechts; Interimsdirektor: Prof. B. Misof Sitz: Bonn **************************************** ", "Hi All, Minh is on holiday at the moment, but when he's back he and I can sit down and work through these issues and differences in performance. We're preparing to release a new version of ModelFinder so these concerns are very timely! If anyone else has observations, this would be a good thread to raise/discuss them. Rob To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/754EBE7A-938B-4C17-886B-4FB2514C78CB%40uni-bonn.de ", "Hi Rob, I posted this before, but ModelFinder was taking a very long time on my unpartitioned alignment of about 2 million bp and 33 taxa. Because if this I simply compared GTR+R10 and GTR+I+G. Chris To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmqmNEfzVj5%2B10ieWtdL7F3chNVJYCGtvE5ftpb%2BT_ZErw%40mail.gmail.com <{===================~~~~~~~~~~~ /\\ /\\ Christopher Blair, Ph.D. Associate Professor Department of Biological Sciences New York City College of Technology and Ecology, Evolution and Behavior PhD Program Graduate Center The City University of New York 285 Jay Street Brooklyn, NY 11201 CBl...@citytech.cuny.edu cbl...@gc.cuny.edu Website: https://sites.google.com/site/christopherblairphd/home Office: Academic Complex 501A; Ph: 718-260-5342 Lab: Academic Complex 401 ", "Dear Minh, there is another point I want to add to this discussion, since I feel that it could be linked to ModelFinder being slow on large data sets. I am using Version 1.6.12 since this is the last stable release. I am aware of the fact the 1.7 includes improvements of the merging. Anyway: A while ago I started a merging run with rcluster 10. Since it is slow I copied the folder including the model.gz file and started a run with rclusterf 10 which should be faster. iqtree says that it read the model.gz file, which is already 500 MB large. Even though it has read the model file, it started to recompute models for all data blocks. Even though I gave this job 56 cores it reports the model of a single data block only every few minutes. The pattern is the following: It writes the model.gz.tmp file, which takes about 4 minutes. Then it renames it to model.gz. Every time it finishes, it reports the result of exactly one model determination of a single data block. - In this way it takes very long to conduct the primary model determination for 1300 data blocks. - I wonder why it determines the models of the individual data blocks, since it should already have obtained them from the previous run when reading the model.gz file? It reported that it read this file and apparently it is writing this file to the disk constantly. (Of course I did not change the data files when starting the rclusterf run.) - Why does it only report the model for a single partition every 4 minutes. It could run 56 model determinations in parallel. Things might have changed in the beta and release candidate versions of iqtree? Best wishes and many many thanks in advance. Christoph To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/754EBE7A-938B-4C17-886B-4FB2514C78CB%40uni-bonn.de ", "Dear Minh, dear all, for my case I think I have solved the problem. I restarted a run with an existing huge model.gz file (about 500 GB) in a ModelFinder merge Analysis. Iqtree was running for 62 hours with little progress. Since I conjectured that writing the model.gz was the bottleneck, I rerun the analysis with the option -cptime 1000, which reduces the time intervals after which checkpointing data is written to the disc from 20 to 1000 seconds. The latter is about one quarter of an hour. This reduced the run time considerably: The model determination for the first 829 data blocks reduced from: 62h:5m:10s to 0h:4m:27s, which is a nice speedup I would say. This speedup will only be achieved if the model.gz file is very large. But for data sets with many data blocks this will be the case at some point. Maybe the default time intervals for writing checkpointing data is an overkill. Having checkpointing data every quarter of an hour should be more than sufficient. Best Christoph To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/C97BEC37-8D13-4735-9FD8-16E56DD7133F%40uni-bonn.de ", "To follow up on what Christoph said about the new version of IQTREE, I found that merging in IQTREE2.0-rc1 is much, much faster. In a merging analysis using 2.0-rc1, a nucleotide dataset with 1059 partitions using -m TESTNEWMERGEONLY -rcluster 10 -rcluster-max 1000 -nt 25 took 38 hours to complete. I didn't try this exact analysis in IQTREE 1.6.x, but similar ones were running for a month before I killed them and they still had >80 days left in the estimated time remaining. This is a great improvement, but I didn't see mention of improved merging in the IQTREE2 preprint on Biorxiv, so more info would be useful. Thanks, Matt Kweskin To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6077c882-1d1d-4289-8a65-6aca68f4b541%40googlegroups.com You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAJgYPPExc5BF4ZPaaPQmQV21eSX5UJ0mGMdfGWAOZ1ZnTLdLiw%40mail.gmail.com **************************************** Dr. Christoph Mayer Email: c...@uni-bonn.de Tel.: +49 (0)228 9122 403 Zoologisches Forschungsmuseum Alexander Koenig - Leibniz Institut f\u00fcr Biodiversit\u00e4t der Tiere - Adenauerallee 160 53113 Bonn, Germany www.zfmk.de Stiftung des \u00f6ffentlichen Rechts; Interimsdirektor: Prof. B. Misof Sitz: Bonn **************************************** You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/754EBE7A-938B-4C17-886B-4FB2514C78CB%40uni-bonn.de **************************************** Dr. Christoph Mayer Email: c...@uni-bonn.de Tel.: +49 (0)228 9122 403 Zoologisches Forschungsmuseum Alexander Koenig - Leibniz Institut f\u00fcr Biodiversit\u00e4t der Tiere - Adenauerallee 160 53113 Bonn, Germany www.zfmk.de Stiftung des \u00f6ffentlichen Rechts; Interimsdirektor: Prof. B. Misof Sitz: Bonn **************************************** You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/C97BEC37-8D13-4735-9FD8-16E56DD7133F%40uni-bonn.de **************************************** Dr. Christoph Mayer Email: c...@uni-bonn.de ", "Dear All, Thanks for the discussions! I will look through these once back in about a week. Quick comments about: The model determination for the first 829 data blocks reduced from: 62h:5m:10s to 0h:4m:27s, which is a nice speedup I would say. Yes indeed the default checkpoint time is too small for very large data set like this. So Christoph nicely pointed out that one should increase this with -cptime option to reduce the bottleneck of writing the checkpoint file. To follow up on what Christoph said about the new version of IQTREE, I found that merging in IQTREE2.0-rc1 is much, much faster. In a merging analysis using 2.0-rc1, a nucleotide dataset with 1059 partitions using -m TESTNEWMERGEONLY -rcluster 10 -rcluster-max 1000 -nt 25 took 38 hours to complete. I didn't try this exact analysis in IQTREE 1.6.x, but similar ones were running for a month before I killed them and they still had >80 days left in the estimated time remaining. This is a great improvement, but I didn't see mention of improved merging in the IQTREE2 preprint on Biorxiv, so more info would be useful. This is actually a new (unpublished) feature in v2.0, where we introduce several heuristics to speed up this process. We\u2019re preparing ModelFinder2 ms about this, so more detailed descriptions will follow in the next few months. Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/4bc97bec-05fb-40cb-9b35-a751e2d178f2%40googlegroups.com ", "Dear Minh, I would like to suggest I simple default value for the -cptime option. Most users will never look at this option, so a better default value would be good to have. Some thoughts: For large data sets which run for many days, a checkpointing ever few hours is fully sufficient. What about: cptime default parameter = number of datablocks * 4. For 20 data blocks this is 80 or about 1.3 Minutes. For 1000 data blocks this is 4000s or about 1h. For 2000 data blocks this is 8000s or about 2h. Etc. Best Christoph To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/E84AAA28-ECDB-4C02-867B-09F09338EC3B%40univie.ac.at **************************************** Dr. Christoph Mayer Email: c.maye...@uni-bonn.de ", "Dear Minh, I have now experienced the ModelFinder speedup available in 2.0-rc1, and it seems to be a major improvement, but I am confused now as to how to setup the analysis correctly. It appears that the analysis options have changed compared to 1.6.x. Could you tell me how to run a merge only analysis that mimics PartitionFinder2. Specifically, I would like to do one run that only uses GTR+G, rclusterf, and AICc. I thought I setup the analysis correctly, but the output suggests that the program is using GTR+I+G rather than GTR+G only. Here are the options I used: /home/michael.branstetter/downloads/iqtree-2.0-rc1-Linux/bin/iqtree -s aln.phy -spp aln.part -m TESTMERGEONLY -rclusterf 10 -mset GTR+G -merit AICc -mrate G -nt 72 -cptime 3600 When I look at the help information for v2.0-rc1, it seems to me that the merge options should be run separately from the model test options, but I can't quite figure out how to run the analysis correctly. I'm also interested in doing a run that would allow for all iqtree models to be tested. All help appreciated. Thanks. Best, Michael --------------------------------------------------------- Michael Branstetter, PhD USDA-ARS Pollinating Insects Research Unit Utah State University 5310 Old Main Hill Logan, UT 84322-5310 (435) 797-2588 --------------------------------------------------------- To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/E84AAA28-ECDB-4C02-867B-09F09338EC3B%40univie.ac.at ", "Michael, I suggest trying your partition file in nexus format if it\u2019s not already. That was the only way I was able to get merging to work with iqtree2-rc1. Matt ", "The merging worked for me using a raxml-style format file, but iqtree used the wrong model. What settings did you use to start the analysis? Best, Michael --------------------------------------------------------- Michael Branstetter, PhD USDA-ARS Pollinating Insects Research Unit Utah State University 5310 Old Main Hill Logan, UT 84322-5310 (435) 797-2588 --------------------------------------------------------- ", "I believe I made an error suggesting that nexus vs raxml style partitions make a difference. In some early attempts, I thought that was the case, but it was probably user error. I\u2019m re-running a job with raxml-style partitions and so far the log looks about the same as when I used nexus. If there is a difference in the results, I\u2019ll follow up. This is the command I used: iqtree-2.0-rc1-Linux/bin/ iqtree -s alignment.phy -p partitions.nexus -m TESTNEWMERGEONLY -nt 15 -rcluster 10 -rcluster-max 1000 -pre TESTNEWMERGE -cptime 1800 ", "Hi Christoph, In version 2.0 we already implemented a better checkpointing automatically adapted to the dataset size. It will measure the time needed to write the checkpoint file, say = x. The waiting time to the next checkpoint will be set to max(60 sec, x*20). That way, IQ-TREE will never spend more than 5% of the runtime for checkpointing. Does that make sense? Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6A3FF99E-B483-4DA3-BCE8-D7E1B08E87A5%40uni-bonn.de ", "Hi Michael, In iqtree v2 there are two new options to control the model and rate for the merging phase. Here is the relevant help usage, which you can see by running iqtree -h: PARTITION-FINDER: --merge Merge partitions to increase model fit --merge greedy|rcluster|rclusterf Set merging algorithm (default: rclusterf) --merge-model 1|all Use only 1 or all models for merging (default: 1) --merge-model STR,... Comma-separated model list for merging --merge-rate 1|all Use only 1 or all rate heterogeneity (default: 1) --merge-rate STR,... Comma-separated rate list for merging --rcluster NUM Percentage of partition pairs for rcluster algorithm --rclusterf NUM Percentage of partition pairs for rclusterf algorithm --rcluster-max NUM Max number of partition pairs (default: 10*partitions) The two relevant options are --merge-model and --merge-rate. You can set: --merge-model all --merge-rate all to revert the old (slow) behaviour of considering all models and rates. Or you can do: --merge-model GTR --merge-rate G to only consider GTR+G. We\u2019re still in the process of preparing ModelFinder2 ms. Full details will follow. Cheers, Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAJgYPPHuWogZExKAZnWfg6-oZiNO7BEvUenNKo7d0232D8%2B3Tg%40mail.gmail.com ", "Hi Minh, Thanks for the help. I had checked the help information, but what remains unclear to me is the relationship between the \"-m\" and \"--merge\" settings, since these seem to be separate parameters in iqtree2. When I attempted a run using \"--merge rclusterf\" only, without the \"-m\" option, iqtree2 did not perform the MF analysis, it just did a tree search. I have only been able to get the MF analysis to work when I use the old \"-m TESTMERGEONLY\" setting. It does appear that doing \"m TESTMERGEONLY\" followed by \"--merge-model GTR --merge-rate G\" produces the correct outcome, limiting the merge model to GTR+G only. However, after the merging, it tests all available models across the partitions. Do I need to set \"-mset\" and \"mrate\" in addition to \"merge-model\" and \"merge-rate\"? And what about \"--merge rclusterf\" versus \"-rclusterf 10\"? Do I need both of these or just one? Perhaps I just need to wait for the MF2 paper/documentation to get the answers I need, but I would appreciate the any clarity you can provide. Thanks, Michael --------------------------------------------------------- Michael Branstetter, PhD USDA-ARS Pollinating Insects Research Unit Utah State University 5310 Old Main Hill Logan, UT 84322-5310 (435) 797-2588 --------------------------------------------------------- To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/6762F488-E24B-416C-99D3-D9A20403AA5F%40univie.ac.at "]}, "vjs-XQWIT08": {"topic": "Sample size: What does it mean?", "initializeDate": "Sep 9, 2019, 4:48:37 AM", "timeStamp": "Sep 10, 2019, 10:48:02 PM", "content": ["Dear developers, I have been using iqtree on large phylogenetic analysis. My trees vary in size, from small to very large trees. When allowing ModelFinder to choose the best substitution model, the .log files mention something called 'sample size'. 'ModelFinder will test 546 protein models (sample size: 3292)' , for example. I find that this number is a good indicator of how long the phylogenetic reconstruction is going to take to complete. However, I don't know what it means. Initially I thought it corresponded to the number of sequences, but I was wrong. Could you clarify, please? Thank you in advance, Best wishes, Maria ", "Hi Maria, On 9 Sep 2019, at 6:48 pm, Maria Mantas < maria....@gmail.com > wrote: Dear developers, I have been using iqtree on large phylogenetic analysis. My trees vary in size, from small to very large trees. When allowing ModelFinder to choose the best substitution model, the .log files mention something called 'sample size'. 'ModelFinder will test 546 protein models (sample size: 3292)' , for example. The sample size is the length of the alignment. It's used to compute the Akaike/Bayesian information criterion for model selection. I find that this number is a good indicator of how long the phylogenetic reconstruction is going to take to complete. Yes, that\u2019s correctly, but does not fully explain the the runtime. The number of sequences matter more. We normally saw that the runtime increases linearly with the alignment length, but quadratically with the number of sequences. If you want to speed up ModelFinder, perhaps you can restrict the models to consider with -mset option. I\u2019d recommend -mset GTR for DNA and -mset LG for protein. These two models are decent and quite often fit well to many datasets. Cheers, Minh However, I don't know what it means. Initially I thought it corresponded to the number of sequences, but I was wrong. Could you clarify, please? Thank you in advance, Best wishes, Maria You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ef281d77-6bbd-42ba-bd43-a613ab626d4d%40googlegroups.com "]}, "3ZuFNWifhbY": {"topic": "Errors of Segmentation Fault and Numerical underflow (lh-branch)", "initializeDate": "Dec 21, 2020, 8:00:19 PM", "timeStamp": "Jan 18, 2021, 6:31:33 PM", "content": ["Hi there! I've been trying to create a gene tree using IQTREE to run on an alignment file of 367 proteins. I've run it in various different ways in order to to try get it to run, but I get an error every time. The first command was: iqtree -s homologs.trimmed.aligned.faa -nt AUTO This resulted in the error: Numerical underflow (lh-branch). Run again with the safe likelihood kernel via `-safe` option (see error fite *_ntauto) When I run with the -safe option I get a similar response \"phylokernelnew.h:3159: double PhyloTree::computeLikelihoodFromBufferSIMD() [VectorClass = Vec4d, nstates = 20, FMA = true, SITE_MODEL = false]: Assertion `std::isfinite(tree_lh) && \"Numerical underflow for lh-from-buffer\"' failed\" (see error file *_ntautosafe) I saw that these issues could be potentially circumvented by using the -m TEST flag - which I attempted using the command: And got the error: ERROR: STACK TRACE FOR DEBUGGING: ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL ABORTED (see error file *ntautosafemtest) NB that this command didn't \"finish\", i.e. it stayed stuck and didn't retrun to a newline after the error message was displayed I've also attached the alignment file in here. I hope you can help, I look foward to using your tool! ", "Here are those log files, I've had to add an .txt extension on the end of the .faa alignment file in order to be able to upload it. Cheers! ", "Hi Megan, Sorry for the long delay, I\u2019m back from a long break. I reran IQ-TREE v1.6.12 your same command line on a MacBook and it completed without any crash. The best model is LG+F+I+G4. Attached is the log file. So I couldn\u2019t reproduce this behaviour. Cheers Minh "]}, "yGEdshu4yI8": {"topic": "iqtree 2.0.3 segfault on a big alignment", "initializeDate": "May 12, 2020, 8:58:30 PM", "timeStamp": "May 14, 2020, 8:49:45 AM", "content": ["Dear iqtree users, I'm running two phylogenies on similar datasets, full alignments of 2-3k bacterial genomes. While one (bigger one) is running smoothly so far, the second one crashes with the following messages: IQ-TREE multicore version 2.0.3 for Linux 64-bit built Apr 26 2020 Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams. Host: ada05.black (AVX2, FMA3, 503 GB RAM) Command: iqtree -T 8 -s final_2002.full.aln --prefix snippy_2002_stm.iqtree -B 1000 Seed: 531157 (Using SPRNG - Scalable Parallel Random Number Generator) Time: Tue May 12 23:09:44 2020 Kernel: AVX+FMA - 8 threads (128 CPU cores detected) Reading alignment file final_2002.full.aln ... Fasta format detected Alignment most likely contains DNA/RNA sequences Alignment has 2003 sequences with 4879402 columns, 1142966 distinct patterns 27165 parsimony-informative, 24887 singleton sites, 4827350 constant sites Gap/Ambiguity Composition p-value 1 FD01542814 3.47% failed 1.45% 2 FD01542815 1.75% passed 49.35% 3 FD01542816 1.77% passed 80.48% .......................... ( skipped 2k lines) ................................... 2003 SAL_UA8372AA 4.07% failed 0.70% **** TOTAL 2.59% 264 sequences failed composition chi2 test (p-value<5%; df=3) NOTE: minimal branch length is reduced to 0.000000020494 for long alignment ERROR: STACK TRACE FOR DEBUGGING: ERROR: 1 funcAbort() ERROR: 2 () ERROR: 3 pllLoadAlignment() ERROR: 4 IQTree::initializePLL(Params&) ERROR: 5 startTreeReconstruction(Params&, IQTree*&, ModelCheckpoint&) ERROR: 6 runPhyloAnalysis(Params&, Checkpoint*) ERROR: 7 main() ERROR: 8 __libc_start_main() ERROR: 9 () ERROR: ERROR: *** IQ-TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR: *** For bug report please send to developers: ERROR: *** Log file: snippy_2002_stm.iqtree.log ERROR: *** Alignment files (if possible) I've tried the same run on a different compute node or with \"-T AUTO\", but results are still the same. Would appreciate any help! I can share alignment file as well (as a Dropbox link), but it's quite big (about 2 Gb gzipped). Thank you in advance! ", "Hi there, Please add -t PARS option to avoid using PLL library. It crashed there. Since a number of users reported the same issue, we may change this as the default behaviour in IQ-TREE. Thanks Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/c111070e-cda3-4d80-94bc-7eb6b2e164de%40googlegroups.com ", "Thank you very much for your answers! Much appreciated. -- Alex Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "me7YFyMeP8E": {"topic": "IQ-TREE basal trifurcations", "initializeDate": "Oct 8, 2019, 1:53:20 PM", "timeStamp": "Oct 9, 2019, 3:26:03 AM", "content": ["I have used IQ-TREE to reconstruct a series of gene trees. My command is \" nohup iqtree -bb 1000 -alrt 1000 -m TEST -mrate G4 -nt AUTO -ntmax 20 -s 36.concatenated.phy & \". But when I look into the newick tree files for the unrooted gene trees, the basal trifurcations always exists. After I have rooted the gene trees, this problem can be solved. I am not sure if it's normal. Or maybe I have made something wrong. Could you help me? Thanks. I have appended one newick tree file. Best regards, Yuan ", "Hi Yuan, That\u2019s the normal behaviour because the tree is unrooted: the most outer bracket is a tri-furcation, because the root location is unknown. The same holds true for other ML programs, not just specific to IQ-TREE. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/67a3f693-b306-4793-b2af-92ecbdc5f8c8%40googlegroups.com <Cluster309_combined_seqs_nums_gt_4_containing_non_Mars_seqs.mafft.trimal.phy.treefile> ", "Hi Minh Thanks for your reply very much. I have got your idea. I will cite your paper. Best regards, Yuan \u5728 2019\u5e7410\u67089\u65e5\u661f\u671f\u4e09 UTC+8\u4e0a\u53481:53:20\uff0c\u8881\u6d0b\u5199\u9053\uff1a "]}, "2fI3JpOS6AA": {"topic": "Mesquite supports IQ-TREE", "initializeDate": "May 5, 2018, 7:19:25 AM", "timeStamp": "May 5, 2018, 7:19:25 AM", "content": ["Dear users, David Maddison has nicely added support for running IQ-TREE within Mesquite software version 3.5 ( http://www.mesquiteproject.org ). After installing Mesquite, you need to install Zephyr package to interact with IQ-TREE and other phylogenetic software. You can then choose to run IQ-TREE from the \u201cAnalysis\u201d menu for your data matrix (screen shot below). Mesquite is very handy and user-friendly, e.g. resulting tree will be automatically displayed on screen right after the analysis is done. Therefore, we really recommend Mesquite especially if you\u2019re not familiar with the command line. Best, IQ-TREE development team "]}, "SuWXTQdpJMk": {"topic": "AU test interpretation", "initializeDate": "Jul 10, 2017, 9:40:38 AM", "timeStamp": "Jul 14, 2017, 8:20:06 AM", "content": ["Hi, I'm using IQTREE's implementation of the AU test to test multiple topologies in my current project and it works wonderfully, thank you for doing it! I know how topological hypothesis testing works etc, but the background of the AU test is somewhat difficult and I wanted to ask if the following would be a fair explanation of it's results - \"We used the AU test to determine statistically if topology A offered a significantly better explanation of our data than topology B\". From my reading of the CONSEL manual, they say this about the AU p-values \"We may reject the possibility that item i has the largest expected value of Yi when AUi < 0.05, at the significance level 0.05\", which I think means just that, but I wanted to make sure. Thanks for any help! Cheers, -Jacek ", "Dear Jacek, Your sentence sounds good to me. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "_LOA-B-aw_g": {"topic": "concatenated aa and nucl partition", "initializeDate": "Feb 27, 2015, 3:10:27 PM", "timeStamp": "Feb 27, 2015, 3:23:15 PM", "content": ["Hi, Do you plan to implement the analysis of aa + nucl partitions? Just in case, I tried the -sp option on a concatenated aa+nucl alignment. Sure enough, I got error message. Best, Giorgio ", "Hi Giorgio, yes you can mix AA and DNA partition. In this case, you need to have 2 separate alignment files, say aa.phy and dna.phy (iqtree can not read a mixed alignment file). Then specify a NEXUS partition file for example (part.nex): #nexus begin set; charset p1 = dna.phy:*; charset p2 = aa.phy:*; end; you can change \u201c*\u201d to position ranges, e.g. charset p1=dna.phy:1-100,200-300; then run iqtree without -s: iqtree -sp part.nex -m TEST this will automatically select best fit models for each partition. -s option is not needed because alignment file names are already embedded in the partition file. Hope that helps Minh > -- > You received this message because you are subscribed to the Google Groups \"IQTREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > Visit this group at http://groups.google.com/group/iqtree > For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at "]}, "a4OhftT90O8": {"topic": "available tests to study correlation between external data and pairwise genetic distances with a tree file?", "initializeDate": "May 19, 2020, 9:50:53 AM", "timeStamp": "May 22, 2020, 7:44:49 AM", "content": ["Hi, I have a data file containing all the taxa labels (in one column), followed by a numeric value for each taxon (separated by one tabulation, in another column). This file is an external data set that brings one type of information for each taxon of my phylogenetic analysis. I also have constructed a phylogenetic tree with all the same taxa sequences. With my tree mapped with my external data set, when I get closer to some specific taxa, there is a correlation or a trend, at least, with the external data. I want to test the significance of this trend/correlation between pairwise genetic distances to some predefined taxa (events) and my external data (continuous/numeric values). Can IQ-Tree provide such kind of analysis? Is there a test that I can use directly on my tree file and external data file? If not, where can I find this kind of test or program? Best regards, Gabriel ", "Hi Gabriel, That's a common kind of analysis to do, but it's not something that IQ-TREE can do. IQ-TREE is focussed only on estimating the tree itself. I'd bet there's an R package to do what you want. Exactly which package depends a lot on what your data are, what the assumptions you are willing to make are, etc. etc. A good place to start is the CRAN task view for phylogenetics: https://cran.r-project.org/web/views/Phylogenetics.html If you get stuck, the best place to ask questions is R-sig-phylo: https://stat.ethz.ch/mailman/listinfo/r-sig-phylo And if I were to guess the best package to start with, it would be the phylosignal package: https://cran.r-project.org/web/packages/phylosignal/index.html Rob You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/ee1584b6-54ff-42bc-9cde-8a976db3a8f9%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Hi Rob, Thank you very much for your response. Are you familiar with \"phylosignal package\"? I'm actually trying to use it for my analyses. Nevertheless, I have some problem to create a p4d object with my data. When I am using the command line <p4d_object <- phylo4d(treefile, externaldata)> I received this error message: Warning in checkTree(object) : Labels are not unique. Warning in checkTree(object) : Labels are not unique. The sequence names in my external data set are strictly the same as used in my tree file. No duplicates were found, so I do not understand this error message. Best regards, Gabriel To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAGr%2BNmrSiB8f46H_q%2BQ9TchcgHhRZP4VaD%3D%3DCPevL8dywfbDDw%40mail.gmail.com ", "Dear Gabriel, It might be that phylosignal substitutes characters in the taxon names that it assumes to be \u2018forbidden characters\u2019. It sometimes depends on the software, what they assume forbidden characters and what they convert them to. Assuming a software converts \u2018/\u2018 to \u2018-\u2018 or \u2018_\u2019 it can happen that after that conversion two sequences have the same name, while having been different before. However, that is guessing, because I am not familiar with phylosignal, but it is a common source of this kind of errors in other software. Cheers, Heiko > To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/CAOn%3DZqZQwHbsT9-xXUeqrMcSNys-FeN1pdFev%2Bt_A%3D5KLX2iYg%40mail.gmail.com ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max Perutz Labs http://www.cibiv.at/ ----------------------------------------------------------------------------- "]}, "OHEBOKFK_2I": {"topic": "Construction ML constrained topology- stuck at step \"Generating 99 parsimony trees\"", "initializeDate": "Jan 14, 2019, 8:58:17 AM", "timeStamp": "Jan 15, 2019, 8:43:01 AM", "content": ["Hello, I am trying to use IQ-Tree 1.6.6 for testing additional topologies. When I run the \"-g\" option to construct the ML tree given a constrained topology, iq-tree becomes stuck at the following step: \"Generating 99 parsimony trees\". I already tested multiple datasets and the same happens in all of them. I tested the same datasets in RAxML and everything works fine, so I believe it has nothing to do with the data itself. I am using ~900 taxa so I was wondering if this has something to do with the fact that I am using a large dataset. Thank you in advance! Best, Carla ", "Dear Carla, -g option is known to be slow for large number of taxa. This is now solved in the beta version 1.7, please get it from here (currently beta7): https://github.com/Cibiv/IQ-TREE/releases Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thank you Minh for your ultra fast reply. It is now working fine with one of the datasets using the 1.7 beta version. Cheers, Carla "]}, "EAZqsm3ouRI": {"topic": "Anaconda/Bioconda Version Update?", "initializeDate": "May 23, 2018, 5:41:30 AM", "timeStamp": "May 24, 2018, 6:17:32 AM", "content": ["The Anaconda/Bioconda install of IQTree is still version 1.5.5. Can this be updated? I'd like to recommend IQTree to a group where bioconda will be the easiest install route, but they'll also need the newer features. ", "Hi Emma, Unfortunately I have no idea how to update this. Maybe somebody else from this forum can help. Or better you ask the maintainer of this bioconda package directly. Cheers, Minh On 23 May 2018, at 7:41 pm, Emma Hodcroft < emmaho...@gmail.com > wrote: The Anaconda/Bioconda install of IQTree is still version 1.5.5. Can this be updated? I'd like to recommend IQTree to a group where bioconda will be the easiest install route, but they'll also need the newer features. You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "BavuEep7oU0": {"topic": "Single branch test on tips?", "initializeDate": "May 19, 2016, 5:30:43 AM", "timeStamp": "May 19, 2016, 5:52:35 AM", "content": ["Dear All, It looks from the annotations on the tree that IQTREE only tests single branches >0 (alrt, abayes, lbp etc.) for internal branches, not for tips. Is this the case? Best wishes Simon ", "Dear Simon, yes that\u2019s right, not only for such branch tests but also the bootstrap, as they test the grouping of at least two taxa. Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "DPq-hjsS7o4": {"topic": "How to input a variable instead of file for iqtree bootstrap using python MPI", "initializeDate": "Sep 14, 2018, 4:29:32 AM", "timeStamp": "Sep 16, 2018, 5:55:37 PM", "content": ["I would like to run bootstrap using -bo, but if i open the file and share the variable using broadcast for other process, Iam not getting either error or any output. kindly help resolving it. #!/usr/bin/env python3 from mpi4py import MPI import os comm = MPI.COMM_WORLD rank = comm.Get_rank() size = comm.Get_size() if rank == 0: filedata = open(\"/mnt/lustre/bio/biosilva/September/13/nr_J-protein_subfamily_final.msa\",\"r\") else: filedata = None filedata = comm.bcast(filedata, root=0) for i in range(size): output= \"/mnt/lustre/bio/biosilva/September/13/boot1_\"+ i os.system(\"iqtree -s 'filedata' -m JTT+G4 -bo 1 -pre 'output'\") Thanks Vignesh ", "Hi Vignesh, This is a python question, not directly related to IQ-TREE. I suggest that you ask it in some python forum, i.e. about how to catch stdout and stderr from calling a program inside python. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout "]}, "7m8kU2kvEjs": {"topic": "Running a naive NNI search in iqtree", "initializeDate": "Jan 30, 2020, 4:13:44 PM", "timeStamp": "Feb 18, 2020, 7:35:04 AM", "content": ["Hi, If I use the allnni=True, ninit=1 and nstop=1, do I get a naive implementation that at each iteration moves to the best NNI, and stops when reaching a local maximum? thanks!! ", "Hi Noa, For other users: -ninit 1 means that IQ-TREE will only construct one starting parsimony tree. -nstop 1 means that IQ-TREE will stop after 1 iteration that no better tree is found. So IQ-TREE will only do 1 iteration or 2. -allnni means that IQ-TREE will evaluate all 2(n-3) NNIs around (n-3) internal branches (n = #taxa) to determine the NNI leading to the highest improvement in likelihood. So if you combine all these options, IQ-TREE will do a hill-climbing NNI search on the parsimony tree, e.g. similar to FastTree algorithm. Note that -fast option is equivalent to \"-ninit 2 -n 2\u201d. Does that answer your question? Cheers Minh On 31 Jan 2020, at 4:13 am, Noa Ecker < n12...@gmail.com > wrote: Hi, If I use the allnni=True, ninit=1 and nstop=1, do I get a naive implementation that at each iteration moves to the best NNI, and stops when reaching a local maximum? thanks!! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/7c27a328-8c35-4e08-a8b4-9bcb01d0a145%40googlegroups.com ", "Great, thanks!!! On Sunday, February 2, 2020 at 6:10:02 PM UTC+2, Minh Bui wrote: Hi Noa, For other users: -ninit 1 means that IQ-TREE will only construct one starting parsimony tree. -nstop 1 means that IQ-TREE will stop after 1 iteration that no better tree is found. So IQ-TREE will only do 1 iteration or 2. -allnni means that IQ-TREE will evaluate all 2(n-3) NNIs around (n-3) internal branches (n = #taxa) to determine the NNI leading to the highest improvement in likelihood. So if you combine all these options, IQ-TREE will do a hill-climbing NNI search on the parsimony tree, e.g. similar to FastTree algorithm. Note that -fast option is equivalent to \"-ninit 2 -n 2\u201d. Does that answer your question? Cheers Minh On 31 Jan 2020, at 4:13 am, Noa Ecker < n12...@gmail.com > wrote: Hi, If I use the allnni=True, ninit=1 and nstop=1, do I get a naive implementation that at each iteration moves to the best NNI, and stops when reaching a local maximum? thanks!! You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "uJt9-EBZqPs": {"topic": "Branch support measures for PMSF site-hetogeneous models", "initializeDate": "May 6, 2020, 10:52:30 AM", "timeStamp": "May 7, 2020, 1:59:40 AM", "content": ["Hi all, I have a question that is more relating to the calculation of branch support under PMSF models. Does it make sense to calculate ultrafast bootstraps under the PMSF models or is it better to apply the non-parametric bootstrap analysis under these models as mentioned in the manual? It is mentioned that non-parametric bootstrap can be calculated but there is no mention to the ultrafast bootstraps under these models. I assume this is also possible? Additionally does it make sense to do PMSF analyses by using empirical mixture models combined with free-rate among-site heterogeneity eg. LG+F+C20+R10? I have not seen someone doing this so far, but it is mostly combined with the simpler +G4 option. In theory if an +RX model is better fitting than +GX then the +RX option should be used for phylogenetic analyses under the PMSF model? Correct me if i am wrong. Many thanks Alex ", "Hi Alex, On 7 May 2020, at 12:52 am, Alexandros Vasilikopoulos < alexva...@gmail.com > wrote: Hi all, I have a question that is more relating to the calculation of branch support under PMSF models. Does it make sense to calculate ultrafast bootstraps under the PMSF models or is it better to apply the non-parametric bootstrap analysis under these models as mentioned in the manual? It is mentioned that non-parametric bootstrap can be calculated but there is no mention to the ultrafast bootstraps under these models. I assume this is also possible? Yes the ultrafast bootstrap works with PMSF model seamlessly. I believe we showed both standard and ultrafast bootstrap in the original paper https://doi.org/10.1093/sysbio/syx068 Additionally does it make sense to do PMSF analyses by using empirical mixture models combined with free-rate among-site heterogeneity eg. LG+F+C20+R10? Yes, perfectly make sense. But note that this will be very slow... I have not seen someone doing this so far, but it is mostly combined with the simpler +G4 option. In theory if an +RX model is better fitting than +GX then the +RX option should be used for phylogenetic analyses under the PMSF model? Correct me if i am wrong. We used this model recently: https://doi.org/10.1101/2020.03.05.976373 . So now you see someone ;-) You can do 2 runs with +G and +R, and compare the BIC scores. I bet that the latter will have much lower (better) score. Cheers Minh Many thanks Alex You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/17de769a-bbc0-4e03-b11c-c4038c64e4b6%40googlegroups.com ", "Thanks a lot Minh! cheers Alex "]}, "riV83ZeDiKw": {"topic": "Partition with Raxml file", "initializeDate": "Nov 27, 2019, 5:49:56 AM", "timeStamp": "Nov 30, 2019, 12:32:36 AM", "content": ["I am working with Phyluce software and I am getting the partition file in the following format: begin sets; charset 'uce-1123.nexus' = 3194-4128; charset 'uce-11875.nexus' = 4129-4878; charset 'uce-1121.nexus' = 1-874; charset 'uce-11122.nexus' = 1817-2458; charset 'uce-1168.nexus' = 2459-3193; charset 'uce-11319.nexus' = 875-1816; charset 'uce-11796.nexus' = 6278-6770; charset 'uce-11285.nexus' = 5419-6277; charset 'uce-11927.nexus' = 6771-7845; charset 'uce-11809.nexus' = 4879-5418; charpartition combined = uce-1121.nexus: 1-874, uce-11319.nexus: 875-1816, uce-11122.nexus: 1817-2458, uce-1168.nexus: 2459-3193, uce-1123.nexus: 3194-4128, uce-11875.nexus: 4129-4878, uce-11809.nexus: 4879-5418, uce-11285.nexus: 5419-6277, uce-11796.nexus: 6278-6770, uce-11927.nexus: 6771-7845; end; The error I am getting when using it as a partition file is : Partition file is not in NEXUS format, assuming RAxML-style partition file... ERROR: Please specify alignment positions for partitionuce-11319.nexus: 875-1816, uce-11122.nexus: 1817-2458, uce-1168.nexus: 2459-3193, uce-1123.nexus: 3194-4128, uce-11875.nexus: 4129-4878, uce-11809.nexus: 4879-5418, uce-11285.nexus: 5419-6277, uce-11796.nexus: 6278-6770, uce-11927.nexus: 6771-7845; ERROR: end; What am I doing wrong? I was running: iqtree -s mafft-nexus-internal-trimmed-gblocks-clean-95p_UCE.phylip -q mafft-nexus-internal-trimmed-gblocks-clean-95p_UCE.charsets Phyluce is using Raxml but the iqtree tutorial mentioned that it is also compatible. how do I use it? Thanks ", "Hi Mila, Thanks for your interests. Please see http://www.iqtree.org/doc/Advanced-Tutorial for the details. - The \u201c#nexus\" keyword is missing. - Your charpartition command is not valid. I suggest to delete it and only use charset. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/a9035b2c-47c8-461e-a21e-10c7bed05278%40googlegroups.com ", "Moreover, IQ-TREE 2 is able to load a directory (of alignment files), so that you don\u2019t have to prepare a partition file or a concatenated alignment file. For example, -p ALN_DIR will perform a partitioned analysis with all alignments in ALN_DIR as partitions. -s ALN_DIR will perform a single model analysis on the (automatically generated) concatenation of all alignments in ALN_DIR. -S ALN_DIR will perform locus tree inferences for all alignments in ALN_DIR, which can be later used for coalescent analysis. Cheers, Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/5DE01E5A-F8C9-42FF-946A-6FC28A89E1F4%40univie.ac.at ", "Thanks for the quick response Just a following question I am a bit confused about the difference between -q, -s- -p and -S I understand that the -s is the phylip file and then i need to specify the partitions (file or folder) so how is it that I can use -s again? is it correct to run the following: nohup iqtree -s File.phylip -q ../Folder -m GTR+I+G -nt AUTO > something.log nohup iqtree -s File.phylip -S ../Folder -m GTR+I+G -nt AUTO > something.log for locus tree? Thanks Mila Grinblat PhD Candidate ARC Centre of Excellence for Coral Reef Studies College of Public Health, Medical & Vet Sciences ph: +61 (0) 467258609 James Cook University Townsville QLD 4811 Australia ", "Hi Mila, -s is to perform a non-partitioned analysis, i.e. using a single model across all sites of an alignment. So you just need to supply an alignment or a directory of alignments (which as I explained will be concatenated into one single alignment). -p is synonymous to -spp in version 1.X. Both options work for backward compatibility. Please refer to to the Advanced tutorial I sent you earlier for explanation. -S is a new option in v2.0, which allows you to construct loci-specific tree topologies. Whereas all previous options will result in a single tree topology across all loci. Is that clear now? Cheers, Minh "]}, "2TwuyoirCmY": {"topic": "Subset from loci.treefile", "initializeDate": "Mar 2, 2021, 9:02:21 AM", "timeStamp": "Mar 3, 2021, 9:57:03 AM", "content": ["Hello IQTRee, I am working on the site/gene concordance approach for building a phylogenetic tree. I have been able to execute the: iqtree -p ALN_DIR --prefix concat -B 1000 -T AUTO and the: iqtree -S ALN_DIR --prefix loci -T AUTO commands, however, I am unable to run the following: iqtree -t concat.treefile --gcf loci.treefile -s ALN_FILE --scf 100 --prefix concord -T 10 because of trees in the loci.treefile that don't have the correct number of taxa. This is because the gene clustering program will add genes in multiple pieces when they are not assembled properly. Is there anyway to filter the loci.treefile so that it retains trees with only the N = 10 number of taxa? That is the number of taxa represented in the concat.treefile constructed from the whole genome alignments. Thanks, Austin ", "Hi Austin, I\u2019m confused, what is the actual problem. Does it work if you run: iqtree -t concat.treefile --gcf loci.treefile --prefix concord (just to compute gCF and no sCF.) then I know, if the loci.treefile has any taxa not in concat.treefile. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/eea24fa3-8414-47b1-bd61-66026615af71n%40googlegroups.com ", "Hello Minh, Attached are the concord.log file and the two input tree files. There is an incorrect number of taxa in the loci.treefile due to a fault in the gene clustering program (Panaroo). Is there a way to simply delete the trees in the loci.treefile that contain more than the designated taxa in the concat.treefile? Thanks, Austin "]}, "K1FoXBSBxt4": {"topic": "IQ-TREE release 2.1.0: special edition for COVID-19", "initializeDate": "Jul 17, 2020, 11:19:57 AM", "timeStamp": "Jul 23, 2020, 7:38:52 PM", "content": ["Dear Users, We\u2019re pleased to announce IQ-TREE version 2.1.0. This version is a special edition for COVID-19 analysis. It is highly tuned for >10K sequences datasets. So in principle it should run well on other large datasets. For a subset of COVID-19 alignment with 10,649 sequences, running this command (GTR model, 3 threads and fast mode): iqtree2 -s global.fa.gz -m GTR -T 3 -fast took about 30 min on a laptop. Feedback are welcome. Downloads are available here: https://github.com/iqtree/iqtree2/releases/tag/v2.1.0 Happy computing! IQ-TREE dev team ", "Hi Minh, When I ran Version 2.1.0, I found that the number of iterations and BEST SCORE varied from run to run even when the seed was fixed. I also found the same lack of reproducibility for Version 2.0.5 when run with MPI. In both cases, runs that did the most iterations had the best value for BEST SCORE. * Do you see this same behavior? Best regards, Wayne > On Jul 17, 2020, at 8:19 AM, Minh Bui < minh...@univie.ac.at > wrote: > Dear Users, > We\u2019re pleased to announce IQ-TREE version 2.1.0. > This version is a special edition for COVID-19 analysis. It is highly tuned for >10K sequences datasets. So in principle it should run well on other large datasets. For a subset of COVID-19 alignment with 10,649 sequences, running this command (GTR model, 3 threads and fast mode): > iqtree2 -s global.fa.gz -m GTR -T 3 -fast > took about 30 min on a laptop. > Feedback are welcome. > Downloads are available here: https://urldefense.com/v3/__https://github.com/iqtree/iqtree2/releases/tag/v2.1.0__;!!Mih3wA!Wd8lD4ZVhzYqAcO9JN3T6xwvOw6eIOLTbrTEHair9LRgsmMblRbWjm55wJ0252tX$ > Happy computing! > IQ-TREE dev team > -- > You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. > To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com > To view this discussion on the web visit https://urldefense.com/v3/__https://groups.google.com/d/msgid/iqtree/3C9EE9B4-5244-488C-907F-A8ACCBA8B931*40univie.ac.at__;JQ!!Mih3wA!Wd8lD4ZVhzYqAcO9JN3T6xwvOw6eIOLTbrTEHair9LRgsmMblRbWjm55wIjR8lwu$ ", "Hi Wayne, With the same seed number, I'd expect a sequential run without multi-threading and no MPI to be fully reproducible. In other cases, when you have more than one thread or more than one MPI process, reproducibility is not guaranteed. Although it might be more reproducible if you have few threads and no MPI. Please note that due to major changes from version 1 to 2, even a sequential run in version 1 is not reproducible in version 2. In short, with the same version and same seed number, a sequential run will be reproducible. If that\u2019s not the case, please send me the data and log files for further inspection. Cheers Minh To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/2E23471D-F099-4829-9548-AEEA51B38F56%40sdsc.edu ", "Hi Minh, Thanks for clarifying what behavior you expect. I have made many benchmark runs of various versions of IQ-TREE and until recently had not seen significant variation in the BEST SCORE for repeat runs for which the number of threads and the seed were fixed. My recent repeat runs suggest that . Version 2.1.0 exhibits more variation compared to 2.0.5 when using OpenMP, and . Version 2.0.5 exhibits more variation with MPI than with OpenMP. I will send you a spreadsheet of results in a separate email message so you can see what you think. Best regards, Wayne "]}, "vkcUCM8k0nU": {"topic": "Codon mixture models in IQtree", "initializeDate": "Mar 2, 2020, 1:53:55 PM", "timeStamp": "Mar 8, 2020, 12:12:29 AM", "content": ["Hello. I have some codon sequences under the GY+F model, with one omega across sites, but I also have some codon sequences with 3 types of omega, i.e. under the M3 model. Does anyone know if IQtree can implement a mixture model for codon models, like the nucleotide and protein ones that it already has? For example, is it possible to use the -m \"MIX{...,..}\" function for codon models? Thank you in advance, Jane K. ", "Hi Jane, Good question! While IQ-TREE allows for codon mixture models to be implemented, such model like M3 is not currently supported. Some tweek in the code is necessary to make it work. But perhaps it\u2019s time to implement it, to take advantage of the speed, compared with PAML\u2026 Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e6701484-bee0-46e1-98b3-59989791780c%40googlegroups.com "]}, "_LcL5xSIMuA": {"topic": "Mix Data Error in v. 1.6", "initializeDate": "Feb 9, 2018, 12:40:57 PM", "timeStamp": "Feb 13, 2018, 10:02:26 PM", "content": ["Greetings, I have been trying to run a mixed-data analysis in v. 1.6. The data consists of two subalignments, DNA and morphology, saved as separate NEXUS files. I have the partitions set as instructed in the Manual, though I omit the Charpartitions command (see below). I use the following options to run the analyses: -sp partitionfile.nex -NT AUTO -M TEST -BB 1000 The analysis seems to load the partitions\\alignments fine, but then I get the following: NOTE: Restoring information from model checkpoint file Partition-CHRY-IQtree-01.nex.model.gz CHECKPOINT: Initial tree restored NOTE: ModelFinder requires 59 MB RAM! NUMBER OF THREADS FOR PARTITION FINDING: 8 ERROR: Cannot concatenate sub-alignments of different type And this is my abbreviated partition file text: #NEXUS BEGIN SETS; CHARSET 1st = CHRYcomb-IQ-tree_local01_mole.nex:DNA, 1-657; CHARSET 2nd = CHRYcomb-IQ-tree_local01_mole.nex:DNA, 658-771; CHARSET 3rd = CHRYcomb-IQ-tree_local01_mole.nex:DNA, 772-2304; .... CHARSET 21st = CHRYcomb-IQ-tree_local01_mole.nex:DNA, 16353-18452; CHARSET 22nd = CHRYcomb-IQ-tree_local01_morph.nex:MORPH, 1-87; END; Any insight as to what the problem might be? I will note that for some taxa, I have only morphological data. These are included in the DNA matrix, but only with missing data \"?\". I did run both aligments individually on the web server as a quick test. The analyses did not much like that the DNA alignment had taxa with only missing data, but once I added a dummy site at the beginning of the alignment, there were no problems. Thank you much for your time, Stephen ", "Hi Stephen, I confirm that v1.6 does not support mixed data types, unfortunately. This will be fixed in the next release. However, I\u2019ve seen that you do edge-unlinked ModelFinder. Therefore, you can use the latest v1.5 version, which indeed supports such analysis. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, Ahh ok, I apologize for the misunderstanding. Thank you for clarifying! Kind regards, Stephen ", "Hi Stephen, No need to apologise, this is indeed an issue that we need to fix. Cheers Minh "]}, "sm1Xhg2DBFE": {"topic": "iq-tree crashed because of failing to write", "initializeDate": "Jan 8, 2021, 2:32:11 PM", "timeStamp": "Jan 18, 2021, 9:18:07 AM", "content": ["Hi all, I had a long run of iq-tree that just crashed as it was not able to write the checkpoint file. Does anyone have an idea of what may cause this? Below I show the tail of the log file: BETTER TREE FOUND at iteration 191: -36967290.353 Iteration 200 / LogL: -36992308.431 / Time: 234h:2m:44s (107h:1m:30s left) Log-likelihood cutoff on original alignment: -36969938.586 NOTE: Bootstrap correlation coefficient of split occurrence frequencies: 0.972 NOTE: UFBoot does not converge, continue at least 100 more iterations UFBoot trees printed to corepers/Phylo-BACE925_0.99/BACE925_0.99.grp.aln.ufboot Iteration 210 / LogL: -36995437.702 / Time: 246h:55m:29s (106h:19m:49s left) ERROR: Cannot write to file corepers/Phylo-BACE925_0.99/BACE925_0.99.grp.aln.ckp.gz Thanks for any help ", "Hi Ricardo, This looks like some issue with the system, outside of IQ-TREE. Which version of IQ-TREE are you running? You can still try to run the analysis again, IQ-TREE should be able to recover from a previous checkpoint file. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b1b1f81f-c3ab-4406-b803-4f1f3a035d2an%40googlegroups.com "]}, "KlWhRbAEtqI": {"topic": "What are the differences among columns, patterns and informative sites?", "initializeDate": "Feb 24, 2020, 6:12:50 PM", "timeStamp": "Mar 3, 2020, 6:36:48 AM", "content": ["Hi, I am running iqtree using SNP data on 5 individuals on a region which has 197 SNPs, the software spit out the message \"Alignment has 5 sequences with 197 columns and 56 patterns (26 informative sites)\". This makes me quite nervous because my understanding is that the alignment has 5 sequence with 197 columns and 197 patterns, and 197 informative sites. Best, Hongru. ", "Hi Hongru, columns are the columns/sites in the alignment and the number of columns is the length of the alignment. In the alignment there might be the same columns. Different columns are called patterns. While (parsimony) informative sites are patterns that have at least two different characters (nucleotides or amino acids) and each character should occur in at least two species. Essentially, informative sites have information for the grouping of species. These patterns are mainly important in the context of parsimony, where no evolutionary model is used. In maximum likelihood inference all patterns containing different characters are important for the estimation of tree topology and branch lengths, while constant/invariant sites (containing only the same character: only A's or only G's etc) are important for the correct estimation of the branch lengths. Therefore, should not be excluded from the alignment. Example: 123456789 species_1 AACGTACGT species_2 AACGATCGT species_3 AACCGTCCT species_4 AACCTACCT sites/columns 1 and 2 are identical and contain only A's - invariant site pattern, uninformative sites/columns 3 and 7 are identical and contain only C's - invariant site pattern, uninformative sites/columns 4 and 8 are identical and contain 2 G'c and 2 C's - informative site pattern sites/columns 5, 6 and 9 occur only once, each site is a different pattern 5th - uninformative 6th - informative 9th - invariant, uninformative Summing up, the alignment has 9 columns, 6 patterns A C G T A T A C G A T T A C C G T T A C C T A T (2 informative) G A G T C T C A Cheers, Olga "]}, "JcbHVBbBwEQ": {"topic": "LSD dating crashes", "initializeDate": "Jun 15, 2020, 6:52:51 AM", "timeStamp": "Jun 18, 2020, 4:32:32 AM", "content": ["Hi, I was trying out the new LSD-dating option using IQTREE v. 2.0.5 on Mac and I got this error: TREE PROCESSING Reading the tree ... Collapse over internal branches having branch length 0.000 settable via option Parameter to adjust variances was set 0.076 settable via option ERROR STACK TRACE FOR DEBUGGING ERROR _sigtramp ERROR lsd buildTimeTree int char **, lsd InputOutputStream ERROR runLSD2 PhyloTree ERROR doTimeTree PhyloTree ERROR runPhyloAnalysis Params Checkpoint ERROR ERROR *** TREE CRASHES WITH SIGNAL SEGMENTATION FAULT ERROR *** For bug report please send to developers ERROR *** Log file /Users/ Giobbe Downloads gb_type_d_b5_h log ERROR *** Alignment files possible Segmentation fault I am using a precomputed model selection for ~1000 loci along with 3 ancestral dates and the --date-tip 0 option. The tree is successfully written but then the crash happens. Am I doing something wrong? Thanks! Giobbe ", "Hi Giobbe, Can you pls try v2.0.6 https://github.com/Cibiv/IQ-TREE/releases/tag/v2.0.6 Hien fixed a few issues in LSD2 in the mean time. So it might have fixed this problem. If the problem still persists let us know. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/73f26c63-c645-4dcd-8632-b46c5a2352bfo%40googlegroups.com ", "It's working, thanks a million for the help! "]}, "Fqd70fXzIX0": {"topic": "mixture models and GUI", "initializeDate": "Jul 7, 2019, 2:12:57 PM", "timeStamp": "Jul 9, 2019, 4:08:12 AM", "content": ["1) Is it possible to ask IQ-tree (web version) to chose automatically mixture models for a partitioned multigene alignment (DNA+proteins) and get a tree? 2) Is it possible to dowload IQ-tree with the same GUI (as in the web page of IQ tree) and execute on a personal computer through this GUI? ", "Hi, Regarding the second question, I have wrote a GUI that integrates the IQ-TREE, you can try it if you wish. Homepage: https://dongzhang0725.github.io/ Brief example for executing IQ-TREE: https://dongzhang0725.github.io/dongzhang0725.github.io/documentation/#5-8-1-Brief-example Best, Dong \u5728 2019\u5e747\u67088\u65e5\u661f\u671f\u4e00 UTC+8\u4e0a\u53482:12:57\uff0cPhilipp Chetverikov\u5199\u9053\uff1a ", "Hi Philipp, There is no way to just download iqtree web service and run it on a PC. But Dong gave an alternative solution PhyloSuite, which you might have seen and it looks quite nice! So try it out. Moreover, Mesquite software also supports IQ-TREE. You can also try CIPRES server. For your 1st question: to run mixed DNA+protein models, you need to run it from the command line (though I\u2019m not sure if PhyloSuite supports that). There is a detailed guide how to set up such a run here: http://www.iqtree.org/doc/Complex-Models#partition-models Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b800a285-a323-4bf6-b752-cd5e2d69b8d2%40googlegroups.com For more options, visit https://groups.google.com/d/optout ", "Hi, Dong, thanks for the links. I will try PhyloSuite with pleasure and will be glad to cite it. 1) Does PhyloSuite have options for molecular clocks and calibration points? I did not find it in the tutorial 2) Does PhyloSuite allow to apply mixture models for a partitioned alignment? Philipp \u043f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a, 8 \u0438\u044e\u043b\u044f 2019 \u0433., 3:42:32 UTC+3 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u5f20\u4e1c \u043d\u0430\u043f\u0438\u0441\u0430\u043b: ", "Dear Minh, thanks for the answer. What do you mean saying that \"Mesquite software also supports IQ-TREE\"? I use Mesquite to get a nexus file (fused multigene matrix) and upload this file to the IQtree web site (along with a partition file) for analysis. Could you suggest other options for using Mesquite and IQ-tree together? Philipp \u043f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a, 8 \u0438\u044e\u043b\u044f 2019 \u0433., 12:04:12 UTC+3 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c Minh Bui \u043d\u0430\u043f\u0438\u0441\u0430\u043b: Hi Philipp, There is no way to just download iqtree web service and run it on a PC. But Dong gave an alternative solution PhyloSuite, which you might have seen and it looks quite nice! So try it out. Moreover, Mesquite software also supports IQ-TREE. You can also try CIPRES server. For your 1st question: to run mixed DNA+protein models, you need to run it from the command line (though I\u2019m not sure if PhyloSuite supports that). There is a detailed guide how to set up such a run here: http://www.iqtree.org/doc/Complex-Models#partition-models Cheers Minh On 8 Jul 2019, at 10:42 am, \u5f20\u4e1c < dongzh...@gmail.com > wrote: Hi, Regarding the second question, I have wrote a GUI that integrates the IQ-TREE, you can try it if you wish. Homepage: https://dongzhang0725.github.io/ Brief example for executing IQ-TREE: https://dongzhang0725.github.io/dongzhang0725.github.io/documentation/#5-8-1-Brief-example Best, Dong \u5728 2019\u5e747\u67088\u65e5\u661f\u671f\u4e00 UTC+8\u4e0a\u53482:12:57\uff0cPhilipp Chetverikov\u5199\u9053\uff1a 1) Is it possible to ask IQ-tree (web version) to chose automatically mixture models for a partitioned multigene alignment (DNA+proteins) and get a tree? 2) Is it possible to dowload IQ-tree with the same GUI (as in the web page of IQ tree) and execute on a personal computer through this GUI? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Philipp, CC David, If you have used Mesquite, then you might be able to do all these analyses with it. You need to install a package called Zephyr: http://zephyr.mesquiteproject.org . It interacts with IQ-TREE (and other software) and automatically displays the tree once done, which is really cool. I\u2019m just not sure if this feature supports mixed DNA and protein data types. @David: can you say if Zephyr supports mixed data matrix? Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e13e1184-7cfd-4d21-8674-0bbf6fcbb8c7%40googlegroups.com ", "Hi Philipp, 1. At the time, we haven't included these functions in the PhyloSuite. 2. As IQ-TREE is very versatile, we included only a part of its parameters in the PhyloSuite GUI. So this option is not included in the GUI. However, PhyloSuite offers an option for users to add parameters that are not included in the GUI. Just modify the preset command via the \"View | Edit command\" function in the dropdown arrow of the \u2018Start\u2019 button. In the screenshot below, I added this option by replacing '-m mtZOA+R6+F' with '-m \"MIX{JC ,HKY}+G4\"'. Then just click 'Save and run' button to start. Best regards, Dong \u5728 2019\u5e747\u67088\u65e5\u661f\u671f\u4e00 UTC+8\u4e0b\u534811:23:40\uff0cPhilipp Chetverikov\u5199\u9053\uff1a "]}, "w4N5oYQ4E5o": {"topic": "\"Numerical Underflow\" error with AA data in IQTree 1.6beta4", "initializeDate": "Jul 17, 2017, 3:15:52 PM", "timeStamp": "Jul 18, 2017, 4:52:57 AM", "content": ["Hi All: I just tried a couple of runs with IQTree1.6beta4 (64 bit, Linux) using an amino acid alignment. In the first run I got the single line: 'ERROR: Numerical underflow (lh-derivative-mixlen). Run again with the safe likelihood kernel via `-safe` option' When I then modified the command syntax so that '-safe' was included, the program was returning a large number of such lines, successively. I had to kill the run by using ^C. Please advise. Thanks! ", "I should have included the command syntax in the above message: iqtree -s TestAlign.phy -m LG+F+H4 then later iqtree -s TestAlign.phy -m LG+F+H4 -safe ", "Hi David, Please send us (CC Stephen) your alignment via personal email. We will have a look. Thank you, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "gjn8ZDcATXk": {"topic": "Codon model - numerical underflow (lh-derivative)", "initializeDate": "May 30, 2017, 5:17:58 AM", "timeStamp": "May 30, 2017, 7:50:52 AM", "content": ["Good afternoon, I used codon to infer phylogenetic tree. I encountered error and would like to ask for your advice: ERROR: Numerical underflow (lh-derivative). Run again with the safe likelihood kernel via `-safe` option What should I do next? Thank you very much! Bests, Giap Nguyen ", "Dear Giap, Some other users reported similar problem with codon models. I seem to fix it, but need to do more carefully testing before final release. So please wait a few days ;-) Thanks, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "Pv9wmB0-VeI": {"topic": "Problem with constrain File", "initializeDate": "Sep 15, 2017, 12:03:46 PM", "timeStamp": "Sep 15, 2017, 5:54:34 PM", "content": ["Dear IQ team, I am having issues running a contrain file with the -g option, The error I get is ERROR: A taxon has no name. I'm not sure what this error means, as during a previous iteration, I received a different error telling me of a taxon not being present in my alignment file. See attached log file. ", "Dear Gavin, > I am having issues running a contrain file with the -g option, > The error I get is ERROR: A taxon has no name. More complete the message is: \u201cERROR: A taxon has no name. (line 1 column 55)\u201d Could you please check whether the tree file has an error at position 55 in line 1? I guess the error points out that there is an extra comma (\u2018,\u2019) or else there is a sequence name missing where there should be one. Maybe when constructing the constraint tree either a comma was left in when removing some sequence names or an additional one sneaked in. It\u2019s hard to tell without having the tree file. > I'm not sure what this error means, as during a previous iteration, I received a different error telling me of a taxon not being present in my alignment file. > See attached log file. See above. Without the treefile we can only guess. Best wishes, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- ", "Heiko, Thank you for your reply. That actually should help as I was not sure what IQtree was referring to as columns. But at site 55, there is a comma and parenthesis, so I can start checking there for what may be the issue. ", "Hi Gavin, Is the parenthesis you mention a closing one? If that looks like this \u201c\u2026(\u2026,)\u2026\", then IQ-TREE is right. There cannot be a comma that is not followed either by a sequence-name or an opening bracket (which contains another subtree). If the above is the case, you have to delete the comma. Subsequently, you should check, that after deletion there are still (at least) two entities (i.e. sequence names and/or subtree in a pair of brackets) remain within the bracket after deletion. So if the bracket looks like this \u201c\u2026((\u2026))\u2026\u201d or \u201c\u2026(sequence-name)\u2026\u201d you have to delete a pair of brackets as well. If there is something like \u201c:0.134\u201d after the bracket - this is the branch length attached and has to be deleted as well. If the constraint tree was obtained from a tree reconstruction it may contain branch lengths. I hope that helps. Cheers, Heiko ", "Thank you, it looks like the problem was that I had single entities within their own brackets. All seems to be working now. You received this message because you are subscribed to a topic in the Google Groups \"IQ-TREE\" group. To unsubscribe from this topic, visit https://groups.google.com/d/topic/iqtree/Pv9wmB0-VeI/unsubscribe To unsubscribe from this group and all its topics, send an email to iqtree+unsubscribe@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Gavin Martin PhD Student Bybee Lab Brigham Young University "]}, "n3QaX3RkFu8": {"topic": "bug report: TESTONLY crashes", "initializeDate": "Jan 22, 2017, 9:39:06 AM", "timeStamp": "Jan 23, 2017, 3:43:56 AM", "content": ["With the attached file, IQ-TREE multicore 64-bit version 1.5.3 crashes with the attached input while trying to create bootstrap support values. \"Creating bootstrap support values... iqtree-omp: /home/CIBIV/minh/Dropbox/iqtree-git/splitgraph.h:235: int SplitGraph::getNTaxa(): Assertion `size() > 0' failed.\" I've attached the input and the verbose stderr/out log. The command was iqtree-omp -nt 1 -bb 1000 -m TESTNEWONLY -s test.phy (I removed the sequence names afterward so the output might be slightly different) ", "Dear Bob, thanks for the report. The problem is that, the two options -m TESTNEWONLY and -bb 1000 interfere with each other. \u201cONLY\" means to stop once finishing model selection, whereas -bb tells IQ-TREE to continue performing bootstrap analysis. Therefore, please use -m TESTNEW instead. However, IQ-TREE shouldn\u2019t crash this way but print some error message instead. I will do this change in the next release. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <test.phy> <test.phy.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "xUT4zearatY": {"topic": "Morphological data", "initializeDate": "May 6, 2019, 3:53:12 AM", "timeStamp": "May 6, 2019, 6:18:44 AM", "content": ["Hi all, I am having trouble getting my morphological file to run. I had it in the phylip format, but for some reason it keeps insisting that there are errors in the sequence length indicated. I've tried shortening the names, inserting tab spaces instead of normal spaces - I just can't figure it out. I've also tried putting my morphological data in fasta format but it is still not working. My command is: \"bin\\iqtree -s morph.fas -st morph\" but the program keeps saying: \"Alignment most likely contains binary sequences. ERROR: Invalid sequence type\" Any ideas would be appreciated!! Cheers, Sariana ", "Hi Sariana, The option should be -st MORPH, i.e. in upper case. I don\u2019t know what happened with the phylip alignment. But if it works with FASTA, then pls continue from there. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "PS: Perhaps your alignment was in sequential phylip format. Note that there are two Phylip formats, where the default in IQ-TREE is interleave. If your alignment is in sequential phylip, then please add option --sequential to the IQ-TREE command line. ", "Thank you Minh, the capital letters did it. Such a silly mistake to have made! On Monday, May 6, 2019 at 12:11:48 PM UTC+2, Minh Bui wrote: PS: Perhaps your alignment was in sequential phylip format. Note that there are two Phylip formats, where the default in IQ-TREE is interleave. If your alignment is in sequential phylip, then please add option --sequential to the IQ-TREE command line. On 6 May 2019, at 8:07 pm, Minh Bui < min...@univie.ac.at > wrote: Hi Sariana, The option should be -st MORPH, i.e. in upper case. I don\u2019t know what happened with the phylip alignment. But if it works with FASTA, then pls continue from there. Cheers, Minh On 6 May 2019, at 5:53 pm, sarian...@gmail.com wrote: Hi all, I am having trouble getting my morphological file to run. I had it in the phylip format, but for some reason it keeps insisting that there are errors in the sequence length indicated. I've tried shortening the names, inserting tab spaces instead of normal spaces - I just can't figure it out. I've also tried putting my morphological data in fasta format but it is still not working. My command is: \"bin\\iqtree -s morph.fas -st morph\" but the program keeps saying: \"Alignment most likely contains binary sequences. ERROR: Invalid sequence type\" Any ideas would be appreciated!! Cheers, Sariana You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com "]}, "bRJZmjS5gD4": {"topic": "Scale bar", "initializeDate": "Aug 14, 2018, 10:06:38 AM", "timeStamp": "Aug 16, 2018, 8:49:20 AM", "content": ["Hello, I am afraid the question is trivial but what does exactly the scale bar mean? Is it the average number of substitutions per site? I am asking because I am facing a consensus tree with a scale bar of 2.6 This seems odd to me, unless I misunderstand the meaning of the bar. The documentation suggests it's a percentage, does it mean it's 2.6%? Or is it 260%? Thanks a lot. ", "Hi there, Before we can answer your question, some information is needed: 1. Which version of IQ-TREE are you using? 2. Assuming that you used a tree viewer program (FigTree?), did you view .treefile or .contree file? 3. \"The documentation suggests it's a percentage\u201d: which documentation are you referring to here? Note that the branch lengths in .treefile are the average number of substitutions per site. For .contree, older IQ-TREE versions do not print the branch lengths (only bootstrap supports are assigned), whereas recent versions estimate branch lengths under the original alignment. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi, 1. v1.6.6 2. I visualised on phylo.io the .contree file 3. the doc that is here: http://www.iqtree.org/doc/ ", "Ok, Then the scale bar and branch lengths are the expected number of substitutions per site (not percentage). Such long branches should rarely happen (i.e. between divergent taxa such as bacteria and eukaryotes). If that\u2019s not the case, I would check carefully the homology assumptions and the alignments first. Then look for saturation such as those 3rd codon positions (sometimes people remove those fast evolving sites). You can also look to remove sequences that do not fit the alignment. Another option is to analyse protein instead of DNA sequences\u2026 Cheers Minh ", "They are already amino acid sequences >< I completely agree there is something fishy going on. The problem likely comes from the alignment indeed! I will work on that. Thanks for your help. Cheers ", "Dear Alessandro, another thing to do if one encounters such long branch lengths, is to have a closer look at the alignment. Does it really make sense? Or do you have sequences in there (or groups of them) which do not look like being properly aligned. Such mis-aligned sequences would require lots of additional mutations to bridge the differences between the different sequences. Another point (which might or might not affect you) - what kind of data do you use? Some people use only the variable sites in an alignment and delete all the constant sites. For the phylogenetic programs analysing such data it looks that all sites are heavily mutating. Thus, the actual rate of substitution is heavily overestimated leading to very long branches. Even though the constant sites do not contribute much to determining the tree structure, the constant sites do strongly contribute to estimate the branch lengths correctly. (Just as a side remark) (Not necessarily related to you, but still handy to know...) Removing the constant sites does not speed up the tree search much, because in the first step alignment site patterns (identical columns) are merged and counted, such that site likelihood are not recomputed again and again for the same pattern, but instead are computed only once and than the site-log-likelihood are multiplied by the number that pattern occurred in the original alignment. Thus, for DNA data lots of constant sites would be condensed to just four constant sites which do not take up much running time ;) This is also valid for proteins, but there are more than 3 possible constant patterns (typically 20 ;) Best regards, Heiko ----------------------------------------------------------------------------- Heiko Schmidt Center for Integrative Bioinformatics Vienna (CIBIV) University of Vienna / Max F. Perutz Laboratories (MFPL) http://www.cibiv.at/ ----------------------------------------------------------------------------- "]}, "57MX5WB0TDs": {"topic": "IQtree 1.7.b9, MF+MERGE with -p creates best_scheme.nex file with __NA__", "initializeDate": "Apr 23, 2019, 9:17:35 AM", "timeStamp": "May 3, 2019, 4:12:09 AM", "content": ["Dear Minh, I have been playing around with IQtree 1.7.b9 (unix version on a Rocks cluster) and really like the -p option where a directory with individual alignment files can be specified, instead of a concatenated alignment. Model selection and likelihood searches have been running fine. Then I tried using MF+MERGE as shown below either for nucleotides or amino acids. This finished without any error message, but the resulting best_scheme.nex file in both cases contains __NA__ instead of pointing to the filenames of the loci in the partition, and the corresponding best_scheme file just has a row of commas with spaces in between. The file name only appears for partitions consisting of a single locus, as also shown in the example below. Would it be possible to fix this, or should I rather use -s and a concatenated file when using +MERGE? ./iqtree_17b9 -p ../NT_CODON_3 -m MF+MERGE -rclusterf 10 -rcluster-max 10000 -cmax 4 -pre NTC3 -nt 10 ./iqtree_17b9 -p ../AA -m MF+MERGE -rclusterf 10 -rcluster-max 10000 -cmax 4 -mset BLOSUM62,Dayhoff,DCMut,JTT,JTTDCMut,LG,WAG -madd LG4M,LG4X -pre AA -nt 10 First few partitions in best_scheme.nex: #nexus begin sets; charset DPOGS200021_PA_5_7_mafft.trimmed.ALICUT_codon_3rd.fas_DPOGS205054_PA_3_5_mafft.trimmed.ALICUT_codon_3rd.fas_DPOGS209799_PA_17_29_mafft.trimmed.ALICUT_codon_3rd.fas_DPOGS209930_PA_3_11_mafft.trimmed.ALICUT_codon_3rd.fas_DPOGS211783_PA_10_45_mafft.trimmed.ALICUT_codon_3rd.fas_DPOGS212039_PA_2_2_mafft.trimmed.ALICUT_codon_3rd.fas_DPOGS214262_PA_4_4_mafft.trimmed.ALICUT_codon_3rd.fas_DPOGS215600_PA_1_9_mafft.trimmed.ALICUT_codon_3rd.fas = __NA__: ; charset DPOGS208056_PA_3_3_mafft.trimmed.ALICUT_codon_3rd.fas_DPOGS211134_PA_3_4_mafft.trimmed.ALICUT_codon_3rd.fas_DPOGS213170_PA_3_3_mafft.trimmed.ALICUT_codon_3rd.fas_DPOGS213297_PA_14_15_mafft.trimmed.ALICUT_codon_3rd.fas_DPOGS213796_PA_3_14_mafft.trimmed.ALICUT_codon_3rd.fas_DPOGS214696_PA_12_14_mafft.trimmed.ALICUT_codon_3rd.fas_DPOGS216067_PA_3_3_mafft.trimmed.ALICUT_codon_3rd.fas = __NA__: ; charset DPOGS208823_PA_24_35_mafft.trimmed.ALICUT_codon_3rd.fas = ../NT_CODON_3/DPOGS208823_PA_24_35_mafft.trimmed.ALICUT_codon_3rd.fas: ; charset DPOGS209957_PA_2_2_mafft.trimmed.ALICUT_codon_3rd.fas_DPOGS211215_PA_3_5_mafft.trimmed.ALICUT_codon_3rd.fas_DPOGS214287_PA_6_18_mafft.trimmed.ALICUT_codon_3rd.fas = __NA__: ; Best wishes, Marianne ", "Hi Marianne, This is because when merging two partitions, each is an alignment file in your case, the merged file name does not exist. That\u2019s why IQ-TREE writes __NA__. We don\u2019t have a solution for this yet, so you can\u2019t use the best_scheme output file right now. if you want to use this best_scheme file, then do the option you suggested, i.e., using the concatenated alignment file. IQ-TREE can help you generate such a file, let me know if you need... Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Marianne, There is now a new option --out-alignment in the latest beta11 version: https://github.com/Cibiv/IQ-TREE/releases/tag/v1.7-beta11 iqtree -p ALN_DIR --out-alignment CONCAT will print two files: the concatenated alignment (CONCAT) and partition file (CONCAT.nex) for all alignments in the directory. Cheers, Minh On 26 Apr 2019, at 5:19 pm, Marianne Espeland < marianne...@gmail.com > wrote: Thanks, Minh. I have a python script for generating concatenated files and the partition file, but would still be interested in learning how to do this in IQ-tree. Couldn't find any documentation on this, so it would be great if you could show me how this is done. I, however, very much like the possibility of giving a directory with individual alignments as input, since by not concatenating there is one less step to do, and thus one less step that can go wrong... Best wishes, Marianne ______________________________ Marianne Espeland, PhD Curator, Head of Lepidoptera Section Zoological Research Museum Alexander Koenig Adenauer Allee 160 53113 Bonn Germany email: marianne...@gmail.com m.esp...@leibniz-zfmk.de phone: +49 228 9122-220 "]}, "gQ0lEmLMUe0": {"topic": "Order of arguments in command line?", "initializeDate": "Dec 14, 2017, 6:40:46 PM", "timeStamp": "Dec 15, 2017, 12:28:08 PM", "content": ["Hi, Today I was running iqtree-omp using the same command I used a few months ago (copy pasted from the help file I made for myself back then) and I got an error message. iqtree-omp -nt 8 -s infile.fasta -m GTR+R16 \u2013wsr ERROR: Please specify the number of cores to use (-nt option)! iqtree-omp -s infile.fasta -m GTR+R16 \u2013wsr -nt 8 ERROR: Error reading tree file -wsr iqtree-omp -s infile.fasta -m GTR+R16 -nt 8 \u2013wsr works fine. I am running version 1.5.5 now, I am guessing that I was running version 1.5.4 a few months ago. I downloaded version 1.5.6 today and tried that, and get the same issues with it being picky about the order in which the arguments are used. Brian Foley HIV Databases ", "Hi Brian, The order of command options should not matter\u2026 and there is no difference in parsing options between these versions. I notice from your pasted command lines that there are two different kinds of dashes in the options. Normal short dash and (strangely) long dash in front of wsr. Can this be the cause? Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Good eye! I did not notice that with the two types of dashes. I have no idea how that happened, I never even knew there were two types possible. But I tested the commands today, with the arguments in various orders, and it is certainly just the \"long dash\" that made the problem. Thanks! ", "Hi Brian, > On 15 Dec 2017, at 18:10, Brian Foley < brianf...@gmail.com > wrote: > Good eye! I did not notice that with the two types of dashes. I have no idea how that happened, I never even knew there were two types possible. Often this is just done by the editor one is using. Simple experiment: I open a \u2018fresh\u2019 document in MS Word and type at the beginning \u201ciqtree -mbt \u201c. When typing the 1st space character Word turns the first letter upper case (Iqtree). When typing the 2nd space character Word turns the dash into a long dash (\u2013mbt). It is very fortunate that the text editors know so much better what we want and act without even asking us\u2026 >:-) > But I tested the commands today, with the arguments in various orders, and it is certainly just the \"long dash\" that made the problem. Good that this is sorted out. (Well observed, Minh!) All the best from Vienna, Heiko "]}, "UEQNHe9LhZs": {"topic": "IQ-TREE 1.6.8: Data type detection problems (AA meta-partitions)", "initializeDate": "Jun 19, 2019, 10:04:02 AM", "timeStamp": "Jun 25, 2019, 11:23:41 AM", "content": ["Hi, I am analyzing a small AA alignment (15 species, ~330 meta-partitions). When running IQTREE 1.6.8 (newest version currently available on our cluster), the software automatically detects the type accurately for about 2/3 of the partitions if I do not use the -st AA option (see copy&paste from log-file below). I ran the analysis both with and without the data type option and got the same topology with overlapping likelihoods and only very minute variations in branch lengths (20 runs without and 1 run with -st AA). What does IQTREE do with the partitions for which it was not able to automatically determine the datatype when not using the -st option? Is this something one should look out for more carefully? I searched through the documentation, but could not seem to find this specific case. Best, Jan Philip Oeyen Subset Type Seqs Sites Infor Invar Model Name 1 15 920 385 279 LG4X EOG090X0LFT_EOG090X08KD_EOG090X0EXU_EOG090X0KP6 2 AA 15 1903 135 1616 LG+R2 EOG090X0GN3_EOG090X0064_EOG090X07IC 3 8 238 72 75 LG4M EOG090X0C5G 4 AA 15 305 141 71 LG+R3 EOG090X0EYV_EOG090X0EV6 5 AA 15 887 244 386 LG+F+R3 EOG090X0ACT_EOG090X0K4K_EOG090X03QT 6 AA 15 584 34 458 JTT+R2 EOG090X0662_EOG090X09VR_EOG090X0KYU ", "Hi Jan, This is part of the log file, where the detection might not print complete information. You should look at .iqtree file with full information, e.g.: SEQUENCE ALIGNMENT ------------------ Input data: 17 taxa with 3 partitions and 1332 total sites (0% missing data) ID Name Type Seq Site Unique Infor Invar Const 1 part1 DNA 17 666 413 343 227 227 2 part2 DNA 17 333 208 153 112 112 3 part3 DNA 17 333 207 165 127 127 And simply look at \u201cType\u201d column, to see if these are all correct or not. Cheers, Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/a7e59ca2-b19f-4c87-950d-e71084e730d0%40googlegroups.com For more options, visit https://groups.google.com/d/optout "]}, "fsepMgBGjSo": {"topic": "Testing the best-fitting number of gamma categories", "initializeDate": "Mar 1, 2017, 2:23:17 AM", "timeStamp": "Mar 1, 2017, 7:11:47 AM", "content": ["Hi Minh, After going through the documentation again, I noticed that G only tests for the default 4 gamma categories. Is there a command to test all numbers of gamma categories to find the best-fitting given the alignment? Alternatively, is there a way to test within a range of categories, for example test from G2 to G18? In addition, when stipulating the number of categories to be tested, if I want multiple gamma rate categories with and without invariant sites allowed, do I have to individually stipulate the number of categories for both G and G+I? For example, will the following command also test for I+ G2, G4, G8, G12, G18, G24, or does the I+G have to be stipulated as well? iqtree-omp -s example.fasta -m TESTNEW -mrate E,I,G2,G4,G8,G12,G18,G24,I+G,I+R,R -mtree -nt 8 Thank you in advance, Tim ", "Dear Tim, On Mar 1, 2017, at 8:23 AM, Tim McInerney < tim...@hotmail.com > wrote: Hi Minh, After going through the documentation again, I noticed that G only tests for the default 4 gamma categories. that\u2019s right Is there a command to test all numbers of gamma categories to find the best-fitting given the alignment? Unfortunately no. The reason is that G4 and G8 have the same number of parameter (Gamma shape) and the more categories the higher likelihood is. Thus, there is no sensible way (to my knowledge) to determine the \u201cbest\u201d number of categories. Alternatively, is there a way to test within a range of categories, for example test from G2 to G18? yes, the way you already gave below ;-) i.e. with option -mrate G2,G3,G4,\u2026,G18 where you have to specify all individual rate models. But as I notice above, you will likely have G18 fitting better than other lower-category Gamma model. In addition, when stipulating the number of categories to be tested, if I want multiple gamma rate categories with and without invariant sites allowed, do I have to individually stipulate the number of categories for both G and G+I? yes that\u2019s right, i.e. you have to add -mrate \u2026,I+G2,I+G4,I+G8,\u2026 into your command line below. Cheers, Minh For example, will the following command also test for I+ G2, G4, G8, G12, G18, G24, or does the I+G have to be stipulated as well? iqtree-omp -s example.fasta -m TESTNEW -mrate E,I,G2,G4,G8,G12,G18,G24,I+G,I+R,R -mtree -nt 8 Thank you in advance, Tim You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "thm_e5Jmxrc": {"topic": "iqtree 1.6.9 with very large dataset", "initializeDate": "Mar 25, 2019, 7:14:09 PM", "timeStamp": "Apr 18, 2019, 9:34:03 AM", "content": ["Hi all, we are running iqtree 1.6.9 with a dataset of about 14,500 accessions and 125,000 sites. Our commandline is: iqtree -s ${1}.varsites.phy -m MFP+ASC -pre ${1} -alrt 1000 -bb 1000 -nt 32 -nm 1000 -bnni -cptime 201 -safe -mem 300G -o ${OUTGROUP} The software is running since about 8 days on a 2 x Xeon CPU E5-2650 0 @ 2.00GHz server with about 380 GB RAM ; here are the last 20 lines from the log file: tail -n 20 *log 7 JC+ASC+R6 11258242.410 29327 22575138.820 22612652.821 22845759.004 Ascertainment bias correction: 4 unobservable constant patterns 8 JC+ASC+R7 11240727.301 29329 22540112.602 22577633.356 22810751.241 Ascertainment bias correction: 4 unobservable constant patterns 9 JC+ASC+R8 11224913.430 29331 22508488.860 22546016.368 22779145.955 Ascertainment bias correction: 4 unobservable constant patterns 10 JC+ASC+R9 11218361.987 29333 22495389.974 22532924.237 22766065.523 Ascertainment bias correction: 4 unobservable constant patterns 11 JC+ASC+R10 11212897.002 29335 22484464.004 22522005.023 22755158.009 Ascertainment bias correction: 4 unobservable constant patterns 12 F81+F+ASC 14492192.689 29320 29043025.379 29080515.751 29313580.969 Ascertainment bias correction: 4 unobservable constant patterns 13 F81+F+ASC+G4 11420627.823 29321 22899897.646 22937391.393 23170462.463 Ascertainment bias correction: 4 unobservable constant patterns 14 F81+F+ASC+R2 11915856.295 29322 23890356.590 23927853.712 24160930.635 Ascertainment bias correction: 4 unobservable constant patterns 15 F81+F+ASC+R3 11496089.494 29324 23050826.987 23088330.860 23321419.488 Ascertainment bias correction: 4 unobservable constant patterns 16 F81+F+ASC+R4 11349876.873 29326 22758405.746 22795916.371 23029016.702 Ascertainment bias correction: 4 unobservable constant patterns We would like to ask if there are suggestions to run such large dataset faster. Thanks in advance, Giuseppe ", "Hi Giuseppe, Quick answer: use \u201c-m GTR+ASC+R10\u201d option, instead. Explanation: for such large data set, GTR is almost always the best model. No need to test simpler models like JC, etc. Moreover, from the log file, +R10 is very likely the best rate heterogeneity model. So setting the model this way will skip the time-consuming model selection and go straight forward into the tree inference. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Minh, What about test R11, R12 and so on ? ", "Good question! Thanks for pointing this out. R10 is the maximum default in IQ-TREE. But for this data set more rate categories seem beneficial. To do so you can use the following options: -mset GTR -mrate ASC+R -cmin 10 -cmax 20 Minh ", "Hi! Thank you very much for your suggestions. We resubmitted our tree using \"-mset GTR -mrate ASC+R -cmin 10 -cmax 20\" options: iqtree -s ${1}.varsites.phy -mset GTR -mrate ASC+R -cmin 10 -cmax 20 -pre ${1} -alrt 1000 -bb 1000 -nt 48 -nm 1000 -bnni -cptime 201 -safe -mem 160G -o $(cat ${FILE_OUTGROUP}) Actually we first used new filters and reducede the number of SNPs: now our input file has 14,359 individuals and 71,476 sites. We still have performace problems. We launched different iqtree runs on our cluster but the queue lasts 24 hours and the jobs all seems to stop around the bionj tree calculation, sometimes starting the INITIALIZING CANDIDATE TREE SET step but never going much further. In half cases a checkpoint file is produced but Iqtree seems to restart each time from p-value calculation, then it repeats best model search and computes BIONJ tree: ... 14357 260740 75.28 failed 0.00 14358 260750 75.35 failed 0.00 14359 260790 75.29 failed 0.00 WARNING 191 sequences contain more than gaps ambiguity **** TOTAL 4.33 820 sequences failed composition chi2 test value NOTE Restoring information from model checkpoint file ALL_GOOD_DATA_ALL_SPECIES_not all sites model CHECKPOINT Initial tree restored NOTE ModelFinder requires 163832 MB RAM ModelFinder will test DNA models sample size 54749 ... Model LnL df AIC AICc BIC Ascertainment bias correction unobservable constant patterns GTR ASC R10 9753715.573 28741 19564913.146 19628440.183 19821010.240 Ascertainment bias correction unobservable constant patterns GTR ASC R11 9750875.262 28743 19559236.524 19622777.289 19815351.439 Ascertainment bias correction unobservable constant patterns GTR ASC R12 9751014.753 28745 19559519.506 19623074.001 19815652.242 Akaike Information Criterion GTR ASC R11 Corrected Akaike Information Criterion GTR ASC R11 Bayesian Information Criterion GTR ASC R11 Best fit model GTR ASC R11 chosen according to BIC All model information printed to ALL_GOOD_DATA_ALL_SPECIES_not all sites model CPU time for ModelFinder 162.085 seconds 42s Wall clock time for ModelFinder 164.188 seconds 44s Generating 1000 samples for ultrafast bootstrap seed 463108 )... Ascertainment bias correction unobservable constant patterns NOTE 163833 MB RAM 159 required Estimate model parameters epsilon 0.100 Initial log likelihood 10886580.579 Current log likelihood 9789659.342 Current log likelihood 9760823.984 Current log likelihood 9758977.709 Current log likelihood 9758844.115 Current log likelihood 9758715.920 Current log likelihood 9758679.053 Current log likelihood 9758662.290 Current log likelihood 9758643.875 10. Current log likelihood 9758633.560 11. Current log likelihood 9758620.705 12. Current log likelihood 9758615.877 13. Current log likelihood 9758606.621 14. Current log likelihood 9758602.613 15. Current log likelihood 9758596.707 16. Current log likelihood 9758592.188 17. Current log likelihood 9758590.259 18. Current log likelihood 9758587.474 19. Current log likelihood 9758584.850 20. Current log likelihood 9758583.540 21. Current log likelihood 9758580.601 22. Current log likelihood 9758579.862 23. Current log likelihood 9758579.135 24. Current log likelihood 9758578.934 25. Current log likelihood 9758577.862 Optimal log likelihood 9758577.755 Rate parameters 1.06372 3.83944 1.39860 0.73490 4.05849 1.00000 Base frequencies 0.245 0.255 0.253 0.248 Site proportion and rates 0.647 0.014 0.177 0.066 0.061 0.188 0.036 0.585 0.043 1.065 0.017 1.820 0.006 3.309 0.005 6.383 0.004 11.673 0.000 53.957 0.005 167.450 Parameters optimization took rounds 15232.268 sec Computing ML distances based on estimated model parameters ... 869358.458 sec Computing BIONJ tree ... 44950.123 seconds Log likelihood of BIONJ tree 11131651.628 -------------------------------------------------------------------- INITIALIZING CANDIDATE TREE SET -------------------------------------------------------------------- Generating parsimony trees ... ****************************************************** CHECKPOINT Resuming analysis from ALL_GOOD_DATA_ALL_SPECIES_not all sites ckp TREE multicore version 1.6 for Linux bit built Dec 2018 Developed Bui Quang Minh Nguyen Lam Tung Olga Chernomor Heiko Schmidt Dominik Schrempf Michael Woodhams Host AVX512 FMA3 188 GB RAM Command iqtree ALL_GOOD_DATA_ALL_SPECIES_not all sites varsites phy mset GTR mrate ASC cmin cmax pre ALL_GOOD_DATA_ALL_SPECIES_not all sites alrt 1000 1000 1000 bnni cptime 201 safe mem 160G o GPT239410 Seed 436769 Using SPRNG Scalable Parallel Random Number Generator Time Mon Apr 2019 Kernel Safe AVX FMA threads CPU cores detected Reading alignment file ALL_GOOD_DATA_ALL_SPECIES_not all sites varsites phy ... Phylip format detected Alignment most likely contains DNA RNA sequences Alignment has 14359 sequences with 54749 columns 54668 distinct patterns 43995 parsimony informative 10754 singleton sites constant sites Gap Ambiguity Composition value 028240 1.62 passed 99.70 028250 0.07 passed 99.98 028260 0.09 passed 99.52 ... Is there any way to further speed up calculation? can we skip any of the first steps like BIONJ tree calculation which is expected to have a worse likelyhood? I can send you complete log files if you need them. Thank you very much! Giuseppe On Tuesday, March 26, 2019 at 12:23:34 PM UTC+1, Minh Bui wrote: Good question! Thanks for pointing this out. R10 is the maximum default in IQ-TREE. But for this data set more rate categories seem beneficial. To do so you can use the following options: -mset GTR -mrate ASC+R -cmin 10 -cmax 20 Minh On 26 Mar 2019, at 7:47 pm, Pierre Arnal < pierre...@gmail.com > wrote: Hi Minh, What about test R11, R12 and so on ? Le mar. 26 mars 2019 \u00e0 01:00, Minh Bui < min...@univie.ac.at > a \u00e9crit : Hi Giuseppe, Quick answer: use \u201c-m GTR+ASC+R10\u201d option, instead. Explanation: for such large data set, GTR is almost always the best model. No need to test simpler models like JC, etc. Moreover, from the log file, +R10 is very likely the best rate heterogeneity model. So setting the model this way will skip the time-consuming model selection and go straight forward into the tree inference. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com ", "Hi Giuseppe, Because this is not just a large but huge data set: >14K sequences of 71K sites! Right now iqtree is stuck at the step of constructing 98 parsimony trees. The BIONJ tree has very bad log-likelihood. So I\u2019d suggest option \u201c-ninit 1\u201d to omit these. Moreover, for such many sequences I\u2019d change the perturbation strength to say 0.1 with \"-pers 0.1\". This not only help to reduce the runtime but might also improve the tree likelihood. For more details see: http://www.iqtree.org/doc/Command-Reference#tree-search-parameters Finally, do you have another computer without 48h limit? If nothing works, you can also try \u201c-fast\u201d option to have a quick tree. Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com ", "Hi Minh. Thanks a lot again. Unfortunately we only have 24h and 144h queues in our cluster but slots availability for the 144h queue is really limited. I missed the \u201c-ninit 1\u201d to omit BIONJ tree search, I was trying with \"-djc\"; thank you for your suggestion. A couple of extra questions, please: Would you suggest a preliminary step for the removal of SNPs in linkage disequilibrium? I read something about this topic in the literature even I am not sure this is neede for IQTREE. What about \"-nstop\" option? Shall we leave it at the default value or increase it? Best, Giuseppe On Wednesday, April 10, 2019 at 3:19:38 AM UTC+2, Minh Bui wrote: Hi Giuseppe, Because this is not just a large but huge data set: >14K sequences of 71K sites! Right now iqtree is stuck at the step of constructing 98 parsimony trees. The BIONJ tree has very bad log-likelihood. So I\u2019d suggest option \u201c-ninit 1\u201d to omit these. Moreover, for such many sequences I\u2019d change the perturbation strength to say 0.1 with \"-pers 0.1\". This not only help to reduce the runtime but might also improve the tree likelihood. For more details see: http://www.iqtree.org/doc/Command-Reference#tree-search-parameters Finally, do you have another computer without 48h limit? If nothing works, you can also try \u201c-fast\u201d option to have a quick tree. Minh ", "I am curious about what type of data could have 14,000 sequences of more than 41,000 sites each, that could possibly be expected to produce a phylogenetic tree with real meaning. For most data sets with that many sites, I would think that recombination, incomplete lineage sorting, introgreassion and other issues such as horizontal gene transfer would become quite confounding. For one example, it is reasonable to use genomic data from humans, chimps, gorillas, and other primates with 10 to 20 genomes from each species and including Neanderthal, Dennisova, Altai, etc.. But if we look at 1,000 or more human genomes we get issues with some humans having more Neanderthal DNA than others, etc. and a single \"tree\" is no longer the best way to understand the evolution and migration of human populations over time. If we are interested in human migrations etc. it is often better to look at one or several individual markers such as mitochondrial genomes, or to study how much Neandethal DNA was retained in various populations. Phylogeneic methods on very large data sets is not \"useless\" even if there is a huge amount of horizontal gene transfer or other issues, but it is not always necessary to built \"the tree\" of all data to get started. Sometimes it is better to pick a few genomes from each of the major lineages in the set and construct a tree, and then begin to ask questions such as \"What percentage of each genome tends to agree with that tree, and which genes have most often been transferred between the lineages?\" For example when one human population invades another, do the mitochondria give us a different picture than the Y chromosome does? Does that answer depend on the method of takeover (war vs migration), or is it more of a matter of fitness (mitochondria from high altitude mountain people perhaps more \"fit\" in high elevations?)? There are some good ways to test your dataset for such things as \"the consistency index\" (using some random or nonrandomly carefull chosem small subsets of the data for each run) to get an idea whether or not one single tree is likely to be a reasonable explanation of your data. If your phylogeny does have some major branches, and the point is to accurately place each genome onto that tree, there may be methods to do that without getting bogged down with the trivial of trying to locate exactly which twig at the branch tips that each leaf belongs on. ", "Please don't take this the wrong way. I am not assuming that you don't know what is best for your data. I am only wondering if I am missing out on some new area of biology I am not aware of. But I am also hoping that maybe my experience with large data sets can be of some help. My experience is mostly with \"deep\" (tens to hundreds of thousand of leaves) data, than wide (very long sequences of complete genomes) data, but I have followed some of the literature on both types. Also, I observe that research on plants, viruses, bacteria, vertebrates, invertebrates etc is not all the same even though when we look at DNA or protein sequences we can all share many of the same tool sets. Please feel free to write to me b...@lanl.gov if it is not good to discuss this in public. Also, I hope you all forgive me for discussing biology, in a forum that is supposed to be about IQ-tree software. ", "Hi all, I just want to concur with what Brain just wrote. Not only doesn't the analysis of this huge dataset make a lot of biological sense, but in computational point of view it is also extremely hard. The phylogenetic signal for your alignment is most likely not strong enough to give you any sensible result. My experience told me that if you run IQ-Tree 10 times, you will get 10 very different trees. This is the case for all other ML software too, like RAxML for instance. Moreover, it is not fruitful to \"waste\" computing time on finding the tree with the maximum likelihood for such many taxa because the search space is astronomically big. Even if we could find the ML tree (the truly global maximum), the inferred tree is most likely still incorrect. The ML here is just the probability of your data, not the tree itself. Thus, I would suggest that you just start the tree inference with the -fast option together with bootstrapping to have an idea of how the tree would look like. The deep branches would be poorly supported but you will certainly find many well supported subgroups. I am not sure if what I am going to tell is a valid approach in phylogenetic inference but for each subgroup I would take one representative taxon and do the inference on those taxa again. I hope that my answer would help. It has been quite a while since I last wrote something here :) Cheers Tung You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com ", "Hi Giuseppe, On 11 Apr 2019, at 7:51 am, giusepp...@gmail.com wrote: Hi Minh. Thanks a lot again. Unfortunately we only have 24h and 144h queues in our cluster but slots availability for the 144h queue is really limited. I missed the \u201c-ninit 1\u201d to omit BIONJ tree search, I was trying with \"-djc\"; thank you for your suggestion. A couple of extra questions, please: Would you suggest a preliminary step for the removal of SNPs in linkage disequilibrium? I read something about this topic in the literature even I am not sure this is neede for IQTREE. I don\u2019t know about such SNP filtering steps. So can\u2019t answer here... What about \"-nstop\" option? Shall we leave it at the default value or increase it? Yes this can be left as default. Cheers, Minh To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com "]}, "fzm906D7jww": {"topic": "IQ-TREE crash", "initializeDate": "Dec 4, 2014, 10:50:15 PM", "timeStamp": "Dec 20, 2016, 7:12:04 AM", "content": ["Hi, I got a crashing message when running iqtree-sse3 with a big protein alignment of 4899 taxa. I paste on the end some last lines of the log. Best regards, Cuong Dang. Create initial parsimony tree by phylogenetic likelihood library (PLL)... 178.252 seconds Reading model parameters from file JTT.paml NOTE: 4720.754 MB RAM is required! Estimate model parameters (epsilon = 0.001) iqtree: iqtree-1.1.3-Source/phylotreesse.cpp:1611: double PhyloTree::computeLikelihoodDervEigenTipSSE(PhyloNeighbor*, PhyloNode*, double&, double&) [with VectorClass = Vec2d; int VCSIZE = 2; int nstates = 20]: Assertion `isnormal(tree_lh)' failed. *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send developers: *** Log file: HIV_train.phylip.log *** Alignment files (if possible) Aborted (core dumped) ", "Dear Cuong, thanks for reporting this bug. Essentially it is a numerical underflow (even with proper numerical scaling) due to such a huge alignment. RAxML published this technical issue, if you want to know details: http://www.biomedcentral.com/1471-2105/12/470 I also ran RAxML on your alignment and it gave the same behaviour, i.e. sometimes tree log-likelihood becomes -inf. So this issue will not likely be resolved soon, unfortunately. Minh You received this message because you are subscribed to the Google Groups \"IQTREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Max F. Perutz Laboratories Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 24026 Fax: ++43 1 4277 24098 Email: minh.bui (AT) univie.ac.at ", "I got the same problem when running iqtree on a large dataset of 11000 SNP loci. It crashed during the model selection part. Below is the last few lines of the output: 26 K3P+I 2937269.815 190 5874919. 629 5874919 672 5877265 .369 27 K3P+G4 2944672.181 190 5889724.362 5889724. 405 5892070 .102 28 K3P+I+G4 2934922.544 191 5870227.089 5870227.132 5872585.175 29 K3Pu 2920397.859 192 5841179. 718 5841179 762 5843550 .150 30 K3Pu+I 2893714.106 193 5787814.211 5787814. 256 5790196 .989 *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: /scratch/chan/iqtree/md5mc48p.10.phy.log *** Alignment files (if possible) Has there been a solution for this problem yet? ", "Hi all, I have the same problem doing partitoned BS analyses (15 taxa, 260000 sites, aa dataset, 234 partitions... anyway, I definitely need to analyse this - so shall I resample that long until it does not crash? (I run 10 runs a 10 bootstrap replicates; one (until now) was successful) what would yu suggest: other partition scheme? other commands? I would like to do the normal BS though... Best Karen WARNING: Numerical underflow caused by alignment sites 2 29 48 66 126 152 155 199 248 285 319 346 380 392 416 439 WARNING: Numerical underflow caused by alignment sites 2 152 199 248 346 392 416 WARNING: Numerical underflow caused by alignment sites 2 199 416 iqtree: .../iq/iqtree-1.3.10-Source/phylotreesse.cpp:2108: double PhyloTree::computeMixrateLikelihoodBranchEigen(PhyloNeighbor*, PhyloNode*): Assertion `!isnan(tree_lh) && !isinf(tree_lh)' failed. *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: rcl_iq_bs30.log *** Alignment files (if possible) /cm/local/apps/slurm/var/spool/job10275850/slurm_script: line 12: 98172 Aborted iqtree -omp 20 -st AA -s ...supermatrix_aa_alltaxa.phy -spp ...coll_partitions_rcl.nex -pre rcl_iq_bs00 -bo 10 -numstop 300 -sprrad 10 If I shall send you the alignment etc please let me know! (quite urgent unfortunately so for any hints running thorough BS I am very gratefull) ", "Dear Karen, yes please send me via personal email the data, command, and log file. I will have a closer look. Thanks, Minh To post to this group, send email to iqt...@googlegroups.com Visit this group at http://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at ", "Hello, I just got the same error: *** IQ-TREE CRASHES WITH SIGNAL ABORTED *** For bug report please send to developers: *** Log file: iq_.log *** Alignment files (if possible) Abort trap: 6 But my alignment is only 38 taxa with only 4173 nucleotide positions, not so big at all, I don't know why it is crashing. To call the software I used: iqtree-omp -s papara_alignment_basalGB.fasta -m TIM3+R5 -alrt 1000 -bb 1000 -bo 100 -pre iq_ -wsr -wbt -nt 6 I attach the log file in case you might need it. Thank you very much for your help, Alicia. ", "Hi Alicia, please do not perform both ultrafast bootstrap (-bb) and standard bootstrap (-bo) within one run. It crashed at the final step because of this. I will add a check in the future release to disable this. Minh > <iq_.log> "]}, "CkAq3STWB14": {"topic": "crash in IQTREE with -b (bootstrap) and -zw (topology testing)", "initializeDate": "Jan 19, 2015, 12:43:27 PM", "timeStamp": "Feb 10, 2015, 4:47:51 AM", "content": ["I have got two crashes of IQTREE today 1) while topology testing - I was using -sp (partition file) and specific models (in the file) while topology testing and there was no problems. But when I tried to test the toplogy with partitioning the data (without -sp option), it crashes [ will attach the log file directly to your mail] while using -zw option. This crash, when not explicitly saying the model is reproducible. But I am not sure if I need to explicitly set the model while doing topology tests with IQTREE since the manual shows otherwise. 2) while carrying out a normal bootstrap analysis IQTREE crashes when finding a worse likelihood [will attach the log file directly]. I have go no problems with UfBoot, aLRT, and LBP. ALthough sometimes there was a crash which was rectified by running the program once more. The normal bootstrap is also rerun now but don't know if it is going to crash again or not. hope these two bugs will be of immediate concern to the developers and others. thanks, Siby. ", "Dear Siby, these bugs have been fixed in version 1.2.0, just released today. Please check it out. Thanks for reporting the issue Minh "]}, "cSWtEvtMXa0": {"topic": "error: IQ-tree Crashes with Signal Abort", "initializeDate": "Jul 18, 2020, 10:28:09 PM", "timeStamp": "Jul 20, 2020, 8:23:42 AM", "content": ["Hi everyone, Everything has been running great with IQ tree until recently. Has anyone seen this error before and how to fix it? I tried to google it but haven't got far. I attached the log file for reference. Thank you so much in advance! Danielle ", "Please try the latest version 2.1.0 from https://github.com/iqtree/iqtree2/releases I notice that you used v2.0.3 and there have been some numerical issue in the early 2.0 series, which have been fixed. Let me know if that works for you. Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/e7ecd5a9-f2b9-4cb2-84d4-659d6f2d0596n%40googlegroups.com <Only_Csp22_Full_length_AA_alignment.log> "]}, "hDxStAoSDzM": {"topic": "UFBOOT file contains numbers", "initializeDate": "Apr 10, 2018, 12:23:10 PM", "timeStamp": "Apr 12, 2018, 4:51:41 PM", "content": ["Dear all, first, sorry if this question has been asked, I fastly checked the documentation and searched the forum and found no answer. I want to use bootstraps to perform some topology analysis using consense from the phylip package and I realized that .ufboot files contain numbers in some trees. The files always contain 1000 lines with a tree in each, but every now and then, a tree contains some numbers that look like nodal supports. I never asked iqtree to add branch lengths or any other stat, and furthermore, the fact that not all lines have numbers, and that different files contain different quantity of lines with numbers is really strange to me. What are those, can I simply remove them and proceed with downstream analyses? I used different versions of iqtree, but for the record the 1.6.2 prints the same output. Here is the command I used for 20 subsets of the same concatenated dataset with progressively exclusion of fast evolving sites: iqtree -s infile.txt -bb 1000 -alrt 1000 -wbt -wspm -st AA -wsr -m LG+F+R7+C60 -pre output -nt AUTO out.ufboot looks like this: (taxon,(((((((((((taxon,taxon)0,(taxon,taxon)0)0,((taxon,taxon)0,taxon)0)0,((taxon,taxon)96.7,(taxon,taxon)83.4)0)0,((taxon,taxon)0,(((taxon,taxon)0,taxon)0,taxon)0)0)0,((taxon,(taxon,taxon)0)0,taxon)0)0,((taxon,taxon)0,(taxon,(taxon,taxon)0)0)0)0,(((((((taxon,taxon),taxon),taxon),taxon),taxon),((((taxon,taxon),taxon),taxon),taxon)),((((taxon,taxon),taxon),taxon),(taxon,taxon)))0)0,taxon)91.7,taxon)0,(taxon,taxon))0,taxon); (taxon,(((((((((((((taxon,taxon),(taxon,taxon)),((taxon,taxon),taxon)),((taxon,taxon),(taxon,taxon))),((taxon,taxon),(((taxon,taxon),taxon),taxon))),(((taxon,(taxon,taxon)),taxon),((taxon,taxon),(taxon,(taxon,taxon))))),taxon),(((((taxon,taxon),taxon),taxon),taxon),taxon)),(((taxon,taxon),taxon),taxon)),(((taxon,taxon),((taxon,taxon),taxon)),(taxon,taxon))),taxon),taxon),taxon),taxon); Any clue would be much appreciated. Thanks. ", "Hi Guifre, I can confirm that it\u2019s a new question, very good that you checked the forum beforehand! From your command line, I also don\u2019t understand why there are numbers with the trees in the .ufboot trees file. Just to be sure since your sample tree has \u201ctaxon\u201d as taxon labels: they were only substituted with real names and posted here for confidential reason, right? Btw I could replicate this behaviour with a local data set. Will have more careful look and get back to you. Thanks for reporting this! Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Thanks for the answer, the names were changed because they were long and uninformative, not for confidentiality although it's from an article in revision. I can provide one of the datasets but I don't think it's the problem since it happened in 3 distinct datasets, also different versions and clusters (local and cipres). Looking forward to hear from you. El dj., 12 abr. 2018 , 02:23, Minh Bui < minh...@univie.ac.at > va escriure: To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+unsubscribe@googlegroups.com "]}, "nsy57KxRy6A": {"topic": "abnormal termination in LNSRCH", "initializeDate": "Feb 20, 2018, 5:42:40 AM", "timeStamp": "May 14, 2018, 4:14:20 AM", "content": ["Dear Developers, I tried GHOST model with my alignment (n = 86 sequences, 642 nucleotide). During the process, I observed the notification as \"abnormal termination in LNSRCH\". Would you please explain to me what is the consequence of that error. Thank you very much! Best regards, Giap Nguyen ", "Hi Giap, This is an internal warning generated by the BFGS algorithm, used by IQ-TREE to optimize the model parameters. I suspect the cause of this is that you are trying to estimate too many parameters from not enough data. With 86 sequences, even with only two GHOST classes you are trying to estimate approximately 350 parameters from only 642 nucleotides. It is difficult to provide firm guidelines about how many parameters one should attempt to estimate from a given sequence length, as we have not yet carried out extensive simulations to assess this specifically. For now, I would err on the conservative side and try to have at least 10 times as many sites as parameters. So I think for your case, you may have to look at removing some sequences from your dataset. Cheers, Stephen You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout ", "Hi Stephen, Thank you very much for your explanation. Bests, Giap Nguyen V\u00e0o 17:42:40 UTC+7 Th\u1ee9 Ba, ng\u00e0y 20 th\u00e1ng 2 n\u0103m 2018, nguyen...@gmail.com \u0111\u00e3 vi\u1ebft: ", "Hi Stephen, I'm running IQ-tree with Mitochondrial genomic data, from 75 species, totally around 16k nucleotides for each sequence, each sequence is composited by 63 partitions, i.e. codon position, rRNA(800bp, 1500bp) and tRNA(60~75bp) during the model selection by ModelFinder, I got some error messages: >>>> . ERROR: ERROR: ABNORMAL_TERMINATION_IN_LNSRCH here is my script to run the analysis: iqtree -s sequence -spp partition -m MFP+MERGE -nt 24 -st DNA -pre prefix -bb 1000 -alrt 1000 But I cannot find any info on this error messages, could you please give me some suggestions about this error? Thanks a lot Best wishes Shaolin \u5728 2018\u5e742\u670820\u65e5\u661f\u671f\u4e8c UTC+1\u4e0b\u53484:01:41\uff0cStephen Crotty\u5199\u9053\uff1a ", "Hi Shaolin, Are you able to send me the log file for this run? It would be helpful to know which model was being tested by ModelFinder when the error occurred. The error originates from the L-BFGS-B algorithm which is used to optimise the model parameters. The error essentially means that the algorithm aborted prematurely when the line search procedure breaks down, most likely caused by a non-smooth likelihood function. We have observed that models with high numbers of parameters (e.g. the GHOST model for heterotachy) are particularly susceptible to this error, which is why I ask which model was being tested when the error occurred. We are currently testing modifications to the L-BFGS-B algorithm in order to reduce this problem. In the meantime, you could rerun ModelFinder but excluding the particular models that result in this behaviour. Hope this helps, Stephen Stephen Crotty, PhD Centre for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC 5, Ebene 1 A-1030 Vienna, Austria Email: stephen...@univie.ac.at "]}, "nLrV9suG_Kc": {"topic": "\u201cERROR: Rate entries could not be read\u201d when using custom codon exchange rates and frequencies", "initializeDate": "Aug 29, 2017, 5:41:19 AM", "timeStamp": "Aug 29, 2017, 8:41:16 AM", "content": ["Hi, I'm runnin iqtree v1.5.5. for Linux 64-bit ad issuing the following command: $ iqtree s testalign st CODON m testmodel where \"testmodel\" is a file containing custom codon exchange rates and frequencies in PAML format. Unfortunately it results in the aforementioned error. I have also tried to supply the ECM matrix as presented in the supplementary materials of Kosiol,C., Holmes,I., Goldman,N., 2007 ( doi ) whith identical results. I'm quite sure that I'm missing something basic but I have no idea how to solve this. Best, Umberto ", "Dear Umberto, The documentation ( http://www.iqtree.org/doc/Substitution-Models#codon-models ) about user-defined codon model is wrong. For standard genetic code the file should contain 61*61 symmetric rate matrix and 61 frequencies (not in PAML format). I will update the doc, thanks! Note that the codon order is AAA,AAC,AAG,AAT,ACA,\u2026.,TTT, excluding the 3 stop codons. I believe that PAML uses a different order. So pls check this carefully. Moreover, your codon model is problematic: it has many codons with zero frequency. This will cause numerical problem. So please change this, before you run IQ-TREE. I don\u2019t know how small a frequency can get before making problem, but it should not be smaller than 0.0001. Cheers Minh You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To post to this group, send email to iqt...@googlegroups.com Visit this group at https://groups.google.com/group/iqtree For more options, visit https://groups.google.com/d/optout <testmodel> <testalign.log> Bui Quang Minh Center for Integrative Bioinformatics Vienna (CIBIV) Campus Vienna Biocenter 5, VBC5, Ebene 1 A-1030 Vienna, Austria Phone: ++43 1 4277 74326 Email: minh.bui (AT) univie.ac.at "]}, "trcKeFD3ZmQ": {"topic": "Re: [iqtree] input file : 25 datasets => output file : 25 tree ?", "initializeDate": "Apr 14, 2020, 7:20:45 PM", "timeStamp": "Apr 15, 2020, 5:57:30 PM", "content": ["Hi Adeline, If you have 25 Nexus files all in a folder, you should be able to generate 25 trees using a single command: iqtree -S ALN_DIR` I.e. the `-S` command is what you need. More details in the command reference, but you can add whatever other commands you want to apply to all of them there too. Rob On Wed, 15 Apr 2020 at 01:00, Adeline < adelin...@orange.fr > wrote: Hello, I have in a file 25 datasets in NEXUS format. In each dataset there are 47 alignments of protein sequences. Is it possible with this input file to generate a tree for each dataset, with iqtree? Or do I have to do it manually? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/fec716d5-e99c-427e-a748-d70a44290c96%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com ", "Hi Adeline, I\u2019m not aware that NEXUS format allows for multiple replicate datasets in file. But one way you might do this (it does depend on your file being in the standard nexus format though) is to define a partition file that specifies the limits of each dataset within your file, then use this approach: iqtree -s ALN_FILE -S PARTITION_FILE This is probably not the best approach, since it means you won\u2019t be able to specify partitions within each dataset, and with 47 genes it\u2019s probably a good idea to consider partitioned analyses. I\u2019d recommend instead just splitting the 25 datasets out into 25 individual nexus files, then running replicate analyses (either with or with a for loop or just 25 command lines in a single shell script) with correctly-specified partitions, and full model selection through MF+MERGE Rob On Thu, 16 Apr 2020 at 01:18, Adeline adelin...@orange.fr wrote: I have 25 replicate datasets in one file, so I don't know how to have 25 trees from a file. Le mercredi 15 avril 2020 01:20:45 UTC+2, Rob Lanfear a \u00e9crit : Hi Adeline, If you have 25 Nexus files all in a folder, you should be able to generate 25 trees using a single command: iqtree -S ALN_DIR` I.e. the `-S` command is what you need. More details in the command reference, but you can add whatever other commands you want to apply to all of them there too. Rob On Wed, 15 Apr 2020 at 01:00, Adeline < adelin...@orange.fr > wrote: Hello, I have in a file 25 datasets in NEXUS format. In each dataset there are 47 alignments of protein sequences. Is it possible with this input file to generate a tree for each dataset, with iqtree? Or do I have to do it manually? You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqt...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/fec716d5-e99c-427e-a748-d70a44290c96%40googlegroups.com Rob Lanfear Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra www.robertlanfear.com You received this message because you are subscribed to the Google Groups \"IQ-TREE\" group. To unsubscribe from this group and stop receiving emails from it, send an email to iqtree+un...@googlegroups.com To view this discussion on the web visit https://groups.google.com/d/msgid/iqtree/b3ac2485-dfb2-4c44-85e5-0ecf211423d4%40googlegroups.com "]}}